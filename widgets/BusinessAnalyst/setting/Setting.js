// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),function(v,A,C,t,k,b,
f,d,c,a,e,g,p,z,l,h,r,G,I,B,E,J,F,y,x){function w(q){return new B({command:q.name})}function n(q){return new B({buttonClass:I,command:q.name})}C=C("dijit.Editor",y,{plugins:null,extraPlugins:null,constructor:function(){e.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",E]);this._plugins=[];this._editInterval=
1E3*this.editActionInterval;if(g("ie")||g("trident")||g("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new t;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);e.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=k.getLocalization("dijit._editor","commands",this.lang);
g("webkit")&&c.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new h({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));A.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);f.add(this.iframe.parentNode,"dijitEditorIFrameContainer");f.add(this.iframe,"dijitEditorIFrame");b.set(this.iframe,"allowTransparency",!0);this.toolbar.startup();
this.onNormalizedDisplayChanged()},destroy:function(){A.forEach(this._plugins,function(q){q&&q.destroy&&q.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(q,H){var K=e.isString(q)?{name:q}:e.isFunction(q)?{ctor:q}:q;if(!K.setEditor){var m={args:K,plugin:null,editor:this};K.name&&(B.registry[K.name]?m.plugin=B.registry[K.name](K):z.publish(x._scopeName+".Editor.getPlugin",m));if(!m.plugin)try{var u=K.ctor||e.getObject(K.name)||
v(K.name);u&&(m.plugin=new u(K))}catch(D){throw Error(this.id+": cannot find plugin ["+K.name+"]");}if(!m.plugin)throw Error(this.id+": cannot find plugin ["+K.name+"]");q=m.plugin}1<arguments.length?this._plugins[H]=q:this._plugins.push(q);q.setEditor(this);e.isFunction(q.setToolbar)&&q.setToolbar(this.toolbar)},resize:function(q){q&&G.prototype.resize.apply(this,arguments)},layout:function(){var q=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+d.getPadBorderExtents(this.iframe.parentNode).h+
d.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=q+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(q){var H,K=this.document.body,m=K.clientWidth,u=K.clientHeight,D=K.clientLeft,M=K.offsetWidth,L=K.offsetHeight,N=K.offsetLeft;/^rtl$/i.test(K.dir||"")?m<M&&q.x>m&&q.x<M&&(H=!0):q.x<D&&q.x>N&&(H=!0);H||u<L&&q.y>u&&q.y<L&&(H=!0);H||(delete this._cursorToStart,delete this._savedSelection,"BODY"==q.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(q){this.customUndo&&this.endEditing(!0);"BODY"!=q.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(q){this._inEditing||(this._inEditing=!0,this._beginEditing(q));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(q){if(!this.customUndo||
"undo"!=q&&"redo"!=q){this.customUndo&&(this.endEditing(),this._beginEditing());var H=this.inherited(arguments);this.customUndo&&this._endEditing();return H}return this[q]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(q){try{var H=this.document.execCommand(q,!1,null);if(g("webkit")&&!H)throw{};}catch(K){H=p.substitute,alert(H(this.commands.systemShortcut,
[this.commands[q],H(this.commands[g("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[q]])])),H=!1}return H},queryCommandEnabled:function(q){return!this.customUndo||"undo"!=q&&"redo"!=q?this.inherited(arguments):"undo"==q?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(q){var H=q.mark,K=q.mark;q=q.isCollapsed;var m;if(K)if(9>g("ie")||9===g("ie")&&g("quirks"))if(e.isArray(K))H=[],A.forEach(K,function(M){H.push(F.getNode(M,this.editNode))},this),this.selection.moveToBookmark({mark:H,
isCollapsed:q});else{if(K.startContainer&&K.endContainer&&(m=F.getSelection(this.window))&&m.removeAllRanges){m.removeAllRanges();q=F.create(this.window);var u=F.getNode(K.startContainer,this.editNode);var D=F.getNode(K.endContainer,this.editNode);u&&D&&(q.setStart(u,K.startOffset),q.setEnd(D,K.endOffset),m.addRange(q))}}else(m=F.getSelection(this.window))&&m.removeAllRanges&&(m.removeAllRanges(),q=F.create(this.window),u=F.getNode(K.startContainer,this.editNode),D=F.getNode(K.endContainer,this.editNode),
u&&D&&(q.setStart(u,K.startOffset),q.setEnd(D,K.endOffset),m.addRange(q)))},_changeToStep:function(q,H){this.setValue(H.text);(q=H.bookmark)&&this._moveToBookmark(q)},undo:function(){var q=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var H=this._steps.pop();H&&0<this._steps.length&&(this.focus(),this._changeToStep(H,this._steps[this._steps.length-1]),this._undoedSteps.push(H),this.onDisplayChanged(),delete this._undoRedoActive,q=!0);delete this._undoRedoActive}return q},
redo:function(){var q=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var H=this._undoedSteps.pop();H&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],H),this._steps.push(H),this.onDisplayChanged(),q=!0);delete this._undoRedoActive}return q},endEditing:function(q){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(q),this._inEditing=!1)},_getBookmark:function(){var q=this.selection.getBookmark(),
H=[];if(q&&q.mark){var K=q.mark;if(9>g("ie")||9===g("ie")&&g("quirks")){var m=F.getSelection(this.window);if(e.isArray(K))A.forEach(q.mark,function(D){H.push(F.getIndex(D,this.editNode).o)},this),q.mark=H;else if(m){var u;m.rangeCount&&(u=m.getRangeAt(0));q.mark=u?u.cloneRange():this.selection.getBookmark()}}try{q.mark&&q.mark.startContainer&&(H=F.getIndex(q.mark.startContainer,this.editNode).o,q.mark={startContainer:H,startOffset:q.mark.startOffset,endContainer:q.mark.endContainer===q.mark.startContainer?
H:F.getIndex(q.mark.endContainer,this.editNode).o,endOffset:q.mark.endOffset})}catch(D){q.mark=null}}return q},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:J.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var q=J.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:q,bookmark:this._getBookmark()})},onKeyDown:function(q){g("ie")||this.iframe||q.keyCode!=a.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var H=
q.keyCode;if(q.ctrlKey&&!q.shiftKey&&!q.altKey){if(90==H||122==H){q.stopPropagation();q.preventDefault();this.undo();return}if(89==H||121==H){q.stopPropagation();q.preventDefault();this.redo();return}}this.inherited(arguments);switch(H){case a.ENTER:case a.BACKSPACE:case a.DELETE:this.beginEditing();break;case 88:case 86:if(q.ctrlKey&&!q.altKey&&!q.metaKey){this.endEditing();88==q.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!q.ctrlKey&&!q.altKey&&
!q.metaKey&&(q.keyCode<a.F1||q.keyCode>a.F15)){this.beginEditing();break}case a.ALT:this.endEditing();break;case a.UP_ARROW:case a.DOWN_ARROW:case a.LEFT_ARROW:case a.RIGHT_ARROW:case a.HOME:case a.END:case a.PAGE_UP:case a.PAGE_DOWN:this.endEditing(!0);case a.CTRL:case a.SHIFT:case a.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(q){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(q){this.customUndo?this.isClosed?this.setValue(q):(this.beginEditing(),q||(q="\x26#160;"),this.setValue(q),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(q){this.setValueDeferred.then(e.hitch(this,function(){!this.disabled&&q||!this._buttonEnabledPlugins&&q?
A.forEach(this._plugins,function(H){H.set("disabled",!0)}):this.disabled&&!q&&A.forEach(this._plugins,function(H){H.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(c.set(this.document.body,"color",c.get(this.iframe,"color")),c.set(this.document.body,"background-color",c.get(this.iframe,"background-color")))}catch(q){}}});e.mixin(B.registry,{undo:w,redo:w,cut:w,copy:w,paste:w,insertOrderedList:w,insertUnorderedList:w,
indent:w,outdent:w,justifyCenter:w,justifyFull:w,justifyLeft:w,justifyRight:w,"delete":w,selectAll:w,removeFormat:w,unlink:w,insertHorizontalRule:w,bold:n,italic:n,underline:n,strikethrough:n,subscript:n,superscript:n,"|":function(){return new B({setEditor:function(q){this.editor=q;this.button=new r({ownerDocument:q.ownerDocument})}})}});return C})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(v,A,C,t,k,b,f,d){C("dijit-legacy-requires")&&k(0,function(){v(["dijit/ToolbarSeparator"])});return A("dijit.Toolbar",[b,d,f],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(v,A,C,t){return v("dijit.ToolbarSeparator",[C,t],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);A.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(v,A,C,t,k){A=A("dijit._editor._Plugin",t,{constructor:function(b){this.params=
b||{};C.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:k,disabled:!1,getLabel:function(b){return this.editor.commands[b]},_initButton:function(){if(this.command.length){var b=this.getLabel(this.command),f=this.editor,d=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(b=C.mixin({label:b,ownerDocument:f.ownerDocument,dir:f.dir,
lang:f.lang,showLabel:!1,iconClass:d,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete b.name,this.button=new this.buttonClass(b))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(b,f,d){this.own(v.connect(b,f,this,d))},updateState:function(){var b=this.editor,f=this.command;if(b&&b.isLoaded&&f.length){var d=this.get("disabled");if(this.button)try{var c=
b._implCommand(f);var a=!d&&(this[c]?this[c](f):b.queryCommandEnabled(f));this.enabled!==a&&(this.enabled=a,this.button.set("disabled",!a));if(a&&"boolean"==typeof this.button.checked){var e=b.queryCommandState(f);this.checked!==e&&(this.checked=e,this.button.set("checked",b.queryCommandState(f)))}}catch(g){console.log(g)}}},setEditor:function(b){this.editor=b;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",C.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",C.hitch(this,"updateState")))},setToolbar:function(b){this.button&&b.addChild(this.button)},set:function(b,f){if("object"===typeof b){for(var d in b)this.set(d,b[d]);return this}d=this._getAttrNames(b);if(this[d.s])var c=this[d.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(b,f);return c||this},get:function(b){var f=this._getAttrNames(b);
return this[f.g]?this[f.g]():this[b]},_setDisabledAttr:function(b){this._set("disabled",b);this.updateState()},_getAttrNames:function(b){var f=this._attrPairNames;if(f[b])return f[b];var d=b.charAt(0).toUpperCase()+b.substr(1);return f[b]={s:"_set"+d+"Attr",g:"_get"+d+"Attr"}},_set:function(b,f){this[b]=f}});A.registry={};return A})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e){return v("dijit._editor.plugins.EnterKeyHandling",c,{blockNodeForEnter:"BR",constructor:function(g){g&&("blockNodeForEnter"in g&&(g.blockNodeForEnter=g.blockNodeForEnter.toUpperCase()),t.mixin(this,g))},setEditor:function(g){if(this.editor!==g)if(this.editor=g,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,g.onLoadDeferred.then(t.hitch(this,function(z){this.own(k(g.document,"keydown",t.hitch(this,function(l){if(l.keyCode==C.ENTER){var h=t.mixin({},l);h.shiftKey=
!0;this.handleEnterKey(h)||(l.stopPropagation(),l.preventDefault())}})));9<=b("ie")&&10>=b("ie")&&this.own(k(g.document,"paste",t.hitch(this,function(l){setTimeout(t.hitch(this,function(){var h=this.editor.document.selection.createRange();h.move("character",-1);h.select();h.move("character",1);h.select()}),0)})));return z}));else if(this.blockNodeForEnter){var p=t.hitch(this,"handleEnterKey");g.addKeyHandler(13,0,0,p);g.addKeyHandler(13,0,1,p);this.own(this.editor.on("KeyPressed",t.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var g=this.editor.selection.getAncestorElement("LI");if(g){b("mozilla")&&"LI"==g.parentNode.parentNode.nodeName&&(g=g.parentNode.parentNode);var p=g.firstChild;!p||1!=p.nodeType||"UL"!=p.nodeName&&"OL"!=p.nodeName||(g.insertBefore(p.ownerDocument.createTextNode("\u00a0"),p),p=e.create(this.editor.window),p.setStart(g.firstChild,0),g=e.getSelection(this.editor.window,!0),g.removeAllRanges(),g.addRange(p))}else a.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(g=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(g.innerHTML=this.bogusHtmlContent,9>=b("ie")&&(g=this.editor.document.selection.createRange(),g.move("character",-1),g.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(g){var p,z=this.editor.document,l;if(g.shiftKey){g=this.editor.selection.getParentElement();if(p=e.getAncestor(g,this.blockNodes)){if("LI"==p.tagName)return!0;g=e.getSelection(this.editor.window);var h=g.getRangeAt(0);h.collapsed||(h.deleteContents(),g=e.getSelection(this.editor.window),h=g.getRangeAt(0));if(e.atBeginningOfContainer(p,h.startContainer,h.startOffset)){var r=z.createElement("br");h=e.create(this.editor.window);p.insertBefore(r,
p.firstChild);h.setStartAfter(r);g.removeAllRanges();g.addRange(h)}else if(e.atEndOfContainer(p,h.startContainer,h.startOffset))h=e.create(this.editor.window),r=z.createElement("br"),p.appendChild(r),p.appendChild(z.createTextNode("\u00a0")),h.setStart(p.lastChild,0),g.removeAllRanges(),g.addRange(h);else{if((l=h.startContainer)&&3==l.nodeType){var G=l.nodeValue;var I=z.createTextNode(G.substring(0,h.startOffset));var B=z.createTextNode(G.substring(h.startOffset));p=z.createElement("br");""==B.nodeValue&&
b("webkit")&&(B=z.createTextNode("\u00a0"));A.place(I,l,"after");A.place(p,I,"after");A.place(B,p,"after");A.destroy(l);h=e.create(this.editor.window);h.setStart(B,0);g.removeAllRanges();g.addRange(h);return!1}return!0}}else g=e.getSelection(this.editor.window),g.rangeCount?(h=g.getRangeAt(0))&&h.startContainer&&(h.collapsed||(h.deleteContents(),g=e.getSelection(this.editor.window),h=g.getRangeAt(0)),(l=h.startContainer)&&3==l.nodeType?(p=h.startOffset,l.length<p&&(B=this._adjustNodeAndOffset(l,p),
l=B.node,p=B.offset),G=l.nodeValue,I=z.createTextNode(G.substring(0,p)),B=z.createTextNode(G.substring(p)),p=z.createElement("br"),B.length||(B=z.createTextNode("\u00a0")),I.length?A.place(I,l,"after"):I=l,A.place(p,I,"after"),A.place(B,p,"after"),A.destroy(l)):(0<=h.startOffset&&(r=l.childNodes[h.startOffset]),p=z.createElement("br"),B=z.createTextNode("\u00a0"),r?(A.place(p,r,"before"),A.place(B,p,"after")):(l.appendChild(p),l.appendChild(B))),h=e.create(this.editor.window),h.setStart(B,0),h.setEnd(B,
B.length),g.removeAllRanges(),g.addRange(h),this.editor.selection.collapse(!0)):a.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var E=!0;g=e.getSelection(this.editor.window);h=g.getRangeAt(0);h.collapsed||(h.deleteContents(),g=e.getSelection(this.editor.window),h=g.getRangeAt(0));r=e.getBlockAncestor(h.endContainer,null,this.editor.editNode);var J=r.blockNode;if(this._checkListLater=J&&("LI"==J.nodeName||"LI"==J.parentNode.nodeName))return b("mozilla")&&(this._pressedEnterInBlock=
J),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(J.innerHTML)&&(J.innerHTML="",b("webkit")&&(h=e.create(this.editor.window),h.setStart(J,0),g.removeAllRanges(),g.addRange(h)),this._checkListLater=!1),!0;if(!r.blockNode||r.blockNode===this.editor.editNode){try{a.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(F){}r={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(r.blockNode){if(r.blockNode!=this.editor.editNode&&!(r.blockNode.textContent||r.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(r.blockNode),!1}else r.blockNode=this.editor.editNode;g=e.getSelection(this.editor.window);h=g.getRangeAt(0)}J=z.createElement(this.blockNodeForEnter);J.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(r.blockNode);B=h.endOffset;E=h.endContainer;E.length<B&&(B=this._adjustNodeAndOffset(E,B),E=
B.node,B=B.offset);if(e.atEndOfContainer(r.blockNode,E,B))r.blockNode===r.blockContainer?r.blockNode.appendChild(J):A.place(J,r.blockNode,"after"),E=!1,h=e.create(this.editor.window),h.setStart(J,0),g.removeAllRanges(),g.addRange(h),this.editor.height&&d.scrollIntoView(J);else if(e.atBeginningOfContainer(r.blockNode,h.startContainer,h.startOffset))A.place(J,r.blockNode,r.blockNode===r.blockContainer?"first":"before"),J.nextSibling&&this.editor.height&&(h=e.create(this.editor.window),h.setStart(J.nextSibling,
0),g.removeAllRanges(),g.addRange(h),d.scrollIntoView(J.nextSibling)),E=!1;else{r.blockNode===r.blockContainer?r.blockNode.appendChild(J):A.place(J,r.blockNode,"after");E=!1;r.blockNode.style&&J.style&&r.blockNode.style.cssText&&(J.style.cssText=r.blockNode.style.cssText);if((l=h.startContainer)&&3==l.nodeType){B=h.endOffset;l.length<B&&(B=this._adjustNodeAndOffset(l,B),l=B.node,B=B.offset);G=l.nodeValue;I=z.createTextNode(G.substring(0,B));B=z.createTextNode(G.substring(B,G.length));A.place(I,l,
"before");A.place(B,l,"after");A.destroy(l);for(h=I.parentNode;h!==r.blockNode;){G=z.createElement(h.tagName);h.style&&G.style&&h.style.cssText&&(G.style.cssText=h.style.cssText);"FONT"===h.tagName&&(h.color&&(G.color=h.color),h.face&&(G.face=h.face),h.size&&(G.size=h.size));for(;B;)l=B.nextSibling,G.appendChild(B),B=l;A.place(G,h,"after");I=h;B=G;h=h.parentNode}if(1==B.nodeType||3==B.nodeType&&B.nodeValue)J.innerHTML="";for(I=B;B;)l=B.nextSibling,J.appendChild(B),B=l}h=e.create(this.editor.window);
z=I;if("BR"!==this.blockNodeForEnter){for(;z;)p=z,z=l=z.firstChild;p&&p.parentNode?(J=p.parentNode,h.setStart(J,0),g.removeAllRanges(),g.addRange(h),this.editor.height&&d.scrollIntoView(J),b("mozilla")&&(this._pressedEnterInBlock=r.blockNode)):E=!0}else h.setStart(J,0),g.removeAllRanges(),g.addRange(h),this.editor.height&&d.scrollIntoView(J),b("mozilla")&&(this._pressedEnterInBlock=r.blockNode)}return E},_adjustNodeAndOffset:function(g,p){for(;g.length<p&&g.nextSibling&&3==g.nextSibling.nodeType;)p-=
g.length,g=g.nextSibling;return{node:g,offset:p}},removeTrailingBr:function(g){if(g=/P|DIV|LI/i.test(g.tagName)?g:this.editor.selection.getParentOfType(g,["P","DIV","LI"]))g.lastChild&&(1<g.childNodes.length&&3==g.lastChild.nodeType&&/^[\s\xAD]*$/.test(g.lastChild.nodeValue)||"BR"==g.lastChild.tagName)&&A.destroy(g.lastChild),g.childNodes.length||(g.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l,h,r,G,I,B,E,J,F,y,x,w,n,q,H){var K=C("dijit._editor.RichText",[F,y],{constructor:function(m){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};m&&p.isString(m.value)&&(this.value=m.value);this.onLoadDeferred=new t},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[p.trim,p.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);r("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));r("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(r("ie")||r("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[p.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[p.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);I.publish(H._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var m=p.hitch(this,function(M,L){return function(){return!this.execCommand(M,L)}}),u={b:m("bold"),i:m("italic"),u:m("underline"),a:m("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:m("formatblock",
"h1"),2:m("formatblock","h2"),3:m("formatblock","h3"),4:m("formatblock","h4"),"\\":m("insertunorderedlist")};r("ie")||(u.Z=m("redo"));for(var D in u)this.addKeyHandler(D,!0,!1,u[D])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(K._editorCommandsLocalized)this._local2NativeFormatNames=K._local2NativeFormatNames,this._native2LocalFormatNames=K._native2LocalFormatNames;else{K._editorCommandsLocalized=!0;K._local2NativeFormatNames={};
K._native2LocalFormatNames={};this._local2NativeFormatNames=K._local2NativeFormatNames;this._native2LocalFormatNames=K._native2LocalFormatNames;for(var m="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),u="",D,M=0;D=m[M++];)u="l"!==D.charAt(1)?u+("\x3c"+D+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+D+"\x3e\x3cbr/\x3e"):u+("\x3c"+D+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+D+"\x3e\x3cbr/\x3e");var L=d.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:u});this.ownerDocumentBody.appendChild(L);
m=p.hitch(this,function(){for(var N=L.firstChild;N;)try{this.selection.selectElement(N.firstChild);var O=N.tagName.toLowerCase();this._local2NativeFormatNames[O]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[O]]=O;N=N.nextSibling.nextSibling}catch(Q){}d.destroy(L)});this.defer(m)}},open:function(m){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new t;this.isClosed||this.close();I.publish(H._scopeName+"._editor.RichText::open",
this);1===arguments.length&&m.nodeName&&(this.domNode=m);var u=this.domNode;if(p.isString(this.value)){var D=this.value;u.innerHTML=""}else if(u.nodeName&&"textarea"==u.nodeName.toLowerCase()){var M=this.textarea=u;this.name=M.name;D=M.value;u=this.domNode=this.ownerDocument.createElement("div");u.setAttribute("widgetId",this.id);M.removeAttribute("widgetId");u.cssText=M.cssText;u.className+=" "+M.className;d.place(u,M,"before");var L=p.hitch(this,function(){a.set(M,{display:"block",position:"absolute",
top:"-1000px"});if(r("ie")){var P=M.style;this.__overflow=P.overflow;P.overflow="hidden"}});r("ie")?this.defer(L,10):L();if(M.form){var N=M.value;this.reset=function(){this.getValue()!==N&&this.replaceValue(N)};z(M.form,"submit",p.hitch(this,function(){b.set(M,"disabled",this.disabled);M.value=this.getValue()}))}}else D=n.getChildrenHtml(u),u.innerHTML="";this.value=D;u.nodeName&&"LI"===u.nodeName&&(u.innerHTML=" \x3cbr\x3e");this.header=u.ownerDocument.createElement("div");u.appendChild(this.header);
this.editingArea=u.ownerDocument.createElement("div");u.appendChild(this.editingArea);this.footer=u.ownerDocument.createElement("div");u.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!A.useXDomain||A.allowXdRichTextSave)){if((D=k.byId(H._scopeName+"._editor.RichText.value"))&&""!==D.value){L=D.value.split(this._SEPARATOR);for(var O=0,Q;Q=L[O++];)if(Q=Q.split(this._NAME_CONTENT_SEP),Q[0]===this.name){this.value=Q[1];L=L.splice(O,1);D.value=L.join(this._SEPARATOR);
break}}K._globalSaveHandler||(K._globalSaveHandler={},B.addOnUnload(function(){for(var P in K._globalSaveHandler){var S=K._globalSaveHandler[P];p.isFunction(S)&&S()}}));K._globalSaveHandler[this.id]=p.hitch(this,"_saveContent")}this.isClosed=!1;D=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");D.id=this.id+"_iframe";D.style.border="none";D.style.width="100%";this._layoutMode?D.style.height="100%":7<=r("ie")?(this.height&&(D.style.height=this.height),this.minHeight&&(D.style.minHeight=
this.minHeight)):D.style.height=this.height?this.height:this.minHeight;D.frameBorder=0;D._loadFunc=p.hitch(this,function(P){this.window=P;this.document=P.document;this.selection=new x.SelectionManager(P);r("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});L=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");L=11>r("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+L+"');document.close()":"javascript: '"+
L+"'";this.editingArea.appendChild(D);D.src=L;"LI"===u.nodeName&&(u.lastChild.style.marginTop="-1.2em");f.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var m=a.getComputedStyle(this.domNode);if(this["aria-label"])var u=this["aria-label"];else{var D=l('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||k.byId(this["aria-labelledby"],this.ownerDocument);D&&(u=D.textContent||D.innerHTML||"")}D="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(u?" aria-label\x3d'"+G.escape(u)+"'":"")+"\x3e\x3c/div\x3e";var M=[m.fontWeight,m.fontSize,m.fontFamily].join(" "),L=m.lineHeight;L=0<=L.indexOf("px")?parseFloat(L)/parseFloat(m.fontSize):0<=L.indexOf("em")?parseFloat(L):"normal";var N="",O=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(Q){Q=Q.replace(/^;/ig,"")+";";var P=Q.split(":")[0];if(P){P=p.trim(P);P=P.toLowerCase();var S,R="";for(S=0;S<P.length;S++){var T=P.charAt(S);switch(T){case "-":S++,T=P.charAt(S).toUpperCase();default:R+=
T}}a.set(O.domNode,R,"")}N+=Q+";"});this.iframe.setAttribute("title",u);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||e.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",u?"\x3ctitle\x3e"+G.escape(u)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",M,";\n",this.height||r("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",L,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",r("ie")||r("trident")||r("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",u?" aria-label\x3d'"+G.escape(u)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+N+"'\x3e",D,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var m=[];this.styleSheets&&(m=this.styleSheets.split(";"),this.styleSheets=
"");m=m.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var u="",D=0,M,L=J.get(this.ownerDocument);M=m[D++];)M=(new E(L.location,M)).toString(),this.editingAreaStyleSheets.push(M),u+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+M+'"/\x3e';return u},addStyleSheet:function(m){var u=m.toString(),D=J.get(this.ownerDocument);if("."===u.charAt(0)||"/"!==u.charAt(0)&&!m.host)u=(new E(D.location,u)).toString();-1<v.indexOf(this.editingAreaStyleSheets,u)||(this.editingAreaStyleSheets.push(u),
this.onLoadDeferred.then(p.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(u);else{var M=this.document.getElementsByTagName("head")[0],L=this.document.createElement("link");L.rel="stylesheet";L.type="text/css";L.href=u;M.appendChild(L)}})))},removeStyleSheet:function(m){var u=m.toString(),D=J.get(this.ownerDocument);if("."===u.charAt(0)||"/"!==u.charAt(0)&&!m.host)u=(new E(D.location,u)).toString();m=v.indexOf(this.editingAreaStyleSheets,u);-1!==m&&(delete this.editingAreaStyleSheets[m],
l('link[href\x3d"'+u+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(m){m=!!m;this._set("disabled",m);if(this.isLoaded){var u=r("ie")&&(this.isLoaded||!this.focusOnLoad);u&&(this.editNode.unselectable="on");this.editNode.contentEditable=!m;this.editNode.tabIndex=m?"-1":this.tabIndex;u&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(r("mozilla")&&!m&&this._mozSettingProps){m=this._mozSettingProps;for(var D in m)if(m.hasOwnProperty(D))try{this.document.execCommand(D,
!1,m[D])}catch(M){}}this._disabledOK=!0}},onLoad:function(m){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=q.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var u=this;this.beforeIframeNode=d.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=d.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){u.editNode.focus()};this.focusNode=
this.editNode;var D=this.events.concat(this.captureEvents),M=this.iframe?this.document:this.editNode;this.own.apply(this,v.map(D,function(L){var N=L.toLowerCase().replace(/^on/,"");return z(M,N,p.hitch(this,L))},this));this.own(z(M,"mouseup",p.hitch(this,"onClick")));r("ie")&&(this.own(z(this.document,"mousedown",p.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);r("webkit")&&(this._webkitListener=this.own(z(this.document,"mouseup",p.hitch(this,"onDisplayChanged")))[0],this.own(z(this.document,
"mousedown",p.hitch(this,function(L){L=L.target;!L||L!==this.document.body&&L!==this.document||this.defer("placeCursorAtEnd")}))));if(r("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(L){}this.isLoaded=!0;this.set("disabled",this.disabled);D=p.hitch(this,function(){this.setValue(m);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&h(p.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(D):D()},onKeyDown:function(m){if(m.keyCode===g.SHIFT||m.keyCode===g.ALT||m.keyCode===g.META||m.keyCode===g.CTRL)return!0;m.keyCode===g.TAB&&this.isTabIndent&&(m.stopPropagation(),m.preventDefault(),this.queryCommandEnabled(m.shiftKey?"outdent":"indent")&&this.execCommand(m.shiftKey?"outdent":"indent"));if(m.keyCode==g.TAB&&!this.isTabIndent&&!m.ctrlKey&&!m.altKey)return m.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>r("ie")&&m.keyCode===g.BACKSPACE&&"Control"===this.document.selection.type&&(m.stopPropagation(),m.preventDefault(),this.execCommand("delete"));r("ff")&&(m.keyCode===g.PAGE_UP||m.keyCode===g.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&m.preventDefault();var u=this._keyHandlers[m.keyCode],D=arguments;u&&!m.altKey&&v.some(u,function(M){if(!(M.shift^m.shiftKey||M.ctrl^(m.ctrlKey||m.metaKey)))return M.handler.apply(this,D)||m.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(m){e.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",m)},_setValueAttr:function(m){this.setValue(m)},_setDisableSpellCheckAttr:function(m){this.document?b.set(this.document.body,"spellcheck",!m):this.onLoadDeferred.then(p.hitch(this,function(){b.set(this.document.body,"spellcheck",!m)}));this._set("disableSpellCheck",m)},addKeyHandler:function(m,u,D,M){"string"==
typeof m&&(m=m.toUpperCase().charCodeAt(0));p.isArray(this._keyHandlers[m])||(this._keyHandlers[m]=[]);this._keyHandlers[m].push({shift:D||!1,ctrl:u||!1,handler:M})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(m){this.onDisplayChanged(m)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(m){(r("ie")||r("trident"))&&this.defer(function(){q.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var u=this.getValue(!0);if(u!==this.value)this.onChange(u);
this._set("value",u)},_onFocus:function(m){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!r("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>r("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(m,u){m=m.toLowerCase();"formatblock"===m?r("safari")&&void 0===u&&(m="heading"):"hilitecolor"!==m||r("mozilla")||(m="backcolor");return m},_implCommand:function(m){return"_"+this._normalizeCommand(m)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(m){var u=this._qcaCache[m];return void 0!==u?u:this._qcaCache[m]=this._queryCommandAvailable(m)},_queryCommandAvailable:function(m){switch(m.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return r("ie")||r("trident")||r("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!r("webkit");default:return!1}},execCommand:function(m,u){this.focused&&this.focus();m=this._normalizeCommand(m,u);if(void 0!==u){if("heading"===m)throw Error("unimplemented");"formatblock"===
m&&(r("ie")||r("trident"))&&(u="\x3c"+u+"\x3e")}var D="_"+m+"Impl";if(this[D])var M=this[D](u);else if((u=1<arguments.length?u:null)||"createlink"!==m)M=this.document.execCommand(m,!1,u);this.onDisplayChanged();return M},queryCommandEnabled:function(m){if(this.disabled||!this._disabledOK)return!1;m=this._normalizeCommand(m);var u=this._implCommand(m);return this[u]?this[u](m):this._browserQueryCommandEnabled(m)},queryCommandState:function(m){if(this.disabled||!this._disabledOK)return!1;m=this._normalizeCommand(m);
try{return this.document.queryCommandState(m)}catch(u){return!1}},queryCommandValue:function(m){if(this.disabled||!this._disabledOK)return!1;m=this._normalizeCommand(m);if(r("ie")&&"formatblock"===m)m=this._native2LocalFormatNames[this.document.queryCommandValue(m)];else if(r("mozilla")&&"hilitecolor"===m){try{var u=this.document.queryCommandValue("styleWithCSS")}catch(D){u=!1}this.document.execCommand("styleWithCSS",!1,!0);m=this.document.queryCommandValue(m);this.document.execCommand("styleWithCSS",
!1,u)}else m=this.document.queryCommandValue(m);return m},_sCall:function(m,u){return this.selection[m].apply(this.selection,u)},placeCursorAtStart:function(){this.focus();var m=!1;if(r("mozilla"))for(var u=this.editNode.firstChild;u;){if(3===u.nodeType){if(0<u.nodeValue.replace(/^\s+|\s+$/g,"").length){m=!0;this.selection.selectElement(u);break}}else if(1===u.nodeType){m=!0;var D=u.tagName?u.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(D)?this.selection.selectElement(u):
this.selection.selectElementChildren(u);break}u=u.nextSibling}else m=!0,this.selection.selectElementChildren(this.editNode);m&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var m=!1;if(r("mozilla"))for(var u=this.editNode.lastChild;u;){if(3===u.nodeType){if(0<u.nodeValue.replace(/^\s+|\s+$/g,"").length){m=!0;this.selection.selectElement(u);break}}else if(1===u.nodeType){m=!0;this.selection.selectElement(u.lastChild||u);break}u=u.previousSibling}else m=!0,this.selection.selectElementChildren(this.editNode);
m&&this.selection.collapse(!1)},getValue:function(m){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,m):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(m){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){m=this._preFilterContent(m);var u=this.isClosed?this.domNode:this.editNode;u.innerHTML=m;this._preDomFilterContent(u)}else this.textarea.value=m;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(p.hitch(this,function(){this.setValue(m)}))},replaceValue:function(m){this.isClosed?this.setValue(m):this.window&&this.window.getSelection&&!r("mozilla")?this.setValue(m):this.window&&this.window.getSelection?(m=this._preFilterContent(m),this.execCommand("selectall"),this.execCommand("inserthtml",m),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(m);this._set("value",this.getValue(!0))},_preFilterContent:function(m){var u=
m;v.forEach(this.contentPreFilters,function(D){D&&(u=D(u))});return u},_preDomFilterContent:function(m){m=m||this.editNode;v.forEach(this.contentDomPreFilters,function(u){u&&p.isFunction(u)&&u(m)},this)},_postFilterContent:function(m,u){if(p.isString(m))var D=m;else m=m||this.editNode,this.contentDomPostFilters.length&&(u&&(m=p.clone(m)),v.forEach(this.contentDomPostFilters,function(M){m=M(m)})),D=n.getChildrenHtml(m);p.trim(D.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(D="");v.forEach(this.contentPostFilters,
function(M){D=M(D)});return D},_saveContent:function(){var m=k.byId(H._scopeName+"._editor.RichText.value");m&&(m.value&&(m.value+=this._SEPARATOR),m.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(m,u){m=m.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");u||(m=m.replace(/'/gm,"\x26#39;"));return m},getNodeHtml:function(m){e.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return n.getNodeHtml(m)},getNodeChildrenHtml:function(m){e.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return n.getChildrenHtml(m)},close:function(m){if(!this.isClosed){arguments.length||(m=!0);m&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);r("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var u=this.textarea.style;u.position="";u.left=u.top="";r("ie")&&(u.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;d.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;f.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);K._globalSaveHandler&&delete K._globalSaveHandler[this.id]},_removeMozBogus:function(m){return m.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(m){m=m.replace(/\sclass="webkit-block-placeholder"/gi,"");m=m.replace(/\sclass="apple-style-span"/gi,
"");return m=m.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(m){return m.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(m){return m.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(m){if(!m)return!1;
if(r("ie")||r("trident")||r("edge"))return this.focused&&!this.disabled;var u=9>r("ie")?this.document.selection.createRange():this.document;try{return u.queryCommandEnabled(m)}catch(D){return!1}},_createlinkEnabledImpl:function(){var m=!0;return m=r("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var m=!0;return m=r("mozilla")||r("webkit")||r("ie")||r("trident")||r("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var m=!0;return m=r("mozilla")||r("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var m=!0;r("webkit")?((m=this.window.getSelection())&&(m=m.toString()),m=!!m):m=this._browserQueryCommandEnabled("cut");return m},_copyEnabledImpl:function(){var m=!0;r("webkit")?((m=this.window.getSelection())&&(m=m.toString()),m=!!m):m=this._browserQueryCommandEnabled("copy");
return m},_pasteEnabledImpl:function(){var m=!0;return r("webkit")?!0:m=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(m){return r("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,m)},_unlinkImpl:function(m){return this.queryCommandEnabled("unlink")&&(r("mozilla")||r("webkit"))?(m=this.selection.getAncestorElement("a"),this.selection.selectElement(m),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,m)},_hilitecolorImpl:function(m){if(!this._handleTextColorOrProperties("hilitecolor",m))if(r("mozilla")){this.document.execCommand("styleWithCSS",!1,!0);console.log("Executing color command.");var u=this.document.execCommand("hilitecolor",!1,m);this.document.execCommand("styleWithCSS",!1,!1)}else u=this.document.execCommand("hilitecolor",!1,m);return u},_backcolorImpl:function(m){r("ie")&&(m=m?m:null);var u=this._handleTextColorOrProperties("backcolor",m);u||(u=this.document.execCommand("backcolor",
!1,m));return u},_forecolorImpl:function(m){r("ie")&&(m=m?m:null);var u=!1;(u=this._handleTextColorOrProperties("forecolor",m))||(u=this.document.execCommand("forecolor",!1,m));return u},_inserthtmlImpl:function(m){m=this._preFilterContent(m);var u=!0;if(9>r("ie")){var D=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var M=D.item(0);D.length;)D.remove(D.item(0));M.outerHTML=m}else D.pasteHTML(m);D.select()}else if(8>r("trident")){var L=w.getSelection(this.window);
if(L&&L.rangeCount&&L.getRangeAt){D=L.getRangeAt(0);D.deleteContents();var N=d.create("div");N.innerHTML=m;for(M=this.document.createDocumentFragment();m=N.firstChild;)var O=M.appendChild(m);D.insertNode(M);O&&(D=D.cloneRange(),D.setStartAfter(O),D.collapse(!1),L.removeAllRanges(),L.addRange(D))}}else r("mozilla")&&!m.length?this.selection.remove():u=this.document.execCommand("inserthtml",!1,m);return u},_boldImpl:function(m){var u=!1;if(r("ie")||r("trident"))this._adaptIESelection(),u=this._adaptIEFormatAreaAndExec("bold");
u||(u=this.document.execCommand("bold",!1,m));return u},_italicImpl:function(m){var u=!1;if(r("ie")||r("trident"))this._adaptIESelection(),u=this._adaptIEFormatAreaAndExec("italic");u||(u=this.document.execCommand("italic",!1,m));return u},_underlineImpl:function(m){var u=!1;if(r("ie")||r("trident"))this._adaptIESelection(),u=this._adaptIEFormatAreaAndExec("underline");u||(u=this.document.execCommand("underline",!1,m));return u},_strikethroughImpl:function(m){var u=!1;if(r("ie")||r("trident"))this._adaptIESelection(),
u=this._adaptIEFormatAreaAndExec("strikethrough");u||(u=this.document.execCommand("strikethrough",!1,m));return u},_superscriptImpl:function(m){var u=!1;if(r("ie")||r("trident"))this._adaptIESelection(),u=this._adaptIEFormatAreaAndExec("superscript");u||(u=this.document.execCommand("superscript",!1,m));return u},_subscriptImpl:function(m){var u=!1;if(r("ie")||r("trident"))this._adaptIESelection(),u=this._adaptIEFormatAreaAndExec("subscript");u||(u=this.document.execCommand("subscript",!1,m));return u},
_fontnameImpl:function(m){if(r("ie")||r("trident"))var u=this._handleTextColorOrProperties("fontname",m);u||(u=this.document.execCommand("fontname",!1,m));return u},_fontsizeImpl:function(m){if(r("ie")||r("trident"))var u=this._handleTextColorOrProperties("fontsize",m);u||(u=this.document.execCommand("fontsize",!1,m));return u},_insertorderedlistImpl:function(m){var u=!1;if(r("ie")||r("trident")||r("edge"))u=this._adaptIEList("insertorderedlist",m);u||(u=this.document.execCommand("insertorderedlist",
!1,m));return u},_insertunorderedlistImpl:function(m){var u=!1;if(r("ie")||r("trident")||r("edge"))u=this._adaptIEList("insertunorderedlist",m);u||(u=this.document.execCommand("insertunorderedlist",!1,m));return u},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(m){var u=0;if(m&&m.childNodes){var D;for(D=0;D<m.childNodes.length;D++){var M=c.position(m.childNodes[D]);
u+=M.h}}return u},_isNodeEmpty:function(m,u){return 1===m.nodeType?0<m.childNodes.length?this._isNodeEmpty(m.childNodes[0],u):!0:3===m.nodeType?""===m.nodeValue.substring(u):!1},_removeStartingRangeFromRange:function(m,u){if(m.nextSibling)u.setStart(m.nextSibling,0);else{for(m=m.parentNode;m&&null==m.nextSibling;)m=m.parentNode;m&&u.setStart(m.nextSibling,0)}return u},_adaptIESelection:function(){var m=w.getSelection(this.window);if(m&&m.rangeCount&&!m.isCollapsed){for(var u=m.getRangeAt(0),D=u.startContainer,
M=u.startOffset;3===D.nodeType&&M>=D.length&&D.nextSibling;)M-=D.length,D=D.nextSibling;for(var L=null;this._isNodeEmpty(D,M)&&D!==L;)L=D,u=this._removeStartingRangeFromRange(D,u),D=u.startContainer,M=0;m.removeAllRanges();m.addRange(u)}},_adaptIEFormatAreaAndExec:function(m){var u=w.getSelection(this.window),D=this.document,M;if(m&&u&&u.isCollapsed){if(this.queryCommandValue(m)){m=this._tagNamesForCommand(m);var L=u.getRangeAt(0);var N=L.startContainer;if(3===N.nodeType){var O=L.endOffset;N.length<
O&&(O=this._adjustNodeAndOffset(Q,O),N=O.node,O=O.offset)}for(;N&&N!==this.editNode;){var Q=N.tagName?N.tagName.toLowerCase():"";if(-1<v.indexOf(m,Q)){var P=N;break}N=N.parentNode}if(P&&(Q=L.startContainer,m=D.createElement(P.tagName),d.place(m,P,"after"),Q&&3===Q.nodeType)){O=L.endOffset;Q.length<O&&(O=this._adjustNodeAndOffset(Q,O),Q=O.node,O=O.offset);N=Q.nodeValue;L=D.createTextNode(N.substring(0,O));var S=N.substring(O,N.length);S&&(M=D.createTextNode(S));d.place(L,Q,"before");if(M){var R=D.createElement("span");
R.className="ieFormatBreakerSpan";d.place(R,Q,"after");d.place(M,R,"after");M=R}d.destroy(Q);O=L.parentNode;for(Q=[];O!==P;){N=O.tagName;L={tagName:N};Q.push(L);N=D.createElement(N);O.style&&N.style&&O.style.cssText&&(N.style.cssText=O.style.cssText,L.cssText=O.style.cssText);"FONT"===O.tagName&&(O.color&&(N.color=O.color,L.color=O.color),O.face&&(N.face=O.face,L.face=O.face),O.size&&(N.size=O.size,L.size=O.size));O.className&&(N.className=O.className,L.className=O.className);if(M)for(;M;)L=M.nextSibling,
N.appendChild(M),M=L;N.tagName==O.tagName?(R=D.createElement("span"),R.className="ieFormatBreakerSpan",d.place(R,O,"after"),d.place(N,R,"after")):d.place(N,O,"after");L=O;M=N;O=O.parentNode}if(M){if(1===M.nodeType||3===M.nodeType&&M.nodeValue)m.innerHTML="";for(;M;)L=M.nextSibling,m.appendChild(M),M=L}if(Q.length){L=Q.pop();M=D.createElement(L.tagName);L.cssText&&M.style&&(M.style.cssText=L.cssText);L.className&&(M.className=L.className);"FONT"===L.tagName&&(L.color&&(M.color=L.color),L.face&&(M.face=
L.face),L.size&&(M.size=L.size));for(d.place(M,m,"before");Q.length;)L=Q.pop(),P=D.createElement(L.tagName),L.cssText&&P.style&&(P.style.cssText=L.cssText),L.className&&(P.className=L.className),"FONT"===L.tagName&&(L.color&&(P.color=L.color),L.face&&(P.face=L.face),L.size&&(P.size=L.size)),M.appendChild(P),M=P;P=D.createTextNode(".");R.appendChild(P);M.appendChild(P)}else R=D.createElement("span"),R.className="ieFormatBreakerSpan",P=D.createTextNode("."),R.appendChild(P),d.place(R,m,"before");M=
w.create(this.window);M.setStart(P,0);M.setEnd(P,P.length);u.removeAllRanges();u.addRange(M);this.selection.collapse(!1);P.parentNode.innerHTML="";m.firstChild||d.destroy(m);return!0}return!1}L=u.getRangeAt(0);if((Q=L.startContainer)&&3===Q.nodeType)return O=L.startOffset,Q.length<O&&(O=this._adjustNodeAndOffset(Q,O),Q=O.node,O=O.offset),N=Q.nodeValue,L=D.createTextNode(N.substring(0,O)),S=N.substring(O),""!==S&&(M=D.createTextNode(N.substring(O))),R=D.createElement("span"),P=D.createTextNode("."),
R.appendChild(P),L.length?d.place(L,Q,"after"):L=Q,d.place(R,L,"after"),M&&d.place(M,R,"after"),d.destroy(Q),M=w.create(this.window),M.setStart(P,0),M.setEnd(P,P.length),u.removeAllRanges(),u.addRange(M),D.execCommand(m),d.place(R.firstChild,R,"before"),d.destroy(R),M.setStart(P,0),M.setEnd(P,P.length),u.removeAllRanges(),u.addRange(M),this.selection.collapse(!1),P.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(m){var u=w.getSelection(this.window);if(u.isCollapsed&&u.rangeCount&&
!this.queryCommandValue(m)){var D=u.getRangeAt(0),M=D.startContainer;if(M&&3==M.nodeType&&!D.startOffset)return D="ul","insertorderedlist"===m&&(D="ol"),m=this.document.createElement(D),D=d.create("li",null,m),d.place(m,M,"before"),D.appendChild(M),d.create("br",null,m,"after"),m=w.create(this.window),m.setStart(M,0),m.setEnd(M,M.length),u.removeAllRanges(),u.addRange(m),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(m,u){var D=w.getSelection(this.window),M=this.document,
L,N;u=u||null;if(m&&D&&D.isCollapsed&&D.rangeCount){var O=D.getRangeAt(0);if((L=O.startContainer)&&3===L.nodeType){var Q=O.startOffset;L.length<Q&&(O=this._adjustNodeAndOffset(L,Q),L=O.node,Q=O.offset);var P=L.nodeValue;O=M.createTextNode(P.substring(0,Q));""!==P.substring(Q)&&(N=M.createTextNode(P.substring(Q)));P=M.createElement("span");Q=M.createTextNode(".");P.appendChild(Q);M=M.createElement("span");P.appendChild(M);O.length?d.place(O,L,"after"):O=L;d.place(P,O,"after");N&&d.place(N,P,"after");
d.destroy(L);L=w.create(this.window);L.setStart(Q,0);L.setEnd(Q,Q.length);D.removeAllRanges();D.addRange(L);if(r("webkit")){D="color";if("hilitecolor"===m||"backcolor"===m)D="backgroundColor";a.set(P,D,u);this.selection.remove();d.destroy(M);P.innerHTML="\x26#160;";this.selection.selectElement(P);this.focus()}else this.execCommand(m,u),d.place(P.firstChild,P,"before"),d.destroy(P),L.setStart(Q,0),L.setEnd(Q,Q.length),D.removeAllRanges(),D.addRange(L),this.selection.collapse(!1),Q.parentNode.removeChild(Q);
return!0}}return!1},_adjustNodeAndOffset:function(m,u){for(;m.length<u&&m.nextSibling&&3===m.nextSibling.nodeType;)u-=m.length,m=m.nextSibling;return{node:m,offset:u}},_tagNamesForCommand:function(m){return"bold"===m?["b","strong"]:"italic"===m?["i","em"]:"strikethrough"===m?["s","strike"]:"superscript"===m?["sup"]:"subscript"===m?["sub"]:"underline"===m?["u"]:[]},_stripBreakerNodes:function(m){if(this.isLoaded)return l(".ieFormatBreakerSpan",m).forEach(function(u){for(;u.firstChild;)d.place(u.firstChild,
u,"before");d.destroy(u)}),m},_stripTrailingEmptyNodes:function(m){function u(D){return/^(p|div|br)$/i.test(D.nodeName)&&0==D.children.length&&/^[\s\xA0]*$/.test(D.textContent||D.innerText||"")||3===D.nodeType&&/^[\s\xA0]*$/.test(D.nodeValue)}for(;m.lastChild&&u(m.lastChild);)d.destroy(m.lastChild);return m},_setTextDirAttr:function(m){this._set("textDir",m);this.onLoadDeferred.then(p.hitch(this,function(){this.editNode.dir=m}))}});return K})},"dijit/_editor/range":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/lang"],function(v,A,C){var t={getIndex:function(f,d){for(var c=[],a=[],e=f,g,p;f!=d;){var z=0;for(g=f.parentNode;p=g.childNodes[z++];)if(p===f){--z;break}c.unshift(z);a.unshift(z-g.childNodes.length);f=g}if(0<c.length&&3==e.nodeType){for(p=e.previousSibling;p&&3==p.nodeType;)c[c.length-1]--,p=p.previousSibling;for(p=e.nextSibling;p&&3==p.nodeType;)a[a.length-1]++,p=p.nextSibling}return{o:c,r:a}},getNode:function(f,d){if(!C.isArray(f)||0==f.length)return d;var c=d;
v.every(f,function(a){if(0<=a&&a<c.childNodes.length)c=c.childNodes[a];else return c=null,!1;return!0});return c},getCommonAncestor:function(f,d,c){c=c||f.ownerDocument.body;var a=function(p){for(var z=[];p;)if(z.unshift(p),p!==c)p=p.parentNode;else break;return z};f=a(f);d=a(d);a=Math.min(f.length,d.length);for(var e=f[0],g=1;g<a;g++)if(f[g]===d[g])e=f[g];else break;return e},getAncestor:function(f,d,c){for(c=c||f.ownerDocument.body;f&&f!==c;){var a=f.nodeName.toUpperCase();if(d.test(a))return f;
f=f.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(f,d,c){c=c||f.ownerDocument.body;d=d||t.BlockTagNames;for(var a=null,e;f&&f!==c;){var g=f.nodeName.toUpperCase();!a&&d.test(g)&&(a=f);!e&&/^(?:BODY|TD|TH|CAPTION)$/.test(g)&&(e=f);f=f.parentNode}return{blockNode:a,blockContainer:e||f.ownerDocument.body}},atBeginningOfContainer:function(f,d,c){var a=!1,e=0==c;e||3!=d.nodeType||/^[\s\xA0]+$/.test(d.nodeValue.substr(0,c))&&(e=
!0);if(e)for(a=!0;d&&d!==f;){if(d.previousSibling){a=!1;break}d=d.parentNode}return a},atEndOfContainer:function(f,d,c){var a=!1,e=c==(d.length||d.childNodes.length);e||3!=d.nodeType||/^[\s\xA0]+$/.test(d.nodeValue.substr(c))&&(e=!0);if(e)for(a=!0;d&&d!==f;){if(d.nextSibling){a=!1;break}d=d.parentNode}return a},adjacentNoneTextNode:function(f,d){var c=f;f=0-f.length||0;for(d=d?"nextSibling":"previousSibling";c&&3==c.nodeType;)f+=c.length,c=c[d];return[c,f]},create:function(f){f=f||window;return f.getSelection?
f.document.createRange():new b},getSelection:function(f,d){if(f.getSelection)return f.getSelection();f=new k.selection(f);d||f._getCurrentSelection();return f}};if(!window.getSelection)var k=t.ie={cachedSelection:{},selection:function(f){this._ranges=[];this.addRange=function(d,c){this._ranges.push(d);c||d._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(d){return this._ranges[d]};this._getCurrentSelection=function(){this.removeAllRanges();
var d=f.document.selection.createRange();d="CONTROL"==f.document.selection.type.toUpperCase()?new b(k.decomposeControlRange(d)):new b(k.decomposeTextRange(d));this.addRange(d,!0),this.isCollapsed=d.collapsed}},decomposeControlRange:function(f){var d=f.item(0),c=f.item(f.length-1);f=d.parentNode;var a=c.parentNode;d=t.getIndex(d,f).o[0];c=t.getIndex(c,a).o[0]+1;return[f,d,a,c]},getEndPoint:function(f,d){var c=f.duplicate();c.collapse(!d);var a="EndTo"+(d?"End":"Start"),e=c.parentElement(),g;if(0<e.childNodes.length)v.every(e.childNodes,
function(l,h){if(3!=l.nodeType)if(c.moveToElementText(l),0<c.compareEndPoints(a,f))if(g&&3==g.nodeType){p=g;var r=!0}else return p=e,z=h,!1;else{if(h==e.childNodes.length-1)return p=e,z=e.childNodes.length,!1}else h==e.childNodes.length-1&&(p=l,r=!0);if(r&&p)return p=(l=t.adjacentNoneTextNode(p)[0])?l.nextSibling:e.firstChild,h=t.adjacentNoneTextNode(p),l=h[0],h=h[1],l?(c.moveToElementText(l),c.collapse(!1)):c.moveToElementText(e),c.setEndPoint(a,f),z=c.text.length-h,!1;g=l;return!0});else{var p=
e;var z=0}d||1!=p.nodeType||z!=p.childNodes.length||(d=p.nextSibling)&&3==d.nodeType&&(p=d,z=0);return[p,z]},setEndPoint:function(f,d,c){f=f.duplicate();var a;if(3!=d.nodeType)if(0<c){if(a=d.childNodes[c-1])if(3==a.nodeType)d=a,c=a.length;else if(a.nextSibling&&3==a.nextSibling.nodeType)d=a.nextSibling,c=0;else{f.moveToElementText(a.nextSibling?a:d);var e=a.parentNode;a=e.insertBefore(a.ownerDocument.createTextNode(" "),a.nextSibling);f.collapse(!1);e.removeChild(a)}}else f.moveToElementText(d),f.collapse(!0);
3==d.nodeType&&(a=t.adjacentNoneTextNode(d),e=a[0],a=a[1],e?(f.moveToElementText(e),f.collapse(!1),"inherit"!=e.contentEditable&&a++):(f.moveToElementText(d.parentNode),f.collapse(!0),f.move("character",1),f.move("character",-1)),c+=a,0<c&&f.move("character",c)!=c&&console.error("Error when moving!"));return f},decomposeTextRange:function(f){var d=k.getEndPoint(f),c=d[0],a=d[1],e=d[0];d=d[1];f.htmlText.length&&(f.htmlText==f.text?d=a+f.text.length:(d=k.getEndPoint(f,!0),e=d[0],d=d[1]));return[c,a,
e,d]},setRange:function(f,d,c,a,e,g){d=k.setEndPoint(f,d,c);f.setEndPoint("StartToStart",d);if(!g)var p=k.setEndPoint(f,a,e);f.setEndPoint("EndToEnd",p||d);return f}},b=t.W3CRange=A(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=
this.startContainer!==this.endContainer?t.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(f,d){d=parseInt(d);if(this.startContainer!==f||this.startOffset!=d)delete this._cachedBookmark,this.startContainer=f,this.startOffset=d,this.endContainer?this._updateInternal():this.setEnd(f,d)},setEnd:function(f,d){d=parseInt(d);if(this.endContainer!==f||this.endOffset!=d)delete this._cachedBookmark,
this.endContainer=f,this.endOffset=d,this.startContainer?this._updateInternal():this.setStart(f,d)},setStartAfter:function(f,d){this._setPoint("setStart",f,d,1)},setStartBefore:function(f,d){this._setPoint("setStart",f,d,0)},setEndAfter:function(f,d){this._setPoint("setEnd",f,d,1)},setEndBefore:function(f,d){this._setPoint("setEnd",f,d,0)},_setPoint:function(f,d,c,a){c=t.getIndex(d,d.parentNode).o;this[f](d.parentNode,c.pop()+a)},_getIERange:function(){var f=(this._body||this.endContainer.ownerDocument.body).createTextRange();
k.setRange(f,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return f},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var f=this.startContainer,d=this._getIERange();3!==f.nodeType||this.startOffset||this.setStartBefore(f);d.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var f=new b([this.startContainer,
this.startOffset,this.endContainer,this.endOffset]);f._body=this._body;return f},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});C.setObject("dijit.range",t);return t})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(v,A,C){var t={};A.setObject("dijit._editor.html",t);var k=t.escapeXml=function(b,f){b=b.replace(/&/gm,"\x26amp;").replace(/</gm,
"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");f||(b=b.replace(/'/gm,"\x26#39;"));return b};t.getNodeHtml=function(b){var f=[];t.getNodeHtmlHelper(b,f);return f.join("")};t.getNodeHtmlHelper=function(b,f){switch(b.nodeType){case 1:var d=b.nodeName.toLowerCase();if(!d||"/"==d.charAt(0))return"";f.push("\x3c",d);var c=[],a={},e;if(C("dom-attributes-explicit")||C("dom-attributes-specified-flag"))for(var g=0;e=b.attributes[g++];){var p=e.name;"_dj"===p.substr(0,3)||C("dom-attributes-specified-flag")&&
!e.specified||p in a||(e=e.value,("src"==p||"href"==p)&&b.getAttribute("_djrealurl")&&(e=b.getAttribute("_djrealurl")),8===C("ie")&&"style"===p&&(e=e.replace("HEIGHT:","height:").replace("WIDTH:","width:")),c.push([p,e]),a[p]=e)}else{var z=(/^input$|^img$/i.test(b.nodeName)?b:b.cloneNode(!1)).outerHTML;a=z.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);z=z.substr(0,z.indexOf("\x3e"));v.forEach(a,function(l){if(l){var h=l.indexOf("\x3d");if(0<h&&(l=l.substring(0,h),"_dj"!=l.substr(0,3)))if("src"!=l&&"href"!=
l||!b.getAttribute("_djrealurl")){switch(l){case "style":var r=b.style.cssText.toLowerCase();break;case "class":r=b.className;break;case "width":if("img"===d){(h=/width=(\S+)/i.exec(z))&&(r=h[1]);break}case "height":if("img"===d){(h=/height=(\S+)/i.exec(z))&&(r=h[1]);break}default:r=b.getAttribute(l)}null!=r&&c.push([l,r.toString()])}else c.push([l,b.getAttribute("_djrealurl")])}},this)}c.sort(function(l,h){return l[0]<h[0]?-1:l[0]==h[0]?0:1});for(a=0;e=c[a++];)f.push(" ",e[0],'\x3d"',"string"===
typeof e[1]?k(e[1],!0):e[1],'"');switch(d){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":f.push(" /\x3e");break;case "script":f.push("\x3e",b.innerHTML,"\x3c/",d,"\x3e");break;default:f.push("\x3e"),b.hasChildNodes()&&t.getChildrenHtmlHelper(b,f),f.push("\x3c/",d,"\x3e")}break;case 4:case 3:f.push(k(b.nodeValue,!0));break;case 8:f.push("\x3c!--",k(b.nodeValue,!0),"--\x3e");break;default:f.push("\x3c!-- Element not recognized - Type: ",b.nodeType," Name: ",
b.nodeName,"--\x3e")}};t.getChildrenHtml=function(b){var f=[];t.getChildrenHtmlHelper(b,f);return f.join("")};t.getChildrenHtmlHelper=function(b,f){if(b)for(var d=b.childNodes||b,c=!C("ie")||d!==b,a,e=0;a=d[e++];)c&&a.parentNode!=b||t.getNodeHtmlHelper(a,f)};return t})},"esri/dijit/geoenrichment/SelectableTree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented ./when dojo/store/util/QueryResults dojo/store/util/SimpleQueryEngine dstore/QueryResults".split(" "),function(v,
A,C,t,k,b,f,d){var c=function(a,e){this.storage=a;this.data=e};c.prototype={storage:null,data:null,filter:function(a){return this.storage._filter(this.data,a)},sort:function(a,e){return this.storage._sort(this.data,a,e)},fetch:function(){return this.storage._fetchRange(this.data)},fetchRange:function(a){return this.storage._fetchRange(this.data,a)},mayHaveChildren:function(a){return this.storage.mayHaveChildren(a)},getChildren:function(a){return this.storage.getChildren(a,{returnCollection:!0})}};
return v(t,{idProperty:"id",bindingProperty:null,autoIdentify:!0,queryEngine:f,isDstoreTree:!1,root:null,data:null,_hash:null,_autoId:null,storage:null,constructor:function(a,e){A.mixin(this,e);this.storage=this;this.root={children:a||[]};A.mixin(this._provideBinding(this.root),{deepness:-1,selectCount:0,leafCount:0});this._hash={};this.idProperty&&this.autoIdentify&&(this._autoId=1);this._initializeNode(this.root,0);this.data=this.root.children},_provideBinding:function(a){var e=this._getBinding(a);
e||(a[this.bindingProperty]=e={});return e},_getBinding:function(a){return this.bindingProperty?a[this.bindingProperty]:a},_initializeNode:function(a,e){var g=this._provideBinding(a);g.selected=!!g.selected;a.children?(g.selectCount=0,g.leafCount=0,C.forEach(a.children,function(p){this._registerNode(p);var z=this._provideBinding(p);z.parent=a;z.deepness=e;this._initializeNode(p,e+1);g.selectCount+=z.selectCount;g.leafCount+=z.leafCount},this),g.selectCount)?g.selectCount===g.leafCount&&(g.selected=
!0):g.selected=!1:("number"!==typeof g.leafCount&&(g.leafCount=1),g.selectCount=g.selected?g.leafCount:0)},isOwned:function(a,e){return e||a!==this.root?this.get(this.getIdentity(a))===a:!0},_registerNode:function(a){this._autoId&&void 0===a[this.idProperty]&&(a[this.idProperty]=this._autoId++);this.idProperty&&(this._hash[a[this.idProperty]]=a)},_unregisterNode:function(a){this.isOwned(a,!0)&&delete this._hash[a[this.idProperty]]},clear:function(){this.root.children.length&&(C.forEach(this.root.children,
function(a){this._unbindNode(a)},this),this.data=this.root.children=[])},destroy:function(){this.clear()},_unbindNode:function(a){a.children&&C.forEach(a.children,function(g){delete this._getBinding(g).parent;this._unbindNode(g)},this);this._unregisterNode(a);var e=this._getBinding(a);e.parent&&(this._incrementCounts(e.parent,-e.selectCount,-e.leafCount),delete e.parent);e!==a&&delete a[this.bindingProperty]},removeNodes:function(a,e){C.forEach(a&&a.slice(),function(g){if(this.isOwned(g,!0)){var p=
this._getBinding(g).parent,z=C.indexOf(p.children,g);0<=z&&p.children.splice(z,1);this._unbindNode(g)}},this);!e&&this.emit("updated")},addNodes:function(a,e,g){if(!e)e=this.root;else if(!this.isOwned(e)||!e.children)return!1;var p=this._getBinding(e).deepness+1,z=0,l=0;C.forEach(a,function(h){if(!this.isOwned(h)){e.children.push(h);this._registerNode(h);var r=this._provideBinding(h);r.parent=e;r.deepness=p;this._initializeNode(h,p+1);z+=r.selectCount;l+=r.leafCount}},this);this._incrementCounts(e,
z,l);!g&&this.emit("updated");return!0},select:function(a,e){return this.changeSelect(a,!0,e)},deselect:function(a){this.changeSelect(a,!1)},changeSelect:function(a,e,g){g=g||this.root.leafCount;var p=a&&this._getBinding(a);if(p){e=!!e;var z=(e?p.leafCount:0)-p.selectCount,l=0>z||this.root.selectCount+z<=g;if(!a.children)return l&&(p.selected=e,z&&this._incrementCounts(a,z)),l;l&&(p.selected=e);C.forEach(a.children,function(h){this.changeSelect(h,e,g)},this);return l}},_incrementCounts:function(a,
e,g){a=this._getBinding(a);a.selectCount+=e;g&&(a.leafCount+=g);a.selectCount?a.selectCount==a.leafCount&&(a.selected=!0):a.selected=!1;a.parent&&this._incrementCounts(a.parent,e,g)},getSelectionState:function(a){if(!this.isOwned(a))return!1;a=this._getBinding(a);return a.selectCount&&a.selectCount!=a.leafCount?"mixed":a.selected=!!a.selectCount},getSelectedNodes:function(a){return this.getDescendingNodes(this.root,!0,a)},getDescendingNodes:function(a,e,g){if(!this.isOwned(a))return[];var p=[];this._collectNodes(a.children,
p,e,g);return p},_collectNodes:function(a,e,g,p){C.forEach(a,function(z){var l=this._getBinding(z),h=null===g||void 0===g?l.leafCount:g?l.selectCount:l.leafCount-l.selectCount;h&&(!z.children||!p&&h==l.leafCount?e.push(z):this._collectNodes(z.children,e,g,p))},this)},inspectChildren:function(a,e,g,p){p&&(e=A.hitch(p,e));a=a||this.root;(a=a.children)&&g&&(a=a.slice(),a.sort(g));return C.every(a,function(z){var l=e(z);return null===l?!1:!1!==l&&z.children?this.inspectChildren(z,e,g):!0},this)},updateExpandedNodes:function(a,
e){for(var g in this._hash)this.updateExpand(this._hash[g],!!a[g]);this._updateOddEven(null,e)},updateExpand:function(a,e,g,p){if(a){var z=!1;a.children&&(a=this._getBinding(a),a.expanded!==e&&(z=!0,a.expanded=e));e={};z&&g&&this._updateOddEven(e,p);return e}},_updateOddEven:function(a,e){var g=1;this.inspectChildren(null,function(p){!1!==p.visible&&(g=1-g);var z=this._getBinding(p);a&&z.isOdd!==g&&(a[this.getIdentity(p)]=g);z.isOdd=g;return!(!p.children||!z.expanded)},e,this)},isOdd:function(a){return(a=
this._getBinding(a))&&a.isOdd},get:function(a){return this._hash[a]},getIdentity:function(a){return this.idProperty?a[this.idProperty]:null},query:function(a,e){return b(this._query(this.data,a,e))},_query:function(a,e,g){return this.queryEngine(e,g)(a)},filter:function(a){return this._filter(this.data,a)},_filter:function(a,e){a=this._query(a,e);return new c(this.storage,a)},sort:function(a,e){return this._sort(this.data,a,e)},_sort:function(a,e,g){"function"===typeof e?(a=a.slice(),a.sort(e)):(e=
Array.isArray(e)?e.map(function(p){return{attribute:p.property,descending:p.descending}}):[{attribute:e,descending:g}],a=this._query(a,{},{sort:e}));return new c(this.storage,a)},mayHaveChildren:function(a){return!!a.children},getChildren:function(a,e){var g=this.isOwned(a,!0)?a.children:null;a=this.isDstoreTree||e&&e.returnCollection;e=this.queryEngine({},a?null:e)(g||[]);return a?new c(this.storage,e):b(e)},fetch:function(){return this._fetchRange(this.data)},fetchRange:function(a){return this._fetchRange(this.data,
a)},_fetchRange:function(a,e){return d(k(e?a.slice(e.start,e.end):a.slice()),{totalLength:k(a.length)})}})})},"esri/dijit/geoenrichment/when":function(){define(["dojo/when"],function(v){return v})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(v,A){function C(t,k){return A(this,function(b){for(var f=0,d=b.length;f<d;f++)t.call(k,b[f],f,b)})}return function(t,k){var b=k&&"totalLength"in k;if(t.then){t=v.delegate(t);var f=t.then(function(d){var c=b?k.totalLength:d.totalLength||
d.length;d.totalLength=c;return!b&&c});t.totalLength=b?k.totalLength:f;t.response=k&&k.response}else t.totalLength=b?k.totalLength:t.length;t.forEach=C;return t}})},"widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid":function(){define("dojo/_base/declare dojo/aspect dojo/Evented dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on dojo/query dijit/Tooltip dijit/_WidgetBase ../../dijit/_TemplatedMixin dgrid/OnDemandGrid dgrid/tree esri/dijit/geoenrichment/utils/KeyboardUtil esri/dijit/geoenrichment/TriStateItem ../../dijit/utils/DgridUtil ../../dijit/utils/DomUtil ../../dijit/utils/MouseUtil ../../dijit/tooltips/TooltipUtil dojo/text!./templates/SelectableTreeGrid.html xstyle/css!./css/SelectableTreeGrid.css".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l,h,r,G,I,B){var E=v(null,{_selectedRowInfos:null,_lastSelectedRowInfo:null,_outsideHandler:null,_isSelectionFrozen:!1,keepSelectionOnOutsideClick:!1,_previouslySelectedRowsByNode:null,constructor:function(){this._previouslySelectedRowsByNode=new WeakMap},buildRendering:function F(){this._selectedRowInfos={};this.inherited(F,arguments)},postCreate:function y(){this.inherited(y,arguments);t.add(this.domNode,"esriMapsAnalystXNonSelectable")},_reselectSingleNode:function(y){this.selectSingleRow(this._previouslySelectedRowsByNode.get(y),
y)},selectSingleRow:function(y,x){this.unselectAllRows();this._selectRow(y,x)},_selectRow:function(y,x){t.add(y,this.selectedRowClass);t.add(y,"row-level-"+this._getNodeLevel(x));var w=this.tree.getIdentity(x),n={row:y,node:x,nodeId:w,index:x.parent&&x.parent.children.indexOf(x)};this._lastSelectedRowInfo=this._selectedRowInfos[w]=n;this._previouslySelectedRowsByNode.set(x,y);var q=this;this._outsideHandler=this._outsideHandler||f(document.body,"click",function(){G.isMouseOver(q.domNode)||q._isSelectionFrozen||
q.keepSelectionOnOutsideClick||q.unselectAllRows()})},_unselectRow:function(y,x){delete this._selectedRowInfos[this.tree.getIdentity(x)];t.remove(y,this.selectedRowClass)},unselectAllRows:function(){for(var y in this._selectedRowInfos)t.remove(this._selectedRowInfos[y].row,this.selectedRowClass);this._selectedRowInfos={};this._lastSelectedRowInfo=null;this._outsideHandler&&this._outsideHandler.remove();this._outsideHandler=null},getSelectedRowNodes:function(){return this._getSelectedNodesRows().nodes},
selectRowNodes:function(y){var x=this;y&&y.forEach(function(w){var n=x.grid.row(w);n&&n.element&&x._selectRow(n.element,w)})},freezeRowSelection:function(){this._isSelectionFrozen=!0},unfreezeRowSelection:function(){this._isSelectionFrozen=!1},_getSelectedNodesRows:function(){var y=[],x=[],w=[],n;for(n in this._selectedRowInfos)w.push(this._selectedRowInfos[n]);w.sort(function(q,H){return q.index-H.index});w.forEach(function(q){y.push(q.node);x.push(q.row)});return{nodes:y,rows:x}},_emitSelectedRowsEvent:function(){var y=
this._getSelectedNodesRows();if(y.nodes.length)this.onRowsSelected(y.nodes,y.rows)}});return v([a,e,C,E],{templateString:B,tree:null,grid:null,gridClass:"",highlightSelected:!0,firstColumns:null,additionalColumns:null,showRootCheckbox:!0,showCheckboxColumn:!0,showHeader:!0,labelColumnField:"label",gridParams:null,keepContentUnderScroll:void 0,hideInvisibleExpandoIcons:!1,expandOnNodeClick:!1,checkLimit:0,checkLimitMessage:null,checkLimitMessageTimeout:5E3,handleMultipleCheck:!1,enableRowSelection:!1,
enableMultipleRowSelection:!1,allowSelectionFromManyParents:!1,selectedRowFilter:null,selectedRowClass:"row-selected",enableHeaderLabelToggleClick:!0,defaultExpand:null,fitParentSize:!1,renderAllRows:!1,rowPostProcessor:null,_rootCheckbox:null,_checkboxes:null,_lastCheckedNode:null,updateSelectionCountDiv:function(y,x){},getLabel:function(y,x){return y.label},postCreate:function x(){this.inherited(x,arguments);this._createGrid()},resize:function(){this.grid.resize();this._updateCheckboxState(this._rootCheckbox);
for(var x in this._checkboxes)this._updateCheckboxState(this._checkboxes[x]);this._emitSelectionChanged()},setWidth:function(x){this.grid&&this.grid.domNode&&b.set(this.grid.domNode,"width",x+"px")},setHeight:function(x){this.grid&&this.grid.domNode&&b.set(this.grid.domNode,"height",x+"px")},row:function(x){return this.grid.row(x)},cell:function(x){return this.grid.cell(x)},_labelColumn:null,_createGrid:function(){var x=this;this._checkboxes={};var w={label:this.getLabel(this.tree.root,!0),sortable:!1,
field:this.labelColumnField,renderCell:this._renderLabel.bind(this),renderHeaderCell:this._renderLabelHeader.bind(this,this.tree.root)},n;if(this.additionalColumns&&this.additionalColumns.length&&(n=this.additionalColumns.filter(function(H){return H.field===x.labelColumnField})[0])){for(var q in w)void 0===n[q]&&(n[q]=w[q]);w=n}w.indentWidth=w.indentWidth||16;this._labelColumn=w=this._prepareTreeColumn(w);q=[];this.firstColumns&&(q=q.concat(this.firstColumns));this.showCheckboxColumn&&q.push({label:"",
field:"checkbox",sortable:!1,renderCell:this._renderCheckboxForColumn.bind(this),renderHeaderCell:this._renderCheckboxForColumn.bind(this,this.tree.root)});n||q.push(w);this.additionalColumns&&(q=q.concat(this.additionalColumns));w=["esriMapsAnalystXSelectableTreeGrid"];this.gridClass&&w.push(this.gridClass);this.fitParentSize&&w.push("fitParentSize");w=Object.assign({class:w.join(" "),keepScrollPosition:!0,store:this.tree,columns:q},this.gridParams);this.grid=this._createGridObject(w,this.gridContainer);
this.own(this.grid);this.grid._expanded=this.defaultExpand||this.grid._expanded||{};h.oddEvenFix(this.grid);this.own(f(this.tree,"updated",this._onStoreUpdated.bind(this)));this._addKeepScrollHandlers();this._addGridHandlers();this.renderAllRows&&(this.grid.minRowsPerPage=1E4,this.grid.maxRowsPerPage=10250);this.grid.startup();I.autoTooltip(this.domNode);this.showHeader||t.add(this.domNode,"esriMapsAnalystXGridNoHeader");f(this.grid.domNode,".dgrid-expando-icon:click,.dgrid-content .dgrid-column-labelColumn:dblclick,.dgrid-content .dgrid-column-labelColumn:keydown",
function(H){(H=x.grid.row(H))&&x.onExpandChangedUser(H.data)})},_createGridObject:function(x,w){return new g(x,w)},onRowInserted:function(x,w){},_addGridHandlers:function(){function x(n,q){w.enableRowSelection&&q.parent&&(!w.selectedRowFilter||w.selectedRowFilter(q))&&(t.add(n,"esriMapsAnalystXClickable"),f(n,"click",function(H){setTimeout(function(){if(!w._isSelectionFrozen){if(H.shiftKey&&w.enableMultipleRowSelection){if(w._lastSelectedRowInfo&&w._lastSelectedRowInfo.row.parentNode&&w._lastSelectedRowInfo.node.parent===
q.parent){var K=r.getChildIndex(w._lastSelectedRowInfo.row.parentNode,w._lastSelectedRowInfo.row),m=r.getChildIndex(n.parentNode,n),u=K<=m?w._lastSelectedRowInfo.row:n;K=K<=m?n:w._lastSelectedRowInfo.row;m=u;if(u.id!==K.id){do{u=w.grid.row(m).data;w._selectRow(m,u);if(m.id===K.id)break;m=m.nextSibling}while(m)}}else w.selectSingleRow(n,q);r.stealFocus()}else z.isCtrl(H)&&w.enableMultipleRowSelection?w._lastSelectedRowInfo&&w._lastSelectedRowInfo.row.parentNode&&w._lastSelectedRowInfo.node.parent===
q.parent||w.allowSelectionFromManyParents?w._selectedRowInfos[q.id]?w._unselectRow(n,q):w._selectRow(n,q):w.selectSingleRow(n,q):w.selectSingleRow(n,q);w._emitSelectedRowsEvent()}})}))}var w=this;this.own(A.after(this.grid,"insertRow",function(n){var q=n&&w.grid._rowIdToObject[n.id];if(n){if(q&&w.hideInvisibleExpandoIcons&&(!q.children||!q.children.length)){var H=d(".dgrid-expando-icon",n)[0];H&&(H.style.width="0")}r[q&&!1===q.visible?"hide":"show"](n);x(n,q)}q&&(w._updateRowHighlighting(q,n),w.onRowInserted(n,
q));w.rowPostProcessor&&w.rowPostProcessor(n,q);return n}))},_addKeepScrollHandlers:function(){function x(n){if(!w.grid.contentNode)return n;if(w.fitParentSize){var q=r.hasScrollbars(w.grid.bodyNode);w.grid.headerNode.style[w.isLeftToRight()?"right":"left"]=q.w?"":"0px";w._lastContentWidth=w.grid.contentNode.style.width||w._lastContentWidth||"";w.grid.contentNode.style.width=q.h?w._lastContentWidth:""}else w.keepContentUnderScroll?w.grid.contentNode.style.width=w.grid.headerNode.firstChild.offsetWidth+
"px":!1===w.keepContentUnderScroll&&(w.grid.contentNode.style.width="");return n}var w=this;if(this.fitParentSize||void 0!==this.keepContentUnderScroll)A.before(this.grid,"refresh",function(){w.hideCheckLimitMessage();w._lastCheckedNode=null}),A.after(this.grid,"resize",x),A.after(this.grid,"refresh",x)},_getNodeLevel:function(x){var w=-1;for(x=x&&x.parent;x;)w++,x=x.parent;return w},_prepareTreeColumn:function(x){return this._wrapTreeColumn(p(x))},_wrapTreeColumn:function(x){return x},_onStoreUpdated:function(){this._checkboxes=
{};this._refreshGrid();this._rootCheckbox&&this._updateCheckboxState(this._rootCheckbox);this._emitSelectionChanged()},_emitSelectionChanged:function(x){var w=this.tree.root.selectCount;this.updateSelectionCountDiv(this.selectionCounter,w);this.emit("SelectionChanged",{selected:w,toggledTreeNode:x})},refresh:function(){this._refreshGrid();this.refreshCheckboxes()},_isRefreshSuspended:!1,setRefreshSuspended:function(x){this._isRefreshSuspended=x},_refreshGrid:function(){if(!this._isRefreshSuspended){var x=
this.grid.getScrollPosition();this.grid.refresh();this.grid.scrollTo(x);for(var w in this._selectedRowInfos)this.grid.row(this._selectedRowInfos[w].node).element&&this._selectRow(this.grid.row(this._selectedRowInfos[w].node).element,this._selectedRowInfos[w].node)}},getScrollPosition:function(){return this.grid&&this.grid.getScrollPosition()},setScrollPosition:function(x){return this.grid&&this.grid.scrollTo(x)},_renderCheckbox:function(x){if(!x.leafCount&&x!==this.tree.root||!this.showCheckboxColumn||
!1===x.selectable&&void 0===x.indepSelection)return document.createTextNode("");var w=new l(null,{class:"esriStyleInTable"});w.autoToggle=!1;w.node=x;this._updateCheckboxState(w,x);!1===x.enabled&&w.set("disabled",!0);x===this.tree.root?(this._rootCheckbox=w,r[this.showRootCheckbox?"show":"hide"](w.domNode)):this._checkboxes[this.tree.getIdentity(x)]=w;w.onClick=this._onCheckboxClick.bind(this,x,w);return w},_renderCheckboxForColumn:function(x){return(x=this._renderCheckbox(x))&&x.domNode},refreshCheckboxes:function(){this._rootCheckbox&&
this._updateCheckboxState(this._rootCheckbox);for(var x in this._checkboxes)this._updateCheckboxState(this._checkboxes[x])},clearLastCheckInfo:function(){this._lastCheckedNode=null},_onCheckboxClick:function(x,w,n){n.stopPropagation();this.hideCheckLimitMessage();var q=this.handleMultipleCheck&&("function"!==typeof this.handleMultipleCheck||this.handleMultipleCheck(x));q&&n.shiftKey&&this._tryToggleMultipleNodes(this._lastCheckedNode,x,w||n)?this._lastCheckedNode=x:(this._lastCheckedNode=q?x:null,
this._toggleNodeSelection(x,w||n),this.refreshCheckboxes())},_tryToggleMultipleNodes:function(x,w,n){if(!x||x===w||x.parent!==w.parent)return!1;var q=w.parent.children,H=q.indexOf(x);w=q.indexOf(w);x=H<w?1:-1;var K=[],m=[];for(H+=x;;H+=x){var u=q[H];((void 0===u.indepSelection?u.selected:u.indepSelection)?K:m).push(u);if(H===w)break}K.forEach(function(D){this._toggleNodeSelection(D,n)},this);m.every(function(D){return this._toggleNodeSelection(D,n)},this);this.refreshCheckboxes();return!0},_toggleNodeSelection:function(x,
w){var n=void 0===x.indepSelection?!x.selected:!x.indepSelection;if(n&&this.checkLimit){var q=this.getSelectedNodes().length,H="function"===typeof this.checkLimit?this.checkLimit(this.tree,q):this.checkLimit;if(q>=H)if(void 0===x.indepSelection&&x.children&&!1!==this.tree.getSelectionState(x))n=!1;else return this.showCheckLimitMessage(w),!1}q=!0;void 0===x.indepSelection?(q=this.tree.changeSelect(x,n,H),!q&&this.showCheckLimitMessage(w)):x.indepSelection=n;this._emitSelectionChanged(x);return q},
_checkLimitHandler:null,showCheckLimitMessage:function(x){if(this.checkLimitMessage){var w=x&&(x.domNode||x.target);w&&(c.show(this.checkLimitMessage,w,["above","below"]),x=function(){w&&c.hide(w);w=null},setTimeout(x,this.checkLimitMessageTimeout),this._checkLimitHandler=x,this.onCheckLimitReached(x))}},hideCheckLimitMessage:function(){this._checkLimitHandler&&this._checkLimitHandler();this._checkLimitHandler=null},onCheckLimitReached:function(x){},_updateCheckboxState:function(x){if(x){var w=this._getNodeSelection(x.node);
x.set("checked",w);this._updateRowHighlighting(x.node,null,w)}},_getNodeSelection:function(x){return void 0!==x.indepSelection?x.indepSelection:this.tree.getSelectionState(x)},_updateRowHighlighting:function(x,w,n){this.highlightSelected&&x&&(n=void 0!==n?n:this._getNodeSelection(x),(w=w||this.grid&&this.row(x).element)&&(!0!==n||void 0===x.indepSelection&&!1===x.selectable?t.remove(w,"selected"):t.add(w,"selected")))},_renderLabel:function(x,w,n){w=this._renderLabelNode(x,n);this._provideLabelClickAction(w,
n,x);return w},_provideLabelClickAction:function(x,w,n){var q=this.expandOnNodeClick&&n.children?n.children.length&&(x=w,function(){this.toggleExpand(n);this.onExpandChangedUser(n)}.bind(this)):!1!==n.enabled&&this.showCheckboxColumn?this._onCheckboxClick.bind(this,n,null):null;q&&(t.add(x,"esriMapsAnalystXClickable"),f(x,"click",function(H){H.stopPropagation();q(H)}))},_renderLabelNode:function(x){return k.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(x)})},
_renderLabelHeader:function(x){var w=k.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(x)||this._labelColumn&&this._labelColumn.label||""});this.enableHeaderLabelToggleClick&&this.showRootCheckbox&&(t.add(w,"esriMapsAnalystXClickable"),f(w,"click",this._onCheckboxClick.bind(this,x,null)));return w},onRowsSelected:function(x,w){},isNodeSelected:function(x){return x&&(x.selected||x.indepSelection)},getSelectedNodes:function(){var x=this.tree.getSelectedNodes(!1),
w=this._getIndepSelectedNodes();return x.concat(w)},_getIndepSelectedNodes:function(){function x(n){n&&(n.indepSelection&&w.push(n),n.children&&n.children.forEach(x))}var w=[];x(this.tree.root);return w},getSelectedState:function(){if(!this.tree)return null;var x={normalSelection:{},indepSelection:{}},w=this.tree.getSelectedNodes(!1);w&&w.forEach(function(n){x.normalSelection[n.id]=!0});(w=this._getIndepSelectedNodes())&&w.forEach(function(n){x.indepSelection[n.id]=!0});return x},setSelectedState:function(x){if(this.tree){this.tree.changeSelect(this.tree.root,
!1);if(x){for(var w in x.normalSelection){var n=this.tree.get(w);n&&this.tree.changeSelect(n,!0)}for(w in x.indepSelection)if(n=this.tree.get(w))n.indepSelection=!0}this.refreshCheckboxes()}},setNodeSelected:function(x,w,n){x&&(void 0!==x.indepSelection?x.indepSelection=w:this.tree.changeSelect(x,w),!1!==n&&this.refreshCheckboxes())},isExpanded:function(x){x="string"===typeof x?x:x[this.tree.idProperty];return this.grid._expanded&&this.grid._expanded[x]},setExpanded:function(x,w,n){x="string"==typeof x?
x:x[this.tree.idProperty];void 0!==x&&(!1!==n?(n=this.grid.row(x))&&n.element&&this.grid.expand(x,w):this.grid._expanded[x]=w)},toggleExpand:function(x){this.setExpanded(x,!this.isExpanded(x))},getExpandedState:function(){return Object.assign({},this.grid._expanded)},setExpandedState:function(x){this.grid._expanded=x||{}},onExpandChangedUser:function(x){},destroy:function(){this.unselectAllRows();this.inherited(arguments)}})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_TemplatedMixin":function(){define(["dojo/_base/declare",
"dijit/_TemplatedMixin","./_EscapeValueMixin"],function(v,A,C){return v([A,C],{})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_EscapeValueMixin":function(){define(["dojo/_base/declare"],function(v){return v(null,{_escapeValue:function(A){return A.replace(/"/g,"\x26quot;")}})})},"dgrid/tree":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/Deferred dojo/_base/lang dojo/query dojo/on dojo/aspect ./util/has-css3 ./Grid dojo/has!touch?./util/touch put-selector/put".split(" "),function(v,
A,C,t,k,b,f,d,c,a,e){function g(l,h,r,G){G=this.grid.isRTL?"right":"left";var I=".dgrid-expando-icon";h&&(I+=".ui-icon.ui-icon-triangle-1-"+(r?"se":"e"));l=e("div"+I+"[style\x3dmargin-"+G+": "+l*(this.indentWidth||9)+"px; float: "+G+"]");l.innerHTML="\x26nbsp;";return l}function p(l){var h=this,r=this.style.height;r&&(this.style.display="0px"==r?"none":"block");l&&(e(this,".dgrid-tree-resetting"),setTimeout(function(){e(h,"!dgrid-tree-resetting")}));this.style.height=""}function z(l){var h=l.renderCell||
c.defaultRenderCell,r,G;l||(l={});l.shouldExpand=l.shouldExpand||function(I,B,E){return E};f.after(l,"init",function(){var I=l.grid,B=".dgrid-content .dgrid-column-"+l.id,E=[];I.cleanEmptyObservers=!1;if(!I.store)throw Error("dgrid tree column plugin requires a store to operate.");l.renderExpando||(l.renderExpando=g);E.push(I.on(l.expandOn||".dgrid-expando-icon:click,"+B+":dblclick,"+B+":keydown",function(J){var F=I.row(J);I.store.mayHaveChildren&&!I.store.mayHaveChildren(F.data)||"keydown"==J.type&&
32!=J.keyCode||"dblclick"==J.type&&G&&1<G.count&&F.id==G.id&&-1<J.target.className.indexOf("dgrid-expando-icon")||I.expand(F);-1<J.target.className.indexOf("dgrid-expando-icon")&&(G&&G.id==I.row(J).id?G.count++:G={id:I.row(J).id,count:1})}));d("touch")&&E.push(I.on(a.selector(B,a.dbltap),function(){I.expand(this)}));I._expanded||(I._expanded={});E.push(f.after(I,"insertRow",function(J){var F=this.row(J);l.shouldExpand(F,r,this._expanded[F.id])&&this.expand(J,!0,!0);return J}));E.push(f.before(I,"removeRow",
function(J,F){if(J=J.connected)k("\x3e.dgrid-row",J).forEach(function(y){I.removeRow(y,!0)}),F||e(J,"!")}));l.collapseOnRefresh&&E.push(f.after(I,"cleanup",function(){this._expanded={}}));I._calcRowHeight=function(J){var F=J.connected;return J.offsetHeight+(F?F.offsetHeight:0)};I.expand=function(J,F,y){var x=J.element?J:I.row(J),w=d("transitionend");J=new C;var n=J.promise;J.resolve();J=x.element;J=-1<J.className.indexOf("dgrid-expando-icon")?J:k(".dgrid-expando-icon",J)[0];y=y||!1===l.enableTransitions;
if(J&&J.mayHaveChildren&&(y||F!==!!this._expanded[x.id])){var q=void 0===F?!this._expanded[x.id]:F;e(J,".ui-icon-triangle-1-"+(q?"se":"e")+"!ui-icon-triangle-1-"+(q?"e":"se"));F=x.element;var H=F.connected,K={originalQuery:this.query};if(!H){H=K.container=F.connected=e(F,"+div.dgrid-tree-container");var m=function(M){return I.store.getChildren(x.data,M)};l.allowDuplicates&&(K.parentId=x.id);"level"in J&&(m.level=J.level);n=n.then(function(){if(I.renderQuery)return I.renderQuery(m,K);var M=e(H,"div"),
L=I.renderArray(m(K),M,"level"in m?{queryLevel:m.level}:{});C.when(L,function(){e(M,"!")});return L});w?b(H,w,p):p.call(H)}H.hidden=!q;var u=H.style;if(!w||y)u.display=q?"block":"none",u.height="";else{if(q){u.display="block";var D=H.scrollHeight;u.height="0px"}else e(H,".dgrid-tree-resetting"),u.height=H.scrollHeight+"px";setTimeout(function(){e(H,"!dgrid-tree-resetting");u.height=q?D?D+"px":"auto":"0px"})}q?this._expanded[x.id]=!0:delete this._expanded[x.id]}return n};f.after(l,"destroy",function(){A.forEach(E,
function(J){J.remove()});delete I.expand;delete I._calcRowHeight})});l.renderCell=function(I,B,E,J){var F=l.grid,y=Number(J&&J.queryLevel)+1,x=!F.store.mayHaveChildren||F.store.mayHaveChildren(I),w=J.parentId;y=r=isNaN(y)?0:y;F=l.renderExpando(y,x,F._expanded[(w?w+"-":"")+F.store.getIdentity(I)],I);F.level=y;F.mayHaveChildren=x;(I=h.call(l,I,B,E,J))&&I.nodeType?(e(E,F),e(E,I)):E.insertBefore(F,E.firstChild)};return l}z.defaultRenderExpando=g;t.getObject("dgrid.tree",!0);return dgrid.tree=z})},"dgrid/util/has-css3":function(){define(["dojo/has"],
function(v){function A(t,k){t=t.style;var b;if(k in t)return!0;k=k.slice(0,1).toUpperCase()+k.slice(1);for(b=C.length;b--;)if(C[b]+k in t)return C[b];return!1}var C=["ms","O","Moz","Webkit"];v.add("css-transitions",function(t,k,b){return A(b,"transitionProperty")});v.add("css-transforms",function(t,k,b){return A(b,"transform")});v.add("css-transforms3d",function(t,k,b){return A(b,"perspective")});v.add("transitionend",function(){var t=v("css-transitions");return t?!0===t?"transitionend":{ms:"MSTransitionEnd",
O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[t]:!1});return v})},"esri/dijit/geoenrichment/utils/KeyboardUtil":function(){define(["dojo/on","dojo/sniff","./DomUtil"],function(v,A,C){var t={listenToKeyboardCombinationOverNode:function(k){return v(document.body,"keydown",function(b){if(!k.isCtrl||t.isCtrl(b))if(!k.isShift||b.shiftKey)if(!k.isAlt||b.altKey)String.fromCharCode(b.keyCode).toLowerCase()!==k["char"]||k.node&&!C.isNodeInLayout(k.node)||k.callback(b)})},isCtrl:function(k){return A("mac")?
k.metaKey:k.ctrlKey}};return t})},"esri/dijit/geoenrichment/utils/DomUtil":function(){define("dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/query esri/dijit/geoenrichment/Deferred dojo/domReady!".split(" "),function(v,A,C,t,k,b,f){function d(l,h){Array.isArray(l)?l.forEach(h):h(l);return l}function c(l,h,r){var G=!1,I=function(B){!B||r&&!r(B)||(B.parentNode===h?G=!0:I(B.parentNode))};I(l);return G}function a(l){return!g.isHidden(l)&&"none"!==k.get(l,"display")&&
!A.contains(l,"dijitHidden")}function e(){p||(p=C.create("div",{"class":"esriGEOffscreen"},document.body));return p}var g={isHidden:function(l){return l&&A.contains(l,"esriGEHidden")},hasVisibleChildren:function(l){if(!l||!l.children.length)return!1;for(var h=0;h<l.children.length;h++)if(!g.isHidden(l.children[h]))return!0;return!1},hide:function(l){return g.addTag(l,"esriGEHidden")},show:function(l){return g.removeTag(l,"esriGEHidden")},display:function(l,h){return g[h?"show":"hide"](l)},addTag:function(l,
h){return d(l,function(r){r&&A.add(r,h)})},removeTag:function(l,h){return d(l,function(r){r&&A.remove(r,h)})},getChildIndex:function(l,h){if(!l||!l.children||!h)return-1;for(var r=0;r<l.children.length;r++)if(l.children[r]===h)return r;return-1},isChildOf:function(l,h){return c(l,h)},isNodeInLayout:function(l){return c(l,document.body,function(h){return a(h)})},isNodeVisible:function(l){return c(l,document.body,function(h){return a(h)&&"hidden"!==k.get(h,"visibility")})},isNodeOnscreen:function(l){return c(l,
document.body,function(h){return!A.contains(h,"esriGEOffscreen")})},enableContent:function(l,h,r){if(l){r=r||{};var G=l.children.length-1;if(!(0>G||(G=l.children[G],A.contains(G,"esriGEDisabledContent")||(G=null),G&&l.removeChild(G),h)))return G=C.create("div",{"class":"esriGEDisabledContent"+(r.overlayClass?" "+r.overlayClass:"")},l),r.textContent&&(G.textContent=r.textContent),!1!==r.fitParent&&(l=t[r.marginBox?"getMarginBox":"getContentBox"](l).h)&&k.set(G,{height:l+"px",marginTop:-l+"px"}),G}},
enableContentAbsolute:function(l,h,r){if(l){r=r||{};var G=k.get(l,"position");"relative"===G||"absolute"===G||h||k.set(l,"position","relative");return g.enableContent(l,h,{overlayClass:"esriGEAbsoluteStretched"+(r.overlayClass?" "+r.overlayClass:"")+(r.isTransparent?" esriGEDisabledContentTransparent":""),fitParent:!1,textContent:r.textContent})}}},p;g.hideNodeInBackground=function(l,h){if(l){if(l._hideNodeInBackgroundUndoController)return l._hideNodeInBackgroundUndoController;var r=C.create("div",
null,l,"after"),G=C.create("div",{style:"position: absolute; left: 0px; top: 0px;"},e());C.place(l,G);h="DomUtil.hideNodeInBackground"+(h?"."+h:"");v.set(r,"_bg_memo_node",h);v.set(G,"_bg_temp_node",h);h={remove:function(){r&&(r.parentNode&&C.place(l,r,"replace"),C.destroy(r),C.destroy(G),p.children.length||(C.destroy(p),p=null),r=null,delete l._hideNodeInBackgroundUndoController)}};return l._hideNodeInBackgroundUndoController=h}};g.showNodeFromBackground=function(l){l&&l._hideNodeInBackgroundUndoController&&
l._hideNodeInBackgroundUndoController.remove()};g.noTransformPosition=function(l){function h(B){for(var E={x:0,y:0};B.offsetParent;)E.x+=B.offsetLeft,E.y+=B.offsetTop,B=B.offsetParent,E.x+=k.get(B,"borderLeftWidth"),E.y+=k.get(B,"borderTopWidth");return E}function r(B){return k.get(B,"width")+k.get(B,"paddingLeft")+k.get(B,"paddingRight")+k.get(B,"borderLeftWidth")+k.get(B,"borderRightWidth")}function G(B){return k.get(B,"height")+k.get(B,"paddingTop")+k.get(B,"paddingBottom")+k.get(B,"borderTopWidth")+
k.get(B,"borderBottomWidth")}if(l){if(l instanceof SVGElement&&l.getBBox){var I=(I=l.ownerSVGElement&&l.ownerSVGElement.parentNode)&&h(I);l=l.getBBox();return{x:(l.x||0)+I.x,y:(l.y||0)+I.y,w:l.width||0,h:l.height||0}}I=h(l);return{x:I.x,y:I.y,w:r(l),h:G(l)}}};g.getNodesBox=function(l,h){if(!l||!l.length)return null;h=h||{};for(var r=1E6,G=-1E6,I=1E6,B=-1E6,E=0;E<l.length;E++){var J=l[E];J=h.ignoreTransformation?g.noTransformPosition(J):t.position(J);r=Math.min(r,J.x);I=Math.min(I,J.y);G=Math.max(G,
J.x+J.w);B=Math.max(B,J.y+J.h)}l={x:r,y:I,w:G-r,h:B-I};h.originNode&&(h=h.ignoreTransformation?g.noTransformPosition(h.originNode):t.position(h.originNode),l.x-=h.x,l.y-=h.y);return l};g.traverseChildren=function(l,h){function r(G){if(G&&G.children)for(var I=0;I<G.children.length;I++){var B=G.children[I];if(h(B))break;r(B)}}r(l)};g.scrollToListNode=function(l,h,r){var G=h.offsetTop+h.clientHeight,I=G-(l.scrollTop+l.clientHeight);0<I&&(l.scrollTop+=I);r&&(G-=h.clientHeight-r.offsetTop,I=l.scrollTop-
G,0<I&&(l.scrollTop-=I))};var z;g.getScrollbarSize=function(){if(!z){var l=C.create("div",null,document.body);l.style.width="100px";l.style.height="100px";l.style.overflow="scroll";l.style.position="absolute";l.style.top="9999px";z={w:l.offsetWidth-l.clientWidth,h:l.offsetHeight-l.clientHeight};C.destroy(l)}return z};g.hasScrollbars=function(l){var h=k.getComputedStyle(l);return{w:"scroll"===h.overflowX||l.offsetWidth>l.clientWidth&&"auto"===h.overflowX,h:"scroll"===h.overflowY||l.offsetHeight>l.clientHeight&&
"auto"===h.overflowY}};g.getMeasureContext=function(l){l=l||{};l.style=l.style?l.style+" ":"";l.style+="display: inline-block; position: absolute; left: 0; top: 0;";return{div:C.create("div",l,document.body),measureText:function(h){this.div.innerHTML=h;h=t.getMarginBox(this.div);delete h.l;delete h.t;return h},destroy:function(){C.destroy(this.div)}}};g.getTextBox=function(l,h){h=g.getMeasureContext(h);l=h.measureText(l);h.destroy();return l};g.getNodeFontFamily=function(l){return(l=k.get(l,"fontFamily")||
k.getComputedStyle(l).fontFamily)&&l.replace(/'|"/g,"").split(",")[0]};g.getNodeFontSize=function(l){return k.toPixelValue(l,k.get(l,"fontSize"))};g.stealFocus=function(){var l=new f;try{var h=C.create("input",{type:"text",style:"position: absolute; left: 0px; top: 0px;"});C.place(h,document.body);h.select();C.destroy(h)}catch(r){}setTimeout(l.resolve,0);return l.promise};g.getWindowBox=function(){for(var l=[],h=0,r=document.body.children.length;h<r;h++){var G=document.body.children[h];g.isHidden(G)||
(g.hide(G),l.push(G))}h={w:document.body.clientWidth,h:document.body.clientHeight};l.forEach(function(I){g.show(I)});return h};g.isBodyLtr=function(){return"ltr"===(document.body.dir||"ltr").toLowerCase()};g.setAttribute=function(l,h,r){return 2===arguments.length?v.set(l,h):v.set(l,h,r)};g.getAttribute=function(l,h,r){return 2===arguments.length?v.get(l,h):v.get(l,h,r)};g.addClass=function(l,h){A.add(l,h)};g.removeClass=function(l,h){A.remove(l,h||"")};g.toggleClass=function(l,h,r){A[r?"add":"remove"](l,
h||"")};g.replaceClass=function(l,h,r){return A.replace(l,h,r)};g.containsClass=function(l,h){return A.contains(l,h)};g.getStyle=function(l,h){return k.get(l,h)};g.setStyle=function(l,h,r){return 2===arguments.length?k.set(l,h):k.set(l,h,r)};g.setFullTextStyle=function(l,h){h.fontSize&&(h=Object.assign({},h),h.fontSize+="px");g.setStyle(l,h)};g.getStylePixelValue=function(l,h){l=g.getStyle(l,h);return"number"===typeof l?l:parseFloat(l)||0};g.getComputedStyle=function(l){return l&&1===l.nodeType&&
window.getComputedStyle(l)};g.position=function(l,h){return t.position(l,h)};g.getMarginBox=function(l,h){return t.getMarginBox(l,h)};g.getMarginExtents=function(l,h){return t.getMarginExtents(l,h)};g.getContentBox=function(l,h){return t.getContentBox(l,h)};g.getPadBorderExtents=function(l,h){return t.getPadBorderExtents(l,h)};g.getPadExtents=function(l,h){return t.getPadExtents(l,h)};g.getBorderExtents=function(l,h){return t.getBorderExtents(l,h)};g.docScroll=function(){return t.docScroll()};g.create=
function(l,h,r,G){return C.create(l,h,r,G)};g.toDom=function(l){return C.toDom(l)};g.place=function(l,h,r){return C.place(l,h,r)};g.empty=function(l){return C.empty(l)};g.destroy=function(l){return C.destroy(l)};g.query=function(l,h){l=b(l,h);h=[];for(var r=0,G=l.length;r<G;r++)h.push(l[r]);return h};return g})},"esri/dijit/geoenrichment/Deferred":function(){define(["dojo/Deferred"],function(v){return v})},"esri/dijit/geoenrichment/TriStateItem":function(){define("dojo/_base/declare dojo/_base/event dojo/_base/lang dojo/Stateful dojo/on dojo/dom-construct dojo/dom-class ./utils/DeviceUtil ./utils/AccessibilitySupport".split(" "),
function(v,A,C,t,k,b,f,d,c){return v(t,{domNode:null,checkboxNode:null,checked:!1,disabled:!1,autoToggle:!0,_currentClass:null,_lastChecked:!1,constructor:function(a,e,g,p){var z=d.isMobileDevice()?"touchstart":"click";e=e||{};var l=e["class"];e["class"]=(l?l+" ":"")+"esriTriStateCheckBoxIcon";if(l=e.label){if(a instanceof HTMLLabelElement)a.innerHTML="\x26nbsp;"+l;else{var h=e.labelAttrs||{};h.innerHTML="\x26nbsp;"+l;h=b.create("label",h);a&&b.place(h,a);a=h}e=C.mixin({},e);delete e.label;delete e.labelAttrs}this.checkboxNode=
b.create("div",e,a,a instanceof HTMLLabelElement?"first":g);this._currentClass=this._composeClass();f.add(this.checkboxNode,this._currentClass);a instanceof HTMLLabelElement?(k(a,z,C.hitch(this,this._onClick)),f.add(a,"esriTriStateCheckBoxLabel"),p&&c.registerButton(a,this._onClick.bind(this),l)):(k(this.checkboxNode,z,C.hitch(this,this._onClick)),p&&c.registerButton(this.checkboxNode,this._onClick.bind(this),l));this.domNode=l?a:this.checkboxNode},postscript:function(){},_onClick:function(a){this.disabled||
(this.autoToggle&&this.toggle(),a&&(a.checked=this.checked),this.onClick(A.fix(a)))},onClick:function(a){},toggle:function(){this.set("checked",!this._lastChecked);return this.checked},_checkedSetter:function(a){a!==this.checked&&(this.checked="mixed"===a?a:this._lastChecked=!!a,this._updateClass())},_disabledSetter:function(a){this.disabled=!!a;this._updateClass()},_updateClass:function(){var a=this._composeClass();a!==this._currentClass&&(f.replace(this.checkboxNode,a,this._currentClass),this._currentClass=
a)},_composeClass:function(){var a="esriTriStateCheckBox"+("mixed"==this.checked?"Mixed":this.checked?"Checked":"");return this.disabled?a+"Disabled":a}})})},"esri/dijit/geoenrichment/utils/DeviceUtil":function(){define(["dojo/sniff","dojo/domReady!"],function(v){var A={},C=function(){var k=window,b=k.navigator.platform,f=k.navigator.userAgent,d={ios:!1,android:!1,androidChrome:!1,desktop:!1,iphone:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,macos:!1,windows:!1,cordova:!(!k.cordova&&!k.phonegap),
phonegap:!(!k.cordova&&!k.phonegap),electron:!1,nwjs:!1},c=k.screen.width,a=k.screen.height,e=f.match(/(Android);?[\s\/]+([\d.]+)?/),g=f.match(/(iPad).*OS\s([\d_]+)/),p=f.match(/(iPod)(.*OS\s([\d_]+))?/),z=!g&&f.match(/(iPhone\sOS|iOS)\s([\d_]+)/),l=0<=f.indexOf("MSIE ")||0<=f.indexOf("Trident/"),h=0<=f.indexOf("Edge/"),r=0<=f.indexOf("Gecko/")&&0<=f.indexOf("Firefox/"),G="Win32"===b,I=0<=f.toLowerCase().indexOf("electron"),B="undefined"!==typeof nw&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&
"undefined"!==typeof process.versions.nw;b="MacIntel"===b;var E="1024x1366 1366x1024 834x1194 1194x834 834x1112 1112x834 768x1024 1024x768".split(" ");!g&&b&&v("touch")&&0<=E.indexOf(c+"x"+a)&&((g=f.match(/(Version)\/([\d.]+)/))||(g=[0,1,"13_0_0"]),b=!1);d.ie=l;d.edge=h;d.firefox=r;e&&!G&&(d.os="android",d.osVersion=e[2],d.android=!0,d.androidChrome=0<=f.toLowerCase().indexOf("chrome"));if(g||z||p)d.os="ios",d.ios=!0;z&&!p&&(d.osVersion=z[2].replace(/_/g,"."),d.iphone=!0);g&&(d.osVersion=g[2].replace(/_/g,
"."),d.ipad=!0);p&&(d.osVersion=p[3]?p[3].replace(/_/g,"."):null,d.ipod=!0);d.ios&&d.osVersion&&0<=f.indexOf("Version/")&&"10"===d.osVersion.split(".")[0]&&(d.osVersion=f.toLowerCase().split("version/")[1].split(" ")[0]);d.webView=!(!(z||g||p)||!f.match(/.*AppleWebKit(?!.*Safari)/i)&&!k.navigator.standalone)||k.matchMedia&&k.matchMedia("(display-mode: standalone)").matches;d.webview=d.webView;d.standalone=d.webView;d.desktop=!(d.ios||d.android)||I||B;d.desktop&&(d.electron=I,d.nwjs=B,d.macos=b,d.windows=
G,d.macos&&(d.os="macos"),d.windows&&(d.os="windows"));d.pixelRatio=k.devicePixelRatio||1;return d}();A.device=C;A.isMobileDevice=function(){return!C.desktop};A.isPCWithTouchScreen=function(){return C.desktop&&v("touch")};A.isLandscape=function(){return 90===Math.abs(window.orientation)};var t=null;A.isWebLayout=function(){if(!t){var k=document.createElement("div");k.style="visibility:hidden;height:1in;width:1in;position:absolute;left: -100%;top:-100%;";document.body.appendChild(k);t=k.offsetHeight;
k.parentNode.removeChild(k)}k=t;k*=7;var b=document.body.offsetWidth;if(b>=k)return!0;var f=document.body.offsetHeight;return b>=f&&Math.sqrt(b*b+f*f)>=k?!0:!1};A.press=C.desktop?"mousedown":"touchstart";A.release=C.desktop?"mouseup":"touchend";A.click=C.desktop?"click":"touchend";A.clickOrRelease=C.desktop?"click, mouseup":"touchend";A.move=C.desktop?"mousemove":"touchmove";return A})},"esri/dijit/geoenrichment/utils/AccessibilitySupport":function(){define([],function(){var v=null;return{initialize:function(A){v=
A},registerButton:function(A,C,t){v&&v(A,C,t)}}})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DgridUtil":function(){define(["dojo/aspect","dojo/dom-class","dojo/query","../../utils/ArrayUtil"],function(v,A,C,t){function k(c,a,e){if(void 0===e){var g=c._rowIdToObject[a.id];g&&(e=(c=c.store)&&c.isOdd&&c.isOdd(g))}0!==e&&1!==e||A.replace(a,d[e],d[1-e])}function b(c,a,e){var g=c.store;if(g&&g.updateExpand){e=g.updateExpand(a.data,e,!0,c.getSortingFunction());for(var p in e)a=c.row(g.get(p)),a.element&&
k(c,a.element,e[p])}}var f=["ui-icon-triangle-1-e","ui-icon-triangle-1-se"],d=["dgrid-row-even","dgrid-row-odd"];return{createExpando:function(c){A.add(c,"dgrid-expando-icon ui-icon ui-icon-triangle-1-e esriMapsAnalystXClickable");return{expando:c,update:function(a){a=a?1:0;A.replace(c,f[a],f[1-a])}}},oddEvenFix:function(c){c.expand&&(c.getSortingFunction=function(){var a=this.get("sort");return a&&a.length?t.getSorting(a):null},v.after(c,"insertRow",function(a){k(c,a);return a}),v.before(c,"refresh",
function(){var a=c.store;a&&a.updateExpandedNodes&&a.updateExpandedNodes(c._expanded,c.getSortingFunction())}),v.around(c,"expand",function(a){return function(e,g){var p=e.element?e:c.row(e);void 0===g&&(g=!c._expanded[p.id]);!0===g&&b(c,p,!0);var z=a.apply(this,arguments);!1===g&&b(c,p,!1);return z}}),v.around(c,"adjustRowIndices",function(a){return function(){var e=c.store;e&&e.updateExpandedNodes&&e.updateExpand&&e.isOdd||a.apply(this,arguments)}}))},makeContentNeverGoUnderScroll:function(c){function a(){var e=
c.headerNode.firstChild,g=c.contentNode;g&&e&&e.offsetWidth!==g.offsetWidth&&(g.style.width="",e.style.width="",e.style.width=g.offsetWidth+"px")}v.after(c,"resize",a);v.after(c,"refresh",a);v.after(c,"expand",function(e){setTimeout(a,100);setTimeout(a,300);return e})},inlineSortArrow:function(c,a,e){a=t.arrayToObject(t.listToArray(a));v.after(c,"updateSortArrow",function(g,p){if((p=g[0]&&g[0].attribute)&&a[p]){var z=(p=c._sortNode||c._findSortArrowParent(p))&&C(".dgrid-sort-arrow",p)[0];g=g[0].descending;
if(z){z.remove();A.remove(p,"dgrid-sort-down dgrid-sort-up");var l=e?C(e,p)[0]:p.lastChild.append?p.lastChild:p;l.append||(l=p);A.add(l,g?"dgrid-sort-down":"dgrid-sort-up");l.append(z)}}},!0)}}})},"widgets/BusinessAnalyst/esriAnalystX/utils/ArrayUtil":function(){define("require exports ../../baUtil/array dojo/store/util/SimpleQueryEngine ./ObjectUtil esri/dijit/geoenrichment/utils/ArrayUtil".split(" "),function(v,A,C,t,k,b){function f(a,e){a.some(function(g,p){e.func(g,p,e,a);if(e.stop)return!0});
return e}function d(a){var e=a.split(" "),g=e[1];a={};switch(e[0]){case "max":a.result=-Infinity;e=function(p,z,l){l.result=Math.max(l.result,k.getObject(p,g))};break;case "min":a.result=Infinity;e=function(p,z,l){l.result=Math.min(l.result,k.getObject(p,g))};break;case "sum":a.result=0;e=function(p,z,l){l.result+=k.getObject(p,g)};break;case "random":a.result=void 0;e=function(p,z,l,h){l.result=h[Math.round((h.length-1)*Math.random())];l.stop=!0};break;default:throw Error("Unsupported query.");}a.func=
e;return a}var c={getSorting:function(a,e){if(!a)return k.compare;if("function"===typeof a)return a;var g=Array.isArray(a)?a:a.sort||[a];var p={};"string"===typeof e&&(e=[e]);Array.isArray(e)?e.forEach(function(z){p[z]=k.compareNames}):e&&(p=e);return function(z,l){for(var h=void 0,r=0;h=g[r];r++){var G=z[h.attribute],I=l[h.attribute];if(G=(p[h.attribute]||(p["*"]?p["*"].bind(null,h.attribute):k.compare))(G,I,!1,!1,z,l))return h.descending?-G:G}return 0}},sort:function(a,e,g){return a.sort(c.getSorting(e,
g))},sortIndices:function(a,e,g){a=C.map(a,function(z,l){return{value:z,index:l}});var p=c.getSorting(e,g);a.sort(function(z,l){return p(z.value,l.value)});return C.map(a,function(z){return z.index})},getQueryEngine:function(a,e){return function(g,p){p&&p.sort&&(p=Object.assign({},p),p.sort=c.getSorting(p.sort,a));return(e||t)(g,p)}},objectToArray:function(a,e){void 0===e&&(e=null);var g=[],p=e?function(h){return a[h]?a[h][e]:void 0}:function(h){return a[h]},z;for(z in a){var l=p(z);"undefined"!==
typeof l&&g.push(l)}return g},arrayToObject:function(a,e){var g={},p=b.composeIdentityFunction(e);C.forEach(a,function(z){g[p(z)]=z});return g},composeIdentityFunction:b.composeIdentityFunction,removeDuplicates:b.removeDuplicates,splitArrayToBunches:b.splitArrayToBunches,contains:function(a,e){return-1!==C.indexOfLoose(a,e)},remove:function(a,e){e=C.indexOfLoose(a,e);-1!==e&&a.splice(e,1);return-1!==e},merge:function(a,e){a=a||[];null!=e&&Array.prototype.push.apply(a,e);return a},listToArray:function(a,
e){if(null==a)return[];void 0===e&&(e=",");a="string"===typeof a?a.split(e):a.slice();for(e=0;e<a.length;e++)"string"===typeof a[e]&&(a[e]=a[e].trim());return a},reorderArray:function(a,e){var g=a.length,p=0,z=Array(g),l={},h={},r;for(r in e){var G=Math.round(r);if(0<=G&&G<g&&!l[G]){var I=Math.round(e[r]);0<=I&&I<g&&!h[I]&&(z[I]=a[G],l[G]=1,h[I]=1,p++)}}p!==g&&(z=z.filter(function(B,E){return h[E]}),a.forEach(function(B,E){!l[E]&&z.push(B)}));return z},mapIndices:function(a,e,g,p){p=null==p?null:
p;if(1===a)g.call(p,0,Math.floor(e/2));else{e=(e-1)/(a-1);for(var z=0;z<a;z++)g.call(p,z,Math.floor(.5+z*e))}},moveElement:function(a,e,g,p){var z=Array.isArray(e)?e:[e];if(-1!==z.indexOf(g))return a.slice();var l=[];a.forEach(function(h){-1===z.indexOf(h)&&(h==g?"before"===p?(z.forEach(function(r){l.push(r)}),l.push(g)):"after"===p&&(l.push(g),z.forEach(function(r){l.push(r)})):l.push(h))});return l},min:function(a,e){var g=a.length;switch(g){case 0:return null;case 1:return a[0];default:for(var p=
a[0],z=e(p),l=0,h=1;h<g;h++){var r=e(a[h]);z>r&&(p=a[h],z=r,l=h)}return{key:l,value:p,comparisonValue:z}}},max:function(a,e){var g=a.length;switch(g){case 0:return null;case 1:return a[0];default:for(var p=a[0],z=e(p),l=0,h=1;h<g;h++){var r=e(a[h]);z<r&&(p=a[h],z=r,l=h)}return{key:l,value:p,comparisonValue:z}}},query:function(a,e){if("object"===typeof e)return f(a,e);if("string"===typeof e)return e=d(e),f(a,e).result},everyEqualProperty:function(a,e){if(2>a.length)return!0;var g;return!a.some(function(p,
z){if(0===z)g=p[e];else if(g!==p[e])return!0})}};return c})},"widgets/BusinessAnalyst/baUtil/array":function(){define(["require","exports"],function(v,A){var C=Array.prototype,t={every:function(k,b,f){return null==k?!0:"string"===typeof k?C.every.call(k.split(""),b,f):C.every.call(k,b,f)},some:function(k,b,f){return null==k?!1:"string"===typeof k?C.some.call(k.split(""),b,f):C.some.call(k,b,f)},forEach:function(k,b,f){if(null!=k)return"string"===typeof k?C.forEach.call(k.split(""),b,f):C.forEach.call(k,
b,f)},map:function(k,b,f){return null==k?[]:"string"===typeof k?C.map.call(k.split(""),b,f):C.map.call(k,b,f)},filter:function(k,b,f){return null==k?[]:"string"===typeof k?C.filter.call(k.split(""),b,f):C.filter.call(k,b,f)},indexOf:function(k,b){return null==k?-1:"string"===typeof k?C.indexOf.call(k.split(""),b):C.indexOf.call(k,b)},indexOfLoose:function(k,b){if(null==k||void 0===k.length)return-1;if("string"===typeof k)return t.indexOfLoose(k.split(""),b);for(var f=0,d=k.length;f<d;f++)if(k[f]==
b)return f;return-1},lastIndexOf:function(k,b){return null==k?-1:"string"===typeof k?C.lastIndexOf.call(k.split(""),b):C.lastIndexOf.call(k,b)},lastIndexOfLoose:function(k,b){if(null==k||void 0===k.length)return-1;if("string"===typeof k)return t.lastIndexOfLoose(k.split(""),b);for(var f=k.length-1;0<=f;f--)if(k[f]==b)return f;return-1}};return t})},"widgets/BusinessAnalyst/esriAnalystX/utils/ObjectUtil":function(){define(["../../baUtil/ObjectUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/utils/SortUtil"],
function(v,A,C){var t=Object.assign({},v,A,C);t.getPrototypeOf=function(k){try{return Object.getPrototypeOf?Object.getPrototypeOf(k):k.__proto__||k.constructor&&k.constructor.prototype}catch(b){return null}};t.isJson=function(k){return"object"===typeof k&&t.getPrototypeOf(k)===Object.prototype};t.copyJson=function(k){return void 0===k||null===k?null:JSON.parse(JSON.stringify({object:k})).object};t.convert=function(k,b,f){var d=b||function(){};b=d(k);if("undefined"!==typeof b)return b;if(Array.isArray(k)){var c=
[];k.forEach(function(p){c.push(t.convert(p,d,f))},this);return c}if(!t.isJson(k))return k;b={};for(var a in k){var e=k[a],g=f?d(a):a;"undefined"===typeof g&&(g=a);b[g]=t.convert(e,d,f)}return b};t.getDeepCopy=function(k){return t.convert(k)};t.getRange=function(k,b,f){b="function"===typeof b?b.bind(null==f?null:f):null;var d,c;for(c in k)if(f=k[c],f=Number(null===b?f:b(f,c)),!isNaN(f))if(void 0===a)var a=d=f;else a=Math.min(a,f),d=Math.max(d,f);return void 0===a?{}:{min:a,max:d}};t.removeEmptyObjects=
function(k){function b(d){d&&"object"===typeof d&&Object.keys(d).forEach(function(c){var a=d[c];!a||"object"!==typeof a||Array.isArray(a)||Object.keys(a).length?b(a):(f=!0,delete d[c])})}for(var f=!0;f;)f=!1,b(k);return k};t.removeValues=function(k,b){function f(d){d&&"object"===typeof d&&Object.keys(d).forEach(function(c){b(c,d[c])?f(d[c]):delete d[c]})}f(k);return k};t.isEqual=function(k,b){if(null===k||"object"!==typeof k||null===b||"object"!==typeof b)return k===b;if(Object.keys(k).length!==Object.keys(b).length)return!1;
var f={},d;for(d in k)f[d]=!0;for(d in b)if(void 0!==f[d])delete f[d];else return!1;for(d in k)if(!t.isEqual(k[d],b[d]))return!1;return!0};t.getObject=function(k,b){if(!b)return k;b=b.split(".");for(var f=0;f<b.length;f++)k=k&&k[b[f]];return k};t.formatNumber=function(k,b){b="number"===typeof b?{places:b}:b||{};if(null==b.places||0>b.places)b.places=t.getPlaces(k,!0),b.maxPlaces&&b.places>b.maxPlaces&&(b.places=b.maxPlaces);return A.formatNumber(k,b)};t.getPlaces=function(k,b){function f(g,p){var z=
k.indexOf(g,d);if(0>z)return c;g=k.charAt(z+g.length);return!g||0>p.indexOf(g)?c:z-d}k=+k;if(isNaN(k))return-1;k+="";var d=k.indexOf(".")+1,c=d?k.length-d:0;if(2>=c||!b)return c;b=0;if(!+k.substr(0,d-1))for(;"0"===k.charAt(d);)d++,b++,c--;for(var a=c-1;2<=a;a--){var e=Math.min(f("000000000000000".substr(0,a),"01234"),f("999999999999999".substr(0,a),"56789"));if(e!==c){c=e;break}}return c+b};return t})},"widgets/BusinessAnalyst/baUtil/ObjectUtil":function(){define(["require","exports"],function(v,
A){function C(t,k){for(var b=0,f=Object.keys(k);b<f.length;b++){var d=f[b];"object"!==typeof t[d]||null===t[d]||"object"!==typeof k[d]||null===k[d]?t[d]=k[d]:Array.isArray(t[d])?Array.isArray(k[d])?t[d].concat(k[d]):t[d]=k[d]:Array.isArray(k[d])?t[d]=k[d]:C(t[d],k[d])}}return{map:function(t,k,b){void 0!==b&&(k=k.bind(b));if("object"!==typeof t)throw Error("Object or array expected");if(Array.isArray(t)){b=[];for(var f=0,d=t.length;f<d;f++)b.push(k(t[f],f));return b}b={};f=0;for(d=Object.keys(t);f<
d.length;f++){var c=d[f];Object.hasOwnProperty.call(t,c)&&(b[c]=k(t[c],c))}return b},deepAssign:function(t){for(var k=[],b=1;b<arguments.length;b++)k[b-1]=arguments[b];for(b=0;b<k.length;b++)C(t,k[b]);return t}}})},"esri/dijit/geoenrichment/utils/ObjectUtil":function(){define(["dojo/number","./DateUtil"],function(v,A){var C={};Math.log10=Math.log10||function(k){return Math.log(k)*Math.LOG10E};C.populateObject=function(k,b,f){function d(c,a){function e(p){var z=c[p],l=a[p],h=z&&"object"===typeof z;
void 0!==z&&(void 0===l?a[p]=z:l&&"object"===typeof l&&h?d(z,l):f&&(h?(l=a[p]={},d(z,l)):a[p]=c[p]))}if(c&&a&&!(Array.isArray(c)&&!Array.isArray(a)||Array.isArray(a)&&!Array.isArray(c)))if(Array.isArray(c))c.forEach(function(p,z){e(z)});else for(var g in c)e(g)}d(b,k);return k};C.filterByPattern=function(k,b){function f(c,a,e){for(var g in c){var p=c[g],z=a[g];if(Array.isArray(p)){var l=p[0];if(z&&Array.isArray(z)){var h=e[g]=[];z.forEach(function(G){if(G&&"object"===typeof G){var I=Array.isArray(G)?
[]:{};f(l,G,I);h.push(I)}})}}else if("object"===typeof p){if(z&&"object"===typeof z){var r=e[g]={};f(p,z,r)}}else void 0!==z&&(e[g]=z)}}var d={};f(b,k,d);return d};C.traverseObject=function(k,b){for(var f in k){var d=k[f];b(d,f,k);d&&"object"===typeof d&&C.traverseObject(d,b)}};C.copyOwnJsonProperties=function(k,b,f){b=b||{};for(var d in k){var c=k[d];k.hasOwnProperty(d)&&"function"!=typeof c&&(c&&"object"==typeof c&&f&&(c=f(d,c)),void 0!==c&&(b[d]=c))}return b};C.removeUndefinedProperties=function(k){k&&
Object.keys(k).forEach(function(b){void 0===k[b]&&delete k[b]});return k};C.getValue=function(k,b){if("string"!==typeof b)return k;b=b.split(".");for(var f=0;f<b.length;f++)k=k&&k[b[f]];return k};C.setValue=function(k,b,f){if("string"===typeof b&&(b=b.split("."),b.length)){for(var d=0;d<b.length-1;d++)k=k&&k[b[d]];k&&(k[b[b.length-1]]=f)}};C.isNumber=function(k){return!isNaN(parseFloat(k))&&isFinite(k)};C.roundNumber=function(k,b){return"number"!==typeof k?k:parseFloat(k.toFixed(void 0!==b?b:0))};
C.getBestPrecision=function(k){return 0===k?0:Math.max(0,Math.round(Math.log10(3E3/Math.abs(k))))};C.getPlaces=function(k,b){function f(g,p){var z=k.indexOf(g,d);if(0>z)return c;g=k.charAt(z+g.length);return!g||0>p.indexOf(g)?c:z-d}k=+k;if(isNaN(k))return-1;k+="";var d=k.indexOf(".")+1,c=d?k.length-d:0;if(2>=c||!b)return c;b=0;if(!+k.substr(0,d-1))for(;"0"===k.charAt(d);)d++,b++,c--;for(var a=c-1;2<=a;a--){var e=Math.min(f("000000000000000".substr(0,a),"01234"),f("999999999999999".substr(0,a),"56789"));
if(e!==c){c=e;break}}return c+b};C.formatNumber=function(k,b){b="number"===typeof b?{places:b}:b||{};var f=b.places,d={};0<=f?d.places=f:f=-1;d.locale=b.locale||A.getDateNumberLocale();k=v.format(k,d);if(b.noSeparator){d=C.getSeparator();var c;if(d)for(;0<=(c=k.indexOf(d));)k=k.substr(0,c)+k.substr(c+1)}if(b.preserveTrailingZeroes||0>=f||!k)return k;for(b=k.length;0<f&&"0"==k.charAt(b-1);)b--,--f||b--;return k.substr(0,b)};C.formatNumberAsCurrency=function(k,b,f){return b?b.split(";")[0>k?1:0].replace("0",
C.formatNumber(Math.abs(k),f)):C.formatNumber(k,f)};var t;C.getSeparator=function(){void 0===t&&(t=v.format(9999,{places:0}).replace(/9/g,""));return t};C.parseNumber=function(k,b,f,d){if(""===k)return"undefined"!==typeof f?f:NaN;if(null==k||"string"!==typeof k&&isNaN(k))return NaN;k=String(k);if(!k.trim())return void 0!==f?f:NaN;f=v.parse(k,{strict:d,locale:A.getDateNumberLocale()});isNaN(f)&&k.trim().length&&(f=d?v.parse(k,{strict:d,locale:"en-US"}):Number(k));return isNaN(f)||void 0===b||0>b?f:
v.round(f,b)};C.parsePercentOrCurrency=function(k,b,f,d,c){"string"===typeof k&&(k=k.replace("%",""),b&&(b=b.split(";")[0].replace("0",""),k=k.replace(b,"")));return C.parseNumber(k,f,d,c)};C.compareEqual=function(k,b,f){return void 0===f?k===b:Number(Number(k).toFixed(f))===Number(Number(b).toFixed(f))};return C})},"esri/dijit/geoenrichment/utils/DateUtil":function(){define(["dojo/date/locale","esri/moment"],function(v,A){var C={formatDate:function(t,k){t=C.objectToDate(t);k.locale=k.locale||C.getDateNumberLocale();
return t?v.format(t,k):""},formatMoment:function(t,k){return(t=C.objectToTime(t))?A(t).format(k):""},formatDateShort:function(t){return C.formatMoment(t,"L")},formatDateTimeShort:function(t){return C.formatMoment(t,"L LT")},formatLiveTime:function(t){var k=C.formatMoment(t,"l, LT").replace(/\d\d\d\d/,function(b){return b.substr(2)});return k?k+" "+C.formatDate(t,{datePattern:"ZZZZ",selector:"date"}):""},formatTypicalTime:function(t){return C.formatMoment(t,"ddd LT")},parseDateShort:function(t){return(t=
+A(t,"L"))?new Date(t):null},getReportFooterDate:function(t){return v.format(t||new Date,{datePattern:"MMMM d, yyyy",selector:"date"})},getFullYear:function(){return(new Date).getFullYear()},objectToTime:function(t){if(!t)return null;t="string"===typeof t?new Date(t):t;return t.getTime?t.getTime():Number(t)||null},objectToDate:function(t){return t?t.getTime?t:new Date(t):null},getDateNumberLocale:function(){return window.dojoConfig&&window.dojoConfig.extraLocale&&window.dojoConfig.extraLocale[0]||
window.dojo.locale}};return C})},"esri/moment":function(){define(["require","exports","./plugins/moment!"],function(v,A,C){return C})},"esri/plugins/moment":function(){define(["require","exports","dojo/_base/kernel","moment/moment"],function(v,A,C,t){Object.defineProperty(A,"__esModule",{value:!0});var k={ar:1,"ar-dz":1,"ar-kw":1,"ar-ly":1,"ar-ma":1,"ar-sa":1,"ar-tn":1,bg:1,bs:1,ca:1,cs:1,da:1,de:1,"de-at":1,"de-ch":1,el:1,"en-au":1,"en-ca":1,"en-gb":1,"en-ie":1,"en-il":1,"en-in":1,"en-nz":1,"en-sg":1,
es:1,"es-do":1,"es-mx":1,"es-us":1,et:1,fi:1,fr:1,"fr-ca":1,"fr-ch":1,he:1,hr:1,hu:1,id:1,it:1,"it-ch":1,ja:1,ko:1,lt:1,lv:1,nb:1,nl:1,"nl-be":1,pl:1,pt:1,"pt-br":1,ro:1,ru:1,sk:1,sl:1,sr:1,"sr-cyrl":1,sv:1,th:1,tr:1,uk:1,vi:1,"zh-cn":1,"zh-hk":1,"zh-mo":1,"zh-tw":1};A.load=function(b,f,d){b=C.locale;var c=b in k;if(!c){var a=b.split("-");1<a.length&&a[0]in k&&(b=a[0],c=!0)}c?f(["moment/locale/"+b],function(){d(t)}):d(t)}})},"esri/dijit/geoenrichment/utils/SortUtil":function(){define([],function(){function v(k,
b,f,d){k=void 0===k||null===k;return k!=(void 0===b||null===b)?(b=k?-1:1,(void 0===d?f:d)?-b:b):k?0:null}function A(k){var b=/^(.+)\s([1-9]\d*)$/.exec(k);return b?{base:b[1],number:b[2]}:/^[1-9]\d*$/.test(k)?{base:"",number:+k}:{base:k,number:0}}var C={NEWEST:"newest",OLDEST:"oldest",ALPHABETICAL:"alphabetical",UNALPHABETICAL:"unalphabetical",compareNumeric:function(k,b,f,d){d=v(k,b,f,d);if(null!==d)return d;k=Number(k);b=Number(b);d=k>b?1:k<b?-1:0;return f?-d:d},compareString:function(k,b,f,d){d=
v(k,b,f,d);if(null!==d)return d;k=String(k);b=String(b);d=k.localeCompare(b);return f?-d:d}},t=/^(.+)\s([1-9]\d*)(\D*)$/;C.compareNames=function(k,b,f,d){var c=A("string"===typeof k?k.toLowerCase():k),a=A("string"===typeof b?b.toLowerCase():b),e=null;if(c.base===a.base)e=C.compareNumeric(c.number,a.number,f,d);else{var g=t.exec(c.base);if(g){var p=t.exec(a.base);p&&g[1]===p[1]&&g[3]===p[3]&&(e=C.compareNumeric(g[2],p[2],f,d))}null===e&&(e=C.compareString(c.base,a.base,f,d))}return e||C.compareString(k,
b,f,d)};C.compare=function(k,b,f,d){var c=v(k,b,f,d);if(null!==c)return c;c=typeof k;typeof b!=c&&(c="");switch(c){case "number":case "boolean":break;case "object":k=k.valueOf();b=b.valueOf();break;default:return C.compareString(k,b,f,d)}c=k>b?1:k<b?-1:0;return f?-c:c};return C})},"esri/dijit/geoenrichment/utils/ArrayUtil":function(){define(["dojo/_base/array"],function(v){var A={},C={}.toString();A.arraysEqual=function(t,k){if(!t&&!k)return!0;if(!t||!k||t.length!==k.length)return!1;for(var b=0;b<
t.length;b++)if(t[b]!==k[b])return!1;return!0};A.composeIdentityFunction=function(t,k){var b="function"===typeof t?t:t?function(f){return f[t]}:function(f){return f};return function(f){return(f=b(f))&&f.toString?f.toString():k&&void 0===f?f:String(f)}};A.removeDuplicates=function(t,k){var b=[],f={};k=A.composeIdentityFunction(k,!0);v.forEach(t,function(d,c){var a=k(d);a===C&&(void 0===d["__ArrayUtil.js_uniqueKey__"]&&(d["__ArrayUtil.js_uniqueKey__"]="__ArrayUtil.js_uniqueKey__"+c),a=d["__ArrayUtil.js_uniqueKey__"]);
void 0===a||a in f||(f[a]=d,b.push(d))});return b};A.splitArrayToBunches=function(t,k){k=k||100;for(var b=[],f,d=0,c=t.length;d<c;d++)f&&f.length!==k||(f=[],b.push(f)),f.push(t[d]);return b};return A})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DomUtil":function(){define("dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/on ../../utils/ObjectUtil esri/dijit/geoenrichment/utils/DomUtil".split(" "),function(v,A,C,t,k,b,f){var d=Object.assign({},f);d.select=function(c){return d.addTag(c,
"selected")};d.unselect=function(c){return d.removeTag(c,"selected")};d.floatStart=function(c){return d.addTag(c,"esriMapsAnalystXFloatStart")};d.floatEnd=function(c){return d.addTag(c,"esriMapsAnalystXFloatEnd")};d.addSpacer=function(c,a){c=v.create("div",{"class":"esriMapsAnalystXSpacer",innerHTML:"\x26nbsp;"},c);if(a)d[a](c);return c};d.getAndUpdateNumber=function(c,a){if(!c)return NaN;var e=c.get&&c.set;void 0===a&&(a=0);var g=b.parseNumber(e?c.get("value"):c.value,a);isNaN(g)||(e?c.set("value",
b.formatNumber(g,a)):c.value=b.formatNumber(g,a));return g};d.getAndUpdateString=function(c){if(!c)return null;if(c.get&&c.set){var a=c.get("value").trim();c.set("value",a)}else a=c.value.trim(),c.value=a;return a};d.getScreenScaleFactor=function(){return d.getTextBox("",{style:"width: 72pt; height: 72pt"}).w/96};d.positionAtCenter=function(c,a){if(c&&a){var e=A.position(c);a=A.position(a);e.w&&e.h&&a.w&&a.h&&C.set(c,{left:(a.w-e.w)/2+"px",top:(a.h-e.h)/2+"px"})}};d.showAroundOverlay=function(c,a){a=
a||{};d.removeAroundOverlay(c);var e={w:"width",h:"height",l:"left",t:"top",r:"right",b:"bottom"},g=A.position(c);if(a.viewPortContainer){var p=A.position(a.viewPortContainer),z=g.x,l=g.y;g.x=Math.max(g.x,p.x);g.w-=g.x-z;g.y=Math.max(g.y,p.y);g.h-=g.y-l;g.w=Math.min(g.w,p.x+p.w-g.x);g.h=Math.min(g.h,p.y+p.h-g.y)}c.__aroundOverlays=(a.placeInNode?[{l:0,t:-g.y,w:g.w,h:g.y},{l:g.w,t:-g.y,w:document.body.clientWidth-(g.x+g.w),h:document.body.clientHeight},{l:0,t:g.h,w:g.w,h:document.body.clientHeight-
(g.y+g.h)},{l:-g.x,t:-g.y,w:g.x,h:document.body.clientHeight}]:[{l:g.x,t:0,w:g.w,h:g.y},{w:document.body.clientWidth-(g.x+g.w),r:0,t:0,b:0},{l:g.x,h:document.body.clientHeight-(g.y+g.h),w:g.w,b:0},{l:0,t:0,w:g.x,b:0}]).map(function(r){var G=v.create("div",{"class":a.overlayClass||"esriMapsAnalystXNodeAroundOverlay"},a.placeInNode?c:document.body),I={position:"absolute"},B;for(B in e)void 0!==r[B]&&(I[e[B]]=Math.round(r[B])+"px");C.set(G,I);return G});g=function(){d.removeAroundOverlay(c)};a.removeOnClick&&
(c.__aroundOverlaysRemoveHandle=k.once(document.body,"click",g));c.__aroundOverlaysResizeHandle=k(window,"resize",function(){d.showAroundOverlay(c,a)});var h;c.__aroundOverlaysSetIntervalHandle=setInterval(function(){if(h){var r=A.position(c);r.x==h.x&&r.y==h.y&&r.w==h.w&&r.h==h.h||d.showAroundOverlay(c,a)}else h=A.position(c)},50);return{remove:g}};d.removeAroundOverlay=function(c){c.__aroundOverlays&&c.__aroundOverlays.forEach(function(a){v.destroy(a)});delete c.__aroundOverlays;c.__aroundOverlaysRemoveHandle&&
c.__aroundOverlaysRemoveHandle.remove();delete c.__aroundOverlaysRemoveHandle;c.__aroundOverlaysResizeHandle&&c.__aroundOverlaysResizeHandle.remove();delete c.__aroundOverlaysResizeHandle;clearInterval(c.__aroundOverlaysSetIntervalHandle);delete c.__aroundOverlaysSetIntervalHandle};d.getDocumentStyleDeclaration=function(c){function a(p){try{var z=p.rules||p.cssRules}catch(h){z=null}if(z)for(p=0;p<z.length;p++){var l=z[p];if(l.styleSheet){if(l=a(l.styleSheet))return l}else if(l.selectorText==c)return l.style}}
for(var e=0;e<document.styleSheets.length;e++){var g=a(document.styleSheets[e]);if(g)return g}return null};d.getNodeFontFamily=function(c){return(c=C.get(c,"fontFamily")||C.getComputedStyle(c)["font-family"])?c.replace(/'|"/g,"").split(",")[0]:c};d.getNodeFontSize=function(c){return C.toPixelValue(c,C.get(c,"fontSize"))};d.listenToNodeAdded=function(c,a,e){if(d.isNodeInLayout(c))a();else{c.__listenToNodeAddedHandle&&c.__listenToNodeAddedHandle.remove();var g=setInterval(function(){d.isNodeInLayout(c)&&
(c.__listenToNodeAddedHandle&&c.__listenToNodeAddedHandle.remove(),a())},e||100);c.__listenToNodeAddedHandle={remove:function(){clearInterval(g);delete c.__listenToNodeAddedHandle}};return c.__listenToNodeAddedHandle}};d.isNodeVisible=function(c){return d.isChildOf(c,document.body,function(a){return!t.contains(a,"dijitHidden")&&"hidden"!=C.get(a,"visibility")})};d.enableHyperlink=function(c,a){a?t.replace(c,"esriMapsAnalystXLink","esriMapsAnalystXLinkDisabled"):t.replace(c,"esriMapsAnalystXLinkDisabled",
"esriMapsAnalystXLink")};return d})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/MouseUtil":function(){define(["dojo/dom-geometry","esri/dijit/geoenrichment/utils/MouseUtil"],function(v,A){var C;A.unitTesting_setCursorOverNode=function(t){t=v.position(t);A.unitTesting_setCursorPosition(t.x+t.w/2,t.y+t.h/2)};A.unitTesting_setCursorPosition=function(t,k){A._latestEvent={clientX:t,pageX:t,clientY:k,pageY:k}};A.unitTesting_lockPosition=function(t){C=t};A.unitTesting_shiftMousePosition=function(t,
k){A.unitTesting_setCursorPosition(A._latestEvent.clientX+(t||0),A._latestEvent.clientY+(k||0))};A._setLatestEvent=function(t){C||(A._latestEvent=t)};return A})},"esri/dijit/geoenrichment/utils/MouseUtil":function(){define("dojo/_base/lang dojo/on dojo/sniff dojo/touch dojo/dom-geometry ./DomUtil dojo/domReady!".split(" "),function(v,A,C,t,k,b){var f={_latestEvent:null,_setLatestEvent:function(e){f._latestEvent=e},_getLatestEvent:function(){return f._latestEvent}};C("touch")?(A(document.body,t.press,
function(e){f._setLatestEvent(a(e))}),A(document.body,t.move,function(e){f._setLatestEvent(a(e))})):A(document.body,"mousemove",function(e){f._setLatestEvent(a(e))});var d;A(document.body,"mousedown",function(){d||(d=!0,A.once(document.body,"mouseup, click",function(){d=!1}))});f.getCursorPosition=function(){return f._latestEvent};f.isMouseOver=function(e,g){var p=g&&g.event||f._latestEvent;if(!(e&&e.parentNode&&e.getBoundingClientRect&&p))return!1;if(g&&g.checkAllChildren){g=v.mixin({},g);delete g.checkAllChildren;
var z=!1;b.traverseChildren(e,function(l){if(f.isMouseOver(l,g))return z=!0});return z}return f.isMouseOverBox(k.position(e),g)};f.isMouseOverBox=function(e,g){if(!e)return!1;var p=g&&g.event||f._latestEvent;g&&g.ignoreBorderTolerance&&(g=g.ignoreBorderTolerance,e=v.mixin({},e),e.x+=g,e.y+=g,e.w-=2*g,e.h-=2*g);return e.x<=p.clientX&&e.x+e.w>=p.clientX&&e.y<=p.clientY&&e.y+e.h>=p.clientY};var c=function(e){if(e.touches){if(!e.touches.length)return e.changedTouches[0];for(var g=e.touches[0].identifier,
p,z=0;z<e.changedTouches.length;z++)if(e.changedTouches[z].identifier===g){p=e.changedTouches[z];break}return p||e.touches[0]}},a=function(e){var g=c(e);g&&(g.type=e.type);return g||e};f.fixTouchEvent=function(e){var g=c(e);g&&(e.screenX=g.screenX,e.screenY=g.screenY,e.clientX=g.clientX,e.clientY=g.clientY,e.pageX=g.pageX,e.pageY=g.pageY);return e};f.isBeingDragged=function(){return d};f.addOverOutHandler=function(e){function g(){clearTimeout(z);p&&p.remove()}var p,z,l=A(e.node,"mouseover",function(h){function r(){f.isMouseOver(e.node)&&
(e.onMouseOver(h),p=A(document.body,"mousemove",function(G){f.isMouseOver(e.node)||(g(),e.onMouseOut(G))}))}g();e.delayTimeout?z=setTimeout(r,e.delayTimeout):r()});return{remove:function(){l.remove();g()}}};f.addOutHandler=function(e,g){return A(document.body,"mousemove",function(p){f.isMouseOver(e,{checkAllChildren:!0})||g(p)})};return f})},"widgets/BusinessAnalyst/esriAnalystX/dijit/tooltips/TooltipUtil":function(){define("dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/dom-class dojo/query dojo/on dojox/gfx dojo/sniff dojo/aspect dojox/uuid/generateRandomUuid dijit/Tooltip ../utils/DomUtil ../utils/MouseUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/domReady!".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z){function l(){F&&(F.isMultilineContainer?B.hideTooltipForNode(F):(clearInterval(F.__autoTooltipInLayoutCheckHandle),delete F.__autoTooltipInLayoutCheckHandle,e.hide(F)),F=null)}function h(y,x){x=x||"";var w=v.create("div",{class:"esriMapsAnalystXValidationTooltip"+x},document.body);!x&&v.create("div",{class:"esriMapsAnalystXValidationTooltipTip"+x},w);v.create("div",{innerHTML:y,class:"esriMapsAnalystXValidationTooltipBody"+x},w);A.set(w,"position","fixed");return w}
function r(y,x){function w(){y&&(document.body.removeChild(y),H.forEach(function(K){K.remove()}),y=H=null)}x=x.textbox||x;var n=C.getMarginBox(y),q=C.position(x);"rtl"===document.dir?A.set(y,{left:q.x-n.w+"px",top:q.y+q.h/2-n.h/2+"px"}):A.set(y,{left:q.x+q.w+"px",top:q.y+q.h/2-n.h/2+"px"});var H=[b(document.body,"mousedown, keydown",w),b(x,"blur",w)];return{remove:w}}function G(y,x,w){function n(){var u=v.create("div",{class:"esriMapsAnalystXClosableTooltipTip"},H);t.add(u,"right"===w?"esriMapsAnalystXClosableTooltipTipRight":
"esriMapsAnalystXClosableTooltipTipLeft")}function q(){K=v.create("div",{class:"esriMapsAnalystXClosableTooltipBody"},H);v.create("div",{innerHTML:y,class:"esriMapsAnalystXClosableTooltipLabel"},K);m=v.create("div",{class:"esriMapsAnalystXClosableTooltipCloseButton esriMapsAnalystXCloseWindow esriMapsAnalystXCloseWindowWhite"},K)}x={class:"esriMapsAnalystXClosableTooltip "+(x||"")};x.id=a();var H=v.create("div",x,document.body),K,m;"right"!==w?(q(),n()):(n(),q());A.set(H,"position","fixed");return{tooltip:H,
body:K,closeButton:m}}function I(y,x,w,n){var q=C.getMarginBox(y.tooltip),H=C.position(x);"rtl"===document.dir&&"right"!==n||"rtl"!==document.dir&&"right"===n?A.set(y.tooltip,{left:H.x+H.w+"px",top:H.y+H.h/2-q.h/2+"px"}):A.set(y.tooltip,{left:H.x-q.w+"px",top:H.y+H.h/2-q.h/2+"px"});var K,m=function(){K&&clearTimeout(K);u&&clearInterval(u);D&&D.remove();y.tooltip.parentNode===document.body&&document.body.removeChild(y.tooltip)};var u=setInterval(function(){g.isNodeInLayout(x)||m();g.isNodeVisible(x)?
g.show(y.tooltip):g.hide(y.tooltip)},300);w&&(K=setTimeout(m,w));var D=b(y.closeButton,"click",function(){m()});y.tooltip._removeFunc=m;return y.tooltip}var B={},E={};B.hideTooltipForNode=z.hideTooltipForNode;B.setTooltipToNode=z.setTooltipToNode;B.createTooltip=function(y,x,w){var n={orientation:C.isBodyLtr(document)?"right":"left",offset:{x:15,y:0}};x&&(n.innerHTML=x);w&&(n=Object.assign(n,w));n.id=a();n.toMouseCursor&&(n.mouseEvent=p.getCursorPosition(),delete n.toMouseCursor);x=n.mouseEvent;delete n.mouseEvent;
w=n.htmlFragment;delete n.htmlFragment;var q=n.widget;delete n.widget;var H=n.orientation;delete n.orientation;var K=n.offset;delete n.offset;var m=n.horizontalOffset;delete n.horizontalOffset;var u=v.create("div",n,y?y.container:document.body);w?v.place(w,u):q&&q.placeAt(u);A.set(u,"position","fixed");var D=C.getMarginBox(u),M=function(L,N){var O=L.touches?event.touches[0].clientX:L.clientX;L=L.touches?event.touches[0].clientY:L.clientY;var Q,P,S=K.x,R=K.y;"left"===H?0>O-D.w-S&&(Q="right"):O+D.w+
S>document.body.clientWidth&&(Q="left");L+D.h+R>document.body.clientHeight&&(P="above");Q=Q||H;A.set(u,{left:N?N+"px":O+("left"===Q?-D.w-S:S)+"px",top:L+("above"===P?-D.h-R:R)+"px"});u.style.display=""};x&&M(x,m);n=[];n.push(b(y?y:document.body,y?"mouse-move, mousemove":"mousemove, touchmove",function(L){M(L,m)}));n.push(b(y?y:document.body,y?"mouse-out, mouseout":"mouseout, touchend",function(L){u.style.display="none"}));y={};y.handlers=n;y.tooltip=u;E[u.id]=y;return u};B.removeTooltip=function(y){if(y){y=
"string"===typeof y?y:y.id;var x=E[y];delete E[y];x&&(x.handlers.forEach(function(w){w.remove()}),v.destroy(x.tooltip))}};var J={};B.registerTooltipForSlider=function(y,x,w,n){var q={offsetX:0,offsetY:0,class:"esriMapsAnalystXTooltip"};x&&(q=Object.assign(q,x));q.id=a();var H=v.create("div",q,document.body);H.style.display="none";A.set(H,"position","fixed");var K=!1,m=function(D,M){if(!K){K=!0;H.style.display="";H.innerHTML=M();var L=C.getMarginBox(H),N=C.position(D);A.set(H,{left:N.x+N.w/2-L.w/2+
q.offsetX+"px",top:N.y-L.h-5+q.offsetY+"px"});var O=[];O.push(c.after(y,"onChange",function(){H.innerHTML=M();N=C.position(D);A.set(H,{left:N.x+N.w/2-L.w/2+"px",top:N.y-L.h-5+"px"})}));var Q=function(){H.style.display="none";O.forEach(function(S){S.remove()});K=!1},P=!1;O.push(b(D,"mousedown, mouseDown, mouse-down",function(){P=!0;O.push(b(document,"mouseup, mouseUp, mouse-up",function(){Q()}))}));O.push(b(D,"mouseout, mouseOut, mouse-out",function(){P||Q()}))}};x=[];x.push(b(y.sliderHandle,"mouseover, mouseOver, mouse-over",
function(){n&&y.isSliderDisabled&&y.isSliderDisabled()||m(y.sliderHandle,function(){var D=n?y.get("value")[0]:y.get("value");return w?w(D):D})}));n&&x.push(b(y.sliderHandleMax,"mouseover, mouseOver, mouse-over",function(){y.isSliderDisabled&&y.isSliderDisabled()||m(y.sliderHandleMax,function(){return w?w(y.get("value")[1]):y.get("value")[1]})}));x.push(c.before(y,"destroy",function(){B.unregisterTooltipForSlider(y)}));y.tooltipId=H.id;var u={};u.tooltip=H;u.handlers=x;J[H.id]=u};B.unregisterTooltipForSlider=
function(y){var x=J[y.tooltipId];x&&(x.handlers.forEach(function(w){w.remove()}),v.destroy(x.tooltip));delete J[y.tooltipId];delete y.tooltipId};var F=null;B.autoTooltip=function(y,x,w){"string"===typeof x&&(x=x.split(" ").filter(function(q){return q&&!!q.trim().length}));x=x||[];x.push("TrimWithEllipses");w=w||[];w.push("esriMapsAnalystXInfoIcon");for(var n=0;n<x.length;n++)b(y,"."+x[n]+":mouseover, "+x[n]+":touchstart, ",function(q){this!==F&&this.offsetWidth<this.scrollWidth&&!this.noAutoTooltip&&
(q=getComputedStyle(this).width,q=Number(q.substr(0,q.length-2)),0>q-Math.round(q)&&this.offsetWidth==this.scrollWidth-1||(l(),F=this,q=F.autoTooltip||F.textContent||F.value,F.title&&(q+=" ("+F.title+")"),q&&e.show(q,F,["above","below"]),b.once(F,"mouseout, touchstart, touchout",function(){l()}),F.__autoTooltipInLayoutCheckHandle=setInterval(function(){g.isNodeInLayout(F)||l()},500)))});if(d("touch"))for(n=0;n<w.length;n++)b(y,"."+w[n]+":touchstart ",function(q){this!==F&&(F=this,F.title&&(e.show(F.title,
F,["above","below"]),b.once(F,"touchstart, touchout",function(){e.hide(F);F=null})))})};B.addAutoTooltipsToTabContainer=function(y){k(".tabLabel",y.domNode).forEach(function(x){t.add(x,"TrimWithEllipses")});B.autoTooltip(y)};B.setMultilineText=function(y,x,w,n){w=w||2;x=x.trim();n=n||["above","below"];t.remove(y,"TrimWithEllipses");y.style.overflow="hidden";y.innerHTML="";for(var q=x,H=!1;q;){w--;var K=v.create("div",null,y);K.style.overflow="hidden";K.style.whiteSpace="nowrap";for(var m=q;m;)if(K.textContent=
m,K.offsetWidth<K.scrollWidth-1)m=(m=m.match(/^(.*[^\s]+)\s+[^\s]+$/))&&m[1]||"";else break;!m||!w&&m!==q?(K.textContent=q,q="",K.style.textOverflow="ellipsis",H=!0):q=q.substr(m.length).trim()}H&&B.setTooltipToNode(y,function(){l();F=y;F.isMultilineContainer=!0;return x},{position:n})};B.showErrorTip=function(y,x){return r(h(x),y.domNode||y)};B.showNewStyleErrorTip=function(y,x,w){return r(h(x,"NewStyle"+(w?" esriMapsAnalystXWarningStyle":"")),y.domNode||y)};B.showAlertTooltip=function(y){y&&y.node&&
y.message&&(e.show(y.message,y.node,y.position||["above","below"]),setTimeout(function(){e.hide(y.node)},y.timeout||5E3))};B.showClosableTooltip=function(y){var x=G(y.message,y.tooltipClass,y.position);return I(x,y.component,y.timeout,y.position)};B.removeClosableTooltip=function(y){y&&y._removeFunc&&y._removeFunc()};B.showClosableTooltipOnVerticalBracket=function(y){var x=y.below||y.above,w=C.position(y.above,!0),n=C.position(x,!0),q="rtl"!==document.dir?"start"===y.direction:"end"===y.direction,
H=w.x+w.w*(q?0:1);w=w.y;var K=n.y+n.h,m=v.create("div",{class:"esriMapsAnalystFlexibleTooltip_tooltip esriMapsAnalystXNonSelectable"},document.body),u=v.create("div",{class:"esriMapsAnalystFlexibleTooltip_surfaceContainer"},m);n={};H={top:w-2,left:H+(q?-3:3),height:K-w+4,width:10};for(var D in H)n[D]=H[D]+"px";A.set(m,n);var M=f.createSurface(u,H.width,H.height);M.clear();M.createPolyline([{x:q?H.width:0,y:0},{x:q?0:H.width,y:0},{x:q?0:H.width,y:H.height},{x:q?H.width:0,y:H.height}]).setStroke({color:"#6E6E6E",
width:6});y.component=m;q=G(y.message,y.tooltipClass,y.position);var L=function(){clickHandler&&clickHandler.remove();N&&clearInterval(N);M&&M.clear();v.destroy(u);v.destroy(m)},N=setInterval(function(){g.isNodeInLayout(x)||L();g.isNodeVisible(x)?A.set(m,"visibility","visible"):A.set(m,"visibility","hidden")},300);y.timeout&&setTimeout(L,y.timeout);clickHandler=b(q.closeButton,"click",L);tooltip=I(q,y.component,y.timeout,y.position);var O=tooltip._removeFunc;tooltip._removeFunc=function(){O();L()};
return tooltip};return B})},"dojox/uuid/generateRandomUuid":function(){define(["./_base"],function(){dojox.uuid.generateRandomUuid=function(){function v(){for(var b=Math.floor(Math.random()%1*Math.pow(2,32)).toString(16);8>b.length;)b="0"+b;return b}var A=v(),C=v();C=C.substring(0,4)+"-4"+C.substring(5,8);var t=v();t="8"+t.substring(1,4)+"-"+t.substring(4,8);var k=v();return(A+"-"+C+"-"+t+k).toLowerCase()};return dojox.uuid.generateRandomUuid})},"dojox/uuid/_base":function(){define(["dojo/_base/kernel",
"dojo/_base/lang"],function(v){v.getObject("uuid",!0,dojox);dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(A,C){if(!A)throw C||(C="An assert statement failed.\nThe method dojox.uuid.assert() was called with a 'false' value.\n"),Error(C);};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID};
dojox.uuid.isValid=function(A){A=A.toString();var C=v.isString(A)&&36==A.length&&A==A.toLowerCase();if(C){A=A.split("-");C=5==A.length&&8==A[0].length&&4==A[1].length&&4==A[2].length&&4==A[3].length&&12==A[4].length;for(var t in A){var k=parseInt(A[t],16);C=C&&isFinite(k)}}return C};dojox.uuid.getVariant=function(A){if(!dojox.uuid._ourVariantLookupTable){var C=dojox.uuid.variant,t=[];t[0]=C.NCS;t[1]=C.NCS;t[2]=C.NCS;t[3]=C.NCS;t[4]=C.NCS;t[5]=C.NCS;t[6]=C.NCS;t[7]=C.NCS;t[8]=C.DCE;t[9]=C.DCE;t[10]=
C.DCE;t[11]=C.DCE;t[12]=C.MICROSOFT;t[13]=C.MICROSOFT;t[14]=C.UNKNOWN;t[15]=C.UNKNOWN;dojox.uuid._ourVariantLookupTable=t}A=A.toString();A=A.charAt(19);A=parseInt(A,16);dojox.uuid.assert(0<=A&&16>=A);return dojox.uuid._ourVariantLookupTable[A]};dojox.uuid.getVersion=function(A){dojox.uuid.assert(dojox.uuid.getVariant(A)==dojox.uuid.variant.DCE,"dojox.uuid.getVersion() was not passed a DCE Variant UUID.");A=A.toString();A=A.charAt(14);return parseInt(A,16)};dojox.uuid.getNode=function(A){dojox.uuid.assert(dojox.uuid.getVersion(A)==
dojox.uuid.version.TIME_BASED,"dojox.uuid.getNode() was not passed a TIME_BASED UUID.");A=A.toString();return A.split("-")[4]};dojox.uuid.getTimestamp=function(A,C){dojox.uuid.assert(dojox.uuid.getVersion(A)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.");A=A.toString();C||(C=null);switch(C){case "string":case String:return dojox.uuid.getTimestamp(A,Date).toUTCString();case "hex":var t=A.split("-");A=t[0];C=t[1];t=t[2];t=t.slice(1);A=t+C+A;dojox.uuid.assert(15==
A.length);return A;case null:case "date":case Date:return t=A.split("-"),A=parseInt(t[0],16),C=parseInt(t[1],16),t=(parseInt(t[2],16)&4095)<<16,t=4294967296*(t+C),t+=A,new Date(t/1E4-122192928E5);default:dojox.uuid.assert(!1,"dojox.uuid.getTimestamp was not passed a valid returnType: "+C)}};return dojox.uuid})},"esri/dijit/geoenrichment/utils/TooltipUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/on dojo/mouse dojo/sniff dijit/Tooltip dijit/place dojox/gfx ./DeviceUtil ./DnDUtil ./DomUtil ./MouseUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/domReady!".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l,h,r){function G(){}var I={},B=v(a._MasterTooltip,{_customClasses:null,_customStyle:null,_orientKey:null,addCustomClasses:function(w){w&&(C.add(this.domNode,w),this._customClasses=w)},setCustomStyle:function(w){this._customStyle=w},show:function(w,n,q,H,K,m,u){if(!this.aroundNode||this.aroundNode!==n||this.containerNode.innerHTML!=w)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{"string"===typeof w?this.containerNode.innerHTML=w:(this.containerNode.innerHTML=
"",t.place(w.domNode||w,this.containerNode));K&&this.set("textDir",K);this.containerNode.align=H?"right":"left";var D=e.around(this.domNode,n,q&&q.length?q:a.defaultPosition,!H,A.hitch(this,"orient")),M=D.aroundNodePos;"M"==D.corner.charAt(0)&&"M"==D.aroundCorner.charAt(0)?(this.connectorNode.style.top=M.y+(M.h-this.connectorNode.offsetHeight>>1)-D.y+"px",this.connectorNode.style.left=""):"M"==D.corner.charAt(1)&&"M"==D.aroundCorner.charAt(1)?this.connectorNode.style.left=M.x+(M.w-this.connectorNode.offsetWidth>>
1)-D.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");this._drawBackground();this.domNode.style.opacity="0";this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=n;this.onMouseEnter=m||G;this.onMouseLeave=u||G}},orient:function(w,n,q,H,K){this.connectorNode.style.top="";var m=H.h;H=H.w;w.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[this._orientKey=n+"-"+q];this.addCustomClasses(this._customClasses);this.domNode.style.width="auto";var u=k.position(this.domNode);u.w=Math.ceil(u.w);if(c("ie")||c("trident"))u.w+=2;k.setMarginBox(this.domNode,{w:Math.min(Math.max(H,1),u.w)});"B"==q.charAt(0)&&"B"==n.charAt(0)?(w=k.position(w),n=this.connectorNode.offsetHeight,
w.h>m?(this.connectorNode.style.top=m-(K.h+n>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(K.h/2-n/2,0),w.h-n)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");this._drawBackground();return Math.max(0,u.w-H)},_surface:null,_surfaceContainer:null,_drawBackground:function(){if(this._orientKey){var w=this.domNode.clientWidth,n=this.domNode.clientHeight,q=k.position(this.domNode),H=k.position(this.connectorNode),
K=k.position(this.containerNode);H.x-=q.x;H.y-=q.y;K.x-=q.x;K.y-=q.y;K.x+=1;K.y+=1;K.w-=2;K.h-=2;this._surface&&this._surface.destroy();this._surfaceContainer&&t.destroy(this._surfaceContainer);q=this._surfaceContainer=t.create("div",{"class":"esriGEAbsoluteStretched"},this.domNode,"first");q.style.pointerEvents="none";w=this._surface=g.createSurface(q,w,n);n=[{x:K.x,y:K.y},{x:K.x+K.w,y:K.y},{x:K.x+K.w,y:K.y+K.h},{x:K.x,y:K.y+K.h},{x:K.x,y:K.y}];q=H.x+H.w/2;H=H.y+H.h/2;switch(this._orientKey){case "BL-TL":case "BM-TM":case "BR-TR":K=
[{x:q-5,y:K.y},{x:q,y:H},{x:q+5,y:K.y}];n.splice.apply(n,[1,0].concat(K));break;case "ML-MR":case "BL-BR":K=[{x:K.x+K.w,y:H-5},{x:q,y:H},{x:K.x+K.w,y:H+5}];n.splice.apply(n,[2,0].concat(K));break;case "TM-BM":case "TL-BL":case "TR-BR":K=[{x:q+5,y:K.y+K.h},{x:q,y:H},{x:q-5,y:K.y+K.h}];n.splice.apply(n,[3,0].concat(K));break;case "MR-ML":case "BR-BL":K=[{x:K.x,y:H+5},{x:q,y:H},{x:K.x,y:H-5}],n.splice.apply(n,[4,0].concat(K))}K=w.createPolyline(n);H="function"===typeof this._customStyle?this._customStyle():
this._customStyle;K.setFill(H&&H.backgroundColor||"white").setStroke({color:"#d3d3d3",width:1,join:"round"});H&&H.color&&(this.containerNode.style.color=H.color)}}}),E={show:function(w,n,q,H,K){"string"===typeof q&&(q=[q]);q=q&&q.map(function(u){return{after:"after-centered",before:"before-centered"}[u]||u});var m=new B;K&&m.setCustomStyle(K);m.addCustomClasses(H);m.show(w,n,q);return m}};I.setTooltipToNode=function(w,n,q){function H(){!K&&I.showTooltipForNode(w,n,q)}q=q||{};if(w&&!r.isPlayerOnServer&&
(I.hideTooltipForNode(w),w.__setTooltipToNodeMouseEnterHandle&&w.__setTooltipToNodeMouseEnterHandle.remove(),n)){var K=!1;p.isMobileDevice()?w.__setTooltipToNodeMouseEnterHandle=z.addNoDragClickHandler(w,H):w.__setTooltipToNodeMouseEnterHandle=f(w,d.enter,H);q.showTooltip&&H();return{remove:function(){n=null;I.hideTooltipForNode(w)},suspend:function(){I.hideTooltipForNode(w);K=!0},resume:function(){K=!1},refresh:function(){w._shownTooltip&&H()}}}};I.showTooltipForNode=function(w,n,q){function H(){I.hideTooltipForNode(w);
var D=Array.isArray(q.classes)?q.classes.join(" "):q.classes;D=(D||"")+" esriGETooltip";q.notRestricted&&(D+=" notRestricted");w._shownTooltip=m=E.show(K,w,q.position||["after","before"],D,q.style)}q=q||{};if(w&&!r.isPlayerOnServer){w.title="";I.hideTooltipForNode(w);var K="function"==typeof n?n():n;if(K){"string"===typeof K&&q.textAlign&&(K="\x3cdiv class\x3d'"+("start"===q.textAlign?"esriGEStart":"end"===q.textAlign?"esriGEEnd":"")+"'\x3e"+K+"\x3c/div\x3e");C.add(w,"esriGESimpleTextTooltip");var m;
H();var u=I.hideTooltipForNode.bind(I,w);n=function(D,M){var L=setInterval(D,M);m.own({remove:function(){clearInterval(L)}})};p.isMobileDevice()?m.own(f(document.body,"touchstart",function(D){!h.isMouseOver(w,{event:D})&&u()})):m.own(f.once(w,d.leave,function(){!q.stayOnHover&&u()}));q.ignoreNodeRemoval||n(function(){!l.isNodeInLayout(w)&&u()},300);p.isMobileDevice()||(n(function(){q.stayOnHover&&h.isMouseOver(m.domNode)||h.isMouseOver(w)||u()},300),m.own(f(w,"click",function(D){q.hideOnClick?u():
!w._shownTooltip&&H()})),q.stayOnHover&&m.own(f(m.domNode,d.leave,u)));return w._shownTooltip}}};I.hideTooltipForNode=function(w){w&&w._shownTooltip&&(C.remove(w,"esriGESimpleTextTooltip"),w._shownTooltip.destroy(),delete w._shownTooltip)};var J,F;I.autoTooltip=function(w){r.isPlayerOnServer||f(w,".TrimWithEllipses:mouseover",function(){if(this!==J&&this.offsetWidth<this.scrollWidth){var n=function(){J=null;F&&(F.tooltip.destroy(),F.mouseOutH.remove(),F.mouseMoveH.remove(),F=null)};n();J=this;F={tooltip:E.show(J.textContent,
J,["above","below"]),mouseOutH:f.once(J,"mouseout, mousedown, touchstart",n),mouseMoveH:f(document.body,"mousemove",function(){h.isMouseOver(J)||n()})}}})};I.showClosableTooltip=function(w){var n="rtl"===document.dir&&"after"!==w.position||"rtl"!==document.dir&&"after"===w.position,q=y(w.message,w.tooltipClass,w.position,n);return x(q,w.node,w.timeout,n,w.onClosed)};I.removeClosableTooltip=function(w){w&&w._removeFunc&&w._removeFunc()};var y=function(w,n,q,H){function K(){var L=t.create("div",{"class":"esriGEClosableTooltipTip"},
u);C.add(L,H?"esriGEClosableTooltipTipRight":"esriGEClosableTooltipTipLeft")}function m(){D=t.create("div",{"class":"esriGEClosableTooltipBody"},u);t.create("div",{innerHTML:w,"class":"esriGEClosableTooltipLabel"},D);M=t.create("div",{"class":"esriGEClosableTooltipCloseButton"},D)}var u=t.create("div",{"class":"esriGEClosableTooltip esriGENonSelectable"+(n?" "+n:"")},document.body),D,M;"after"!==q?(m(),K()):(K(),m());u.style.position="fixed";return{tooltip:u,body:D,closeButton:M}},x=function(w,n,
q,H,K){function m(){var P=k.position(n),S=P.x+";"+P.y+";"+P.w+";"+P.h;S!==u&&(u=S,S=k.getMarginBox(w.tooltip),b.set(w.tooltip,{left:(H?P.x+P.w:P.x-S.w)+"px",top:P.y+P.h/2-S.h/2+"px"}))}var u;m();var D,M,L=function(){D&&clearTimeout(D);N&&clearInterval(N);O&&clearInterval(O);Q&&Q.remove();w.tooltip.parentNode&&w.tooltip.parentNode.removeChild(w.tooltip)};var N=setInterval(function(){l.isNodeInLayout(n)&&n.parentNode||(M=!1,L());l.isNodeVisible(n)&&l.isNodeOnscreen(n)?(M=!0,l.show(w.tooltip)):(M=!1,
l.hide(w.tooltip))},0);var O=setInterval(function(){M&&m()},0);q&&(D=setTimeout(L,q));var Q=f(w.closeButton,"click",function(){L();K&&K()});w.tooltip._removeFunc=L;return w.tooltip};I.showTooltipForNode(document.body,"Normal \x3cb\x3eBold\x3c/b\x3e \x3ci\x3eItalic\x3c/i\x3e",{});I.hideTooltipForNode(document.body);return I})},"esri/dijit/geoenrichment/utils/DnDUtil":function(){define(["dojo/on","dojo/sniff","./DeviceUtil","./KeyboardUtil"],function(v,A,C,t){var k={MOBILE_TOLERANCE:10,LONG_PRESS_TIMEOUT:500,
addNoDragClickHandler:function(b,f,d){d=d||{};return C.isMobileDevice()?k._addMobile(b,f,d):k._addPC(b,f,d)},_addPC:function(b,f,d){var c=d.tolerance||0,a,e,g=v(b,"mousedown",function(p){e&&e.remove();var z=p.clientX,l=p.clientY,h;a=v(document.body,"mousemove",function(r){if(!r.shiftKey&&!t.isCtrl(r)){var G=r.clientY;if(0<Math.abs(r.clientX-z)||0<Math.abs(G-l))h=!0}});e=v.once(document.body,"mouseup",function(r){a.remove();var G=r.clientX,I=r.clientY;!h&&Math.abs(G-z)<=c&&Math.abs(I-l)<=c&&f(r)})});
return{remove:function(){a&&a.remove();e&&e.remove();g&&g.remove()}}},_addMobile:function(b,f,d){function c(){e&&e.remove();g&&g.remove();p&&p.remove();clearTimeout(z)}var a=d.tolerance||k.MOBILE_TOLERANCE,e,g,p,z;var l=v(b,"touchstart",function(h){function r(B){return Math.abs(h.clientX-B.clientX)<a&&Math.abs(h.clientY-B.clientY)<a}c();var G;if(d.detectLongPress){var I;g=v(b,"touchmove",function(B){I=B});z=setTimeout(function(){r(I||h)&&(d.ignoreReleaseIfLongPressHappened&&(G=!0),d.longPressCallback(h))},
d.longPressTimeout||k.LONG_PRESS_TIMEOUT)}e=v.once(b,"touchend",function(B){!G&&r(B)&&f(B);c()});p=v.once(b,"touchcancel",c)});return{remove:function(){l&&l.remove();c()}}},addGlobalDragHanlder:function(b){function f(){d&&d.remove();c&&c.remove();a&&a.remove();e&&e.remove();g&&b.destroyDnDBox&&b.destroyDnDBox(g)}b.tolerance=0<b.tolerance?b.tolerance:5;var d,c,a,e,g;return v(b.node,b.downEventName||C.press,function(p){f();if(!b.onMouseDown||b.onMouseDown(p)){var z=p.clientX,l=p.clientY,h=z,r=l;d=v(document.body,
C.move,function(G){function I(){f();b.dragEnded&&b.dragEnded()}G.shiftKey||t.isCtrl(G)||!(Math.abs(z-G.clientX)>=b.tolerance||Math.abs(l-G.clientY)>=b.tolerance)||(d.remove(),b.dragStarted&&!b.dragStarted(G,G.clientX-h,G.clientY-r))||(h=G.clientX,r=G.clientY,g=b.createDnDBox&&b.createDnDBox(),c=v(document.body,C.move,function(B){b.dragMoved&&b.dragMoved(B,B.clientX-h,B.clientY-r,I);h=B.clientX;r=B.clientY}),a=v.once(document.body,A("ie")||A("trident")?"mouseup, touchend, click":"mouseup, touchend",
function(){I()}),e=v(document.body,"keyup",function(B){27==B.keyCode&&(f(),b.dragCanceled&&b.dragCanceled())}))});v.once(document.body,A("ie")||A("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){d.remove()})}})}};return k})},"esri/dijit/geoenrichment/ReportPlayer/config":function(){define(["esri/kernel"],function(v){function A(C){C=C.split(".");return Number((Number(C[0])+Number(C[1])/100).toFixed(2))}v=Math.max(A("3.37"),A(v.version)).toFixed(2);return{jsapiVersion:v,esriDijitCssUrl:"https://js.arcgis.com/"+
v+"/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/"+v+"/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/"+v+"/",configScriptText:null,env:"prod",isPlayerOnServer:!1,updateVariableInfoFromDataXml:!0,runReportTask:{cacheResult:!0,ignoreErrors:!0,secondAttempt:!0},maps:{maxNumberOfMapsShownAtTheSameTime:6},charts:{showErrorIfHasUnavailableData:!1},tables:{leaveEmptyCellsUponError:!0,showUnavailableData:!0},createImageCommand:{skipSavingFile:!1},createPDFCommand:{skipSavingFile:!1,
skipCreditConsumption:!1},createPlayerCommand:{loadMapPortalItems:!0,compressData:!1,prettifyDataJson:!1,skipCreditConsumption:!1},exportToExcel:{skipSavingFile:!1},modules:{exportCommands:!0,complexCellTooltips:!0,paths:{panoramicViewer:null}},generalization:{factor:-1,maxVerticesInAllFeatures:1E5,numVerticesPerFeature:5E4}}})},"widgets/BusinessAnalyst/utils/GEUtil":function(){define("dojo/_base/array dojo/when esri/request ./GeocodeUtil esri/geometry/webMercatorUtils esri/dijit/geoenrichment/utils/FileUtil jimu/portalUtils".split(" "),
function(v,A,C,t,k,b,f){var d={},c={};return{getAvailableCountries:function(){return f.getPortal(portalUrl).loadSelfInfo().then(function(a){return C({url:(a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Countries",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"}).then(function(e){v.forEach(e.countries,function(g){v.forEach(g.hierarchies,
function(p){p.default&&(d[g.id]=p.ID)});c[g.id]=!!g.disableMultiHierarchySupport});return e})})},createRingOrDriveTimes:function(a){return f.getPortal(portalUrl).loadSelfInfo().then(function(e){return C({url:(e&&e.helperServices&&e.helperServices.geoenrichment&&e.helperServices.geoenrichment.url?e.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",useData:JSON.stringify({sourceCountry:a.sourceCountry}),
studyAreasOptions:JSON.stringify(a.studyAreasOptions),dataCollections:JSON.stringify(["GlobalIntersect"]),returnGeometry:!0,outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:a.geometry}]),token:esri.id.credentials[0].token},handleAs:"json"})})},createReport:function(a){var e={appID:"webappbuilder",langCode:"en-us",report:"string"===typeof a.report?a.report:JSON.stringify(a.report),format:"pdf",f:"bin",token:esri.id.credentials[0].token,useData:JSON.stringify({sourceCountry:a.sourceCountry}),
studyAreas:JSON.stringify(a.studyAreas),reportFields:JSON.stringify({locationname:a.locationName,latitude:a.lat,longitude:a.long,subtitle:"Prepared by Esri",areadesc2:a.areadesc2})};return f.getPortal(portalUrl).loadSelfInfo().then(function(g){return C({url:(g&&g.helperServices&&g.helperServices.geoenrichment&&g.helperServices.geoenrichment.url?g.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/createReport",content:e,
handleAs:"blob"}).then(function(p){return b.saveAs(p,a.reportDownloadName+".pdf")}).otherwise(function(p){alert("Error: "+p)})})},checkCapabilities:function(a){return f.getPortal(portalUrl).loadSelfInfo().then(function(e){var g=!1,p=!1,z=e&&e.user&&e.user.privileges,l=e&&e.helperServices;e=l.geoenrichment&&l.geoenrichment.url;l=l.routingUtilities&&l.routingUtilities.url;var h=e?e:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!a.mode&&a.appProxies&&
0<a.appProxies.length&&v.some(a.appProxies,function(r){return h.toLowerCase()===r.sourceUrl.toLowerCase()})?p=g=!0:v.forEach(z,function(r){"premium:user:geoenrichment"===r?g=!0:"premium:user:networkanalysis"===r&&(p=!0)});return{hasPrivilege:g&&p,geServiceConfigured:!!e,dirRoutingServiceConfigured:!!l}})},getCountryForPolygon:function(a,e,g){return f.getPortal(portalUrl).loadSelfInfo().then(function(p){return C({url:(p&&p.helperServices&&p.helperServices.geoenrichment&&p.helperServices.geoenrichment.url?
p.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",dataCollections:JSON.stringify(["GlobalIntersect"]),outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:a.toJson()}]),token:esri.id.credentials[0].token},handleAs:"json"}).then(function(z){if(z&&z.results&&1===z.results.length&&1===z.results[0].value.FeatureSet[0].features.length)return z.results[0].value.FeatureSet[0].features[0].attributes.sourceCountry;
if(z&&z.results&&1===z.results.length&&1<z.results[0].value.FeatureSet[0].features.length){var l=a.getCentroid();l=k.xyToLngLat(l.x,l.y);var h=function(r){var G="";v.forEach(r,function(I){I.attributes.sourceCountry==g&&(G=g)});if(G)return G;v.forEach(r,function(I){I.attributes.sourceCountry==e.defaultCountryID&&(G=defaultCountryID)});return G?G:r[0].attributes.sourceCountry};return A(t.reverseGeocode({x:l[0],y:l[1]})).then(function(r){return r&&r.address&&r.address.CountryCode?r.address.CountryCode:
h(z.results[0].value.FeatureSet[0].features)}).otherwise(function(){return h(z.results[0].value.FeatureSet[0].features)})}return e.defaultCountryID})})},getGEProxyUrl:function(a){var e=!1;return f.getPortal(portalUrl).loadSelfInfo().then(function(g){geUrl=g&&g.helperServices&&g.helperServices.geoenrichment&&g.helperServices.geoenrichment.url?g.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!a.mode&&a.appProxies&&0<
a.appProxies.length&&v.forEach(a.appProxies,function(p){geUrl.toLowerCase()===p.sourceUrl.toLowerCase()&&(e=p.proxyUrl)});return e})},getCountryHierarchies:function(){return d},getCountryDisableMultiHierarchySupport:function(){return c}}})},"widgets/BusinessAnalyst/utils/GeocodeUtil":function(){define(["esri/request","jimu/portalUtils"],function(v,A){return{reverseGeocode:function(C){return A.getPortal(portalUrl).loadSelfInfo().then(function(t){return v({url:(t&&t.isPortal&&t.helperServices&&t.helperServices.geocode&&
0<t.helperServices.geocode.length?t.helperServices.geocode[0].url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer")+"/reverseGeocode",content:{appID:"webappbuilder",f:"json",langCode:"en-us",location:JSON.stringify({x:C.x,y:C.y}),distance:250},handleAs:"json"})})}}})},"esri/dijit/geoenrichment/utils/FileUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","./DataUtil","./ImageUtil"],function(v,A,C,t){function k(){return new v.reject(Error("Saving not supported."))}
var b=k,f=/[\\/:*?"<>|]/g,d={savingSupported:function(){return void 0!==window.Blob},saveTextFile:function(e,g,p,z){return d.savingSupported()?d.saveAs(new Blob([e],{type:p||"text/plain"}),g||"text.txt",z):k()},saveImageFile:function(e,g){if(d.savingSupported()){if("string"===typeof e){var p=t.base64DataFromDataURL(e);p=C.binaryStringToByteArray(atob(p)).buffer}else e instanceof ArrayBuffer&&(p=e);return d.saveAs(p?C.arrayBuffersToBlob([p],"image/png"):e,g)}k()},_queue:[],_isSavePendingFlag:!1,_saveTimeoutH:null,
saveAs:function(e,g,p){return p&&p.addDownloadIntervals?(p=new v,d._queue.push({blob:e,name:g||"download",dfd:p}),d._trySaveAsNext(),p.promise):b(e,d.validateName(g||"download"))},_trySaveAsNext:function(){if(d._queue.length&&!d._isSavePendingFlag){var e=d._queue.shift();d._isSavePendingFlag=!0;A(b(e.blob,d.validateName(e.name))).then(e.dfd.resolve,e.dfd.reject).always(function(){setTimeout(function(){d._isSavePendingFlag=!1;d._trySaveAsNext()},100)})}},validateName:function(e){return String(e).trim().replace(f,
"")}};if(!d.savingSupported())return d;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return b=function(e,g){var p=new v;window.navigator.msSaveOrOpenBlob(e,g)?p.resolve():p.reject(Error("Failed to save or open downloaded file."));return p.promise},d;var c=window.URL||window.webkitURL;if("download"in window.document.createElement("a")){var a=function(e){if(void 0!==window.MouseEvent)var g=new MouseEvent("click",{bubbles:!0,cancelable:!1});else g=document.createEvent("MouseEvent"),g.initMouseEvent("click",
!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);e.dispatchEvent(g)};b=function(e,g){var p=new v,z=c.createObjectURL(e),l=window.document.createElement("a");l.href=z;l.download=g;a(l);setTimeout(function(){c.revokeObjectURL(z);l=null;p.resolve();p=null},1E3);return p.promise};return d}b=function(e,g){var p=new v;e=new File([e],g,{type:e.type});var z=c.createObjectURL(e);window.open(z,"_blank");setTimeout(function(){c.revokeObjectURL(z);p.resolve()},1E3);return p.promise};return d})},"esri/dijit/geoenrichment/utils/DataUtil":function(){define(["esri/dijit/geoenrichment/Deferred",
"esri/dijit/geoenrichment/when"],function(v,A){function C(f){return"string"==typeof f?{source:f,getLength:function(){return this.source.length},getByte:function(d){return this.source.charCodeAt(d)&255}}:window.ArrayBuffer&&f instanceof ArrayBuffer?{source:new Uint8Array(f),getLength:function(){return this.source.byteLength},getByte:function(d){return this.source[d]}}:f}function t(f){for(var d=f.length,c=new Uint8Array(f.length),a=0;a<d;a++)c[a]=f.charCodeAt(a);return c}function k(f,d){f=new Uint8Array(f);
d=Math.min(d,f.byteLength);for(var c="",a=0;a<d;a++)c+=String.fromCharCode(f[a]);return c}var b={arrayBufferFromBlob:function(f){var d=new v,c=new FileReader;c.onloadend=function(){c.error?d.reject(c.error):d.resolve(c.result)};c.readAsArrayBuffer(f);return d.promise},arrayBuffersToBlob:function(f,d){return new Blob(f,{type:d||"application/octet-stream"})},binaryStringFromByteSource:function(f){if("string"==typeof f)return f;f=C(f);var d=f.getLength(),c=d%4;d-=c;for(var a="",e=0,g,p,z,l;e<d;)g=f.getByte(e++),
p=f.getByte(e++),z=f.getByte(e++),l=f.getByte(e++),a+=String.fromCharCode(g,p,z,l);1==c?a+=String.fromCharCode(f.getByte(e)):2==c?a+=String.fromCharCode(f.getByte(e),f.getByte(e+1)):3==c&&(a+=String.fromCharCode(f.getByte(e),f.getByte(e+1),f.getByte(e+2)));return a},base64FromByteSource:function(f){f=C(f);var d=f.getLength(),c=d%3;d-=c;for(var a,e,g,p,z="",l=0;l<d;l+=3)p=f.getByte(l)<<16|f.getByte(l+1)<<8|f.getByte(l+2),a=p>>18&63,e=p>>12&63,g=p>>6&63,p&=63,z+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a]+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[g]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p];1==c?(p=f.getByte(l),z+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>2&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p<<4&63]+"\x3d\x3d"):2==c&&(p=f.getByte(l)<<8|f.getByte(l+1),z+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>
10&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>4&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p<<2&63]+"\x3d");return z},base64FromJson:function(f){return btoa(unescape(encodeURIComponent("string"===typeof f?f:JSON.stringify(f))))}};b.binaryStringToByteArray=t;b.base64ToByteArray=function(f){return t(atob(f))};b.getFirstBytes=function(f,d){if("string"==typeof f)var c=f.substr(0,d);else if(window.ArrayBuffer&&f instanceof ArrayBuffer)c=k(f,d);
else if(window.Blob&&f instanceof Blob){c=new v;var a=new FileReader;a.onloadend=function(){a.error?c.resolve(""):c.resolve(k(a.result,d))};a.readAsArrayBuffer(f.slice(0,d))}return A(c||"")};b.isBase64=function(f){return f&&0==f.length%4&&/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/]+$/.test(f.replace(/={0,2}$/,""))};b.base64ToJson=function(f){return JSON.parse(decodeURIComponent(escape(atob(f))))};b.getContentType=function(f){f=b.getFileExtension(f);if(null===f)return null;
switch(f){case "png":return"image/png";case "jpg":case "jpeg":return"image/jpeg";case "gif":return"image/gif";case "svg":return"image/svg+xml";case "json":return"application/json";case "txt":return"text/plain";case "xml":return"text/xml";default:return null}};b.getFileExtension=function(f){var d=f.lastIndexOf(".")+1;return d?f.substr(d).toLowerCase():null};return b})},"esri/dijit/geoenrichment/utils/ImageUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when",
"./UrlUtil"],function(v,A,C){var t={base64DataToDataURL:function(k,b){if(/^data:image/.test(k))return k;b||(b=atob(k.substr(0,16)),b=t.getImageContentType(b));return"data:"+(b||"image/png")+";base64,"+k},getImageContentType:function(k){if("\u00ff\u00d8\u00ff"===k.substr(0,3)&&"JFIF"===k.substr(6,4))return"image/jpeg";if("\u0089PNG\r\n\u001a\n"===k.substr(0,8))return"image/png";if("GIF89a"===k.substr(0,6)||"GIF87a"===k.substr(0,6))return"image/gif"},base64DataFromDataURL:function(k){0==k.indexOf("data:")&&
(k=k.substr(k.indexOf(",")+1));return k},getBase64DataIndex:function(k){k=0==k.indexOf("data:")?k.indexOf(";base64,"):-1;return 0<k?k+8:0},getContentType:function(k){var b=t.getBase64DataIndex(k);return b?k.substring(5,b-8):null},checkBase64FileSize:function(k,b){return t.getBase64FileSize(k)<=b},getBase64FileSize:function(k){return.75*k.length},imageToDataURL:function(k,b){b=b||{};var f=document.createElement("canvas"),d=f.getContext("2d");f.width=b.width||k.width;f.height=b.height||k.height;var c=
b.opacity;null!=c&&!isNaN(c)&&0<=c&&1>c&&(d.globalAlpha=+c,b.format="image/png");(c=b.pos)?d.drawImage(k,c.x||0,c.y||0):d.drawImage(k,0,0,f.width,f.height);return f.toDataURL(b.format)},imageFromUrl:function(k,b){var f=new v,d=new Image;0!==k.indexOf("data:")&&b&&b.crossOrigin&&d.setAttribute("crossOrigin",b.crossOrigin);d.onload=function(){if(d.width&&d.height)f.resolve(d);else{var c=Error("Error of reading an image from URL.");b&&b.ignoreError?f.resolve(null):f.reject(c)}d.onload=d.onerror=null};
d.onerror=function(c){b&&b.ignoreError?f.resolve(null):f.reject(c);d.onload=d.onerror=null};k=require.toUrl(k);/^http:/i.test(k)&&/^https/i.test(window.location.protocol)&&(k=C.toHttpsUrl(k));d.src=k;return f.promise},scaleImage:function(k,b){if("string"===typeof k){var f=t.base64DataToDataURL(k),d=t.getContentType(f);f=t.imageFromUrl(f)}return A(f||k).then(function(c){var a=1,e=c.width,g=c.height;if(b.factor)a=b.factor;else if(b.maxDim)a=b.maxDim/Math.max(e,g);else if(b.imageDim){var p=b.imageDim.w,
z=b.imageDim.h;b.imageDim.preserveRatio?(a=Math.min(p/e,z/g),b.imageDim.reduceOnly&&1<a&&(a=1)):b.imageDim.reduceOnly?(e=Math.min(e,p),g=Math.min(g,z)):(e=p,g=z)}return t.imageToDataURL(c,{width:e*a,height:g*a,format:b.format||d,opacity:b.opacity})})},getImageViewType:function(k,b){return 1E3<=b?(k/=b,.025>=Math.abs(k-2)?"360":2<k?"pano":null):null}};return t})},"esri/dijit/geoenrichment/utils/UrlUtil":function(){define(["dojo/_base/url","esri/config","esri/kernel","esri/urlUtils","esri/arcgis/utils"],
function(v,A,C,t,k){var b={getDomain:function(d){if("string"!==typeof d)return null;d=d.replace(/^(http:\/\/|https:\/\/)/i,"");var c=d.indexOf("/");return 0>c?d:d.substr(0,c)},getPortalUrl:function(d){if("string"!==typeof d)return null;d=d.replace(/\?.*$/,"");var c=d.match(/^(.+)\/sharing(\/|$)/i);return c||(c=d.match(/^(.+)\/home$/i))?c[1]:(c=d.match(/^(.+)\/portal(\/|$)/i))?c[1]+"/portal":d},getProxyUrl:function(d){var c=A.defaults.io.proxyUrl;c&&!/^http/i.test(c)&&(c=t.getAbsoluteUrl(c));c&&d&&
(c=b.toHttpsUrl(c));return c},registerCORS:function(d){(d=b.getDomain(d))&&-1==A.defaults.io.corsEnabledServers.indexOf(d)&&A.defaults.io.corsEnabledServers.push(d);b._fixCORS()},_fixCORS:function(){A.defaults.io.corsEnabledServers=A.defaults.io.corsEnabledServers.filter(function(d){return d.indexOf&&0===d.indexOf("null://")?(console.log("WARNING: incorrect CORS URL detected: "+d),!1):!0})},indexOfQuery:function(d){var c=d.indexOf("?");0<=c&&(d=d.substr(c+1),/^(http:\/\/|https:\/\/)/i.test(d)&&(d=
d.indexOf("?"),c=0<=d?c+1+d:-1));return c},removeQuery:function(d){var c=b.indexOfQuery(d);return 0>c?d:d.substr(0,c)},addQueryPart:function(d,c){var a=0>b.indexOfQuery(d)?"?":"\x26";return d+a+c},getVariableValue:function(d,c){if(d&&"string"===typeof c){var a=t.urlToObject(d);if(a.query){var e={};Object.keys(a.query).forEach(function(g){e[g.toLowerCase()]=a.query[g]});return e[c.toLowerCase()]}}},addUrlVariable:function(d,c,a){c=encodeURIComponent(c);a=encodeURIComponent(a);return b.addQueryPart(d,
c+"\x3d"+a)},securePortsMap:{80:"443",8080:"8443"},toHttpUrl:function(d){return!d||/^http/i.test(d)?d:"http://"+d},toHttpsUrl:function(d){d&&(d=b.toHttpUrl(d));if(!d||!/^http:\/\//i.test(d))return d;var c=new v(d);d=d.replace(/^http/i,"https");var a=b.securePortsMap[c.port];a&&(d=d.replace(":"+c.port,":"+a));return d},combine:function(d,c){"number"===typeof c&&(c+="");if(c){if(/^(http:\/\/|https:\/\/)/i.test(c)||!d)return c;"/"!=c.charAt(0)&&(c="/"+c);if(1==c.length)return d;var a=d.length-1;"/"==
d.charAt(a)&&(d=d.substr(0,a));var e=t.urlToObject(d);d=b.removeQuery(d);a=d.length-c.length;0<=a&&d.substr(a).toLowerCase()==c.toLowerCase()&&(d=d.substr(0,a));d+=c;for(var g in e.query)b.addQueryPart(d,e.query[g])}return d},combineMulti:function(d){for(var c=d[0],a=1;a<d.length;a++)c=b.combine(c,d[a]);return c},openUrl:function(d,c){if(c)return window.open(d,"_blank");c=window.open();c.opener=null;c.referrer=null;c.location=d;return c},isPageRunOnWebService:function(){return/^http/i.test(window.location.protocol)},
getToken:function(d){return(d=d&&C.id.findCredential(d)||C.id.credentials[0])&&d.token}},f;b.getArcgisUrl=function(){return f};b.setArcgisUrl=function(d){d&&(f=d,k.arcgisUrl=b.combine(d,"/sharing/rest/content/items"))};return b})},"widgets/BusinessAnalyst/utils/ReportUtil":function(){define("dojo/Deferred dojo/promise/all dojo/when dojo/_base/array esri/request ./GEUtil jimu/portalUtils dojo/i18n!../nls/strings".split(" "),function(v,A,C,t,k,b,f,d){STANDARD_INFOGRAPHIC_TYPEKEYWORD="esriReportPlayerStandardInfographic";
return{_ownedCachedCustomReports:null,_sharedCachedCustomReports:null,_cachedCountryClassicReports:[],_cachedInfographicReports:null,_countryInitDfds:[],getAvailableClassicReports:function(c,a){var e=this,g=[],p=new v,z;a&&t.forEach(a.countryConfig,function(G){c==G.countryID&&(z=G)});z||(z={countryID:c,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,
allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var l=null,h=null,r=null;C(this._initReports(c),function(){if(!a||z.allowAllEsriReports||e._hasEnabledReports(e._cachedCountryClassicReports[c],z.enabledEsriReports))l=g.length,g.push({value:"esriReports",label:d.esriReports,children:[]});if(!a||z.allowAllOrgReports&&e._hasReportsForCountry(e._ownedCachedCustomReports,c)||e._hasEnabledReportsForCountry(e._ownedCachedCustomReports,
c,z.enabledOrgReports))h=g.length,g.push({value:"myReports",label:d.myReports,children:[]});if(!a||z.allowAllOrgReports&&e._hasReportsForCountry(e._sharedCachedCustomReports,c)||e._hasEnabledReportsForCountry(e._sharedCachedCustomReports,c,z.enabledOrgReports))r=g.length,g.push({value:"sharedReports",label:d.sharedReports,children:[]});(z.allowAllEsriReports||e._hasEnabledReports(e._cachedCountryClassicReports[c],z.enabledEsriReports))&&e._cachedCountryClassicReports[c]&&0<e._cachedCountryClassicReports[c].length&&
t.forEach(e._cachedCountryClassicReports[c],function(B){(z.allowAllEsriReports||z.enabledEsriReports.includes(B.reportID))&&g[l].children.push(e._formatClassicReportsForDropDown(B))});var G=["esriWebInfographicReport","esriWebSingleInfographic","esriWebBlankInfographic","esriWebHiddenInfographic","esriWebComparisonReport"];(z.allowAllOrgReports&&e._hasReportsForCountry(e._ownedCachedCustomReports,c)||e._hasEnabledReportsForCountry(e._ownedCachedCustomReports,c,z.enabledOrgReports))&&t.forEach(e._ownedCachedCustomReports,
function(B){B.properties.countries.includes(c)&&(z.allowAllOrgReports||z.enabledOrgReports.includes(B.id))&&(B.typeKeywords.some(function(E){return 0<=G.indexOf(E)})||(b.getCountryDisableMultiHierarchySupport()[c]?B.properties.hierarchy===b.getCountryHierarchies()[c]&&g[h].children.push(e._formatClassicReportsForDropDown(B)):g[h].children.push(e._formatClassicReportsForDropDown(B))))});(z.allowAllOrgReports&&e._hasReportsForCountry(e._sharedCachedCustomReports,c)||e._hasEnabledReportsForCountry(e._sharedCachedCustomReports,
c,z.enabledOrgReports))&&t.forEach(e._sharedCachedCustomReports,function(B){B.properties.countries.includes(c)&&(z.allowAllOrgReports||z.enabledOrgReports.includes(B.id))&&(B.typeKeywords.some(function(E){return 0<=G.indexOf(E)})||(b.getCountryDisableMultiHierarchySupport()[c]?B.properties.hierarchy===b.getCountryHierarchies()[c]&&g[r].children.push(e._formatClassicReportsForDropDown(B)):g[r].children.push(e._formatClassicReportsForDropDown(B))))});var I=function(B,E){B=B.label.toUpperCase();E=E.label.toUpperCase();
var J=0;B>E?J=1:B<E&&(J=-1);return J};0<g.length&&g[0].children.sort(I);1<g.length&&g[1].children.sort(I);2<g.length&&g[2].children.sort(I);p.resolve(g)});return p},_hasEnabledReports:function(c,a){return c&&a?t.some(c,function(e){return a.includes(e.reportID)}):!1},_hasReportsForCountry:function(c,a){return c&&a?t.some(c,function(e){return e.properties.countries.includes(a)}):!1},_hasEnabledReportsForCountry:function(c,a,e){return c&&a&&e?t.some(c,function(g){return g.properties.countries.includes(a)?
e.includes(g.id):!1}):!1},_formatClassicReportsForDropDown:function(c){return c.metadata?{label:c.metadata.title,value:c.reportID,reportType:c.metadata.type}:{label:c.title,value:c.id,reportType:c.properties.type,item:{itemid:c.id,url:portalUrl,token:esri.id.credentials[0].token}}},getAvailableInfographicReports:function(c,a){var e=this,g=[],p=new v,z;a&&t.forEach(a.countryConfig,function(G){c==G.countryID&&(z=G)});z||(z={countryID:c,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,
allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var l=null,h=null,r=null;C(this._initReports(c),function(){if(!a||z.allowAllEsriInfographics||e._hasEnabledInfographics(e._cachedInfographicReports,z.enabledEsriInfographics))l=g.length,g.push({value:"esriReports",
label:d.esriInfographics,children:[]});if(!a||z.allowAllOrgInfographics&&0<e._ownedCachedCustomReports.length||e._hasEnabledInfographics(e._ownedCachedCustomReports,z.enabledOrgInfographics))h=g.length,g.push({value:"myReports",label:d.myInfographics,children:[]});if(!a||z.allowAllOrgInfographics&&0<e._sharedCachedCustomReports.length||e._hasEnabledInfographics(e._sharedCachedCustomReports,z.enabledOrgInfographics))r=g.length,g.push({value:"sharedReports",label:d.sharedInfographics,children:[]});
(z.allowAllEsriInfographics||e._hasEnabledInfographics(e._cachedInfographicReports,z.enabledEsriInfographics))&&t.forEach(e._cachedInfographicReports,function(I){if(I.properties.countries.includes(c)&&(z.allowAllEsriInfographics||z.enabledEsriInfographics.includes(I.id))){var B=e._getIndexOfInfographicByTitle(I.title,g[l].children);if(-1===B)g[l].children.push(e._formatInfographicReportsForDropDown(I));else{var E=b.getCountryHierarchies()[c];I.properties.hierarchy===E&&(g[l].children[B]=e._formatInfographicReportsForDropDown(I))}}});
(z.allowAllOrgInfographics&&0<e._ownedCachedCustomReports.length||e._hasEnabledInfographics(e._ownedCachedCustomReports,z.enabledOrgInfographics))&&t.forEach(e._ownedCachedCustomReports,function(I){I.properties.countries.includes(c)&&(z.allowAllOrgInfographics||z.enabledOrgInfographics.includes(I.id))&&(I.typeKeywords.includes("esriWebInfographicReport")||e._isOldPortalInfographic(I))&&(b.getCountryDisableMultiHierarchySupport()[c]?I.properties.hierarchy===b.getCountryHierarchies()[c]&&g[h].children.push(e._formatInfographicReportsForDropDown(I)):
g[h].children.push(e._formatInfographicReportsForDropDown(I)))});(z.allowAllOrgInfographics&&0<e._sharedCachedCustomReports.length||e._hasEnabledInfographics(e._sharedCachedCustomReports,z.enabledOrgInfographics))&&t.forEach(e._sharedCachedCustomReports,function(I){I.properties.countries.includes(c)&&(z.allowAllOrgInfographics||z.enabledOrgInfographics.includes(I.id))&&(I.typeKeywords.includes("esriWebInfographicReport")||e._isOldPortalInfographic(I))&&(b.getCountryDisableMultiHierarchySupport()[c]?
I.properties.hierarchy===b.getCountryHierarchies()[c]&&g[r].children.push(e._formatInfographicReportsForDropDown(I)):g[r].children.push(e._formatInfographicReportsForDropDown(I)))});var G=function(I,B){I=I.label.toUpperCase();B=B.label.toUpperCase();var E=0;I>B?E=1:I<B&&(E=-1);return E};0<g.length&&g[0].children.sort(G);1<g.length&&g[1].children.sort(G);2<g.length&&g[2].children.sort(G);p.resolve(g)});return p},_hasEnabledInfographics:function(c,a){return t.some(c,function(e){return a.includes(e.id)})},
_isOldPortalInfographic:function(c){return c.properties&&c.properties.isHidden&&"true"===c.properties.isHidden?!1:c.properties&&c.properties.isGraphicReport&&"true"===c.properties.isGraphicReport?!0:!1},_formatInfographicReportsForDropDown:function(c){return{label:c.title,value:c.id}},_getIndexOfInfographicByTitle:function(c,a){var e=-1;t.some(a,function(g,p){if(g.label===c)return e=p,!1});return e},_initReports:function(c){var a=[],e=this;if(this._countryInitDfds[c])return this._countryInitDfds[c];
this._countryInitDfds[c]=new v;var g=function(p,z){return k(p).then(function(l){t.forEach(l.results,function(h){z.push(h)});if(-1!=l.nextStart)return p.content.start=l.nextStart,g(p,z)},function(l){alert(l)})};f.getPortal(portalUrl).loadSelfInfo().then(function(p){var z=p&&p.helperServices&&p.helperServices.geoenrichment&&p.helperServices.geoenrichment.url?p.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";e._cachedCountryClassicReports[c]||
a.push(k({url:z+"/Geoenrichment/reports/"+c,content:{appID:"webappbuilder",f:"json",langCode:"en-us"}}).then(function(l){e._cachedCountryClassicReports[c]=l.reports},function(l){alert(l)}));e._cachedInfographicReports||(e._cachedInfographicReports=[],a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:"typekeywords:(esriWebStandardInfographicReport)"}},e._cachedInfographicReports)));e._ownedCachedCustomReports||
(e._ownedCachedCustomReports=[],a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) owner:'+esri.id.credentials[0].userId}},e._ownedCachedCustomReports)));e._sharedCachedCustomReports||(e._sharedCachedCustomReports=[],a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",
sortOrder:"desc",q:'access:shared type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},e._sharedCachedCustomReports)),a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:org type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},e._sharedCachedCustomReports)),
p&&p.appInfo&&p.appInfo.orgId&&a.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:public type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId+" orgid: "+p.id}},e._sharedCachedCustomReports)));0===a.length?e._countryInitDfds[c].resolve():A(a).then(function(){e._countryInitDfds[c].resolve()})});return this._countryInitDfds[c]}}})},
"widgets/BusinessAnalyst/utils/ValidationUtil":function(){define(["dojo/dom-class"],function(v){return{MIN_RINGS_VALUE:0,MAX_RINGS_VALUE:1E3,MIN_DTWT_VALUE:0,MAX_DTWT_VALUE:300,validateInvalidValues:function(A,C,t,k,b){var f=A.get("value"),d=C.get("value"),c=t.get("value"),a=!0;0<f.length&&null===this._tryParseFloat(f)?(a=!1,v.remove(k,"hidden"),k.innerHTML=b,v.add(A.domNode,"invalidValue")):v.remove(A.domNode,"invalidValue");0<d.length&&null===this._tryParseFloat(d)?(a=!1,v.remove(k,"hidden"),k.innerHTML=
b,v.add(C.domNode,"invalidValue")):v.remove(C.domNode,"invalidValue");0<c.length&&null===this._tryParseFloat(c)?(a=!1,v.remove(k,"hidden"),k.innerHTML=b,v.add(t.domNode,"invalidValue")):v.remove(t.domNode,"invalidValue");a&&v.add(k,"hidden");return a},validateMinMaxValues:function(A,C,t,k,b,f,d){var c=A.get("value"),a=C.get("value"),e=t.get("value"),g=!0;0<c.length?(c=parseFloat(c),c<k||c>b?(g=!1,v.remove(f,"hidden"),f.innerHTML=d,v.add(A.domNode,"invalidValue")):v.remove(A.domNode,"invalidValue")):
v.remove(A.domNode,"invalidValue");0<a.length?(c=parseFloat(a),c<k||c>b?(g=!1,v.remove(f,"hidden"),f.innerHTML=d,v.add(C.domNode,"invalidValue")):v.remove(C.domNode,"invalidValue")):v.remove(C.domNode,"invalidValue");0<e.length?(c=parseFloat(e),c<k||c>b?(g=!1,v.remove(f,"hidden"),f.innerHTML=d,v.add(t.domNode,"invalidValue")):v.remove(t.domNode,"invalidValue")):v.remove(t.domNode,"invalidValue");g&&v.add(f,"hidden");return g},_tryParseFloat:function(A){var C=null;null!==A&&0<A.length&&(isNaN(A)||
(C=parseFloat(A)));return C}}})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),function(v,A,C,t,k,b){var f=null,d=v([C,k],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new b({whiteList:this.whiteList,
safeAttrValue:t.hitch(this,function(c,a,e,g){return"style"===a?this.xss.friendlyAttrValue(e).replace(/"/g,"'"):"img"===c&&"src"===a?this.xss.escapeAttrValue(e):this.xss.safeAttrValue(c,a,e,g)}),onTag:t.hitch(this,function(c,a,e){if(e.isWhite&&this._isInWhiteList(c,this.graphicsWhiteList))return a}),onIgnoreTagAttr:t.hitch(this,function(c,a,e,g){if("data-"===a.substr(0,5))return a+'\x3d"'+this.xss.escapeAttrValue(e)+'"'}),onIgnoreTag:t.hitch(this,function(c,a,e){if("o:"===c.substr(0,2)||"!--[if"===
c||"!--[endif]--"===c)return a})},!0);this.xss=this.sanitizer.xss},sanitize:function(c){return this.sanitizer.sanitize(c)},_getWhiteList:function(){var c="title height width class style font-family id align text-align".split(" "),a={div:c,h1:c,h2:c,h3:c,h4:c,h5:c,h6:c,span:c,p:c,s:c,strong:c,em:c,u:c,ol:c,ul:c,li:c,a:["href","target"].concat(c),img:["src","alt","border"].concat(c),blockquote:c,font:["face","size","color"].concat(c),pre:c,code:c,b:c,i:c,wbr:c,video:"autoplay controls loop muted poster preload".split(" ").concat(c),
audio:["autoplay","controls","loop","muted","preload"].concat(c),source:["media","src","type"].concat(c),table:["cellpadding","cellspacing","border"].concat(c),tbody:[].concat(c),tr:["valign"].concat(c),td:["valign","colspan","rowspan","nowrap"].concat(c),th:["valign","colspan","rowspan","nowrap"].concat(c),hr:c,html:c,title:c,link:["rel","href"],style:["type"].concat(c),body:c};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],
desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],feFuncA:[],feFuncB:[],feFuncG:[],feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],
mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],textPath:[],title:[],tspan:[],use:[],view:[],object:[],canvas:c};return this._extendObjectOfArrays([a,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],
blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align",
"valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(c){var a={};A.forEach(c,function(e){var g=Object.keys(e);A.forEach(g,function(p){Array.isArray(e[p])&&Array.isArray(a[p])?a[p]=a[p].concat(e[p]):
a[p]=e[p]},this)},this);return a},_isInWhiteList:function(c,a){a=Object.keys(a);var e=!1;A.forEach(a,function(g){c===g&&(e=!0)},this);return e}});d.getInstance=function(){null===f&&(f=new d);return f};return d})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(v,A,C,t,k,b,f,d,c,a,e,g,p){var z=C("dijit._editor.plugins.LinkDialog",
e,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:g,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=b.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(h){v("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),b.hitch(this,function(r,G,I){var B=this;this.tag="insertImage"==this.command?"img":"a";r=b.delegate(r.getLocalization("dijit","common",this.lang),r.getLocalization("dijit._editor",
"LinkDialog",this.lang));var E=this.dropDown=this.button.dropDown=new G({title:r[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:b.hitch(this,"setValue"),onOpen:function(){B._onOpenDialog();G.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(b.hitch(B,"_onCloseDialog"),0)}});r.urlRegExp=this.urlRegExp;r.id=I.getUniqueId(this.editor.id);this._uniqueId=r.id;this._setContent(E.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
a.substitute(this.linkDialogTemplate,r));E.startup();this._urlInput=I.byId(this._uniqueId+"_urlInput");this._textInput=I.byId(this._uniqueId+"_textInput");this._setButton=I.byId(this._uniqueId+"_setButton");this.own(I.byId(this._uniqueId+"_cancelButton").on("click",b.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",b.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",b.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=b.hitch(this,function(){var J=this._urlInput.get("value");return this._urlRegExp.test(J)||this._emailRegExp.test(J)});this.own(f(E.domNode,"keydown",b.hitch(this,b.hitch(this,function(J){!J||J.keyCode!=k.ENTER||J.shiftKey||J.metaKey||J.ctrlKey||J.altKey||this._setButton.get("disabled")||(E.onExecute(),E.execute(E.get("value")))}))));h()}))},_checkAndFixInput:function(){var h=this,r=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var G=r,I=!1,B=!1;G&&1<G.length&&(G=b.trim(G),0!==G.indexOf("mailto:")&&(0<G.indexOf("/")?-1===G.indexOf("://")&&"/"!==G.charAt(0)&&G.indexOf("./")&&0!==G.indexOf("../")&&h._hostRxp.test(G)&&(I=!0):h._userAtRxp.test(G)&&(B=!0)));I&&h._urlInput.set("value","http://"+G);B&&h._urlInput.set("value","mailto:"+G);h._setButton.set("disabled",!h._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(b.hitch(this,
function(){this.own(f(this.editor.editNode,"mouseup",b.hitch(this,"_onMouseUp")));this.own(f(this.editor.editNode,"dblclick",b.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(h){this.dropDown.set({parserScope:"dojo",content:h})},_checkValues:function(h){h&&h.urlInput&&(h.urlInput=h.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&h&&h.textInput&&("function"===typeof this.linkFilter?h.textInput=this.linkFilter(h.textInput):
A.forEach(this.linkFilter,function(r){h.textInput=h.textInput.replace(r[0],r[1])}));return h},_createlinkEnabledImpl:function(){return!0},setValue:function(h){this._onCloseDialog();if(9>d("ie")){var r=p.getSelection(this.editor.window).getRangeAt(0).endContainer;3===r.nodeType&&(r=r.parentNode);r&&r.nodeName&&r.nodeName.toLowerCase()!==this.tag&&(r=this.editor.selection.getSelectedElement(this.tag));r&&r.nodeName&&r.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(r),
this.editor.execCommand("unlink"))}h=this._checkValues(h);this.editor.execCommand("inserthtml",a.substitute(this.htmlTemplate,h));c("a",this.editor.document).forEach(function(G){G.innerHTML||t.has(G,"name")||G.parentNode.removeChild(G)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(h){if(h&&h.tagName.toLowerCase()===this.tag){var r=h.getAttribute("_djrealurl")||h.getAttribute("href");var G=h.getAttribute("target")||"_self";var I=h.textContent||
h.innerText;this.editor.selection.selectElement(h,!0)}else I=this.editor.selection.getSelectedText();return{urlInput:r||"",textInput:I||"",targetSelect:G||""}},_onOpenDialog:function(){if(d("ie")){var h=p.getSelection(this.editor.window);if(h.rangeCount){var r=h.getRangeAt(0);var G=r.endContainer;3===G.nodeType&&(G=G.parentNode);G&&G.nodeName&&G.nodeName.toLowerCase()!==this.tag&&(G=this.editor.selection.getSelectedElement(this.tag));if(!G||G.nodeName&&G.nodeName.toLowerCase()!==this.tag)(h=this.editor.selection.getAncestorElement(this.tag))&&
h.nodeName&&h.nodeName.toLowerCase()==this.tag?(G=h,this.editor.selection.selectElement(G)):r.startContainer===r.endContainer&&(h=r.startContainer.firstChild)&&h.nodeName&&h.nodeName.toLowerCase()==this.tag&&(G=h,this.editor.selection.selectElement(G))}}else G=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(G))},_onDblClick:function(h){if(h&&h.target&&(h=h.target,(h.tagName?h.tagName.toLowerCase():
"")===this.tag&&t.get(h,"href"))){var r=this.editor;this.editor.selection.selectElement(h);r.onDisplayChanged();r._updateTimer&&(r._updateTimer.remove(),delete r._updateTimer);r.onNormalizedDisplayChanged();var G=this.button;setTimeout(function(){G.set("disabled",!1);G.loadAndOpenDropDown().then(function(){G.dropDown.focus&&G.dropDown.focus()})},10)}},_onMouseUp:function(){if(d("ff")){var h=this.editor.selection.getAncestorElement(this.tag);if(h){var r=p.getSelection(this.editor.window).getRangeAt(0);
if(r.collapsed&&h.childNodes.length){var G=r.cloneRange();G.selectNodeContents(h.childNodes[h.childNodes.length-1]);G.setStart(h.childNodes[0],0);1!==r.compareBoundaryPoints(G.START_TO_START,G)?r.setStartBefore(h):-1!==r.compareBoundaryPoints(G.END_TO_START,G)&&r.setStartAfter(h)}}}}}),l=C("dijit._editor.plugins.ImgLinkDialog",[z],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(h){if(h&&h.tagName.toLowerCase()===this.tag){var r=h.getAttribute("_djrealurl")||h.getAttribute("src");var G=h.getAttribute("alt");this.editor.selection.selectElement(h,!0)}else G=this.editor.selection.getSelectedText();return{urlInput:r||"",textInput:G||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(b.hitch(this,function(){this.own(f(this.editor.editNode,"mousedown",b.hitch(this,"_selectTag")))}))},_selectTag:function(h){h&&h.target&&(h=h.target,(h.tagName?h.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(h))},_checkValues:function(h){h&&h.urlInput&&(h.urlInput=h.urlInput.replace(/"/g,"\x26quot;"));h&&h.textInput&&(h.textInput=h.textInput.replace(/"/g,"\x26quot;"));return h},_onDblClick:function(h){if(h&&h.target&&(h=h.target,(h.tagName?
h.tagName.toLowerCase():"")===this.tag&&t.get(h,"src"))){var r=this.editor;this.editor.selection.selectElement(h);r.onDisplayChanged();r._updateTimer&&(r._updateTimer.remove(),delete r._updateTimer);r.onNormalizedDisplayChanged();var G=this.button;setTimeout(function(){G.set("disabled",!1);G.loadAndOpenDropDown().then(function(){G.dropDown.focus&&G.dropDown.focus()})},10)}}});e.registry.createLink=function(h){var r={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in h?h.allowUnsafeHtml:!1};
"linkFilter"in h&&(r.linkFilter=h.linkFilter);return new z(r)};e.registry.insertImage=function(){return new l({command:"insertImage"})};z.ImgLinkDialog=l;return z})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l,h,r,G){var I=C("dijit._editor.plugins.ViewSource",l,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){g("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var B=d.getLocalization("dijit._editor","commands"),E=this.editor;this.button=new h({label:B.viewSource,ownerDocument:E.ownerDocument,dir:E.dir,lang:E.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:a.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(B){this.editor=B;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=A.before(this.editor,"setValue",a.hitch(this,function(E){return[this._filter(E)]}));this._getValueFilterHandle=A.after(this.editor,"getValue",a.hitch(this,function(E){return this._filter(E)}));this.editor.addKeyHandler(c.F12,!0,!0,a.hitch(this,function(E){this.button.focus();
this.toggle();E.stopPropagation();E.preventDefault();setTimeout(a.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(B){var E=this.editor,J=E._plugins;this._sourceShown=B;var F=this;try{this.sourceArea||this._createSourceView();if(B)E._sourceQueryCommandEnabled=E.queryCommandEnabled,E.queryCommandEnabled=function(x){return"viewsource"===x.toLowerCase()},this.editor.onDisplayChanged(),v.forEach(J,function(x){!x||x instanceof I||!x.isInstanceOf(l)||x.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return F.sourceArea}),this.sourceArea.value=E.get("value"),this.sourceArea.style.height=E.iframe.style.height,this.sourceArea.style.width=E.iframe.style.width,E.iframe.parentNode.style.position="relative",f.set(E.iframe,{position:"absolute",top:0,visibility:"hidden"}),f.set(this.sourceArea,{display:"block"}),this._resizeHandle=e(window,"resize",a.hitch(this,function(){var x=p.getBox(E.ownerDocument);"_prevW"in this&&"_prevH"in this&&
x.w===this._prevW&&x.h===this._prevH||(this._prevW=x.w,this._prevH=x.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(a.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(a.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=a.hitch(this,function(){var x=this.sourceArea.value;return x=this._filter(x)}),this._setListener=A.after(this.editor,
"setValue",a.hitch(this,function(x){this.sourceArea.value=x||""}),!0);else{if(!E._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);E.queryCommandEnabled=E._sourceQueryCommandEnabled;if(!this._readOnly){var y=this.sourceArea.value;E.beginEditing();E.set("value",y);E.endEditing()}v.forEach(J,function(x){x&&
x.isInstanceOf(l)&&x.set("disabled",!1)});f.set(this.sourceArea,"display","none");f.set(E.iframe,{position:"relative",visibility:"visible"});delete E._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(a.hitch(this,function(){var x=E.domNode.parentNode;x&&(x=G.getEnclosingWidget(x))&&x.resize&&x.resize();E.resize()}),300)}catch(x){console.log(x)}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var B=this.editor,E=B.getHeaderHeight(),J=
B.getFooterHeight(),F=b.position(B.domNode),y=b.getPadBorderExtents(B.iframe.parentNode),x=b.getMarginExtents(B.iframe.parentNode),w=b.getPadBorderExtents(B.domNode),n=F.w-w.w;F=F.h-(E+w.h+J);this._fsPlugin&&this._fsPlugin.isFullscreen&&(B=p.getBox(B.ownerDocument),n=B.w-w.w,F=B.h-(E+w.h+J));b.setMarginBox(this.sourceArea,{w:Math.round(n-(y.w+x.w)),h:Math.round(F-(y.h+x.h))})},_createSourceView:function(){var B=this.editor,E=B._plugins;this.sourceArea=k.create("textarea");this.readOnly&&(t.set(this.sourceArea,
"readOnly",!0),this._readOnly=!0);f.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});t.set(this.sourceArea,"aria-label",this.editor.id);k.place(this.sourceArea,B.iframe,"before");g("ie")&&B.iframe.parentNode.lastChild!==B.iframe&&f.set(B.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});B._viewsource_oldFocus=B.focus;var J=this;B.focus=function(){if(J._sourceShown)J.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,z.focus(B.editNode)):B._viewsource_oldFocus()}catch(x){console.log("ViewSource focus code error: "+x)}};var F,y;for(F=0;F<E.length;F++)if((y=E[F])&&("dijit._editor.plugins.FullScreen"===y.declaredClass||y.declaredClass===r._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=y;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return J._sourceShown?J.sourceArea:this._viewsource_getAltViewNode()});
this.own(e(this.sourceArea,"keydown",a.hitch(this,function(x){this._sourceShown&&x.keyCode==c.F12&&x.ctrlKey&&x.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(a.hitch(this,function(){B.focus()}),100),x.stopPropagation(),x.preventDefault())})))},_stripScripts:function(B){B&&(B=B.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),B=B.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),B=B.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return B},_stripComments:function(B){B&&
(B=B.replace(/\x3c!--(.|\s){1,}?--\x3e/g,""));return B},_stripIFrames:function(B){B&&(B=B.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return B},_stripEventHandlers:function(B){if(B){var E=B.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(E)for(var J=0,F=E.length;J<F;J++){var y=E[J],x=y.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");B=B.replace(y,x)}}return B},_filter:function(B){B&&(this.stripScripts&&(B=this._stripScripts(B)),this.stripComments&&(B=this._stripComments(B)),
this.stripIFrames&&(B=this._stripIFrames(B)),this.stripEventHandlers&&(B=this._stripEventHandlers(B)));return B},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var B=this.sourceArea;z.focus(B);this._sourceShown&&!this.readOnly&&(B.setSelectionRange?B.setSelectionRange(0,0):this.sourceArea.createTextRange&&
(B=B.createTextRange(),B.collapse(!0),B.moveStart("character",-99999),B.moveStart("character",0),B.moveEnd("character",0),B.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});l.registry.viewSource=l.registry.viewsource=function(B){return new I({readOnly:"readOnly"in
B?B.readOnly:!1,stripComments:"stripComments"in B?B.stripComments:!0,stripScripts:"stripScripts"in B?B.stripScripts:!0,stripIFrames:"stripIFrames"in B?B.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in B?B.stripEventHandlers:!0})};return I})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l){v=C("dijit._editor.plugins._FontDropDown",[a,e,g],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:v,postMixInProperties:function(){this.inherited(arguments);this.strings=k.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=c.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new d({idProperty:"value",data:A.map(this.values,function(B){var E=this.strings[B]||B;return{label:this.getLabel(B,E),name:E,value:B}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(B,E){E=!1!==E;this.select.set("value",0>A.indexOf(this.values,B)?"":B,E);E||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(B){this._set("disabled",B);this.select.set("disabled",B)}});var h=C("dijit._editor.plugins._FontNameDropDown",v,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(B,E){return this.plainText?E:"\x3cdiv style\x3d'font-family: "+B+"'\x3e"+E+"\x3c/div\x3e"},_normalizeFontName:function(B){var E=this.values;if(!B||!E)return B;var J=B.split(",");if(1<J.length)for(var F=0,y=J.length;F<y;F++){var x=f.trim(J[F]);if(-1<A.indexOf(E,x))return x}return B},_setValueAttr:function(B,E){E=!1!==
E;B=this._normalizeFontName(B);this.generic&&(B={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[B]||B);this.inherited(arguments,[B,E])}}),r=C("dijit._editor.plugins._FontSizeDropDown",v,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(B,
E){return this.plainText?E:"\x3cfont size\x3d"+B+"'\x3e"+E+"\x3c/font\x3e"},_setValueAttr:function(B,E){E=!1!==E;B.indexOf&&-1!=B.indexOf("px")&&(B={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(B,10)]||B);this.inherited(arguments,[B,E])}}),G=C("dijit._editor.plugins._FormatBlockDropDown",v,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(B,E){return this.plainText||
"noFormat"==B?E:"\x3c"+B+"\x3e"+E+"\x3c/"+B+"\x3e"},_execCommand:function(B,E,J){if("noFormat"===J){var F;if((E=l.getSelection(B.window))&&0<E.rangeCount&&(J=E.getRangeAt(0),J)){E=J.startContainer;for(F=J.endContainer;E&&E!==B.editNode&&E!==B.document.body&&1!==E.nodeType;)E=E.parentNode;for(;F&&F!==B.editNode&&F!==B.document.body&&1!==F.nodeType;)F=F.parentNode;var y=b.hitch(this,function(q,H){if(q.childNodes&&q.childNodes.length){var K;for(K=0;K<q.childNodes.length;K++){var m=q.childNodes[K];if(1==
m.nodeType&&B.selection.inSelection(m)){var u=m.tagName?m.tagName.toLowerCase():"";-1!==A.indexOf(this.values,u)&&H.push(m);y(m,H)}}}});J=b.hitch(this,function(q){if(q&&q.length){for(B.beginEditing();q.length;)this._removeFormat(B,q.pop());B.endEditing()}});var x=[];if(E==F){for(F=E;F&&F!==B.editNode&&F!==B.document.body;){if(1==F.nodeType){var w=F.tagName?F.tagName.toLowerCase():"";if(-1!==A.indexOf(this.values,w)){var n=F;break}}F=F.parentNode}y(E,x);n&&(x=[n].concat(x))}else for(F=E;B.selection.inSelection(F);)1==
F.nodeType&&(w=F.tagName?F.tagName.toLowerCase():"",-1!==A.indexOf(this.values,w)&&x.push(F),y(F,x)),F=F.nextSibling;J(x);B.onDisplayChanged()}}else B.execCommand(E,J)},_removeFormat:function(B,E){if(B.customUndo){for(;E.firstChild;)t.place(E.firstChild,E,"before");E.parentNode.removeChild(E)}else{B.selection.selectElementChildren(E);var J=B.selection.getSelectedHtml();B.selection.selectElement(E);B.execCommand("inserthtml",J||"")}}}),I=C("dijit._editor.plugins.FontChoice",z,{useDefaultCommand:!1,
_initButton:function(){var B={fontName:h,fontSize:r,formatBlock:G}[this.command],E=this.params;this.params.custom&&(E.values=this.params.custom);var J=this.editor;this.button=new B(b.delegate({dir:J.dir,lang:J.lang},E));this.own(this.button.select.on("change",b.hitch(this,function(F){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=F.indexOf(" ")&&(F="'"+F+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,F):this.editor.execCommand(this.command,
F)})))},updateState:function(){var B=this.editor,E=this.command;if(B&&B.isLoaded&&E.length&&this.button){var J=this.get("disabled");this.button.set("disabled",J);if(!J){try{var F=B.queryCommandValue(E)||""}catch(x){F=""}(J=b.isString(F)&&(F.match(/'([^']*)'/)||F.match(/"([^"]*)"/)))&&(F=J[1]);"fontSize"!==E||F||(F=3);if("formatBlock"===E)if(F&&"p"!=F)0>A.indexOf(this.button.values,F)&&(F="noFormat");else{F=null;if((E=l.getSelection(this.editor.window))&&0<E.rangeCount&&(E=E.getRangeAt(0)))var y=E.endContainer;
for(;y&&y!==B.editNode&&y!==B.document;){if((E=y.tagName?y.tagName.toLowerCase():"")&&-1<A.indexOf(this.button.values,E)){F=E;break}y=y.parentNode}F||(F="noFormat")}F!==this.button.get("value")&&this.button.set("value",F,!1)}}}});A.forEach(["fontName","fontSize","formatBlock"],function(B){z.registry[B]=function(E){return new I({command:B,plainText:E.plainText})}});I._FontDropDown=v;I._FontNameDropDown=h;I._FontSizeDropDown=r;I._FormatBlockDropDown=G;return I})},"dojox/editor/plugins/Preview":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/Button dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Preview".split(" "),
function(v,A,C,t){var k=v.declare("dojox.editor.plugins.Preview",t,{useDefaultCommand:!1,styles:"",stylesheets:null,iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=v.i18n.getLocalization("dojox.editor.plugins","Preview");this.button=new A.form.Button({label:this._nlsResources.preview,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Preview",tabIndex:"-1",onClick:v.hitch(this,"_preview")})},setEditor:function(b){this.editor=b;this._initButton()},
updateState:function(){this.button.set("disabled",this.get("disabled"))},_preview:function(){try{var b=this.editor.get("value"),f="\t\t\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dUTF-8'\x3e\n",d;if(this.stylesheets)for(d=0;d<this.stylesheets.length;d++)f+="\t\t\x3clink rel\x3d'stylesheet' type\x3d'text/css' href\x3d'"+this.stylesheets[d]+"'\x3e\n";this.styles&&(f+="\t\t\x3cstyle\x3e"+this.styles+"\x3c/style\x3e\n");b="\x3chtml\x3e\n\t\x3chead\x3e\n"+f+"\t\x3c/head\x3e\n\t\x3cbody\x3e\n"+
b+"\n\t\x3c/body\x3e\n\x3c/html\x3e";var c=window.open("javascript: ''",this._nlsResources.preview,"status\x3d1,menubar\x3d0,location\x3d0,toolbar\x3d0");c.document.open();c.document.write(b);c.document.close()}catch(a){console.warn(a)}}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(b){b.plugin||"preview"!==b.args.name.toLowerCase()||(b.plugin=new k({styles:"styles"in b.args?b.args.styles:"",stylesheets:"stylesheets"in b.args?b.args.stylesheets:null}))});return k})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(v,A,C,t,k,b){var f=C("dijit._editor.plugins.TextColor",k,{buttonClass:b,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var d=this;this.button.loadDropDown=function(c){function a(e){d.button.dropDown=new e({dir:d.editor.dir,ownerDocument:d.editor.ownerDocument,value:d.value,onChange:function(g){d.editor.execCommand(d.command,g)},onExecute:function(){d.editor.execCommand(d.command,this.get("value"))}});c()}"string"==
typeof d.colorPicker?v([d.colorPicker],a):a(d.colorPicker)}},updateState:function(){var d=this.editor,c=this.command;if(d&&d.isLoaded&&c.length){if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{var e=d.queryCommandValue(c)||""}catch(g){e=""}}""==e&&(e="#000000");"transparent"==e&&(e="#ffffff");"string"==typeof e?-1<e.indexOf("rgb")&&(e=A.fromRgb(e).toHex()):(e=((e&255)<<16|e&65280|(e&16711680)>>>16).toString(16),e="#000000".slice(0,7-e.length)+e);this.value=
e;(d=this.button.dropDown)&&d.get&&e!==d.get("value")&&d.set("value",e,!1)}}});k.registry.foreColor=function(d){return new f(d)};k.registry.hiliteColor=function(d){return new f(d)};return f})},"dojox/editor/plugins/ToolbarLineBreak":function(){define("dojo dijit dojox dijit/_Widget dijit/_TemplatedMixin dijit/_editor/_Plugin dojo/_base/declare".split(" "),function(v,A,C,t,k,b,f){var d=f("dojox.editor.plugins.ToolbarLineBreak",[t,k],{templateString:"\x3cspan class\x3d'dijit dijitReset'\x3e\x3cbr\x3e\x3c/span\x3e",
postCreate:function(){v.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin){var a=c.args.name.toLowerCase();if("||"===a||"toolbarlinebreak"===a)c.plugin=new b({button:new d,setEditor:function(e){this.editor=e}})}});return d})},"dojox/editor/plugins/FindReplace":function(){define("dojo dijit dojox dijit/_base/manager dijit/_base/popup dijit/_Widget dijit/_TemplatedMixin dijit/_KeyNavContainer dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/Toolbar dijit/form/CheckBox dijit/form/_TextBoxMixin dijit/form/TextBox dijit/_editor/_Plugin dijit/form/Button dijit/form/DropDownButton dijit/form/ToggleButton ./ToolbarLineBreak dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/FindReplace".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l){v.experimental("dojox.editor.plugins.FindReplace");var h=v.declare("dojox.editor.plugins._FindReplaceCloseBox",[b,f,c],{btnId:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'float: right' class\x3d'dijitInline' tabindex\x3d'-1'\x3e\x3cbutton class\x3d'dijit dijitReset dijitInline' id\x3d'${btnId}' dojoAttachPoint\x3d'button' dojoType\x3d'dijit.form.Button' tabindex\x3d'-1' iconClass\x3d'dijitEditorIconsFindReplaceClose' showLabel\x3d'false'\x3eX\x3c/button\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=A.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.btnId=this.id+"_close";this.inherited(arguments)},startup:function(){this.connect(this.button,"onClick","onClick")},onClick:function(){}}),r=v.declare("dojox.editor.plugins._FindReplaceTextBox",[b,f,c],{textId:"",label:"",toolTip:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceTextBox' title\x3d'${tooltip}' tabindex\x3d'-1'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${textId}' tabindex\x3d'-1'\x3e${label}\x3c/label\x3e\x3cinput dojoType\x3d'dijit.form.TextBox' intermediateChanges\x3d'true' class\x3d'focusTextBox' tabIndex\x3d'0' id\x3d'${textId}' dojoAttachPoint\x3d'textBox, focusNode' value\x3d'' dojoAttachEvent\x3d'onKeyPress: _onKeyPress'/\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=A.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.textId=this.id+"_text";this.inherited(arguments)},postCreate:function(){this.textBox.set("value","");this.disabled=this.textBox.get("disabled");this.connect(this.textBox,"onChange","onChange");v.attr(this.textBox.textbox,"formnovalidate","true")},_setValueAttr:function(E){this.value=E;this.textBox.set("value",E)},focus:function(){this.textBox.focus()},_setDisabledAttr:function(E){this.disabled=E;this.textBox.set("disabled",
E)},onChange:function(E){this.value=E},_onKeyPress:function(E){var J=0,F=0;!E.target||E.ctrlKey||E.altKey||E.shiftKey||(E.keyCode==v.keys.LEFT_ARROW?(J=E.target.selectionStart,F=E.target.selectionEnd,J<F&&(A.selectInputText(E.target,J,J),v.stopEvent(E))):E.keyCode==v.keys.RIGHT_ARROW&&(J=E.target.selectionStart,F=E.target.selectionEnd,J<F&&(A.selectInputText(E.target,F,F),v.stopEvent(E))))}}),G=v.declare("dojox.editor.plugins._FindReplaceCheckBox",[b,f,c],{checkId:"",label:"",tooltip:"",widget:null,
widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' tabindex\x3d'-1' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceCheckBox' title\x3d'${tooltip}' \x3e\x3cinput dojoType\x3d'dijit.form.CheckBox' tabIndex\x3d'0' id\x3d'${checkId}' dojoAttachPoint\x3d'checkBox, focusNode' value\x3d''/\x3e\x3clabel tabindex\x3d'-1' class\x3d'dijitLeft dijitInline' for\x3d'${checkId}'\x3e${label}\x3c/label\x3e\x3c/span\x3e",postMixInProperties:function(){this.id=A.getUniqueId(this.declaredClass.replace(/\./g,
"_"));this.checkId=this.id+"_check";this.inherited(arguments)},postCreate:function(){this.checkBox.set("checked",!1);this.disabled=this.checkBox.get("disabled");this.checkBox.isFocusable=function(){return!1}},_setValueAttr:function(E){this.checkBox.set("value",E)},_getValueAttr:function(){return this.checkBox.get("value")},focus:function(){this.checkBox.focus()},_setDisabledAttr:function(E){this.disabled=E;this.checkBox.set("disabled",E)}}),I=v.declare("dojox.editor.plugins._FindReplaceToolbar",e,
{postCreate:function(){this.connectKeyNavHandlers([],[]);this.connect(this.containerNode,"onclick","_onToolbarEvent");this.connect(this.containerNode,"onkeydown","_onToolbarEvent");v.addClass(this.domNode,"dijitToolbar")},addChild:function(E,J){A._KeyNavContainer.superclass.addChild.apply(this,arguments)},_onToolbarEvent:function(E){E.stopPropagation()}}),B=v.declare("dojox.editor.plugins.FindReplace",[l],{buttonClass:A.form.ToggleButton,iconClassPrefix:"dijitEditorIconsFindReplace",editor:null,button:null,
_frToolbar:null,_closeBox:null,_findField:null,_replaceField:null,_findButton:null,_replaceButton:null,_replaceAllButton:null,_caseSensitive:null,_backwards:null,_promDialog:null,_promDialogTimeout:null,_strings:null,_bookmark:null,_initButton:function(){this._strings=v.i18n.getLocalization("dojox.editor.plugins","FindReplace");this.button=new A.form.ToggleButton({label:this._strings.findReplace,showLabel:!1,iconClass:this.iconClassPrefix+" dijitEditorIconFindString",tabIndex:"-1",onChange:v.hitch(this,
"_toggleFindReplace")});v.isOpera&&this.button.set("disabled",!0);this.connect(this.button,"set",v.hitch(this,function(E,J){"disabled"===E&&this._toggleFindReplace(!J&&this._displayed,!0,!0)}))},setEditor:function(E){this.editor=E;this._initButton()},toggle:function(){this.button.set("checked",!this.button.get("checked"))},_toggleFindReplace:function(E,J,F){var y=v.marginBox(this.editor.domNode);E&&!v.isOpera?(v.style(this._frToolbar.domNode,"display","block"),this._populateFindField(),J||(this._displayed=
!0)):(v.style(this._frToolbar.domNode,"display","none"),J||(this._displayed=!1),F||this.editor.focus());this.editor.resize({h:y.h})},_populateFindField:function(){var E=this.editor._sCall("getSelectedText",[null]);this._findField&&this._findField.textBox&&(E&&this._findField.textBox.set("value",E),this._findField.textBox.focus(),A.selectInputText(this._findField.textBox.focusNode))},setToolbar:function(E){this.inherited(arguments);if(!v.isOpera){var J=this._frToolbar=new I;v.style(J.domNode,"display",
"none");v.place(J.domNode,E.domNode,"after");J.startup();this._closeBox=new h;J.addChild(this._closeBox);this._findField=new r({label:this._strings.findLabel,tooltip:this._strings.findTooltip});J.addChild(this._findField);this._replaceField=new r({label:this._strings.replaceLabel,tooltip:this._strings.replaceTooltip});J.addChild(this._replaceField);J.addChild(new C.editor.plugins.ToolbarLineBreak);this._findButton=new A.form.Button({label:this._strings.findButton,showLabel:!0,iconClass:this.iconClassPrefix+
" dijitEditorIconFind"});this._findButton.titleNode.title=this._strings.findButtonTooltip;J.addChild(this._findButton);this._replaceButton=new A.form.Button({label:this._strings.replaceButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplace"});this._replaceButton.titleNode.title=this._strings.replaceButtonTooltip;J.addChild(this._replaceButton);this._replaceAllButton=new A.form.Button({label:this._strings.replaceAllButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplaceAll"});
this._replaceAllButton.titleNode.title=this._strings.replaceAllButtonTooltip;J.addChild(this._replaceAllButton);this._caseSensitive=new G({label:this._strings.matchCase,tooltip:this._strings.matchCaseTooltip});J.addChild(this._caseSensitive);this._backwards=new G({label:this._strings.backwards,tooltip:this._strings.backwardsTooltip});J.addChild(this._backwards);this._findButton.set("disabled",!0);this._replaceButton.set("disabled",!0);this._replaceAllButton.set("disabled",!0);this.connect(this._findField,
"onChange","_checkButtons");this.connect(this._findField,"onKeyDown","_onFindKeyDown");this.connect(this._replaceField,"onKeyDown","_onReplaceKeyDown");this.connect(this._findButton,"onClick","_find");this.connect(this._replaceButton,"onClick","_replace");this.connect(this._replaceAllButton,"onClick","_replaceAll");this.connect(this._closeBox,"onClick","toggle");this._promDialog=new A.TooltipDialog;this._promDialog.startup();this._promDialog.set("content","")}},_checkButtons:function(){this._findField.get("value")?
(this._findButton.set("disabled",!1),this._replaceButton.set("disabled",!1),this._replaceAllButton.set("disabled",!1)):(this._findButton.set("disabled",!0),this._replaceButton.set("disabled",!0),this._replaceAllButton.set("disabled",!0))},_onFindKeyDown:function(E){E.keyCode==v.keys.ENTER&&(this._find(),v.stopEvent(E))},_onReplaceKeyDown:function(E){E.keyCode==v.keys.ENTER&&(this._replace()||this._replace(),v.stopEvent(E))},_find:function(E){var J=this._findField.get("value")||"";if(J){var F=this._caseSensitive.get("value"),
y=this._backwards.get("value");J=this._findText(J,F,y);!J&&E&&(this._promDialog.set("content",v.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextFind})),A.popup.open({popup:this._promDialog,around:this._findButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;A.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this.editor.focus()}),0));return J}return!1},_replace:function(E){var J=
!1,F=this.editor;F.focus();var y=this._findField.get("value")||"",x=this._replaceField.get("value")||"";if(y){var w=this._caseSensitive.get("value"),n=this._backwards.get("value"),q=F._sCall("getSelectedText",[null]);v.isMoz&&(y=v.trim(y),q=v.trim(q));y=this._filterRegexp(y,!w);q&&y.test(q)&&(F.execCommand("inserthtml",x),J=!0,n&&(this._findText(x,w,n),F._sCall("collapse",[!0])));!this._find(!1)&&E&&(this._promDialog.set("content",v.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextReplace})),
A.popup.open({popup:this._promDialog,around:this._replaceButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;A.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this.editor.focus()}),0));return J}return null},_replaceAll:function(E){var J=0;this._backwards.get("value")?this.editor.placeCursorAtEnd():this.editor.placeCursorAtStart();this._replace(!1)&&J++;var F=v.hitch(this,function(){this._replace(!1)?
(J++,setTimeout(F,10)):E&&(this._promDialog.set("content",v.string.substitute(this._strings.replaceDialogText,{0:""+J})),A.popup.open({popup:this._promDialog,around:this._replaceAllButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;A.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this._findField.focus();this._findField.textBox.focusNode.select()}),0))});F()},_findText:function(E,J,
F){var y=this.editor,x=y.window,w=!1;if(E)if(x.find)w=x.find(E,J,F,!1,!1,!1,!1);else{var n=y.document;if(n.selection||x.getSelection)if(this.editor.focus(),y=n.body.createTextRange(),w=y.duplicate(),x.getSelection().getRangeAt(0),(n=n.selection?n.selection.createRange():null)?F?y.setEndPoint("EndToStart",n):y.setEndPoint("StartToEnd",n):this._bookmark&&(x=x.getSelection().toString(),y.moveToBookmark(this._bookmark),y.text!=x?(y=w.duplicate(),this._bookmark=null):(F?w.setEndPoint("EndToStart",y):w.setEndPoint("StartToEnd",
y),y=w.duplicate())),J=J?4:0,F&&(J|=1),w=y.findText(E,y.text.length,J))y.select(),this._bookmark=y.getBookmark()}return w},_filterRegexp:function(E,J){for(var F="",y=null,x=0;x<E.length;x++)switch(y=E.charAt(x),y){case "\\":F+=y;x++;F+=E.charAt(x);break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":F+="\\";default:F+=y}F="^"+F+"$";return J?new RegExp(F,"mi"):new RegExp(F,"m")},updateState:function(){this.button.set("disabled",this.get("disabled"))},
destroy:function(){this.inherited(arguments);this._promDialogTimeout&&(clearTimeout(this._promDialogTimeout),this._promDialogTimeout=null,A.popup.close(this._promDialog));this._frToolbar&&(this._frToolbar.destroyRecursive(),this._frToolbar=null);this._promDialog&&(this._promDialog.destroyRecursive(),this._promDialog=null)}});B._FindReplaceCloseBox=h;B._FindReplaceTextBox=r;B._FindReplaceCheckBox=G;B._FindReplaceToolbar=I;v.subscribe(A._scopeName+".Editor.getPlugin",null,function(E){E.plugin||"findreplace"!==
E.args.name.toLowerCase()||(E.plugin=new B({}))});return B})},"dojox/editor/plugins/PasteFromWord":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/RichText dijit/form/Button dijit/Dialog dojox/html/format dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/PasteFromWord dojo/i18n!dijit/nls/common dojo/i18n!dijit/_editor/nls/commands".split(" "),function(v,A,C,t){var k=v.declare("dojox.editor.plugins.PasteFromWord",
t,{iconClassPrefix:"dijitAdditionalEditorIcon",width:"400px",height:"300px",_template:"\x3cdiv class\x3d'dijitPasteFromWordEmbeddedRTE'\x3e\x3cdiv style\x3d'width: ${width}; padding-top: 5px; padding-bottom: 5px;'\x3e${instructions}\x3c/div\x3e\x3cdiv id\x3d'${uId}_rte' style\x3d'width: ${width}; height: ${height}'\x3e\x3c/div\x3e\x3ctable style\x3d'width: ${width}' tabindex\x3d'-1'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_paste'\x3e${paste}\x3c/button\x3e\x26nbsp;\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_cancel'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",
_filters:[{regexp:/(<meta\s*[^>]*\s*>)|(<\s*link\s* href="file:[^>]*\s*>)|(<\/?\s*\w+:[^>]*\s*>)/gi,handler:""},{regexp:/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,handler:""},{regexp:/(class="Mso[^"]*")|(\x3c!--(.|\s){1,}?--\x3e)/gi,handler:""},{regexp:/(<p[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/p[^>]*>)|(<p[^>]*>\s*<font[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/\s*font\s*>\s<\/p[^>]*>)/ig,handler:""},{regexp:/(style="[^"]*mso-[^;][^"]*")|(style="margin:\s*[^;"]*;")/gi,
handler:""},{regexp:/(<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>)|(<\s*script\b([^<>]|\s)*>?)|(<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>)/ig,handler:""},{regexp:/<(\/?)o:p[^>]*>/gi,handler:""}],_initButton:function(){this._filters=this._filters.slice(0);var b=v.i18n.getLocalization("dojox.editor.plugins","PasteFromWord");v.mixin(b,v.i18n.getLocalization("dijit","common"));v.mixin(b,v.i18n.getLocalization("dijit._editor","commands"));this.button=new A.form.Button({label:b.pasteFromWord,
showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"PasteFromWord",tabIndex:"-1",onClick:v.hitch(this,"_openDialog")});this._uId=A.getUniqueId(this.editor.id);b.uId=this._uId;b.width=this.width||"400px";b.height=this.height||"300px";this._dialog=(new A.Dialog({title:b.pasteFromWord})).placeAt(v.body());this._dialog.set("content",v.string.substitute(this._template,b));v.style(v.byId(this._uId+"_rte"),"opacity",.001);this.connect(A.byId(this._uId+"_paste"),"onClick","_paste");this.connect(A.byId(this._uId+
"_cancel"),"onClick","_cancel");this.connect(this._dialog,"onHide","_clearDialog")},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(b){this.editor=b;this._initButton()},_openDialog:function(){this._dialog.show();this._rte||setTimeout(v.hitch(this,function(){this._rte=new A._editor.RichText({height:this.height||"300px"},this._uId+"_rte");this._rte.startup();this._rte.onLoadDeferred.addCallback(v.hitch(this,function(){v.animateProperty({node:this._rte.domNode,
properties:{opacity:{start:.001,end:1}}}).play()}))}),100)},_paste:function(){var b=C.html.format.prettyPrint(this._rte.get("value"));this._dialog.hide();var f;for(f=0;f<this._filters.length;f++){var d=this._filters[f];b=b.replace(d.regexp,d.handler)}b=C.html.format.prettyPrint(b);this.editor.focus();this.editor.execCommand("inserthtml",b)},_cancel:function(){this._dialog.hide()},_clearDialog:function(){this._rte.set("value","")},destroy:function(){this._rte&&this._rte.destroy();this._dialog&&this._dialog.destroyRecursive();
delete this._dialog;delete this._rte;this.inherited(arguments)}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(b){b.plugin||"pastefromword"!==b.args.name.toLowerCase()||(b.plugin=new k({width:"width"in b.args?b.args.width:"400px",height:"height"in b.args?b.args.width:"300px"}))});return k})},"dojox/html/format":function(){define(["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(v,A,C,t,k){var b=v.getObject("dojox.html.format",!0);b.prettyPrint=
function(f,d,c,a,e){var g=[],p=0,z=[],l="\t",h="",r=[],G,I=/[=]([^"']+?)(\s|>)/g,B=/style=("[^"]*"|'[^']*'|\S*)/gi,E=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(d&&0<d&&10>d)for(l="",G=0;G<d;G++)l+=" ";d=t.doc.createElement("div");d.innerHTML=f;var J=A.encode,F=A.decode,y=d.ownerDocument.createElement("div"),x=function(u){u=u.cloneNode(!1);y.appendChild(u);u=y.innerHTML;y.innerHTML="";return u},w=function(){var u;for(u=0;u<p;u++)g.push(l)},n=function(){g.push("\n")},q=function(u){var D;u=u.split("\n");for(D=
0;D<u.length;D++)u[D]=v.trim(u[D]);u=u.join(" ");u=v.trim(u);if(""!==u){var M=[];if(c&&0<c){var L="";for(D=0;D<p;D++)L+=l;D=L.length;L=c;for(c>D&&(L-=D);u;)if(u.length>c){for(D=L;0<D&&" "!==u.charAt(D);D--);if(!D)for(D=L;D<u.length&&" "!==u.charAt(D);D++);var N=u.substring(0,D);N=v.trim(N);u=v.trim(u.substring(D==u.length?u.length:D+1,u.length));if(N){var O="";for(D=0;D<p;D++)O+=l;N=O+N+"\n"}M.push(N)}else{O="";for(D=0;D<p;D++)O+=l;u=O+u+"\n";M.push(u);u=null}return M.join("")}O="";for(D=0;D<p;D++)O+=
l;return O+u+"\n"}return""},H=function(u){if(u){var D=u;D&&(D=D.replace(/&quot;/gi,'"'),D=D.replace(/&gt;/gi,"\x3e"),D=D.replace(/&lt;/gi,"\x3c"),D=D.replace(/&amp;/gi,"\x26"));var M;u=0;var L=D.split("\n"),N=[];for(D=0;D<L.length;D++){var O=L[D],Q=-1<O.indexOf("\n");if(O=v.trim(O)){Q=u;for(M=0;M<O.length;M++){var P=O.charAt(M);"{"===P?u++:"}"===P&&(u--,Q=u)}P="";for(M=0;M<p+Q;M++)P+=l;N.push(P+O+"\n")}else Q&&0===D&&N.push("\n")}u=N.join("")}return u},K=function(u){var D=u.nodeName.toLowerCase(),
M=v.trim(x(u));u=M.substring(0,M.indexOf("\x3e")+1);u=u.replace(I,'\x3d"$1"$2');u=u.replace(B,function(N){var O=N.substring(0,6);N=N.substring(6,N.length);var Q=N.charAt(0);N=v.trim(N.substring(1,N.length-1));N=N.split(";");var P=[];C.forEach(N,function(R){if(R=v.trim(R))R=R.substring(0,R.indexOf(":")).toLowerCase()+R.substring(R.indexOf(":"),R.length),P.push(R)});P=P.sort();N=P.join("; ");var S=v.trim(N);return S&&";"!==S?O+Q+(N+";")+Q:""});var L=[];u=u.replace(E,function(N){L.push(v.trim(N));return""});
L=L.sort();u="\x3c"+D;L.length&&(u+=" "+L.join(" "));-1!=M.indexOf("\x3c/")?(z.push(D),u+="\x3e"):(u=e?u+" /\x3e":u+"\x3e",z.push(!1));a:switch(D){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "small":D=!0;break a;default:D=!1}r.push(D);h&&!D&&(g.push(q(h)),h="");D?h+=u:(w(),g.push(u),n(),p++)},m=function(u){var D=u.childNodes;if(D){var M;for(M=0;M<D.length;M++){var L=D[M];if(1===
L.nodeType){var N=v.trim(L.tagName.toLowerCase());k("ie")&&L.parentNode!=u||N&&"/"===N.charAt(0)||(K(L),"script"===N?g.push(H(L.innerHTML)):"pre"===N?(L=L.innerHTML,k("mozilla")&&(L=L.replace("\x3cbr\x3e","\n"),L=L.replace("\x3cpre\x3e",""),L=L.replace("\x3c/pre\x3e","")),"\n"!==L.charAt(L.length-1)&&(L+="\n"),g.push(L)):m(L),L=r.pop(),h&&!L&&(g.push(q(h)),h=""),(N=z.pop())?(N="\x3c/"+N+"\x3e",L?h+=N:(p--,w(),g.push(N),n())):p--)}else 3===L.nodeType||4===L.nodeType?h+=J(L.nodeValue,a):8===L.nodeType&&
(L=F(L.nodeValue,a),w(),g.push("\x3c!--"),n(),p++,g.push(q(L)),p--,w(),g.push("--\x3e"),n())}}};m(d);h&&(g.push(q(h)),h="");return g.join("")};return b})},"dojox/editor/plugins/InsertAnchor":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/range dijit/_Templated dijit/TooltipDialog dijit/form/ValidationTextBox dijit/form/Select dijit/form/Button dijit/form/DropDownButton dojo/_base/declare dojo/i18n dojo/string dojo/NodeList-dom dojox/editor/plugins/ToolbarLineBreak dojo/i18n!dojox/editor/plugins/nls/InsertAnchor dojo/i18n!dijit/nls/common".split(" "),
function(v,A,C,t){var k=v.declare("dojox.editor.plugins.InsertAnchor",t,{htmlTemplate:'\x3ca name\x3d"${anchorInput}" class\x3d"dijitEditorPluginInsertAnchorStyle"\x3e${textInput}\x3c/a\x3e',iconClassPrefix:"dijitAdditionalEditorIcon",_template:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_anchorInput'\x3e${anchor}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_anchorInput' name\x3d'anchorInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${cancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){var b=this,f=v.i18n.getLocalization("dojox.editor.plugins","InsertAnchor",this.lang),d=this.dropDown=new A.TooltipDialog({title:f.title,execute:v.hitch(this,"setValue"),onOpen:function(){b._onOpenDialog();A.TooltipDialog.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(v.hitch(b,"_onCloseDialog"),0)}});this.button=new A.form.DropDownButton({label:f.insertAnchor,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"InsertAnchor",tabIndex:"-1",
dropDown:this.dropDown});f.id=A.getUniqueId(this.editor.id);this._uniqueId=f.id;this.dropDown.set("content",d.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+v.string.substitute(this._template,f));d.startup();this._anchorInput=A.byId(this._uniqueId+"_anchorInput");this._textInput=A.byId(this._uniqueId+"_textInput");this._setButton=A.byId(this._uniqueId+"_setButton");this.connect(A.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel()});
this._anchorInput&&this.connect(this._anchorInput,"onChange","_checkInput");this._textInput&&this.connect(this._anchorInput,"onChange","_checkInput");this.editor.contentDomPreFilters.push(v.hitch(this,this._preDomFilter));this.editor.contentDomPostFilters.push(v.hitch(this,this._postDomFilter));this._setup()},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(b){this.editor=b;this._initButton()},_checkInput:function(){var b=!0;this._anchorInput.isValid()&&
(b=!1);this._setButton.set("disabled",b)},_setup:function(){this.editor.onLoadDeferred.addCallback(v.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);setTimeout(v.hitch(this,function(){this._applyStyles()}),100)}))},getAnchorStyle:function(){var b=v.moduleUrl(C._scopeName,"editor/plugins/resources").toString();if(!b.match(/^https?:\/\//i)&&!b.match(/^file:\/\//i)){var f="/"===b.charAt(0)?v.doc.location.protocol+"//"+v.doc.location.host:this._calcBaseUrl(v.global.location.href);
"/"!==f[f.length-1]&&"/"!==b.charAt(0)&&(f+="/");b=f+b}return"@media screen {\n\t.dijitEditorPluginInsertAnchorStyle {\n\t\tbackground-image: url({MODURL}/images/anchor.gif);\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-position: top left;\n\t\tborder-width: 1px;\n\t\tborder-style: dashed;\n\t\tborder-color: #D0D0D0;\n\t\tpadding-left: 20px;\n\t}\n}\n".replace(/\{MODURL\}/gi,b)},_applyStyles:function(){if(!this._styled)try{this._styled=!0;var b=this.editor.document,f=this.getAnchorStyle();if(v.isIE)b.createStyleSheet("").cssText=
f;else{var d=b.createElement("style");d.appendChild(b.createTextNode(f));b.getElementsByTagName("head")[0].appendChild(d)}}catch(c){}},_calcBaseUrl:function(b){var f=null;null!==b&&(f=b.indexOf("?"),-1!=f&&(b=b.substring(0,f)),f=b.lastIndexOf("/"),f=0<f&&f<b.length?b.substring(0,f):b);return f},_checkValues:function(b){b&&(b.anchorInput&&(b.anchorInput=b.anchorInput.replace(/"/g,"\x26quot;")),b.textInput||(b.textInput="\x26nbsp;"));return b},setValue:function(b){this._onCloseDialog();if(!this.editor.window.getSelection){var f=
A.range.getSelection(this.editor.window).getRangeAt(0).endContainer;3===f.nodeType&&(f=f.parentNode);f&&f.nodeName&&"a"!==f.nodeName.toLowerCase()&&(f=this.editor._sCall("getSelectedElement",["a"]));f&&f.nodeName&&"a"===f.nodeName.toLowerCase()&&this.editor.queryCommandEnabled("unlink")&&(this.editor._sCall("selectElementChildren",[f]),this.editor.execCommand("unlink"))}b=this._checkValues(b);this.editor.execCommand("inserthtml",v.string.substitute(this.htmlTemplate,b))},_onCloseDialog:function(){this.editor.focus()},
_getCurrentValues:function(b){if(b&&"a"===b.tagName.toLowerCase()&&v.attr(b,"name")){var f=v.attr(b,"name");var d=b.textContent||b.innerText;this.editor._sCall("selectElement",[b,!0])}else d=this.editor._sCall("getSelectedText");return{anchorInput:f||"",textInput:d||""}},_onOpenDialog:function(){if(this.editor.window.getSelection)var b=this.editor._sCall("getAncestorElement",["a"]);else b=A.range.getSelection(this.editor.window).getRangeAt(0).endContainer,3===b.nodeType&&(b=b.parentNode),b&&b.nodeName&&
"a"!==b.nodeName.toLowerCase()&&(b=this.editor._sCall("getSelectedElement",["a"]));this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(b))},_onDblClick:function(b){b&&b.target&&(b=b.target,"a"===(b.tagName?b.tagName.toLowerCase():"")&&v.attr(b,"name")&&(this.editor.onDisplayChanged(),this.editor._sCall("selectElement",[b]),setTimeout(v.hitch(this,function(){this.button.set("disabled",!1);this.button.openDropDown();this.button.dropDown.focus&&this.button.dropDown.focus()}),
10)))},_preDomFilter:function(b){v.query("a[name]:not([href])",this.editor.editNode).addClass("dijitEditorPluginInsertAnchorStyle")},_postDomFilter:function(b){b&&v.query("a[name]:not([href])",b).removeClass("dijitEditorPluginInsertAnchorStyle");return b}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(b){if(!b.plugin){var f=b.args.name;f&&(f=f.toLowerCase());"insertanchor"===f&&(b.plugin=new k)}});return k})},"dojox/editor/plugins/Blockquote":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/ToggleButton dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Blockquote".split(" "),
function(v,A,C,t){var k=v.declare("dojox.editor.plugins.Blockquote",t,{iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=v.i18n.getLocalization("dojox.editor.plugins","Blockquote");this.button=new A.form.ToggleButton({label:this._nlsResources.blockquote,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Blockquote",tabIndex:"-1",onClick:v.hitch(this,"_toggleQuote")})},setEditor:function(b){this.editor=b;this._initButton();this.connect(this.editor,
"onNormalizedDisplayChanged","updateState");b.customUndo=!0},_toggleQuote:function(b){try{var f=this.editor;f.focus();var d=this.button.get("checked"),c=A.range.getSelection(f.window),a,e,g,p;c&&0<c.rangeCount&&(a=c.getRangeAt(0));if(a){f.beginEditing();if(d)if(a.startContainer===a.endContainer){if(this._isRootInline(a.startContainer)){for(g=a.startContainer;g&&g.parentNode!==f.editNode;)g=g.parentNode;for(;g&&g.previousSibling&&(this._isTextElement(g)||1===g.nodeType&&this._isInlineFormat(this._getTagName(g)));)g=
g.previousSibling;g&&1===g.nodeType&&!this._isInlineFormat(this._getTagName(g))&&(g=g.nextSibling);if(g){var z=f.document.createElement("blockquote");v.place(z,g,"after");z.appendChild(g);for(p=z.nextSibling;p&&(this._isTextElement(p)||1===p.nodeType&&this._isInlineFormat(this._getTagName(p)));)z.appendChild(p),p=z.nextSibling}}else{for(var l=a.startContainer;(this._isTextElement(l)||this._isInlineFormat(this._getTagName(l))||"li"===this._getTagName(l))&&l!==f.editNode&&l!==f.document.body;)l=l.parentNode;
l!==f.editNode&&l!==l.ownerDocument.documentElement&&(z=f.document.createElement("blockquote"),v.place(z,l,"after"),z.appendChild(l))}z&&(f._sCall("selectElementChildren",[z]),f._sCall("collapse",[!0]))}else{var h;g=a.startContainer;for(p=a.endContainer;g&&this._isTextElement(g)&&g.parentNode!==f.editNode;)g=g.parentNode;for(h=g;h.nextSibling&&f._sCall("inSelection",[h]);)h=h.nextSibling;p=h;if(p===f.editNode||p===f.document.body){z=f.document.createElement("blockquote");v.place(z,g,"after");var r=
this._getTagName(g);if(this._isTextElement(g)||this._isInlineFormat(r))for(f=g;f&&(this._isTextElement(f)||1===f.nodeType&&this._isInlineFormat(this._getTagName(f)));)z.appendChild(f),f=z.nextSibling;else z.appendChild(g);return}p=p.nextSibling;for(h=g;h&&h!==p;){if(1===h.nodeType){if(r=this._getTagName(h),"br"!==r){if(!window.getSelection&&"p"===r&&this._isEmpty(h)){h=h.nextSibling;continue}this._isInlineFormat(r)?z||(z=f.document.createElement("blockquote"),v.place(z,h,"after")):(z&&this._isEmpty(z)&&
z.parentNode.removeChild(z),z=f.document.createElement("blockquote"),v.place(z,h,"after"));z.appendChild(h);h=z}}else this._isTextElement(h)&&(z||(z=f.document.createElement("blockquote"),v.place(z,h,"after")),z.appendChild(h),h=z);h=h.nextSibling}z&&(this._isEmpty(z)?z.parentNode.removeChild(z):(f._sCall("selectElementChildren",[z]),f._sCall("collapse",[!0])),z=null)}else if(z=!1,a.startContainer===a.endContainer){for(e=a.endContainer;e&&e!==f.editNode&&e!==f.document.body;){if("blockquote"===(e.tagName?
e.tagName.toLowerCase():"")){z=!0;break}e=e.parentNode}if(z){for(var G;e.firstChild;)G=e.firstChild,v.place(G,e,"before");e.parentNode.removeChild(e);G&&(f._sCall("selectElementChildren",[G]),f._sCall("collapse",[!0]))}}else{g=a.startContainer;for(p=a.endContainer;g&&this._isTextElement(g)&&g.parentNode!==f.editNode;)g=g.parentNode;for(a=[];g&&g.nextSibling&&f._sCall("inSelection",[g]);)g.parentNode&&"blockquote"===this._getTagName(g.parentNode)&&(g=g.parentNode),a.push(g),g=g.nextSibling;for(var I=
this._findBlockQuotes(a);I.length;){var B=I.pop();if(B.parentNode){for(;B.firstChild;)v.place(B.firstChild,B,"before");B.parentNode.removeChild(B)}}}f.endEditing()}f.onNormalizedDisplayChanged()}catch(E){}},updateState:function(){var b=this.editor,f=this.get("disabled");if(b&&b.isLoaded&&this.button&&(this.button.set("disabled",f),!f)){f=!1;var d=A.range.getSelection(b.window);if(d&&0<d.rangeCount&&(d=d.getRangeAt(0)))var c=d.endContainer;for(;c&&c!==b.editNode&&c!==b.document;){if("blockquote"===
(c.tagName?c.tagName.toLowerCase():"")){f=!0;break}c=c.parentNode}this.button.set("checked",f)}},_findBlockQuotes:function(b){var f=[];if(b){var d;for(d=0;d<b.length;d++){var c=b[d];1===c.nodeType&&("blockquote"===this._getTagName(c)&&f.push(c),c.childNodes&&0<c.childNodes.length&&(f=f.concat(this._findBlockQuotes(c.childNodes))))}}return f},_getTagName:function(b){var f="";b&&1===b.nodeType&&(f=b.tagName?b.tagName.toLowerCase():"");return f},_isRootInline:function(b){var f=this.editor;if(this._isTextElement(b)&&
b.parentNode===f.editNode||1===b.nodeType&&this._isInlineFormat(b)&&b.parentNode===f.editNode)return!0;if(this._isTextElement(b)&&this._isInlineFormat(this._getTagName(b.parentNode))){for(b=b.parentNode;b&&b!==f.editNode&&this._isInlineFormat(this._getTagName(b));)b=b.parentNode;if(b===f.editNode)return!0}return!1},_isTextElement:function(b){return b&&3===b.nodeType||4===b.nodeType?!0:!1},_isEmpty:function(b){if(b.childNodes){var f=!0,d;for(d=0;d<b.childNodes.length;d++){var c=b.childNodes[d];if(1===
c.nodeType){if("p"!==this._getTagName(c)||v.trim(c.innerHTML)){f=!1;break}}else if(this._isTextElement(c)){if((c=v.trim(c.nodeValue))&&"\x26nbsp;"!==c&&"\u00a0"!==c){f=!1;break}}else{f=!1;break}}return f}return!0},_isInlineFormat:function(b){switch(b){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "img":case "small":return!0;default:return!1}}});v.subscribe(A._scopeName+".Editor.getPlugin",
null,function(b){b.plugin||"blockquote"!==b.args.name.toLowerCase()||(b.plugin=new k({}))});return k})},"dojox/editor/plugins/UploadImage":function(){define("dojo dijit dojox dijit/_editor/_Plugin dojo/_base/connect dojo/_base/declare dojox/form/FileUploader dijit/_editor/_Plugin".split(" "),function(v,A,C,t){v.experimental("dojox.editor.plugins.UploadImage");var k=v.declare("dojox.editor.plugins.UploadImage",t,{tempImageUrl:"",iconClassPrefix:"editorIcon",useDefaultCommand:!1,uploadUrl:"",button:null,
label:"Upload",setToolbar:function(b){this.button.destroy();this.createFileInput();b.addChild(this.button)},_initButton:function(){this.command="uploadImage";this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",arguments);delete this.command},updateState:function(){this.button.set("disabled",this.get("disabled"))},createFileInput:function(){var b=v.create("span",{innerHTML:"."},document.body);v.style(b,{width:"40px",height:"20px",paddingLeft:"8px",paddingRight:"8px"});this.button=
new C.form.FileUploader({isDebug:!0,uploadUrl:this.uploadUrl,uploadOnChange:!0,selectMultipleFiles:!1,baseClass:"dojoxEditorUploadNorm",hoverClass:"dojoxEditorUploadHover",activeClass:"dojoxEditorUploadActive",disabledClass:"dojoxEditorUploadDisabled"},b);this.connect(this.button,"onChange","insertTempImage");this.connect(this.button,"onComplete","onComplete")},onComplete:function(b,f,d){b=b[0];f=v.byId(this.currentImageId,this.editor.document);d=this.downloadPath?this.downloadPath+b.name:b.file;
f.src=d;v.attr(f,"_djrealurl",d);b.width&&(f.width=b.width,f.height=b.height)},insertTempImage:function(){this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+this.tempImageUrl+'" width\x3d"32" height\x3d"32"/\x3e')}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(b){if(!b.plugin)switch(b.args.name){case "uploadImage":b.plugin=new k({url:b.args.url})}});return k})},"dojox/form/FileUploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/_base/sniff dojo/query dojo/dom dojo/dom-style dojo/dom-geometry dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/_base/config dijit/_base/manager dojo/io/iframe dojo/_base/Color dojo/_base/unload dijit/_Widget dijit/_TemplatedMixin dijit/_Contained dojox/embed/Flash dojox/embed/flashVars dojox/html/styles".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p,z,l,h,r,G,I,B,E,J,F,y,x,w){v.deprecated("dojox.form.FileUploader","Use dojox.form.Uploader","2.0");return A("dojox.form.FileUploader",[E,J,F],{swfPath:h.uploaderPath||require.toUrl("dojox/form/resources/fileuploader.swf"),templateString:'\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d"progNode"\x3e\x3cdiv dojoAttachPoint\x3d"progTextNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d"insideNode" class\x3d"uploaderInsideNode"\x3e\x3c/div\x3e\x3c/div\x3e',uploadUrl:"",
isDebug:!1,devMode:!1,baseClass:"dojoxUploaderNorm",hoverClass:"dojoxUploaderHover",activeClass:"dojoxUploaderActive",disabledClass:"dojoxUploaderDisabled",force:"",uploaderType:"",flashObject:null,flashMovie:null,insideNode:null,deferredUploading:1,fileListId:"",uploadOnChange:!1,selectMultipleFiles:!0,htmlFieldName:"uploadedfile",flashFieldName:"flashUploadFiles",fileMask:null,minFlashVersion:9,tabIndex:-1,showProgress:!1,progressMessage:"Loading",progressBackgroundUrl:require.toUrl("dijit/themes/tundra/images/buttonActive.png"),
progressBackgroundColor:"#ededed",progressWidgetId:"",skipServerCheck:!1,serverTimeout:5E3,log:function(){this.isDebug&&console.log(Array.prototype.slice.call(arguments).join(" "))},constructor:function(){this._subs=[]},postMixInProperties:function(){this.fileList=[];this._cons=[];this.fileMask=this.fileMask||[];this.fileInputs=[];this.fileCount=0;this._disabled=this.flashReady=!1;this.force=this.force.toLowerCase();this.uploaderType=(y.available>=this.minFlashVersion||"flash"==this.force)&&"html"!=
this.force?"flash":"html";this.deferredUploading=!0===this.deferredUploading?1:this.deferredUploading;this._refNode=this.srcNodeRef;this.getButtonStyle()},startup:function(){},postCreate:function(){this.inherited(arguments);this.setButtonStyle();if("flash"==this.uploaderType)var n="createFlashUploader";else this.uploaderType="html",n="createHtmlUploader";this[n]();this.fileListId&&this.connect(c.byId(this.fileListId),"click",function(q){q=q.target.parentNode.parentNode.parentNode;q.id&&-1<q.id.indexOf("file_")&&
this.removeFile(q.id.split("file_")[1])});B.addOnUnload(this,this.destroy)},getHiddenNode:function(n){if(!n)return null;var q=null;for(n=n.parentNode;n&&"body"!=n.tagName.toLowerCase();){if("none"==a.get(n,"display")){q=n;break}n=n.parentNode}return q},getButtonStyle:function(){var n=this.srcNodeRef;(this._hiddenNode=this.getHiddenNode(n))&&a.set(this._hiddenNode,"display","block");if(!n&&this.button&&this.button.domNode){var q=!0;n=this.button.domNode.className+" dijitButtonNode";var H=this.getText(d(".dijitButtonText",
this.button.domNode)[0]);this.srcNodeRef=n=z.place('\x3cbutton id\x3d"'+this.button.id+'" class\x3d"'+n+'"\x3e'+H+"\x3c/button\x3e",this.button.domNode,"after");this.button.destroy();this.baseClass="dijitButton";this.hoverClass="dijitButtonHover";this.pressClass="dijitButtonActive";this.disabledClass="dijitButtonDisabled"}else!this.srcNodeRef&&this.button&&(n=this.button);g.get(n,"class")&&(this.baseClass+=" "+g.get(n,"class"));g.set(n,"class",this.baseClass);this.norm=this.getStyle(n);this.width=
this.norm.w;this.height=this.norm.h;"flash"==this.uploaderType?(this.over=this.getTempNodeStyle(n,this.baseClass+" "+this.hoverClass,q),this.down=this.getTempNodeStyle(n,this.baseClass+" "+this.activeClass,q),this.dsbl=this.getTempNodeStyle(n,this.baseClass+" "+this.disabledClass,q),this.fhtml={cn:this.getText(n),nr:this.norm,ov:this.over,dn:this.down,ds:this.dsbl}):(this.fhtml={cn:this.getText(n),nr:this.norm},"middle"==this.norm.va&&(this.norm.lh=this.norm.h));this.devMode&&(this.log("classes - base:",
this.baseClass," hover:",this.hoverClass,"active:",this.activeClass),this.log("fhtml:",this.fhtml),this.log("norm:",this.norm),this.log("over:",this.over),this.log("down:",this.down))},setButtonStyle:function(){a.set(this.domNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+"px",padding:"0px",lineHeight:"normal",position:"relative"});"html"==this.uploaderType&&"middle"==this.norm.va&&a.set(this.domNode,"lineHeight",this.norm.lh+"px");this.showProgress?(this.progTextNode.innerHTML=this.progressMessage,
a.set(this.progTextNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",lineHeight:this.fhtml.nr.h+0+"px",position:"absolute"}),a.set(this.progNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",position:"absolute",display:"none",backgroundImage:"url("+this.progressBackgroundUrl+")",backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundColor:this.progressBackgroundColor})):z.destroy(this.progNode);
a.set(this.insideNode,{position:"absolute",top:"0px",left:"0px",display:""});p.add(this.domNode,this.srcNodeRef.className);-1<this.fhtml.nr.d.indexOf("inline")&&p.add(this.domNode,"dijitInline");try{this.insideNode.innerHTML=this.fhtml.cn}catch(q){if("flash"==this.uploaderType){this.insideNode=this.insideNode.parentNode.removeChild(this.insideNode);b.body().appendChild(this.insideNode);this.insideNode.innerHTML=this.fhtml.cn;var n=k.connect(this,"onReady",this,function(){k.disconnect(n);this.insideNode=
this.insideNode.parentNode.removeChild(this.insideNode);this.domNode.appendChild(this.insideNode)})}else this.insideNode.appendChild(document.createTextNode(this.fhtml.cn))}this._hiddenNode&&a.set(this._hiddenNode,"display","none")},onChange:function(n){},onProgress:function(n){},onComplete:function(n){},onCancel:function(){},onError:function(n){},onReady:function(n){},onLoad:function(n){},submit:function(n){n=n?l.toObject(n):null;this.upload(n);return!1},upload:function(n){if(!this.fileList.length)return!1;
if(!this.uploadUrl)return console.warn("uploadUrl not provided. Aborting."),!1;this.showProgress||this.set("disabled",!0);if(this.progressWidgetId){var q=r.byId(this.progressWidgetId).domNode;"none"==a.get(q,"display")&&(this.restoreProgDisplay="none",a.set(q,"display","block"));"hidden"==a.get(q,"visibility")&&(this.restoreProgDisplay="hidden",a.set(q,"visibility","visible"))}n&&!n.target&&(this.postData=n);this.log("upload type:",this.uploaderType," - postData:",this.postData);for(n=0;n<this.fileList.length;n++)q=
this.fileList[n],q.bytesLoaded=0,q.bytesTotal=q.size||1E5,q.percent=0;"flash"==this.uploaderType?this.uploadFlash():this.uploadHTML();return!1},removeFile:function(n,q){var H;for(H=0;H<this.fileList.length;H++)if(this.fileList[H].name==n){q||this.fileList.splice(H,1);break}"flash"==this.uploaderType?this.flashMovie.removeFile(n):q||(z.destroy(this.fileInputs[H]),this.fileInputs.splice(H,1),this._renumberInputs());this.fileListId&&z.destroy("file_"+n)},destroy:function(){"flash"!=this.uploaderType||
this.flashMovie?(t.forEach(this._subs,k.unsubscribe,dojo),t.forEach(this._cons,k.disconnect,dojo),this.scrollConnect&&k.disconnect(this.scrollConnect),"flash"==this.uploaderType?(this.flashObject.destroy(),delete this.flashObject):(z.destroy(this._fileInput),z.destroy(this._formNode)),this.inherited(arguments)):this._cons.push(k.connect(this,"onLoad",this,"destroy"))},_displayProgress:function(n){!0===n?("flash"==this.uploaderType?a.set(this.insideNode,"top","-2500px"):a.set(this.insideNode,"display",
"none"),a.set(this.progNode,"display","")):!1===n?(a.set(this.insideNode,{display:"",top:"0"}),a.set(this.progNode,"display","none")):a.set(this.progNode,"width",n*this.fhtml.nr.w+"px")},_animateProgress:function(){this._displayProgress(!0);var n=!1,q=k.connect(this,"_complete",function(){k.disconnect(q);n=!0}),H=0,K=setInterval(C.hitch(this,function(){H+=5;H>this.fhtml.nr.w&&(H=0,n=!0);this._displayProgress(H/this.fhtml.nr.w);n&&(clearInterval(K),setTimeout(C.hitch(this,function(){this._displayProgress(!1)}),
500))}),50)},_error:function(n){"string"==typeof n&&(n=Error(n));this.onError(n)},_addToFileList:function(){if(this.fileListId){var n="";t.forEach(this.fileList,function(q){n+='\x3ctable id\x3d"file_'+q.name+'" class\x3d"fileToUpload"\x3e\x3ctr\x3e\x3ctd class\x3d"fileToUploadClose"\x3e\x3c/td\x3e\x3ctd class\x3d"fileToUploadName"\x3e'+q.name+'\x3c/td\x3e\x3ctd class\x3d"fileToUploadSize"\x3e'+(q.size?Math.ceil(.001*q.size)+"kb":"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"},this);c.byId(this.fileListId).innerHTML=
n}},_change:function(n){f("ie")&&t.forEach(n,function(q){q.name=q.name.split("\\")[q.name.split("\\").length-1]});this.selectMultipleFiles?this.fileList=this.fileList.concat(n):(this.fileList[0]&&this.removeFile(this.fileList[0].name,!0),this.fileList=n);this._addToFileList();this.onChange(n);this.uploadOnChange?("html"==this.uploaderType&&this._buildFileInput(),this.upload()):"html"==this.uploaderType&&this.selectMultipleFiles&&(this._buildFileInput(),this._connectInput())},_complete:function(n){n=
C.isArray(n)?n:[n];t.forEach(n,function(q){q.ERROR&&this._error(q.ERROR)},this);t.forEach(this.fileList,function(q){q.bytesLoaded=1;q.bytesTotal=1;q.percent=100;this._progress(q)},this);t.forEach(this.fileList,function(q){this.removeFile(q.name,!0)},this);this.onComplete(n);this.fileList=[];this._resetHTML();this.set("disabled",!1);this.restoreProgDisplay&&setTimeout(C.hitch(this,function(){a.set(r.byId(this.progressWidgetId).domNode,"none"==this.restoreProgDisplay?"display":"visibility",this.restoreProgDisplay)}),
500)},_progress:function(n){for(var q=0,H=0,K=0;K<this.fileList.length;K++){var m=this.fileList[K];m.name==n.name&&(m.bytesLoaded=n.bytesLoaded,m.bytesTotal=n.bytesTotal,m.percent=Math.ceil(m.bytesLoaded/m.bytesTotal*100),this.log(m.name,"percent:",m.percent));H+=Math.ceil(.001*m.bytesLoaded);q+=Math.ceil(.001*m.bytesTotal)}n=Math.ceil(H/q*100);this.progressWidgetId&&r.byId(this.progressWidgetId).update({progress:n+"%"});this.showProgress&&this._displayProgress(.01*n);this.onProgress(this.fileList)},
_getDisabledAttr:function(){return this._disabled},_setDisabledAttr:function(n){if(this._disabled!=n){if("flash"==this.uploaderType){if(!this.flashReady){var q=k.connect(this,"onLoad",this,function(){k.disconnect(q);this._setDisabledAttr(n)});return}this._disabled=n;this.flashMovie.doDisable(n)}else this._disabled=n,a.set(this._fileInput,"display",this._disabled?"none":"");p.toggle(this.domNode,this.disabledClass,n)}},_onFlashBlur:function(){this.flashMovie.blur();if(!this.nextFocusObject&&this.tabIndex)for(var n=
d("[tabIndex]"),q=0;q<n.length;q++)if(n[q].tabIndex>=Number(this.tabIndex)+1){this.nextFocusObject=n[q];break}this.nextFocusObject.focus()},_disconnect:function(){t.forEach(this._cons,k.disconnect,dojo)},uploadHTML:function(){this.selectMultipleFiles&&z.destroy(this._fileInput);this._setHtmlPostData();this.showProgress&&this._animateProgress();G.send({url:this.uploadUrl.toString(),form:this._formNode,handleAs:"json",error:C.hitch(this,function(n){this._error("HTML Upload Error:"+n.message)}),load:C.hitch(this,
function(n,q,H){this._complete(n)})})},createHtmlUploader:function(){this._buildForm();this._setFormStyle();this._buildFileInput();this._connectInput();this._styleContent();a.set(this.insideNode,"visibility","visible");this.onReady()},_connectInput:function(){this._disconnect();this._cons.push(k.connect(this._fileInput,"mouseover",this,function(n){p.add(this.domNode,this.hoverClass);this.onMouseOver(n)}));this._cons.push(k.connect(this._fileInput,"mouseout",this,function(n){setTimeout(C.hitch(this,
function(){p.remove(this.domNode,this.activeClass);p.remove(this.domNode,this.hoverClass);this.onMouseOut(n);this._checkHtmlCancel("off")}),0)}));this._cons.push(k.connect(this._fileInput,"mousedown",this,function(n){p.add(this.domNode,this.activeClass);p.remove(this.domNode,this.hoverClass);this.onMouseDown(n)}));this._cons.push(k.connect(this._fileInput,"mouseup",this,function(n){p.remove(this.domNode,this.activeClass);this.onMouseUp(n);this.onClick(n);this._checkHtmlCancel("up")}));this._cons.push(k.connect(this._fileInput,
"change",this,function(){this._checkHtmlCancel("change");var n=this._fileInput.value;n?this._change([{name:n,type:"",size:0}]):this._change([])}));0<=this.tabIndex&&g.set(this.domNode,"tabIndex",this.tabIndex)},_checkHtmlCancel:function(n){"change"==n&&(this.dialogIsOpen=!1);"up"==n&&(this.dialogIsOpen=!0);if("off"==n){if(this.dialogIsOpen)this.onCancel();this.dialogIsOpen=!1}},_styleContent:function(){var n=this.fhtml.nr;a.set(this.insideNode,{width:n.w+"px",height:"middle"==n.va?n.h+"px":"auto",
textAlign:n.ta,paddingTop:n.p[0]+"px",paddingRight:n.p[1]+"px",paddingBottom:n.p[2]+"px",paddingLeft:n.p[3]+"px"});try{a.set(this.insideNode,"lineHeight","inherit")}catch(q){}},_resetHTML:function(){"html"==this.uploaderType&&this._formNode&&(this.fileInputs=[],d("*",this._formNode).forEach(function(n){z.destroy(n)}),this.fileCount=0,this._buildFileInput(),this._connectInput())},_buildForm:function(){this._formNode||(9>f("ie")||f("ie")&&f("quirks")?(this._formNode=document.createElement('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e'),
this._formNode.encoding="multipart/form-data",this._formNode.id=r.getUniqueId("FileUploaderForm"),this.domNode.appendChild(this._formNode)):this._formNode=z.create("form",{enctype:"multipart/form-data",method:"post",id:r.getUniqueId("FileUploaderForm")},this.domNode))},_buildFileInput:function(){this._fileInput&&(this._disconnect(),this._fileInput.id+=this.fileCount,a.set(this._fileInput,"display","none"));this._fileInput=document.createElement("input");this.fileInputs.push(this._fileInput);var n=
this.htmlFieldName;this.selectMultipleFiles&&(n+=this.fileCount,this.fileCount++);g.set(this._fileInput,{id:this.id,name:n,type:"file"});p.add(this._fileInput,"dijitFileInputReal");this._formNode.appendChild(this._fileInput);n=e.getMarginBox(this._fileInput);a.set(this._fileInput,{position:"relative",left:this.fhtml.nr.w-n.w+"px",opacity:0})},_renumberInputs:function(){if(this.selectMultipleFiles){var n;this.fileCount=0;t.forEach(this.fileInputs,function(q){n=this.htmlFieldName+this.fileCount;this.fileCount++;
g.set(q,"name",n)},this)}},_setFormStyle:function(){w.insertCssRule("#"+this._formNode.id+" input","font-size:"+Math.max(2,Math.max(Math.ceil(this.fhtml.nr.w/60),Math.ceil(this.fhtml.nr.h/15)))+"em");a.set(this.domNode,{overflow:"hidden",position:"relative"});a.set(this.insideNode,"position","absolute")},_setHtmlPostData:function(){if(this.postData)for(var n in this.postData)z.create("input",{type:"hidden",name:n,value:this.postData[n]},this._formNode)},uploadFlash:function(){try{if(this.showProgress){this._displayProgress(!0);
var n=k.connect(this,"_complete",this,function(){k.disconnect(n);this._displayProgress(!1)})}var q={},H;for(H in this.postData)q[H]=this.postData[H];this.flashMovie.doUpload(q)}catch(K){this._error("FileUploader - Sorry, the SWF failed to initialize."+K)}},createFlashUploader:function(){if(this.uploadUrl=this.uploadUrl.toString())if(0>this.uploadUrl.toLowerCase().indexOf("http")&&0!=this.uploadUrl.indexOf("/")){var n=window.location.href.split("/");n.pop();n=n.join("/")+"/";this.uploadUrl=n+this.uploadUrl;
this.log("SWF Fixed - Relative loc:",n," abs loc:",this.uploadUrl)}else this.log("SWF URL unmodified:",this.uploadUrl);else console.warn("Warning: no uploadUrl provided.");n={expressInstall:!0,path:this.swfPath.uri||this.swfPath,width:this.fhtml.nr.w,height:this.fhtml.nr.h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName,uploadUrl:this.uploadUrl,uploadOnSelect:this.uploadOnChange,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.selectMultipleFiles,
id:this.id,isDebug:this.isDebug,devMode:this.devMode,flashButton:x.serialize("fh",this.fhtml),fileMask:x.serialize("fm",this.fileMask),noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new y(n,this.insideNode);this.flashObject.onError=C.hitch(function(q){this._error("Flash Error: "+q)});this.flashObject.onReady=C.hitch(this,function(){a.set(this.insideNode,"visibility","visible");
this.log("FileUploader flash object ready");this.onReady(this)});this.flashObject.onLoad=C.hitch(this,function(q){this.flashMovie=q;this.flashReady=!0;this.onLoad(this)});this._connectFlash()},_connectFlash:function(){this._doSub("/filesSelected","_change");this._doSub("/filesUploaded","_complete");this._doSub("/filesProgress","_progress");this._doSub("/filesError","_error");this._doSub("/filesCanceled","onCancel");this._doSub("/stageBlur","_onFlashBlur");this._doSub("/up","onMouseUp");this._doSub("/down",
"onMouseDown");this._doSub("/over","onMouseOver");this._doSub("/out","onMouseOut");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&g.set(this.domNode,"tabIndex",this.tabIndex)},_doSub:function(n,q){this._subs.push(k.subscribe(this.id+n,this,q))},urlencode:function(n){return n&&"none"!=n?n.replace(/:/g,"||").replace(/\./g,"^^").replace("url(","").replace(")","").replace(/'/g,"").replace(/"/g,""):!1},isButton:function(n){n=n.tagName.toLowerCase();
return"button"==n||"input"==n},getTextStyle:function(n){var q={};q.ff=a.get(n,"fontFamily");if(q.ff){q.ff=q.ff.replace(", ",",");q.ff=q.ff.replace(/"|'/g,"");q.ff="sans-serif"==q.ff?"Arial":q.ff;q.fw=a.get(n,"fontWeight");q.fi=a.get(n,"fontStyle");q.fs=parseInt(a.get(n,"fontSize"),10);if(-1<a.get(n,"fontSize").indexOf("%"))for(var H=n;H.tagName;){if(-1==a.get(H,"fontSize").indexOf("%")){q.fs=parseInt(a.get(H,"fontSize"),10);break}"body"==H.tagName.toLowerCase()&&(q.fs=.16*parseInt(a.get(H,"fontSize"),
10));H=H.parentNode}q.fc=(new I(a.get(n,"color"))).toHex();q.fc=parseInt(q.fc.substring(1,Infinity),16)}q.lh=a.get(n,"lineHeight");q.ta=a.get(n,"textAlign");q.ta="start"!=q.ta&&q.ta?q.ta:"left";q.va=this.isButton(n)?"middle":q.lh==q.h?"middle":a.get(n,"verticalAlign");return q},getText:function(n){n=C.trim(n.innerHTML);-1<n.indexOf("\x3c")&&(n=escape(n));return n},getStyle:function(n){var q={},H=e.getContentBox(n),K=e.getPadExtents(n);q.p=[K.t,K.w-K.l,K.h-K.t,K.l];q.w=H.w+K.w;q.h=H.h+K.h;q.d=a.get(n,
"display");H=new I(a.get(n,"backgroundColor"));q.bc=0==H.a?"#ffffff":H.toHex();q.bc=parseInt(q.bc.substring(1,Infinity),16);if(H=this.urlencode(a.get(n,"backgroundImage")))q.bi={url:H,rp:a.get(n,"backgroundRepeat"),pos:escape(a.get(n,"backgroundPosition"))},q.bi.pos||(H=a.get(n,"backgroundPositionX"),K=a.get(n,"backgroundPositionY"),q.bi.pos=escape(("left"==H?"0%":"right"==H?"100%":H)+" "+("top"==K?"0%":"bottom"==K?"100%":K)));return C.mixin(q,this.getTextStyle(n))},getTempNodeStyle:function(n,q,
H){if(H){H=z.place("\x3c"+n.tagName+"\x3e\x3cspan\x3e"+n.innerHTML+"\x3c/span\x3e\x3c/"+n.tagName+"\x3e",n.parentNode);var K=H.firstChild;p.add(K,n.className);p.add(H,q);n=this.getStyle(K)}else H=z.place("\x3c"+n.tagName+"\x3e"+n.innerHTML+"\x3c/"+n.tagName+"\x3e",n.parentNode),p.add(H,n.className),p.add(H,q),H.id=n.id,n=this.getStyle(H);z.destroy(H);return n}})})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(v,A,C,t,k,b,f,d,c,a,e,g,p){C.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");b=p._iframeName;b=b.substring(0,b.lastIndexOf("_"));var z=t.delegate(p,{create:function(){return z._frame=p.create.apply(p,arguments)},get:null,post:null,send:function(l){var h=k._ioSetArgs(l,function(J){E&&E.cancel()},function(J){var F=null;J=J.ioArgs;try{var y=J.handleAs;"xml"===y||"html"===y?F=E.response.data:(F=E.response.text,"json"===y?F=A.fromJson(F):"javascript"===y&&(F=C.eval(F)))}catch(x){F=
x}return F},function(J,F){F.ioArgs._hasError=!0;return J}),r=h.ioArgs,G="GET",I=d.byId(l.form);l.method&&"POST"===l.method.toUpperCase()&&I&&(G="POST");l={method:G,handleAs:"json"===l.handleAs||"javascript"===l.handleAs?"text":l.handleAs,form:l.form,query:I?null:l.content,data:I?l.content:null,timeout:l.timeout,ioArgs:r};l.method&&(l.method=l.method.toUpperCase());if(v.ioPublish&&C.publish&&!1!==r.args.ioPublish)var B=g.after(p,"_notifyStart",function(J){J.options.ioArgs===r&&(B.remove(),k._ioNotifyStart(h))},
!0);var E=p(r.url,l,!0);r._callNext=E._callNext;E.then(function(){h.resolve(h)}).otherwise(function(J){h.ioArgs.error=J;h.reject(J)});return h},_iframeOnload:f.global[b+"_onload"]});t.setObject("dojo.io.iframe",z);return z})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(v,A,C,t,k,b,f,d,c){function a(h){h=v.delegate(g,h);if(!("path"in h))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),
null;"id"in h||(h.id="dojox-embed-flash-"+e++);return h}var e=0,g={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};if(k("ie")){var p=function(h){h=a(h);if(!h)return null;var r,G=h.path;if(h.vars){var I=[];for(r in h.vars)I.push(encodeURIComponent(r)+"\x3d"+encodeURIComponent(h.vars[r]));h.params.FlashVars=I.join("\x26");delete h.vars}G='\x3cobject id\x3d"'+c.escape(String(h.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+
c.escape(String(h.width))+'" height\x3d"'+c.escape(String(h.height))+'"'+(h.style?' style\x3d"'+c.escape(String(h.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+c.escape(String(G))+'" /\x3e';if(h.params)for(r in h.params)G+='\x3cparam name\x3d"'+c.escape(r)+'" value\x3d"'+c.escape(String(h.params[r]))+'" /\x3e';return{id:h.id,markup:G+"\x3c/object\x3e"}};var z=function(){for(var h=10,r=null;!r&&7<h;)try{r=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+h--)}catch(G){}return r?(h=r.GetVariable("$version").split(" ")[1].split(","),
{major:null!=h[0]?parseInt(h[0]):0,minor:null!=h[1]?parseInt(h[1]):0,rev:null!=h[2]?parseInt(h[2]):0}):{major:0,minor:0,rev:0}}();A.addOnWindowUnload(function(){console.warn("***************UNLOAD");var h=function(){};t("object").reverse().style("display","none").forEach(function(r){for(var G in r)if("FlashVars"!=G&&"function"==typeof r[G])try{r[G]=h}catch(I){}})})}else p=function(h){h=a(h);if(!h)return null;var r,G=h.path;if(h.vars){var I=[];for(r in h.vars)I.push(encodeURIComponent(r)+"\x3d"+encodeURIComponent(h.vars[r]));
h.params.flashVars=I.join("\x26");delete h.vars}G='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+c.escape(String(G))+'" id\x3d"'+c.escape(String(h.id))+'" width\x3d"'+c.escape(String(h.width))+'" height\x3d"'+c.escape(String(h.height))+'"'+(h.style?' style\x3d"'+c.escape(String(h.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(h.params)for(r in h.params)G+=" "+c.escape(r)+'\x3d"'+c.escape(String(h.params[r]))+'"';return{id:h.id,markup:G+
" /\x3e"}},z=function(){var h=navigator.plugins["Shockwave Flash"];return h&&h.description?(h=h.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=h[0]?parseInt(h[0]):0,minor:null!=h[1]?parseInt(h[1]):0,rev:null!=h[2]?parseInt(h[2]):0}):{major:0,minor:0,rev:0}}();var l=function(h,r){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=z.major;this.minimumVersion=h.minimumVersion||9;this.domNode=this.movie=this.id=null;r&&(r=b.byId(r));setTimeout(v.hitch(this,function(){if(h.expressInstall||this.available&&this.available>=this.minimumVersion)if(h&&r)this.init(h,r);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};v.extend(l,{onReady:function(h){},onLoad:function(h){},onError:function(h){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(h,r){this.destroy();r=b.byId(r||this.domNode);if(!r)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var G=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;l.initialized&&(this.id=l.place(h,r),this.domNode=r,setTimeout(v.hitch(this,
function(){this.movie=this.byId(this.id,h.doc);this.onReady(this.movie);this._poller=setInterval(v.hitch(this,function(){try{G=this.movie.PercentLoaded()}catch(I){console.warn("this.movie.PercentLoaded() failed",I,this.movie)}if(100==G)this._onload();else if(0==G&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(h){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var h=
v.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),r;for(r in this)h[r]||delete this[r];this._poller?f(this,"Load",this,"_destroy"):this._destroy()}},byId:function(h,r){r=r||document;return r.embeds[h]?r.embeds[h]:r[h]?r[h]:window[h]?window[h]:document[h]?document[h]:null}});v.mixin(l,{minSupported:8,available:z.major,supported:z.major>=z.required,minimumRequired:z.required,version:z,initialized:!1,onInitialize:function(){l.initialized=!0},__ie_markup__:function(h){return p(h)},proxy:function(h,
r){C.forEach(r instanceof Array?r:[r],function(G){this[G]=v.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+G+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+C.map(arguments,function(I){return __flash__toXML(I)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},h)}});l.place=function(h,r){h=p(h);r=b.byId(r);r||(r=d.doc.createElement("div"),r.id=h.id+"-container",d.body().appendChild(r));return h?(r.innerHTML=h.markup,
h.id):null};l.onInitialize();v.setObject("dojox.embed.Flash",l);return l})},"dojox/embed/flashVars":function(){define(["dojo"],function(v){v.deprecated("dojox.embed.flashVars","Will be removed in 2.0","2.0");var A={serialize:function(C,t){var k=function(c){"string"==typeof c&&(c=c.replace(/;/g,"_sc_"),c=c.replace(/\./g,"_pr_"),c=c.replace(/:/g,"_cl_"));return c},b=dojox.embed.flashVars.serialize,f="";if(v.isArray(t)){for(var d=0;d<t.length;d++)f+=b(C+"."+d,k(t[d]))+";";return f.replace(/;{2,}/g,";")}if(v.isObject(t)){for(d in t)f+=
b(C+"."+d,k(t[d]))+";";return f.replace(/;{2,}/g,";")}return C+":"+t}};v.setObject("dojox.embed.flashVars",A);return A})},"dojox/html/styles":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(v,A,C,t){var k=v.getObject("dojox.html",!0),b={},f={},d=[];k.insertCssRule=function(c,a,e){e=k.getDynamicStyleSheet(e);var g=c+" {"+a+"}";console.log("insertRule:",g);t("ie")?(e.cssText+=g,console.log("ss.cssText:",e.cssText)):e.sheet?e.sheet.insertRule(g,
e._indicies.length):e.appendChild(C.doc.createTextNode(g));e._indicies.push(c+" "+a);return c};k.removeCssRule=function(c,a,e){var g=-1,p,z;for(p in b)if(!e||e===p){var l=b[p];for(z=0;z<l._indicies.length;z++)if(c+" "+a===l._indicies[z]){g=z;break}if(-1<g)break}if(!l)return console.warn("No dynamic style sheet has been created from which to remove a rule."),!1;if(-1===g)return console.warn("The css rule was not found and could not be removed."),!1;l._indicies.splice(g,1);t("ie")?l.removeRule(g):l.sheet&&
l.sheet.deleteRule(g);return!0};k.modifyCssRule=function(c,a,e){};k.getStyleSheet=function(c){if(b[c||"default"])return b[c||"default"];if(!c)return!1;var a=k.getStyleSheets();if(a[c])return k.getStyleSheets()[c];for(var e in a)if(a[e].href&&-1<a[e].href.indexOf(c))return a[e];return!1};k.getDynamicStyleSheet=function(c){c||(c="default");b[c]||(C.doc.createStyleSheet?(b[c]=C.doc.createStyleSheet(),9>t("ie")&&(b[c].title=c)):(b[c]=C.doc.createElement("style"),b[c].setAttribute("type","text/css"),C.doc.getElementsByTagName("head")[0].appendChild(b[c]),
console.log(c," ss created: ",b[c].sheet)),b[c]._indicies=[]);return b[c]};k.enableStyleSheet=function(c){if(c=k.getStyleSheet(c))c.sheet?c.sheet.disabled=!1:c.disabled=!1};k.disableStyleSheet=function(c){if(c=k.getStyleSheet(c))c.sheet?c.sheet.disabled=!0:c.disabled=!0};k.activeStyleSheet=function(c){var a=k.getToggledStyleSheets(),e;if(1===arguments.length)A.forEach(a,function(g){g.disabled=g.title===c?!1:!0});else for(e=0;e<a.length;e++)if(!1===a[e].disabled)return a[e];return!0};k.getPreferredStyleSheet=
function(){};k.getToggledStyleSheets=function(){var c;if(!d.length){var a=k.getStyleSheets();for(c in a)a[c].title&&d.push(a[c])}return d};k.getStyleSheets=function(){if(f.collected)return f;A.forEach(C.doc.styleSheets,function(c){var a=c.sheet?c.sheet:c;c=a.title||a.href;if(t("ie"))-1===a.cssText.indexOf("#default#VML")&&(a.href?f[c]=a:a.imports.length?A.forEach(a.imports,function(e){f[e.title||e.href]=e}):f[c]=a);else{f[c]=a;f[c].id=a.ownerNode.id;c=[];try{c=a[a.cssRules?"cssRules":"rules"]}catch(e){console.warn("Reading css rules from stylesheet "+
a.href+" is forbidden due to same-origin policy. See http://www.w3.org/TR/CSP/#cascading-style-sheet-css-parsing",a)}A.forEach(c,function(e){e.href&&(f[e.href]=e.styleSheet,f[e.href].id=a.ownerNode.id)})}});f.collected=!0;return f};return k})},"jimu/dijit/EditorChooseImage":function(){define("dojo dijit dijit/_editor/_Plugin jimu/dijit/ImageChooser dojo/_base/html dojo/_base/lang dojo/i18n dojo/_base/connect dojo/_base/declare".split(" "),function(v,A,C,t,k,b,f){v.experimental("dojox.editor.plugins.ChooseImage");
var d=v.declare("dojox.editor.plugins.ChooseImage",C,{iconClassPrefix:"editorIcon",useDefaultCommand:!1,_initButton:function(){this.createFileInput();this.command="chooseImage";var c=f.getLocalization("dijit._editor","commands");this.button=new A.form.Button({label:c.insertImage,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"UploadImage",tabIndex:"-1",onClick:b.hitch(this,this._chooseImage)});this.button.set("readOnly",!1);this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",
arguments);delete this.command},updateState:function(){var c=this.get("disabled");this.button.set("disabled",this.get("disabled"));!0===c?(k.addClass(this.button,"dijitButtonDisabled"),this.imageChooser.disableChooseImage()):(k.removeClass(this.button,"dijitButtonDisabled"),this.imageChooser.enableChooseImage())},createFileInput:function(){var c=v.create("span",{innerHTML:"."},document.body);this.imageChooser=new t({showSelfImg:!1,cropImage:!1,format:[t.GIF,t.JPEG,t.PNG]},c);this.connect(this.imageChooser,
"onImageChange","insertTempImage")},_chooseImage:function(){k.setStyle(this.imageChooser.domNode,"display","none");this.imageChooser.triggerImgUpload()},onComplete:function(c){c=c[0];var a=v.byId(this.currentImageId,this.editor.document);var e=this.downloadPath?this.downloadPath+c.name:c.file;a.src=e;v.attr(a,"_djrealurl",e);c.width&&(a.width=c.width,a.height=c.height)},insertTempImage:function(c,a){a=a&&a.fileName?'alt\x3d"'+a.fileName+'"':"";this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",
'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+c+'" '+a+"/\x3e")},destroy:function(){this.imageChooser&&this.imageChooser.destroy();this.inherited(arguments)}});v.subscribe(A._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin)switch(c.args.name){case "chooseImage":c.plugin=new d({url:c.args.url})}});C.registry.chooseImage=function(c){return new d(c)};return d})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(v,A,C,t,k,b){A.experimental("dijit.editor.plugins.EditorTextColor");var f=t("dijit.editor.plugins.EditorTextColor",k,{buttonClass:b,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";this.hackCommand="foreColor";this.inherited(arguments);var d="",c=!1;this.params.custom&&(this.params.custom.recordUID&&(d=this.params.custom.recordUID),this.params.custom.forceAttr&&(c=this.params.custom.forceAttr));var a=this;this.button.set("iconClass",
this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(e){function g(p){a.button.dropDown=new p({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,value:a.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:d,onChange:function(z){a.editor.execCommand("useCSS",c);a.editor.execCommand("styleWithCSS",!c);a.editor.execCommand(a.hackCommand,
z)},onClose:function(){a.button.closeDropDown()}});e()}"string"===typeof a.colorPicker?v([a.colorPicker],g):g(a.colorPicker)}},updateState:function(){var d=this.editor,c=this.hackCommand;if(d&&d.isLoaded&&c.length){if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{var e=d.queryCommandValue(c)||""}catch(g){e=""}}""===e?e="#000000":"transparent"===e&&(e="rgba(0, 0, 0, 0)");this.value=e;(d=this.button.dropDown)&&d.getColor&&e!==d.getColor()&&(d.refreshRecords(),
d.setColor(e))}}});A.subscribe(C._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin)switch(d.args.name){case "editorTextColor":d.plugin=new f}});return f})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(v,A,C,t,k,b){A.experimental("dijit.editor.plugins.EditorBackgroundColor");var f=t("dijit.editor.plugins.EditorBackgroundColor",k,{buttonClass:b,colorPicker:"jimu/dijit/ColorPalette",
useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var d="";this.params.custom&&this.params.custom.recordUID&&(d=this.params.custom.recordUID);var c=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(a){function e(g){c.button.dropDown=new g({dir:c.editor.dir,ownerDocument:c.editor.ownerDocument,
value:c.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:d,onChange:function(p){c.editor.execCommand("useCSS",!1);c.editor.execCommand("styleWithCSS",!0);c.editor.execCommand(c.hackCommand,p)},onExecute:function(){c.editor.execCommand(c.hackCommand,this.get("value"))},onClose:function(){c.button.closeDropDown()}});a()}"string"===typeof c.colorPicker?v([c.colorPicker],e):e(c.colorPicker)}},updateState:function(){var d=
this.editor,c=this.hackCommand;if(d&&d.isLoaded&&c.length){if(this.button){var a=this.get("disabled");this.button.set("disabled",a);if(a)return;try{var e=d.queryCommandValue(c)||""}catch(g){e=""}}""===e?e="#000000":"transparent"===e&&(e="rgba(0, 0, 0, 0)");this.value=e;(d=this.button.dropDown)&&d.getColor&&e!==d.getColor()&&(d.refreshRecords(),d.setColor(e))}}});A.subscribe(C._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin)switch(d.args.name){case "editorBackgroundColor":d.plugin=new f}});
return f})},"widgets/BusinessAnalyst/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/templates/SelectableTreeGrid.html":'\x3cdiv class\x3d"esriMapsAnalystXNonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"gridContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"selectionCounter" class\x3d"esriMapsAnalystXSelectableTreeCounter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/setting/Setting.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"reportInfographicTabContainer" style\x3d"width: 100%; height: 520px;"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"homeContentPane" title\x3d"${nls.home}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n                \x3cdiv class\x3d"editor-container" data-dojo-attach-point\x3d"editorContainer"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"editor"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n                    \x3cdiv style\x3d"float: left;"\x3e${nls.options}\x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"searchTextBoxOption"\r\n                            data-dojo-attach-point\x3d"searchTextBoxOption"\x3e\r\n                        \x3clabel for\x3d"searchTextBoxOption"\x3e${nls.searchTextBox}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"dropPinOption"\r\n                            data-dojo-attach-point\x3d"dropPinOption"\x3e\r\n                        \x3clabel for\x3d"dropPinOption"\x3e${nls.dropPin}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"drawPolygonOption"\r\n                            data-dojo-attach-point\x3d"drawPolygonOption"\x3e\r\n                        \x3clabel for\x3d"drawPolygonOption"\x3e${nls.drawPolygon}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"drawFreehandPolygonOption"\r\n                            data-dojo-attach-point\x3d"drawFreehandPolygonOption"\x3e\r\n                        \x3clabel for\x3d"drawFreehandPolygonOption"\x3e${nls.drawFreehandPolygon}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"infographicsContentPane" title\x3d"${nls.infographics}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledInfographicsOption"\r\n                        data-dojo-attach-point\x3d"disabledInfographicsOption"\x3e\r\n                    \x3clabel for\x3d"disabledInfographicsOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cdiv style\x3d"float: left;"\x3e${nls.exportOptions}\x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportPrintOption"\r\n                            data-dojo-attach-point\x3d"exportPrintOption"\x3e\r\n                        \x3clabel for\x3d"exportPrintOption"\x3e${nls.print}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportImageOption"\r\n                            data-dojo-attach-point\x3d"exportImageOption"\x3e\r\n                        \x3clabel for\x3d"exportImageOption"\x3e${nls.image}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportPDFOption"\r\n                            data-dojo-attach-point\x3d"exportPDFOption"\x3e\r\n                        \x3clabel for\x3d"exportPDFOption"\x3e${nls.pdf}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"float: left; margin-left: 15px;"\x3e\r\n                        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"exportDynamicHTMLOption"\r\n                            data-dojo-attach-point\x3d"exportDynamicHTMLOption"\x3e\r\n                        \x3clabel for\x3d"exportDynamicHTMLOption"\x3e${nls.dynamicHTML}\x3c/label\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cspan style\x3d"float: left; margin-top: 3px;"\x3e${nls.selectCountryOrRegion}\x3c/span\x3e\r\n                \x3cdiv style\x3d"float:left; margin-left: 5px;" data-dojo-attach-point\x3d"countryDropDownContainerInfographics"\x3e\x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"infographicTreeGridContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"reportsContentPane" title\x3d"${nls.reports}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledReportsOption"\r\n                        data-dojo-attach-point\x3d"disabledReportsOption"\x3e\r\n                    \x3clabel for\x3d"disabledReportsOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cspan style\x3d"float: left; margin-top: 3px;"\x3e${nls.selectCountryOrRegion}\x3c/span\x3e\r\n                \x3cdiv style\x3d"float:left; margin-left: 5px;" data-dojo-attach-point\x3d"countryDropDownContainerReports"\x3e\x3c/div\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                \x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"reportTreeGridContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"ringsContentPane" title\x3d"${nls.rings}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cspan\x3e${nls.defaultValues}\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                ${nls.radius}\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 1"\r\n                    data-dojo-attach-point\x3d"ringsBufferRadii1"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 3"\r\n                    data-dojo-attach-point\x3d"ringsBufferRadii2"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 5"\r\n                    data-dojo-attach-point\x3d"ringsBufferRadii3"\x3e\x3c/div\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ringsBufferUnits"\x3e\r\n                    \x3coption value\x3d"esriMiles" selected\x3d"selected"\x3e${nls.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"ringValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n                \x3cbr /\x3e\r\n                \x3cbr /\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledRingsOption"\r\n                        data-dojo-attach-point\x3d"disabledRingsOption"\x3e\r\n                    \x3clabel for\x3d"disabledRingsOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"driveTimeContentPane" title\x3d"${nls.driveTime}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cspan\x3e${nls.defaultValues}\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                ${nls.time}\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 5"\r\n                    data-dojo-attach-point\x3d"driveTimeBufferRadii1"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 10"\r\n                    data-dojo-attach-point\x3d"driveTimeBufferRadii2"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 15"\r\n                    data-dojo-attach-point\x3d"driveTimeBufferRadii3"\x3e\x3c/div\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"driveTimeBufferUnits"\x3e\r\n                    \x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"driveTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n                \x3cbr /\x3e\r\n                \x3cbr /\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"disabledDriveTimeOption"\r\n                        id\x3d"disabledDriveTimeOption"\x3e\r\n                    \x3clabel for\x3d"disabledDriveTimeOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"walkTimeContentPane" title\x3d"${nls.walkTime}"\x3e\r\n            \x3cdiv style\x3d"margin-top: 15px; margin-left: 15px;"\x3e\r\n                \x3cspan\x3e${nls.defaultValues}\x3c/span\x3e\r\n                \x3cbr\x3e\r\n                \x3cbr\x3e\r\n                ${nls.time}\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 5"\r\n                    data-dojo-attach-point\x3d"walkTimeBufferRadii1"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 10"\r\n                    data-dojo-attach-point\x3d"walkTimeBufferRadii2"\x3e\x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 50px;" data-dojo-props\x3d"value: 15"\r\n                    data-dojo-attach-point\x3d"walkTimeBufferRadii3"\x3e\x3c/div\x3e\r\n                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"walkTimeBufferUnits"\x3e\r\n                    \x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n                    \x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n                \x3c/select\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"walkTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n                \x3cbr /\x3e\r\n                \x3cbr /\x3e\r\n                \x3cdiv style\x3d"margin-top: 10px"\x3e\r\n                    \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" id\x3d"disabledWalkTimeOption"\r\n                        data-dojo-attach-point\x3d"disabledWalkTimeOption"\x3e\r\n                    \x3clabel for\x3d"disabledWalkTimeOption"\x3e${nls.disable}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/setting/css/style.css":'.widget-setting-page .esriMapsAnalystXSelectableTreeGrid.dgrid {position: absolute; top: 33px; right: 0; left: -8px; bottom: 0; height: auto; width: auto;}.jimu-widget-business-analyst-setting .tabs {font-family: "Avenir Light"; color: #000000; height: 100%;} .jimu-widget-business-analyst-setting .tabs .tab-description {margin: 10px 0;} .jimu-widget-business-analyst-setting .jimu-tab\x3e.control\x3e.tab{background-color: #fff; border-top: 0; border-left: 0; border-right: 0; border-bottom: 1px solid #dedede; color:#898989; font-family: "Avenir Medium"; font-size: 14px;} .jimu-widget-business-analyst-setting .jimu-tab\x3e.control\x3e.tab.jimu-state-selected {border-bottom: 3px solid #24b5cc; font-family: "Avenir Heavy"; color: #000000;} .jimu-widget-business-analyst-setting .tabs .titles {font-weight: bold; font-family: "Avenir Medium"; font-size: 14px; margin: 20px 0 10px 0;} .jimu-widget-business-analyst-setting .tabs .hide{display: none;} .jimu-widget-business-analyst-setting .tabs .indent{margin-left: 20px; margin-top: 10px;} .jimu-widget-business-analyst-setting .tabs .unit-item{margin: 15px 5px 5px 5px; line-height: 18px; height: 18px; vertical-align: middle;} .jimu-widget-business-analyst-setting .tabs .clearFix {*overflow: hidden; *zoom: 1;} .jimu-widget-business-analyst-setting .tabs .clearFix:after {display: table; content: ""; width: 0; clear: both;} .jimu-widget-business-analyst-setting .tabs .view{height: 100%; overflow-y: auto;} .jimu-widget-business-analyst-setting .tabs .jimu-tab\x3e.jimu-viewstack{padding-bottom: 30px;} .jimu-widget-business-analyst-setting .validationErrorMessage {color: #FF0000; margin-top: 10px;} .jimu-widget-business-analyst-setting .validationErrorMessage.hidden {display: none;} .jimu-widget-business-analyst-setting .invalidValue {outline: 3px solid #FF0000;} .jimu-widget-business-analyst-setting .makeDefaultLink {cursor: pointer!important; color: #0079c1;} .jimu-widget-business-analyst-setting .makeDefaultLink:hover {text-decoration: underline; text-decoration-color: #0079c1;} .jimu-widget-business-analyst-setting .esriMapsAnalystXSelectableTreeLabel.default {color: #0079c1;} .jimu-widget-business-analyst-setting .editor-container {height: 325px;} .jimu-widget-business-analyst-setting .dijitEditorIFrameContainer {height: 262px;}',
"*now":function(v){v(['dojo/i18n!*preload*widgets/BusinessAnalyst/setting/nls/Setting*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/array dojo/_base/declare dojo/_base/html dojo/dom-class dojo/dom-construct dojo/dom-style dojo/mouse dojo/on dojo/query dojo/sniff jimu/BaseWidgetSetting jimu/utils dijit/_WidgetsInTemplateMixin dijit/Editor esri/dijit/geoenrichment/SelectableTree ../esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid ../utils/GEUtil ../utils/ReportUtil ../utils/ValidationUtil jimu/dijit/formSelect jimu/dijit/TabContainer jimu/dijit/EditorXssFilter dojo/NodeList-manipulate dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/ViewSource dijit/_editor/plugins/FontChoice dojox/editor/plugins/Preview dijit/_editor/plugins/TextColor dojox/editor/plugins/ToolbarLineBreak dijit/ToolbarSeparator dojox/editor/plugins/FindReplace dojox/editor/plugins/PasteFromWord dojox/editor/plugins/InsertAnchor dojox/editor/plugins/Blockquote dojox/editor/plugins/UploadImage jimu/dijit/EditorChooseImage jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor dijit/form/CheckBox dijit/layout/ContentPane".split(" "),function(v,
A,C,t,k,b,f,d,c,a,e,g,p,z,l,h,r,G,I,B,E,J){return A([e,p],{baseClass:"jimu-widget-business-analyst-setting",selectedCountryID:"",currentDefaultInfographicID:"",currentDefaultInfographicDiv:null,currentDefaultReportID:"",currentDefaultReportDiv:null,postCreate:function(){this.inherited(arguments);this.tab=new E({tabs:[{title:this.nls.home,content:this.homeContentPane},{title:this.nls.infographics,content:this.infographicsContentPane},{title:this.nls.reports,content:this.reportsContentPane},{title:this.nls.rings,
content:this.ringsContentPane},{title:this.nls.driveTime,content:this.driveTimeContentPane},{title:this.nls.walkTime,content:this.walkTimeContentPane}],selected:this.nls.home});this.tab.placeAt(this.reportInfographicTabContainer);this.tab.startup();this.editorXssFilter=J.getInstance()},startup:function(){this._started||(this.inherited(arguments),this.initEditor(),this.setConfig(this.config))},initEditor:function(){var F=document.getElementsByTagName("head")[0],y=window.apiUrl+"dojox/editor/plugins/resources/css/TextColor.css";
c('link[href\x3d"'+y+'"]',F)[0]||g.loadStyleLink("editor_plugins_resources_TextColor",y);y=window.apiUrl+"dojox/editor/plugins/resources/editorPlugins.css";c('link[href\x3d"'+y+'"]',F)[0]||g.loadStyleLink("editor_plugins_resources_editorPlugins",y);y=window.apiUrl+"dojox/editor/plugins/resources/css/PasteFromWord.css";c('link[href\x3d"'+y+'"]',F)[0]||g.loadStyleLink("editor_plugins_resources_PasteFromWord",y);this.editor=new z({plugins:["bold","italic","underline",g.getEditorTextColor("about"),g.getEditorBackgroundColor("about"),
"|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent"],extraPlugins:["|","createLink","unlink","pastefromword","|","undo","redo","|","chooseImage","|","viewsource","toolbarlinebreak",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize","formatBlock"],style:"font-family:Verdana;"},this.editor);C.setStyle(this.editor.domNode,
{width:"100%",height:"100%"});this.editor.startup();8!==a("ie")&&this.editor.resize({w:"100%",h:"100%"})},setConfig:function(F){var y=this;this.initializeNewConfigValues(F);r.getAvailableCountries().then(function(x){var w=[];v.forEach(x.countries,function(n){w.push({label:n.name,value:n.id,selected:n.id==y.config.defaultCountryID?"selected":""})});y.countryDropDownInfographics=(new B({options:w})).placeAt(y.countryDropDownContainerInfographics);y.countryDropDownInfographics.startup();y.selectedCountryID=
y.countryDropDownInfographics.get("value");d(y.countryDropDownInfographics,"change",function(){y._countryChangeInfographics()});y.countryDropDownReports=(new B({options:w})).placeAt(y.countryDropDownContainerReports);y.countryDropDownReports.startup();y.selectedCountryID=y.countryDropDownReports.get("value");d(y.countryDropDownReports,"change",function(){y._countryChangeReports()});y._loadConfigForCountry(y.selectedCountryID)});this._loadRingDTWTConfig();this._loadInfographicExportOptions();this._loadFirstPageOptions();
F=this.editorXssFilter.sanitize(F.firstPageText||this.nls.defaultFirstPageText);this.editor.set("value",F)},getConfig:function(){if(!this._validateRingDTWT())return!1;this._setConfigForCountry(this.selectedCountryID);this._setRingDTWTConfig();this._setInfographicExportOptions();this._setFirstPageOptions();this.config.defaultCountryID=this.selectedCountryID;this.config.firstPageText=this.editor.get("value");return this.config},_countryChangeInfographics:function(){this.countryDropDownReports.get("value")!=
this.countryDropDownInfographics.get("value")&&(this.countryDropDownReports.set("value",this.countryDropDownInfographics.get("value")),this._countryChange())},_countryChangeReports:function(){this.countryDropDownInfographics.get("value")!=this.countryDropDownReports.get("value")&&(this.countryDropDownInfographics.set("value",this.countryDropDownReports.get("value")),this._countryChange())},_countryChange:function(){this._setConfigForCountry(this.selectedCountryID);this.selectedCountryID=this.countryDropDownInfographics.get("value");
this._loadConfigForCountry(this.selectedCountryID)},_setConfigForCountry:function(F){var y=null;v.forEach(this.config.countryConfig,function(w){w.countryID==F&&(y=w)});y||(y={countryID:F,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],
enabledEsriInfographics:[],enabledOrgInfographics:[]});y.allowEsriInfographics=0<this.infographicsTreeGrid.tree.data[0].leafCount?0!=this.infographicsTreeGrid.tree.data[0].selectCount:!0;y.allowMyInfographics=0<this.infographicsTreeGrid.tree.data[1].leafCount?0!=this.infographicsTreeGrid.tree.data[1].selectCount:!0;y.allowSharedInfographics=0<this.infographicsTreeGrid.tree.data[2].leafCount?0!=this.infographicsTreeGrid.tree.data[2].selectCount:!0;y.allowAllEsriInfographics=this.infographicsTreeGrid.tree.data[0].leafCount===
this.infographicsTreeGrid.tree.data[0].selectCount;y.allowAllOrgInfographics=this.infographicsTreeGrid.tree.data[1].leafCount===this.infographicsTreeGrid.tree.data[1].selectCount&&this.infographicsTreeGrid.tree.data[2].leafCount===this.infographicsTreeGrid.tree.data[2].selectCount;y.allowAllEsriInfographics||(y.enabledEsriInfographics=this._getEnabledReports(this.infographicsTreeGrid.tree.data[0].children));y.allowAllOrgInfographics||(y.enabledOrgInfographics=this._getEnabledReports(this.infographicsTreeGrid.tree.data[1].children.concat(this.infographicsTreeGrid.tree.data[2].children)));
y.defaultInfographicID=this.currentDefaultInfographicID;y.allowEsriReports=0<this.reportsTreeGrid.tree.data[0].leafCount?0!=this.reportsTreeGrid.tree.data[0].selectCount:!0;y.allowMyReports=0<this.reportsTreeGrid.tree.data[1].leafCount?0!=this.reportsTreeGrid.tree.data[1].selectCount:!0;y.allowSharedReports=0<this.reportsTreeGrid.tree.data[2].leafCount?0!=this.reportsTreeGrid.tree.data[2].selectCount:!0;y.allowAllEsriReports=this.reportsTreeGrid.tree.data[0].leafCount===this.reportsTreeGrid.tree.data[0].selectCount;
y.allowAllOrgReports=this.reportsTreeGrid.tree.data[1].leafCount===this.reportsTreeGrid.tree.data[1].selectCount&&this.reportsTreeGrid.tree.data[2].leafCount===this.reportsTreeGrid.tree.data[2].selectCount;y.allowAllEsriReports||(y.enabledEsriReports=this._getEnabledReports(this.reportsTreeGrid.tree.data[0].children));y.allowAllOrgReports||(y.enabledOrgReports=this._getEnabledReports(this.reportsTreeGrid.tree.data[1].children.concat(this.reportsTreeGrid.tree.data[2].children)));y.defaultReportID=
this.currentDefaultReportID;var x=-1;v.forEach(this.config.countryConfig,function(w,n){w.countryID==F&&(x=n)});-1!=x?this.config.countryConfig[x]=y:this.config.countryConfig.push(y)},_loadConfigForCountry:function(F){var y=this;G.getAvailableInfographicReports(F).then(function(x){v.forEach(x,function(n){v.forEach(n.children,function(q){q.selected=!0})});y.infographicsTreeGrid||(y.infographicsTreeGrid=new h({tree:new l(x),showHeader:!1,_renderLabelNode:function(n,q){var H=k.create("div"),K=k.create("div",
{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(n),style:"float: left"},H);if(1===n.deepness){n.value===y.currentDefaultInfographicID&&(t.add(K,"default"),y.currentDefaultInfographicDiv=K);var m=k.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",innerHTML:y.nls.makeDefault,style:"margin-left: 10px; display: none"},H),u=k.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",innerHTML:y.nls.removeDefault,style:"margin-left: 10px; display: none"},
H);n.makeDefaultDiv=m;n.unselectDefaultDiv=u;d(m,"click",function(D){D.stopPropagation();y.currentDefaultInfographicDiv&&t.remove(y.currentDefaultInfographicDiv,"default");t.add(K,"default");y.currentDefaultInfographicID=n.value;y.currentDefaultInfographicDiv=K;b.set(m,"display","none");b.set(u,"display","")});d(u,"click",function(D){D.stopPropagation();y.currentDefaultInfographicDiv&&t.remove(y.currentDefaultInfographicDiv,"default");y.currentDefaultInfographicID="";y.currentDefaultInfographicDiv=
null;b.set(u,"display","none");b.set(m,"display","")});d(q,f.enter,function(){n.selected&&(n.value!==y.currentDefaultInfographicID?b.set(m,"display",""):b.set(u,"display",""))});d(q,f.leave,function(){b.set(m,"display","none");b.set(u,"display","none")})}return H}},y.infographicTreeGridContainer));y.own(d(y.infographicsTreeGrid,"SelectionChanged",function(n){n.toggledTreeNode&&0==n.toggledTreeNode.deepness?n.toggledTreeNode.selected||v.forEach(n.toggledTreeNode.children,function(q){q.value===y.currentDefaultInfographicID&&
y.currentDefaultInfographicDiv&&(t.remove(y.currentDefaultInfographicDiv,"default"),y.currentDefaultInfographicID="",y.currentDefaultInfographicDiv=null)}):n.toggledTreeNode&&!n.toggledTreeNode.selected&&n.toggledTreeNode.value===y.currentDefaultInfographicID?y.currentDefaultInfographicDiv&&(t.remove(y.currentDefaultInfographicDiv,"default"),y.currentDefaultInfographicID="",y.currentDefaultInfographicDiv=null,b.set(n.toggledTreeNode.makeDefaultDiv,"display","none"),b.set(n.toggledTreeNode.unselectDefaultDiv,
"display","none")):n.toggledTreeNode&&!n.toggledTreeNode.selected?b.set(n.toggledTreeNode.makeDefaultDiv,"display","none"):n.toggledTreeNode&&n.toggledTreeNode.selected&&b.set(n.toggledTreeNode.makeDefaultDiv,"display","")}));var w=-1;v.forEach(y.config.countryConfig,function(n,q){n.countryID==F&&(w=q)});y.currentDefaultInfographicID="";y.currentDefaultReportID="";-1!=w&&(y.currentDefaultInfographicID=y.config.countryConfig[w].defaultInfographicID,y.currentDefaultReportID=y.config.countryConfig[w].defaultReportID,
y.config.countryConfig[w].allowAllEsriInfographics||v.forEach(x[0].children,function(n){v.some(y.config.countryConfig[w].enabledEsriInfographics,function(q){return n.value===q})||(n.selected=!1)}),y.config.countryConfig[w].allowAllOrgInfographics||v.forEach(x[1].children.concat(x[2].children),function(n){v.some(y.config.countryConfig[w].enabledOrgInfographics,function(q){return n.value===q})||(n.selected=!1)}));y.infographicsTreeGrid.tree.clear();y.infographicsTreeGrid.tree.addNodes(x)});G.getAvailableClassicReports(F).then(function(x){v.forEach(x,
function(n){v.forEach(n.children,function(q){q.selected=!0})});y.reportsTreeGrid||(y.reportsTreeGrid=new h({tree:new l(x),showHeader:!1,_renderLabelNode:function(n,q){var H=k.create("div"),K=k.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(n),style:"float: left"},H);if(1===n.deepness){n.value===y.currentDefaultReportID&&(t.add(K,"default"),y.currentDefaultReportDiv=K);var m=k.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",
innerHTML:y.nls.makeDefault,style:"margin-left: 10px; display: none"},H),u=k.create("span",{class:"esriMapsAnalystXSelectableTreeLabel makeDefaultLink",innerHTML:y.nls.removeDefault,style:"margin-left: 10px; display: none"},H);n.makeDefaultDiv=m;n.unselectDefaultDiv=u;d(m,"click",function(D){D.stopPropagation();y.currentDefaultReportDiv&&t.remove(y.currentDefaultReportDiv,"default");t.add(K,"default");y.currentDefaultReportID=n.value;y.currentDefaultReportDiv=K;b.set(m,"display","none");b.set(u,"display",
"")});d(u,"click",function(D){D.stopPropagation();y.currentDefaultReportDiv&&t.remove(y.currentDefaultReportDiv,"default");y.currentDefaultReportID="";y.currentDefaultReportDiv=null;b.set(u,"display","none");b.set(m,"display","")});d(q,f.enter,function(){n.selected&&(n.value!==y.currentDefaultReportID?b.set(m,"display",""):b.set(u,"display",""))});d(q,f.leave,function(){b.set(m,"display","none");b.set(u,"display","none")})}return H}},y.reportTreeGridContainer));y.own(d(y.reportsTreeGrid,"SelectionChanged",
function(n){n.toggledTreeNode&&0==n.toggledTreeNode.deepness?n.toggledTreeNode.selected||v.forEach(n.toggledTreeNode.children,function(q){q.value===y.currentDefaultReportID&&y.currentDefaultReportDiv&&(t.remove(y.currentDefaultReportDiv,"default"),y.currentDefaultReportID="",y.currentDefaultReportDiv=null)}):n.toggledTreeNode&&!n.toggledTreeNode.selected&&n.toggledTreeNode.value===y.currentDefaultReportID?y.currentDefaultReportDiv&&(t.remove(y.currentDefaultReportDiv,"default"),y.currentDefaultReportID=
"",y.currentDefaultReportDiv=null,b.set(n.toggledTreeNode.makeDefaultDiv,"display","none"),b.set(n.toggledTreeNode.unselectDefaultDiv,"display","none")):n.toggledTreeNode&&!n.toggledTreeNode.selected?b.set(n.toggledTreeNode.makeDefaultDiv,"display","none"):n.toggledTreeNode&&n.toggledTreeNode.selected&&b.set(n.toggledTreeNode.makeDefaultDiv,"display","")}));var w=-1;v.forEach(y.config.countryConfig,function(n,q){n.countryID==F&&(w=q)});-1!=w&&(y.config.countryConfig[w].allowAllEsriReports||v.forEach(x[0].children,
function(n){v.some(y.config.countryConfig[w].enabledEsriReports,function(q){return n.value===q})||(n.selected=!1)}),y.config.countryConfig[w].allowAllOrgReports||v.forEach(x[1].children.concat(x[2].children),function(n){v.some(y.config.countryConfig[w].enabledOrgReports,function(q){return n.value===q})||(n.selected=!1)}));y.reportsTreeGrid.tree.clear();y.reportsTreeGrid.tree.addNodes(x)})},_getClassicReportId:function(F){return F.value&&F.value.itemid?F.value.itemid:F.value},_getEnabledReports:function(F){var y=
[];v.forEach(F,function(x){x.selected&&(x.value&&x.value.itemid?y.push(x.value.itemid):y.push(x.value))});return y},_setRingDTWTConfig:function(){this.config.ringDefaults=this._getRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3);this.config.driveTimeDefaults=this._getRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3);this.config.walkTimeDefaults=this._getRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3);
this.config.ringUnitDefault=this.ringsBufferUnits.get("value");this.config.driveTimeUnitDefault=this.driveTimeBufferUnits.get("value");this.config.walkTimeUnitDefault=this.walkTimeBufferUnits.get("value");this.config.ringDisabled=this.disabledRingsOption.checked;this.config.driveTimeDisabled=this.disabledDriveTimeOption.checked;this.config.walkTimeDisabled=this.disabledWalkTimeOption.checked;this.config.infographicsDisabled=this.disabledInfographicsOption.checked;this.config.reportsDisabled=this.disabledReportsOption.checked},
_loadRingDTWTConfig:function(){this._setRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,this.config.ringDefaults);this.ringsBufferUnits.set("value",this.config.ringUnitDefault);this.disabledRingsOption.setChecked(this.config.ringDisabled);this._setRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.config.driveTimeDefaults);this.driveTimeBufferUnits.set("value",this.config.driveTimeUnitDefault);this.disabledDriveTimeOption.setChecked(this.config.driveTimeDisabled);
this._setRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.config.walkTimeDefaults);this.walkTimeBufferUnits.set("value",this.config.walkTimeUnitDefault);this.disabledWalkTimeOption.setChecked(this.config.walkTimeDisabled);this.disabledInfographicsOption.setChecked(this.config.infographicsDisabled);this.disabledReportsOption.setChecked(this.config.reportsDisabled)},_setInfographicExportOptions:function(){this.config.exportInfographicsPrintOption=this.exportPrintOption.checked;
this.config.exportInfographicsImageOption=this.exportImageOption.checked;this.config.exportInfographicsPDFOption=this.exportPDFOption.checked;this.config.exportInfographicsDynamicHTMLOption=this.exportDynamicHTMLOption.checked},_loadInfographicExportOptions:function(){this.exportPrintOption.setChecked(this.config.exportInfographicsPrintOption);this.exportImageOption.setChecked(this.config.exportInfographicsImageOption);this.exportPDFOption.setChecked(this.config.exportInfographicsPDFOption);this.exportDynamicHTMLOption.setChecked(this.config.exportInfographicsDynamicHTMLOption)},
_setFirstPageOptions:function(){this.config.searchTextBoxOption=this.searchTextBoxOption.checked;this.config.dropPinOption=this.dropPinOption.checked;this.config.drawPolygonOption=this.drawPolygonOption.checked;this.config.drawFreehandPolygonOption=this.drawFreehandPolygonOption.checked},_loadFirstPageOptions:function(){this.searchTextBoxOption.setChecked(this.config.searchTextBoxOption);this.dropPinOption.setChecked(this.config.dropPinOption);this.drawPolygonOption.setChecked(this.config.drawPolygonOption);
this.drawFreehandPolygonOption.setChecked(this.config.drawFreehandPolygonOption)},_getRadii:function(F,y,x){F=F.get("value");y=y.get("value");x=x.get("value");var w=[];""!=F&&w.push(F);""!=y&&w.push(y);""!=x&&w.push(x);return w},_setRadii:function(F,y,x,w){0<w.length?F.set("value",w[0]):F.set("value","");1<w.length?y.set("value",w[1]):y.set("value","");2<w.length?x.set("value",w[2]):x.set("value","")},_validateRingDTWT:function(){var F=!0,y=!0,x=!1;y=F=I.validateInvalidValues(this.ringsBufferRadii1,
this.ringsBufferRadii2,this.ringsBufferRadii3,this.ringValidationErrorMessage,this.nls.thisEntryIsNotValid);F||(this.tab.selectTab(this.nls.rings),x=!0);F=I.validateInvalidValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.driveTimeValidationErrorMessage,this.nls.thisEntryIsNotValid);y=y&&F;F||x||(this.tab.selectTab(this.nls.driveTime),x=!0);F=I.validateInvalidValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.walkTimeValidationErrorMessage,
this.nls.thisEntryIsNotValid);y=y&&F;F||x||(this.tab.selectTab(this.nls.walkTime),x=!0);if(!y)return y;tabChange=!1;y=F=I.validateMinMaxValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,I.MIN_RINGS_VALUE,I.MAX_RINGS_VALUE,this.ringValidationErrorMessage,this.nls.invalidValueRing);F||(this.tab.selectTab(this.nls.rings),x=!0);F=I.validateMinMaxValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,I.MIN_DTWT_VALUE,I.MAX_DTWT_VALUE,this.driveTimeValidationErrorMessage,
this.nls.invalidValueDTWT);y=y&&F;F||x||(this.tab.selectTab(this.nls.driveTime),x=!0);F=I.validateMinMaxValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,I.MIN_DTWT_VALUE,I.MAX_DTWT_VALUE,this.walkTimeValidationErrorMessage,this.nls.invalidValueDTWT);y=y&&F;F||x||(this.tab.selectTab(this.nls.walkTime),x=!0);return y},initializeNewConfigValues:function(F){"undefined"===typeof F.exportInfographicsPrintOption&&(F.exportInfographicsPrintOption=!0);"undefined"===typeof F.exportInfographicsImageOption&&
(F.exportInfographicsImageOption=!0);"undefined"===typeof F.exportInfographicsPDFOption&&(F.exportInfographicsPDFOption=!0);"undefined"===typeof F.exportInfographicsDynamicHTMLOption&&(F.exportInfographicsDynamicHTMLOption=!0);"undefined"===typeof F.firstPageText&&(F.firstPageText=this.nls.defaultFirstPageText);"undefined"===typeof F.searchTextBoxOption&&(F.searchTextBoxOption=!0);"undefined"===typeof F.dropPinOption&&(F.dropPinOption=!0);"undefined"===typeof F.drawPolygonOption&&(F.drawPolygonOption=
!0);"undefined"===typeof F.drawFreehandPolygonOption&&(F.drawFreehandPolygonOption=!0)}})});