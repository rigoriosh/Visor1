// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.

//>>built
/*
 Chen, Yi-Cyuan 2015-2017
 @license MIT
 Cropper.js v1.5.1
 https://fengyuanchen.github.io/cropperjs

 Copyright 2015-present Chen Fengyuan
 Released under the MIT license

 Date: 2019-03-10T09:55:53.729Z
 inherited ||
        // if it is inherited, we need to check to make sure there isn't an existing property */
require({
        cache: {
                "jimu/ConfigManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/Deferred dojo/on ./utils ./WidgetManager ./shared/AppVersionManager ./ConfigLoader ./tokenUtils ./dijit/AGOLLoading ./portalUrlUtils ./portalUtils esri/config esri/tasks/GeometryService".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                function h(t, u) {
                                        var z = q.clone(t), x = l.widgetProperties; "undefined" === typeof u && (u = !1); delete z.mode; delete z.configWabVersion;
                                        l.visitElement(z, function (y, D) {
                                                y.widgets ? (delete y.isOnScreen, delete y.gid, "jimu.js/images/group_icon.png" === y.icon && delete y.icon, delete y.openType, D.isOnScreen && y.panel && l.isEqual(y.panel, z.widgetOnScreen.panel) && delete y.panel) : (D = y.folderUrl + "images/icon.png?wab_dv\x3d" + window.deployVersion, y.icon && y.icon === D && delete y.icon, delete y.panel, delete y.folderUrl, delete y.amdFolder, delete y.thumbnail, delete y.configFile, delete y.gid, delete y.isOnScreen, delete y.isRemote, delete y.featureActions, x.forEach(function (H) { delete y[H] }),
                                                        u ? "undefined" === typeof y.openAtStart && (y.openAtStart = !1) : (y.visible && delete y.visible, y.manifest && y.label === y.manifest.label && delete y.label, y.isDefaultConfig && (delete y.config, delete y.isDefaultConfig)), delete y.manifest, y.itemId && delete y.uri)
                                        }); delete z.rawAppConfig; delete z._ssl; delete z.getConfigElementById; delete z.getConfigElementsByName; delete z.processNoUriWidgets; delete z.addElementId; delete z.getCleanConfig; delete z.visitElement; delete z.agolConfig; delete z._itemData; delete z.oldWabVersion;
                                        delete z.titleColor; return z
                                } var p = null; var B = E(null, {
                                        urlParams: null, appConfig: null, configFile: null, _configLoaded: !1, portalSelf: null, constructor: function (t) {
                                                this.urlParams = t || {}; this.listenBuilderEvents(); this.versionManager = new n; this.widgetManager = k.getInstance(); this.configLoader = d.getInstance(this.urlParams, { versionManager: this.versionManager }); "config" === this.urlParams.mode && window.parent.setConfigViewerTopic && q.isFunction(window.parent.setConfigViewerTopic) && window.parent.setConfigViewerTopic(m);
                                                "preview" === this.urlParams.mode && window.parent.setPreviewViewerTopic && q.isFunction(window.parent.setPreviewViewerTopic) && window.parent.setPreviewViewerTopic(m); l.isMobileUa() || r(window, "resize", q.hitch(this, this._onWindowResize)); r(window, "orientationchange", q.hitch(this, this._onOrientationChange))
                                        }, listenBuilderEvents: function () {
                                                m.subscribe("builder/widgetChanged", q.hitch(this, this._onWidgetChanged)); m.subscribe("builder/groupChanged", q.hitch(this, this._onGroupChanged)); m.subscribe("builder/layoutDefinitionChanged",
                                                        q.hitch(this, this._onLayoutDefinitionChanged)); m.subscribe("builder/onScreenGroupsChanged", q.hitch(this, this._onOnScreenGroupsChanged)); m.subscribe("builder/widgetPoolChanged", q.hitch(this, this._onWidgetPoolChanged)); m.subscribe("builder/openAtStartChange", q.hitch(this, this._onOpenAtStartChanged)); m.subscribe("builder/onScreenOrderChanged", q.hitch(this, this._onScreenOrderChanged)); m.subscribe("builder/mapContentModified", q.hitch(this, this._onMapContentModified)); m.subscribe("builder/mapChanged", q.hitch(this,
                                                                this._onMapChanged)); m.subscribe("builder/mapOptionsChanged", q.hitch(this, this._onMapOptionsChanged)); m.subscribe("builder/mapRefreshIntervalChanged", q.hitch(this, this._onMapRefreshIntervalChanged)); m.subscribe("builder/appAttributeChanged", q.hitch(this, this._onAppAttributeChanged)); m.subscribe("builder/dataSourceChanged", q.hitch(this, this._onDataSourceChanged)); m.subscribe("builder/setAppConfig", q.hitch(this, this._onAppConfigSet)); m.subscribe("builder/themeChanged", q.hitch(this, this._onThemeChanged));
                                                m.subscribe("builder/layoutChanged", q.hitch(this, this._onLayoutChanged)); m.subscribe("builder/styleChanged", q.hitch(this, this._onStyleChanged)); m.subscribe("builder/syncExtent", q.hitch(this, this._onSyncExtent)); m.subscribe("builder/loadingPageChanged", q.hitch(this, this._onLoadingPageChanged)); m.subscribe("builder/templateConfigChanged", q.hitch(this, this._onTemplateConfigChanged)); m.subscribe("builder/appProxyForMapChanged", q.hitch(this, this._onAppProxyForMapChanged)); m.subscribe("builder/appProxyForUrlChanged",
                                                        q.hitch(this, this._onAppProxyForUrlChanged)); m.subscribe("builder/sharedThemeChanged", q.hitch(this, this._onSharedThemeChanged))
                                        }, loadConfig: function () {
                                                if ("preview" !== this.urlParams.mode && "config" !== this.urlParams.mode) {
                                                        var t = new g; t.placeAt(window.jimuConfig.layoutId); return this.configLoader.loadConfig().then(q.hitch(this, function (u) {
                                                                this.portalSelf = this.configLoader.portalSelf; this.appConfig = this._addDefaultValues(u); console.timeEnd("Load Config"); window.appInfo.isRunInMobile = l.inMobileSize(); u =
                                                                        this.getAppConfig(); t.destroy(); m.publish("appConfigLoaded", u); return u
                                                        }), q.hitch(this, function (u) { t.destroy(); console.error(u); u && u.message && "string" === typeof u.message && this._showErrorMessage(u) }))
                                                }
                                        }, _showErrorMessage: function (t) {
                                                if (!1 === t.isSelfOrigin) {
                                                        w.create("div", { "class": "app-error", innerHTML: l.sanitizeHTML(t.message || t) }, document.body); t = w.create("div", { "class": "app-error", innerHTML: l.sanitizeHTML(window.jimuNls.common.close) }, document.body); w.setStyle(t, {
                                                                "margin-top": "80px", "padding-top": 0,
                                                                background: "none", cursor: "pointer"
                                                        }); r(t, "click", q.hitch(this, function () { window.close() })); w.setStyle(t, "display", "none"); t = w.create("div", { "class": "app-error" }, document.body); w.setStyle(t, { "margin-top": "90px", "padding-top": 0, background: "none" }); t = w.create("div", { "class": "app-error-advanced-button", innerHTML: l.sanitizeHTML(window.jimuNls.advancedOptions) }, t); w.setStyle(t, {
                                                                margin: "0 auto 0 auto", color: "#666", padding: "8px 12px 8px 12px", background: "none", border: "1px solid #ccc", display: "inline-block",
                                                                "border-radius": "4px", cursor: "pointer"
                                                        }); r(t, "click", q.hitch(this, function () { w.setStyle(z, "display", "block") })); t = window.location.href; var u = b.getStandardPortalUrl(window.location.origin); u = b.getArcgisOnlineUrl(u); t = t.replace(window.location.origin, u); t = window.jimuNls.proceedTo.replace("${value}", "\x3ca href\x3d" + t + "\x3e" + t + "\x3c/a\x3e"); var z = w.create("div", { "class": "app-error", innerHTML: l.sanitizeHTML(t) }, document.body); w.setStyle(z, { "margin-top": "140px", display: "none", "padding-top": 0, background: "none" })
                                                } else w.create("div",
                                                        { "class": "app-error", innerHTML: l.sanitizeHTML(t.message || t) }, document.body); w.setStyle(jimuConfig.loadingId, "display", "none")
                                        }, getAppConfig: function () {
                                                if (window.appInfo.isRunInMobile) { var t = q.clone(this._getMobileConfig(this.appConfig)); t._originConfig = q.clone(this.appConfig) } else t = q.clone(this.appConfig); t.getConfigElementById = function (u) { return l.getConfigElementById(this, u) }; t.getConfigElementsByName = function (u) { return l.getConfigElementsByName(this, u) }; t.getCleanConfig = function (u) {
                                                        return this._originConfig ?
                                                                h(this._originConfig, u) : h(this, u)
                                                }; t.visitElement = function (u) { l.visitElement(this, u) }; return t
                                        }, _onOrientationChange: function () { this.appConfig && m.publish("appConfigChanged", this.getAppConfig(), "layoutChange") }, _onWindowResize: function () { var t = l.inMobileSize(); window.appInfo.isRunInMobile !== t && (window.appInfo.isRunInMobile = t, this.appConfig && m.publish("appConfigChanged", this.getAppConfig(), "layoutChange")) }, _getMobileConfig: function (t) { return l.mixinAppConfigPosition(t, t.mobileLayout) }, _updateDataSourceForWidget: function (t) {
                                                this._deleteDataSourcesFromWidget(t);
                                                this._addDataSourcesForWidget(t)
                                        }, _deleteDataSourcesFromWidget: function (t) { for (var u in this.appConfig.dataSource.dataSources) u.startWith("widget~" + t.id + "~") && delete this.appConfig.dataSource.dataSources[u] }, _addDataSourcesForWidget: function (t) { A.forEach(t.provideDataSources, function (u) { var z = "widget~" + t.id + "~" + u.id; u.id = z; this.appConfig.dataSource.dataSources[z] = u }, this); delete t.provideDataSources }, _addIdForWidgets: function (t) {
                                                var u = 0, z; this.getAppConfig().visitElement(function (x) {
                                                        if (x.id) {
                                                                x.id =
                                                                x.id.replace(/\//g, "_"); var y = x.id.lastIndexOf("_"); -1 < y && (z = x.id.substr(y + 1), u = Math.max(u, z))
                                                        }
                                                }); A.forEach(t, function (x) { x.id || (u++, x.id = x.itemId ? x.itemId + "_" + u : x.uri ? x.uri.replace(/\//g, "_") + "_" + u : "_" + u) })
                                        }, _onWidgetChanged: function (t) {
                                                var u = l.reCreateObject(t); t = l.getConfigElementById(this.appConfig, t.id); this._updateDataSourceForWidget(u); !1 !== u.inPanel || t.uri || (u.closeable = !0); for (var z in u) t[z] = u[z]; delete t.isDefaultConfig; this.configLoader.addNeedValues(this.appConfig); this._addDefaultValues(this.appConfig);
                                                m.publish("appConfigChanged", this.getAppConfig(), "widgetChange", u)
                                        }, _onGroupChanged: function (t) { var u = l.reCreateObject(t); t = l.getConfigElementById(this.appConfig, t.id); this._handleDataSourceForWidgets(t, u); for (var z in u) t[z] = u[z]; this.configLoader.addNeedValues(this.appConfig); this._addDefaultValues(this.appConfig); m.publish("appConfigChanged", this.getAppConfig(), "groupChange", u) }, _handleDataSourceForWidgets: function (t, u) {
                                                var z = A.filter(u.widgets, function (x) {
                                                        return x.id ? 0 === A.filter(t.widgets, function (y) {
                                                                return x.id ===
                                                                        y.id
                                                        }).length : !0
                                                }, this); this._addIdForWidgets(z); A.forEach(z, function (x) { this._addDataSourcesForWidget(x) }, this); z = A.filter(t.widgets, function (x) { return 0 === A.filter(u.widgets, function (y) { return y.id === x.id }).length }, this); A.forEach(z, function (x) { this._deleteDataSourcesFromWidget(x) }, this); A.forEach(u.widgets, function (x) { A.forEach(t.widgets, function (y) { x.id === y.id && x.provideDataSources && this._updateDataSourceForWidget(x) }, this) }, this)
                                        }, _onWidgetPoolChanged: function (t) {
                                                var u = l.reCreateObject(t); this._handleDataSourceForWidgetsSection(this.appConfig.widgetPool,
                                                        u); 1 === this.widgetManager.getControllerWidgets().length ? (this.appConfig.widgetPool.widgets = u.widgets, this.appConfig.widgetPool.groups = u.groups) : (t = l.getConfigElementById(this.appConfig, u.controllerId), A.forEach(t.controlledWidgets, function (z) { this._removeWidgetOrGroupFromPoolById(this.appConfig, z) }, this), A.forEach(t.controlledGroups, function (z) { this._removeWidgetOrGroupFromPoolById(this.appConfig, z) }, this), this.appConfig.widgetPool.widgets = "undefined" === typeof this.appConfig.widgetPool.widgets ? u.widgets :
                                                                this.appConfig.widgetPool.widgets.concat(u.widgets), this.appConfig.widgetPool.groups = "undefined" === typeof this.appConfig.widgetPool.groups ? u.groups : this.appConfig.widgetPool.groups.concat(u.groups), t.controlledWidgets = A.map(u.widgets, function (z) { return z.id }), t.controlledGroups = A.map(u.groups, function (z) { return z.id })); this.configLoader.addNeedValues(this.appConfig); this.configLoader.loadAndUpgradeAllWidgetsConfig(this.appConfig).then(q.hitch(this, function (z) {
                                                                        this.appConfig = z; this._addDefaultValues(this.appConfig);
                                                                        m.publish("appConfigChanged", this.getAppConfig(), "widgetPoolChange", u)
                                                                }))
                                        }, _handleDataSourceForWidgetsSection: function (t, u) { var z = u.widgets; A.forEach(u.groups, function (y) { z = z.concat(y.widgets) }, this); var x = t.widgets; A.forEach(t.groups, function (y) { x = x.concat(y.widgets) }, this); this._handleDataSourceForWidgets({ widgets: x }, { widgets: z }) }, _removeWidgetOrGroupFromPoolById: function (t, u) {
                                                A.some(t.widgetPool.widgets, function (z, x) { if (z.id === u) return t.widgetPool.widgets.splice(x, 1), !0 }); A.some(t.widgetPool.groups,
                                                        function (z, x) { if (z.id === u) return t.widgetPool.groups.splice(x, 1), !0 })
                                        }, _onOpenAtStartChanged: function (t) {
                                                var u = l.reCreateObject(t), z = this.appConfig; t.isOnScreen ? (z = z.widgetOnScreen && z.widgetOnScreen.widgets) && 0 < z.length && A.forEach(z, q.hitch(this, function (x) { x.id === t.id ? x.openAtStart = !x.openAtStart : delete x.openAtStart })) : ((z = z.widgetPool) && z.groups && 0 < z.groups.length && A.forEach(z.groups, q.hitch(this, function (x) { x.id === t.id ? x.openAtStart = !x.openAtStart : delete x.openAtStart })), z && z.widgets && 0 < z.widgets.length &&
                                                        A.forEach(z.widgets, q.hitch(this, function (x) { x.id === t.id ? x.openAtStart = !x.openAtStart : delete x.openAtStart }))); m.publish("appConfigChanged", this.getAppConfig(), "openAtStartChange", u)
                                        }, _onScreenOrderChanged: function (t) {
                                                var u = l.reCreateObject(t); A.forEach(this.appConfig.widgetOnScreen.widgets, function (z) { z.isController || (!1 !== z.inPanel || !0 !== z.closeable) && !0 !== z.inPanel && z.uri || A.some(u, function (x) { if (z.id === x.id) return z.position = x.position, !0 }) }, this); m.publish("appConfigChanged", this.getAppConfig(),
                                                        "onScreenOrderChange", u)
                                        }, _onAppAttributeChanged: function (t) { t = l.reCreateObject(t); q.mixin(this.appConfig, t); this.configLoader.processProxy(this.appConfig); this.configLoader.addNeedValues(this.appConfig); this._addDefaultValues(this.appConfig); m.publish("appConfigChanged", this.getAppConfig(), "attributeChange", t) }, _onDataSourceChanged: function (t) { var u = l.reCreateObject(t); this.appConfig.dataSource = u; m.publish("appConfigChanged", this.getAppConfig(), "dataSourceChange", t) }, _onLoadingPageChanged: function (t) {
                                                t =
                                                l.reCreateObject(t); if ("backgroundColor" in t) this.appConfig.loadingPage.backgroundColor = t.backgroundColor; else if ("backgroundImage" in t) { var u = this.appConfig.loadingPage.backgroundImage || {}; this.appConfig.loadingPage.backgroundImage = q.mixin(u, t.backgroundImage) } else "loadingGif" in t && (u = this.appConfig.loadingPage.loadingGif || {}, this.appConfig.loadingPage.loadingGif = q.mixin(u, t.loadingGif)); this.configLoader.addNeedValues(this.appConfig); this._addDefaultValues(this.appConfig); m.publish("appConfigChanged",
                                                        this.getAppConfig(), "loadingPageChange", t)
                                        }, _onAppProxyForMapChanged: function (t) {
                                                t = l.reCreateObject(t); "appProxy" in this.appConfig.map ? this.appConfig.map.appProxy.mapItemId !== t.mapItemId ? this.appConfig.map.appProxy = t : A.forEach(t.proxyItems, q.hitch(this, function (u) {
                                                        if (!A.some(this.appConfig.map.appProxy.proxyItems, function (x) {
                                                                if (x.sourceUrl === u.sourceUrl) return x.useProxy = u.useProxy, x.proxyUrl = u.proxyUrl || "", x.proxyId = u.proxyId || "", isNaN(u.hitsPerInterval) || (x.hitsPerInterval = u.hitsPerInterval), isNaN(u.intervalSeconds) ||
                                                                        (x.intervalSeconds = u.intervalSeconds), !0
                                                        }) && u.useProxy && u.proxyUrl) { var z = this.appConfig.map.appProxy.proxyItems || []; z.push(u); this.appConfig.map.appProxy.proxyItems = z }
                                                })) : this.appConfig.map.appProxy = t; m.publish("appConfigChanged", this.getAppConfig(), "appProxyChange", t)
                                        }, _onAppProxyForUrlChanged: function (t) { t = l.reCreateObject(t); this.appConfig.appProxies = t; m.publish("appConfigChanged", this.getAppConfig(), "appProxyChange", t) }, _onTemplateConfigChanged: function (t) {
                                                t = l.reCreateObject(t); this.appConfig.templateConfig =
                                                        t; this.configLoader.addNeedValues(this.appConfig); this._addDefaultValues(this.appConfig); m.publish("appConfigChanged", this.getAppConfig(), "templateConfigChange", t)
                                        }, _onMapContentModified: function () { m.publish("mapContentModified") }, _onMapChanged: function (t) {
                                                var u = l.reCreateObject(t); this.appConfig.map.mapOptions && l.deleteMapOptions(this.appConfig.map.mapOptions); this.appConfig.map.mapRefreshInterval = { useWebMapRefreshInterval: !0 }; q.mixin(this.appConfig.map, u); this._deleteDataSourcesFromMap(); this.configLoader.addNeedValues(this.appConfig);
                                                this.configLoader.loadAndUpgradeAllWidgetsConfig(this.appConfig).then(q.hitch(this, function (z) { this.appConfig = z; this._addDefaultValues(this.appConfig); m.publish("appConfigChanged", this.getAppConfig(), "mapChange", u) }))
                                        }, _deleteDataSourcesFromMap: function () { A.forEach(Object.keys(this.appConfig.dataSource.dataSources), function (t) { t.startWith("map") && delete this.appConfig.dataSource.dataSources[t] }, this) }, _onMapOptionsChanged: function (t) {
                                                t = l.reCreateObject(t); this.appConfig.map.mapOptions || (this.appConfig.map.mapOptions =
                                                        {}); q.mixin(this.appConfig.map.mapOptions, t); m.publish("appConfigChanged", this.getAppConfig(), "mapOptionsChange", t)
                                        }, _onMapRefreshIntervalChanged: function (t) {
                                                t = l.reCreateObject(t); this.appConfig.map.mapRefreshInterval || (this.appConfig.map.mapRefreshInterval = {}); q.mixin(this.appConfig.map.mapRefreshInterval, t); this.appConfig.map.mapRefreshInterval.useWebMapRefreshInterval && delete this.appConfig.map.mapRefreshInterval.minutes; m.publish("appConfigChanged", this.getAppConfig(), "mapRefreshIntervalChange",
                                                        t)
                                        }, _onThemeChanged: function (t) { this._getAppConfigFromTheme(t).then(q.hitch(this, function (u) { var z = q.clone(this.appConfig.widgetOnScreen); this.appConfig = u; this._handleDataSourceForWidgetsSection(z, {}); m.publish("appConfigChanged", this.getAppConfig(), "themeChange", t.getName()) })) }, _onLayoutChanged: function (t) {
                                                this.appConfig = l.mixinAppConfigPosition(this.appConfig, t.layoutConfig); this.appConfig.layoutDefinition = t.layoutConfig.layoutDefinition; this.configLoader.addNeedValues(this.appConfig); this._addDefaultValues(this.appConfig);
                                                m.publish("appConfigChanged", this.getAppConfig(), "layoutChange", t.name)
                                        }, _onStyleChanged: function (t) {
                                                this.appConfig.theme.styles = this._genStyles(this.appConfig.theme.styles, t.name); t.isCustom ? this.appConfig.theme.customStyles = { mainBackgroundColor: t.styleColor } : (delete this.appConfig.theme.customStyles, delete this.appConfig.titleColor, this.appConfig.theme.sharedTheme = { isPortalSupport: this.appConfig.theme.sharedTheme.isPortalSupport, useHeader: !1, useLogo: !1 }); m.publish("appConfigChanged", this.getAppConfig(),
                                                        "styleChange", t.name)
                                        }, _onOnScreenGroupsChanged: function (t) { t = l.reCreateObject(t); this.appConfig.widgetOnScreen.groups = t.groups; m.publish("appConfigChanged", this.getAppConfig(), "onScreenGroupsChange", t.groups) }, _onLayoutDefinitionChanged: function (t) {
                                                t = l.reCreateObject(t); l.isEqual(this.appConfig.layoutDefinition, t.layoutDefinition) || (this.appConfig.layoutDefinition = t.layoutDefinition, this.appConfig.widgetOnScreen.groups = l.handleGridLayoutOnScreenGroupChange(this.appConfig.widgetOnScreen.groups, t.groupIds),
                                                        this.configLoader.addNeedValues(this.appConfig), this._addDefaultValues(this.appConfig), m.publish("appConfigChanged", this.getAppConfig(), "layoutDefinitionChange", t.layoutDefinition))
                                        }, _onSharedThemeChanged: function (t) {
                                                var u = this.appConfig.theme.sharedTheme; t = l.reCreateObject(t); t.useHeader && !u.useHeader && (this.portalSelf.portalProperties && this.portalSelf.portalProperties.sharedTheme ? (this.appConfig.theme.customStyles = { mainBackgroundColor: this.portalSelf.portalProperties.sharedTheme.header.background },
                                                        this.appConfig.titleColor = this.portalSelf.portalProperties.sharedTheme.header.text, this._onAppAttributeChanged({ titleColor: this.appConfig.titleColor })) : console.error("Portal does not support sharedTheme.")); !t.useHeader && u.useHeader && (delete this.appConfig.titleColor, this._onAppAttributeChanged({ titleColor: this.appConfig.titleColor })); t.useLogo && !u.useLogo && (this.portalSelf.portalProperties && this.portalSelf.portalProperties.sharedTheme ? (this.appConfig.logo = this.portalSelf.portalProperties.sharedTheme.logo &&
                                                                this.portalSelf.portalProperties.sharedTheme.logo.small ? this.portalSelf.portalProperties.sharedTheme.logo.small : "images/app-logo.png", this.appConfig.logoLink = this.portalSelf.portalProperties.sharedTheme.logo.link, this._onAppAttributeChanged({ logo: this.appConfig.logo, logoLink: this.appConfig.logoLink })) : console.error("Portal does not support sharedTheme.")); !t.useLogo && u.useLogo && this._onAppAttributeChanged({ logo: this.appConfig.logo }); q.mixin(u, t); m.publish("appConfigChanged", this.getAppConfig(), "sharedThemeChange",
                                                                        t)
                                        }, _onSyncExtent: function (t) { m.publish("syncExtent", t) }, _genStyles: function (t, u) { var z = []; z.push(u); A.forEach(t, function (x) { 0 > z.indexOf(x) && z.push(x) }); return z }, _getAppConfigFromTheme: function (t) {
                                                var u = new v, z = [], x = this.getAppConfig().getCleanConfig(); x.mode = this.urlParams.mode; A.forEach(x.widgetPool.groups, function (H) { delete H.panel }, this); if (t.appConfig) {
                                                        var y = q.clone(t.appConfig); y.map = x.map; y.map.position = t.appConfig.map.position; this._copyPoolToThemePool(x, y); y.links = x.links; y.title = x.title;
                                                        y.subtitle = x.subtitle; y.logo = x.logo
                                                } else {
                                                        var D = t.getCurrentLayout(); z = t.getCurrentStyle(); y = q.clone(x); D = q.clone(D.layoutConfig); y.widgetOnScreen = D.widgetOnScreen; D.widgetPool && (A.forEach(D.widgetPool.widgets, function (H) { H.isPreconfiguredInTheme = !0 }), A.forEach(D.widgetPool.groups, function (H) { H.isPreconfiguredInTheme = !0 })); this._copyPoolToThemePool(x, D); y.widgetPool = D.widgetPool; D.map && D.map.position && (y.map.position = D.map.position); y.mobileLayout = D.mobileLayout; y.layoutDefinition = D.layoutDefinition;
                                                        z = this._genStyles(A.map(t.getStyles(), function (H) { return H.name }), z.name); y.theme = { name: t.getName(), styles: z, version: t.getVersion() }; this.portalSelf.portalProperties && this.portalSelf.portalProperties.sharedTheme ? (y.theme.sharedTheme = { useHeader: !0, useLogo: !0, isPortalSupport: !0 }, y.theme.customStyles = { mainBackgroundColor: this.portalSelf.portalProperties.sharedTheme.header.background }) : (y.theme.sharedTheme = { useHeader: !1, useLogo: !1, isPortalSupport: !1 }, y.theme.customStyles = { mainBackgroundColor: "" }); y.titleColor =
                                                                x.titleColor; y.logoLink = x.logoLink
                                                } this.configLoader.addNeedValues(y); this.configLoader.loadWidgetsManifest(y).then(q.hitch(this, function (H) { return this.configLoader.loadAndUpgradeAllWidgetsConfig(H) })).then(q.hitch(this, function () { this._addDefaultValues(y); u.resolve(y) })); return u
                                        }, _copyPoolToThemePool: function (t, u) {
                                                var z = t.widgetPool; u.widgetPool || (u.widgetPool = {}); t = u.widgetPool; var x = A.filter(t.widgets, function (I) { if (I.isPreconfiguredInTheme || !A.some(z.widgets, function (N) { return N.name === I.name })) return !0 }),
                                                        y = A.filter(t.groups, function (I) { return I.isPreconfiguredInTheme }), D = A.filter(z.widgets, function (I) { return !I.isPreconfiguredInTheme }), H = A.filter(z.groups, function (I) { return !I.isPreconfiguredInTheme }); D = this._getPoolWidgetsWithoutDuplicated(D, u.widgetOnScreen.widgets || []); t.widgets = D.concat(x); t.groups = H.concat(y)
                                        }, _getPoolWidgetsWithoutDuplicated: function (t, u) {
                                                for (var z = q.clone(t), x = this.getAppConfig(), y = t.length - 1; 0 <= y; y--)for (var D = u.length - 1; 0 <= D; D--)if (u[D].uri) {
                                                        var H = u[D].name; H || (H = l.getWidgetNameFromUri(u[D].uri));
                                                        var I = x.getConfigElementById(t[y].id); t[y] && t[y].name === H && !1 === I.supportMultiInstance && (console.log("Widget", t[y].name, "is not copied to new theme because this widget exists in new theme."), z.splice(y, 1))
                                                } return z
                                        }, _onAppConfigSet: function (t) {
                                                t = l.reCreateObject(t); window.appInfo.isRunInMobile = l.inMobileSize(); this.configLoader.processProxy(t); this.configLoader.addNeedValues(t); this.configLoader.loadAndUpgradeAllWidgetsConfig(t).then(q.hitch(this, function (u) {
                                                        this._addDefaultValues(u); c.setPortalUrl(u.portalUrl);
                                                        window.portalUrl = u.portalUrl; this.appConfig ? (l.deleteMapOptions(u.map.mapOptions), this.appConfig = u, this._deleteDataSourcesFromMap(), m.publish("appConfigChanged", this.getAppConfig(), "resetConfig", u)) : (this.appConfig = u, e.getPortal(u.portalUrl).loadSelfInfo().then(q.hitch(this, function (z) { this.portalSelf = z; m.publish("appConfigLoaded", this.getAppConfig()) }))); u = c.getPortalCredential(window.portalUrl); window.postMessageToSw({ type: "to_sw_credential", credential: u.toJson() })
                                                }))
                                        }, _addDefaultValues: function (t) {
                                                this._addDefaultPortalUrl(t);
                                                this._addDefaultGeometryService(t); this._addDefaultStyle(t); this._addDefaultMap(t); this._addDefaultVisible(t); this._addDefaultDataSource(t); this._addDefaultSharedTheme(t); "undefined" === typeof t.widgetOnScreen && (t.widgetOnScreen = {}); "undefined" === typeof t.widgetPool && (t.widgetPool = {}); this._addDefaultPanelAndPosition(t); this._addDefaultOfWidgetGroup(t); (t.widgetPool.widgets && 0 < t.widgetPool.widgets.length && void 0 === t.widgetPool.widgets[0].index || t.widgetPool.groups && 0 < t.widgetPool.groups.length && void 0 ===
                                                        t.widgetPool.groups[0].index) && this._addIndexForWidgetPool(t); return t
                                        }, _addDefaultDataSource: function (t) { t.dataSource ? (t.dataSource.dataSources || (t.dataSource.dataSources = {}), t.dataSource.settings || (t.dataSource.settings = {})) : t.dataSource = { dataSources: {}, settings: {} } }, _addDefaultPortalUrl: function (t) { "undefined" === typeof t.portalUrl && (t.portalUrl = "http://www.arcgis.com/"); t.portalUrl && "/" !== t.portalUrl.substr(t.portalUrl.length - 1) && (t.portalUrl += "/") }, _addDefaultGeometryService: function (t) {
                                                var u =
                                                        t && t.geometryService; u = u && "string" === typeof u && q.trim(u) ? q.trim(u) : this.portalSelf.helperServices.geometry.url; t.geometryService = u; a.defaults.geometryService = new f(t.geometryService)
                                        }, _addDefaultStyle: function (t) { !t.theme || t.theme.styles && 0 !== t.theme.styles.length || (t.theme.styles = ["default"]) }, _addDefaultMap: function (t) {
                                                t.map.id = "map"; "undefined" === typeof t.map["3D"] && "undefined" === typeof t.map["2D"] && (t.map["2D"] = !0); "undefined" === typeof t.map.position && (t.map.position = { left: 0, right: 0, top: 0, bottom: 0 });
                                                "undefined" === typeof t.map.portalUrl && (t.map.portalUrl = t.portalUrl)
                                        }, _addDefaultVisible: function (t) { l.visitElement(t, function (u) { void 0 === u.visible && (u.visible = !0) }) }, _addDefaultSharedTheme: function (t) { t.theme.sharedTheme ? ("undefined" === typeof t.theme.sharedTheme.useHeader && (t.theme.sharedTheme.useHeader = !1), "undefined" === typeof t.theme.sharedTheme.useLogo && (t.theme.sharedTheme.useLogo = !1)) : t.theme.sharedTheme = { useHeader: !1, useLogo: !1 } }, _addDefaultPanelAndPosition: function (t) {
                                                this._addOnScreenDefaultPanelAndPosition(t);
                                                this._addPoolDefaultPanelAndPosition(t)
                                        }, _addOnScreenDefaultPanelAndPosition: function (t) {
                                                var u; if (t = t.widgetOnScreen) {
                                                        var z = t.panel && t.panel.positionRelativeTo ? t.panel.positionRelativeTo : "map"; "undefined" === typeof t.panel || "undefined" === typeof t.panel.uri ? t.panel = { uri: "jimu/OnScreenWidgetPanel", position: { relativeTo: z } } : "undefined" === typeof t.panel.position ? t.panel.position = { relativeTo: z } : "undefined" === typeof t.panel.position.relativeTo && (t.panel.position.relativeTo = z); if (t.widgets) for (z = 0; z < t.widgets.length; z++)t.widgets[z].position ||
                                                                (t.widgets[z].position = {}), t.widgets[z].position.relativeTo || (t.widgets[z].position.relativeTo = t.widgets[z] && t.widgets[z].positionRelativeTo ? t.widgets[z].positionRelativeTo : "map"), !0 !== t.widgets[z].inPanel || t.widgets[z].panel || (t.widgets[z].panel = q.clone(t.panel), t.widgets[z].panel.position = t.widgets[z].position, t.widgets[z].panel.position.relativeTo = t.widgets[z].position.relativeTo); if (t.groups) for (z = 0; z < t.groups.length; z++)for (t.groups[z].panel || (t.groups[z].panel = t.panel), t.groups[z].panel && !t.groups[z].panel.position &&
                                                                        (t.groups[z].panel.position = {}), t.groups[z].panel.position.relativeTo || (t.groups[z].panel.position.relativeTo = t.groups[z].panel.positionRelativeTo ? t.groups[z].panel.positionRelativeTo : "map"), t.groups[z].widgets || (t.groups[z].widgets = []), u = 0; u < t.groups[z].widgets.length; u++)t.groups[z].widgets[u].panel = t.groups[z].panel
                                                }
                                        }, _addPoolDefaultPanelAndPosition: function (t) {
                                                var u, z = t.widgetPool; if (z) {
                                                        var x = z.panel && z.panel.positionRelativeTo ? z.panel.positionRelativeTo : "map"; "undefined" === typeof z.panel || "undefined" ===
                                                                typeof z.panel.uri ? z.panel = { uri: "jimu/OnScreenWidgetPanel", position: { relativeTo: x } } : "undefined" === typeof z.panel.position ? z.panel.position = { relativeTo: x } : "undefined" === typeof z.panel.position.relativeTo && (z.panel.position.relativeTo = x); if (z.groups) for (x = 0; x < z.groups.length; x++)for (z.groups[x].panel ? z.groups[x].panel.position.relativeTo || (z.groups[x].panel.position.relativeTo = z.groups[x].panel.positionRelativeTo ? z.groups[x].panel.positionRelativeTo : "map") : z.groups[x].panel = z.panel, z.groups[x].widgets ||
                                                                        (z.groups[x].widgets = []), u = 0; u < z.groups[x].widgets.length; u++)z.groups[x].widgets[u].panel = z.groups[x].panel; if (z.widgets) for (x = 0; x < z.widgets.length; x++)!1 === z.widgets[x].inPanel ? (u = z.widgets[x].positionRelativeTo ? z.widgets[x].positionRelativeTo : "map", z.widgets[x].position) ? z.widgets[x].position.relativeTo || (z.widgets[x].position.relativeTo = u) : z.widgets[x].position = { relativeTo: u } : z.widgets[x].panel || (z.widgets[x].panel = t.widgetPool.panel)
                                                }
                                        }, _addDefaultOfWidgetGroup: function (t) {
                                                l.visitElement(t, q.hitch(this,
                                                        function (u, z) { u.isOnScreen = z.isOnScreen; u.widgets ? (u.gid = u.id, 1 === u.widgets.length ? (u.label || (u.label = u.widgets[0].label ? u.widgets[0].label : window.apiNls.common.groupLabel), u.icon || (u.icon = u.widgets[0].uri ? this._getDefaultIconFromUri(u.widgets[0].uri) : "jimu.js/images/group_icon.png")) : (u.icon = u.icon ? u.icon : "jimu.js/images/group_icon.png", u.label = u.label ? u.label : window.apiNls.common.groupLabel + " " + z.index)) : u.gid = z.groupId }))
                                        }, _getDefaultIconFromUri: function (t) {
                                                t = t.split("/"); t.pop(); return t.join("/") +
                                                        "/images/icon.png?wab_dv\x3d" + window.deployVersion
                                        }, _addIndexForWidgetPool: function (t) { var u = 0, z, x; if (t.widgetPool.widgets) for (z = 0; z < t.widgetPool.widgets.length; z++)t.widgetPool.widgets[z].index = u, u++; if (t.widgetPool.groups) for (z = 0; z < t.widgetPool.groups.length; z++)for (t.widgetPool.groups[z].index = u, u++, x = 0; x < t.widgetPool.groups[z].widgets.length; x++)t.widgetPool.groups[z].widgets[x].index = x }
                                }); B.getInstance = function (t) {
                                        null === p ? p = new B(t) : t && (p.urlParams = t, p.configLoader && (p.configLoader.urlParams =
                                                t)); window.getAppConfig = q.hitch(p, p.getAppConfig); return p
                                }; return B
                        })
                }, "jimu/utils": function () {
                        define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/promise/all dojo/on dojo/json dojo/cookie dojo/number dojo/date/locale dojo/i18n!dojo/cldr/nls/number dojox/encoding/base64 esri/lang moment/moment esri/arcgis/utils esri/dijit/PopupTemplate esri/SpatialReference esri/geometry/Extent esri/geometry/geometryEngine esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters esri/tasks/FeatureSet esri/symbols/PictureMarkerSymbol esri/urlUtils esri/request esri/tasks/query esri/tasks/QueryTask esri/graphicsUtils jimu/portalUrlUtils ./shared/utils ./accessibleUtils ./zoomToUtils libs/caja-html-sanitizer-minified".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y, D, H, I, N, T, M, R, ca, K, Q, X, W, fa, ma, ia, va) {
                                        function xa(C, G) { var L = C.match(/url\([^)]+\)/gi), P; if (null === L || "" === G) return C; for (P = 0; P < L.length; P++) { var S = L[P].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i); if (4 <= S.length) { var Y = S[2]; /^data:image\/.*;/.test(Y) || (G.endWith("/") || (G += "/"), C = C.replace(S[1] + Y + S[3], S[1] + G + Y + S[3])) } } return C } function na(C, G) {
                                                var L = Array.isArray(G), P = L && [] || {}; L ? (C = C || [], P = P.concat(C), G.forEach(function (S, Y) {
                                                        "undefined" === typeof C[Y] ?
                                                        P[Y] = S : "object" === typeof S ? P[Y] = na(C[Y], S) : -1 === C.indexOf(S) && P.push(S)
                                                })) : (C && "object" === typeof C && Object.keys(C).forEach(function (S) { P[S] = C[S] }), Object.keys(G).forEach(function (S) { P[S] = "object" === typeof G[S] && G[S] ? C[S] ? na(C[S], G[S]) : G[S] : G[S] })); return P
                                        } function ra(C, G) {
                                                var L = C.map(function (Y) { return Y.id }); q.forEach(G, function (Y) { 0 > L.indexOf(Y) && C.push({ id: Y, widgets: [] }) }, this); var P = []; C = q.filter(C, function (Y) { return 0 > G.indexOf(Y.id) ? (P.push(Y), !1) : !0 }, this); if (0 === C.length) return []; var S = C[C.length -
                                                        1]; q.forEach(P, function (Y) { S.widgets = S.widgets.concat(Y.widgets) }, this); return C = C.sort(function (Y, ha) { return G.indexOf(Y.id) - G.indexOf(ha.id) })
                                        } function sa(C, G, L) {
                                                function P(Y, ha) { return E.isArray(Y[ha.key]) ? Y[ha.key][ha.index] : Y[ha.key] } G = function (Y) {
                                                        var ha = []; Y.split("_").forEach(function (ja) { var ka = !1; "--" === ja.slice(ja.length - 2) && (ka = !0, ja = ja.slice(0, ja.length - 2)); var ua = ja.search(/\[[0-9]+\]/); -1 === ua && (ua = ja.length); ha.push({ key: ja.slice(0, ua), index: Number(ja.slice(ua + 1, -1)), deleteFlag: ka }) });
                                                        return ha
                                                }(G); for (var S = 1; S < G.length - 1; S++)if (C = P(C, G[S]), !C) return; if (G[G.length - 1].deleteFlag) !0 === L && (E.isArray(C[G[G.length - 1].key]) ? delete C[G[G.length - 1].key][G[G.length - 1].index] : delete C[G[G.length - 1].key]); else if (E.isArray(C[G[G.length - 1].key])) { if (void 0 === L) return C[G[G.length - 1].key][G[G.length - 1].index]; C[G[G.length - 1].key][G[G.length - 1].index] = L } else { if (void 0 === L) return C[G[G.length - 1].key]; C[G[G.length - 1].key] = L }
                                        } function wa(C, G, L) {
                                                function P(ja) {
                                                        ja = aa.template.getSearchRange(G, ja,
                                                                "]"); var ka = G.slice(ja.firstPos, ja.lastPos); return -1 !== ja.firstPos ? (ka = G.slice(ja.firstPos + ka.indexOf("[") + 1, ja.lastPos - 1), ja = G.slice(ja.lastPos + 1), (ka = aa.getConfigElementById(C, ka)) ? { object: ka, key: "section_" + ja, state: "isSection" } : { state: "deleted" }) : { state: "isNotSection" }
                                                } var S = C, Y = G = G.replace(/\//g, "_"), ha = P("groups\\[.+\\]"); if ("deleted" !== ha.state && ("isSection" === ha.state && (S = ha.object, Y = ha.key), ha = P("widgets\\[.+\\]"), "delete" !== ha.state)) return "isSection" === ha.state && (S = ha.object, Y = ha.key), sa(S,
                                                        Y, L)
                                        } var aa = {}, Da = { geometryService: "http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer" }; E.mixin(aa, ma); E.mixin(aa, ia); E.mixin(aa, va); window.atob || (window.atob = function (C) { C = f.decode(C); for (var G = "", L = 0, P = C.length; L < P; L++)G += String.fromCharCode(C[L]); return G }); window.btob || (window.btob = function (C) { for (var G = [], L = 0, P = C.length; L < P; L++)G.push(String.charCodeAt(C[L])); return f.encode(G) }); var Ca = []; require.on("error", function (C) {
                                                q.forEach(Ca, function (G) {
                                                        C.info[0] && -1 < C.info[0].indexOf(G.resKey) &&
                                                        G.def.reject(C); for (var L in C.info) -1 < L.indexOf(G.resKey) && G.def.reject(C)
                                                })
                                        }); aa.checkError = function (C, G) { Ca.push({ resKey: C, def: G }) }; aa.replacePlaceHolder = function (C, G) { var L = c.stringify(C), P = L.match(/\$\{(\w)+\}/g); if (null === P) return C; for (C = 0; C < P.length; C++) { var S = P[C].match(/(\w)+/g)[0]; G[S] && (L = L.replace(P[C], G[S])) } return c.parse(L) }; aa.changeUnit = function (C) {
                                                var G = Math.abs(C); C = Math.floor(G); var L = Math.floor(60 * (G - C)); G = (60 * (60 * (G - C) - L)).toFixed(2); return C + "\u00b0" + (10 > L ? "0" + L : L) + "'" + (10 >
                                                        G ? "0" + G : G) + '"'
                                        }; aa.formatTime = function (C) { var G = C / 1E3; C = Math.floor(G / 60); G = Number(G - 60 * C).toFixed(1); return (10 > C ? "0" + C : C) + ":" + (10 > G ? "0" + G : G) }; aa.parseTime = function (C) { var G = /(\d{2,}):(\d{2})\.(\d{1})/; if (!G.test(C)) return console.log("wrong time format."), -1; C = C.match(G); return 1E3 * (60 * parseInt(C[1], 10) + parseInt(C[2], 10) + parseInt(C[3], 10) / 10) }; aa.preloadImg = function (C, G) { var L = []; L = "string" === typeof C ? [C] : C; q.forEach(L, function (P) { (new Image).src = G ? G + P : P }) }; aa.setWABLogoDefaultAlt = function (C) {
                                                if (C) {
                                                        C =
                                                        r("img", C); for (var G = ["img_1412759111499", "img_1545621838463", "img_1560482577021"], L = 0, P = C.length; L < P; L++) { var S = C[L]; -1 < G.indexOf(A.getAttr(S, "id")) && !A.getAttr(S, "alt") && A.setAttr(S, "alt", "ArcGIS Web AppBuilder.png") }
                                                }
                                        }; var O = null; aa.getImagesSize = function (C) {
                                                var G = new k; if (!C || 0 !== C.indexOf("http")) return G.reject(), G; null === O && (O = A.create("img", { id: "__test-image-size", style: { position: "absolute", left: "-9999px", top: "-9999px" } }, document.body)); var L = d(O, "load", function () {
                                                        clearTimeout(P); P = null; L.remove();
                                                        var S = A.getContentBox(O); 1 === S.w && 1 === S.h || 0 === S.w || 0 === S.h ? G.reject() : G.resolve([S.w, S.h])
                                                }, {}), P = setTimeout(function () { clearTimeout(P); P = null; G.reject() }, 5E3); A.setAttr(O, "src", C); return G
                                        }; aa.getPositionStyle = function (C) {
                                                var G = {}; if (!C) return G; C = E.clone(C); if (window.isRTL) {
                                                        if ("undefined" !== typeof C.left && "undefined" !== typeof C.right) { var L = C.left; C.left = C.right; C.right = L } else "undefined" !== typeof C.left ? (C.right = C.left, delete C.left) : "undefined" !== typeof C.right && (C.left = C.right, delete C.right);
                                                        "undefined" !== typeof C.paddingLeft && "undefined" !== typeof C.paddingRight ? (L = C.paddingLeft, C.paddingLeft = C.paddingRight, C.paddingRight = L) : "undefined" !== typeof C.paddingLeft ? (C.paddingRight = C.paddingLeft, delete C.paddingLeft) : "undefined" !== typeof C.paddingRight && (C.paddingLeft = C.paddingRight, delete C.paddingRight); "undefined" !== typeof C.marginLeft && "undefined" !== typeof C.marginRight ? (L = C.marginLeft, C.marginLeft = C.marginRight, C.marginRight = L) : "undefined" !== typeof C.marginLeft ? (C.marginRight = C.marginLeft,
                                                                delete C.marginLeft) : "undefined" !== typeof C.marginRight && (C.marginLeft = C.marginRight, delete C.marginRight)
                                                } L = "left top right bottom width height padding paddingLeft paddingRight paddingTop paddingBottom margin marginLeft marginRight marginTop marginBottom".split(" "); for (var P = 0; P < L.length; P++) { var S = L[P]; "number" === typeof C[S] ? G[S] = C[S] + "px" : "undefined" !== typeof C[S] ? G[S] = C[S] : "padding" === S.substr(0, 7) || "margin" === S.substr(0, 7) ? G[S] = 0 : G[S] = "auto" } G.zIndex = "undefined" === typeof C.zIndex ? "auto" : C.zIndex;
                                                return G
                                        }; aa.isEqual = function (C, G) {
                                                function L(Y, ha) {
                                                        var ja; if (null === Y && null === ha || "undefined" === typeof Y && "undefined" === typeof ha) return !0; if (null === Y && null !== ha || null === ha && null !== Y || "undefined" === typeof Y && "undefined" !== typeof ha || "undefined" === typeof ha && "undefined" !== typeof Y) return !1; if (isNaN(Y) && isNaN(ha) && "number" === typeof Y && "number" === typeof ha || Y === ha) return !0; if ("function" === typeof Y && "function" === typeof ha || Y instanceof Date && ha instanceof Date || Y instanceof RegExp && ha instanceof RegExp ||
                                                                Y instanceof String && ha instanceof String || Y instanceof Number && ha instanceof Number) return Y.toString() === ha.toString(); if (-1 < P.indexOf(Y) || -1 < S.indexOf(ha)) return !1; if (null !== ha) {
                                                                        for (ja in ha) if (ha.hasOwnProperty(ja) !== Y.hasOwnProperty(ja) || typeof ha[ja] !== typeof Y[ja]) return !1; for (ja in Y) {
                                                                                if (ha.hasOwnProperty(ja) !== Y.hasOwnProperty(ja) || typeof ha[ja] !== typeof Y[ja]) return !1; switch (typeof Y[ja]) {
                                                                                        case "object": case "function": P.push(Y); S.push(ha); if (!L(Y[ja], ha[ja])) return !1; P.pop(); S.pop(); break;
                                                                                        default: if (!(isNaN(Y[ja]) && isNaN(ha[ja]) && "number" === typeof Y[ja] && "number" === typeof ha[ja] || Y[ja] === ha[ja])) return !1
                                                                                }
                                                                        }
                                                                } return !0
                                                } var P = []; var S = []; return L(C, G) ? !0 : !1
                                        }; aa.file = {
                                                loadFileAPI: function () { var C = new k; C.resolve(); return C }, supportHTML5: function () { return window.File && window.FileReader && window.FileList && window.Blob ? !0 : !1 }, supportFileAPI: function () { return w("safari") && 6 > w("safari") ? !1 : window.FileAPI && window.FileAPI.readAsDataURL ? !0 : !1 }, isEnabledFlash: function () {
                                                        var C = null; if (document.all) try {
                                                                C =
                                                                new ActiveXObject("ShockwaveFlash.ShockwaveFlash")
                                                        } catch (G) { C = null } else navigator.plugins && 0 < navigator.plugins.length && (C = navigator.plugins["Shockwave Flash"]); return !!C
                                                }, containSeparator: function (C) { return 0 <= C.indexOf("/") ? !0 : 0 <= C.indexOf("\\") ? !0 : !1 }, getNameFromPath: function (C) { var G = ""; G = 0 <= C.indexOf("/") ? "/" : "\\"; C = C.split(G); return 0 < C.length ? C[C.length - 1] : null }, getFolderFromPath: function (C) { return C.substr(0, C.length - aa.file.getNameFromPath(C).length) }, readFile: function (C, G, L, P) {
                                                        if (this.supportHTML5()) {
                                                                var S =
                                                                        C.target.files[0]; S && (S.type.match(G) ? S.size >= L ? P({ errCode: "exceed" }) : (C = new FileReader, C.onload = function (ha) { P(null, S.name, ha.target.result) }, C.readAsDataURL(S)) : P({ errCode: "invalidType" }))
                                                        } else if (this.supportFileAPI()) { var Y = window.FileAPI.getFiles(C); Y[0].type.match(G) ? Y[0].size >= L ? P({ errCode: "exceed" }) : window.FileAPI.readAsDataURL(Y[0], function (ha) { ha && ha.result ? P(null, Y[0].name, ha.result) : P({ errCode: "readError" }) }) : P({ errCode: "invalidType" }) }
                                                }
                                        }; aa.getUriInfo = function (C) {
                                                var G = {}; var L = C.indexOf("/");
                                                C.substring(0, L); L = C.substring(0, C.lastIndexOf("/") + 1); G.folderUrl = require(aa.getRequireConfig()).toUrl(L); G.amdFolder = L; G.url = G.folderUrl; if (/^http(s)?:\/\//.test(C) || /^\/\//.test(C)) G.isRemote = !0; return G
                                        }; aa.widgetJson = function () {
                                                var C = {
                                                        addManifest2WidgetJson: function (G, L) {
                                                                E.mixin(G, L.properties); G.name = L.name; G.label || (G.label = L.label); G.manifest = L; G.isRemote = L.isRemote; L.featureActions && (G.featureActions = L.featureActions); G.icon || (G.icon = L.icon); G.thumbnail || (G.thumbnail = L.thumbnail); G.folderUrl =
                                                                        L.folderUrl; G.amdFolder = L.amdFolder
                                                        }, removeManifestFromWidgetJson: function (G) { if (G.manifest) { for (var L in G.manifest.properties) G[L] = void 0; G.name = void 0; G.label = void 0; G.featureActions = void 0; G.manifest = void 0 } }, getUriFromItem: function (G) { return G.url ? C.getFolderUrlFromItem(G) + "Widget" : null }, getFolderUrlFromItem: function (G) {
                                                                if (!G.url) return null; G = /manifest\.json$/.test(G.url) ? G.url.substring(0, G.url.length - 13) : /\/$/.test(G.url) ? G.url : G.url + "/"; "https:" === window.location.protocol && (G = G.replace(/^http:\/\//,
                                                                        "https://")); return G
                                                        }
                                                }; return C
                                        }(); aa.getRequireConfig = function () { if (jimuConfig) { var C = []; jimuConfig.widgetsPackage && (C = C.concat(jimuConfig.widgetsPackage)); jimuConfig.themesPackage && (C = C.concat(jimuConfig.themesPackage)); jimuConfig.configsPackage && (C = C.concat(jimuConfig.configsPackage)); return { packages: C } } return {} }; aa.getTypeByGeometryType = function (C) {
                                                var G = "", L = "esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),
                                                P = ["esriGeometryRing", "esriGeometryPolygon", "esriGeometryEnvelope"]; 0 <= ["esriGeometryPoint", "esriGeometryMultipoint"].indexOf(C) ? G = "point" : 0 <= L.indexOf(C) ? G = "polyline" : 0 <= P.indexOf(C) && (G = "polygon"); return G
                                        }; aa.getSymbolTypeByGeometryType = function (C) { var G = null; C = aa.getTypeByGeometryType(C); "point" === C ? G = "marker" : "polyline" === C ? G = "line" : "polygon" === C && (G = "fill"); return G }; aa.getServices = function () { return Da }; aa.getArcGISDefaultGeometryService = function () { return new N(Da.geometryService) }; aa.restoreToDefaultWebMapExtent =
                                                function (C, G, L) {
                                                        var P = new k; if (!C || "esri.Map" !== C.declaredClass) return setTimeout(function () { P.reject("Invalid map.") }, 0), P; G = G && G.itemInfo; if (!G) return setTimeout(function () { P.reject("Invalid itemInfo") }, 0), P; G = G.item && G.item.extent; if (!G) return setTimeout(function () { P.reject("Invalid itemInfo.item.extent") }), P; var S = new u({ wkid: 4326 }); S = new z(G[0][0], G[0][1], G[1][0], G[1][1], S); if (4326 === parseInt(C.spatialReference.wkid, 10)) return C.setExtent(S); if (C.spatialReference.isWebMercator()) return S = I.geographicToWebMercator(S),
                                                                C.setExtent(S); G = new T; G.geometries = [S]; G.outSR = C.spatialReference; S = esriConfig && esriConfig.defaults && esriConfig.defaults.geometryService; S && "esri.tasks.GeometryService" === S.declaredClass || (L && "string" === typeof L && E.trim(L) ? (L = E.trim(L), S = new N(L)) : S = aa.getArcGISDefaultGeometryService()); S.project(G).then(function (Y) { if (Y = Y && Y[0]) return C.setExtent(Y); P.reject("Invalid projected geometry."); return P }, function (Y) { console.error(Y); P.reject(Y); return P }); return P
                                                }; aa.getAncestorWindow = function () {
                                                        for (var C =
                                                                window; C && C.parent && C !== C.parent;)C = C.parent; return C
                                                }; aa.getAncestorDom = function (C, G, L) { if (C && 1 === C.nodeType && G && "function" === typeof G) { var P = 100, S = document.body; L && ("number" === typeof L ? (L = parseInt(L, 10), 0 < L && (P = L)) : 1 === L.nodeType && (S = L)); for (L = 0; C.parentNode && L < P && A.isDescendant(C.parentNode, S);) { if (G(C.parentNode)) return C.parentNode; C = C.parentNode; L++ } } return null }; aa.bindClickAndDblclickEvents = function (C, G, L, P) {
                                                        var S = null; if (C && 1 === C.nodeType && G && "function" === typeof G && L && "function" === typeof L) {
                                                                var Y =
                                                                        200; P && "number" === typeof P && (P = parseInt(P, 10), 0 < P && (Y = P)); var ha = 0; S = d(C, "click", function (ja) { ha++; 1 === ha ? setTimeout(function () { 1 === ha && (ha = 0, G(ja)) }, Y) : 2 === ha && (ha = 0, L(ja)) })
                                                        } return S
                                                }; aa.isScrollToBottom = function (C) { var G = A.getContentBox(C); return 1 > C.scrollHeight - (C.scrollTop + G.h) }; aa.getAllItemTypes = function () {
                                                        var C = []; C = C.concat(["Web Map", "Web Scene", "CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service",
                                                                "Geocoding Service", "Network Analysis Service", "Geoprocessing Service"]).concat(["Web Mapping Application", "Mobile Application", "Code Attachment", "Operations Dashboard Add In", "Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";")); return C = C.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer",
                                                                        "Layer Package", "Explorer Layer"]).concat(["Geoprocessing Package", "Geoprocessing Sample", "Locator Package", "Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))
                                                }; aa.getItemQueryStringByTypes = function (C) {
                                                        var G = "", L = aa.getAllItemTypes(); if (C && 0 < C.length && 0 < C.length) {
                                                                var P = ""; q.forEach(C, function (S, Y) { P += ' type:"' + S + '" '; Y !== C.length - 1 && (P += " OR ") }); G = " ( " + P + " ) "; L = C.concat(L); L = q.filter(L, function (S) {
                                                                        return q.every(C,
                                                                                function (Y) { return 0 > Y.toLowerCase().indexOf(S.toLowerCase()) })
                                                                }); q.forEach(L, function (S) { G += ' -type:"' + S + '" ' })
                                                        } return G
                                                }; aa.getItemQueryStringByTypeKeywords = function (C) { var G = ""; C && 0 < C.length && (G = ' typekeywords:"' + C.join(",") + '" '); return G }; aa.isNotEmptyString = function (C, G) { var L = C && "string" === typeof C; return L ? G ? L && E.trim(C) : !0 : !1 }; aa.isNotEmptyStringArray = function (C, G) { for (var L = 0; L < C.length; L++) { var P = C[L]; if (!aa.isNotEmptyString(P.value ? P.value : P, G)) return !1 } return !0 }; aa.isValidNumber = function (C) {
                                                        return "number" ===
                                                                typeof C && !isNaN(C)
                                                }; aa.isValidNumberArray = function (C) { for (var G = 0; G < C.length; G++) { var L = C[G]; L = L.value || 0 === L.value ? L.value : L; if (!aa.isValidNumber(L)) return !1 } return !0 }; aa.isValidDate = function (C) { if (C) try { var G = aa.getDateByDateTimeStr(C); return !isNaN(G.getTime()) } catch (L) { return console.error(L), !1 } else return !1 }; aa.isObject = function (C) { return C && "object" === typeof C }; aa.createWebMap = function (C, G, L, P) { C = fa.getStandardPortalUrl(C); C = fa.getBaseItemUrl(C); B.arcgisUrl = C; return B.createMap(G, L, P) }; aa.getRandomString =
                                                        function () { var C = Math.random().toString(); return C = C.slice(2, C.length) }; aa._getDomainsByServerName = function (C) { var G = C.split("."), L = G.length; return q.map(G, E.hitch(this, function (P, S) { P = G.slice(S, L); var Y = "", ha = P.length - 1; q.forEach(P, E.hitch(this, function (ja, ka) { Y += ja; ka !== ha && (Y += ".") })); return Y })) }; aa.removeCookie = function (C, G) {
                                                                var L = this._getDomainsByServerName(window.location.hostname); q.forEach(L, E.hitch(this, function (P) {
                                                                        g(C, null, { expires: -1, path: G }); g(C, null, { expires: -1, path: G, domain: P }); g(C,
                                                                                null, { expires: -1, path: G, domain: "." + P })
                                                                }))
                                                        }; aa.isLocaleChanged = function (C, G) { return !C.startWith(G) }; aa.hashToObject = function (C) { C = C.replace("#", ""); C = v.queryToObject(C); for (var G in C) if (C.hasOwnProperty(G)) try { C[G] = c.parse(C[G]) } catch (L) { } return C }; aa.reCreateObject = function (C) {
                                                                function G(P) { var S = []; P.forEach(function (Y) { Array.isArray(Y) ? S.push(G(Y)) : "object" === typeof Y ? S.push(L(Y)) : S.push(Y) }); return S } function L(P) {
                                                                        var S = {}, Y; for (Y in P) P.hasOwnProperty(Y) && (null === P[Y] ? S[Y] = null : Array.isArray(P[Y]) ?
                                                                                S[Y] = G(P[Y]) : S[Y] = "object" === typeof P[Y] ? L(P[Y]) : P[Y]); return S
                                                                } return Array.isArray(C) ? G(C) : L(C)
                                                        }; aa.setVerticalCenter = function (C) { setTimeout(function () { var G = r(".jimu-vcenter-text", C), L, P; q.forEach(G, function (S) { L = A.getContentBox(S).h; A.setStyle(S, { lineHeight: L + "px" }) }, this); G = r(".jimu-vcenter", C); q.forEach(G, function (S) { L = A.getContentBox(S).h; P = A.getContentBox(r(S).parent()[0]).h; A.setStyle(S, { marginTop: (P - L) / 2 + "px" }) }, this) }, 10) }; aa.merge = na; aa.loadStyleLink = function (C, G, L) {
                                                                var P = new k, S = require(aa.getRequireConfig()).toUrl(G);
                                                                if (require.cache["url:" + S]) { var Y = require.cache["url:" + S]; var ha = S.split("/").pop(); S = S.substr(0, S.length - ha.length); Y = xa(Y, S); C = L ? A.create("style", { id: C, type: "text/css" }, A.byId(L), "before") : A.create("style", { id: C, type: "text/css" }, document.getElementsByTagName("head")[0]); C.styleSheet && !C.sheet ? C.styleSheet.cssText = Y : C.appendChild(A.toDom(Y)); P.resolve("load"); return P } Y = L ? A.create("link", { id: C, rel: "stylesheet", type: "text/css", href: S + "?wab_dv\x3d" + window.deployVersion }, A.byId(L), "before") : A.create("link",
                                                                        { id: C, rel: "stylesheet", type: "text/css", href: S + "?wab_dv\x3d" + window.deployVersion }, document.getElementsByTagName("head")[0]); d(Y, "load", function () { P.resolve("load") }); var ja = setInterval(function () { var ka; if (q.some(document.styleSheets, function (ua) { if (ua.href && ua.href.substr(ua.href.indexOf(G), ua.href.length) === G) return ka = ua, !0 })) try { !P.isFulfilled() && (ka.cssRules && ka.cssRules.length || ka.rules && ka.rules.length) && P.resolve("load"), clearInterval(ja) } catch (ua) { } }, 50); return P
                                                        }; aa.changeLocation = function (C) {
                                                                window.history.pushState &&
                                                                window.history.pushState({ path: C }, "", encodeURI(C))
                                                        }; aa.urlToObject = function (C) { var G = null; -1 === C.indexOf("#") ? (G = ca.urlToObject(C), G.hash = null) : (C = C.split("#"), G = ca.urlToObject(C[0]), G.hash = C[1] ? -1 < C[1].indexOf("\x3d") ? v.queryToObject(C[1]) : C[1] : null); return G }; aa.manifest = function () {
                                                                function C(G) {
                                                                        G.panels.forEach(function (L) { L.uri = "panels/" + L.name + "/Panel.js" }); G.styles.forEach(function (L) { L.uri = "styles/" + L.name + "/style.css" }); G.layouts.forEach(function (L) {
                                                                                L.uri = "layouts/" + L.name + "/config.json";
                                                                                L.icon = "layouts/" + L.name + "/icon.png"; L.RTLIcon = "layouts/" + L.name + "/icon_rtl.png"
                                                                        })
                                                                } return {
                                                                        addManifestProperies: function (G) {
                                                                                G.icon || (G.icon = G.folderUrl + "images/icon.png?wab_dv\x3d" + window.deployVersion); G.thumbnail || (G.thumbnail = G.folderUrl + "images/thumbnail.png"); "theme" === G.category ? C(G) : ("undefined" !== typeof G["2D"] && (G.support2D = G["2D"]), "undefined" !== typeof G["3D"] && (G.support3D = G["3D"]), "undefined" === typeof G["2D"] && "undefined" === typeof G["3D"] && (G.support2D = !0), delete G["2D"], delete G["3D"],
                                                                                        "undefined" === typeof G.properties && (G.properties = {}), ma.processWidgetProperties(G))
                                                                        }, processManifestLabel: function (G, L) {
                                                                                var P = L.split("-")[0]; G.label = G.i18nLabels && (G.i18nLabels[L] || G.i18nLabels[P] || G.i18nLabels.defaultLabel) || G.label || G.name; G.layouts && q.forEach(G.layouts, function (S) { var Y = "i18nLabels_layout_" + S.name; S.label = G[Y] && (G[Y][L] || G[Y].defaultLabel) || S.label || S.name }); G.styles && q.forEach(G.styles, function (S) {
                                                                                        var Y = "i18nLabels_style_" + S.name; S.label = G[Y] && (G[Y][L] || G[Y].defaultLabel) || S.label ||
                                                                                                S.name
                                                                                })
                                                                        }, addI18NLabel: function (G) { var L = new k; if (G.i18nLabels) return L.resolve(G), L; G.i18nLabels = {}; if (G.properties && !1 === G.properties.hasLocale) return L.resolve(G), L; var P = G.isRemote ? G.amdFolder + "nls/strings.js" : G.amdFolder + "nls/strings"; require(aa.getRequireConfig(), ["dojo/i18n!" + P], function (S) { var Y = {}; Y[dojoConfig.locale] = S; ma.addI18NLabelToManifest(G, null, Y); L.resolve(G) }); return L }
                                                                }
                                                        }(); aa.isNumberField = function (C) {
                                                                return 0 <= ["esriFieldTypeOID", "esriFieldTypeSmallInteger", "esriFieldTypeInteger",
                                                                        "esriFieldTypeSingle", "esriFieldTypeDouble"].indexOf(C)
                                                        }; aa.getTime = function (C) { var G = C.getTimezoneOffset(); G = 0 > G ? "+" + Math.abs(G) / 60 : "-" + G / 60; return C.getTime() + 36E5 * G }; aa.getUniqueValues = function (C, G, L, P, S) {
                                                                return function () { var Y = new k, ha = {}; P ? (ha.layerDefinition = P, S && (ha.fieldPopupInfo = S), Y.resolve(ha)) : Y = K({ url: C, content: { f: "json" }, handleAs: "json", callbackParamName: "callback" }).then(function (ja) { ha.layerDefinition = ja; return ha }, function (ja) { console.log("Error: ", ja.message) }); return Y }().then(function (Y) {
                                                                        return aa._getUniqueValues(C,
                                                                                G, L, Y.layerDefinition).then(function (ha) { return aa._getValues(Y.layerDefinition, Y.fieldPopupInfo, G, ha) })
                                                                })
                                                        }; aa._getValues = function (C, G, L, P) {
                                                                var S = []; S = aa.getFieldInfoByFieldName(C.fields, L); var Y = null, ha = aa.isNumberField(S.type), ja = "esriFieldTypeDate" === S.type ? !0 : !1; if (S) {
                                                                        if (ha) P = q.map(P, function (ka) { ka = parseFloat(ka); isNaN(ka) && (ka = null); return ka }); else if (ja) return S = q.map(P, E.hitch(this, function (ka) {
                                                                                var ua = ka, qa = ka; aa.isValidDate(ka) && (ua = aa.getDateTimeStrByFieldInfo(ka, G), qa = aa.localizeDateByFieldInfo(ka,
                                                                                        G)); return { value: ua, label: qa }
                                                                        })); C = aa.getCodedValueListForCodedValueOrSubTypes(C, L); if (null !== C) for (Y = {}, L = 0; L < C.length; L++)Y[C[L].value] = C[L].label
                                                                } return S = q.map(P, function (ka) { var ua = null; ua = null === ka || void 0 === ka ? "\x3cNull\x3e" : Y && Y.hasOwnProperty(ka) ? Y[ka] : ha ? G ? aa.localizeNumberByFieldInfo(ka, G) : aa.localizeNumber(ka) : ja ? aa.localizeDateByFieldInfo(new Date(ka), G) : ka; return { value: ka, label: ua } })
                                                        }; aa._getUniqueValues = function (C, G, L, P) {
                                                                var S = new k; C = C.replace(/\/*$/g, ""); L || (L = "1\x3d1"); S = /\/ImageServer$/gi.test(C);
                                                                var Y = -1 < C.indexOf("MapServer/dynamicLayer"); S || Y ? S = aa._getUniqueValuesByQueryTask(C, G, L) : (S = aa.getFieldInfoByFieldName(P.fields, G), S = 0 < aa.getCodedValuesOrTypesCount(S, P) ? aa._getUniqueValuesByQueryTask(C, G, L) : aa._getUniqueValuesByGenerateRenderer(C, G, L)); return S
                                                        }; aa.getCodedValuesOrTypesCount = function (C, G) { return C ? G.typeIdField && G.typeIdField.toUpperCase() === C.name.toUpperCase() && G.types ? G.types.length : (C = aa._getAllCodedValue(G, C)) ? C.length : 0 : 0 }; aa._getUniqueValuesByQueryTask = function (C, G, L) {
                                                                var P =
                                                                        new Q; P.where = L; P.returnDistinctValues = !0; P.returnGeometry = !1; P.outFields = [G]; return (new X(C)).execute(P).then(function (S) { var Y = []; S.features && 0 < S.features.length && q.forEach(S.features, function (ha) { ha && ha.attributes && Y.push(ha.attributes[G]) }); return Y })
                                                        }; aa._getUniqueValuesByGenerateRenderer = function (C, G, L) {
                                                                var P = new k, S = C.split("?"); C = 1 < S.length ? S[0].replace(/\/*$/g, "") + "/generateRenderer?" + S[1] : C.replace(/\/*$/g, "") + "/generateRenderer"; G = c.stringify({ type: "uniqueValueDef", uniqueValueFields: [G] });
                                                                K({ url: C, content: { classificationDef: G, f: "json", where: L }, handleAs: "json", callbackParamName: "callback" }).then(E.hitch(this, function (Y) { var ha = []; (Y = Y && Y.uniqueValueInfos) && 0 < Y.length && (ha = q.map(Y, E.hitch(this, function (ja) { return ja.value }))); P.resolve(ha) }), E.hitch(this, function (Y) { P.reject(Y) })); return P
                                                        }; aa.isCodedValuesSupportFilter = function (C, G) { C = C.currentVersion ? C : C.toJson().layerDefinition; var L = parseFloat(C.currentVersion); return G <= parseFloat(C.maxRecordCount) && 10.1 < L }; aa.combineRadioCheckBoxWithLabel =
                                                                function (C, G) { var L = !1; if (C && 1 === C.nodeType && "input" === C.tagName.toLowerCase()) { var P = C.getAttribute("type") || ""; P = P.toLowerCase(); if ("radio" === P || "checkbox" === P) L = !0 } P = !1; G && 1 === G.nodeType && "label" === G.tagName.toLowerCase() && (P = !0); L && P && (L = C.getAttribute("id"), L || (L = "input_" + aa.getRandomString(), C.setAttribute("id", L)), G.setAttribute("for", L), A.setStyle(G, "cursor", "pointer")) }; aa.groupRadios = function (C, G) {
                                                                        var L = [], P = "radiogroup_" + aa.getRandomString(); q.forEach(C, function (S) {
                                                                                S.name = P; G && (S = d(S, "change",
                                                                                        G), L.push(S))
                                                                        }); return L
                                                                }; aa.convertExtentToPolygon = function (C) { var G = C.xmin, L = C.xmax, P = C.ymin, S = C.ymax; return new H({ rings: [[[G, S], [L, S], [L, P], [G, P], [G, S]]], spatialReference: C.toJson() }) }; aa.combineGeometries = function (C) {
                                                                        function G(qa) { var V = { points: [], spatialReference: qa[0].spatialReference.toJson() }; q.forEach(qa, function (da) { "point" === da.type ? V.points = V.points.concat([[da.x, da.y]]) : "multipoint" === da.type && (V.points = V.points.concat(da.points)) }); return new y(V) } function L(qa) {
                                                                                var V = { paths: [], spatialReference: qa[0].spatialReference.toJson() };
                                                                                q.forEach(qa, function (da) { V.paths = V.paths.concat(da.paths) }); return new D(V)
                                                                        } function P(qa) { var V = { rings: [], spatialReference: qa[0].spatialReference.toJson() }; q.forEach(qa, function (da) { "polygon" === da.type ? V.rings = V.rings.concat(da.rings) : "extent" === da.type && (da = aa.convertExtentToPolygon(da), V.rings = V.rings.concat(da.rings)) }); return new H(V) } var S = null; if (C && 0 < C.length) if (1 === C.length) S = C[0]; else {
                                                                                for (var Y = null, ha = null, ja = null, ka = null, ua = 0; ua < C.length; ua++) {
                                                                                        Y = C[ua]; switch (Y.type) {
                                                                                                case "point": case "multipoint": ka =
                                                                                                        "point"; break; case "polyline": ka = "polyline"; break; case "polygon": case "extent": ka = "polygon"; break; default: return null
                                                                                        }if (0 === ua) ja = ka; else if (ja !== ka) return null; if (ua !== C.length - 1 && (ha = C[ua + 1], !Y.spatialReference.equals(ha.spatialReference))) return null
                                                                                } "point" === ka ? S = G(C) : "polyline" === ka ? S = L(C) : "polygon" === ka && (S = P(C))
                                                                        } return S
                                                                }; aa.combineGeometriesByGraphics = function (C) { var G = null; C && 0 < C.length && (C = q.map(C, function (L) { return L.geometry }), G = aa.combineGeometries(C)); return G }; aa.isFeaturelayerUrlSupportQuery =
                                                                        function (C, G) { var L = !1, P = /\/featureserver\//gi.test(C); C = /\/mapserver\//gi.test(C); G = (G || "").toLowerCase(); P ? L = 0 <= G.indexOf("query") : C && (L = 0 <= G.indexOf("data")); return L }; aa.isImageServiceSupportQuery = function (C) { return 0 <= (C || "").toLowerCase().indexOf("catalog") }; aa.isStringEndWith = function (C, G) { return C.lastIndexOf(G) + G.length === C.length }; aa._localizeNumber = function (C, G) {
                                                                                var L = (C.toString().split(".")[1] || "").length, P = ""; P = G && isFinite(G.places) && G.places; P = 0 < P || 0 < L ? "#,###,###,##0.0" + Array.prototype.join.call({
                                                                                        length: 0 <
                                                                                                P ? P + 1 : L
                                                                                }, "0") : "#,###,###,##0"; L = { locale: G && G.locale || m.locale, pattern: P }; E.mixin(L, G || {}); try { return b.format(C, L) } catch (S) { return console.error(S), C.toLocaleString() }
                                                                        }; aa.localizeNumber = function (C, G) { if (!aa.isNumberOrNumberString(C)) return C; C = Number(C); var L = !1; 0 > C && (L = !0, C = Math.abs(C)); C = aa._localizeNumber(C, G); L && (C = window.isRTL ? C + "-" : "-" + C); return C }; aa.isLocalizedNumber = function (C) { C = b.parse(C, { locale: m.locale }); return isNaN(C) ? !1 : !isNaN(parseFloat(C)) }; aa.parseNumberToUSENFormat = function (C) {
                                                                                var G =
                                                                                        b.parse(C, { locale: m.locale }); return isNaN(G) ? parseFloat(h.isDefined(C) && C.replace ? C.replace(",", ".") : C) : G
                                                                        }; aa.parseNumber = function (C, G) { var L = { locale: m.locale }; E.mixin(L, G || {}); try { return b.parse(C, L) } catch (P) { return console.error(P), C } }; aa.localizeDate = function (C, G) {
                                                                                var L = { locale: m.locale, fullYear: !0 }; E.mixin(L, G || {}); "ar" === m.locale && "long" !== L.formatLength && "full" !== L.formatLength && (L.formatLength = "long"); try { return e.format(C, L) } catch (P) {
                                                                                        return console.error(P), "date" === L.selector ? C.toLocaleDateString() :
                                                                                                "time" === L.selector ? C.toLocaleTimeString() : C.toLocaleString()
                                                                                }
                                                                        }; aa.localizeNumberByFieldInfo = function (C, G) { var L = null; L = E.exists("format.places", G) && G.format.places; L = aa.localizeNumber(C, { places: L }); return E.exists("format.digitSeparator", G) && !G.format.digitSeparator ? L.toString().replace(new RegExp("\\" + a.group, "g"), "") : L }; aa.localizeDateByFieldInfo = function (C, G) {
                                                                                var L = null; try {
                                                                                        var P = { date: C instanceof Date ? C.getTime() : C }, S = E.exists("format.dateFormat", G) ? G.format.dateFormat : "longMonthDayYear"; L =
                                                                                                h.substitute(P, "${date}", { dateFormat: { properties: ["date"], formatter: "DateFormat" + t.prototype._dateFormats[S] } })
                                                                                } catch (Y) { console.error(Y), L = C } return L
                                                                        }; aa.getDatePatternsByFormat = function (C) { return t.prototype._dateFormatsJson[C] }; aa.localizeDateTimeByFieldInfo = function (C, G, L, P) {
                                                                                var S = { h: "h", m: "h:mm", s: "h:mm:ss" }, Y = { h: "H", m: "H:mm", s: "H:mm:ss" }, ha = function (da, Z, ea) {
                                                                                        da = aa.getDatePatternsByFormat(da).datePattern; var la = S[Z]; la = ea || "h" === Z ? S[Z] + " a" : Y[Z]; return "(datePattern: '" + da + "', timePattern: '" +
                                                                                                la + "', selector: 'date and time')"
                                                                                }, ja, ka, ua = null; try { var qa = { date: C instanceof Date ? C.getTime() : C }; if (E.exists("format.dateFormat", G)) { var V = G.format.dateFormat; L ? ka = 0 < V.indexOf("Time") ? ha(V, P, 0 > V.indexOf("24")) : ha(V, P) : ja = V.split("ShortTime")[0].split("LongTime")[0] } else L ? ka = ha("longMonthDayYear", P) : ja = "longMonthDayYear"; ka = ka ? ka : t.prototype._dateFormats[ja]; ua = h.substitute(qa, "${date}", { dateFormat: { properties: ["date"], formatter: "DateFormat" + ka } }) } catch (da) { console.error(da), ua = C } return ua
                                                                        }; aa.getDateTimeStr =
                                                                                function (C, G) { G = G ? "YYYY-MM-DD HH:mm:ss" : "YYYY-MM-DD"; return p(C).format(G) }; aa.getDateByDateTimeStr = function (C) { return p(C).toDate() }; aa.getDateByDateTimeStrAndFormat = function (C, G) { C = aa.getDateByDateTimeStr(C); E.exists("format.dateFormat", G) && (G = G.format.dateFormat, 0 <= G.indexOf("ShortTime") ? C.setSeconds(0) : 0 > G.indexOf("Time") && (C.setHours(0), C.setMinutes(0), C.setSeconds(0))); return C }; aa.getDateTimeStrByFieldInfo = function (C, G) {
                                                                                        var L = "YYYY-MM-DD"; E.exists("format.dateFormat", G) && (G = G.format.dateFormat,
                                                                                                0 <= G.indexOf("LongTime") ? L += " HH:mm:ss" : 0 <= G.indexOf("ShortTime") && (L += " HH:mm")); return p(C).format(L)
                                                                                }; aa.fieldFormatter = {
                                                                                        getFormattedUrl: function (C) {
                                                                                                if (C && "string" === typeof C) {
                                                                                                        var G = C.indexOf("http:"); -1 === G && (G = C.indexOf("https:")); if (-1 < G && -1 === C.indexOf("href\x3d")) {
                                                                                                                var L = C.indexOf(" ", G); -1 === L && (L = C.length); var P = -1 < C.indexOf("\r\n", G) ? C.indexOf("\r\n", G) : -1 < C.indexOf("\n", G) ? C.indexOf("\n", G) : L; L = P < L ? P : L; P = C.substring(G, L); C = C.substring(0, G) + '\x3cA href\x3d"' + P + '" target\x3d"_blank"\x3e' +
                                                                                                                        P + "\x3c/A\x3e" + C.substring(L, C.length)
                                                                                                        }
                                                                                                } return null === C ? "" : C
                                                                                        }, getFormattedNumber: function (C, G) { if ("number" === typeof C) { var L = (C.toString().split(".")[1] || "").length; C = aa.localizeNumberByFieldInfo(C, { format: { places: G && "number" === typeof G.places ? parseInt(G.places, 10) : L, digitSeparator: G && G.digitSeparator } }); return '\x3cspan class\x3d"jimu-numeric-value"\x3e' + (C || "") + "\x3c/span\x3e" } return C }, getFormattedDate: function (C, G) {
                                                                                                if ("number" === typeof C || C instanceof Date) C = aa.localizeDateByFieldInfo(C, { format: G });
                                                                                                return C || ""
                                                                                        }, getCodedValue: function (C, G) { if (C && C.codedValues) { for (var L = 0, P = C.codedValues.length; L < P; L++) { var S = C.codedValues[L]; if (h.isDefined(G) && E.exists("code", S) && G.toString() === S.code.toString()) return S.name } return G } return G || null }, getTypeName: function (C, G) { for (var L = G.length, P = 0; P < L; P++)if (C === G[P].id) return G[P].name; return C }
                                                                                }; aa.addRelativePathInCss = xa; aa.url = {
                                                                                        isAbsolute: function (C) { return C ? C.startWith("http") || C.startWith("/") : !1 }, removeQueryParamFromUrl: function (C, G) {
                                                                                                C = ca.urlToObject(C);
                                                                                                C.query && delete C.query[G]; G = C.path; for (var L in C.query) G = G === C.path ? G + "?" + L + "\x3d" + C.query[L] : G + "\x26" + L + "\x3d" + C.query[L]; return G
                                                                                        }, addQueryParamToUrl: function (C, G, L) { C = ca.urlToObject(C); C.query || (C.query = {}); C.query[G] = L; G = C.path; for (var P in C.query) G = G === C.path ? G + "?" + P + "\x3d" + C.query[P] : G + "\x26" + P + "\x3d" + C.query[P]; return G }, compareUrl: function (C, G) {
                                                                                                C = this.getUrlPath(C); G = this.getUrlPath(G); C = fa.removeProtocol(C.toString().toLowerCase()).replace(/\/+/g, "/"); G = fa.removeProtocol(G.toString().toLowerCase()).replace(/\/+/g,
                                                                                                        "/"); return C === G
                                                                                        }, getUrlPath: function (C) { return ca.urlToObject(C).path }
                                                                                }; aa.processUrlInWidgetConfig = function (C, G) { if (C) return C.startWith("data:") || C.startWith("http") || C.startWith("/") ? C : C.startWith("${appPath}") ? C.replace("${appPath}", window.appInfo.appPath) : G + C }; aa.processUrlInAppConfig = function (C) { if (C) return C.startWith("data:") || C.startWith("http") || C.startWith("/") ? C : window.appInfo.appPath + C }; aa.getLocationUrlWithoutHashAndQueryParams = function () {
                                                                                        var C = window.location, G = C.protocol + "//" + C.host +
                                                                                                C.pathname; C = ca.urlToObject(C.href); C.query && C.query.apiurl && (G = aa.url.addQueryParamToUrl(G, "apiurl", C.query.apiurl)); return G
                                                                                }; aa.getDefaultWebMapThumbnail = function () { return require.toUrl("jimu/images/webmap.png") }; aa.invertColor = function (C) { C = C.substring(1); 3 === C.length && (C = C.slice(0, 1) + C.slice(0, 1) + C.slice(1, 1) + C.slice(1, 1) + C.slice(2, 1) + C.slice(2, 1)); C = parseInt(C, 16); return 7829367 < C ? "#000000" : "#ffffff" }; aa.isLightColor = function (C) {
                                                                                        C = C.substring(1); 3 === C.length && (C = C.slice(0, 1) + C.slice(0, 1) + C.slice(1,
                                                                                                1) + C.slice(1, 1) + C.slice(2, 1) + C.slice(2, 1)); C = parseInt(C, 16); return 7829367 < C ? !0 : !1
                                                                                }; aa.mixinAppConfigPosition = function (C, G) {
                                                                                        var L = E.clone(C); if (!G) return L; G = E.clone(G); var P = L.widgetOnScreen, S = G.widgetOnScreen; S && S.widgets && ("[object Object]" === Object.prototype.toString.call(S.widgets) ? q.forEach(P.widgets, function (Y, ha) { ha = Y.uri ? Y.uri : "ph_" + ha; S.widgets[ha] && S.widgets[ha].position && (S.widgets[ha].position.relativeTo || (S.widgets[ha].position.relativeTo = "map"), Y.position = S.widgets[ha].position) }, this) :
                                                                                                q.forEach(S.widgets, function (Y, ha) { Y.position && !Y.position.relativeTo && (Y.position.relativeTo = "map"); P.widgets[ha] && Y.position && (P.widgets[ha].position = Y.position) })); S && S.groups && ("[object Object]" === Object.prototype.toString.call(S.groups) ? q.forEach(P.groups, function (Y, ha) { ha = Y.label ? Y.label : "g_" + ha; S.groups[ha] && S.groups[ha].panel && S.groups[ha].panel.position && (S.groups[ha].panel.position.relativeTo || (S.groups[ha].panel.position.relativeTo = "map"), Y.panel.position = S.groups[ha].panel.position) },
                                                                                                        this) : (C = C.layoutDefinition ? C.layoutDefinition.manager : "jimu/layoutManagers/AbsolutePositionLayoutManager", "jimu/layoutManagers/AbsolutePositionLayoutManager" === C ? q.forEach(S.groups, function (Y, ha) { Y.panel && Y.panel.position && !Y.panel.position.relativeTo && (Y.panel.position.relativeTo = "map"); P.groups[ha] && Y.panel && Y.panel.position && (P.groups[ha].panel.position = Y.panel.position) }) : "jimu/layoutManagers/GridLayoutManager" === C && (P.groups = ra(P.groups, S.groups.map(function (Y) { return Y.id }))))); G.map && G.map.position &&
                                                                                                                (L.map ? L.map.position = G.map.position : L.map = { position: G.map.position }); G.widgetPool && G.widgetPool.panel && (G.widgetPool.panel.position && !G.widgetPool.panel.position.relativeTo && (G.widgetPool.panel.position.relativeTo = "map"), L.widgetPool.panel.position = G.widgetPool.panel.position); G.mobileLayout && (L.mobileLayout = G.mobileLayout); return L
                                                                                }; aa.handleGridLayoutOnScreenGroupChange = ra; aa.template = {
                                                                                        groupIdentification: "groups\\[.+\\]", widgetIdentification: "widgets\\[.+\\]", getSearchRange: function (C, G, L) {
                                                                                                var P =
                                                                                                        -1; G = C.search(new RegExp(G)); 0 <= G && (C = C.slice(G, C.length), C = C.indexOf(L), P = G + C + L.length); return { firstPos: G, lastPos: P }
                                                                                        }, setConfigValue: function (C, G, L) { sa(C, G, L) }, getConfigValue: function (C, G) { return sa(C, G) }, setConfigValueWithId: function (C, G, L) { wa(C, G, L) }, getConfigValueWithId: function (C, G) { return wa(C, G) }, getKeyInfo: function (C) { var G = this.getWidgetIdByKey(C); if (null !== G) return { type: "widget", id: G }; C = this.getGroupIdByKey(C); return null !== C ? { type: "group", id: C } : { type: "unknow", id: null } }, getWidgetIdByKey: function (C) {
                                                                                                var G =
                                                                                                        aa.template.getSearchRange(C, aa.template.widgetIdentification, "]"); if (-1 === G.firstPos) C = null; else { var L = C.slice(G.firstPos, G.lastPos); C = C.slice(G.firstPos + L.indexOf("[") + 1, G.lastPos - 1) } return C
                                                                                        }, getGroupIdByKey: function (C) { var G = aa.template.getSearchRange(C, aa.template.groupIdentification, "]"); if (-1 === G.firstPos) C = null; else { var L = C.slice(G.firstPos, G.lastPos); C = C.slice(G.firstPos + L.indexOf("[") + 1, G.lastPos - 1) } return C }, getConfigedWidgetsByTemplateConfig: function (C) {
                                                                                                var G = [], L = aa.template.widgetIdentification +
                                                                                                        "_config", P; q.forEach(C.configurationSettings, function (S) { q.forEach(S.fields, function (Y) { Y.fieldName && (P = aa.template.getSearchRange(Y.fieldName, L, "]"), 0 <= P.firstPos && (Y = aa.template.getWidgetIdByKey(Y.fieldName), -1 === G.indexOf(Y) && G.push(Y))) }, this) }, this); return G
                                                                                        }, mergeTemplateAppConfigToAppConfig: function (C, G, L) {
                                                                                                function P(ja) { var ka = []; q.forEach(ja, function (ua) { ua && ka.push(ua) }, this); return ka } var S = C.widgetOnScreen, Y = C.portalUrl; G.values.webmap && (C.map.itemId = G.values.webmap); L && (C.map.portalUrl =
                                                                                                        Y, G.values.app_title || (G.values.app_title = L.title), G.values.app_subtitle || (G.values.app_subtitle = L.snippet)); for (var ha in G.values) "webmap" !== ha && aa.template.setConfigValueWithId(C, ha, G.values[ha]); C.widgetPool.widgets = P(C.widgetPool.widgets); S.widgets = P(S.widgets); if (C.widgetPool.groups) for (G = 0; G < C.widgetPool.groups.length; G++)C.widgetPool.groups[G].widgets = P(C.widgetPool.groups[G].widgets); if (S.groups) for (G = 0; G < S.groups.length; G++)S.groups[G].widgets = P(S.groups[G].widgets); return C
                                                                                        }
                                                                                }; aa.deleteMapOptions =
                                                                                        function (C) { C && (delete C.extent, delete C.lods, delete C.center, delete C.scale, delete C.zoom, delete C.maxScale, delete C.maxZoom, delete C.minScale, delete C.minZoom) }; aa.sanitizeHTML = function (C) { return C ? html_sanitize(C, function (G) { return G }, function (G) { return G }) : C }; aa.stripHTML = function (C) { return C ? -1 < C.indexOf("\x3c") && -1 < C.indexOf("\x3e") ? C.replace(/<(?:.|\s)*?>/g, "") : C : C }; aa.encodeHTML = function (C) {
                                                                                                return String(C).replace(/&/g, "\x26amp;").replace(/</g, "\x26lt;").replace(/>/g, "\x26gt;").replace(/"/g,
                                                                                                        "\x26quot;").replace(/'/g, "\x26#39;")
                                                                                        }; aa.removeSuffixSlashes = function (C) { return C.replace(/\/*$/g, "") }; aa.getBestDisplayAttributes = function (C, G) { var L = {}, P = null, S; for (S in C) P = aa.getBestDisplayValue(S, C, G), L[S] = P; return L }; aa.getBestDisplayValue = function (C, G, L) {
                                                                                                var P = "", S = null; E.isArrayLike(L) ? S = aa.getFieldInfoByFieldName(L, C) : "object" === typeof L && L.name === C && (S = L); S && (P = G[C], "esriFieldTypeDate" === S.type ? P && (C = new Date(parseInt(P, 10)), P = aa._tryLocaleDate(C)) : "number" === typeof P && (S.domain && "codedValue" ===
                                                                                                        S.domain.type ? q.some(S.domain.codedValues, function (Y) { if (Y.code === P) return P = Y.name, !0 }) : P = aa._tryLocaleNumber(P))); if (null === P || void 0 === P) P = ""; return P
                                                                                        }; aa._getCodedValues = function (C) { var G = null; (C = C.domain) && "codedValue" === C.type && C.codedValues && 0 < C.codedValues.length && (G = C.codedValues, G = q.map(G, E.hitch(this, function (L) { return { value: L.code, label: L.name } }))); return G }; aa._getSubTypes = function (C) {
                                                                                                var G = null; C.subtypeField && C.subtypes && 0 < C.subtypes.length && (G = q.map(C.subtypes, E.hitch(this, function (L) {
                                                                                                        return {
                                                                                                                value: L.id,
                                                                                                                label: L.name
                                                                                                        }
                                                                                                }))); return G
                                                                                        }; aa._getRenderTypes = function (C) { var G = null; C.typeIdField && C.types && 0 < C.types.length && (G = q.map(C.types, E.hitch(this, function (L) { return { value: L.id, label: L.name } }))); return G }; aa._getCodedValueOrSubtypes = function (C, G, L) { var P = aa.getFieldInfoByFieldName(C.fields, G), S; return P ? S = void 0 !== L && null !== L ? aa._getCodedValueBySubTypeId(C, G, L, P) : aa._getAllCodedValue(C, P) : S }; aa._getDisplayValueForCodedValueOrSubtype = function (C, G, L, P) {
                                                                                                var S = { isCodedValueOrSubtype: !1, displayValue: L + "" };
                                                                                                (C = aa._getCodedValueOrSubtypes(C, G, P)) && 0 < C.length && q.some(C, E.hitch(this, function (Y) { return Y.value === L ? (S = { isCodedValueOrSubtype: !0, displayValue: Y.label }, !0) : !1 })); return S
                                                                                        }; aa._deleteSubtypePropertiesTemp = function (C) { delete C.subtypeField; delete C.subtypes }; aa.getDisplayValueForCodedValueOrSubtype = function (C, G, L) {
                                                                                                aa._deleteSubtypePropertiesTemp(C); var P = L[G], S, Y = C.typeIdField; L.hasOwnProperty(Y) && (S = L[Y]); (Y = C.subtypeField) && C.subtypes && 0 < C.subtypes.length && L.hasOwnProperty(Y) && (S = L[Y]); P = aa._getDisplayValueForCodedValueOrSubtype(C,
                                                                                                        G, P, S); C.typeIdField === G && (P.displayValue = aa._updateCodedValueListFromRender(C, [{ value: L[G], label: P.displayValue }])[0].label); return P
                                                                                        }; aa._getDisplayValueFromCodedValues = function (C, G) { var L = { isCodedValueOrSubtype: !1, displayValue: C + "" }; G && 0 < G.length && q.some(G, E.hitch(this, function (P) { return P.value === C ? (L = { isCodedValueOrSubtype: !0, displayValue: P.label }, !0) : !1 })); L.value = C; return L }; aa.getDisplayValueForCodedValueOrSubtypeBatch = function (C, G, L) {
                                                                                                aa._deleteSubtypePropertiesTemp(C); var P = {}, S = C.typeIdField,
                                                                                                        Y = C.subtypeField, ha = aa.getFieldInfoByFieldName(C.fields, G); Y && C.subtypes && 0 < C.subtypes.length ? (P.subType = aa._getSubTypes(C), S = Y, P.all = aa._getAllCodedValueNew(C, ha)) : (P.all = aa._getAllCodedValue(C, ha), P.subType = aa._getRenderTypes(C)); if (P.subType && 0 < P.subType.length) { Y = P.subType; for (var ja in Y) { var ka = Y[ja].value, ua = aa._getCodedValueBySubTypeId(C, G, ka, ha); P[ka] = C.typeIdField === G ? aa._updateCodedValueListFromRender(C, ua) : ua } } C.typeIdField === G && (P.subType = aa._updateCodedValueListFromRender(C, P.subType),
                                                                                                                P.all = aa._updateCodedValueListFromRender(C, P.all)); ka = []; ja = []; for (var qa in L) ka = L[qa], Y = ka[G], S === G ? ka = P.subType : ka.hasOwnProperty(S) ? (ka = ka[S], ka = P[ka], ka || (ka = aa._getCodedValues(ha), C.typeIdField === G && (ka = aa._updateCodedValueListFromRender(C, ka)))) : ka = P.all, Y = aa._getDisplayValueFromCodedValues(Y, ka), ja.push(Y); return ja
                                                                                        }; aa._getUniquCodedValue = function (C, G, L) { C[G] ? L !== C[G] && (C[G] = C[G] + ", " + L) : C[G] = L; return C }; aa._getAllCodedValue = function (C, G) {
                                                                                                var L = G.name, P = {}, S = null, Y = !0; if (C.typeIdField && C.types &&
                                                                                                        0 < C.types.length) q.map(C.types, E.hitch(this, function (ua) { ua.domains && ua.domains[L] && (ua = ua.domains[L], "inherited" === ua.type ? Y && (Y = !1, ua = aa._getCodedValues(G), q.map(ua, E.hitch(this, function (qa) { P = aa._getUniquCodedValue(P, qa.value, qa.label) }))) : ua.codedValues && 0 < ua.codedValues.length && q.map(ua.codedValues, E.hitch(this, function (qa) { P = aa._getUniquCodedValue(P, qa.code, qa.name) }))) })), S || (S = aa._getCodedValues(G)); else return this._getCodedValues(G); C = []; var ha = aa.isNumberField(G.type), ja; for (ja in P) {
                                                                                                                var ka =
                                                                                                                        ha ? parseFloat(ja) : ja; C.push({ value: ka, label: P[ja] })
                                                                                                        } 0 < C.length && (S = C); return S
                                                                                        }; aa._getAllCodedValueNew = function (C, G) {
                                                                                                var L = G.name, P = {}, S = null, Y = !0; if (C.subtypeField && C.subtypes && 0 < C.subtypes.length) q.map(C.subtypes, E.hitch(this, function (ua) {
                                                                                                        ua.domains && ua.domains[L] && (ua = ua.domains[L], "inherited" === ua.type ? Y && (Y = !1, ua = aa._getCodedValues(G), q.map(ua, E.hitch(this, function (qa) { P = aa._getUniquCodedValue(P, qa.value, qa.label) }))) : ua.codedValues && 0 < ua.codedValues.length && q.map(ua.codedValues, E.hitch(this,
                                                                                                                function (qa) { P = aa._getUniquCodedValue(P, qa.code, qa.name) })))
                                                                                                })), S || (S = aa._getCodedValues(G)); else return this._getCodedValues(G); C = []; var ha = aa.isNumberField(G.type), ja; for (ja in P) { var ka = ha ? parseFloat(ja) : ja; C.push({ value: ka, label: P[ja] }) } 0 < C.length && (S = C); return S
                                                                                        }; aa._getCodedValueBySubTypeId = function (C, G, L, P) {
                                                                                                var S = "typeIdField", Y = "types"; C.subtypeField && C.subtypes && 0 < C.subtypes.length && (S = "subtypeField", Y = "subtypes"); var ha = null; P = P ? P : aa.getFieldInfoByFieldName(C.fields, G); if (!P) return ha; C[S] &&
                                                                                                        C[Y] && 0 < C[Y].length ? (q.map(C[Y], E.hitch(this, function (ja) { if (ja.id === L) { if (G === C[S]) return ha = [{ value: ja.id, label: ja.name }], !0; ja.domains && ja.domains[G] ? (ja = ja.domains[G], "inherited" === ja.type ? ha = aa._getCodedValues(P) : ja.codedValues && 0 < ja.codedValues.length && (ha = q.map(ja.codedValues, E.hitch(this, function (ka) { return { value: ka.code, label: ka.name } })))) : ja.domains && (ha = aa._getCodedValues(P)) } })), ha || (ha = aa._getCodedValues(P))) : ha = aa._getCodedValues(P); return ha
                                                                                        }; aa.getCodedValueListForCodedValueOrSubTypes =
                                                                                                function (C, G, L) {
                                                                                                        aa._deleteSubtypePropertiesTemp(C); var P = null; P = aa.getFieldInfoByFieldName(C.fields, G); if (L) { var S = L[C.typeIdField]; var Y = L[C.subtypeField] } if (C.subtypeField && C.subtypes && 0 < C.subtypes.length) return G === C.subtypeField ? (P = aa._getSubTypes(C), void 0 !== Y && (L = aa._getDisplayValueFromCodedValues(Y, P), P = [{ value: L.value, label: L.displayValue }])) : P = void 0 === Y ? aa._getAllCodedValueNew(C, P) : aa._getCodedValueBySubTypeId(C, G, Y, P), G === C.typeIdField && (P = aa._updateCodedValueListFromRender(C, P)), P; C.subtypeField =
                                                                                                                ""; C.subtypes = []; C.typeIdField && C.typeIdField.toUpperCase() === G.toUpperCase() ? (P = aa._getRenderTypes(C), L && void 0 !== S && null !== S && (L = aa._getDisplayValueFromCodedValues(S, P), P = [{ value: L.value, label: L.displayValue }])) : P = L && void 0 !== S && null !== S ? aa._getCodedValueBySubTypeId(C, G, S, P) : aa._getAllCodedValue(C, P); G === C.typeIdField && (P = aa._updateCodedValueListFromRender(C, P)); return P
                                                                                                }; aa._verifyIfFieldIsSubtypeField = function (C, G) {
                                                                                                        var L = { isSubtypeField: !1, subtypeField: "" }; if (C.subtypeField) return L = {
                                                                                                                isSubtypeField: C.subtypeField ===
                                                                                                                        G.name, subtypeField: C.subtypeField
                                                                                                        };["esriFieldTypeSmallInteger", "esriFieldTypeInteger"].indexOf(G.type) && C.typeIdField === G.name && C.types && 0 < C.types.length && (void 0 === C.types[0].domains[G.name] ? L = { isSubtypeField: !0, subtypeField: G.name } : L.isSubtypeField = !1); return !1
                                                                                                }; aa.getUniqueRendererByLayerDefinition = function (C) { var G = null; C.drawingInfo && C.drawingInfo.renderer && "uniqueValue" === C.drawingInfo.renderer.type && (G = C.drawingInfo.renderer); return G }; aa.isUniqueReneredByLayerObject = function (C, G) {
                                                                                                        return "uniqueValue" ===
                                                                                                                C.type && G && G.field1 === C.field1
                                                                                                }; aa._getRenderValueLabelsForUnique = function (C) { var G = null, L = null, P = aa.getUniqueRendererByLayerDefinition(C); P ? (G = {}, L = P.uniqueValueInfos) : C.renderer && (P = C.toJson().layerDefinition, P = aa.getUniqueRendererByLayerDefinition(P), C = C.renderer.toJson(), aa.isUniqueReneredByLayerObject(C, P) ? (G = {}, L = C.uniqueValueInfos) : P && (G = {}, L = P.uniqueValueInfos)); if (L) for (C = 0; C < L.length; C++)P = L[C], G[P.value] = P.label; return G }; aa._updateCodedValueListFromRender = function (C, G) {
                                                                                                        if ((C = aa._getRenderValueLabelsForUnique(C)) &&
                                                                                                                G) for (var L = 0; L < G.length; L++) { var P = G[L]; C[P.value] && (P.label = C[P.value]) } return G
                                                                                                }; aa.getDefaultPortalFieldInfo = function (C) { var G = C.name; G = { fieldName: G, label: C.alias || G, tooltip: "", visible: !1, format: null, stringFieldOption: "textbox" }; switch (C.type) { case "esriFieldTypeSmallInteger": case "esriFieldTypeInteger": G.format = { places: 0, digitSeparator: !0 }; break; case "esriFieldTypeSingle": case "esriFieldTypeDouble": G.format = { places: 2, digitSeparator: !0 }; break; case "esriFieldTypeDate": G.format = { dateFormat: "longMonthDayYear" } }return G };
                                        aa.getDefaultPopupInfo = function (C, G, L) { var P = null; C && C.fields && (P = { title: G, fieldInfos: [], description: null, showAttachments: !0, mediaInfos: [] }, q.forEach(C.fields, function (S) { var Y = !1; L ? q.some(L, E.hitch(this, function (ha) { return ha && S.name.toLowerCase() === ha.toLowerCase() })) && (Y = !0) : Y = !0; Y && (Y = this.getDefaultPortalFieldInfo(S), Y.visible = !0, Y.isEditable = S.editable, P.fieldInfos.push(Y)) }, this)); return P }; aa._tryLocaleNumber = function (C) { var G = aa.localizeNumber(C); if (null === G || void 0 === G) G = C; return G }; aa._tryLocaleDate =
                                                function (C) { var G = aa.localizeDate(C); G || (G = C.toLocaleDateString()); return G }; aa.getFieldInfoByFieldName = function (C, G) { var L = null; C && 0 < C.length && q.some(C, E.hitch(this, function (P) { return P.name === G ? (L = P, !0) : !1 })); return L }; aa.getDateFieldFormatByFieldName = function (C, G) { if (C && 0 < C.length) for (var L = 0; L < C.length; L++) { var P = C[L]; if (P.fieldName === G) { if (P.format && P.format.dateFormat) return P.format.dateFormat; break } } return "" }; aa.completePopupFieldFromLayerField = function (C, G) {
                                                        if (!G) return C; for (var L in C) {
                                                                var P =
                                                                        C[L].name, S = !1, Y; for (Y in G) if (G[Y].fieldName === P) { S = !0; break } S || (P = aa.getPopupFieldFromLayerField(C[L]), G.push(P))
                                                        } return G
                                                }; aa.getPopupFieldFromLayerField = function (C) { return { fieldName: C.name, isEditable: C.editable, label: C.alias, visible: C.visible ? C.visible : !1, stringFieldOption: "esriFieldTypeString" === C.type ? "textbox" : null, tooltips: "", domain: C.domain ? C.domain : null } }; aa.containsNonLatinCharacter = function (C) { for (var G = 0; G < C.length; G++)if (255 < C.charCodeAt(G)) return !0; return !1 }; aa.has = function (C) {
                                                        var G =
                                                                w(C); if (G) return G; if ("ie" === C.toLowerCase()) { C = 0; var L = /MSIE (\d+\.\d+);/.test(navigator.userAgent), P = !!navigator.userAgent.match(/Trident\/7.0/), S = navigator.userAgent.indexOf("rv:11.0"); L && (C = Number(RegExp.$1)); -1 !== navigator.appVersion.indexOf("MSIE 10") && (C = 10); P && -1 !== S && (C = 11); return 11 === C && 11 || G } if ("edge" === C.toLowerCase()) return navigator.userAgent.split("Edge/")[1] || G
                                                }; aa.detectUserAgent = function () { return window.userAgent }; aa.isMobileUa = function () { return window.isMobileUa }; aa.inMobileSize =
                                                        function () { var C = A.getMarginBox(document.body); if (C.w <= window.jimuConfig.breakPoints[0] || C.h <= window.jimuConfig.breakPoints[0]) return A.addClass(window.jimuConfig.layoutId, "jimu-ismobile"), !0; A.removeClass(window.jimuConfig.layoutId, "jimu-ismobile"); return !1 }; aa.getObjectIdField = function (C) { if (C.objectIdField) return C.objectIdField; C = C.fields; for (var G = 0; G < C.length; G++) { var L = C[G]; if ("esriFieldTypeOID" === L.type) return L.name } return null }; aa.isNeedHttpsButNot = function () {
                                                                var C = navigator.geolocation,
                                                                G = window.hasOwnProperty("isSecureContext"); return (G && window.isSecureContext || !G && "https:" === window.location.protocol) && C ? !1 : !0
                                                        }; aa.toFeatureSet = function (C) {
                                                                var G = new M; "[object Object]" === Object.prototype.toString.call(C) && (C = [C]); G.features = C; if (0 < C.length) {
                                                                        var L; q.some(C, function (S) { if (S.geometry) return L = S, !0 }); if (L) {
                                                                                C = L.getLayer(); var P = {}; C && (G.displayFieldName = C.displayField, q.forEach(C.fields, E.hitch(this, function (S) { var Y = S.name; P[Y] = S.alias || Y })), G.fieldAliases = P); G.geometryType = L.geometry.type;
                                                                                G.spatialReference = L.geometry.spatialReference
                                                                        }
                                                                } return G
                                                        }; aa.showValidationErrorTipForFormDijit = function (C) { try { !C.validate() && C.domNode && C.focusNode && (C.focusNode.focus(), setTimeout(E.hitch(this, function () { C.focusNode.blur() }), 100)) } catch (G) { console.error(G) } }; aa.getFeatureLayerDefinition = function (C) { var G = null, L = C.graphics; C.graphics = []; var P = C.toJson(); C.graphics = L; P && (G = P.layerDefinition); return G }; aa.simulateClickEvent = function (C) {
                                                                if (w("safari")) {
                                                                        var G = document.createEvent("MouseEvents"); G.initEvent("click",
                                                                                !0, !0); C.dispatchEvent(G)
                                                                } else C.click()
                                                        }; aa.getFeatureSetByLayerAndFeatures = function (C, G) { var L = new M; L.fields = E.clone(C.fields); L.features = G; L.geometryType = C.geometryType; L.fieldAliases = {}; q.forEach(L.fields, E.hitch(this, function (P) { var S = P.name; L.fieldAliases[S] = P.alias || S })); return L }; aa.featureAction = function () {
                                                                return {
                                                                        zoomTo: function (C, G, L) {
                                                                                L || (L = {}); if (C && G && 0 < G.length) {
                                                                                        var P = q.every(G, function (S) { return S && S.spatialReference && S.type }); if (q.every(G, function (S) {
                                                                                                return S && S.geometry && S.geometry.spatialReference &&
                                                                                                        S.geometry.type
                                                                                        }) || P) P && (G = q.map(G, function (S) { return { geometry: S } })), aa.zoomToFeatureSet(C, { features: G }, L.extentFactor)
                                                                                }
                                                                        }, flash: function (C, G) {
                                                                                function L(ka, ua) { q.forEach(S, function (qa, V) { qa.setSymbol(ua ? ka : Y[V] || ha) }) } function P(ka) { return function () { setTimeout(function () { L(ja, !0); S[0] && G && G.redraw(); setTimeout(function () { L(null, !1); S[0] && G && G.redraw(); ka() }, 200) }, 200) } } if (q.every(C || [], function (ka) { return ka && ka.geometry })) {
                                                                                        var S = C; C = S[0]; var Y = q.map(S, function (ka) { return ka.symbol }), ha = C.symbol ||
                                                                                                E.getObject("renderer.symbol", !1, G), ja = null; G && "esriGeometryPoint" === G.geometryType ? ja = new R(require.toUrl("jimu") + "/images/flash.gif", 20, 20) : (ja = E.clone(ha)) && (ja.outline ? ja.outline.setColor("#ffc500") : ja.setColor("#ffc500")); C && ha && ja && G && ("esriGeometryPoint" === G.geometryType ? (L(ja, !0), G.redraw(), setTimeout(function () { L(null, !1); G.redraw() }, 2E3)) : P(P(P(function () { })))())
                                                                                }
                                                                        }, panTo: function (C, G) {
                                                                                q.every(G || [], function (L) { return L && L.geometry }) && (0 < G.length ? G = W.graphicsExtent(G).getCenter() : (G = G[0].geometry,
                                                                                        G = "polyline" === G.type || "polygon" === G.type ? G.getExtent().getCenter() : "extent" === G.type ? G.getCenter() : "multipoint" === G.type ? 1 < G.points.length ? G.getExtent().getCenter() : G.getPoint(0) : G), C.centerAt(G))
                                                                        }, showPopup: function (C, G) { q.every(G || [], function (L) { return L && L.geometry }) && (C = C.infoWindow, C.setFeatures(G), G = G[0], "point" === G.geometry.type ? C.show(G.geometry, { closetFirst: !0 }) : C.show(G.geometry.getExtent().getCenter(), { closetFirst: !0 })) }
                                                                }
                                                        }(); aa.isInConfigOrPreviewWindow = function () {
                                                                var C = !1; try {
                                                                        C = !window.isBuilder &&
                                                                        window.parent && window.parent !== window && window.parent.isBuilder
                                                                } catch (G) { C = !1 } return !!C
                                                        }; aa.getAppHref = function () { var C = ""; return C = aa.isInConfigOrPreviewWindow() ? window.parent.location.href : window.location.href }; aa.getAppIdFromUrl = function () {
                                                                var C = !0, G = aa.getAppHref(); if (-1 !== G.indexOf("id\x3d") || -1 !== G.indexOf("appid\x3d") || -1 !== G.indexOf("apps")) C = !1; if (!0 === C) return G; C = this.urlToObject(window.location.href); if (C.query && (C.query.id || C.query.appid)) return C.query.id || C.query.appid; if (window.appInfo) {
                                                                        if (window.appInfo.id) return window.appInfo.id;
                                                                        if (window.appInfo.appPath) { if (C = window.appInfo.appPath.split("/"), C.length && 2 < C.length) return C[C.length - 2] } else console.error("CAN NOT getAppIdFromUrl")
                                                                }
                                                        }; aa.getEditorContentHeight = function (C, G, L) {
                                                                var P = new k; this._content = C; this._dom = G; this._domParam = L; var S = setTimeout(E.hitch(this, function () {
                                                                        clearTimeout(S); S = null; var Y = 0, ha = this._domParam.contentWidth; try {
                                                                                var ja = document.createElement("div"); ja.setAttribute("id", "fakeContent"); A.setStyle(ja, "background-size", "contain"); ja.innerHTML = this._content;
                                                                                this._dom.appendChild(ja); if (ja) { var ka = r("img", ja); ka && ka.length && ka.style({ maxWidth: ha - 20 + "px" }); A.setStyle(ja, "position", "absolute"); A.setStyle(ja, "width", ha + "px"); A.setStyle(ja, "left", "-99999px"); A.setStyle(ja, "top", "-99999px"); A.setStyle(ja, "visibility", "hidden"); var ua = A.getContentBox(ja); ua.h && (Y = ua.h, Y += this._domParam.contentMarginTop + this._domParam.footerHeight + 8) }
                                                                        } catch (qa) { console.error("can't getEditorContentHeight" + qa), Y = 200 } P.resolve(Y)
                                                                }), 1500); return P
                                                        }; aa.getBase64Data = function (C) {
                                                                var G =
                                                                        new k; if (C && C.startWith("data:image")) G.resolve(C); else try { K({ url: C, handleAs: "arraybuffer" }).then(function (L) { var P = new FileReader; P.onloadend = function () { G.resolve(P.result) }; P.onerror = function () { G.resolve(null) }; P.readAsDataURL(new Blob([L], { type: "image/png" })) }, function () { G.resolve(null) }) } catch (L) { console.warn(L), G.resolve(null) } return G
                                                        }; aa.getEditorTextColor = function (C, G) { return { name: "dijit.editor.plugins.EditorTextColor", custom: { recordUID: aa.getColorRecordName(C), forceAttr: G } } }; aa.getEditorBackgroundColor =
                                                                function (C) { return { name: "dijit.editor.plugins.EditorBackgroundColor", custom: { recordUID: aa.getColorRecordName(C) } } }; aa.getColorRecordName = function (C) { return "wab_cr_" + (C || "") }; aa.b64toBlob = function (C, G, L) { G = G || ""; L = L || 512; C = window.atob(C.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/, "")); for (var P = [], S = 0; S < C.length; S += L) { for (var Y = C.slice(S, S + L), ha = Array(Y.length), ja = 0; ja < Y.length; ja++)ha[ja] = Y.charCodeAt(ja); Y = new Uint8Array(ha); P.push(Y) } return new Blob(P, { type: G }) }; aa.subtractionArray = function (C,
                                                                        G) { for (var L = C.length - 1; 0 <= L; L--)for (var P = C[L], S = G.length - 1; 0 <= S; S--)if (P === G[S]) { C.splice(L, 1); G.splice(S, 1); break } return C }; aa.resourcesUrlToBlob = function (C) { return K({ url: C, handleAs: "blob" }) }; aa.processItemResourceOfAppConfig = function (C, G) {
                                                                                function L(ka) { var ua = ka.obj, qa = ka.key, V = { obj: ua, key: qa }; "number" === typeof ka.i ? (V.i = ka.i, V.value = ua[qa][ka.i]) : V.value = ua[qa]; return V } function P(ka) {
                                                                                        for (var ua in ka) if ("object" === typeof ka[ua]) if (Array.isArray(ka[ua])) for (var qa = ka, V = ua, da = 0; da < qa[V].length; da++)"string" ===
                                                                                                typeof qa[V][da] ? S(qa, V, da) : "object" === typeof qa[V][da] && P(qa[V][da]); else P(ka[ua]); else "string" === typeof ka[ua] && S(ka, ua)
                                                                                } function S(ka, ua, qa) { "number" === typeof qa ? G.test(ka[ua][qa]) && (ja = G.func(L({ obj: ka, key: ua, i: qa })), "function" === typeof ja.then ? ha.push(ja) : Y.push(ja)) : G.test(ka[ua]) && (ja = G.func(L({ obj: ka, key: ua })), "function" === typeof ja.then ? ha.push(ja) : Y.push(ja)) } var Y = [], ha = [], ja; P(C); return 0 < ha.length ? n(ha).then(function (ka) { 0 < Y.length && (ka = ka.concat(Y)); return { appConfig: C, result: ka } }) :
                                                                                        { appConfig: C, result: Y }
                                                                        }; aa.isEsriDomain = function (C) { return /^https?:\/\/(?:[\w\-_]+\.)+(?:esri|arcgis)\.com/.test(C) }; aa.uniqueArray = function (C) { for (var G = [], L = 0; L < C.length; L++)-1 === G.indexOf(C[L]) && G.push(C[L]); return G }; aa.isNotEmptyObject = function (C, G) { return G ? aa.isObject(C) && 0 < Object.keys(C).length && Array.isArray(C) : aa.isObject(C) && 0 < Object.keys(C).length }; aa.getMinOfArray = function (C) { return Number(Math.min.apply(Math, C)) }; aa.getDataSchemaFromLayerDefinition = function (C) {
                                                                                var G = C.fields.filter(function (L) {
                                                                                        return "esriFieldTypeOID" ===
                                                                                                L.type
                                                                                }); G = 0 < G.length ? G[0] : null; return { geometryType: C.geometryType, fields: C.fields, displayField: C.displayField, objectIdField: G, typeIdField: C.typeIdField }
                                                                        }; aa.isValidPointGeometry = function (C) { return C && "point" === C.type && aa.isTrueOrZero(C.x) && aa.isTrueOrZero(C.y) }; aa.isVaildPointGeometry = aa.isValidPointGeometry; aa.isNumberOrNumberString = function (C) { return /^-?[1-9]\d*$/.test(C) || /^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$/.test(C) }; aa.convertNumberToPercentage = function (C, G, L) {
                                                                                if (!aa.isNumberOrNumberString(C)) return C;
                                                                                "undefined" === typeof L && (L = !0); "undefined" === typeof G && (G = 2); G = { format: { places: G, digitSeparator: L } }; L = m.locale; L = "ar" === L || "tr" === L; C = Number(C); var P = !1; 0 > C && (P = !0, C = Math.abs(C)); C = aa.localizeNumberByFieldInfo(100 * C, G); C = L ? "%" + C : C + "%"; P && (C = window.isRTL ? C + "-" : "-" + C); return C
                                                                        }; aa.getClientFeaturesFromMap = function (C, G, L, P) {
                                                                                var S = [], Y = !1; if (G) {
                                                                                        L ? 0 < G.getSelectedFeatures().length ? (S = G.getSelectedFeatures(), Y = !0) : S = G.graphics : S = G.graphics; P && (S = aa.filterFeaturesByExtent(C.extent, S)); if (S && 0 < S.length) {
                                                                                                var ha =
                                                                                                        aa.getObjectIdField(G); ha && (C = S[0]) && C.attributes && C.attributes.hasOwnProperty(ha) && S.sort(function (ja, ka) { ja.attributes || (ja.attributes = {}); ka.attributes || (ka.attributes = {}); ja = ja.attributes[ha]; ka = ka.attributes[ha]; return ja < ka ? -1 : ja > ka ? 1 : 0 })
                                                                                        } S.isSelectedFeatures = Y; return S
                                                                                }
                                                                        }; aa.filterFeaturesByExtent = function (C, G) {
                                                                                var L = C.normalize(); return G = q.filter(G, E.hitch(this, function (P) {
                                                                                        try {
                                                                                                if (P.geometry) {
                                                                                                        var S = "point" === P.geometry.type || "multipoint" === P.geometry; return q.some(L, E.hitch(this, function (Y) {
                                                                                                                return S ?
                                                                                                                        Y.contains(P.geometry) : x.intersects(Y, P.geometry)
                                                                                                        }))
                                                                                                }
                                                                                        } catch (Y) { console.error(Y) } return !1
                                                                                }))
                                                                        }; aa.upperCaseString = function (C) { return C && "string" === typeof C ? C.toUpperCase() : C }; aa.lowerCaseString = function (C) { return C && "string" === typeof C ? C.toLowerCase() : C }; aa.getSubstituteString = function (C, G) { return h.substitute({ value: C }, G) }; aa.getUUID = function () { function C() { return (65536 * (1 + Math.random()) | 0).toString(16).substring(1) } return C() + C() + "_" + C() + "_" + C() + "_" + C() + "_" + C() + C() + C() }; aa.getStyleColorInTheme = function (C) {
                                                                                var G =
                                                                                        new k; if (window && window.isBuilder) { var L = "./stemapp/themes/"; var P = window.appConfig } else L = "./themes/", P = window.getAppConfig(); if (P && P.theme.customStyles && P.theme.customStyles.mainBackgroundColor) return G.resolve(P.theme.customStyles.mainBackgroundColor), G.promise; var S = P.theme.name, Y = P.theme.styles[0]; C && (Y = C); K({ url: L + S + "/manifest.json", handleAs: "json" }).then(E.hitch(this, function (ha) { if (ha && ha.styles) { ha = ha.styles; for (var ja = 0; ja < ha.length; ja++) { var ka = ha[ja]; ka.name === Y && G.resolve(ka.styleColor) } } }),
                                                                                                E.hitch(this, function (ha) { console.error(ha); G.reject(null) })); return G.promise
                                                                        }; aa.themesHeaderLogoA11y = function (C, G, L) {
                                                                                C.logoLink ? (A.setAttr(L.link, "href", C.logoLink), A.setAttr(L.link, "tabIndex", G), A.setAttr(L.link, "target", "_blank"), A.setAttr(L.logo, "alt", C.logoLink), A.setStyle(L.icon, "cursor", "pointer")) : (A.setAttr(L.link, "href", "javascript:void(0)"), A.setAttr(L.link, "tabIndex", -1), A.setAttr(L.link, "target", ""), A.removeAttr(L.logo, "alt"), A.setAttr(L.logo, "role", "presentation"), A.setStyle(L.icon,
                                                                                        "cursor", "default")); C.logoAlt && A.setAttr(L.logo, "alt", C.logoAlt)
                                                                        }; return aa
                                })
                }, "dojo/NodeList-traverse": function () {
                        define(["./query", "./_base/lang", "./_base/array"], function (E, q, A) {
                                var w = E.NodeList; q.extend(w, {
                                        _buildArrayFromCallback: function (m) { for (var v = [], r = 0; r < this.length; r++) { var l = m.call(this[r], this[r], v); l && (v = v.concat(l)) } return v }, _getUniqueAsNodeList: function (m) { for (var v = [], r = 0, l; l = m[r]; r++)1 == l.nodeType && -1 == A.indexOf(v, l) && v.push(l); return this._wrap(v, null, this._NodeListCtor) }, _getUniqueNodeListWithParent: function (m,
                                                v) { m = this._getUniqueAsNodeList(m); m = v ? E._filterResult(m, v) : m; return m._stash(this) }, _getRelatedUniqueNodes: function (m, v) { return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(v), m) }, children: function (m) { return this._getRelatedUniqueNodes(m, function (v, r) { return q._toArray(v.childNodes) }) }, closest: function (m, v) { return this._getRelatedUniqueNodes(null, function (r, l) { do if (E._filterResult([r], m, v).length) return r; while (r != v && (r = r.parentNode) && 1 == r.nodeType); return null }) }, parent: function (m) {
                                                        return this._getRelatedUniqueNodes(m,
                                                                function (v, r) { return v.parentNode })
                                                }, parents: function (m) { return this._getRelatedUniqueNodes(m, function (v, r) { for (r = []; v.parentNode;)v = v.parentNode, r.push(v); return r }) }, siblings: function (m) { return this._getRelatedUniqueNodes(m, function (v, r) { r = []; for (var l = v.parentNode && v.parentNode.childNodes, k = 0; k < l.length; k++)l[k] != v && r.push(l[k]); return r }) }, next: function (m) { return this._getRelatedUniqueNodes(m, function (v, r) { for (v = v.nextSibling; v && 1 != v.nodeType;)v = v.nextSibling; return v }) }, nextAll: function (m) {
                                                        return this._getRelatedUniqueNodes(m,
                                                                function (v, r) { for (r = []; v = v.nextSibling;)1 == v.nodeType && r.push(v); return r })
                                                }, prev: function (m) { return this._getRelatedUniqueNodes(m, function (v, r) { for (v = v.previousSibling; v && 1 != v.nodeType;)v = v.previousSibling; return v }) }, prevAll: function (m) { return this._getRelatedUniqueNodes(m, function (v, r) { for (r = []; v = v.previousSibling;)1 == v.nodeType && r.push(v); return r }) }, andSelf: function () { return this.concat(this._parent) }, first: function () { return this._wrap(this[0] && [this[0]] || [], this) }, last: function () {
                                                        return this._wrap(this.length ?
                                                                [this[this.length - 1]] : [], this)
                                                }, even: function () { return this.filter(function (m, v) { return 0 != v % 2 }) }, odd: function () { return this.filter(function (m, v) { return 0 == v % 2 }) }
                                }); return w
                        })
                }, "dojo/cookie": function () {
                        define(["./_base/kernel", "./regexp"], function (E, q) {
                                E.cookie = function (A, w, m) {
                                        var v = document.cookie; if (1 == arguments.length) var r = (r = v.match(new RegExp("(?:^|; )" + q.escapeString(A) + "\x3d([^;]*)"))) ? decodeURIComponent(r[1]) : void 0; else {
                                                m = m || {}; v = m.expires; if ("number" == typeof v) {
                                                        var l = new Date; l.setTime(l.getTime() +
                                                                864E5 * v); v = m.expires = l
                                                } v && v.toUTCString && (m.expires = v.toUTCString()); w = encodeURIComponent(w); v = A + "\x3d" + w; for (var k in m) v += "; " + k, l = m[k], !0 !== l && (v += "\x3d" + l); document.cookie = v
                                        } return r
                                }; E.cookie.isSupported = function () { "cookieEnabled" in navigator || (this("__djCookieTest__", "CookiesAllowed"), navigator.cookieEnabled = "CookiesAllowed" == this("__djCookieTest__"), navigator.cookieEnabled && this("__djCookieTest__", "", { expires: -1 })); return navigator.cookieEnabled }; return E.cookie
                        })
                }, "dojox/encoding/base64": function () {
                        define(["dojo/_base/lang"],
                                function (E) {
                                        E = E.getObject("dojox.encoding.base64", !0); E.encode = function (q) {
                                                var A = [], w = q.length, m = w % 3; w -= m; for (var v = 0; v < w;) {
                                                        var r = q[v++] << 16 | q[v++] << 8 | q[v++]; A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 18 & 63)); A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 12 & 63)); A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 6 & 63)); A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r &
                                                                63))
                                                } switch (m) {
                                                        case 2: r = q[v++] << 16 | q[v++] << 8; A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 18 & 63)); A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 12 & 63)); A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 6 & 63)); A.push("\x3d"); break; case 1: r = q[v++] << 16, A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>> 18 & 63)), A.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r >>>
                                                                12 & 63)), A.push("\x3d"), A.push("\x3d")
                                                }return A.join("")
                                        }; E.decode = function (q) {
                                                q = q.split(""); for (var A = [], w = q.length; "\x3d" == q[--w];); for (var m = 0; m < w;) {
                                                        var v = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(q[m++]) << 18; m <= w && (v |= "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(q[m++]) << 12); m <= w && (v |= "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(q[m++]) << 6); m <= w && (v |= "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(q[m++]));
                                                        A.push(v >>> 16 & 255); A.push(v >>> 8 & 255); A.push(v & 255)
                                                } for (; 0 == A[A.length - 1];)A.pop(); return A
                                        }; return E
                                })
                }, "moment/moment": function () {
                        (function (E, q) { "object" === typeof exports && "undefined" !== typeof module ? module.exports = q() : "function" === typeof define && define.amd ? define(q) : E.moment = q() })(this, function () {
                                function E() { return Dc.apply(null, arguments) } function q(F) { return F instanceof Array || "[object Array]" === Object.prototype.toString.call(F) } function A(F) { return null != F && "[object Object]" === Object.prototype.toString.call(F) }
                                function w(F, J) { return Object.prototype.hasOwnProperty.call(F, J) } function m(F) { if (Object.getOwnPropertyNames) return 0 === Object.getOwnPropertyNames(F).length; for (var J in F) if (w(F, J)) return !1; return !0 } function v(F) { return void 0 === F } function r(F) { return "number" === typeof F || "[object Number]" === Object.prototype.toString.call(F) } function l(F) { return F instanceof Date || "[object Date]" === Object.prototype.toString.call(F) } function k(F, J) { var U = [], ba, pa = F.length; for (ba = 0; ba < pa; ++ba)U.push(J(F[ba], ba)); return U }
                                function n(F, J) { for (var U in J) w(J, U) && (F[U] = J[U]); w(J, "toString") && (F.toString = J.toString); w(J, "valueOf") && (F.valueOf = J.valueOf); return F } function d(F, J, U, ba) { return Ra(F, J, U, ba, !0).utc() } function c(F) { null == F._pf && (F._pf = { empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidEra: null, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1, parsedDateParts: [], era: null, meridiem: null, rfc2822: !1, weekdayMismatch: !1 }); return F._pf } function g(F) {
                                        if (null == F._isValid) {
                                                var J =
                                                        c(F), U = Ec.call(J.parsedDateParts, function (ba) { return null != ba }); U = !isNaN(F._d.getTime()) && 0 > J.overflow && !J.empty && !J.invalidEra && !J.invalidMonth && !J.invalidWeekday && !J.weekdayMismatch && !J.nullInput && !J.invalidFormat && !J.userInvalidated && (!J.meridiem || J.meridiem && U); F._strict && (U = U && 0 === J.charsLeftOver && 0 === J.unusedTokens.length && void 0 === J.bigHour); if (null != Object.isFrozen && Object.isFrozen(F)) return U; F._isValid = U
                                        } return F._isValid
                                } function b(F) {
                                        var J = d(NaN); null != F ? n(c(J), F) : c(J).userInvalidated =
                                                !0; return J
                                } function e(F, J) { var U, ba = oc.length; v(J._isAMomentObject) || (F._isAMomentObject = J._isAMomentObject); v(J._i) || (F._i = J._i); v(J._f) || (F._f = J._f); v(J._l) || (F._l = J._l); v(J._strict) || (F._strict = J._strict); v(J._tzm) || (F._tzm = J._tzm); v(J._isUTC) || (F._isUTC = J._isUTC); v(J._offset) || (F._offset = J._offset); v(J._pf) || (F._pf = c(J)); v(J._locale) || (F._locale = J._locale); if (0 < ba) for (U = 0; U < ba; U++) { var pa = oc[U]; var Ba = J[pa]; v(Ba) || (F[pa] = Ba) } return F } function a(F) {
                                        e(this, F); this._d = new Date(null != F._d ? F._d.getTime() :
                                                NaN); this.isValid() || (this._d = new Date(NaN)); !1 === fc && (fc = !0, E.updateOffset(this), fc = !1)
                                } function f(F) { return F instanceof a || null != F && null != F._isAMomentObject } function h(F) { !1 === E.suppressDeprecationWarnings && "undefined" !== typeof console && console.warn && console.warn("Deprecation warning: " + F) } function p(F, J) {
                                        var U = !0; return n(function () {
                                                null != E.deprecationHandler && E.deprecationHandler(null, F); if (U) {
                                                        var ba = [], pa, Ba, Fa = arguments.length; for (pa = 0; pa < Fa; pa++) {
                                                                var Ka = ""; if ("object" === typeof arguments[pa]) {
                                                                        Ka +=
                                                                        "\n[" + pa + "] "; for (Ba in arguments[0]) w(arguments[0], Ba) && (Ka += Ba + ": " + arguments[0][Ba] + ", "); Ka = Ka.slice(0, -2)
                                                                } else Ka = arguments[pa]; ba.push(Ka)
                                                        } h(F + "\nArguments: " + Array.prototype.slice.call(ba).join("") + "\n" + Error().stack); U = !1
                                                } return J.apply(this, arguments)
                                        }, J)
                                } function B(F, J) { null != E.deprecationHandler && E.deprecationHandler(F, J); pc[F] || (h(J), pc[F] = !0) } function t(F) { return "undefined" !== typeof Function && F instanceof Function || "[object Function]" === Object.prototype.toString.call(F) } function u(F,
                                        J) { var U = n({}, F), ba; for (ba in J) w(J, ba) && (A(F[ba]) && A(J[ba]) ? (U[ba] = {}, n(U[ba], F[ba]), n(U[ba], J[ba])) : null != J[ba] ? U[ba] = J[ba] : delete U[ba]); for (ba in F) w(F, ba) && !w(J, ba) && A(F[ba]) && (U[ba] = n({}, U[ba])); return U } function z(F) { null != F && this.set(F) } function x(F, J, U) { var ba = "" + Math.abs(F); return (0 <= F ? U ? "+" : "" : "-") + Math.pow(10, Math.max(0, J - ba.length)).toString().substr(1) + ba } function y(F, J, U, ba) {
                                                var pa = ba; "string" === typeof ba && (pa = function () { return this[ba]() }); F && (Jb[F] = pa); J && (Jb[J[0]] = function () {
                                                        return x(pa.apply(this,
                                                                arguments), J[1], J[2])
                                                }); U && (Jb[U] = function () { return this.localeData().ordinal(pa.apply(this, arguments), F) })
                                        } function D(F) { return F.match(/\[[\s\S]/) ? F.replace(/^\[|\]$/g, "") : F.replace(/\\/g, "") } function H(F) { var J = F.match(gc), U; var ba = 0; for (U = J.length; ba < U; ba++)J[ba] = Jb[J[ba]] ? Jb[J[ba]] : D(J[ba]); return function (pa) { var Ba = "", Fa; for (Fa = 0; Fa < U; Fa++)Ba += t(J[Fa]) ? J[Fa].call(pa, F) : J[Fa]; return Ba } } function I(F, J) {
                                                if (!F.isValid()) return F.localeData().invalidDate(); J = N(J, F.localeData()); hc[J] = hc[J] || H(J);
                                                return hc[J](F)
                                        } function N(F, J) { function U(pa) { return J.longDateFormat(pa) || pa } var ba = 5; for (Yb.lastIndex = 0; 0 <= ba && Yb.test(F);)F = F.replace(Yb, U), Yb.lastIndex = 0, --ba; return F } function T(F, J) { var U = F.toLowerCase(); Sb[U] = Sb[U + "s"] = Sb[J] = F } function M(F) { return "string" === typeof F ? Sb[F] || Sb[F.toLowerCase()] : void 0 } function R(F) { var J = {}, U, ba; for (ba in F) w(F, ba) && (U = M(ba)) && (J[U] = F[ba]); return J } function ca(F) {
                                                var J = [], U; for (U in F) w(F, U) && J.push({ unit: U, priority: fb[U] }); J.sort(function (ba, pa) {
                                                        return ba.priority -
                                                                pa.priority
                                                }); return J
                                        } function K(F) { return 0 === F % 4 && 0 !== F % 100 || 0 === F % 400 } function Q(F) { return 0 > F ? Math.ceil(F) || 0 : Math.floor(F) } function X(F) { F = +F; var J = 0; 0 !== F && isFinite(F) && (J = Q(F)); return J } function W(F, J) { return function (U) { return null != U ? (ma(this, F, U), E.updateOffset(this, J), this) : fa(this, F) } } function fa(F, J) { return F.isValid() ? F._d["get" + (F._isUTC ? "UTC" : "") + J]() : NaN } function ma(F, J, U) {
                                                if (F.isValid() && !isNaN(U)) if ("FullYear" === J && K(F.year()) && 1 === F.month() && 29 === F.date()) U = X(U), F._d["set" + (F._isUTC ?
                                                        "UTC" : "") + J](U, F.month(), wa(U, F.month())); else F._d["set" + (F._isUTC ? "UTC" : "") + J](U)
                                        } function ia(F, J, U) { ic[F] = t(J) ? J : function (ba, pa) { return ba && U ? U : J } } function va(F, J) { return w(ic, F) ? ic[F](J._strict, J._locale) : new RegExp(xa(F)) } function xa(F) { return na(F.replace("\\", "").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (J, U, ba, pa, Ba) { return U || ba || pa || Ba })) } function na(F) { return F.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$\x26") } function ra(F, J) {
                                                var U, ba = J; "string" === typeof F && (F = [F]); r(J) && (ba = function (Ba,
                                                        Fa) { Fa[J] = X(Ba) }); var pa = F.length; for (U = 0; U < pa; U++)jc[F[U]] = ba
                                        } function sa(F, J) { ra(F, function (U, ba, pa, Ba) { pa._w = pa._w || {}; J(U, pa._w, pa, Ba) }) } function wa(F, J) { if (isNaN(F) || isNaN(J)) return NaN; var U = (J % 12 + 12) % 12; return 1 === U ? K(F + (J - U) / 12) ? 29 : 28 : 31 - U % 7 % 2 } function aa(F, J) { if (!F.isValid()) return F; if ("string" === typeof J) if (/^\d+$/.test(J)) J = X(J); else if (J = F.localeData().monthsParse(J), !r(J)) return F; var U = Math.min(F.date(), wa(F.year(), J)); F._d["set" + (F._isUTC ? "UTC" : "") + "Month"](J, U); return F } function Da(F) {
                                                return null !=
                                                        F ? (aa(this, F), E.updateOffset(this, !0), this) : fa(this, "Month")
                                        } function Ca() {
                                                function F(Fa, Ka) { return Ka.length - Fa.length } var J = [], U = [], ba = [], pa; for (pa = 0; 12 > pa; pa++) { var Ba = d([2E3, pa]); J.push(this.monthsShort(Ba, "")); U.push(this.months(Ba, "")); ba.push(this.months(Ba, "")); ba.push(this.monthsShort(Ba, "")) } J.sort(F); U.sort(F); ba.sort(F); for (pa = 0; 12 > pa; pa++)J[pa] = na(J[pa]), U[pa] = na(U[pa]); for (pa = 0; 24 > pa; pa++)ba[pa] = na(ba[pa]); this._monthsShortRegex = this._monthsRegex = new RegExp("^(" + ba.join("|") + ")", "i");
                                                this._monthsStrictRegex = new RegExp("^(" + U.join("|") + ")", "i"); this._monthsShortStrictRegex = new RegExp("^(" + J.join("|") + ")", "i")
                                        } function O(F, J, U, ba, pa, Ba, Fa) { 100 > F && 0 <= F ? (J = new Date(F + 400, J, U, ba, pa, Ba, Fa), isFinite(J.getFullYear()) && J.setFullYear(F)) : J = new Date(F, J, U, ba, pa, Ba, Fa); return J } function C(F) {
                                                if (100 > F && 0 <= F) { var J = Array.prototype.slice.call(arguments); J[0] = F + 400; J = new Date(Date.UTC.apply(null, J)); isFinite(J.getUTCFullYear()) && J.setUTCFullYear(F) } else J = new Date(Date.UTC.apply(null, arguments));
                                                return J
                                        } function G(F, J, U) { U = 7 + J - U; return -((7 + C(F, 0, U).getUTCDay() - J) % 7) + U - 1 } function L(F, J, U, ba, pa) { U = (7 + U - ba) % 7; ba = G(F, ba, pa); ba = 1 + 7 * (J - 1) + U + ba; 0 >= ba ? (J = F - 1, F = (K(J) ? 366 : 365) + ba) : ba > (K(F) ? 366 : 365) ? (J = F + 1, F = ba - (K(F) ? 366 : 365)) : (J = F, F = ba); return { year: J, dayOfYear: F } } function P(F, J, U) { var ba = G(F.year(), J, U); ba = Math.floor((F.dayOfYear() - ba - 1) / 7) + 1; 1 > ba ? (F = F.year() - 1, J = ba + S(F, J, U)) : ba > S(F.year(), J, U) ? (J = ba - S(F.year(), J, U), F = F.year() + 1) : (F = F.year(), J = ba); return { week: J, year: F } } function S(F, J, U) {
                                                var ba = G(F,
                                                        J, U); J = G(F + 1, J, U); return ((K(F) ? 366 : 365) - ba + J) / 7
                                        } function Y(F, J) { return F.slice(J, 7).concat(F.slice(0, J)) } function ha(F, J, U) {
                                                var ba; F = F.toLocaleLowerCase(); if (!this._weekdaysParse) for (this._weekdaysParse = [], this._shortWeekdaysParse = [], this._minWeekdaysParse = [], ba = 0; 7 > ba; ++ba) { var pa = d([2E3, 1]).day(ba); this._minWeekdaysParse[ba] = this.weekdaysMin(pa, "").toLocaleLowerCase(); this._shortWeekdaysParse[ba] = this.weekdaysShort(pa, "").toLocaleLowerCase(); this._weekdaysParse[ba] = this.weekdays(pa, "").toLocaleLowerCase() } if (U) J =
                                                        "dddd" === J ? cb.call(this._weekdaysParse, F) : "ddd" === J ? cb.call(this._shortWeekdaysParse, F) : cb.call(this._minWeekdaysParse, F); else if ("dddd" === J) { J = cb.call(this._weekdaysParse, F); if (-1 !== J) return J; J = cb.call(this._shortWeekdaysParse, F); if (-1 !== J) return J; J = cb.call(this._minWeekdaysParse, F) } else if ("ddd" === J) { J = cb.call(this._shortWeekdaysParse, F); if (-1 !== J) return J; J = cb.call(this._weekdaysParse, F); if (-1 !== J) return J; J = cb.call(this._minWeekdaysParse, F) } else {
                                                                J = cb.call(this._minWeekdaysParse, F); if (-1 !== J) return J;
                                                                J = cb.call(this._weekdaysParse, F); if (-1 !== J) return J; J = cb.call(this._shortWeekdaysParse, F)
                                                        } return -1 !== J ? J : null
                                        } function ja() {
                                                function F(Oa, db) { return db.length - Oa.length } var J = [], U = [], ba = [], pa = [], Ba; for (Ba = 0; 7 > Ba; Ba++) { var Fa = d([2E3, 1]).day(Ba); var Ka = na(this.weekdaysMin(Fa, "")); var Qa = na(this.weekdaysShort(Fa, "")); Fa = na(this.weekdays(Fa, "")); J.push(Ka); U.push(Qa); ba.push(Fa); pa.push(Ka); pa.push(Qa); pa.push(Fa) } J.sort(F); U.sort(F); ba.sort(F); pa.sort(F); this._weekdaysMinRegex = this._weekdaysShortRegex =
                                                        this._weekdaysRegex = new RegExp("^(" + pa.join("|") + ")", "i"); this._weekdaysStrictRegex = new RegExp("^(" + ba.join("|") + ")", "i"); this._weekdaysShortStrictRegex = new RegExp("^(" + U.join("|") + ")", "i"); this._weekdaysMinStrictRegex = new RegExp("^(" + J.join("|") + ")", "i")
                                        } function ka() { return this.hours() % 12 || 12 } function ua(F, J) { y(F, 0, 0, function () { return this.localeData().meridiem(this.hours(), this.minutes(), J) }) } function qa(F, J) { return J._meridiemParse } function V(F) { return F ? F.toLowerCase().replace("_", "-") : F } function da(F) {
                                                var J =
                                                        null; if (void 0 === Za[F] && "undefined" !== typeof module && module && module.exports && null != F.match("^[^/\\\\]*$")) try { J = Tb._abbr; var U = require; U("./locale/" + F); Z(J) } catch (ba) { Za[F] = null } return Za[F]
                                        } function Z(F, J) { F && ((J = v(J) ? la(F) : ea(F, J)) ? Tb = J : "undefined" !== typeof console && console.warn && console.warn("Locale " + F + " not found. Did you forget to load it?")); return Tb._abbr } function ea(F, J) {
                                                if (null !== J) {
                                                        var U = qc; J.abbr = F; if (null != Za[F]) B("defineLocaleOverride", "use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),
                                                                U = Za[F]._config; else if (null != J.parentLocale) if (null != Za[J.parentLocale]) U = Za[J.parentLocale]._config; else if (U = da(J.parentLocale), null != U) U = U._config; else return Ub[J.parentLocale] || (Ub[J.parentLocale] = []), Ub[J.parentLocale].push({ name: F, config: J }), null; Za[F] = new z(u(U, J)); Ub[F] && Ub[F].forEach(function (ba) { ea(ba.name, ba.config) }); Z(F); return Za[F]
                                                } delete Za[F]; return null
                                        } function la(F) {
                                                var J; F && F._locale && F._locale._abbr && (F = F._locale._abbr); if (!F) return Tb; if (!q(F)) { if (J = da(F)) return J; F = [F] } a: {
                                                        J =
                                                        0; for (var U, ba, pa, Ba; J < F.length;) { Ba = V(F[J]).split("-"); U = Ba.length; for (ba = (ba = V(F[J + 1])) ? ba.split("-") : null; 0 < U;) { if (pa = da(Ba.slice(0, U).join("-"))) { F = pa; break a } if (pa = ba && ba.length >= U) { b: { pa = void 0; var Fa = Math.min(Ba.length, ba.length); for (pa = 0; pa < Fa; pa += 1)if (Ba[pa] !== ba[pa]) break b; pa = Fa } pa = pa >= U - 1 } if (pa) break; U-- } J++ } F = Tb
                                                } return F
                                        } function oa(F) {
                                                var J; (J = F._a) && -2 === c(F).overflow && (J = 0 > J[sb] || 11 < J[sb] ? sb : 1 > J[ob] || J[ob] > wa(J[ib], J[sb]) ? ob : 0 > J[eb] || 24 < J[eb] || 24 === J[eb] && (0 !== J[nb] || 0 !== J[tb] || 0 !==
                                                        J[Db]) ? eb : 0 > J[nb] || 59 < J[nb] ? nb : 0 > J[tb] || 59 < J[tb] ? tb : 0 > J[Db] || 999 < J[Db] ? Db : -1, c(F)._overflowDayOfYear && (J < ib || J > ob) && (J = ob), c(F)._overflowWeeks && -1 === J && (J = Fc), c(F)._overflowWeekday && -1 === J && (J = Gc), c(F).overflow = J); return F
                                        } function ya(F) {
                                                var J = F._i; var U = Hc.exec(J) || Ic.exec(J); var ba = Zb.length; var pa = kc.length; if (U) {
                                                        c(F).iso = !0; for (J = 0; J < ba; J++)if (Zb[J][1].exec(U[1])) { var Ba = Zb[J][0]; var Fa = !1 !== Zb[J][2]; break } if (null == Ba) F._isValid = !1; else {
                                                                if (U[3]) {
                                                                        J = 0; for (ba = pa; J < ba; J++)if (kc[J][1].exec(U[3])) {
                                                                                var Ka =
                                                                                        (U[2] || " ") + kc[J][0]; break
                                                                        } if (null == Ka) { F._isValid = !1; return }
                                                                } if (Fa || null == Ka) { if (U[4]) if (Jc.exec(U[4])) var Qa = "Z"; else { F._isValid = !1; return } F._f = Ba + (Ka || "") + (Qa || ""); Ha(F) } else F._isValid = !1
                                                        }
                                                } else F._isValid = !1
                                        } function ta(F) {
                                                var J = Kc.exec(F._i.replace(/\([^)]*\)|[\n\t]/g, " ").replace(/(\s\s+)/g, " ").replace(/^\s\s*/, "").replace(/\s\s*$/, "")); if (J) {
                                                        var U = J[3], ba = J[2], pa = J[5], Ba = J[6], Fa = J[7], Ka = parseInt(J[4], 10); U = [49 >= Ka ? 2E3 + Ka : 999 >= Ka ? 1900 + Ka : Ka, rc.indexOf(U), parseInt(ba, 10), parseInt(pa, 10), parseInt(Ba,
                                                                10)]; Fa && U.push(parseInt(Fa, 10)); a: { if (Fa = J[1]) if (Fa = sc.indexOf(Fa), ba = (new Date(U[0], U[1], U[2])).getDay(), Fa !== ba) { c(F).weekdayMismatch = !0; Fa = F._isValid = !1; break a } Fa = !0 } Fa && (F._a = U, (Fa = J[8]) ? J = Lc[Fa] : J[9] ? J = 0 : (J = parseInt(J[10], 10), Fa = J % 100, J = (J - Fa) / 100 * 60 + Fa), F._tzm = J, F._d = C.apply(null, F._a), F._d.setUTCMinutes(F._d.getUTCMinutes() - F._tzm), c(F).rfc2822 = !0)
                                                } else F._isValid = !1
                                        } function Ea(F) {
                                                var J = Mc.exec(F._i); null !== J ? F._d = new Date(+J[1]) : (ya(F), !1 === F._isValid && (delete F._isValid, ta(F), !1 === F._isValid &&
                                                        (delete F._isValid, F._strict ? F._isValid = !1 : E.createFromInputFallback(F))))
                                        } function Aa(F, J, U) { return null != F ? F : null != J ? J : U } function za(F) {
                                                var J = []; if (!F._d) {
                                                        var U = new Date(E.now()); U = F._useUTC ? [U.getUTCFullYear(), U.getUTCMonth(), U.getUTCDate()] : [U.getFullYear(), U.getMonth(), U.getDate()]; if (F._w && null == F._a[ob] && null == F._a[sb]) {
                                                                var ba = F._w; if (null != ba.GG || null != ba.W || null != ba.E) { var pa = 1; var Ba = 4; var Fa = Aa(ba.GG, F._a[ib], P(La(), 1, 4).year); var Ka = Aa(ba.W, 1); var Qa = Aa(ba.E, 1); if (1 > Qa || 7 < Qa) var Oa = !0 } else if (pa =
                                                                        F._locale._week.dow, Ba = F._locale._week.doy, Ka = P(La(), pa, Ba), Fa = Aa(ba.gg, F._a[ib], Ka.year), Ka = Aa(ba.w, Ka.week), null != ba.d) { if (Qa = ba.d, 0 > Qa || 6 < Qa) Oa = !0 } else if (null != ba.e) { if (Qa = ba.e + pa, 0 > ba.e || 6 < ba.e) Oa = !0 } else Qa = pa; 1 > Ka || Ka > S(Fa, pa, Ba) ? c(F)._overflowWeeks = !0 : null != Oa ? c(F)._overflowWeekday = !0 : (Oa = L(Fa, Ka, Qa, pa, Ba), F._a[ib] = Oa.year, F._dayOfYear = Oa.dayOfYear)
                                                        } if (null != F._dayOfYear) {
                                                                Oa = Aa(F._a[ib], U[ib]); if (F._dayOfYear > (K(Oa) ? 366 : 365) || 0 === F._dayOfYear) c(F)._overflowDayOfYear = !0; Oa = C(Oa, 0, F._dayOfYear);
                                                                F._a[sb] = Oa.getUTCMonth(); F._a[ob] = Oa.getUTCDate()
                                                        } for (Oa = 0; 3 > Oa && null == F._a[Oa]; ++Oa)F._a[Oa] = J[Oa] = U[Oa]; for (; 7 > Oa; Oa++)F._a[Oa] = J[Oa] = null == F._a[Oa] ? 2 === Oa ? 1 : 0 : F._a[Oa]; 24 === F._a[eb] && 0 === F._a[nb] && 0 === F._a[tb] && 0 === F._a[Db] && (F._nextDay = !0, F._a[eb] = 0); F._d = (F._useUTC ? C : O).apply(null, J); J = F._useUTC ? F._d.getUTCDay() : F._d.getDay(); null != F._tzm && F._d.setUTCMinutes(F._d.getUTCMinutes() - F._tzm); F._nextDay && (F._a[eb] = 24); F._w && "undefined" !== typeof F._w.d && F._w.d !== J && (c(F).weekdayMismatch = !0)
                                                }
                                        } function Ha(F) {
                                                if (F._f ===
                                                        E.ISO_8601) ya(F); else if (F._f === E.RFC_2822) ta(F); else {
                                                                F._a = []; c(F).empty = !0; var J = "" + F._i, U, ba, pa = J.length, Ba = 0; var Fa = N(F._f, F._locale).match(gc) || []; var Ka = Fa.length; for (U = 0; U < Ka; U++) { var Qa = Fa[U]; if (ba = (J.match(va(Qa, F)) || [])[0]) { var Oa = J.substr(0, J.indexOf(ba)); 0 < Oa.length && c(F).unusedInput.push(Oa); J = J.slice(J.indexOf(ba) + ba.length); Ba += ba.length } if (Jb[Qa]) { if (ba ? c(F).empty = !1 : c(F).unusedTokens.push(Qa), Oa = F, null != ba && w(jc, Qa)) jc[Qa](ba, Oa._a, Oa, Qa) } else F._strict && !ba && c(F).unusedTokens.push(Qa) } c(F).charsLeftOver =
                                                                        pa - Ba; 0 < J.length && c(F).unusedInput.push(J); 12 >= F._a[eb] && !0 === c(F).bigHour && 0 < F._a[eb] && (c(F).bigHour = void 0); c(F).parsedDateParts = F._a.slice(0); c(F).meridiem = F._meridiem; J = F._a; U = eb; pa = F._locale; Fa = F._a[eb]; Ba = F._meridiem; null != Ba && (null != pa.meridiemHour ? Fa = pa.meridiemHour(Fa, Ba) : null != pa.isPM && ((pa = pa.isPM(Ba)) && 12 > Fa && (Fa += 12), pa || 12 !== Fa || (Fa = 0))); J[U] = Fa; J = c(F).era; null !== J && (F._a[ib] = F._locale.erasConvertYear(J, F._a[ib])); za(F); oa(F)
                                                        }
                                        } function Na(F) {
                                                if (!F._d) {
                                                        var J = R(F._i); F._a = k([J.year, J.month,
                                                        void 0 === J.day ? J.date : J.day, J.hour, J.minute, J.second, J.millisecond], function (U) { return U && parseInt(U, 10) }); za(F)
                                                }
                                        } function Pa(F) {
                                                var J = F._i, U = F._f; F._locale = F._locale || la(F._l); if (null === J || void 0 === U && "" === J) return b({ nullInput: !0 }); "string" === typeof J && (F._i = J = F._locale.preparse(J)); if (f(J)) return new a(oa(J)); if (l(J)) F._d = J; else if (q(U)) {
                                                        var ba = !1, pa = F._f.length; if (0 === pa) c(F).invalidFormat = !0, F._d = new Date(NaN); else {
                                                                for (J = 0; J < pa; J++) {
                                                                        U = 0; var Ba = !1; var Fa = e({}, F); null != F._useUTC && (Fa._useUTC = F._useUTC);
                                                                        Fa._f = F._f[J]; Ha(Fa); g(Fa) && (Ba = !0); U += c(Fa).charsLeftOver; U += 10 * c(Fa).unusedTokens.length; c(Fa).score = U; if (ba) U < Ka && (Ka = U, Qa = Fa); else if (null == Ka || U < Ka || Ba) { var Ka = U; var Qa = Fa; Ba && (ba = !0) }
                                                                } n(F, Qa || Fa)
                                                        }
                                                } else U ? Ha(F) : Sa(F); g(F) || (F._d = null); return F
                                        } function Sa(F) { var J = F._i; v(J) ? F._d = new Date(E.now()) : l(J) ? F._d = new Date(J.valueOf()) : "string" === typeof J ? Ea(F) : q(J) ? (F._a = k(J.slice(0), function (U) { return parseInt(U, 10) }), za(F)) : A(J) ? Na(F) : r(J) ? F._d = new Date(J) : E.createFromInputFallback(F) } function Ra(F,
                                                J, U, ba, pa) { var Ba = {}; if (!0 === J || !1 === J) ba = J, J = void 0; if (!0 === U || !1 === U) ba = U, U = void 0; if (A(F) && m(F) || q(F) && 0 === F.length) F = void 0; Ba._isAMomentObject = !0; Ba._useUTC = Ba._isUTC = pa; Ba._l = U; Ba._i = F; Ba._f = J; Ba._strict = ba; F = new a(oa(Pa(Ba))); F._nextDay && (F.add(1, "d"), F._nextDay = void 0); return F } function La(F, J, U, ba) { return Ra(F, J, U, ba, !1) } function Wa(F, J) { var U; 1 === J.length && q(J[0]) && (J = J[0]); if (!J.length) return La(); var ba = J[0]; for (U = 1; U < J.length; ++U)if (!J[U].isValid() || J[U][F](ba)) ba = J[U]; return ba } function gb(F) {
                                                        var J =
                                                                R(F); F = J.year || 0; var U = J.quarter || 0, ba = J.month || 0, pa = J.week || J.isoWeek || 0, Ba = J.day || 0, Fa = J.hour || 0, Ka = J.minute || 0, Qa = J.second || 0, Oa = J.millisecond || 0; a: { var db, tc = !1, Nc = Vb.length; for (db in J) if (w(J, db) && (-1 === cb.call(Vb, db) || null != J[db] && isNaN(J[db]))) { J = !1; break a } for (db = 0; db < Nc; ++db)if (J[Vb[db]]) { if (tc) { J = !1; break a } parseFloat(J[Vb[db]]) !== X(J[Vb[db]]) && (tc = !0) } J = !0 } this._isValid = J; this._milliseconds = +Oa + 1E3 * Qa + 6E4 * Ka + 36E5 * Fa; this._days = +Ba + 7 * pa; this._months = +ba + 3 * U + 12 * F; this._data = {}; this._locale =
                                                                        la(); this._bubble()
                                                } function $a(F) { return F instanceof gb } function Ma(F) { return 0 > F ? -1 * Math.round(-1 * F) : Math.round(F) } function Ja(F, J) { y(F, 0, 0, function () { var U = this.utcOffset(), ba = "+"; 0 > U && (U = -U, ba = "-"); return ba + x(~~(U / 60), 2) + J + x(~~U % 60, 2) }) } function Va(F, J) { F = (J || "").match(F); if (null === F) return null; F = ((F[F.length - 1] || []) + "").match(Oc) || ["-", 0, 0]; J = +(60 * F[1]) + X(F[2]); return 0 === J ? 0 : "+" === F[0] ? J : -J } function kb(F, J) {
                                                        return J._isUTC ? (J = J.clone(), F = (f(F) || l(F) ? F.valueOf() : La(F).valueOf()) - J.valueOf(),
                                                                J._d.setTime(J._d.valueOf() + F), E.updateOffset(J, !1), J) : La(F).local()
                                                } function bb() { return this.isValid() ? this._isUTC && 0 === this._offset : !1 } function Ia(F, J) {
                                                        var U = F, ba = null; $a(F) ? U = { ms: F._milliseconds, d: F._days, M: F._months } : r(F) || !isNaN(+F) ? (U = {}, J ? U[J] = +F : U.milliseconds = +F) : (ba = Pc.exec(F)) ? (U = "-" === ba[1] ? -1 : 1, U = { y: 0, d: X(ba[ob]) * U, h: X(ba[eb]) * U, m: X(ba[nb]) * U, s: X(ba[tb]) * U, ms: X(Ma(1E3 * ba[Db])) * U }) : (ba = Qc.exec(F)) ? (U = "-" === ba[1] ? -1 : 1, U = {
                                                                y: Xa(ba[2], U), M: Xa(ba[3], U), w: Xa(ba[4], U), d: Xa(ba[5], U), h: Xa(ba[6],
                                                                        U), m: Xa(ba[7], U), s: Xa(ba[8], U)
                                                        }) : null == U ? U = {} : "object" === typeof U && ("from" in U || "to" in U) && (ba = La(U.from), U = La(U.to), ba.isValid() && U.isValid() ? (U = kb(U, ba), ba.isBefore(U) ? U = hb(ba, U) : (U = hb(U, ba), U.milliseconds = -U.milliseconds, U.months = -U.months), ba = U) : ba = { milliseconds: 0, months: 0 }, U = {}, U.ms = ba.milliseconds, U.M = ba.months); U = new gb(U); $a(F) && w(F, "_locale") && (U._locale = F._locale); $a(F) && w(F, "_isValid") && (U._isValid = F._isValid); return U
                                                } function Xa(F, J) {
                                                        F = F && parseFloat(F.replace(",", ".")); return (isNaN(F) ?
                                                                0 : F) * J
                                                } function hb(F, J) { var U = {}; U.months = J.month() - F.month() + 12 * (J.year() - F.year()); F.clone().add(U.months, "M").isAfter(J) && --U.months; U.milliseconds = +J - +F.clone().add(U.months, "M"); return U } function Kb(F, J) { return function (U, ba) { if (null !== ba && !isNaN(+ba)) { B(J, "moment()." + J + "(period, number) is deprecated. Please use moment()." + J + "(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."); var pa = U; U = ba; ba = pa } U = Ia(U, ba); zb(this, U, F); return this } } function zb(F,
                                                        J, U, ba) { var pa = J._milliseconds, Ba = Ma(J._days); J = Ma(J._months); F.isValid() && (ba = null == ba ? !0 : ba, J && aa(F, fa(F, "Month") + J * U), Ba && ma(F, "Date", fa(F, "Date") + Ba * U), pa && F._d.setTime(F._d.valueOf() + pa * U), ba && E.updateOffset(F, Ba || J)) } function jb(F) { return "string" === typeof F || F instanceof String } function Wb(F) { var J = q(F), U = !1; J && (U = 0 === F.filter(function (ba) { return !r(ba) && jb(F) }).length); return J && U } function Ab(F, J) {
                                                                if (F.date() < J.date()) return -Ab(J, F); var U = 12 * (J.year() - F.year()) + (J.month() - F.month()), ba = F.clone().add(U,
                                                                        "months"); 0 > J - ba ? (F = F.clone().add(U - 1, "months"), J = (J - ba) / (ba - F)) : (F = F.clone().add(U + 1, "months"), J = (J - ba) / (F - ba)); return -(U + J) || 0
                                                        } function Eb(F) { if (void 0 === F) return this._locale._abbr; F = la(F); null != F && (this._locale = F); return this } function Fb() { return this._locale } function pb(F, J) { return (F % J + J) % J } function Lb(F, J, U) { return 100 > F && 0 <= F ? new Date(F + 400, J, U) - uc : (new Date(F, J, U)).valueOf() } function Mb(F, J, U) { return 100 > F && 0 <= F ? Date.UTC(F + 400, J, U) - uc : Date.UTC(F, J, U) } function Gb(F, J) { return J.erasAbbrRegex(F) }
                                function Nb() { var F = [], J = [], U = [], ba = [], pa, Ba = this.eras(); var Fa = 0; for (pa = Ba.length; Fa < pa; ++Fa)J.push(na(Ba[Fa].name)), F.push(na(Ba[Fa].abbr)), U.push(na(Ba[Fa].narrow)), ba.push(na(Ba[Fa].name)), ba.push(na(Ba[Fa].abbr)), ba.push(na(Ba[Fa].narrow)); this._erasRegex = new RegExp("^(" + ba.join("|") + ")", "i"); this._erasNameRegex = new RegExp("^(" + J.join("|") + ")", "i"); this._erasAbbrRegex = new RegExp("^(" + F.join("|") + ")", "i"); this._erasNarrowRegex = new RegExp("^(" + U.join("|") + ")", "i") } function ab(F, J) {
                                        y(0, [F, F.length],
                                                0, J)
                                } function qb(F, J, U, ba, pa) { if (null == F) return P(this, ba, pa).year; var Ba = S(F, ba, pa); J > Ba && (J = Ba); F = L(F, J, U, ba, pa); F = C(F.year, 0, F.dayOfYear); this.year(F.getUTCFullYear()); this.month(F.getUTCMonth()); this.date(F.getUTCDate()); return this } function rb(F, J) { J[Db] = X(1E3 * ("0." + F)) } function mb(F) { return F } function ub(F, J, U, ba) { var pa = la(); J = d().set(ba, J); return pa[U](J, F) } function Hb(F, J, U) {
                                        r(F) && (J = F, F = void 0); F = F || ""; if (null != J) return ub(F, J, U, "month"); var ba = []; for (J = 0; 12 > J; J++)ba[J] = ub(F, J, U, "month");
                                        return ba
                                } function vb(F, J, U, ba) { "boolean" !== typeof F && (U = J = F, F = !1); r(J) && (U = J, J = void 0); J = J || ""; var pa = la(); F = F ? pa._week.dow : 0; pa = []; if (null != U) return ub(J, (U + F) % 7, ba, "day"); for (U = 0; 7 > U; U++)pa[U] = ub(J, (U + F) % 7, ba, "day"); return pa } function Bb(F, J, U, ba) { J = Ia(J, U); F._milliseconds += ba * J._milliseconds; F._days += ba * J._days; F._months += ba * J._months; return F._bubble() } function Ob(F) { return 0 > F ? Math.floor(F) : Math.ceil(F) } function wb(F) { return function () { return this.as(F) } } function Ib(F) {
                                        return function () {
                                                return this.isValid() ?
                                                        this._data[F] : NaN
                                        }
                                } function Rc(F, J, U, ba, pa) { return pa.relativeTime(J || 1, !!U, F, ba) } function Pb(F) { return (0 < F) - (0 > F) || +F } function $b() {
                                        if (!this.isValid()) return this.localeData().invalidDate(); var F = lc(this._milliseconds) / 1E3, J = lc(this._days), U = lc(this._months), ba = this.asSeconds(); if (!ba) return "P0D"; var pa = Q(F / 60); var Ba = Q(pa / 60); F %= 60; pa %= 60; var Fa = Q(U / 12); U %= 12; var Ka = F ? F.toFixed(3).replace(/\.?0+$/, "") : ""; var Qa = 0 > ba ? "-" : ""; var Oa = Pb(this._months) !== Pb(ba) ? "-" : ""; var db = Pb(this._days) !== Pb(ba) ? "-" :
                                                ""; ba = Pb(this._milliseconds) !== Pb(ba) ? "-" : ""; return Qa + "P" + (Fa ? Oa + Fa + "Y" : "") + (U ? Oa + U + "M" : "") + (J ? db + J + "D" : "") + (Ba || pa || F ? "T" : "") + (Ba ? ba + Ba + "H" : "") + (pa ? ba + pa + "M" : "") + (F ? ba + Ka + "S" : "")
                                } var Ec = Array.prototype.some ? Array.prototype.some : function (F) { var J = Object(this), U = J.length >>> 0, ba; for (ba = 0; ba < U; ba++)if (ba in J && F.call(this, J[ba], ba, J)) return !0; return !1 }; var oc = E.momentProperties = [], fc = !1, pc = {}; E.suppressDeprecationWarnings = !1; E.deprecationHandler = null; var Sc = Object.keys ? Object.keys : function (F) {
                                        var J,
                                        U = []; for (J in F) w(F, J) && U.push(J); return U
                                }; var gc = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g, Yb = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, hc = {}, Jb = {}, Sb = {}, fb = {}, vc = /\d/, lb = /\d\d/, wc = /\d{3}/, mc = /\d{4}/, ac = /[+-]?\d{6}/, Ya = /\d\d?/, xc = /\d\d\d\d?/, yc = /\d\d\d\d\d\d?/, bc = /\d{1,3}/, nc = /\d{1,4}/, cc = /[+-]?\d{1,6}/, Qb = /\d+/, dc = /[+-]?\d+/, Tc = /Z|[+-]\d\d:?\d\d/gi,
                                        ec = /Z|[+-]\d\d(?::?\d\d)?/gi, Xb = /[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i; var ic = {}; var jc = {}, ib = 0, sb = 1, ob = 2, eb = 3, nb = 4, tb = 5, Db = 6, Fc = 7, Gc = 8; var cb = Array.prototype.indexOf ? Array.prototype.indexOf : function (F) { var J; for (J = 0; J < this.length; ++J)if (this[J] === F) return J; return -1 }; y("M", ["MM", 2], "Mo", function () { return this.month() + 1 }); y("MMM", 0, 0, function (F) {
                                                return this.localeData().monthsShort(this,
                                                        F)
                                        }); y("MMMM", 0, 0, function (F) { return this.localeData().months(this, F) }); T("month", "M"); fb.month = 8; ia("M", Ya); ia("MM", Ya, lb); ia("MMM", function (F, J) { return J.monthsShortRegex(F) }); ia("MMMM", function (F, J) { return J.monthsRegex(F) }); ra(["M", "MM"], function (F, J) { J[sb] = X(F) - 1 }); ra(["MMM", "MMMM"], function (F, J, U, ba) { ba = U._locale.monthsParse(F, ba, U._strict); null != ba ? J[sb] = ba : c(U).invalidMonth = F }); var rc = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), zc = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/; y("Y", 0, 0,
                                                function () { var F = this.year(); return 9999 >= F ? x(F, 4) : "+" + F }); y(0, ["YY", 2], 0, function () { return this.year() % 100 }); y(0, ["YYYY", 4], 0, "year"); y(0, ["YYYYY", 5], 0, "year"); y(0, ["YYYYYY", 6, !0], 0, "year"); T("year", "y"); fb.year = 1; ia("Y", dc); ia("YY", Ya, lb); ia("YYYY", nc, mc); ia("YYYYY", cc, ac); ia("YYYYYY", cc, ac); ra(["YYYYY", "YYYYYY"], ib); ra("YYYY", function (F, J) { J[ib] = 2 === F.length ? E.parseTwoDigitYear(F) : X(F) }); ra("YY", function (F, J) { J[ib] = E.parseTwoDigitYear(F) }); ra("Y", function (F, J) { J[ib] = parseInt(F, 10) }); E.parseTwoDigitYear =
                                                        function (F) { return X(F) + (68 < X(F) ? 1900 : 2E3) }; var Ac = W("FullYear", !0); y("w", ["ww", 2], "wo", "week"); y("W", ["WW", 2], "Wo", "isoWeek"); T("week", "w"); T("isoWeek", "W"); fb.week = 5; fb.isoWeek = 5; ia("w", Ya); ia("ww", Ya, lb); ia("W", Ya); ia("WW", Ya, lb); sa(["w", "ww", "W", "WW"], function (F, J, U, ba) { J[ba.substr(0, 1)] = X(F) }); y("d", 0, "do", "day"); y("dd", 0, 0, function (F) { return this.localeData().weekdaysMin(this, F) }); y("ddd", 0, 0, function (F) { return this.localeData().weekdaysShort(this, F) }); y("dddd", 0, 0, function (F) {
                                                                return this.localeData().weekdays(this,
                                                                        F)
                                                        }); y("e", 0, 0, "weekday"); y("E", 0, 0, "isoWeekday"); T("day", "d"); T("weekday", "e"); T("isoWeekday", "E"); fb.day = 11; fb.weekday = 11; fb.isoWeekday = 11; ia("d", Ya); ia("e", Ya); ia("E", Ya); ia("dd", function (F, J) { return J.weekdaysMinRegex(F) }); ia("ddd", function (F, J) { return J.weekdaysShortRegex(F) }); ia("dddd", function (F, J) { return J.weekdaysRegex(F) }); sa(["dd", "ddd", "dddd"], function (F, J, U, ba) { ba = U._locale.weekdaysParse(F, ba, U._strict); null != ba ? J.d = ba : c(U).invalidWeekday = F }); sa(["d", "e", "E"], function (F, J, U, ba) {
                                                                J[ba] =
                                                                X(F)
                                                        }); var sc = "Sun Mon Tue Wed Thu Fri Sat".split(" "); y("H", ["HH", 2], 0, "hour"); y("h", ["hh", 2], 0, ka); y("k", ["kk", 2], 0, function () { return this.hours() || 24 }); y("hmm", 0, 0, function () { return "" + ka.apply(this) + x(this.minutes(), 2) }); y("hmmss", 0, 0, function () { return "" + ka.apply(this) + x(this.minutes(), 2) + x(this.seconds(), 2) }); y("Hmm", 0, 0, function () { return "" + this.hours() + x(this.minutes(), 2) }); y("Hmmss", 0, 0, function () { return "" + this.hours() + x(this.minutes(), 2) + x(this.seconds(), 2) }); ua("a", !0); ua("A", !1); T("hour",
                                                                "h"); fb.hour = 13; ia("a", qa); ia("A", qa); ia("H", Ya); ia("h", Ya); ia("k", Ya); ia("HH", Ya, lb); ia("hh", Ya, lb); ia("kk", Ya, lb); ia("hmm", xc); ia("hmmss", yc); ia("Hmm", xc); ia("Hmmss", yc); ra(["H", "HH"], eb); ra(["k", "kk"], function (F, J, U) { F = X(F); J[eb] = 24 === F ? 0 : F }); ra(["a", "A"], function (F, J, U) { U._isPm = U._locale.isPM(F); U._meridiem = F }); ra(["h", "hh"], function (F, J, U) { J[eb] = X(F); c(U).bigHour = !0 }); ra("hmm", function (F, J, U) { var ba = F.length - 2; J[eb] = X(F.substr(0, ba)); J[nb] = X(F.substr(ba)); c(U).bigHour = !0 }); ra("hmmss", function (F,
                                                                        J, U) { var ba = F.length - 4, pa = F.length - 2; J[eb] = X(F.substr(0, ba)); J[nb] = X(F.substr(ba, 2)); J[tb] = X(F.substr(pa)); c(U).bigHour = !0 }); ra("Hmm", function (F, J, U) { U = F.length - 2; J[eb] = X(F.substr(0, U)); J[nb] = X(F.substr(U)) }); ra("Hmmss", function (F, J, U) { U = F.length - 4; var ba = F.length - 2; J[eb] = X(F.substr(0, U)); J[nb] = X(F.substr(U, 2)); J[tb] = X(F.substr(ba)) }); var Uc = W("Hours", !0), qc = {
                                                                                calendar: {
                                                                                        sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT",
                                                                                        sameElse: "L"
                                                                                }, longDateFormat: { LTS: "h:mm:ss A", LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D, YYYY", LLL: "MMMM D, YYYY h:mm A", LLLL: "dddd, MMMM D, YYYY h:mm A" }, invalidDate: "Invalid date", ordinal: "%d", dayOfMonthOrdinalParse: /\d{1,2}/, relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", ss: "%d seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", w: "a week", ww: "%d weeks", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, months: "January February March April May June July August September October November December".split(" "),
                                                                                monthsShort: rc, week: { dow: 0, doy: 6 }, weekdays: "Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "), weekdaysMin: "Su Mo Tu We Th Fr Sa".split(" "), weekdaysShort: sc, meridiemParse: /[ap]\.?m?\.?/i
                                                                        }, Za = {}, Ub = {}, Tb, Hc = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/, Ic = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
                                                                                Jc = /Z|[+-]\d\d(?::?\d\d)?/, Zb = [["YYYYYY-MM-DD", /[+-]\d{6}-\d\d-\d\d/], ["YYYY-MM-DD", /\d{4}-\d\d-\d\d/], ["GGGG-[W]WW-E", /\d{4}-W\d\d-\d/], ["GGGG-[W]WW", /\d{4}-W\d\d/, !1], ["YYYY-DDD", /\d{4}-\d{3}/], ["YYYY-MM", /\d{4}-\d\d/, !1], ["YYYYYYMMDD", /[+-]\d{10}/], ["YYYYMMDD", /\d{8}/], ["GGGG[W]WWE", /\d{4}W\d{3}/], ["GGGG[W]WW", /\d{4}W\d{2}/, !1], ["YYYYDDD", /\d{7}/], ["YYYYMM", /\d{6}/, !1], ["YYYY", /\d{4}/, !1]], kc = [["HH:mm:ss.SSSS", /\d\d:\d\d:\d\d\.\d+/], ["HH:mm:ss,SSSS", /\d\d:\d\d:\d\d,\d+/], ["HH:mm:ss", /\d\d:\d\d:\d\d/],
                                                                                ["HH:mm", /\d\d:\d\d/], ["HHmmss.SSSS", /\d\d\d\d\d\d\.\d+/], ["HHmmss,SSSS", /\d\d\d\d\d\d,\d+/], ["HHmmss", /\d\d\d\d\d\d/], ["HHmm", /\d\d\d\d/], ["HH", /\d\d/]], Mc = /^\/?Date\((-?\d+)/i, Kc = /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/, Lc = { UT: 0, GMT: 0, EDT: -240, EST: -300, CDT: -300, CST: -360, MDT: -360, MST: -420, PDT: -420, PST: -480 }; E.createFromInputFallback = p("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",
                                                                                        function (F) { F._d = new Date(F._i + (F._useUTC ? " UTC" : "")) }); E.ISO_8601 = function () { }; E.RFC_2822 = function () { }; var Vc = p("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/", function () { var F = La.apply(null, arguments); return this.isValid() && F.isValid() ? F < this ? this : F : b() }), Wc = p("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/", function () {
                                                                                                var F = La.apply(null, arguments); return this.isValid() && F.isValid() ? F > this ?
                                                                                                        this : F : b()
                                                                                        }), Vb = "year quarter month week day hour minute second millisecond".split(" "); Ja("Z", ":"); Ja("ZZ", ""); ia("Z", ec); ia("ZZ", ec); ra(["Z", "ZZ"], function (F, J, U) { U._useUTC = !0; U._tzm = Va(ec, F) }); var Oc = /([\+\-]|\d\d)/gi; E.updateOffset = function () { }; var Pc = /^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/, Qc = /^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/; Ia.fn = gb.prototype; Ia.invalid =
                                                                                                function () { return Ia(NaN) }; var Xc = Kb(1, "add"), Yc = Kb(-1, "subtract"); E.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ"; E.defaultFormatUtc = "YYYY-MM-DDTHH:mm:ss[Z]"; var Bc = p("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.", function (F) { return void 0 === F ? this.localeData() : this.locale(F) }), uc = 126227808E5; y("N", 0, 0, "eraAbbr"); y("NN", 0, 0, "eraAbbr"); y("NNN", 0, 0, "eraAbbr"); y("NNNN", 0, 0, "eraName"); y("NNNNN", 0, 0, "eraNarrow");
                                y("y", ["y", 1], "yo", "eraYear"); y("y", ["yy", 2], 0, "eraYear"); y("y", ["yyy", 3], 0, "eraYear"); y("y", ["yyyy", 4], 0, "eraYear"); ia("N", Gb); ia("NN", Gb); ia("NNN", Gb); ia("NNNN", function (F, J) { return J.erasNameRegex(F) }); ia("NNNNN", function (F, J) { return J.erasNarrowRegex(F) }); ra(["N", "NN", "NNN", "NNNN", "NNNNN"], function (F, J, U, ba) { (J = U._locale.erasParse(F, ba, U._strict)) ? c(U).era = J : c(U).invalidEra = F }); ia("y", Qb); ia("yy", Qb); ia("yyy", Qb); ia("yyyy", Qb); ia("yo", function (F, J) { return J._eraYearOrdinalRegex || Qb }); ra(["y",
                                        "yy", "yyy", "yyyy"], ib); ra(["yo"], function (F, J, U, ba) { var pa; U._locale._eraYearOrdinalRegex && (pa = F.match(U._locale._eraYearOrdinalRegex)); J[ib] = U._locale.eraYearOrdinalParse ? U._locale.eraYearOrdinalParse(F, pa) : parseInt(F, 10) }); y(0, ["gg", 2], 0, function () { return this.weekYear() % 100 }); y(0, ["GG", 2], 0, function () { return this.isoWeekYear() % 100 }); ab("gggg", "weekYear"); ab("ggggg", "weekYear"); ab("GGGG", "isoWeekYear"); ab("GGGGG", "isoWeekYear"); T("weekYear", "gg"); T("isoWeekYear", "GG"); fb.weekYear = 1; fb.isoWeekYear =
                                                1; ia("G", dc); ia("g", dc); ia("GG", Ya, lb); ia("gg", Ya, lb); ia("GGGG", nc, mc); ia("gggg", nc, mc); ia("GGGGG", cc, ac); ia("ggggg", cc, ac); sa(["gggg", "ggggg", "GGGG", "GGGGG"], function (F, J, U, ba) { J[ba.substr(0, 2)] = X(F) }); sa(["gg", "GG"], function (F, J, U, ba) { J[ba] = E.parseTwoDigitYear(F) }); y("Q", 0, "Qo", "quarter"); T("quarter", "Q"); fb.quarter = 7; ia("Q", vc); ra("Q", function (F, J) { J[sb] = 3 * (X(F) - 1) }); y("D", ["DD", 2], "Do", "date"); T("date", "D"); fb.date = 9; ia("D", Ya); ia("DD", Ya, lb); ia("Do", function (F, J) {
                                                        return F ? J._dayOfMonthOrdinalParse ||
                                                                J._ordinalParse : J._dayOfMonthOrdinalParseLenient
                                                }); ra(["D", "DD"], ob); ra("Do", function (F, J) { J[ob] = X(F.match(Ya)[0]) }); var Cc = W("Date", !0); y("DDD", ["DDDD", 3], "DDDo", "dayOfYear"); T("dayOfYear", "DDD"); fb.dayOfYear = 4; ia("DDD", bc); ia("DDDD", wc); ra(["DDD", "DDDD"], function (F, J, U) { U._dayOfYear = X(F) }); y("m", ["mm", 2], 0, "minute"); T("minute", "m"); fb.minute = 14; ia("m", Ya); ia("mm", Ya, lb); ra(["m", "mm"], nb); var Zc = W("Minutes", !1); y("s", ["ss", 2], 0, "second"); T("second", "s"); fb.second = 15; ia("s", Ya); ia("ss", Ya, lb); ra(["s",
                                                        "ss"], tb); var $c = W("Seconds", !1); y("S", 0, 0, function () { return ~~(this.millisecond() / 100) }); y(0, ["SS", 2], 0, function () { return ~~(this.millisecond() / 10) }); y(0, ["SSS", 3], 0, "millisecond"); y(0, ["SSSS", 4], 0, function () { return 10 * this.millisecond() }); y(0, ["SSSSS", 5], 0, function () { return 100 * this.millisecond() }); y(0, ["SSSSSS", 6], 0, function () { return 1E3 * this.millisecond() }); y(0, ["SSSSSSS", 7], 0, function () { return 1E4 * this.millisecond() }); y(0, ["SSSSSSSS", 8], 0, function () { return 1E5 * this.millisecond() }); y(0, ["SSSSSSSSS",
                                                                9], 0, function () { return 1E6 * this.millisecond() }); T("millisecond", "ms"); fb.millisecond = 16; ia("S", bc, vc); ia("SS", bc, lb); ia("SSS", bc, wc); var Cb; for (Cb = "SSSS"; 9 >= Cb.length; Cb += "S")ia(Cb, Qb); for (Cb = "S"; 9 >= Cb.length; Cb += "S")ra(Cb, rb); var ad = W("Milliseconds", !1); y("z", 0, 0, "zoneAbbr"); y("zz", 0, 0, "zoneName"); var Ga = a.prototype; Ga.add = Xc; Ga.calendar = function (F, J) {
                                                                        if (1 === arguments.length) if (arguments[0]) {
                                                                                var U = arguments[0], ba; if (!(ba = f(U) || l(U) || jb(U) || r(U) || Wb(U))) {
                                                                                        ba = A(U) && !m(U); var pa = !1, Ba = "years year y months month M days day d dates date D hours hour h minutes minute m seconds second s milliseconds millisecond ms".split(" "),
                                                                                                Fa, Ka = Ba.length; for (Fa = 0; Fa < Ka; Fa += 1) { var Qa = Ba[Fa]; pa = pa || w(U, Qa) } ba = ba && pa
                                                                                } if (ba || null === U || void 0 === U) F = arguments[0], J = void 0; else { U = arguments[0]; ba = A(U) && !m(U); pa = !1; Ba = "sameDay nextDay lastDay nextWeek lastWeek sameElse".split(" "); for (Fa = 0; Fa < Ba.length; Fa += 1)Qa = Ba[Fa], pa = pa || w(U, Qa); ba && pa && (J = arguments[0], F = void 0) }
                                                                        } else J = F = void 0; U = F || La(); ba = kb(U, this).startOf("day"); ba = E.calendarFormat(this, ba) || "sameElse"; pa = J && (t(J[ba]) ? J[ba].call(this, U) : J[ba]); return this.format(pa || this.localeData().calendar(ba,
                                                                                this, La(U)))
                                                                }; Ga.clone = function () { return new a(this) }; Ga.diff = function (F, J, U) {
                                                                        if (!this.isValid()) return NaN; F = kb(F, this); if (!F.isValid()) return NaN; var ba = 6E4 * (F.utcOffset() - this.utcOffset()); J = M(J); switch (J) {
                                                                                case "year": J = Ab(this, F) / 12; break; case "month": J = Ab(this, F); break; case "quarter": J = Ab(this, F) / 3; break; case "second": J = (this - F) / 1E3; break; case "minute": J = (this - F) / 6E4; break; case "hour": J = (this - F) / 36E5; break; case "day": J = (this - F - ba) / 864E5; break; case "week": J = (this - F - ba) / 6048E5; break; default: J =
                                                                                        this - F
                                                                        }return U ? J : Q(J)
                                                                }; Ga.endOf = function (F) {
                                                                        F = M(F); if (void 0 === F || "millisecond" === F || !this.isValid()) return this; var J = this._isUTC ? Mb : Lb; switch (F) {
                                                                                case "year": var U = J(this.year() + 1, 0, 1) - 1; break; case "quarter": U = J(this.year(), this.month() - this.month() % 3 + 3, 1) - 1; break; case "month": U = J(this.year(), this.month() + 1, 1) - 1; break; case "week": U = J(this.year(), this.month(), this.date() - this.weekday() + 7) - 1; break; case "isoWeek": U = J(this.year(), this.month(), this.date() - (this.isoWeekday() - 1) + 7) - 1; break; case "day": case "date": U =
                                                                                        J(this.year(), this.month(), this.date() + 1) - 1; break; case "hour": U = this._d.valueOf(); U += 36E5 - pb(U + (this._isUTC ? 0 : 6E4 * this.utcOffset()), 36E5) - 1; break; case "minute": U = this._d.valueOf(); U += 6E4 - pb(U, 6E4) - 1; break; case "second": U = this._d.valueOf(), U += 1E3 - pb(U, 1E3) - 1
                                                                        }this._d.setTime(U); E.updateOffset(this, !0); return this
                                                                }; Ga.format = function (F) { F || (F = this.isUtc() ? E.defaultFormatUtc : E.defaultFormat); F = I(this, F); return this.localeData().postformat(F) }; Ga.from = function (F, J) {
                                                                        return this.isValid() && (f(F) && F.isValid() ||
                                                                                La(F).isValid()) ? Ia({ to: this, from: F }).locale(this.locale()).humanize(!J) : this.localeData().invalidDate()
                                                                }; Ga.fromNow = function (F) { return this.from(La(), F) }; Ga.to = function (F, J) { return this.isValid() && (f(F) && F.isValid() || La(F).isValid()) ? Ia({ from: this, to: F }).locale(this.locale()).humanize(!J) : this.localeData().invalidDate() }; Ga.toNow = function (F) { return this.to(La(), F) }; Ga.get = function (F) { F = M(F); return t(this[F]) ? this[F]() : this }; Ga.invalidAt = function () { return c(this).overflow }; Ga.isAfter = function (F, J) {
                                                                        F =
                                                                        f(F) ? F : La(F); if (!this.isValid() || !F.isValid()) return !1; J = M(J) || "millisecond"; return "millisecond" === J ? this.valueOf() > F.valueOf() : F.valueOf() < this.clone().startOf(J).valueOf()
                                                                }; Ga.isBefore = function (F, J) { F = f(F) ? F : La(F); if (!this.isValid() || !F.isValid()) return !1; J = M(J) || "millisecond"; return "millisecond" === J ? this.valueOf() < F.valueOf() : this.clone().endOf(J).valueOf() < F.valueOf() }; Ga.isBetween = function (F, J, U, ba) {
                                                                        F = f(F) ? F : La(F); J = f(J) ? J : La(J); if (!(this.isValid() && F.isValid() && J.isValid())) return !1; ba = ba ||
                                                                                "()"; return ("(" === ba[0] ? this.isAfter(F, U) : !this.isBefore(F, U)) && (")" === ba[1] ? this.isBefore(J, U) : !this.isAfter(J, U))
                                                                }; Ga.isSame = function (F, J) { F = f(F) ? F : La(F); if (!this.isValid() || !F.isValid()) return !1; J = M(J) || "millisecond"; if ("millisecond" === J) return this.valueOf() === F.valueOf(); F = F.valueOf(); return this.clone().startOf(J).valueOf() <= F && F <= this.clone().endOf(J).valueOf() }; Ga.isSameOrAfter = function (F, J) { return this.isSame(F, J) || this.isAfter(F, J) }; Ga.isSameOrBefore = function (F, J) {
                                                                        return this.isSame(F, J) ||
                                                                                this.isBefore(F, J)
                                                                }; Ga.isValid = function () { return g(this) }; Ga.lang = Bc; Ga.locale = Eb; Ga.localeData = Fb; Ga.max = Wc; Ga.min = Vc; Ga.parsingFlags = function () { return n({}, c(this)) }; Ga.set = function (F, J) { if ("object" === typeof F) { F = R(F); J = ca(F); var U, ba = J.length; for (U = 0; U < ba; U++)this[J[U].unit](F[J[U].unit]) } else if (F = M(F), t(this[F])) return this[F](J); return this }; Ga.startOf = function (F) {
                                                                        F = M(F); if (void 0 === F || "millisecond" === F || !this.isValid()) return this; var J = this._isUTC ? Mb : Lb; switch (F) {
                                                                                case "year": var U = J(this.year(),
                                                                                        0, 1); break; case "quarter": U = J(this.year(), this.month() - this.month() % 3, 1); break; case "month": U = J(this.year(), this.month(), 1); break; case "week": U = J(this.year(), this.month(), this.date() - this.weekday()); break; case "isoWeek": U = J(this.year(), this.month(), this.date() - (this.isoWeekday() - 1)); break; case "day": case "date": U = J(this.year(), this.month(), this.date()); break; case "hour": U = this._d.valueOf(); U -= pb(U + (this._isUTC ? 0 : 6E4 * this.utcOffset()), 36E5); break; case "minute": U = this._d.valueOf(); U -= pb(U, 6E4); break;
                                                                                case "second": U = this._d.valueOf(), U -= pb(U, 1E3)
                                                                        }this._d.setTime(U); E.updateOffset(this, !0); return this
                                                                }; Ga.subtract = Yc; Ga.toArray = function () { return [this.year(), this.month(), this.date(), this.hour(), this.minute(), this.second(), this.millisecond()] }; Ga.toObject = function () { return { years: this.year(), months: this.month(), date: this.date(), hours: this.hours(), minutes: this.minutes(), seconds: this.seconds(), milliseconds: this.milliseconds() } }; Ga.toDate = function () { return new Date(this.valueOf()) }; Ga.toISOString = function (F) {
                                                                        if (!this.isValid()) return null;
                                                                        var J = (F = !0 !== F) ? this.clone().utc() : this; return 0 > J.year() || 9999 < J.year() ? I(J, F ? "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYYYY-MM-DD[T]HH:mm:ss.SSSZ") : t(Date.prototype.toISOString) ? F ? this.toDate().toISOString() : (new Date(this.valueOf() + 6E4 * this.utcOffset())).toISOString().replace("Z", I(J, "Z")) : I(J, F ? "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]" : "YYYY-MM-DD[T]HH:mm:ss.SSSZ")
                                                                }; Ga.inspect = function () {
                                                                        if (!this.isValid()) return "moment.invalid(/* " + this._i + " */)"; var F = "moment", J = ""; this.isLocal() || (F = 0 === this.utcOffset() ? "moment.utc" :
                                                                                "moment.parseZone", J = "Z"); F = "[" + F + '("]'; var U = 0 <= this.year() && 9999 >= this.year() ? "YYYY" : "YYYYYY"; return this.format(F + U + "-MM-DD[T]HH:mm:ss.SSS" + (J + '[")]'))
                                                                }; "undefined" !== typeof Symbol && null != Symbol.for && (Ga[Symbol.for("nodejs.util.inspect.custom")] = function () { return "Moment\x3c" + this.format() + "\x3e" }); Ga.toJSON = function () { return this.isValid() ? this.toISOString() : null }; Ga.toString = function () { return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ") }; Ga.unix = function () {
                                                                        return Math.floor(this.valueOf() /
                                                                                1E3)
                                                                }; Ga.valueOf = function () { return this._d.valueOf() - 6E4 * (this._offset || 0) }; Ga.creationData = function () { return { input: this._i, format: this._f, locale: this._locale, isUTC: this._isUTC, strict: this._strict } }; Ga.eraName = function () { var F, J = this.localeData().eras(); var U = 0; for (F = J.length; U < F; ++U) { var ba = this.clone().startOf("day").valueOf(); if (J[U].since <= ba && ba <= J[U].until || J[U].until <= ba && ba <= J[U].since) return J[U].name } return "" }; Ga.eraNarrow = function () {
                                                                        var F, J = this.localeData().eras(); var U = 0; for (F = J.length; U <
                                                                                F; ++U) { var ba = this.clone().startOf("day").valueOf(); if (J[U].since <= ba && ba <= J[U].until || J[U].until <= ba && ba <= J[U].since) return J[U].narrow } return ""
                                                                }; Ga.eraAbbr = function () { var F, J = this.localeData().eras(); var U = 0; for (F = J.length; U < F; ++U) { var ba = this.clone().startOf("day").valueOf(); if (J[U].since <= ba && ba <= J[U].until || J[U].until <= ba && ba <= J[U].since) return J[U].abbr } return "" }; Ga.eraYear = function () {
                                                                        var F, J = this.localeData().eras(); var U = 0; for (F = J.length; U < F; ++U) {
                                                                                var ba = J[U].since <= J[U].until ? 1 : -1; var pa =
                                                                                        this.clone().startOf("day").valueOf(); if (J[U].since <= pa && pa <= J[U].until || J[U].until <= pa && pa <= J[U].since) return (this.year() - E(J[U].since).year()) * ba + J[U].offset
                                                                        } return this.year()
                                                                }; Ga.year = Ac; Ga.isLeapYear = function () { return K(this.year()) }; Ga.weekYear = function (F) { return qb.call(this, F, this.week(), this.weekday(), this.localeData()._week.dow, this.localeData()._week.doy) }; Ga.isoWeekYear = function (F) { return qb.call(this, F, this.isoWeek(), this.isoWeekday(), 1, 4) }; Ga.quarter = Ga.quarters = function (F) {
                                                                        return null ==
                                                                                F ? Math.ceil((this.month() + 1) / 3) : this.month(3 * (F - 1) + this.month() % 3)
                                                                }; Ga.month = Da; Ga.daysInMonth = function () { return wa(this.year(), this.month()) }; Ga.week = Ga.weeks = function (F) { var J = this.localeData().week(this); return null == F ? J : this.add(7 * (F - J), "d") }; Ga.isoWeek = Ga.isoWeeks = function (F) { var J = P(this, 1, 4).week; return null == F ? J : this.add(7 * (F - J), "d") }; Ga.weeksInYear = function () { var F = this.localeData()._week; return S(this.year(), F.dow, F.doy) }; Ga.weeksInWeekYear = function () {
                                                                        var F = this.localeData()._week; return S(this.weekYear(),
                                                                                F.dow, F.doy)
                                                                }; Ga.isoWeeksInYear = function () { return S(this.year(), 1, 4) }; Ga.isoWeeksInISOWeekYear = function () { return S(this.isoWeekYear(), 1, 4) }; Ga.date = Cc; Ga.day = Ga.days = function (F) { if (!this.isValid()) return null != F ? this : NaN; var J = this._isUTC ? this._d.getUTCDay() : this._d.getDay(); if (null != F) { var U = this.localeData(); "string" === typeof F && (isNaN(F) ? (F = U.weekdaysParse(F), F = "number" === typeof F ? F : null) : F = parseInt(F, 10)); return this.add(F - J, "d") } return J }; Ga.weekday = function (F) {
                                                                        if (!this.isValid()) return null !=
                                                                                F ? this : NaN; var J = (this.day() + 7 - this.localeData()._week.dow) % 7; return null == F ? J : this.add(F - J, "d")
                                                                }; Ga.isoWeekday = function (F) { if (!this.isValid()) return null != F ? this : NaN; if (null != F) { var J = this.localeData(); F = "string" === typeof F ? J.weekdaysParse(F) % 7 || 7 : isNaN(F) ? null : F; return this.day(this.day() % 7 ? F : F - 7) } return this.day() || 7 }; Ga.dayOfYear = function (F) { var J = Math.round((this.clone().startOf("day") - this.clone().startOf("year")) / 864E5) + 1; return null == F ? J : this.add(F - J, "d") }; Ga.hour = Ga.hours = Uc; Ga.minute = Ga.minutes =
                                                                        Zc; Ga.second = Ga.seconds = $c; Ga.millisecond = Ga.milliseconds = ad; Ga.utcOffset = function (F, J, U) {
                                                                                var ba = this._offset || 0, pa; if (!this.isValid()) return null != F ? this : NaN; if (null != F) {
                                                                                        if ("string" === typeof F) { if (F = Va(ec, F), null === F) return this } else 16 > Math.abs(F) && !U && (F *= 60); !this._isUTC && J && (pa = -Math.round(this._d.getTimezoneOffset())); this._offset = F; this._isUTC = !0; null != pa && this.add(pa, "m"); ba !== F && (!J || this._changeInProgress ? zb(this, Ia(F - ba, "m"), 1, !1) : this._changeInProgress || (this._changeInProgress = !0, E.updateOffset(this,
                                                                                                !0), this._changeInProgress = null)); return this
                                                                                } return this._isUTC ? ba : -Math.round(this._d.getTimezoneOffset())
                                                                        }; Ga.utc = function (F) { return this.utcOffset(0, F) }; Ga.local = function (F) { this._isUTC && (this.utcOffset(0, F), this._isUTC = !1, F && this.subtract(-Math.round(this._d.getTimezoneOffset()), "m")); return this }; Ga.parseZone = function () { if (null != this._tzm) this.utcOffset(this._tzm, !1, !0); else if ("string" === typeof this._i) { var F = Va(Tc, this._i); null != F ? this.utcOffset(F) : this.utcOffset(0, !0) } return this }; Ga.hasAlignedHourOffset =
                                                                                function (F) { if (!this.isValid()) return !1; F = F ? La(F).utcOffset() : 0; return 0 === (this.utcOffset() - F) % 60 }; Ga.isDST = function () { return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset() }; Ga.isLocal = function () { return this.isValid() ? !this._isUTC : !1 }; Ga.isUtcOffset = function () { return this.isValid() ? this._isUTC : !1 }; Ga.isUtc = bb; Ga.isUTC = bb; Ga.zoneAbbr = function () { return this._isUTC ? "UTC" : "" }; Ga.zoneName = function () {
                                                                                        return this._isUTC ? "Coordinated Universal Time" :
                                                                                                ""
                                                                                }; Ga.dates = p("dates accessor is deprecated. Use date instead.", Cc); Ga.months = p("months accessor is deprecated. Use month instead", Da); Ga.years = p("years accessor is deprecated. Use year instead", Ac); Ga.zone = p("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/", function (F, J) { return null != F ? ("string" !== typeof F && (F = -F), this.utcOffset(F, J), this) : -this.utcOffset() }); Ga.isDSTShifted = p("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",
                                                                                        function () { if (!v(this._isDSTShifted)) return this._isDSTShifted; var F = {}; e(F, this); F = Pa(F); if (F._a) { var J = F._isUTC ? d(F._a) : La(F._a); var U; if (U = this.isValid()) { F = F._a; J = J.toArray(); U = Math.min(F.length, J.length); var ba = Math.abs(F.length - J.length), pa = 0, Ba; for (Ba = 0; Ba < U; Ba++)X(F[Ba]) !== X(J[Ba]) && pa++; U = 0 < pa + ba } this._isDSTShifted = U } else this._isDSTShifted = !1; return this._isDSTShifted }); var Ua = z.prototype; Ua.calendar = function (F, J, U) { F = this._calendar[F] || this._calendar.sameElse; return t(F) ? F.call(J, U) : F };
                                Ua.longDateFormat = function (F) { var J = this._longDateFormat[F], U = this._longDateFormat[F.toUpperCase()]; if (J || !U) return J; this._longDateFormat[F] = U.match(gc).map(function (ba) { return "MMMM" === ba || "MM" === ba || "DD" === ba || "dddd" === ba ? ba.slice(1) : ba }).join(""); return this._longDateFormat[F] }; Ua.invalidDate = function () { return this._invalidDate }; Ua.ordinal = function (F) { return this._ordinal.replace("%d", F) }; Ua.preparse = mb; Ua.postformat = mb; Ua.relativeTime = function (F, J, U, ba) {
                                        var pa = this._relativeTime[U]; return t(pa) ?
                                                pa(F, J, U, ba) : pa.replace(/%d/i, F)
                                }; Ua.pastFuture = function (F, J) { F = this._relativeTime[0 < F ? "future" : "past"]; return t(F) ? F(J) : F.replace(/%s/i, J) }; Ua.set = function (F) { var J; for (J in F) if (w(F, J)) { var U = F[J]; t(U) ? this[J] = U : this["_" + J] = U } this._config = F; this._dayOfMonthOrdinalParseLenient = new RegExp((this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) + "|" + /\d{1,2}/.source) }; Ua.eras = function (F, J) {
                                        var U = this._eras || la("en")._eras; F = 0; for (J = U.length; F < J; ++F) {
                                                switch (typeof U[F].since) {
                                                        case "string": var ba =
                                                                E(U[F].since).startOf("day"); U[F].since = ba.valueOf()
                                                }switch (typeof U[F].until) { case "undefined": U[F].until = Infinity; break; case "string": ba = E(U[F].until).startOf("day").valueOf(), U[F].until = ba.valueOf() }
                                        } return U
                                }; Ua.erasParse = function (F, J, U) {
                                        var ba, pa = this.eras(); F = F.toUpperCase(); var Ba = 0; for (ba = pa.length; Ba < ba; ++Ba) {
                                                var Fa = pa[Ba].name.toUpperCase(); var Ka = pa[Ba].abbr.toUpperCase(); var Qa = pa[Ba].narrow.toUpperCase(); if (U) switch (J) {
                                                        case "N": case "NN": case "NNN": if (Ka === F) return pa[Ba]; break; case "NNNN": if (Fa ===
                                                                F) return pa[Ba]; break; case "NNNNN": if (Qa === F) return pa[Ba]
                                                } else if (0 <= [Fa, Ka, Qa].indexOf(F)) return pa[Ba]
                                        }
                                }; Ua.erasConvertYear = function (F, J) { var U = F.since <= F.until ? 1 : -1; return void 0 === J ? E(F.since).year() : E(F.since).year() + (J - F.offset) * U }; Ua.erasAbbrRegex = function (F) { w(this, "_erasAbbrRegex") || Nb.call(this); return F ? this._erasAbbrRegex : this._erasRegex }; Ua.erasNameRegex = function (F) { w(this, "_erasNameRegex") || Nb.call(this); return F ? this._erasNameRegex : this._erasRegex }; Ua.erasNarrowRegex = function (F) {
                                        w(this,
                                                "_erasNarrowRegex") || Nb.call(this); return F ? this._erasNarrowRegex : this._erasRegex
                                }; Ua.months = function (F, J) { return F ? q(this._months) ? this._months[F.month()] : this._months[(this._months.isFormat || zc).test(J) ? "format" : "standalone"][F.month()] : q(this._months) ? this._months : this._months.standalone }; Ua.monthsShort = function (F, J) { return F ? q(this._monthsShort) ? this._monthsShort[F.month()] : this._monthsShort[zc.test(J) ? "format" : "standalone"][F.month()] : q(this._monthsShort) ? this._monthsShort : this._monthsShort.standalone };
                                Ua.monthsParse = function (F, J, U) {
                                        var ba; if (this._monthsParseExact) {
                                                a: {
                                                        F = F.toLocaleLowerCase(); if (!this._monthsParse) for (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = [], ba = 0; 12 > ba; ++ba) { var pa = d([2E3, ba]); this._shortMonthsParse[ba] = this.monthsShort(pa, "").toLocaleLowerCase(); this._longMonthsParse[ba] = this.months(pa, "").toLocaleLowerCase() } if (U) J = "MMM" === J ? cb.call(this._shortMonthsParse, F) : cb.call(this._longMonthsParse, F); else if ("MMM" === J) {
                                                                J = cb.call(this._shortMonthsParse, F);
                                                                if (-1 !== J) break a; J = cb.call(this._longMonthsParse, F)
                                                        } else { J = cb.call(this._longMonthsParse, F); if (-1 !== J) break a; J = cb.call(this._shortMonthsParse, F) } J = -1 !== J ? J : null
                                                } return J
                                        } this._monthsParse || (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = []); for (ba = 0; 12 > ba; ba++)if (pa = d([2E3, ba]), U && !this._longMonthsParse[ba] && (this._longMonthsParse[ba] = new RegExp("^" + this.months(pa, "").replace(".", "") + "$", "i"), this._shortMonthsParse[ba] = new RegExp("^" + this.monthsShort(pa, "").replace(".", "") +
                                                "$", "i")), U || this._monthsParse[ba] || (pa = "^" + this.months(pa, "") + "|^" + this.monthsShort(pa, ""), this._monthsParse[ba] = new RegExp(pa.replace(".", ""), "i")), U && "MMMM" === J && this._longMonthsParse[ba].test(F) || U && "MMM" === J && this._shortMonthsParse[ba].test(F) || !U && this._monthsParse[ba].test(F)) return ba
                                }; Ua.monthsRegex = function (F) {
                                        if (this._monthsParseExact) return w(this, "_monthsRegex") || Ca.call(this), F ? this._monthsStrictRegex : this._monthsRegex; w(this, "_monthsRegex") || (this._monthsRegex = Xb); return this._monthsStrictRegex &&
                                                F ? this._monthsStrictRegex : this._monthsRegex
                                }; Ua.monthsShortRegex = function (F) { if (this._monthsParseExact) return w(this, "_monthsRegex") || Ca.call(this), F ? this._monthsShortStrictRegex : this._monthsShortRegex; w(this, "_monthsShortRegex") || (this._monthsShortRegex = Xb); return this._monthsShortStrictRegex && F ? this._monthsShortStrictRegex : this._monthsShortRegex }; Ua.week = function (F) { return P(F, this._week.dow, this._week.doy).week }; Ua.firstDayOfYear = function () { return this._week.doy }; Ua.firstDayOfWeek = function () { return this._week.dow };
                                Ua.weekdays = function (F, J) { J = q(this._weekdays) ? this._weekdays : this._weekdays[F && !0 !== F && this._weekdays.isFormat.test(J) ? "format" : "standalone"]; return !0 === F ? Y(J, this._week.dow) : F ? J[F.day()] : J }; Ua.weekdaysMin = function (F) { return !0 === F ? Y(this._weekdaysMin, this._week.dow) : F ? this._weekdaysMin[F.day()] : this._weekdaysMin }; Ua.weekdaysShort = function (F) { return !0 === F ? Y(this._weekdaysShort, this._week.dow) : F ? this._weekdaysShort[F.day()] : this._weekdaysShort }; Ua.weekdaysParse = function (F, J, U) {
                                        var ba; if (this._weekdaysParseExact) return ha.call(this,
                                                F, J, U); this._weekdaysParse || (this._weekdaysParse = [], this._minWeekdaysParse = [], this._shortWeekdaysParse = [], this._fullWeekdaysParse = []); for (ba = 0; 7 > ba; ba++) {
                                                        var pa = d([2E3, 1]).day(ba); U && !this._fullWeekdaysParse[ba] && (this._fullWeekdaysParse[ba] = new RegExp("^" + this.weekdays(pa, "").replace(".", "\\.?") + "$", "i"), this._shortWeekdaysParse[ba] = new RegExp("^" + this.weekdaysShort(pa, "").replace(".", "\\.?") + "$", "i"), this._minWeekdaysParse[ba] = new RegExp("^" + this.weekdaysMin(pa, "").replace(".", "\\.?") + "$", "i"));
                                                        this._weekdaysParse[ba] || (pa = "^" + this.weekdays(pa, "") + "|^" + this.weekdaysShort(pa, "") + "|^" + this.weekdaysMin(pa, ""), this._weekdaysParse[ba] = new RegExp(pa.replace(".", ""), "i")); if (U && "dddd" === J && this._fullWeekdaysParse[ba].test(F) || U && "ddd" === J && this._shortWeekdaysParse[ba].test(F) || U && "dd" === J && this._minWeekdaysParse[ba].test(F) || !U && this._weekdaysParse[ba].test(F)) return ba
                                                }
                                }; Ua.weekdaysRegex = function (F) {
                                        if (this._weekdaysParseExact) return w(this, "_weekdaysRegex") || ja.call(this), F ? this._weekdaysStrictRegex :
                                                this._weekdaysRegex; w(this, "_weekdaysRegex") || (this._weekdaysRegex = Xb); return this._weekdaysStrictRegex && F ? this._weekdaysStrictRegex : this._weekdaysRegex
                                }; Ua.weekdaysShortRegex = function (F) { if (this._weekdaysParseExact) return w(this, "_weekdaysRegex") || ja.call(this), F ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex; w(this, "_weekdaysShortRegex") || (this._weekdaysShortRegex = Xb); return this._weekdaysShortStrictRegex && F ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex }; Ua.weekdaysMinRegex = function (F) {
                                        if (this._weekdaysParseExact) return w(this,
                                                "_weekdaysRegex") || ja.call(this), F ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex; w(this, "_weekdaysMinRegex") || (this._weekdaysMinRegex = Xb); return this._weekdaysMinStrictRegex && F ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex
                                }; Ua.isPM = function (F) { return "p" === (F + "").toLowerCase().charAt(0) }; Ua.meridiem = function (F, J, U) { return 11 < F ? U ? "pm" : "PM" : U ? "am" : "AM" }; Z("en", {
                                        eras: [{ since: "0001-01-01", until: Infinity, offset: 1, name: "Anno Domini", narrow: "AD", abbr: "AD" }, {
                                                since: "0000-12-31", until: -Infinity,
                                                offset: 1, name: "Before Christ", narrow: "BC", abbr: "BC"
                                        }], dayOfMonthOrdinalParse: /\d{1,2}(th|st|nd|rd)/, ordinal: function (F) { var J = F % 10; J = 1 === X(F % 100 / 10) ? "th" : 1 === J ? "st" : 2 === J ? "nd" : 3 === J ? "rd" : "th"; return F + J }
                                }); E.lang = p("moment.lang is deprecated. Use moment.locale instead.", Z); E.langData = p("moment.langData is deprecated. Use moment.localeData instead.", la); var xb = Math.abs, bd = wb("ms"), cd = wb("s"), dd = wb("m"), ed = wb("h"), fd = wb("d"), gd = wb("w"), hd = wb("M"), id = wb("Q"), jd = wb("y"), kd = Ib("milliseconds"), ld = Ib("seconds"),
                                        md = Ib("minutes"), nd = Ib("hours"), od = Ib("days"), pd = Ib("months"), qd = Ib("years"), yb = Math.round, Rb = { ss: 44, s: 45, m: 45, h: 22, d: 26, w: null, M: 11 }, lc = Math.abs, Ta = gb.prototype; Ta.isValid = function () { return this._isValid }; Ta.abs = function () { var F = this._data; this._milliseconds = xb(this._milliseconds); this._days = xb(this._days); this._months = xb(this._months); F.milliseconds = xb(F.milliseconds); F.seconds = xb(F.seconds); F.minutes = xb(F.minutes); F.hours = xb(F.hours); F.months = xb(F.months); F.years = xb(F.years); return this }; Ta.add =
                                                function (F, J) { return Bb(this, F, J, 1) }; Ta.subtract = function (F, J) { return Bb(this, F, J, -1) }; Ta.as = function (F) {
                                                        if (!this.isValid()) return NaN; var J = this._milliseconds; F = M(F); if ("month" === F || "quarter" === F || "year" === F) { var U = this._days + J / 864E5; U = this._months + 4800 * U / 146097; switch (F) { case "month": return U; case "quarter": return U / 3; case "year": return U / 12 } } else switch (U = this._days + Math.round(146097 * this._months / 4800), F) {
                                                                case "week": return U / 7 + J / 6048E5; case "day": return U + J / 864E5; case "hour": return 24 * U + J / 36E5;
                                                                case "minute": return 1440 * U + J / 6E4; case "second": return 86400 * U + J / 1E3; case "millisecond": return Math.floor(864E5 * U) + J; default: throw Error("Unknown unit " + F);
                                                        }
                                                }; Ta.asMilliseconds = bd; Ta.asSeconds = cd; Ta.asMinutes = dd; Ta.asHours = ed; Ta.asDays = fd; Ta.asWeeks = gd; Ta.asMonths = hd; Ta.asQuarters = id; Ta.asYears = jd; Ta.valueOf = function () { return this.isValid() ? this._milliseconds + 864E5 * this._days + this._months % 12 * 2592E6 + 31536E6 * X(this._months / 12) : NaN }; Ta._bubble = function () {
                                                        var F = this._milliseconds, J = this._days, U = this._months,
                                                        ba = this._data; 0 <= F && 0 <= J && 0 <= U || 0 >= F && 0 >= J && 0 >= U || (F += 864E5 * Ob(146097 * U / 4800 + J), U = J = 0); ba.milliseconds = F % 1E3; F = Q(F / 1E3); ba.seconds = F % 60; F = Q(F / 60); ba.minutes = F % 60; F = Q(F / 60); ba.hours = F % 24; J += Q(F / 24); F = Q(4800 * J / 146097); U += F; J -= Ob(146097 * F / 4800); F = Q(U / 12); ba.days = J; ba.months = U % 12; ba.years = F; return this
                                                }; Ta.clone = function () { return Ia(this) }; Ta.get = function (F) { F = M(F); return this.isValid() ? this[F + "s"]() : NaN }; Ta.milliseconds = kd; Ta.seconds = ld; Ta.minutes = md; Ta.hours = nd; Ta.days = od; Ta.weeks = function () {
                                                        return Q(this.days() /
                                                                7)
                                                }; Ta.months = pd; Ta.years = qd; Ta.humanize = function (F, J) {
                                                        if (!this.isValid()) return this.localeData().invalidDate(); var U = !1, ba = Rb; "object" === typeof F && (J = F, F = !1); "boolean" === typeof F && (U = F); "object" === typeof J && (ba = Object.assign({}, Rb, J), null != J.s && null == J.ss && (ba.ss = J.s - 1)); F = this.localeData(); J = !U; var pa = Ia(this).abs(), Ba = yb(pa.as("s")), Fa = yb(pa.as("m")), Ka = yb(pa.as("h")), Qa = yb(pa.as("d")), Oa = yb(pa.as("M")), db = yb(pa.as("w")); pa = yb(pa.as("y")); Ba = Ba <= ba.ss && ["s", Ba] || Ba < ba.s && ["ss", Ba] || 1 >= Fa && ["m"] ||
                                                                Fa < ba.m && ["mm", Fa] || 1 >= Ka && ["h"] || Ka < ba.h && ["hh", Ka] || 1 >= Qa && ["d"] || Qa < ba.d && ["dd", Qa]; null != ba.w && (Ba = Ba || 1 >= db && ["w"] || db < ba.w && ["ww", db]); Ba = Ba || 1 >= Oa && ["M"] || Oa < ba.M && ["MM", Oa] || 1 >= pa && ["y"] || ["yy", pa]; Ba[2] = J; Ba[3] = 0 < +this; Ba[4] = F; J = Rc.apply(null, Ba); U && (J = F.pastFuture(+this, J)); return F.postformat(J)
                                                }; Ta.toISOString = $b; Ta.toString = $b; Ta.toJSON = $b; Ta.locale = Eb; Ta.localeData = Fb; Ta.toIsoString = p("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)", $b); Ta.lang = Bc;
                                y("X", 0, 0, "unix"); y("x", 0, 0, "valueOf"); ia("x", dc); ia("X", /[+-]?\d+(\.\d{1,3})?/); ra("X", function (F, J, U) { U._d = new Date(1E3 * parseFloat(F)) }); ra("x", function (F, J, U) { U._d = new Date(X(F)) }); E.version = "2.29.3"; var Dc = La; E.fn = Ga; E.min = function () { var F = [].slice.call(arguments, 0); return Wa("isBefore", F) }; E.max = function () { var F = [].slice.call(arguments, 0); return Wa("isAfter", F) }; E.now = function () { return Date.now ? Date.now() : +new Date }; E.utc = d; E.unix = function (F) { return La(1E3 * F) }; E.months = function (F, J) {
                                        return Hb(F,
                                                J, "months")
                                }; E.isDate = l; E.locale = Z; E.invalid = b; E.duration = Ia; E.isMoment = f; E.weekdays = function (F, J, U) { return vb(F, J, U, "weekdays") }; E.parseZone = function () { return La.apply(null, arguments).parseZone() }; E.localeData = la; E.isDuration = $a; E.monthsShort = function (F, J) { return Hb(F, J, "monthsShort") }; E.weekdaysMin = function (F, J, U) { return vb(F, J, U, "weekdaysMin") }; E.defineLocale = ea; E.updateLocale = function (F, J) {
                                        if (null != J) {
                                                var U = qc; if (null != Za[F] && null != Za[F].parentLocale) Za[F].set(u(Za[F]._config, J)); else {
                                                        var ba =
                                                                da(F); null != ba && (U = ba._config); J = u(U, J); null == ba && (J.abbr = F); J = new z(J); J.parentLocale = Za[F]; Za[F] = J
                                                } Z(F)
                                        } else null != Za[F] && (null != Za[F].parentLocale ? (Za[F] = Za[F].parentLocale, F === Z() && Z(F)) : null != Za[F] && delete Za[F]); return Za[F]
                                }; E.locales = function () { return Sc(Za) }; E.weekdaysShort = function (F, J, U) { return vb(F, J, U, "weekdaysShort") }; E.normalizeUnits = M; E.relativeTimeRounding = function (F) { return void 0 === F ? yb : "function" === typeof F ? (yb = F, !0) : !1 }; E.relativeTimeThreshold = function (F, J) {
                                        if (void 0 === Rb[F]) return !1;
                                        if (void 0 === J) return Rb[F]; Rb[F] = J; "s" === F && (Rb.ss = J - 1); return !0
                                }; E.calendarFormat = function (F, J) { F = F.diff(J, "days", !0); return -6 > F ? "sameElse" : -1 > F ? "lastWeek" : 0 > F ? "lastDay" : 1 > F ? "sameDay" : 2 > F ? "nextDay" : 7 > F ? "nextWeek" : "sameElse" }; E.prototype = Ga; E.HTML5_FMT = { DATETIME_LOCAL: "YYYY-MM-DDTHH:mm", DATETIME_LOCAL_SECONDS: "YYYY-MM-DDTHH:mm:ss", DATETIME_LOCAL_MS: "YYYY-MM-DDTHH:mm:ss.SSS", DATE: "YYYY-MM-DD", TIME: "HH:mm", TIME_SECONDS: "HH:mm:ss", TIME_MS: "HH:mm:ss.SSS", WEEK: "GGGG-[W]WW", MONTH: "YYYY-MM" }; return E
                        })
                },
                "esri/tasks/ProjectParameters": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "), function (E, q, A, w, m, v, r, l) {
                                E = E(null, {
                                        declaredClass: "esri.tasks.ProjectParameters", geometries: null, outSR: null, transformation: null, transformForward: null, toJson: function () {
                                                var k = A.map(this.geometries, function (d) { return d.toJson() }), n = {}; n.outSR = this.outSR.wkid || w.toJson(this.outSR.toJson()); n.inSR = this.geometries[0].spatialReference.wkid ||
                                                        w.toJson(this.geometries[0].spatialReference.toJson()); n.geometries = w.toJson({ geometryType: l.getJsonType(this.geometries[0]), geometries: k }); this.transformation && (n.transformation = this.transformation.wkid || w.toJson(this.transformation)); r.isDefined(this.transformForward) && (n.transformForward = this.transformForward); return n
                                        }
                                }); m("extend-esri") && q.setObject("tasks.ProjectParameters", E, v); return E
                        })
                }, "jimu/portalUrlUtils": function () {
                        define(["dojo/_base/lang", "jimu/shared/basePortalUrlUtils"], function (E,
                                q) {
                                        var A = E.clone(q); A.declaredClass = "jimu.portalUrlUtils"; A.getPortalUrlFromLocation = function () { return A.getPortalServerFromLocation() + A.getDeployContextFromLocation() }; A.getPortalSignInUrlFromLocation = function () { var w = A.getPortalUrlFromLocation(); return A.setHttpsProtocol(w + "home/signin.html") }; A.getPortalServerFromLocation = function () { return window.location.protocol + "//" + window.location.host }; A.getDeployContextFromLocation = function () {
                                                var w = window.location.href.split("?")[0], m = w.indexOf("/home/");
                                                0 > m && (m = w.indexOf("/apps/")); w = w.substring(w.indexOf(window.location.host) + window.location.host.length + 1, m); "/" !== w && (w = "/" + w + "/"); return w
                                        }; A.getRestBaseUrlFromLocation = function () { return window.location.protocol + "//" + window.location.host + A.getDeployContextFromLocation() + "sharing/rest/" }; return A
                        })
                }, "jimu/shared/basePortalUrlUtils": function () {
                        define(function () {
                                var E = { declaredClass: "jimu.shared.basePortalUrlUtils" }; "function" !== typeof String.prototype.trim && (String.prototype.trim = function () {
                                        return this.replace(/^\s*/gi,
                                                "").replace(/\s*$/gi, "")
                                }); "function" !== typeof String.prototype.startWith && (String.prototype.startWith = function (q) { return this.substr(0, q.length) === q }); "function" !== typeof String.prototype.endWith && (String.prototype.endWith = function (q) { return this.substr(this.length - q.length, q.length) === q }); E.getServerByUrl = function (q) { q = (q || "").trim(); q = q.replace(/^(http(s?):?)\/\//gi, ""); 0 === q.indexOf("//") && (q = q.slice(2)); return q.split("/")[0] }; E.getServerWithProtocol = function (q) {
                                        var A = ""; if (q = (q || "").trim()) {
                                                var w =
                                                        E.getServerByUrl(q); if (!w) return A; var m = E.getProtocol(q); m ? A = m + "://" + w : 0 === q.indexOf("//") && (A = "//" + w)
                                        } return A
                                }; E.isSameServer = function (q, A) { q = E.getServerByUrl(q) || ""; A = E.getServerByUrl(A) || ""; return q.toLowerCase() === A.toLowerCase() }; E.getDomain = function (q) { var A = ""; if (q = E.getServerByUrl(q)) q = q.replace(/:\d+$/, ""), q = q.match(/[^.]\w+\.\w+$/), null !== q && (A = q[0], /^\d+\.\d+$/.test(A) && (A = "")); return A }; E.isSameDomain = function (q, A) { q = E.getDomain(q); A = E.getDomain(A); return "" !== q && q === A }; E.isOrgOnline =
                                        function (q) { return 0 <= E.getServerByUrl(q).toLowerCase().indexOf(".maps.arcgis.com") }; E.isOnline = function (q) { return 0 <= E.getServerByUrl(q).toLowerCase().indexOf(".arcgis.com") }; E.isArcGIScom = function (q) { q = E.getServerByUrl(q).toLowerCase(); return "www.arcgis.com" === q || "arcgis.com" === q }; E.getStandardPortalUrl = function (q) {
                                                var A = E.getServerByUrl(q); if ("" === A) return ""; E.isOnline(A) ? (E.isArcGIScom(A) && (A = "www.arcgis.com"), q = E.addProtocol(q), q = E.getProtocol(q) + "://" + A) : (q = (q || "").trim().replace(/sharing(.*)/gi,
                                                        "").replace(/\/*$/g, ""), q = E.addProtocol(q), q.replace(new RegExp("http(s?)://" + A, "g"), "") || (q += "/arcgis")); return q
                                        }; E.isSamePortalUrl = function (q, A) { var w = /^http(s?):\/\//gi, m = /^\/\//gi; q = E.getStandardPortalUrl(q).toLowerCase().replace(w, "").replace(m, ""); A = E.getStandardPortalUrl(A).toLowerCase().replace(w, "").replace(m, ""); return q === A }; E.addProtocol = function (q) {
                                                if (-1 >= q.toLowerCase().indexOf("http://") && -1 >= q.toLowerCase().indexOf("https://")) {
                                                        var A = ""; "undefined" !== typeof window && window.location ?
                                                                (A = window.location.protocol, q = q.startWith("//") ? A + q : q.startWith("/") ? A + "//" + window.location.host + q : A + "//" + q) : (A = "http:", q = q.startWith("//") ? A + q : A + "//" + q)
                                                } return q
                                        }; E.getProtocol = function (q) { var A = ""; q = q.toLowerCase(); 0 === q.indexOf("https://") ? A = "https" : 0 === q.indexOf("http://") && (A = "http"); return A }; E.updateUrlProtocolByOtherUrl = function (q, A) { A = A.toLowerCase(); 0 === A.indexOf("https://") ? q = E.setHttpsProtocol(q) : 0 === A.indexOf("http://") && (q = E.setHttpProtocol(q)); return q }; E.removeProtocol = function (q) {
                                                return q.replace(/^http(s?):\/\//i,
                                                        "//")
                                        }; E.setHttpProtocol = function (q) { q = E.addProtocol(q); return q.replace(/^https:\/\//, "http://") }; E.setHttpsProtocol = function (q) { q = E.addProtocol(q); return q.replace(/^http:\/\//, "https://") }; E.setProtocol = function (q, A) { return 0 <= A.indexOf("https") ? E.setHttpsProtocol(q) : 0 <= A.indexOf("http") ? E.setHttpProtocol(q) : q }; E.getSharingUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/rest"); return A }; E.getOAuth2Url = function (q) {
                                                var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/rest/oauth2");
                                                return A
                                        }; E.getAppIdUrl = function (q, A) { var w = ""; (q = E.getStandardPortalUrl(q)) && (w = q + "/sharing/rest/oauth2/apps/" + A); return w }; E.getSignInUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/signin.html"); return A }; E.getBaseSearchUrl = function (q) { var A = ""; q = E.getStandardPortalUrl(q); (q = q.replace(/\/*$/g, "")) && (A = q + "/sharing/rest/search"); return A }; E.getBaseItemUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/rest/content/items"); return A }; E.getItemUrl = function (q,
                                                A) { var w = ""; (q = E.getBaseItemUrl(q)) && A && (w = q + "/" + A); return w }; E.getItemDataUrl = function (q, A) { var w = ""; (q = E.getItemUrl(q, A)) && (w = q + "/data"); return w }; E.getItemGroupsUrl = function (q, A) { var w = ""; (q = E.getItemUrl(q, A)) && (w = q + "/groups"); return w }; E.getGenerateTokenUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/generateToken"); return A }; E.getItemDetailsPageUrl = function (q, A) { var w = ""; q && A && (q = E.getStandardPortalUrl(q), w = q + "/home/item.html?id\x3d" + A); return w }; E.getUserProfilePageUrl =
                                                        function (q, A) { var w = ""; q && A && (q = E.getStandardPortalUrl(q), w = q + "/home/user.html?user\x3d" + A); return w }; E.getBaseGroupUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/rest/community/groups"); return A }; E.getPortalSelfInfoUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q || "")) && (A = q + "/sharing/rest/portals/self"); return A }; E.getPortalHelpMapUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q || "")) && (A = q + "/sharing/rest/portals/helpmap"); return A }; E.getCommunitySelfUrl = function (q) {
                                                                var A =
                                                                        ""; (q = E.getStandardPortalUrl(q || "")) && (A = q + "/sharing/rest/community/self"); return A
                                                        }; E.getBaseUserUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/rest/community/users"); return A }; E.getUserUrl = function (q, A) { var w = "", m = E.getBaseUserUrl(q); q && A && (w = m + "/" + A); return w }; E.getUserTagsUrl = function (q, A) { var w = "", m = E.getUserUrl(q, A); q && A && (w = m + "/tags"); return w }; E.getUserThumbnailUrl = function (q, A, w) { var m = ""; (q = E.getUserUrl(q, A)) && w && (m = q + "/info/" + w); return m }; E.getContentUrl = function (q) {
                                                                var A =
                                                                        ""; q && (q = E.getStandardPortalUrl(q), A = q + "/sharing/rest/content"); return A
                                                        }; E.getUserContentUrl = function (q, A, w) { var m = ""; m = ""; q && A && (m = E.getContentUrl(q), m = w ? m + "/users/" + A + "/" + w : m + "/users/" + A); return m }; E.getUserContentItemUrl = function (q, A, w) { var m = ""; m = ""; q && A && w && (m = E.getUserContentUrl(q, A), m = m + "/items/" + w); return m }; E.getItemResourceUrl = function (q, A, w) { var m = ""; m = ""; q && A && (m = E.getContentUrl(q), m = w ? m + "/items/" + A + "/resources/" + w : m + "/items/" + A + "/resources"); return m }; E.getAddItemUrl = function (q, A, w) {
                                                                var m =
                                                                        ""; m = ""; q && A && (m = E.getUserContentUrl(q, A, w), m += "/addItem"); return m
                                                        }; E.getDeleteItemUrl = function (q, A, w) { var m = ""; (q = E.getUserItemsUrl(q, A)) && (m = q + "/" + w + "/delete"); return m }; E.getUserItemsUrl = function (q, A, w) { var m = ""; m = ""; q && A && (m = E.getUserContentUrl(q, A, w), m += "/items"); return m }; E.getUpdateItemUrl = function (q, A, w, m) { var v = ""; v = ""; q && A && (v = E.getUserItemsUrl(q, A, m), v = v + "/" + w + "/update"); return v }; E.shareItemUrl = function (q, A, w, m) { var v = ""; v = ""; q && A && (v = E.getUserItemsUrl(q, A, m), v = v + "/" + w + "/share"); return v };
                                E.getHomeIndexUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/index.html"); return A }; E.getHomeMapViewerUrl = function (q, A) { var w = ""; if (q = E.getStandardPortalUrl(q)) w = q + "/home/webmap/viewer.html", w = A ? w + ("?webmap\x3d" + A) : w + "?useExisting\x3d1"; return w }; E.getHomeSceneViewerUrl = function (q, A) { var w = ""; if (q = E.getStandardPortalUrl(q)) w = q + "/home/webscene/viewer.html", A && (w += "?webscene\x3d" + A); return w }; E.getHomeGalleryUrl = function (q) {
                                        var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/gallery.html");
                                        return A
                                }; E.getHomeGroupsUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/groups.html"); return A }; E.getHomeMyContentUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/content.html"); return A }; E.getHomeMyOrganizationUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/organization.html"); return A }; E.getHomeUserUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/home/user.html"); return A }; E.getPortalHelpUrl = function (q, A) {
                                        var w = ""; (q = E.getStandardPortalUrl(q)) &&
                                                (w = q + "/portalhelp/" + (A || "en") + "/portal/"); return w
                                }; E.getPortalAdminHelpUrl = function (q, A) { var w = ""; (q = E.getStandardPortalUrl(q)) && (w = q + "/portalhelp/" + (A || "en") + "/admin/help/"); return w }; E.getPortalProxyUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/proxy"); return A }; E.getOAuth2SignOutUrl = function (q) { var A = ""; (q = E.getStandardPortalUrl(q)) && (A = q + "/sharing/rest/oauth2/signout"); return A }; E.getNewPrintUrl = function (q) {
                                        var A = ""; if (q = E.getStandardPortalUrl(q)) q = E.setHttpProtocol(q),
                                                A = q + "/sharing/tools/newPrint"; return A
                                }; E.getSwitchAccoutnsUrl = function (q, A, w) { var m = ""; if (q = E.getStandardPortalUrl(q)) m = q + "/home/pages/Account/manage_accounts.html#client_id\x3d" + A, w && (m += "\x26redirect_uri\x3d" + w); m && (m = E.setHttpsProtocol(m)); return m }; E.getArcgisOnlineUrl = function (q) { return q.endsWith("mapsdevext.arcgis.com") || q.endsWith("mapsdevext.arcgis.com/") ? "https://devext.arcgis.com" : q.endsWith("mapsqa.arcgis.com") || q.endsWith("mapsqa.arcgis.com/") ? "https://qaext.arcgis.com" : "https://www.arcgis.com" };
                                return E
                        })
                }, "jimu/shared/utils": function () {
                        define([], function () {
                                function E(w, m) {
                                        function v(r, l) {
                                                var k, n, d = "widgetOnScreen" === r; if (w[r]) {
                                                        if (w[r].groups) for (k = 0; k < w[r].groups.length; k++) { var c = w[r].groups[k]; l(c, { index: k, isWidget: !1, groupId: c.id, isThemeWidget: !1, isOnScreen: d }); if (w[r].groups[k].widgets) for (n = 0; n < w[r].groups[k].widgets.length; n++) { var g = w[r].groups[k].widgets[n]; l(g, { index: n, isWidget: !0, groupId: c.id, isThemeWidget: g.uri && -1 < g.uri.indexOf("themes/" + w.theme.name), isOnScreen: d }) } } if (w[r].widgets) for (k =
                                                                0; k < w[r].widgets.length; k++)g = w[r].widgets[k], l(w[r].widgets[k], { index: k, isWidget: !0, groupId: r, isThemeWidget: g.uri && -1 < g.uri.indexOf("themes/" + w.theme.name), isOnScreen: d })
                                                }
                                        } v("widgetOnScreen", m); v("widgetPool", m)
                                } var q = {}, A = "inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwitched isController hasVersionManager isThemeWidget supportMultiInstance mirrorIconForRTL".split(" "); q.visitElement = E; q.getConfigElementById = function (w,
                                        m) { var v; if ("map" === m) return w.map; E(w, function (r) { if (r.id === m) return v = r, !0 }); return v }; q.getConfigElementByLabel = function (w, m) { var v; if ("map" === m) return w.map; E(w, function (r) { if (r.label || r.name === m) return v = r, !0 }); return v }; q.getConfigElementsByName = function (w, m) { var v = []; if ("map" === m) return [w.map]; E(w, function (r) { r.name === m && v.push(r) }); return v }; q.getWidgetNameFromUri = function (w) { w = w.split("/"); w.pop(); return w.pop() }; q.getAmdFolderFromUri = function (w) {
                                                w = w.split("/"); w.pop(); return w.join("/") +
                                                        "/"
                                        }; q.widgetProperties = A; q.processWidgetProperties = function (w) { "undefined" === typeof w.properties.isController && (w.properties.isController = !1); "undefined" === typeof w.properties.isThemeWidget && (w.properties.isThemeWidget = !1); "undefined" === typeof w.properties.hasVersionManager && (w.properties.hasVersionManager = !1); "undefined" === typeof w.properties.mirrorIconForRTL && (w.properties.mirrorIconForRTL = !1); A.forEach(function (m) { "undefined" === typeof w.properties[m] && (w.properties[m] = !0) }) }; q.getControllerWidgets =
                                                function (w) { var m = []; w.visitElement(function (v) { v.isController && m.push(v) }); return m }; q.addI18NLabelToManifest = function (w, m, v) {
                                                        function r(n, d) {
                                                                d[l] && (w.i18nLabels[n] = d[l]); "theme" === w.category && (w.layouts && w.layouts.forEach(function (c) { w["i18nLabels_layout_" + c.name] || (w["i18nLabels_layout_" + c.name] = {}); w["i18nLabels_layout_" + c.name][n] = d["_layout_" + c.name] }), w.styles && w.styles.forEach(function (c) {
                                                                        w["i18nLabels_style_" + c.name] || (w["i18nLabels_style_" + c.name] = {}); w["i18nLabels_style_" + c.name][n] = d["_style_" +
                                                                                c.name]
                                                                })); "widget" === w.category && w.featureActions && w.featureActions.forEach(function (c) { w["i18nLabels_featureAction_" + c.name] || (w["i18nLabels_featureAction_" + c.name] = {}); w["i18nLabels_featureAction_" + c.name][n] = d["_featureAction_" + c.name] })
                                                        } w.i18nLabels = {}; var l = "widget" === w.category ? "_widgetLabel" : "_themeLabel"; m && m.root && m.root[l] && (w.i18nLabels.defaultLabel = m.root[l], "theme" === w.category && (w.layouts && w.layouts.forEach(function (n) {
                                                                w["i18nLabels_layout_" + n.name] = {}; w["i18nLabels_layout_" + n.name].defaultLabel =
                                                                        m.root["_layout_" + n.name]
                                                        }), w.styles && w.styles.forEach(function (n) { w["i18nLabels_style_" + n.name] = {}; w["i18nLabels_style_" + n.name].defaultLabel = m.root["_style_" + n.name] })), "widget" === w.category && w.featureActions && w.featureActions.forEach(function (n) { w["i18nLabels_featureAction_" + n.name] = {}; w["i18nLabels_featureAction_" + n.name].defaultLabel = m.root["_featureAction_" + n.name] })); for (var k in v) r(k, v[k])
                                                }; q.isHostedService = function (w) {
                                                        if (!w) return !1; var m = -1 !== w.indexOf(".arcgis.com/"); w = -1 !== w.indexOf("//services") ||
                                                                -1 !== w.indexOf("//tiles") || -1 !== w.indexOf("//features"); return m && w
                                                }; return q
                        })
                }, "jimu/accessibleUtils": function () {
                        define("dojo/_base/lang dojo/_base/html dojo/query esri/lang dojo/keys dojo/on".split(" "), function (E, q, A, w, m, v) {
                                var r = {
                                        firstFocusNodeClass: "firstFocusNode", lastFocusNodeClass: "lastFocusNode", lastFocusNodeClassInDOM: "lastFocusNodeInDOM", isInNavMode: function () { return q.hasClass(document.body, "jimu-nav-mode") ? !0 : !1 }, initTabIndexAndOrder: function (l) {
                                                var k = r.getFirstFocusNode(l.domNode, l.inPanel),
                                                n = r.getLastFocusNode(l.domNode); k && !n && (n = k); l.isController && (k = n = null); r.initFirstFocusNode(l.domNode, k); r.initLastFocusNode(l.domNode, n); r.addLabelToWidgetDOM(l)
                                        }, addLabelToWidgetDOM: function (l) { if (0 <= ["ZoomSlider", "AttributeTable", "Search", "ExtentNavigate", "OverviewMap"].indexOf(l.name)) { var k = w.substitute({ widgetLabel: l.name }, window.jimuNls.widgetToolTip); q.setAttr(l.domNode, "aria-label", k) } }, isOnScreenNotCloseableOffPanel: function (l) { return l.isOnScreen && !l.inPanel && !0 !== l.closeable }, preventMapNavigation: function (l) {
                                                0 <=
                                                [m.NUMPAD_PLUS, 61, 187, m.NUMPAD_MINUS, 173, 189, m.UP_ARROW, m.NUMPAD_8, m.RIGHT_ARROW, m.NUMPAD_6, m.DOWN_ARROW, m.NUMPAD_2, m.LEFT_ARROW, m.NUMPAD_4, m.PAGE_UP, m.NUMPAD_9, m.PAGE_DOWN, m.NUMPAD_3, m.END, m.NUMPAD_1, m.HOME, m.NUMPAD_7].indexOf(l.keyCode) && l.stopPropagation()
                                        }, _addAttrsOnWidgetDom: function (l) { var k = 0 <= ["MyLocation", "HomeButton", "FullScreen"].indexOf(l.name) ? "button" : ""; l.inPanel || q.setAttr(l.domNode, "role", k) }, initWidgetCancelEvent: function (l) {
                                                this._addAttrsOnWidgetDom(l); v(l.domNode, "keydown", E.hitch(this,
                                                        function (k) {
                                                                r.preventMapNavigation(k); var n = k.target; l.inPanel || 0 > [m.ENTER, m.ESCAPE].indexOf(k.keyCode) || (r.isOnScreenNotCloseableOffPanel(l) ? k.keyCode === m.ENTER && q.hasClass(n, l.baseClass) ? (k.preventDefault(), r.focusFirstFocusNode(l.domNode)) : k.keyCode === m.ESCAPE && (q.hasClass(n, l.baseClass) ? "Splash" !== l.name && (n = l.domNode.parentNode, "map" === q.getAttr(n, "id") ? (k.preventDefault(), n.focus()) : (k = "jimu-layout-manager" === q.getAttr(n, "id") ? l.domNode : l.domNode.parentNode, r.trapToNextFocusContainer(k))) : (k.stopPropagation(),
                                                                        l.domNode.focus())) : k.keyCode !== m.ESCAPE || q.hasClass(n, l.baseClass) || (l.domNode.focus(), l.onClose(), k.preventDefault(), k.stopPropagation()))
                                                        }))
                                        }, initFirstFocusNode: function (l, k) {
                                                var n = r.getFirstFocusNode(l); n && (q.removeClass(n, r.firstFocusNodeClass), n.firstNodeEvent && n.firstNodeEvent.remove(), n === l && (q.setAttr(n, "tabindex", null), q.setAttr(n, "role", ""))); k && (k === l && (q.setAttr(k, "tabindex", 0), q.setAttr(k, "role", "document")), q.addClass(k, r.firstFocusNodeClass), k.firstNodeEvent = v(k, "keydown", E.hitch(this,
                                                        function (d) { q.hasClass(d.target, r.firstFocusNodeClass) && d.keyCode === m.TAB && (window.currentMsgPopup && window.currentMsgPopup.firstFocusNode ? (window.currentMsgPopup.focusedNodeBeforeOpen = d.target, d.preventDefault(), window.currentMsgPopup.firstFocusNode.focus()) : !r.tryToFocusSplashWidget(d, l) && d.shiftKey && (d.preventDefault(), d = r.getLastFocusNode(l), r.isDomFocusable(d) ? d.focus() : (d = r.getFocusNodesInDom(d), 1 <= d.length && d[d.length - 1].focus()))) })))
                                        }, tryToFocusSplashWidget: function (l, k) {
                                                var n = A(".jimu-widget-splash",
                                                        A("#jimu-layout-manager")[0])[0]; return n && "none" !== q.getStyle(n, "display") && n !== k ? (l.stopPropagation(), l.preventDefault(), A("." + r.firstFocusNodeClass, n)[0].focus(), !0) : !1
                                        }, initLastFocusNode: function (l, k) {
                                                var n = r.getLastFocusNode(l); n && (q.removeClass(n, r.lastFocusNodeClass), n.lastNodeEvent && n.lastNodeEvent.remove(), n === l && q.setAttr(n, "tabindex", null)); k && (k === l && q.setAttr(k, "tabindex", 0), q.addClass(k, r.lastFocusNodeClass), k.lastNodeEvent = v(k, "keydown", E.hitch(this, function (d) {
                                                        if (!d.shiftKey && d.keyCode ===
                                                                m.TAB) if (l === k || q.hasClass(d.target, r.lastFocusNodeClass) && r.isDomFocusable(d.target)) d.preventDefault(), this.focusFirstFocusNode(l); else { var c = this.getFocusNodesInDom(k); if (0 === c.length || r._isLastFromInnerNodes(c, d.target)) d.preventDefault(), this.focusFirstFocusNode(l) }
                                                })))
                                        }, _isLastFromInnerNodes: function (l, k) { var n = !1; if (k === l[l.length - 1]) n = !0; else for (var d = 0; d < l.length; d++)if (k === l[d] && q.hasClass(l[d], r.lastFocusNodeClassInDOM)) { n = !0; break } return n }, focusFirstFocusNode: function (l) {
                                                var k = A("." +
                                                        r.firstFocusNodeClass, l)[0]; (k ? k : l).focus()
                                        }, getFirstFocusNode: function (l, k) { var n = q.hasClass(l, r.firstFocusNodeClass) ? l : A("." + r.firstFocusNodeClass, l)[0]; !n && k && (n = l, null === q.getAttr(n, "tabindex") && q.setAttr(n, "tabindex", "0")); return n }, getLastFocusNode: function (l) { return q.hasClass(l, r.lastFocusNodeClass) ? l : A("." + r.lastFocusNodeClass, l)[0] }, getFirstSkipLink: function () { return A("#skipContainer a")[0] }, focusOnFirstSkipLink: function () { r.getFirstSkipLink().focus() }, traversalDom: function (l, k) {
                                                k = k ? k :
                                                        []; for (var n = l.childNodes, d = 0; d < n.length; d++)l = n[d], 1 === l.nodeType && (k.push(l), r.traversalDom(l, k)); return k
                                        }, getFocusNodesInDom: function (l) { l = r.traversalDom(l); for (var k = [], n = 0; n < l.length; n++) { var d = l[n]; r.isDomFocusable(d) && k.push(d) } return k }, isDomFocusable: function (l) {
                                                var k = ["A", "INPUT", "BUTTON", "SELECT", "TEXTAREA"], n = "hidden" !== q.getAttr(l, "type") && "none" !== q.getStyle(l, "display"), d = !0 !== q.getAttr(l, "disabled"), c = parseInt(q.getAttr(l, "tabindex"), 10); return n && d && (0 <= k.indexOf(l.tagName) && -1 !==
                                                        c || 0 > k.indexOf(l.tagName) && 0 <= c) ? !0 : !1
                                        }, getFrameNodesByAsc: function () { for (var l = A("#jimu-layout-manager")[0].children, k = [], n = 0; n < l.length; n++) { var d = l[n]; 0 < parseInt(q.getAttr(d, "tabindex"), 10) && "none" !== q.getStyle(d, "display") && k.push(d) } k.sort(function (c, g) { c = parseInt(q.getAttr(c, "tabindex"), 10); g = parseInt(q.getAttr(g, "tabindex"), 10); return c < g ? -1 : c === g ? 0 : 1 }); return k }, trapToNextFocusContainer: function (l) {
                                                var k = r.getFrameNodesByAsc(), n = null; if ("skipContainer" === q.getAttr(l, "id")) return (n = k[0]) &&
                                                        n.focus(), n; k.unshift(r.getFirstSkipLink()); l = parseInt(q.getAttr(l, "tabindex"), 10); for (var d = 0; d < k.length; d++)if (parseInt(q.getAttr(k[d], "tabindex"), 10) === l) { n = d === k.length - 1 ? k[0] : k[d + 1]; break } k = !r.isInNavMode() && "link" === q.getAttr(n, "role"); n && !k && n.focus(); return n
                                        }, isAutoFocusFirstNodeWidget: function (l) {
                                                var k = !0; r.isOnScreenNotCloseableOffPanel(l) ? k = !1 : l.openAtStart ? l.openAtStartAysn ? k = l.openAtStartAysn = !1 : l._isFirstOpenAtStart || (l._isFirstOpenAtStart = !0, k = !1) : l.isOnScreen && "widgetOnScreen" !==
                                                        l.gid ? k = !1 : l.inGroupPanel && (k = !1); return k
                                        }, _getTooltipLabel: function (l, k) { var n = q.getAttr(l, "aria-label"); l = q.getAttr(l, "title"); return n || l || k }, addTooltipByDomNode: function (l, k, n) {
                                                l.defaultPosition = ["below-centered", "above-centered", "after-centered", "before-centered"]; var d; v(k, "focus", E.hitch(this, function (c) {
                                                        r.isInNavMode() && (d && q.setAttr(d, "role", "presentation"), l.show(r._getTooltipLabel(k, n) + "\x26nbsp;\x26nbsp;", c.target), d || (d = A(".dijitTooltipContainer", document.body)[0], q.setAttr(d, "role",
                                                                "presentation")))
                                                })); v(k, "blur", E.hitch(this, function (c) { l && l.hide(c.target) }))
                                        }
                                }; return r
                        })
                }, "jimu/zoomToUtils": function () {
                        define("dojo/_base/lang dojo/_base/array dojo/Deferred esri/config esri/graphic esri/graphicsUtils esri/geometry/Extent esri/geometry/Point esri/SpatialReference esri/geometry/webMercatorUtils esri/tasks/ProjectParameters".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                var c = {
                                        zoomToFeatureSet: function (g, b, e) {
                                                var a = b.features && 0 < b.features.length && b.features[0].getLayer && b.features[0].getLayer();
                                                a = a ? a.id : null; b = c.graphicsExtent(b.features, e); return c.zoomToExtent(g, b, a)
                                        }, zoomToExtent: function (g, b, e) {
                                                if (!g || !c.isValidExtent(b)) { var a = new A; a.reject(); return a } e ? (a = new A, require(["jimu/LayerStructure"], function (f) { (f = f.getInstance().getNodeById(e)) ? f.zoomTo(b).then(function () { a.resolve() }, function () { a.reject() }) : c.projectToMapSpatialReference(g, b).then(function (h) { b.isSinglePoint && (h = c.convertSinglePointExtent(g, h)); g.setExtent(h, !0); a.resolve() }, function () { a.reject() }) })) : a = c.projectToMapSpatialReference(g,
                                                        b).then(function (f) { b.isSinglePoint && (f = c.convertSinglePointExtent(g, f)); return g.setExtent(f, !0) }); return a
                                        }, isValidExtent: function (g) { return g && c.isTrueOrZero(g.xmin) && c.isTrueOrZero(g.ymin) && c.isTrueOrZero(g.xmax) && c.isTrueOrZero(g.ymax) }
                                }; c.isVaildExtent = c.isValidExtent; c.isTrueOrZero = function (g) { return 0 === g ? !0 : !!g }; c.convertSinglePointExtent = function (g, b) { var e = g.getScale(); if (e = c.getMedianScale(g, e, 0)) b = c.adjustHeightToAspectRatio(g, b), b = c.getExtentForScale(b, g.width, e); return b }; c.graphicsExtent =
                                        function (g, b) {
                                                var e = null; try {
                                                        if (g && 1 === g.length && g[0].geometry && "esri.geometry.Multipoint" === g[0].geometry.declaredClass && 1 === g[0].geometry.points.length) { var a = g[0].geometry.points[0], f = new l(a[0], a[1], g[0].geometry.spatialReference); g = [new m(f)] } if (g && 1 === g.length && g[0].geometry && "esri.geometry.Point" === g[0].geometry.declaredClass) { var h = g[0].geometry; e = new r(h.x - 1E-4, h.y - 1E-4, h.x + 1E-4, h.y + 1E-4, h.spatialReference); e.isSinglePoint = !0 } else g && 0 < g.length && (e = v.graphicsExtent(g)) && "number" === typeof b &&
                                                                0 < b && (e = e.expand(b))
                                                } catch (p) { console.error(p) } return e
                                        }; c.projectToMapSpatialReference = function (g, b) { return c.projectToSpatialReference(b, g.spatialReference) }; c.projectToSpatialReference = function (g, b) {
                                                var e = new A, a = g; if (b && g) if (b.equals(g.spatialReference)) e.resolve(a); else if (b.isWebMercator() && g.spatialReference.equals(new k(4326))) a = n.geographicToWebMercator(g), a.isSinglePoint = g.isSinglePoint, e.resolve(a); else if (b.equals(new k(4326)) && g.spatialReference.isWebMercator()) a = n.webMercatorToGeographic(g),
                                                        a.isSinglePoint = g.isSinglePoint, e.resolve(a); else { var f = w && w.defaults && w.defaults.geometryService; if (f && "esri.tasks.GeometryService" === f.declaredClass) { var h = new d; h.geometries = [g]; h.outSR = b; f.project(h).then(function (p) { (a = p && 0 < p.length && p[0]) ? (a.isSinglePoint = g.isSinglePoint, e.resolve(a)) : e.reject() }, function () { }) } else e.reject() } else e.reject(); return e
                                        }; c.getMapLods = function (g) { var b = null; g._params && g._params.lods && (b = q.map(g._params.lods, E.hitch(this, function (e) { return e.toJson() }))); return b };
                                c.getMedianScale = function (g, b, e) { return c.getTargetScale(g, 2, b, e) }; c.getTargetScale = function (g, b, e, a) { g = c.getMapLods(g); var f = 1; if (g) { var h = [], p = []; q.forEach(g, function (B) { 0 < e && B.scale > e || (B.scale < a ? p.push(B.scale) : h.push(B.scale)) }); h.reverse(); 1 <= h.length ? (f = p.length ? p.length / g.length : 1, b = Math.floor((h.length - 1) / (b / f)), b = h[b]) : b = null } else b = 0 === e ? null : (e - a) / b; return b }; c.getScaleForNextTileLevel = function (g, b, e) {
                                        if (g = c.getMapLods(g)) {
                                                if (e) {
                                                        for (e = 0; e < g.length; e++)if (g[e].scale < b) return g[e].scale -
                                                                1; return g[g.length - 1].scale - 1
                                                } for (e = g.length - 1; 0 <= e; e--)if (g[e].scale > b) return g[e].scale + 1; return g[0].scale + 1
                                        } return e ? b - 1 : b + 1
                                }; c.adjustExtentToAspectRatio = function (g, b) { g = g.width / g.height; var e = b.getWidth() / b.getHeight(); e > g ? (g = b.getWidth() / g / 2, E.mixin(b, { ymin: b.getCenter().y - g, ymax: b.getCenter().y + g })) : e < g && (g = b.getHeight() * g / 2, E.mixin(b, { xmin: b.getCenter().x - g, xmax: b.getCenter().x + g })); return b }; c.adjustHeightToAspectRatio = function (g, b) {
                                        g = b.getWidth() * (g.height / g.width) / 5; E.mixin(b, {
                                                ymin: b.getCenter().y -
                                                        g, ymax: b.getCenter().y + g
                                        }); return b
                                }; c.getExtentForScale = function (g, b, e) { var a = 20015077 / 180, f = esri.config.defaults, h = esri.WKIDUnitConversion, p = g.spatialReference; if (p) { var B = p.wkid; var t = p.wkt } p = null; B ? p = h.values[h[B]] : t && -1 !== t.search(/^PROJCS/i) && (h = /UNIT\[([^\]]+)\]\]$/i.exec(t)) && h[1] && (p = parseFloat(h[1].split(",")[1])); return g.expand(e * b / (39.37 * (p || a) * f.screenDPI) / g.getWidth()) }; c.getScaleForExtent = function (g, b) {
                                        var e = 20015077 / 180, a = esri.config.defaults, f = esri.WKIDUnitConversion, h = g.spatialReference;
                                        if (h) { var p = h.wkid; var B = h.wkt } h = null; p ? h = f.values[f[p]] : B && -1 !== B.search(/^PROJCS/i) && (f = /UNIT\[([^\]]+)\]\]$/i.exec(B)) && f[1] && (h = parseFloat(f[1].split(",")[1])); return g.getWidth() / b * (h || e) * 39.37 * a.screenDPI
                                }; return c
                        })
                }, "libs/caja-html-sanitizer-minified": function () {
                        (function () {
                                var E = function () {
                                        function w(a) { return (a = ("" + a).match(g)) ? new k(n(a[1]), n(a[2]), n(a[3]), n(a[4]), n(a[5]), n(a[6]), n(a[7])) : null } function m(a, f) { return "string" == typeof a ? encodeURI(a).replace(f, v) : null } function v(a) {
                                                a = a.charCodeAt(0);
                                                return "%" + "0123456789ABCDEF".charAt(a >> 4 & 15) + "0123456789ABCDEF".charAt(a & 15)
                                        } function r(a) { if (null === a) return null; a = a.replace(/(^|\/)\.(?:\/|$)/g, "$1").replace(/\/{2,}/g, "/"); for (var f = d, h; (h = a.replace(f, "$1")) != a; a = h); return a } function l(a, f) {
                                                a = a.R(); var h = f.K(); h ? a.fa(f.j) : h = f.V(); h ? a.ca(f.m) : h = f.W(); h ? a.da(f.k) : h = f.Y(); var p = f.g, B = r(p); if (h) a.ba(f.T()), B = B && B.replace(c, ""); else if (h = !!p) {
                                                        if (47 !== B.charCodeAt(0)) {
                                                                B = r(a.g || "").replace(c, ""); var t = B.lastIndexOf("/") + 1; B = r((t ? B.substring(0, t) : "") +
                                                                        r(p)).replace(c, "")
                                                        }
                                                } else B = B && B.replace(c, ""), B !== p && a.G(B); h ? a.G(B) : h = f.Z(); h ? a.M(f.l) : h = f.X(); h && a.ea(f.n); return a
                                        } function k(a, f, h, p, B, t, u) { this.j = a; this.m = f; this.k = h; this.h = p; this.g = B; this.l = t; this.n = u } function n(a) { return "string" == typeof a && 0 < a.length ? a : null } var d = RegExp(/(\/|^)(?:[^./][^/]*|\.{2,}(?:[^./][^/]*)|\.{3,}[^/]*)\/\.\.(?:\/|$)/), c = /^(?:\.\.\/)*(?:\.\.$)?/; k.prototype.toString = function () {
                                                var a = []; null !== this.j && a.push(this.j, ":"); null !== this.k && (a.push("//"), null !== this.m && a.push(this.m,
                                                        "@"), a.push(this.k), null !== this.h && a.push(":", this.h.toString())); null !== this.g && a.push(this.g); null !== this.l && a.push("?", this.l); null !== this.n && a.push("#", this.n); return a.join("")
                                        }; k.prototype.R = function () { return new k(this.j, this.m, this.k, this.h, this.g, this.l, this.n) }; k.prototype.U = function () { return this.j && decodeURIComponent(this.j).toLowerCase() }; k.prototype.fa = function (a) { this.j = a ? a : null }; k.prototype.K = function () { return null !== this.j }; k.prototype.ca = function (a) { this.m = a ? a : null }; k.prototype.V =
                                                function () { return null !== this.m }; k.prototype.da = function (a) { this.k = a ? a : null; this.G(this.g) }; k.prototype.W = function () { return null !== this.k }; k.prototype.T = function () { return this.h && decodeURIComponent(this.h) }; k.prototype.ba = function (a) { if (a) { a = Number(a); if (a !== (a & 65535)) throw Error("Bad port number " + a); this.h = "" + a } else this.h = null }; k.prototype.Y = function () { return null !== this.h }; k.prototype.S = function () { return this.g && decodeURIComponent(this.g) }; k.prototype.G = function (a) {
                                                        a ? (a = "" + a, this.g = !this.k || /^\//.test(a) ?
                                                                a : "/" + a) : this.g = null
                                                }; k.prototype.M = function (a) { this.l = a ? a : null }; k.prototype.Z = function () { return null !== this.l }; k.prototype.aa = function (a) {
                                                        if ("object" === typeof a && !(a instanceof Array) && (a instanceof Object || "[object Array]" !== Object.prototype.toString.call(a))) { var f = [], h = -1; for (t in a) { var p = a[t]; "string" === typeof p && (f[++h] = t, f[++h] = p) } a = f } f = []; h = ""; for (var B = 0; B < a.length;) { var t = a[B++]; p = a[B++]; f.push(h, encodeURIComponent(t.toString())); h = "\x26"; p && f.push("\x3d", encodeURIComponent(p.toString())) } this.l =
                                                                f.join("")
                                                }; k.prototype.ea = function (a) { this.n = a ? a : null }; k.prototype.X = function () { return null !== this.n }; var g = /^(?:([^:/?#]+):)?(?:\/\/(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/, b = /[#\/\?@]/g, e = /[#\?]/g; k.parse = w; k.create = function (a, f, h, p, B, t, u) {
                                                        a = new k(m(a, b), m(f, b), "string" == typeof h ? encodeURIComponent(h) : null, 0 < p ? p.toString() : null, m(B, e), null, "string" == typeof u ? encodeURIComponent(u) : null); t && ("string" === typeof t ? a.M(t.replace(/[^?&=0-9A-Za-z_\-~.%]/g, v)) : a.aa(t));
                                                        return a
                                                }; k.$ = l; k.ja = r; k.ua = { oa: function (a) { return /\.html$/.test(w(a).S()) ? "text/html" : "application/javascript" }, $: function (a, f) { return a ? l(w(a), w(f)).toString() : "" + f } }; return k
                                }(); "undefined" !== typeof window && (window.URI = E); var q = { e: { NONE: 0, URI: 1, URI_FRAGMENT: 11, SCRIPT: 2, STYLE: 3, HTML: 12, ID: 4, IDREF: 5, IDREFS: 6, GLOBAL_NAME: 7, LOCAL_NAME: 8, CLASSES: 9, FRAME_TARGET: 10, MEDIA_QUERY: 13 } }; q.atype = q.e; q.w = {
                                        "*::class": 9, "*::dir": 0, "*::draggable": 0, "*::hidden": 0, "*::id": 4, "*::inert": 0, "*::itemprop": 0, "*::itemref": 6,
                                        "*::itemscope": 0, "*::lang": 0, "*::onblur": 2, "*::onchange": 2, "*::onclick": 2, "*::ondblclick": 2, "*::onerror": 2, "*::onfocus": 2, "*::onkeydown": 2, "*::onkeypress": 2, "*::onkeyup": 2, "*::onload": 2, "*::onmousedown": 2, "*::onmousemove": 2, "*::onmouseout": 2, "*::onmouseover": 2, "*::onmouseup": 2, "*::onreset": 2, "*::onscroll": 2, "*::onselect": 2, "*::onsubmit": 2, "*::ontouchcancel": 2, "*::ontouchend": 2, "*::ontouchenter": 2, "*::ontouchleave": 2, "*::ontouchmove": 2, "*::ontouchstart": 2, "*::onunload": 2, "*::spellcheck": 0, "*::style": 3,
                                        "*::tabindex": 0, "*::title": 0, "*::translate": 0, "a::accesskey": 0, "a::coords": 0, "a::href": 1, "a::hreflang": 0, "a::name": 7, "a::onblur": 2, "a::onfocus": 2, "a::shape": 0, "a::target": 10, "a::type": 0, "area::accesskey": 0, "area::alt": 0, "area::coords": 0, "area::href": 1, "area::nohref": 0, "area::onblur": 2, "area::onfocus": 2, "area::shape": 0, "area::target": 10, "audio::controls": 0, "audio::loop": 0, "audio::mediagroup": 5, "audio::muted": 0, "audio::preload": 0, "audio::src": 1, "bdo::dir": 0, "blockquote::cite": 1, "br::clear": 0, "button::accesskey": 0,
                                        "button::disabled": 0, "button::name": 8, "button::onblur": 2, "button::onfocus": 2, "button::type": 0, "button::value": 0, "canvas::height": 0, "canvas::width": 0, "caption::align": 0, "col::align": 0, "col::char": 0, "col::charoff": 0, "col::span": 0, "col::valign": 0, "col::width": 0, "colgroup::align": 0, "colgroup::char": 0, "colgroup::charoff": 0, "colgroup::span": 0, "colgroup::valign": 0, "colgroup::width": 0, "command::checked": 0, "command::command": 5, "command::disabled": 0, "command::icon": 1, "command::label": 0, "command::radiogroup": 0,
                                        "command::type": 0, "data::value": 0, "del::cite": 1, "del::datetime": 0, "details::open": 0, "dir::compact": 0, "div::align": 0, "dl::compact": 0, "fieldset::disabled": 0, "font::color": 0, "font::face": 0, "font::size": 0, "form::accept": 0, "form::action": 1, "form::autocomplete": 0, "form::enctype": 0, "form::method": 0, "form::name": 7, "form::novalidate": 0, "form::onreset": 2, "form::onsubmit": 2, "form::target": 10, "h1::align": 0, "h2::align": 0, "h3::align": 0, "h4::align": 0, "h5::align": 0, "h6::align": 0, "hr::align": 0, "hr::noshade": 0, "hr::size": 0,
                                        "hr::width": 0, "iframe::align": 0, "iframe::frameborder": 0, "iframe::height": 0, "iframe::marginheight": 0, "iframe::marginwidth": 0, "iframe::width": 0, "img::align": 0, "img::alt": 0, "img::border": 0, "img::height": 0, "img::hspace": 0, "img::ismap": 0, "img::name": 7, "img::src": 1, "img::usemap": 11, "img::vspace": 0, "img::width": 0, "input::accept": 0, "input::accesskey": 0, "input::align": 0, "input::alt": 0, "input::autocomplete": 0, "input::checked": 0, "input::disabled": 0, "input::inputmode": 0, "input::ismap": 0, "input::list": 5, "input::max": 0,
                                        "input::maxlength": 0, "input::min": 0, "input::multiple": 0, "input::name": 8, "input::onblur": 2, "input::onchange": 2, "input::onfocus": 2, "input::onselect": 2, "input::pattern": 0, "input::placeholder": 0, "input::readonly": 0, "input::required": 0, "input::size": 0, "input::src": 1, "input::step": 0, "input::type": 0, "input::usemap": 11, "input::value": 0, "ins::cite": 1, "ins::datetime": 0, "label::accesskey": 0, "label::for": 5, "label::onblur": 2, "label::onfocus": 2, "legend::accesskey": 0, "legend::align": 0, "li::type": 0, "li::value": 0,
                                        "map::name": 7, "menu::compact": 0, "menu::label": 0, "menu::type": 0, "meter::high": 0, "meter::low": 0, "meter::max": 0, "meter::min": 0, "meter::optimum": 0, "meter::value": 0, "ol::compact": 0, "ol::reversed": 0, "ol::start": 0, "ol::type": 0, "optgroup::disabled": 0, "optgroup::label": 0, "option::disabled": 0, "option::label": 0, "option::selected": 0, "option::value": 0, "output::for": 6, "output::name": 8, "p::align": 0, "pre::width": 0, "progress::max": 0, "progress::min": 0, "progress::value": 0, "q::cite": 1, "select::autocomplete": 0, "select::disabled": 0,
                                        "select::multiple": 0, "select::name": 8, "select::onblur": 2, "select::onchange": 2, "select::onfocus": 2, "select::required": 0, "select::size": 0, "source::type": 0, "table::align": 0, "table::bgcolor": 0, "table::border": 0, "table::cellpadding": 0, "table::cellspacing": 0, "table::frame": 0, "table::rules": 0, "table::summary": 0, "table::width": 0, "tbody::align": 0, "tbody::char": 0, "tbody::charoff": 0, "tbody::valign": 0, "td::abbr": 0, "td::align": 0, "td::axis": 0, "td::bgcolor": 0, "td::char": 0, "td::charoff": 0, "td::colspan": 0, "td::headers": 6,
                                        "td::height": 0, "td::nowrap": 0, "td::rowspan": 0, "td::scope": 0, "td::valign": 0, "td::width": 0, "textarea::accesskey": 0, "textarea::autocomplete": 0, "textarea::cols": 0, "textarea::disabled": 0, "textarea::inputmode": 0, "textarea::name": 8, "textarea::onblur": 2, "textarea::onchange": 2, "textarea::onfocus": 2, "textarea::onselect": 2, "textarea::placeholder": 0, "textarea::readonly": 0, "textarea::required": 0, "textarea::rows": 0, "textarea::wrap": 0, "tfoot::align": 0, "tfoot::char": 0, "tfoot::charoff": 0, "tfoot::valign": 0, "th::abbr": 0,
                                        "th::align": 0, "th::axis": 0, "th::bgcolor": 0, "th::char": 0, "th::charoff": 0, "th::colspan": 0, "th::headers": 6, "th::height": 0, "th::nowrap": 0, "th::rowspan": 0, "th::scope": 0, "th::valign": 0, "th::width": 0, "thead::align": 0, "thead::char": 0, "thead::charoff": 0, "thead::valign": 0, "tr::align": 0, "tr::bgcolor": 0, "tr::char": 0, "tr::charoff": 0, "tr::valign": 0, "track::default": 0, "track::kind": 0, "track::label": 0, "track::srclang": 0, "ul::compact": 0, "ul::type": 0, "video::controls": 0, "video::height": 0, "video::loop": 0, "video::mediagroup": 5,
                                        "video::muted": 0, "video::poster": 1, "video::preload": 0, "video::src": 1, "video::width": 0
                                }; q.ATTRIBS = q.w; q.c = { OPTIONAL_ENDTAG: 1, EMPTY: 2, CDATA: 4, RCDATA: 8, UNSAFE: 16, FOLDABLE: 32, SCRIPT: 64, STYLE: 128, VIRTUALIZED: 256 }; q.eflags = q.c; q.f = {
                                        a: 0, abbr: 0, acronym: 0, address: 0, applet: 272, area: 2, article: 0, aside: 0, audio: 0, b: 0, base: 274, basefont: 274, bdi: 0, bdo: 0, big: 0, blockquote: 0, body: 305, br: 2, button: 0, canvas: 0, caption: 0, center: 0, cite: 0, code: 0, col: 2, colgroup: 1, command: 2, data: 0, datalist: 0, dd: 1, del: 0, details: 0, dfn: 0, dialog: 272,
                                        dir: 0, div: 0, dl: 0, dt: 1, em: 0, fieldset: 0, figcaption: 0, figure: 0, font: 0, footer: 0, form: 0, frame: 274, frameset: 272, h1: 0, h2: 0, h3: 0, h4: 0, h5: 0, h6: 0, head: 305, header: 0, hgroup: 0, hr: 2, html: 305, i: 0, iframe: 4, img: 2, input: 2, ins: 0, isindex: 274, kbd: 0, keygen: 274, label: 0, legend: 0, li: 1, link: 274, map: 0, mark: 0, menu: 0, meta: 274, meter: 0, nav: 0, nobr: 0, noembed: 276, noframes: 276, noscript: 276, object: 272, ol: 0, optgroup: 0, option: 1, output: 0, p: 1, param: 274, pre: 0, progress: 0, q: 0, s: 0, samp: 0, script: 84, section: 0, select: 0, small: 0, source: 2, span: 0,
                                        strike: 0, strong: 0, style: 148, sub: 0, summary: 0, sup: 0, table: 0, tbody: 1, td: 1, textarea: 8, tfoot: 1, th: 1, thead: 1, time: 0, title: 280, tr: 1, track: 2, tt: 0, u: 0, ul: 0, "var": 0, video: 0, wbr: 2
                                }; q.ELEMENTS = q.f; q.O = {
                                        a: "HTMLAnchorElement", abbr: "HTMLElement", acronym: "HTMLElement", address: "HTMLElement", applet: "HTMLAppletElement", area: "HTMLAreaElement", article: "HTMLElement", aside: "HTMLElement", audio: "HTMLAudioElement", b: "HTMLElement", base: "HTMLBaseElement", basefont: "HTMLBaseFontElement", bdi: "HTMLElement", bdo: "HTMLElement", big: "HTMLElement",
                                        blockquote: "HTMLQuoteElement", body: "HTMLBodyElement", br: "HTMLBRElement", button: "HTMLButtonElement", canvas: "HTMLCanvasElement", caption: "HTMLTableCaptionElement", center: "HTMLElement", cite: "HTMLElement", code: "HTMLElement", col: "HTMLTableColElement", colgroup: "HTMLTableColElement", command: "HTMLCommandElement", data: "HTMLElement", datalist: "HTMLDataListElement", dd: "HTMLElement", del: "HTMLModElement", details: "HTMLDetailsElement", dfn: "HTMLElement", dialog: "HTMLDialogElement", dir: "HTMLDirectoryElement", div: "HTMLDivElement",
                                        dl: "HTMLDListElement", dt: "HTMLElement", em: "HTMLElement", fieldset: "HTMLFieldSetElement", figcaption: "HTMLElement", figure: "HTMLElement", font: "HTMLFontElement", footer: "HTMLElement", form: "HTMLFormElement", frame: "HTMLFrameElement", frameset: "HTMLFrameSetElement", h1: "HTMLHeadingElement", h2: "HTMLHeadingElement", h3: "HTMLHeadingElement", h4: "HTMLHeadingElement", h5: "HTMLHeadingElement", h6: "HTMLHeadingElement", head: "HTMLHeadElement", header: "HTMLElement", hgroup: "HTMLElement", hr: "HTMLHRElement", html: "HTMLHtmlElement",
                                        i: "HTMLElement", iframe: "HTMLIFrameElement", img: "HTMLImageElement", input: "HTMLInputElement", ins: "HTMLModElement", isindex: "HTMLUnknownElement", kbd: "HTMLElement", keygen: "HTMLKeygenElement", label: "HTMLLabelElement", legend: "HTMLLegendElement", li: "HTMLLIElement", link: "HTMLLinkElement", map: "HTMLMapElement", mark: "HTMLElement", menu: "HTMLMenuElement", meta: "HTMLMetaElement", meter: "HTMLMeterElement", nav: "HTMLElement", nobr: "HTMLElement", noembed: "HTMLElement", noframes: "HTMLElement", noscript: "HTMLElement", object: "HTMLObjectElement",
                                        ol: "HTMLOListElement", optgroup: "HTMLOptGroupElement", option: "HTMLOptionElement", output: "HTMLOutputElement", p: "HTMLParagraphElement", param: "HTMLParamElement", pre: "HTMLPreElement", progress: "HTMLProgressElement", q: "HTMLQuoteElement", s: "HTMLElement", samp: "HTMLElement", script: "HTMLScriptElement", section: "HTMLElement", select: "HTMLSelectElement", small: "HTMLElement", source: "HTMLSourceElement", span: "HTMLSpanElement", strike: "HTMLElement", strong: "HTMLElement", style: "HTMLStyleElement", sub: "HTMLElement", summary: "HTMLElement",
                                        sup: "HTMLElement", table: "HTMLTableElement", tbody: "HTMLTableSectionElement", td: "HTMLTableDataCellElement", textarea: "HTMLTextAreaElement", tfoot: "HTMLTableSectionElement", th: "HTMLTableHeaderCellElement", thead: "HTMLTableSectionElement", time: "HTMLTimeElement", title: "HTMLTitleElement", tr: "HTMLTableRowElement", track: "HTMLTrackElement", tt: "HTMLElement", u: "HTMLElement", ul: "HTMLUListElement", "var": "HTMLElement", video: "HTMLVideoElement", wbr: "HTMLElement"
                                }; q.ELEMENT_DOM_INTERFACES = q.O; q.N = {
                                        NOT_LOADED: 0, SAME_DOCUMENT: 1,
                                        NEW_DOCUMENT: 2
                                }; q.ueffects = q.N; q.J = { "a::href": 2, "area::href": 2, "audio::src": 1, "blockquote::cite": 0, "command::icon": 1, "del::cite": 0, "form::action": 2, "img::src": 1, "input::src": 1, "ins::cite": 0, "q::cite": 0, "video::poster": 1, "video::src": 1 }; q.URIEFFECTS = q.J; q.L = { UNSANDBOXED: 2, SANDBOXED: 1, DATA: 0 }; q.ltypes = q.L; q.I = { "a::href": 2, "area::href": 2, "audio::src": 2, "blockquote::cite": 2, "command::icon": 1, "del::cite": 2, "form::action": 2, "img::src": 1, "input::src": 1, "ins::cite": 2, "q::cite": 2, "video::poster": 1, "video::src": 2 };
                                q.LOADERTYPES = q.I; "undefined" !== typeof window && (window.html4 = q); var A = function (w) {
                                        function m(na, ra) { ra = z.hasOwnProperty(ra) ? z[ra] : (na = ra.match(x)) ? String.fromCharCode(parseInt(na[1], 10)) : (na = ra.match(y)) ? String.fromCharCode(parseInt(na[1], 16)) : H && D.test(ra) ? (H.innerHTML = "\x26" + ra + ";", na = H.textContent, z[ra] = na) : "\x26" + ra + ";"; return ra } function v(na) { return na.replace(N, m) } function r(na) { return ("" + na).replace(M, "\x26amp;").replace(ca, "\x26lt;").replace(K, "\x26gt;").replace(Q, "\x26#34;") } function l(na) {
                                                return na.replace(R,
                                                        "\x26amp;$1").replace(ca, "\x26lt;").replace(K, "\x26gt;")
                                        } function k(na) { var ra = { z: na.z || na.cdata, A: na.A || na.comment, B: na.B || na.endDoc, r: na.r || na.endTag, d: na.d || na.pcdata, F: na.F || na.rcdata, H: na.H || na.startDoc, v: na.v || na.startTag }; return function (sa, wa) { var aa = /(<\/|\x3c!--|<[!?]|[&<>])/g; sa += ""; if (W) sa = sa.split(aa); else { for (var Da = [], Ca = 0, O; null !== (O = aa.exec(sa));)Da.push(sa.substring(Ca, O.index)), Da.push(O[0]), Ca = O.index + O[0].length; Da.push(sa.substring(Ca)); sa = Da } d(ra, sa, 0, { o: !1, C: !1 }, wa) } } function n(na,
                                                ra, sa, wa, aa) { return function () { d(na, ra, sa, wa, aa) } } function d(na, ra, sa, wa, aa) {
                                                        try {
                                                                na.H && 0 == sa && na.H(aa); for (var Da, Ca, O, C = ra.length; sa < C;) {
                                                                        var G = ra[sa++], L = ra[sa]; switch (G) {
                                                                                case "\x26": T.test(L) ? (na.d && na.d("\x26" + L, aa, ma, n(na, ra, sa, wa, aa)), sa++) : na.d && na.d("\x26amp;", aa, ma, n(na, ra, sa, wa, aa)); break; case "\x3c/": if (Da = /^([-\w:]+)[^'"]*/.exec(L)) if (Da[0].length === L.length && "\x3e" === ra[sa + 1]) sa += 2, O = Da[1].toLowerCase(), na.r && na.r(O, aa, ma, n(na, ra, sa, wa, aa)); else {
                                                                                        var P = ra, S = sa, Y = na, ha = aa, ja = ma, ka = wa, ua =
                                                                                                g(P, S); ua ? (Y.r && Y.r(ua.name, ha, ja, n(Y, P, S, ka, ha)), sa = ua.next) : sa = P.length
                                                                                } else na.d && na.d("\x26lt;/", aa, ma, n(na, ra, sa, wa, aa)); break; case "\x3c": if (Da = /^([-\w:]+)\s*\/?/.exec(L)) if (Da[0].length === L.length && "\x3e" === ra[sa + 1]) { sa += 2; O = Da[1].toLowerCase(); na.v && na.v(O, [], aa, ma, n(na, ra, sa, wa, aa)); var qa = w.f[O]; qa & fa && (sa = c(ra, { name: O, next: sa, c: qa }, na, aa, ma, wa)) } else { P = ra; S = na; Y = aa; ha = ma; ja = wa; var V = g(P, sa); V ? (S.v && S.v(V.name, V.P, Y, ha, n(S, P, V.next, ja, Y)), sa = V.c & fa ? c(P, V, S, Y, ha, ja) : V.next) : sa = P.length } else na.d &&
                                                                                        na.d("\x26lt;", aa, ma, n(na, ra, sa, wa, aa)); break; case "\x3c!--": if (!wa.C) { for (Ca = sa + 1; Ca < C && ("\x3e" !== ra[Ca] || !/--$/.test(ra[Ca - 1])); Ca++); if (Ca < C) { if (na.A) { var da = ra.slice(sa, Ca).join(""); na.A(da.substr(0, da.length - 2), aa, ma, n(na, ra, Ca + 1, wa, aa)) } sa = Ca + 1 } else wa.C = !0 } wa.C && na.d && na.d("\x26lt;!--", aa, ma, n(na, ra, sa, wa, aa)); break; case "\x3c!": if (/^\w/.test(L)) { if (!wa.o) { for (Ca = sa + 1; Ca < C && "\x3e" !== ra[Ca]; Ca++); Ca < C ? sa = Ca + 1 : wa.o = !0 } wa.o && na.d && na.d("\x26lt;!", aa, ma, n(na, ra, sa, wa, aa)) } else na.d && na.d("\x26lt;!",
                                                                                                aa, ma, n(na, ra, sa, wa, aa)); break; case "\x3c?": if (!wa.o) { for (Ca = sa + 1; Ca < C && "\x3e" !== ra[Ca]; Ca++); Ca < C ? sa = Ca + 1 : wa.o = !0 } wa.o && na.d && na.d("\x26lt;?", aa, ma, n(na, ra, sa, wa, aa)); break; case "\x3e": na.d && na.d("\x26gt;", aa, ma, n(na, ra, sa, wa, aa)); break; case "": break; default: na.d && na.d(G, aa, ma, n(na, ra, sa, wa, aa))
                                                                        }
                                                                } na.B && na.B(aa)
                                                        } catch (Z) { if (Z !== ma) throw Z; }
                                                } function c(na, ra, sa, wa, aa, Da) {
                                                        var Ca = na.length; ia.hasOwnProperty(ra.name) || (ia[ra.name] = RegExp("^" + ra.name + "(?:[\\s\\/]|$)", "i")); for (var O = ia[ra.name], C = ra.next,
                                                                G = ra.next + 1; G < Ca && ("\x3c/" !== na[G - 1] || !O.test(na[G])); G++); G < Ca && --G; Ca = na.slice(C, G).join(""); if (ra.c & w.c.CDATA) sa.z && sa.z(Ca, wa, aa, n(sa, na, G, Da, wa)); else if (ra.c & w.c.RCDATA) sa.F && sa.F(l(Ca), wa, aa, n(sa, na, G, Da, wa)); else throw Error("bug"); return G
                                                } function g(na, ra) {
                                                        var sa = /^([-\w:]+)/.exec(na[ra]), wa = {}; wa.name = sa[1].toLowerCase(); wa.c = w.f[wa.name]; var aa = na[ra].substr(sa[0].length); ra += 1; for (var Da = na.length; ra < Da && "\x3e" !== na[ra]; ra++)aa += na[ra]; if (!(Da <= ra)) {
                                                                for (var Ca = []; "" !== aa;)if (sa = X.exec(aa)) if (sa[4] &&
                                                                        !sa[5] || sa[6] && !sa[7]) { sa = sa[4] || sa[6]; var O = !1; for (aa = [aa, na[ra++]]; ra < Da; ra++) { if (O) { if ("\x3e" === na[ra]) break } else 0 <= na[ra].indexOf(sa) && (O = !0); aa.push(na[ra]) } if (Da <= ra) break; aa = aa.join("") } else { O = sa[1].toLowerCase(); if (sa[2]) { var C = sa[3]; var G = C.charCodeAt(0); if (34 === G || 39 === G) C = C.substr(1, C.length - 2); C = v(C.replace(I, "")) } else C = ""; Ca.push(O, C); aa = aa.substr(sa[0].length) } else aa = aa.replace(/^[\s\S][^a-z\s]*/, ""); wa.P = Ca; wa.next = ra + 1; return wa
                                                        }
                                                } function b(na) {
                                                        function ra(aa, Da) { wa || Da.push(aa) }
                                                        var sa, wa; return k({
                                                                startDoc: function () { sa = []; wa = !1 }, startTag: function (aa, Da, Ca) {
                                                                        if (!wa && w.f.hasOwnProperty(aa)) {
                                                                                var O = w.f[aa]; if (!(O & w.c.FOLDABLE)) {
                                                                                        var C = na(aa, Da); if (C) {
                                                                                                if ("object" !== typeof C) throw Error("tagPolicy did not return object (old API?)"); if ("attribs" in C) Da = C.attribs; else throw Error("tagPolicy gave no attribs"); var G; "tagName" in C ? (G = C.tagName, C = w.f[G]) : (G = aa, C = O); if (O & w.c.OPTIONAL_ENDTAG) { var L = sa[sa.length - 1]; L && L.D === aa && (L.t !== G || aa !== G) && Ca.push("\x3c/", L.t, "\x3e") } O & w.c.EMPTY ||
                                                                                                        sa.push({ D: aa, t: G }); Ca.push("\x3c", G); aa = 0; for (L = Da.length; aa < L; aa += 2) { var P = Da[aa], S = Da[aa + 1]; null !== S && void 0 !== S && Ca.push(" ", P, '\x3d"', r(S), '"') } Ca.push("\x3e"); O & w.c.EMPTY && !(C & w.c.EMPTY) && Ca.push("\x3c/", G, "\x3e")
                                                                                        } else wa = !(O & w.c.EMPTY)
                                                                                }
                                                                        }
                                                                }, endTag: function (aa, Da) {
                                                                        if (wa) wa = !1; else if (w.f.hasOwnProperty(aa)) {
                                                                                var Ca = w.f[aa]; if (!(Ca & (w.c.EMPTY | w.c.FOLDABLE))) {
                                                                                        if (Ca & w.c.OPTIONAL_ENDTAG) for (Ca = sa.length; 0 <= --Ca;) { var O = sa[Ca].D; if (O === aa) break; if (!(w.f[O] & w.c.OPTIONAL_ENDTAG)) return } else for (Ca = sa.length; 0 <=
                                                                                                --Ca && sa[Ca].D !== aa;); if (!(0 > Ca)) { for (O = sa.length; --O > Ca;) { var C = sa[O].t; w.f[C] & w.c.OPTIONAL_ENDTAG || Da.push("\x3c/", C, "\x3e") } Ca < sa.length && (aa = sa[Ca].t); sa.length = Ca; Da.push("\x3c/", aa, "\x3e") }
                                                                                }
                                                                        }
                                                                }, pcdata: ra, rcdata: ra, cdata: ra, endDoc: function (aa) { for (; sa.length; sa.length--)aa.push("\x3c/", sa[sa.length - 1].t, "\x3e") }
                                                        })
                                                } function e(na, ra, sa, wa, aa) { if (!aa) return null; try { var Da = E.parse("" + na); if (Da && (!Da.K() || va.test(Da.U()))) { var Ca = aa(Da, ra, sa, wa); return Ca ? Ca.toString() : null } } catch (O) { } return null }
                                        function a(na, ra, sa, wa, aa) { sa || na(ra + " removed", { Q: "removed", tagName: ra }); if (wa !== aa) { var Da = "changed"; wa && !aa ? Da = "removed" : !wa && aa && (Da = "added"); na(ra + "." + sa + " " + Da, { Q: Da, tagName: ra, ia: sa, oldValue: wa, newValue: aa }) } } function f(na, ra, sa) { ra = ra + "::" + sa; if (na.hasOwnProperty(ra)) return na[ra]; ra = "*::" + sa; if (na.hasOwnProperty(ra)) return na[ra] } function h(na, ra, sa, wa, aa) {
                                                for (var Da = 0; Da < ra.length; Da += 2) {
                                                        var Ca = ra[Da], O = ra[Da + 1], C = O, G = null, L; if ((L = na + "::" + Ca, w.w.hasOwnProperty(L)) || (L = "*::" + Ca, w.w.hasOwnProperty(L))) G =
                                                                w.w[L]; if (null !== G) switch (G) {
                                                                        case w.e.NONE: break; case w.e.SCRIPT: O = null; aa && a(aa, na, Ca, C, O); break; case w.e.STYLE: if ("undefined" === typeof t) { O = null; aa && a(aa, na, Ca, C, O); break } var P = []; t(O, { declaration: function (S, Y) { var ha = S.toLowerCase(); u(ha, Y, sa ? function (ja) { return e(ja, w.N.ga, w.L.ha, { TYPE: "CSS", CSS_PROP: ha }, sa) } : null); Y.length && P.push(ha + ": " + Y.join(" ")) } }); O = 0 < P.length ? P.join(" ; ") : null; aa && a(aa, na, Ca, C, O); break; case w.e.ID: case w.e.IDREF: case w.e.IDREFS: case w.e.GLOBAL_NAME: case w.e.LOCAL_NAME: case w.e.CLASSES: O =
                                                                                wa ? wa(O) : O; aa && a(aa, na, Ca, C, O); break; case w.e.URI: O = e(O, f(w.J, na, Ca), f(w.I, na, Ca), { TYPE: "MARKUP", XML_ATTR: Ca, XML_TAG: na }, sa); aa && a(aa, na, Ca, C, O); break; case w.e.URI_FRAGMENT: O && "#" === O.charAt(0) ? (O = O.substring(1), O = wa ? wa(O) : O, null !== O && void 0 !== O && (O = "#" + O)) : O = null; aa && a(aa, na, Ca, C, O); break; default: O = null, aa && a(aa, na, Ca, C, O)
                                                                } else O = null, aa && a(aa, na, Ca, C, O); ra[Da + 1] = O
                                                } return ra
                                        } function p(na, ra, sa) {
                                                return function (wa, aa) {
                                                        if (w.f[wa] & w.c.UNSAFE) sa && a(sa, wa, void 0, void 0, void 0); else return {
                                                                attribs: h(wa,
                                                                        aa, na, ra, sa)
                                                        }
                                                }
                                        } function B(na, ra) { var sa = []; b(ra)(na, sa); return sa.join("") } var t, u; "undefined" !== typeof window && (t = window.parseCssDeclarations, u = window.sanitizeCssProperty); var z = { lt: "\x3c", LT: "\x3c", gt: "\x3e", GT: "\x3e", amp: "\x26", AMP: "\x26", quot: '"', apos: "'", nbsp: "\u00a0" }, x = /^#(\d+)$/, y = /^#x([0-9A-Fa-f]+)$/, D = /^[A-Za-z][A-za-z0-9]+$/, H = "undefined" !== typeof window && window.document ? window.document.createElement("textarea") : null, I = /\0/g, N = /&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g, T = /^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,
                                                M = /&/g, R = /&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi, ca = /[<]/g, K = />/g, Q = /"/g, X = /^\s*([-.:\w]+)(?:\s*(=)\s*((")[^"]*("|$)|(')[^']*('|$)|(?=[a-z][-\w]*\s*=)|[^"'\s]*))?/i, W = 3 === "a,b".split(/(,)/).length, fa = w.c.CDATA | w.c.RCDATA, ma = {}, ia = {}, va = /^(?:https?|mailto)$/i, xa = {}; xa.ka = xa.escapeAttrib = r; xa.la = xa.makeHtmlSanitizer = b; xa.ma = xa.makeSaxParser = k; xa.na = xa.makeTagPolicy = p; xa.pa = xa.normalizeRCData = l; xa.qa = xa.sanitize = function (na, ra, sa, wa) { return B(na, p(ra, sa, wa)) }; xa.ra = xa.sanitizeAttribs = h; xa.sa =
                                                        xa.sanitizeWithPolicy = B; xa.ta = xa.unescapeEntities = v; return xa
                                }(q); q = A.sanitize; "undefined" !== typeof window && (window.html = A, window.html_sanitize = q); "function" === typeof define && define.amd && define([], function () { return A })
                        })()
                }, "jimu/WidgetManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/Evented dojo/on dijit/Tooltip dojo/aspect dojo/json dojo/query dojo/request/xhr dojo/promise/all dijit/registry ./utils jimu/tokenUtils ./dijit/Message ./DataSourceManager ./portalUrlUtils ./portalUtils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t) {
                                        var u = null, z = E(r, {
                                                constructor: function () {
                                                        this.loaded = []; this.missedActions = []; this.activeWidget = null; this.widgetsUri = {}; window.isBuilder ? (v.subscribe("app/mapLoaded", q.hitch(this, this._onMapLoaded)), v.subscribe("app/mapChanged", q.hitch(this, this._onMapChanged))) : (v.subscribe("mapLoaded", q.hitch(this, this._onMapLoaded)), v.subscribe("mapChanged", q.hitch(this, this._onMapChanged))); window.isBuilder ? (v.subscribe("app/sceneViewLoaded", q.hitch(this, this._onSceneViewLoaded)),
                                                                v.subscribe("app/sceneViewChanged", q.hitch(this, this._onSceneViewChanged))) : (v.subscribe("sceneViewLoaded", q.hitch(this, this._onSceneViewLoaded)), v.subscribe("sceneViewChanged", q.hitch(this, this._onSceneViewChanged))); window.isBuilder ? (v.subscribe("app/appConfigLoaded", q.hitch(this, this._onAppConfigLoaded)), v.subscribe("app/appConfigChanged", q.hitch(this, this._onAppConfigChanged))) : (v.subscribe("appConfigLoaded", q.hitch(this, this._onAppConfigLoaded)), v.subscribe("appConfigChanged", q.hitch(this, this._onAppConfigChanged)));
                                                        v.subscribe("userSignIn", q.hitch(this, this._onUserSignIn)); v.subscribe("userSignOut", q.hitch(this, this._onUserSignOut)); v.subscribe("builder/actionTriggered", q.hitch(this, this._onActionTriggered)); v.subscribe("/dnd/move/start", q.hitch(this, this._onMoveStart))
                                                }, loadWidget: function (x) {
                                                        var y = new m, D; x = q.clone(x); (D = this.getWidgetById(x.id)) ? y.resolve(D) : this.getWidgetUri(x).then(q.hitch(this, function (H) {
                                                                x.uri = H; b([this.loadWidgetClass(x), this.loadWidgetManifest(x)]).then(q.hitch(this, function (I) {
                                                                        var N =
                                                                                I[0], T = I[1]; this.loadWidgetResources(T).then(q.hitch(this, function (M) { try { var R = this.createWidget(T, N, M); w.setAttr(R.domNode, "data-widget-name", T.name); console.log("widget [" + T.uri + "] created.") } catch (ca) { console.log("create [" + T.uri + "] error:" + ca.stack), new h({ message: window.jimuNls.widgetManager.createWidgetError + ": " + T.uri }), e.byId(T.id) && e.byId(T.id).destroy(), y.reject(ca) } setTimeout(q.hitch(this, function () { y.resolve(R); this.emit("widget-created", R); v.publish("widgetCreated", R) }), 50) }), function (M) { y.reject(M) })
                                                                }),
                                                                        function (I) { y.reject(I) })
                                                        })); return y
                                                }, loadWidgetClass: function (x) { var y = new m; var D = x.isRemote ? x.uri + ".js" : x.uri; require(a.getRequireConfig(), [D], q.hitch(this, function (H) { y.resolve(H) })); a.checkError(x.uri, y); return y }, loadWidgetResources: function (x) {
                                                        var y = new m, D = []; var H = q.clone(x); x = this.tryLoadWidgetConfig(H); var I = this._tryLoadResource(H, "i18n"); var N = this._tryLoadResource(H, "style"); H = this._tryLoadResource(H, "template"); D.push(x); D.push(I); D.push(H); D.push(N); b(D).then(q.hitch(this, function (T) {
                                                                var M =
                                                                        {}; M.config = T[0]; M.i18n = T[1]; M.template = T[2]; M.style = T[3]; y.resolve(M)
                                                        }), function (T) { y.reject(T) }); return y
                                                }, getWidgetUri: function (x) {
                                                        if (this.widgetsUri[x.id]) return this.widgetsUri[x.id]; var y = x.itemId ? t.getPortal(window.portalUrl).getItemById(x.itemId).then(function (D) { return B.isOnline(window.portalUrl) && !B.isOnline(D.url) ? (new m).reject("Not allow.", x.itemId) : a.widgetJson.getUriFromItem(D) }) : a.getUriInfo(x.uri).isRemote ? (new m).reject("Not allow.", x.uri) : (new m).resolve(x.uri); return this.widgetsUri[x.id] =
                                                                y
                                                }, loadWidgetManifest: function (x) {
                                                        var y = new m; return this.getWidgetUri(x).then(q.hitch(this, function (D) {
                                                                x.uri = D; if (x.manifest) return y.resolve(x), y; D = a.getUriInfo(D).folderUrl + "manifest.json"; return g(D, { handleAs: "json", headers: { "X-Requested-With": null } }).then(q.hitch(this, function (H) {
                                                                        if (H.error && H.error.code) return y.reject(H.error); H.category = "widget"; q.mixin(H, a.getUriInfo(x.uri)); return a.manifest.addI18NLabel(H).then(q.hitch(this, function () {
                                                                                this._processManifest(H); a.widgetJson.addManifest2WidgetJson(x,
                                                                                        H); y.resolve(x); return y
                                                                        }))
                                                                }))
                                                        }), function (D) { y.reject(D) })
                                                }, getWidgetMarginBox: function (x) { if ("string" === typeof x && (x = this.getWidgetById(x), !x)) return {}; if (x._marginBox) return x._marginBox; var y = { left: -9999, top: -9999, relativeTo: x.position.relativeTo }; x._isTestSizeFlag = !0; x.setPosition(y); this.openWidget(x); x._marginBox = x.getMarginBox(); this.closeWidget(x); "undefined" !== typeof x._isTestSizeFlag && delete x._isTestSizeFlag; return x._marginBox }, _processManifest: function (x) {
                                                        a.manifest.addManifestProperies(x);
                                                        a.manifest.processManifestLabel(x, window.dojoConfig.locale)
                                                }, createWidget: function (x, y, D) {
                                                        if (this.getWidgetById(x.id)) return this.getWidgetById(x.id); D.config && D.i18n && (D.config = a.replacePlaceHolder(D.config, D.i18n)); x.rawConfig = x.config; x.config = D.config || {}; this.appConfig._appData && this._mergeAgolConfig(x); x.nls = D.i18n || {}; D.template && (x.templateString = D.template); x["class"] = "jimu-widget"; x.label || (x.label = x.name); this.map && (x.map = this.map); x.appConfig = this.appConfig; D = {}; for (var H in x) x.hasOwnProperty(H) &&
                                                                (D[H] = x[H]); D.widgetManager = this; x = new y(D); x.clazz = y; n.after(x, "startup", q.hitch(this, this._postWidgetStartup, x)); n.before(x, "destroy", q.hitch(this, this._onDestroyWidget, x)); x.domNode.addEventListener(this._getActiveEventName(), q.hitch(this, this._onClickWidget, x), { capture: !0 }); this.loaded.push(x); return x
                                                }, getAllWidgets: function () { return this.loaded }, destroyAllWidgets: function () { var x = A.map(this.loaded, function (y) { return y.id }); A.forEach(x, function (y) { this.destroyWidget(y) }, this); this.loaded = [] },
                                                loadWidgetSettingPage: function (x) {
                                                        var y = new m; x = q.clone(x); x.id += "_setting"; b([this.loadWidgetSettingClass(x)]).then(q.hitch(this, function (D) {
                                                                var H = D[0]; this.loadWidgetSettingPageResources(x).then(q.hitch(this, function (I) {
                                                                        var N = { nls: I.i18n, appConfig: this.appConfig, "class": "jimu-widget-setting" }; null !== I.template && (N.templateString = I.template); "HTML3D" === window.appInfo.appType ? N.sceneView = this.sceneView : N.map = this.map; for (var T in x) x.hasOwnProperty(T) && (N[T] = x[T]); try {
                                                                                var M = new H(N); w.setAttr(M.domNode,
                                                                                        "data-widget-name-setting", N.name); n.before(M, "destroy", q.hitch(this, this._onDestroyWidgetSetting, M)); y.resolve(M)
                                                                        } catch (R) { new h({ message: window.jimuNls.widgetManager.createWidgetSettingPageError + ":" + x.uri }), e.byId(N.id) && e.byId(N.id).destroy(), y.reject(R) }
                                                                }), function (I) { console.log(I) })
                                                        }), function (D) { y.reject(D) }); return y
                                                }, loadWidgetSettingClass: function (x) {
                                                        var y = new m; var D = x.isRemote ? x.folderUrl + "setting/Setting.js" : x.amdFolder + "setting/Setting"; require(a.getRequireConfig(), [D], q.hitch(this,
                                                                function (H) { y.resolve(H) })); a.checkError(x.folderUrl + "setting/Setting.js", y); return y
                                                }, loadWidgetSettingPageResources: function (x) { var y = new m, D = []; x = q.clone(x); var H = this._tryLoadResource(x, "settingI18n"); var I = this._tryLoadResource(x, "settingTemplate"); x = this._tryLoadResource(x, "settingStyle"); D.push(H); D.push(I); D.push(x); b(D).then(q.hitch(this, function (N) { var T = {}; T.i18n = N[0] || {}; T.template = N[1]; T.style = N[2]; y.resolve(T) }), function (N) { console.log(N) }); return y }, getWidgetById: function (x) {
                                                        var y;
                                                        A.some(this.loaded, function (D) { if (D.id === x) return y = D, !0 }, this); return y
                                                }, getWidgetByLabel: function (x) { var y; A.some(this.loaded, function (D) { if (D.label === x) return y = D, !0 }, this); return y }, getWidgetsByName: function (x) { var y = []; A.some(this.loaded, function (D) { D.name === x && y.push(D) }, this); return y }, changeWindowStateTo: function (x, y) { "normal" === y ? this.normalizeWidget(x) : "minimized" === y ? this.minimizeWidget(x) : "maximized" === y ? this.maximizeWidget(x) : console.log("error state: " + y) }, closeWidget: function (x) {
                                                        if ("string" ===
                                                                typeof x && (x = this.getWidgetById(x), !x)) return; if ("closed" !== x.state) { this.activeWidget && this.activeWidget.id === x.id && (this.activeWidget.onDeActive(), this.activeWidget = null); w.setStyle(x.domNode, "display", "none"); x.setState("closed"); try { x.onClose() } catch (y) { console.log(console.error("fail to close widget " + x.name + ". " + y.stack)) } } this.appConfig.mode || this._removeDataSourceUsage(x)
                                                }, openWidget: function (x) {
                                                        if ("string" === typeof x && (x = this.getWidgetById(x), !x)) return; if (!x.started) try { x.started = !0, x.startup() } catch (y) {
                                                                console.error("fail to startup widget " +
                                                                        x.name + ". " + y.stack)
                                                        } if ("closed" === x.state) { w.setStyle(x.domNode, "display", ""); x.setState("opened"); try { x.onOpen() } catch (y) { console.error("fail to open widget " + x.name + ". " + y.stack) } !x._isTestSizeFlag && a.isAutoFocusFirstNodeWidget(x) && a.focusFirstFocusNode(x.domNode); this.appConfig.mode || this._addDataSourceUsage(x) }
                                                }, activateWidget: function (x) { if ("string" === typeof x && (x = this.getWidgetById(x), !x)) return; "opened" === x.state && this._activeWidget(x) }, maximizeWidget: function (x) {
                                                        if ("string" === typeof x && (x =
                                                                this.getWidgetById(x), !x)) return; "closed" === x.state && this.openWidget(x); x.setWindowState("maximized"); try { x.onMaximize() } catch (y) { console.log(console.error("fail to maximize widget " + x.name + ". " + y.stack)) }
                                                }, minimizeWidget: function (x) { if ("string" === typeof x && (x = this.getWidgetById(x), !x)) return; "closed" === x.state && this.openWidget(x); x.setWindowState("minimized"); try { x.onMinimize() } catch (y) { console.log(console.error("fail to minimize widget " + x.name + ". " + y.stack)) } }, normalizeWidget: function (x) {
                                                        if ("string" ===
                                                                typeof x && (x = this.getWidgetById(x), !x)) return; "closed" === x.state && this.openWidget(x); x.setWindowState("normal"); try { x.onNormalize() } catch (y) { console.log(console.error("fail to normalize widget " + x.name + ". " + y.stack)) }
                                                }, destroyWidget: function (x) { if ("string" === typeof x && (x = this.getWidgetById(x), !x)) return; this._removeWidget(x); try { x.destroy() } catch (y) { console.log(console.error("fail to destroy widget " + x.name + ". " + y.stack)) } }, tryLoadWidgetConfig: function (x) {
                                                        return this._tryLoadWidgetConfig(x).then(q.hitch(this,
                                                                function (y) { return this._upgradeWidgetConfig(x, y).then(function (D) { return x.config = D }) }))
                                                }, triggerWidgetOpen: function (x) { function y(N) { var T = n.after(N, "onOpen", function () { T.remove(); D.resolve(N) }) } var D = new m, H = this.getWidgetById(x); if (H) { if ("closed" !== H.state) return D.resolve(H), D; y(H) } else var I = v.subscribe("widgetCreated", q.hitch(this, function (N) { N.id === x && (I.remove(), D.resolve(N)) })); v.publish("openWidget", x); return D }, _tryLoadWidgetConfig: function (x) {
                                                        var y = new m; if (x.config && q.isObject(x.config)) return y.resolve(x.config),
                                                                y; if (x.config) { if (require.cache["url:" + x.config]) return y.resolve(d.parse(require.cache["url:" + x.config])), y; y = a.processUrlInAppConfig(x.config); y = y.split("/"); y[y.length - 1] = encodeURIComponent(y[y.length - 1]); y = y.join("/"); return g(y, { handleAs: "json", headers: { "X-Requested-With": null } }) } return this._tryLoadResource(x, "config").then(function (D) { x.isDefaultConfig = !0; return D })
                                                }, _upgradeWidgetConfig: function (x, y) {
                                                        var D = new m, H = x.manifest.version, I = x.version, N; if (H === I) return D.resolve(y), D; if (!1 === x.hasVersionManager) return x.version =
                                                                H, D.resolve(y), D; require(a.getRequireConfig(), [x.amdFolder + (x.isRemote ? "VersionManager.js" : "VersionManager")], q.hitch(this, function (T) { T = new T; var M = T.getVersionIndex(I), R = T.getVersionIndex(H); if (M > R) D.reject("Bad widget version number, " + x.name + "," + I); else try { N = T.upgrade(y, I, H), x.version = H, D.resolve(N) } catch (ca) { console.log("Read widget [" + x.name + "] old config error," + ca.stack), D.resolve(y) } })); return D
                                                }, loadWidgetStyle: function (x) {
                                                        var y = this._getStyleIdFromWidgetJson(x, !1), D = new m; return w.byId(y) ?
                                                                (D.resolve("load"), D) : a.loadStyleLink(y, x.styleFile, "theme_" + this.appConfig.theme.name + "_style_common")
                                                }, loadWidgetSettingStyle: function (x) { var y = this._getStyleIdFromWidgetJson(x, !0), D = new m; return w.byId(y) ? (D.resolve("load"), D) : a.loadStyleLink(y, x.settingStyleFile) }, loadWidgetConfig: function (x) { x = require(a.getRequireConfig()).toUrl(x.configFile); if (require.cache["url:" + x]) { var y = new m; y.resolve(d.parse(require.cache["url:" + x])); return y } return g(x, { handleAs: "json", headers: { "X-Requested-With": null } }) },
                                                loadWidgetI18n: function (x) { var y = new m; require(a.getRequireConfig(), ["dojo/i18n!" + x.i18nFile], function (D) { y.resolve(D) }); return y }, loadWidgetSettingI18n: function (x) { var y = new m; require(a.getRequireConfig(), ["dojo/i18n!" + x.settingI18nFile], function (D) { y.resolve(D) }); return y }, loadWidgetTemplate: function (x) { var y = new m; require(a.getRequireConfig(), ["dojo/text!" + x.templateFile], function (D) { y.resolve(D) }); a.checkError(x.templateFile, y); return y }, loadWidgetSettingTemplate: function (x) {
                                                        var y = new m; require(a.getRequireConfig(),
                                                                ["dojo/text!" + x.settingTemplateFile], function (D) { y.resolve(D) }); a.checkError(x.settingTemplateFile, y); return y
                                                }, removeWidgetStyle: function (x) { this._removeStyle(this._getStyleIdFromWidgetJson(x, !1)) }, removeWidgetSettingStyle: function (x) { this._removeStyle(this._getStyleIdFromWidgetJson(x, !0)) }, _removeStyle: function (x) { if (w.byId(x)) { var y = w.attr(x, "data-import-styles"); if (y) for (var D = 0; D < parseInt(y, 10); D++)w.destroy(x + "_import_" + D); w.destroy(x) } }, _getStyleIdFromWidgetJson: function (x, y) {
                                                        return this._replaceId("widget/style/" +
                                                                (x.itemId ? x.itemId : x.uri) + (y ? "/setting" : ""))
                                                }, getControllerWidgets: function () { return A.filter(this.loaded, function (x) { return x.isController }) }, getOffPanelWidgets: function () { return A.filter(this.loaded, function (x) { return !x.inPanel }) }, getOnScreenOffPanelWidgets: function () { return A.filter(this.loaded, function (x) { return x.isOnScreen && !x.inPanel }) }, closeOtherWidgetsInTheSameGroup: function (x) {
                                                        if ("string" === typeof x && (x = this.getWidgetById(x), !x)) return; for (var y = 0; y < this.loaded.length; y++)this.loaded[y].gid ===
                                                                x.gid && this.loaded[y].id !== x.id && this.closeWidget(this.loaded[y])
                                                }, closeAllWidgetsInGroup: function (x) { for (var y = 0; y < this.loaded.length; y++)this.loaded[y].gid === x && this.closeWidget(this.loaded[y]) }, _addDataSourceUsage: function (x) { A.forEach(this._getUsedDataSourceIdFromWidget(x), function (y) { p.getInstance().addDataSourceUsage(y, x.id) }) }, _removeDataSourceUsage: function (x) { A.forEach(this._getUsedDataSourceIdFromWidget(x), function (y) { p.getInstance().removeDataSourceUsage(y, x.id) }) }, _getUsedDataSourceIdFromWidget: function (x) {
                                                        if ((x =
                                                                this.appConfig.getConfigElementById(x.id)) && x.config) { var y = d.stringify(x.config); return A.filter(Object.keys(this.appConfig.dataSource.dataSources), function (D) { return -1 < y.indexOf(D) }, this) }
                                                }, _mergeAgolConfig: function (x) { var y = this.appConfig._appData.values, D = "widgets[" + x.id + "]", H; for (H in y) { var I = H.replace(/\//g, "_").indexOf(D + "_config"); 0 <= I && a.template.setConfigValue(x, H.replace(/\//g, "_").substr(I, H.length).replace(D, "widget"), y[H]) } }, _onUserSignIn: function (x) {
                                                        A.forEach(this.loaded, function (y) { y.onSignIn(x) },
                                                                this)
                                                }, _onUserSignOut: function () { A.forEach(this.loaded, function (x) { x.onSignOut() }, this) }, _activeWidget: function (x) {
                                                        if (this.activeWidget) { if (this.activeWidget.id === x.id) { !1 === this.activeWidget.inPanel && this.activeWidget.moveTopOnActive && w.setStyle(this.activeWidget.domNode, "zIndex", 101); return } "active" === this.activeWidget.state && (this.activeWidget.setState("opened"), !1 === this.activeWidget.inPanel && w.setStyle(x.domNode, "zIndex", "zIndex" in x.position ? x.position.zIndex : "auto"), this.activeWidget.onDeActive()) } this.activeWidget =
                                                                x; "opened" === this.activeWidget.state && (this.activeWidget.setState("active"), !1 === this.activeWidget.inPanel && this.activeWidget.moveTopOnActive && w.setStyle(this.activeWidget.domNode, "zIndex", 101), this.activeWidget.onActive(), v.publish("widgetActived", x))
                                                }, _onClickWidget: function (x, y) { var D = c(".jimu-widget", x.domNode); if (0 < D.length) for (var H = 0; H < D.length; H++)if (y.target === D[H] || w.isDescendant(y.target, D[H])) return; this._activeWidget(x) }, _onMoveStart: function (x) {
                                                        A.forEach(this.loaded, function (y) {
                                                                y.domNode ===
                                                                x.node && this._activeWidget(y)
                                                        }, this)
                                                }, _onAppConfigLoaded: function (x) { this.appConfig = x = q.clone(x); f.setPortalUrl(x.portalUrl) }, _onMapLoaded: function (x) { this.map = x }, _onMapChanged: function (x) { this.map = x }, _onSceneViewLoaded: function (x) { this.sceneView = x }, _onSceneViewChanged: function (x) { this.sceneView = x }, _onAppConfigChanged: function (x, y, D, H) {
                                                        var I = q.clone(x); this.appConfig = I; A.forEach(this.loaded, function (N) { N && (N.onAppConfigChanged(I, y, D, H), "widgetChange" === y && this._onConfigChanged(D.id, D.config, H)) },
                                                                this)
                                                }, _onConfigChanged: function (x, y) { if (x = this.getWidgetById(x)) x.onConfigChanged(y), q.mixin(x.config, y) }, _onActionTriggered: function (x) { if ("map" !== x.elementId && "app" !== x.elementId) { var y = this.getWidgetById(x.elementId); if (y) y.onAction(x.action, x.data); else this.missedActions.push({ id: x.elementId, action: { name: x.action, data: x.data } }); A.forEach(this.getControllerWidgets(), function (D) { if (D.widgetIsControlled(x.elementId)) D.onAction(x.action, { widgetId: x.elementId, data: x.data }) }, this) } }, _resetFirstFocusNode: function (x) {
                                                        if (window.isMoveFocusWhenInit) {
                                                                var y =
                                                                        this.getWidgetsByName("Splash")[0]; if (y && "none" !== w.getStyle(y.domNode, "display")) window.isMoveFocusWhenInit = !1, x && "Splash" === x.name || y.domNode.focus(); else if (window.currentMsgPopup && window.currentMsgPopup.firstFocusNode) window.isMoveFocusWhenInit = !1, window.currentMsgPopup.focusedNodeBeforeOpen = a.getFirstSkipLink(), window.currentMsgPopup.firstFocusNode.focus(); else if (window.isMoveFocusWhenInit) window.isMoveFocusWhenInit = !1, a.isInNavMode() && a.focusOnFirstSkipLink(); else return !1; return !0
                                                        }
                                                }, _postWidgetStartup: function (x) {
                                                        x.started =
                                                        !0; a.setVerticalCenter(x.domNode); n.after(x, "resize", q.hitch(this, a.setVerticalCenter, x.domNode)); a.initTabIndexAndOrder(x); a.initWidgetCancelEvent(x); var y = x.position || x.panel && x.panel.position; y && "browser" === y.relativeTo && l(x.domNode, "focus", q.hitch(this, function () { this._resetFirstFocusNode() })); this.openWidget(x); if (y = f.getPortalCredential(this.appConfig.portalUrl)) x.onSignIn(y); else x.onSignOut(); this._triggerMissedAction(x); x.inPanel || a.addTooltipByDomNode(k, x.domNode, x.label)
                                                }, _triggerMissedAction: function (x) {
                                                        this.missedActions.forEach(function (y) {
                                                                if (y.id ===
                                                                        x.id) x.onAction(y.action.name, y.action.data)
                                                        })
                                                }, _remove: function (x) { delete this.widgetsUri[x]; return A.some(this.loaded, function (y, D) { if (y.id === x) return this.loaded.splice(D, 1), !0 }, this) }, _tryLoadResource: function (x, y) {
                                                        var D = new m, H = function () {
                                                                if ("config" === y) var N = this.loadWidgetConfig(x); else if ("style" === y) N = this.loadWidgetStyle(x); else if ("i18n" === y) N = this.loadWidgetI18n(x); else if ("template" === y) N = this.loadWidgetTemplate(x); else if ("settingTemplate" === y) N = this.loadWidgetSettingTemplate(x); else if ("settingStyle" ===
                                                                        y) N = this.loadWidgetSettingStyle(x); else if ("settingI18n" === y) N = this.loadWidgetSettingI18n(x); else return D; N.then(function (T) { D.resolve(T) }, function (T) { console.error("Load widget resource error. resource:", y); console.error(T); new h({ message: window.jimuNls.widgetManager.loadWidgetResourceError + ": " + x.uri }); D.reject(T) })
                                                        }; if ("config" === y) { var I = x.amdFolder + "config.json"; x.configFile = I; I = "hasConfig" } else if ("style" === y) I = x.amdFolder + "css/style.css", x.styleFile = I, I = "hasStyle"; else if ("i18n" === y) I = x.amdFolder +
                                                                "nls/strings.js", x.i18nFile = x.isRemote ? I : x.amdFolder + "nls/strings", I = "hasLocale"; else if ("template" === y) I = x.amdFolder + "Widget.html", x.templateFile = I, I = "hasUIFile"; else if ("settingTemplate" === y) I = x.amdFolder + "setting/Setting.html", x.settingTemplateFile = I, I = "hasSettingUIFile"; else if ("settingI18n" === y) I = x.amdFolder + "setting/nls/strings.js", x.settingI18nFile = x.isRemote ? I : x.amdFolder + "setting/nls/strings", I = "hasSettingLocale"; else if ("settingStyle" === y) I = x.amdFolder + "setting/css/style.css", x.settingStyleFile =
                                                                        I, I = "hasSettingStyle"; else return D; x[I] ? H.apply(this) : D.resolve(null); return D
                                                }, _replaceId: function (x) { return x.replace(/\//g, "_").replace(/\./g, "_") }, _onDestroyWidget: function (x) { "closed" !== x.state && this.closeWidget(x); this._removeWidget(x); this.emit("widget-destroyed", x.id); v.publish("widgetDestroyed", x.id); console.log("destroy widget [" + x.uri + "].") }, _onDestroyWidgetSetting: function (x) { this.removeWidgetSettingStyle(x) }, _removeWidget: function (x) {
                                                        if ("string" === typeof x && (x = this.getWidgetById(x),
                                                                !x)) return; this.activeWidget && this.activeWidget.id === x.id && (this.activeWidget = null); this._remove(x.id); 0 === this.getWidgetsByName(x.name).length && this.removeWidgetStyle(x)
                                                }, _getActiveEventName: function () { var x = "PointerEvent" in window ? "pointer" : "MSPointerEvent" in window ? "MSPointer" : !1, y = x && "MS" === x.slice(0, 2); return x ? x + (y ? "Down" : "down") : "mousedown" }
                                        }); z.getInstance = function (x) { null === u && (u = new z(x), window._widgetManager = u); return u }; return z
                                })
                }, "jimu/tokenUtils": function () {
                        define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/kernel esri/config esri/request esri/urlUtils esri/sniff esri/IdentityManager esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils esri/layers/vectorTiles/kernel".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h) {
                                        "function" !== typeof m.getAll && (m.getAll = function (p) { var B = []; (p = m(p)) && B.push(p); return B }); b = {
                                                portalUrl: null, cookiePath: "/", _started: !1, webTierPortalUrls: [], isInBuilderWindow: function () { return !!window.isBuilder }, isInConfigOrPreviewWindow: function () { return f.isInConfigOrPreviewWindow() }, isStringStartWith: function (p, B) { return p.substr(0, B.length) === B }, getCookiePath: function () { return this.cookiePath }, setPortalUrl: function (p) {
                                                        (p = a.getStandardPortalUrl(p)) &&
                                                        (p += "/"); this.portalUrl = p
                                                }, getPortalUrl: function () { return this.portalUrl }, isWebTierPortal: function (p) {
                                                        var B = new w, t = a.getStandardPortalUrl(p); p = t + "/sharing"; var u = a.setHttpsProtocol(t + "/sharing/generateToken?f\x3djson"), z = a.setHttpsProtocol(p); l.get(u, { jsonp: "callback" }).then(E.hitch(this, function (x) {
                                                                x.token ? (this.webTierPortalUrls.push(t), this.removeWabAuthInfo(), k.id.getCredential(z).then(E.hitch(this, function (y) {
                                                                        function D(I) {
                                                                                var N = I.creationTime || (new Date).getTime(), T = I.expires; 0 < N && 0 < T && T > N &&
                                                                                        setTimeout(function () { l.get(u, { jsonp: "callback" }).then(function (M) { M.token && (I.token = M.token, I.expires = M.expires, I.creationTime = (new Date).getTime(), I.refreshServerTokens(), D(I)) }, function (M) { console.error(M) }) }, .8 * (T - N))
                                                                        } y.token || (y.token = x.token); y.expires || (y.expires = x.expires); var H = this.findServerFromCorsEnabledServers(y.server); -1 < H && n.defaults.io.corsEnabledServers.splice(H, 1); this._pushCorsEnabledServerInfo({ host: a.getServerByUrl(t), withCredentials: !0 }); B.resolve(!0); D(y)
                                                                }), E.hitch(this, function () { B.resolve(!0) }))) :
                                                                B.resolve(!1)
                                                        }), E.hitch(this, function (x) { console.error(x); B.reject(x) })); return B
                                                }, addAuthorizedCrossOriginDomains: function (p) { if (p && 0 < p.length) for (var B = 0; B < p.length; B++)this.addWithCredentialDomain(p[B]) }, addWithCredentialDomain: function (p) { if (p && "string" === typeof p) { var B = n.defaults.io.corsEnabledServers, t = a.getServerByUrl(p); (p = a.getServerWithProtocol(p)) || (p = "http://" + t); p = this.findServerFromCorsEnabledServers(p); -1 < p && B.splice(p, 1); this._pushCorsEnabledServerInfo({ host: t, withCredentials: !0 }) } },
                                                findServerFromCorsEnabledServers: function (p) { var B = n.defaults.io.corsEnabledServers, t, u = -1; g("esri-cors") && B && B.length && q.some(B, function (z, x) { z = !z || "object" !== typeof z || z instanceof RegExp ? z : z.host; return !(z instanceof RegExp) && z && (t = 0 !== z.trim().toLowerCase().indexOf("http"), c.hasSameOrigin(p, t ? "http://" + z : z) || t && c.hasSameOrigin(p, "https://" + z)) ? (u = x, !0) : !1 }); return u }, _pushCorsEnabledServerInfo: function (p) {
                                                        if (p) {
                                                                var B = n.defaults.io.corsEnabledServers, t = "charAt charCodeAt concat endsWith indexOf lastIndexOf localeCompare match replace search slice split startsWith substr substring toLocaleLowerCase toLocaleUpperCase toLowerCase toString toUpperCase trim trimLeft trimRight valueOf".split(" ");
                                                                if ("object" === typeof p && "string" === typeof p.host) { for (var u in p.host) p[u] = "function" === typeof p.host[u] ? function () { return p.host[u].apply(p.host, arguments) } : p.host[u]; p.length = p.host.length; q.forEach(t, function (z) { "function" === typeof p.host[z] && (p[z] = function () { return p.host[z].apply(p.host, arguments) }) }) } B.push(p)
                                                        }
                                                }, tryRegisterCredential: function (p) { return this.isValidCredential(p) ? q.some(k.id.credentials, E.hitch(this, function (B) { return p.token === B.token })) ? !1 : (k.id.credentials.push(p), !0) : !1 },
                                                registerToken: function (p) { var B = a.getSharingUrl(this.portalUrl); k.id.findCredential(B) && q.some(k.id.credentials, E.hitch(this, function (t, u) { if (this.isValidPortalCredentialOfPortalUrl(this.portalUrl, t)) return k.id.credentials.splice(u, 1), !0 })); return this._getTokenInfo(p).then(function (t) { t && k.id.registerToken(t) }) }, _getTokenInfo: function (p) {
                                                        var B = a.getPortalSelfInfoUrl(this.portalUrl); return l.get(B + ("?f\x3djson\x26token\x3d" + p), { jsonp: "callback" }).then(E.hitch(this, function (t) {
                                                                return t.user ? {
                                                                        server: a.getSharingUrl(this.portalUrl),
                                                                        ssl: t.allSSL, token: p, userId: t.user.username
                                                                } : null
                                                        }), function (t) { console.error(t); throw Error(window.jimuNls.urlParams.validateTokenError); })
                                                }, _isInvalidPortalUrl: function (p) { return p && "string" === typeof p && E.trim(p) }, signInPortal: function (p) {
                                                        var B = new w; if (this._isInvalidPortalUrl(p)) { p = a.getStandardPortalUrl(p); var t = a.getSharingUrl(p), u = this.getPortalCredential(p); u ? setTimeout(E.hitch(this, function () { B.resolve(u) }), 0) : B = k.id.getCredential(t) } else setTimeout(E.hitch(this, function () { B.reject("Invalid portalurl.") }),
                                                                0); return B
                                                }, _loadPortalSelfInfo: function (p) { p = a.getPortalSelfInfoUrl(p); return d({ url: p, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }) }, registerOAuthInfo: function (p, B, t) {
                                                        if (!p || "string" !== typeof p || !B || "string" !== typeof B) return null; t || (t = 0); var u = k.id.findOAuthInfo(p); u || (u = window.location.protocol + "//" + window.location.host + require.toUrl("jimu") + "/oauth-callback.html", u = new e({
                                                                appId: B, expiration: 20159, portalUrl: p, authNamespace: "/", popup: !0, flowType: 8.4 <= Number(t) ? "authorization-code" :
                                                                        "auto", popupCallbackUrl: u
                                                        }), k.id.registerOAuthInfos([u])); u.appId = B; return u
                                                }, signOutAll: function (p) {
                                                        var B = a.getStandardPortalUrl(this.portalUrl) + "/sharing/rest", t = a.getPortalSignInUrlFromLocation(); t = t + "?returnUrl\x3d" + encodeURIComponent(window.location.href); var u = f.getLocationUrlWithoutHashAndQueryParams(); u = f.url.addQueryParamToUrl(u, "action", "setportalurl"); window.appInfo.isRunInPortal ? (this.removeEsriAuthCookieStorage(), window.location.href = B + "/oauth2/signout?client_id\x3darcgisonline\x26redirect_uri\x3d" +
                                                                t) : (this.removeWabAuthInfo(), p && p.supportsOAuth ? (p = B + "/oauth2/signout?client_id\x3d" + p.appId + "\x26redirect_uri\x3d" + u, window.location.href = p) : window.location.href = u)
                                                }, userHaveSignInPortal: function (p) { return !!this.getPortalCredential(E.trim(p || "")) }, isValidCredential: function (p) {
                                                        var B = !1; if (p) {
                                                                B = p.token; var t = p.server, u = p.scope; B = B && "string" === typeof B && E.trim(B); t = t && "string" === typeof t && E.trim(t); u = "portal" === u || "server" === u; var z = !0; p.expires && (p = parseInt(p.expires, 10), z = (new Date).getTime(), z =
                                                                        p > z); B = B && t && u && z
                                                        } return B
                                                }, isValidPortalCredentialOfPortalUrl: function (p, B) { var t = !1; this.isValidCredential(B) && (t = "portal" === B.scope, p = a.isSameServer(p, B.server), t = t && p); return t }, getPortalCredential: function (p) { var B = null; p = E.trim(p || ""); if (!p) return null; p = a.getStandardPortalUrl(p); (B = this._filterPortalCredential(p, k.id.credentials)) || this._tryConvertArcGIScomCrendentialToOrgCredential(); return B }, _tryConvertArcGIScomCrendentialToOrgCredential: function () {
                                                        var p = this.portalUrl; if (p && (p = a.getStandardPortalUrl(p),
                                                                a.isOrgOnline(p) && !this._filterPortalCredential(p, k.id.credentials))) { var B = this._filterPortalCredential("http://www.arcgis.com", k.id.credentials); B && k.id.registerToken({ token: B.token, scope: "portal", userId: B.userId, server: p + "/sharing/rest", expires: B.expires }) }
                                                }, saveAndRegisterCookieToCredential: function (p) {
                                                        p = E.clone(p); p.referer = window.location.host; p.scope = "portal"; p.isAdmin = !!p.isAdmin; this.saveWabAuthInfo(p); var B = p.server + "/sharing/rest"; p.server = B; k.id.registerToken(p); return k.id.findCredential(B,
                                                                p.userId)
                                                }, registerAuth2Hash: function (p) { p = E.clone(p); var B = 1E3 * parseInt(p.expires_in, 10); B = (new Date).getTime() + B; var t = a.getStandardPortalUrl(p.state.portalUrl); return this.saveAndRegisterCookieToCredential({ referer: window.location.host, server: t, token: p.access_token, expires: B, userId: p.username, scope: "portal", isAdmin: !!p.isAdmin }) }, readWabAuthInfo: function () { var p = null, B = localStorage.getItem("wab_token"); try { var t = m("wab_auth"); t && (p = v.parse(t), p.token = B) } catch (u) { console.error(u) } return p }, saveWabAuthInfo: function (p) {
                                                        p =
                                                        E.clone(p); this.removeWabAuthInfo(); localStorage.setItem("wab_token", p.token); delete p.token; m("wab_auth", v.stringify(p), { expires: new Date(p.expires), path: "/" })
                                                }, removeWabAuthInfo: function () { this.removeCookie("wab_auth"); localStorage.removeItem("wab_token") }, removeEsriAuthCookieStorage: function () { window.localStorage && window.localStorage.removeItem("esriJSAPIOAuth"); window.sessionStorage && window.sessionStorage.removeItem("esriJSAPIOAuth") }, _filterPortalCredential: function (p, B) {
                                                        var t = null; p = a.getStandardPortalUrl(p);
                                                        B && 0 < B.length && (B = q.filter(B, E.hitch(this, function (u) { return this.isValidPortalCredentialOfPortalUrl(p, u) })), 0 < B.length && (t = B[B.length - 1])); return t
                                                }, _removePortalCredential: function (p) {
                                                        var B = E.trim(p || ""); if (B) {
                                                                B = a.getStandardPortalUrl(B); for (p = q.filter(k.id.credentials, E.hitch(this, function (t) { return this.isValidPortalCredentialOfPortalUrl(B, t) })); 0 < p.length;)p[0].destroy(), p.splice(0, 1); k.id.credentials = q.filter(k.id.credentials, E.hitch(this, function (t) {
                                                                        return !this.isValidPortalCredentialOfPortalUrl(B,
                                                                                t)
                                                                }))
                                                        }
                                                }, getUserIdByToken: function (p, B) {
                                                        var t = new w; if (p && "string" === typeof p && B && "string" === typeof B) {
                                                                var u = a.getStandardPortalUrl(B); B = q.filter(k.id.credentials, E.hitch(this, function (x) { var y = x.token === p && x.userId; x = a.isSameServer(u, x.server); return y && x })); if (0 < B.length) { var z = B[0]; setTimeout(E.hitch(this, function () { t.resolve(z.userId) }), 0); return t } B = a.getCommunitySelfUrl(u); d({ url: B, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }).then(E.hitch(this, function (x) {
                                                                        t.resolve(x && x.username ||
                                                                                "")
                                                                }), E.hitch(this, function (x) { console.error(x); t.reject("fail to get userId by token") }))
                                                        } else setTimeout(E.hitch(this, function () { t.reject("invalid parameters") }), 0); return t
                                                }, xtGetCredentialFromCookie: function (p) {
                                                        var B = this.readWabAuthInfo(); if (!B || "object" !== typeof B || !a.isSameServer(p, B.server) || window.location.host !== B.referer) return null; B.expires = parseInt(B.expires, 10); var t = (new Date).getTime(); if (!(B.expires > t)) return this.removeWabAuthInfo(), null; p += "/sharing/rest"; B.server = p; (t = k.id.findCredential(p)) ||
                                                                k.id.registerToken(B); return t = k.id.findCredential(p)
                                                }, removeCookie: function (p) { var B = this.getCookiePath(); f.removeCookie(p, B) }, _getDomainsByServerName: function (p) { var B = p.split("."), t = B.length; return q.map(B, E.hitch(this, function (u, z) { u = B.slice(z, t); var x = "", y = u.length - 1; q.forEach(u, E.hitch(this, function (D, H) { x += D; H !== y && (x += ".") })); return x })) }, _publishCurrentPortalUserSignIn: function (p) { if (this.isValidCredential(p)) try { r.publish("userSignIn", p) } catch (B) { console.error(B) } }, _publishAnyUserSignIn: function (p) {
                                                        if (this.isValidCredential(p)) try {
                                                                r.publish("anyUserSignIn",
                                                                        p)
                                                        } catch (B) { console.error(B) }
                                                }, _publishCurrentPortalUserSignOut: function (p) { try { r.publish("userSignOut", p) } catch (B) { console.error(B) } }, _signInSuccess: function (p) { try { this.isValidPortalCredentialOfPortalUrl(this.portalUrl, p) && this._publishCurrentPortalUserSignIn(p), this._publishAnyUserSignIn(p) } catch (B) { console.error(B) } }, _bindEvents: function () { A.after(k.id, "signIn", E.hitch(this, function (p, B) { console.log(B[1]); A.after(p, "callback", E.hitch(this, function (t, u) { this._signInSuccess(u[0], !1) })); return p })) },
                                                isStart: function () { return this._started }, startup: function () {
                                                        if (!this._started) {
                                                                if (this.isInConfigOrPreviewWindow()) { var p = window.parent; if (p) { var B = p.esri && p.esri.id; B._wab = "builder"; if (B) { k.id = B; var t = window.esriConfig.defaults.io; p = p.esriConfig.defaults.io; t.corsEnabledServers = p.corsEnabledServers; t.webTierAuthServers = p.webTierAuthServers; t._processedCorsServers = p._processedCorsServers; t.corsStatus = p.corsStatus; Object.defineProperty(h, "id", { get: function () { return B }, enumerable: !0, configurable: !0 }) } } } this._bindEvents();
                                                                this._started = !0
                                                        }
                                                }
                                        }; b.startup(); return b
                                })
                }, "esri/layers/vectorTiles/kernel": function () { define(["require", "exports", "esri/kernel", "./identity/IdentityManager"], function (E, q, A, w) { return function () { function m() { } Object.defineProperty(m, "id", { get: function () { return A.id ? w : null }, enumerable: !0, configurable: !0 }); m.workerMessages = {}; return m }() }) }, "esri/layers/vectorTiles/identity/IdentityManager": function () {
                        define(["require", "exports", "esri/IdentityManager"], function (E, q, A) {
                                Object.defineProperty(q, "__esModule",
                                        { value: !0 }); q.findCredential = function (w) { return A.findCredential(w) }
                        })
                }, "jimu/dijit/Message": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/keys dojo/on jimu/dijit/Popup".split(" "), function (E, q, A, w, m, v) {
                                return E(v, {
                                        baseClass: "jimu-popup jimu-message", declaredClass: "jimu.dijit.Message", type: "message", message: "", autoHeight: !0, maxWidth: 350, maxHeight: 180, customZIndex: null, postMixInProperties: function () { this.content = this.message; window.currentMsgPopup = this }, _createTitleNode: function () {
                                                this.titleLabel &&
                                                (this.titleNode = A.create("div", { "class": "title" }, this.domNode), this.titleLabeNode = A.create("span", { "class": "title-label jimu-float-leading", innerHTML: this.titleLabel || "\x26nbsp" }, this.titleNode), this.closeBtnNode = A.create("div", { "class": "close-btn jimu-icon jimu-icon-close jimu-float-trailing", role: "button", tabindex: 0 }, this.titleNode), this.own(m(this.closeBtnNode, "click", q.hitch(this, this.close))), this.own(m(this.closeBtnNode, "keydown", q.hitch(this, function (r) { r.keyCode === w.ENTER && (this.close(), this.focusLastActiveNode()) }))))
                                        },
                                        _preProcessing: function () { 0 === this.buttons.length && this.buttons.push({ label: window.jimuNls.common.ok, key: w.ENTER, onClick: q.hitch(this, this.close) }) }, _increaseZIndex: function () { A.setStyle(this.domNode, "zIndex", 501); A.setStyle(this.overlayNode, "zIndex", 500) }
                                })
                        })
                }, "jimu/dijit/Popup": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/keys dojo/sniff dojo/touch dojo/query dojo/dnd/move dijit/_WidgetBase jimu/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                        var e = 0; return E([g, A], {
                                                declaredClass: "jimu.dijit.Popup", baseClass: "jimu-popup", classNames: [], titleLabel: "", content: null, container: null, customZIndex: null, buttons: [], enabledButtons: [], disabledButtons: [], onClose: null, _fixedHeight: !1, autoHeight: !1, isResize: !0, horizontalWidthRate: 0, maxHeight: 800, maxWidth: 1024, enableMoveable: !0, hasTitle: !0, contentHasNoMargin: !1, hasOverlay: !0, moveToCenter: !0, customPosition: null, hiddenAfterInit: !1, useFocusLogic: !0, constructor: function () {
                                                        this.buttons =
                                                        []; this.enabledButtons = []; this.disabledButtons = []; this.pauseKeyHandles = []; this.container = jimuConfig.layoutId
                                                }, focusLastActiveNode: function () { this.focusedNodeBeforeOpen && this.useFocusLogic && this.focusedNodeBeforeOpen.focus() }, postCreate: function () {
                                                        this.focusedNodeBeforeOpen = document.activeElement; this._preProcessing(); this.inherited(arguments); this._initDomNode(); this._addStylesByHeightType(); this._calcAndSetPosition(); m.place(this.domNode, this.container); setTimeout(q.hitch(this, function () {
                                                                this._calcAndSetPosition(!0,
                                                                        !1); this.initFocusNodes()
                                                        }), 50); this.isResize && this.own(r(window, "resize", q.hitch(this, function () { this._calcAndSetPosition(!0, !0) }))); this.hasOverlay && (this.overlayNode = m.create("div", { "class": "jimu-overlay" }, this.container)); this.customZIndex || 0 === this.customZIndex ? (m.setStyle(this.domNode, "zIndex", this.customZIndex + 1), this.overlayNode && m.setStyle(this.overlayNode, "zIndex", this.customZIndex)) : this._increaseZIndex(); this.hiddenAfterInit && this.hide(); v.animateProperty({
                                                                node: this.domNode, properties: { opacity: 1 },
                                                                duration: 200
                                                        }).play(); m.setAttr(this.domNode, "aria-label", window.jimuNls.common.popup); this.own(r(this.domNode, "keydown", q.hitch(this, function (a) { a.keyCode === l.ESCAPE && (this.closeBtnNode ? this.closeBtnNode.focus() : (this.close(), this.focusLastActiveNode())); b.preventMapNavigation(a) })))
                                                }, initFocusNodes: function () {
                                                        if (this.useFocusLogic) {
                                                                if ("string" === typeof this.content) {
                                                                        var a = "uniqMsgId_" + b.getUUID(); m.setAttr(this.contentContainerNode, "id", a); m.setAttr(this.domNode, "tabindex", "0"); m.setAttr(this.domNode,
                                                                                "aria-labelledby", a)
                                                                } this.firstFocusNode = this._getFirstFocusNode(); this.lastFocusNode = this._getLastFocusNode(); this.firstFocusNode && (this.own(r(this.firstFocusNode, "keydown", q.hitch(this, function (f) { f.shiftKey && f.keyCode === l.TAB && (f.preventDefault(), this.firstFocusNode.focus()) }))), this.firstFocusNode.focus()); this.lastFocusNode && this.own(r(this.lastFocusNode, "keydown", q.hitch(this, function (f) { f.shiftKey || f.keyCode !== l.TAB || (f.preventDefault(), this.firstFocusNode.focus()) })))
                                                        }
                                                }, _getFirstFocusNode: function () {
                                                        var a =
                                                                this.closeBtnNode; "string" === typeof this.content && (a = this.domNode); if (!a) { var f = []; this.content.domNode ? f = b.getFocusNodesInDom(this.content.domNode) : 1 === this.content.nodeType && (f = b.getFocusNodesInDom(this.content)); 0 < f.length ? a = f[0] : this.buttons.length && (a = this._getFirstBtn()) } return a
                                                }, _getLastFocusNode: function () {
                                                        var a = this._getLastBtn(); if (!a) if (this.content && "string" !== typeof this.content) {
                                                                var f; this.content.domNode ? f = b.getFocusNodesInDom(this.content.domNode) : 1 === this.content.nodeType && (f = b.getFocusNodesInDom(this.content));
                                                                a = 0 < f.length ? f[f.length - 1] : this.closeBtnNode
                                                        } else a = this.closeBtnNode; return a
                                                }, _getFirstBtn: function () { for (var a = null, f = d(".jimu-btn", this.buttonContainer), h = 0; h <= f.length - 1; h++)if ("none" !== m.getStyle(f[h], "display")) { a = f[h]; break } return a }, _getLastBtn: function () { for (var a = null, f = d(".jimu-btn", this.buttonContainer), h = f.length - 1; 0 <= h; h--)if ("none" !== m.getStyle(f[h], "display")) { a = f[h]; break } return a }, _preProcessing: function () {
                                                        "number" !== typeof this.width && (this.width = this.maxWidth); "number" === typeof this.height &&
                                                                (this._fixedHeight = !0, this.autoHeight = !1); this.autoHeight && (this.maxHeight = 598)
                                                }, _createTitleNode: function () {
                                                        this.titleNode = m.create("div", { "class": "title" }, this.domNode); this.titleLabeNode = m.create("span", { "class": "title-label jimu-float-leading", innerHTML: b.sanitizeHTML(this.titleLabel) || "\x26nbsp" }, this.titleNode); this.closeBtnNode = m.create("div", { "class": "close-btn jimu-icon jimu-icon-close jimu-float-trailing", tabindex: 0, "aria-label": window.jimuNls.common.close, role: "button" }, this.titleNode);
                                                        var a = null; a = "ontouchstart" in document ? n.press : "click"; this.own(r(this.closeBtnNode, a, q.hitch(this, this.close))); this.own(r(this.closeBtnNode, "keydown", q.hitch(this, function (f) { f.keyCode !== l.ENTER && f.keyCode !== l.SPACE || this.close() })))
                                                }, _initDomNode: function () {
                                                        for (var a = 0; a <= this.classNames.length - 1; a++)m.addClass(this.domNode, this.classNames[a]); this.hasTitle && this._createTitleNode(); this.contentContainerNode = m.create("div", { "class": "content" }, this.domNode); this.content && ("string" === typeof this.content ?
                                                                this.contentContainerNode.innerHTML = this.content : this.content.domNode ? (this.content.placeAt(this.contentContainerNode), this.content.popup = this) : 1 === this.content.nodeType && m.place(this.content, this.contentContainerNode)); this.buttonContainer = m.create("div", { "class": "button-container" }, this.domNode); 0 === this.buttons.length && m.setStyle(this.buttonContainer, "display", "none"); for (a = 0; a <= this.buttons.length - 1; a++)this._createButton(this.buttons[a]), this.buttons[a].disable && this.disableButton(a)
                                                }, _limitButtonsMaxWidth: function () {
                                                        var a =
                                                                this.enabledButtons.length; if (0 !== a) { var f = m.getContentBox(this.buttonContainer), h = m.getMarginExtents(this.enabledButtons[0]), p = m.getPadBorderExtents(this.enabledButtons[0]), B = 0; p = 8 === k("ie") ? p.l + p.r : 0; B = (f.w - (h.l + h.r + p) * a) / a; 0 < B && (w.forEach(this.enabledButtons, q.hitch(this, function (t) { m.setStyle(t, "maxWidth", B + "px") })), w.forEach(this.disabledButtons, q.hitch(this, function (t) { m.setStyle(t, "maxWidth", B + "px") }))) }
                                                }, _moveableNode: function (a, f) {
                                                        this.moveable && (this.moveable.destroy(), this.moveable = null);
                                                        var h = m.getMarginBox(this.container); h.l = h.l - a + f; h.w += 2 * (a - f); this.moveable = new c.boxConstrainedMoveable(this.domNode, { box: h, handle: this.titleNode || this.contentContainerNode, within: !0 }); this.own(r(this.moveable, "Moving", q.hitch(this, this.onMoving))); this.own(r(this.moveable, "MoveStop", q.hitch(this, this.onMoveStop)))
                                                }, _getHeaderBox: function () { return 0 === d("#header").length ? { t: 0, l: 0, w: 0, h: 0 } : m.getMarginBox("header") }, _getFooterBox: function () {
                                                        return 0 === d(".footer", this.container).length ? {
                                                                t: 0, l: 0, w: 0,
                                                                h: 0
                                                        } : m.getMarginBox(d(".footer", this.container)[0])
                                                }, _calcAndSetPosition: function (a, f) {
                                                        var h = m.getMarginBox(this.domNode); if ("string" !== typeof this.container || m.byId(this.container)) {
                                                                var p = m.getContentBox(this.container), B = this._getHeaderBox(), t = this._getFooterBox(); t = p.h - B.h - t.h - 40; var u = 0, z = 0; this.customPosition && this.customPosition.height ? (this.height = this.customPosition.height, z = "number" === typeof this.height ? this.height + "px" : this.height) : (this.height = this._fixedHeight ? this.height > t ? t : this.height :
                                                                        this.autoHeight ? (h.h > t ? t : h.h) || t - 200 : t > this.maxHeight ? this.maxHeight : t, z = this.height + "px"); this.customPosition && this.customPosition.width ? (this.width = this.customPosition.width, u = "number" === typeof this.width ? this.width + "px" : this.width) : ("number" === typeof this.horizontalWidthRate && 0 < this.horizontalWidthRate ? (u = m.getMarginBox(window.document.body).w * this.horizontalWidthRate, this.width = u = u > this.maxWidth ? u : this.maxWidth) : this.width = this.width || this.maxWidth, u = this.width + "px"); var x = h = 0; this.customPosition ?
                                                                                (h = "number" === typeof this.customPosition.left ? this.customPosition.left + "px" : this.customPosition.left, x = "number" === typeof this.customPosition.top ? this.customPosition.top + "px" : this.customPosition.top) : this.moveToCenter && (x = (t - this.height) / 2 + B.h + 20, x = x < B.h ? B.h : x, h = (p.w - this.width) / 2 + "px", x += "px"); m.setStyle(this.domNode, { width: u, height: this.autoHeight ? "auto" : z, left: h, top: x }); this.enableMoveable && this._moveableNode(this.width, 100); !this.moveToCenter && a && "block" === m.getStyle(this.domNode, "display") && this.emit("popupHasInitedSuccessfully",
                                                                                        f)
                                                        }
                                                }, setDomNodeStyls: function (a) { m.setStyle(this.domNode, a) }, setCustomPosition: function (a, f, h, p) { this.width = h || this.width || this.maxWidth; this.height = p || this.height || this.maxHeight; h = "number" === typeof this.width ? this.width + "px" : this.width; p = "number" === typeof this.height ? this.height + "px" : this.height; m.setStyle(this.domNode, { left: "number" === typeof a ? a + "px" : a, top: "number" === typeof f ? f + "px" : f, width: h, height: this.autoHeight ? "auto" : p }) }, _addStylesByHeightType: function () {
                                                        this.autoHeight ? (m.addClass(this.contentContainerNode,
                                                                "content-static"), 0 === this.buttons.length && m.setStyle(this.contentContainerNode, { marginBottom: "15px" })) : (m.addClass(this.contentContainerNode, "content-absolute"), this.hasTitle || m.addClass(this.contentContainerNode, "no-popup-title-content-absolute"), m.addClass(this.buttonContainer, "button-container-absolute"), 0 === this.buttons.length && m.setStyle(this.contentContainerNode, { bottom: "15px" })); this.contentHasNoMargin && m.addClass(this.contentContainerNode, "content-fill-Popup")
                                                }, _increaseZIndex: function () {
                                                        m.setStyle(this.domNode,
                                                                "zIndex", e + 200 + 1); this.overlayNode && m.setStyle(this.overlayNode, "zIndex", e + 200); e++
                                                }, setTitleLabel: function (a) { this.titleNode.innerHTML = b.stripHTML(a) }, onMoving: function (a) { m.setStyle(a.node, "opacity", .9) }, onMoveStop: function (a) { m.setStyle(a.node, "opacity", 1) }, show: function () { this.overlayNode && m.setStyle(this.overlayNode, "display", "block"); m.setStyle(this.domNode, "display", "block") }, hide: function () { this.overlayNode && m.setStyle(this.overlayNode, "display", "none"); m.setStyle(this.domNode, "display", "none") },
                                                close: function () { if (!this.onClose || !1 !== this.onClose()) { var a = this.domNode.parentNode, f = q.clone(this.domNode); m.setStyle(this.domNode, "display", "none"); this.overlayNode && m.destroy(this.overlayNode); this.destroy(); this.moveable && this.moveable.destroy(); m.place(f, a); v.animateProperty({ node: f, properties: { opacity: 0 }, duration: 200, onEnd: function () { m.destroy(f) } }).play(); this.focusLastActiveNode(); window.currentMsgPopup = null } }, addButton: function (a) { this._createButton(a) }, _createButton: function (a) {
                                                        var f =
                                                                " "; a.classNames && 0 < a.classNames.length && "function" === typeof a.classNames.join && (f += a.classNames.join(" ")); var h = m.create("div", { "class": "jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1 " + f, innerHTML: a.label, tabindex: 0, role: "button", title: a.title || a.label }, this.buttonContainer); this.enabledButtons.push(h); f = m.create("div", {
                                                                        "class": "jimu-btn jimu-state-disabled jimu-float-trailing jimu-trailing-margin1 " + f, title: a.title || a.label, innerHTML: a.label, tabindex: 0, role: "button",
                                                                        "aria-disabled": "true", style: { display: "none" }
                                                                }, this.buttonContainer); this.disabledButtons.push(f); this.own(r(h, "click", q.hitch(this, function (p) { if (a.onClick) a.onClick(p); else this.close() }))); this.own(r(h, "keydown", q.hitch(this, function (p) { if (p.keyCode === l.ENTER || p.keyCode === l.SPACE) if (a.onClick) a.onClick(p); else this.close() })))
                                                }, setButtonProps: function (a, f) {
                                                        "number" === typeof a && isFinite(a) || (f = a, a = 0); if (f && 0 !== this.enabledButtons.length) for (var h in f) "title" === h ? (m.setAttr(this.enabledButtons[a],
                                                                "title", f[h]), m.setAttr(this.disabledButtons[a], "title", f[h])) : "label" === h && (m.setProp(this.enabledButtons[a], "innerHTML", f[h]), m.setProp(this.disabledButtons[a], "innerHTML", f[h]))
                                                }, enableButton: function (a) {
                                                        "number" === typeof a && isFinite(a) && a < this.enabledButtons.length ? (m.setStyle(this.enabledButtons[a], "display", "inline-block"), m.setStyle(this.disabledButtons[a], "display", "none")) : (w.forEach(this.enabledButtons[a], q.hitch(this, function (f) { m.setStyle(f, "display", "inline-block") })), w.forEach(this.disabledButtons[a],
                                                                q.hitch(this, function (f) { m.setStyle(f, "display", "none") })))
                                                }, disableButton: function (a) { "number" === typeof a && isFinite(a) && a < this.disabledButtons.length ? (m.setStyle(this.disabledButtons[a], "display", "inline-block"), m.setStyle(this.enabledButtons[a], "display", "none")) : (w.forEach(this.disabledButtons, q.hitch(this, function (f) { m.setStyle(f, "display", "inline-block") })), w.forEach(this.enabledButtons, q.hitch(this, function (f) { m.setStyle(f, "display", "none") }))) }, showButton: function (a) { this.enableButton(a) },
                                                hideButton: function (a) { "number" === typeof a && isFinite(a) && a < this.disabledButtons.length ? (m.setStyle(this.disabledButtons[a], "display", "none"), m.setStyle(this.enabledButtons[a], "display", "none")) : (w.forEach(this.disabledButtons, q.hitch(this, function (f) { m.setStyle(f, "display", "none") })), w.forEach(this.enabledButtons, q.hitch(this, function (f) { m.setStyle(f, "display", "none") }))) }, resize: function (a) {
                                                        a && (this.width = a.w, this.height = a.h); this._calcAndSetPosition(); this.content && this.content.domNode && this.content.resize &&
                                                                this.content.resize()
                                                }
                                        })
                                })
                }, "dojo/dnd/move": function () {
                        define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "), function (E, q, A, w, m, v) {
                                w = E("dojo.dnd.move.constrainedMoveable", v, {
                                        constraints: function () { }, within: !1, constructor: function (r, l) { l || (l = {}); this.constraints = l.constraints; this.within = l.within }, onFirstMove: function (r) { var l = this.constraintBox = this.constraints.call(this, r); l.r = l.l + l.w; l.b = l.t + l.h; this.within && (r = q.getMarginSize(r.node), l.r -= r.w, l.b -= r.h) },
                                        onMove: function (r, l) { var k = this.constraintBox, n = r.node.style; this.onMoving(r, l); l.l = l.l < k.l ? k.l : k.r < l.l ? k.r : l.l; l.t = l.t < k.t ? k.t : k.b < l.t ? k.b : l.t; n.left = l.l + "px"; n.top = l.t + "px"; this.onMoved(r, l) }
                                }); m = E("dojo.dnd.move.boxConstrainedMoveable", w, { box: {}, constructor: function (r, l) { var k = l && l.box; this.constraints = function () { return k } } }); E = E("dojo.dnd.move.parentConstrainedMoveable", w, {
                                        area: "content", constructor: function (r, l) {
                                                var k = l && l.area; this.constraints = function () {
                                                        var n = this.node.parentNode, d = A.getComputedStyle(n),
                                                        c = q.getMarginBox(n, d); if ("margin" == k) return c; var g = q.getMarginExtents(n, d); c.l += g.l; c.t += g.t; c.w -= g.w; c.h -= g.h; if ("border" == k) return c; g = q.getBorderExtents(n, d); c.l += g.l; c.t += g.t; c.w -= g.w; c.h -= g.h; if ("padding" == k) return c; g = q.getPadExtents(n, d); c.l += g.l; c.t += g.t; c.w -= g.w; c.h -= g.h; return c
                                                }
                                        }
                                }); return { constrainedMoveable: w, boxConstrainedMoveable: m, parentConstrainedMoveable: E }
                        })
                }, "jimu/DataSourceManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Evented dojo/when ./utils jimu/LayerInfos/LayerInfos jimu/portalUtils jimu/portalUrlUtils jimu/filterUtils esri/tasks/query esri/tasks/QueryTask esri/tasks/StatisticDefinition ./Query".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                        var a = null, f = E(m, {
                                                constructor: function () {
                                                        this._listeners = []; this._refreshTimers = []; this._dataStore = {}; this._jimuQueryObject = {}; this._dataSourceUsage = {}; this._itemsFilter = {}; this.filterUtils = new d; window.isBuilder ? (w.subscribe("app/mapLoaded", q.hitch(this, this._onMapLoaded)), w.subscribe("app/mapChanged", q.hitch(this, this._onMapChanged))) : (w.subscribe("mapLoaded", q.hitch(this, this._onMapLoaded)), w.subscribe("mapChanged", q.hitch(this, this._onMapChanged))); window.isBuilder ?
                                                                (w.subscribe("app/appConfigLoaded", q.hitch(this, this._onAppConfigLoaded)), w.subscribe("app/appConfigChanged", q.hitch(this, this._onAppConfigChanged))) : (w.subscribe("appConfigLoaded", q.hitch(this, this._onAppConfigLoaded)), w.subscribe("appConfigChanged", q.hitch(this, this._onAppConfigChanged))); w.subscribe("updateDataSourceData", q.hitch(this, this._onUpdataDataSourceData)); window.isBuilder && w.subscribe("app/dataSourceDataUpdated", q.hitch(this, this._onDataSourceDataUpdatedInApp))
                                                }, getData: function (h) { return this._dataStore[h] },
                                                getDataSourceConfig: function (h) { return this.appConfig.dataSource.dataSources[h] }, parseDataSourceId: function (h) { var p = h.split("~"), B = {}; if (2 > p.length) return console.error("Bad data source id:", h), B; switch (p[0]) { case "map": return p = h.lastIndexOf("~"), B = { from: "map", layerId: h.substring(4, p) }; case "widget": return B = { from: "widget", widgetId: p[1] }; case "external": return B = { from: "external" }; default: console.error("Bad data source id:", h) } }, addDataSourceUsage: function (h, p) {
                                                        this._dataSourceUsage[h] ? (0 > this._dataSourceUsage[h].indexOf(p) &&
                                                                this._dataSourceUsage[h].push(p), 1 === this._dataSourceUsage[h].length && this._startOneDataSource(this.appConfig.dataSource.dataSources[h])) : (this._dataSourceUsage[h] = [p], this._startOneDataSource(this.appConfig.dataSource.dataSources[h]))
                                                }, removeDataSourceUsage: function (h, p) { this._dataSourceUsage[h] && 0 <= this._dataSourceUsage[h].indexOf(p) && (this._dataSourceUsage[h] = A.filter(this._dataSourceUsage[h], function (B) { return B !== p })) }, _onUpdataDataSourceData: function (h, p) {
                                                        this.appConfig.dataSource.dataSources[h] ?
                                                        "widget" !== this.parseDataSourceId(h).from ? console.error("Please update data source from widget only.", h) : this._updateDataSourceData(h, p) : console.error("Not found data source id:", h)
                                                }, _updateDataSourceData: function (h, p) { this._dataStore[h] = p; w.publish("dataSourceDataUpdated", h, p); this.emit("update", h, p) }, _onDataSourceDataUpdatedInApp: function (h, p) { this._updateDataSourceData(h, p) }, _onMapLoaded: function (h) { this.map = h; window.isBuilder || this._handleDataSourceConfigChange(this.appConfig, this.appConfig, "mapLoaded") },
                                                _onMapChanged: function (h) { this.map = h; window.isBuilder || this._handleDataSourceConfigChange(this.appConfig, this.appConfig, "mapChanged") }, _onAppConfigLoaded: function (h) { this.appConfig = q.clone(h) }, _onAppConfigChanged: function (h, p) { h = q.clone(h); window.isBuilder || ("dataSourceChange" === p ? this._handleDataSourceConfigChange(this.appConfig, h, p) : "mapChange" === p && this._cleanForConfigChangedDataSource(this.appConfig, h)); this.appConfig = h }, _handleDataSourceConfigChange: function (h, p, B) {
                                                        h && (this._removeListeners(),
                                                                this._removeTimers(), this._cleanForConfigChangedDataSource(h, p)); A.forEach(Object.keys(p.dataSource.dataSources), function (t) { p.dataSource.dataSources[t].idObj = this.parseDataSourceId(t) }, this); this._listenDataSourceChange(p.dataSource.dataSources); this._startRefreshTimer(p.dataSource, B); this._initStaticDataSource(p.dataSource)
                                                }, _cleanForConfigChangedDataSource: function (h, p) {
                                                        var B = h.dataSource.dataSources, t = p.dataSource.dataSources; A.forEach(Object.keys(B), function (u) {
                                                                if (!t[u] || t[u] && !r.isEqual(t[u],
                                                                        B[u])) delete this._jimuQueryObject[u], this._updateDataSourceData(u, { features: [] }), delete this._dataStore[u]
                                                        }, this)
                                                }, _isGlobalRefresh: function (h) { return h.unifiedRefreshInterval && 0 < h.unifiedRefreshInterval }, _startOneDataSource: function (h) {
                                                        var p = this._isGlobalRefresh(this.appConfig.dataSource.settings) ? this.appConfig.dataSource.settings.unifiedRefreshInterval : h.refreshInterval; if ("map" === h.idObj.from) this._listenMapDataSourceChange(h); else if ("external" === h.idObj.from && h.filterByExtent) {
                                                                var B = {}; B.handle =
                                                                        this.map.on("extent-change", q.hitch(this, this._onLayerDataChange, h)); B.dsId = h.id; this._listeners.push(B)
                                                        } if ("map" === h.idObj.from || "external" === h.idObj.from) this._refeshDataSource(h), h.isDynamic && (B = {}, B.handle = setInterval(q.hitch(this, this._refeshDataSource, h), 6E4 * p), B.dsId = h.id, this._refreshTimers.push(B))
                                                }, _stopAndCleanOneDataSource: function (h) {
                                                        this._listeners = A.filter(this._listeners, function (p) { return p.dsId === h.id ? (p.handle.remove(), !1) : !0 }, this); this._refreshTimers = A.filter(this._refreshTimers,
                                                                function (p) { return p.dsId === h.id ? (clearInterval(p.handle), !1) : !0 }, this); this._updateDataSourceData(h.id, { features: [] })
                                                }, _listenDataSourceChange: function (h) { A.forEach(Object.keys(h), function (p) { p = h[p]; if ("map" === p.idObj.from) this._listenMapDataSourceChange(p); else if ("external" === p.idObj.from && p.filterByExtent) { var B = {}; B.handle = this.map.on("extent-change", q.hitch(this, this._onLayerDataChange, p)); B.dsId = p.id; this._listeners.push(B) } }, this) }, _listenMapDataSourceChange: function (h) {
                                                        this._getLayerObject(h.idObj.layerId).then(q.hitch(this,
                                                                function (p) { if (p) { var B = {}; B.handle = p.on("edits-complete", q.hitch(this, this._onLayerDataChange, h)); B.dsId = h.id; this._listeners.push(B); B = {}; B.handle = this._getLayerInfo(h.idObj.layerId).on("filterChanged", q.hitch(this, this._onLayerDataChange, h)); B.dsId = h.id; this._listeners.push(B); h.filterByExtent && (B = {}, B.handle = this.map.on("extent-change", q.hitch(this, this._onLayerDataChange, h)), B.dsId = h.id, this._listeners.push(B)) } else console.error("Can not find layer that data source depends on.", h.id) }))
                                                }, _onLayerDataChange: function (h) { this._doQueryForDataSource(h) },
                                                _doQueryForDataSource: function (h) { ("config" === this.appConfig.mode || this._dataSourceUsage[h.id] && 0 !== this._dataSourceUsage[h.id].length) && this.doQuery(h).then(q.hitch(this, function (p) { this._updateDataSourceData(h.id, { features: p.features }) })) }, _getLayerObject: function (h) { return (h = l.getInstanceSync().getLayerOrTableInfoById(h)) ? h.getLayerObject() : v(null) }, _getLayerInfo: function (h) { return l.getInstanceSync().getLayerOrTableInfoById(h) }, _startRefreshTimer: function (h, p) {
                                                        var B = h.dataSources, t = h.settings;
                                                        A.forEach(Object.keys(B), function (u) { u = B[u]; if ("widget" !== u.idObj.from && u.isDynamic && u.url) { var z = this._isGlobalRefresh(t) ? t.unifiedRefreshInterval : u.refreshInterval; "dataSourceChange" === p ? ("external" === u.idObj.from || "map" === u.idObj.from) && this._refeshDataSource(u) : "external" === u.idObj.from && this._refeshDataSource(u); u = { handle: setInterval(q.hitch(this, this._refeshDataSource, u), 6E4 * z), dsId: h.id }; this._refreshTimers.push(u) } }, this)
                                                }, _initStaticDataSource: function (h) {
                                                        A.forEach(Object.keys(h.dataSources),
                                                                function (p) { p = h.dataSources[p]; "widget" !== p.idObj.from && !p.isDynamic && p.url && this._doQueryForDataSource(p) }, this)
                                                }, _refeshDataSource: function (h) { this._doQueryForDataSource(h) }, _getDataSourceFilter: function (h) {
                                                        if ("map" === h.idObj.from) { var p = l.getInstanceSync().getLayerOrTableInfoById(h.idObj.layerId), B; p && (B = p.getFilter()); p = h.filter ? this._getFilterExpr(h.filter, h.url) : "1\x3d1"; var t = B ? "(" + B + ") and (" + p + ")" : p; return v(t) } return "external" === h.idObj.from ? h.portalUrl && h.itemId ? this._getFilterFromItem(h.portalUrl,
                                                                h.itemId, h.url).then(q.hitch(this, function (u) { var z = h.filter ? this._getFilterExpr(h.filter, h.url) : "1\x3d1"; return t = u ? "(" + u + ") and (" + z + ")" : z })) : v(h.filter ? this._getFilterExpr(h.filter, h.url) : "1\x3d1") : v(h.filter ? this._getFilterExpr(h.filter, h.url) : "1\x3d1")
                                                }, _getFilterExpr: function (h, p) { return this.filterUtils.hasVirtualDate(h) ? (this.filterUtils.isHosted = r.isHostedService(p), this.filterUtils.getExprByFilterObj(h)) : h.expr }, _getFilterFromItem: function (h, p, B) {
                                                        var t = n.getItemUrl(h, p); if (this._itemsFilter[t]) return v(this._itemsFilter[t]);
                                                        var u = k.getPortal(h); return u.getItemById(p).then(q.hitch(this, function (z) { return "Feature Service" !== z.type ? this._itemsFilter[t] = null : u.getItemData(p).then(q.hitch(this, function (x) { var y = B.split("/"), D = y.pop(); D || (D = y.pop()); if (!x.layers) return this._itemsFilter[t] = null; x = x.layers.filter(function (H) { return H.id + "" === D })[0]; return x && x.layerDefinition ? this._itemsFilter[t] = x.layerDefinition.definitionExpression : this._itemsFilter[t] = null })) }))
                                                }, doQuery: function (h) {
                                                        h.idObj || (h.idObj = this.parseDataSourceId(h.id));
                                                        this.emit("begin-update", h.id); return this._getQueryObjectFromDataSource(h).then(q.hitch(this, function (p) {
                                                                if ("Features" === h.type) {
                                                                        if ("serviceLimitation" === h.resultRecordType) { var B = p; var t = new g(h.url); return t.execute(B) } var u = this._jimuQueryObject[h.id]; !u || u.url === h.url && r.isEqual(u.query.toJson(), p.toJson()) || (delete this._jimuQueryObject[h.id], u = null); u || (u = {}, u.url = h.url, u.query = p, "all" !== h.resultRecordType && (u.pageSize = h.resultRecordCount), u = new e(u), this._jimuQueryObject[h.id] = u); return "all" ===
                                                                                h.resultRecordType ? u.getAllFeatures() : u.queryByPage(1)
                                                                } t = new g(h.url); B = new c; return this._getDataSourceFilter(h).then(q.hitch(this, function (z) {
                                                                        B.where = z; h.filterByExtent && (B.geometry = this.map.extent); h.dataSchema.groupByFields && 0 < h.dataSchema.groupByFields.length && (B.groupByFieldsForStatistics = h.dataSchema.groupByFields); h.dataSchema.orderByFields && 0 < h.dataSchema.orderByFields.length && (B.orderByFields = h.dataSchema.orderByFields); B.outStatistics = h.dataSchema.statistics.map(function (x) {
                                                                                var y = x.onStatisticField +
                                                                                        "_" + x.statisticType; "count" === x.statisticType && (y = "STAT_COUNT"); y = r.upperCaseString(y); var D = new b; D.statisticType = x.statisticType; D.onStatisticField = x.onStatisticField; D.outStatisticFieldName = y; return D
                                                                        }); return t.execute(B)
                                                                }))
                                                        }))
                                                }, _getQueryObjectFromDataSource: function (h) {
                                                        return this._getDataSourceFilter(h).then(q.hitch(this, function (p) {
                                                                var B = new c; B.where = p; h.filterByExtent && (B.geometry = this.map.extent); B.outFields = h.dataSchema.fields.map(function (t) { return t.name }); h.dataSchema.orderByFields &&
                                                                        0 < h.dataSchema.orderByFields.length && (B.orderByFields = h.dataSchema.orderByFields); B.returnGeometry = !0; B.outSpatialReference = this.map.spatialReference; return v(B)
                                                        }))
                                                }, _removeListeners: function () { this._listeners.forEach(q.hitch(this, function (h) { h.handle.remove() })); this._listeners = [] }, _removeTimers: function () { this._refreshTimers.forEach(q.hitch(this, function (h) { clearInterval(h.handle) })); this._refreshTimers = [] }
                                        }); f.getInstance = function () { null === a && (a = new f, window._datasourceManager = a); return a }; return f
                                })
                },
                "jimu/LayerInfos/LayerInfos": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/on dojo/topic dojo/Evented dojo/promise/all ./LayerInfoFactory libs/crc".split(" "), function (E, q, A, w, m, v, r, l, k, n) {
                                var d = E([r], {
                                        declaredClass: "jimu.LayerInfos", map: null, _operLayers: null, _layerInfos: null, _finalLayerInfos: null, _tableInfos: null, _basemapLayerInfos: null, _finalBasemapLayerInfos: null, _basemapLayers: null, _unreachableLayersTitleOfWebmap: null, _objectId: null, _layerInfoFactory: null,
                                        _previousLayerOrder: null, constructor: function (b, e) { this._objectId = Math.random(); this._unreachableLayersTitleOfWebmap = []; this._basemapLayers = e.baseMap.baseMapLayers; this._operLayers = e.operationalLayers; this._tables = e.tables; this._layerInfoFactory = new k(b, this); this.map = b; this._previousLayerOrder = [].concat(this.map.layerIds, this.map.graphicsLayerIds); this._initLayerInfos(); this._initBasemapLayerInfos(); this._initTablesInfos(); this.update(); this._bindEvents() }, update: function () {
                                                this._extraSetLayerInfos();
                                                this._clearAddedFlag(this._finalLayerInfos); this._clearAddedFlag(this._finalBasemapLayerInfos); this._initFinalLayerInfos(); this._initFinalBasemapLayerInfos(); this._markFirstOrLastNode()
                                        }, getLayerInfoArrayOfWebmap: function () { var b = []; q.forEach(this.getLayerInfoArray(), function (e) { for (var a = 0; a < this._operLayers.length; a++)if (e.id === this._operLayers[a].id) { b.push(e); break } a === this._operLayers.length && 0 <= this._removedLayerInfoIdsFromFeatureCollection.indexOf(e.id) && b.push(e) }, this); return b }, getTableInfoArrayOfWebmap: function () {
                                                var b =
                                                        []; q.forEach(this.getTableInfoArray(), function (e) { for (var a = 0; a < this._tables.length; a++)if (e.id === this._tables[a].id) { b.push(e); break } }, this); return b
                                        }, getLayerInfoArray: function () { return q.filter(this._finalLayerInfos, function (b) { A.getObject("_wabProperties.isTemporaryLayer", !1, b.layerObject) && (b._flag._isTemporaryLayerInfo = !0); return !b._flag._isTemporaryLayerInfo }) }, getTableInfoArray: function () { return this._tableInfos }, getBasemapLayerInfoArray: function () { return this._finalBasemapLayerInfos }, addFeatureCollection: function (b,
                                                e) { var a = this._getUniqueTopLayerInfoId(e), f = { layers: [] }; q.forEach(b, function (p, B) { p.id = a + "_" + B; f.layers.push({ id: p.id, layerObject: p }) }, this); this.map.addLayers(b); try { var h = this._layerInfoFactory.create({ featureCollection: f, title: e || a, id: a }, this.map); h.init() } catch (p) { console.warn(p.message), h = null } h && (h._extraOfWebmapLayerInfo = !0, this._layerInfos.push(h), this.update(), this._onLayersUpdated(h, h.getRootLayerInfo())) }, addTable: function (b) { b = this._addTables([b], this._tableInfos); return b[0] ? b[0] : null },
                                        removeTable: function (b) { var e = -1; q.forEach(this._tableInfos, function (f, h) { b.id === f.id && (e = h) }); if (0 <= e) { var a = this._tableInfos[e]; this._tableInfos.splice(e, 1); a.destroy(); this._onTableChange([b], d.REMOVED) } }, _addTables: function (b, e) {
                                                var a = [], f = []; q.forEach(b, function (h) {
                                                        try { h.layerObject = { url: h.url, featureCollectionData: h.featureCollectionData, empty: !0 }; h.id = this._getUniqueTableId(h.id); h.selfType = "table"; var p = this._layerInfoFactory.create(h); p.init() } catch (B) { console.warn(B.message), p = null } p && (a.push(p),
                                                                e.push(p), f.push(p.getLayerObject()))
                                                }, this); l(f).then(A.hitch(this, function (h) { var p = []; q.forEach(h, function (B, t) { t = a[t]; B ? p.push(t) : (this.removeTable(t), t.destroy()) }, this); this._onTableChange(p, d.ADDED) })); return a
                                        }, _getUniqueTableId: function (b) { var e = this._tableInfos.concat(this._tableInfos || []); return this._getUniqueLayerOrTableId(b, e) }, _getUniqueTopLayerInfoId: function (b) { return this._getUniqueLayerOrTableId(b, this._finalLayerInfos) }, _getUniqueLayerOrTableId: function (b, e) {
                                                var a = 1, f; b || (b = "table");
                                                for (f = b; ;) { for (var h = 0; h < e.length && e[h].id !== f; h++); if (h === e.length) return f; f = b + "_" + a.toString(); a++ }
                                        }, _traversal: function (b, e) { for (var a = 0; a < e.length; a++)if (e[a].traversal(b)) return !0; return !1 }, traversal: function (b) { var e = this.getLayerInfoArray(); return this._traversal(b, e) }, traversalLayerInfosOfWebmap: function (b) { var e = this.getLayerInfoArrayOfWebmap(); return this._traversal(b, e) }, traversalAll: function (b) {
                                                var e = this.getLayerInfoArray(), a = this.getBasemapLayerInfoArray(), f = this.getTableInfoArray();
                                                e = e.concat(a.concat(f)); return this._traversal(b, e)
                                        }, _traversalAllWithSpecialLayerInfo: function (b) { return this._traversal(b, this._finalLayerInfos.concat(this._tableInfos)) }, getLayerInfoById: function (b) { return this._findLayerInfoById(b) }, getTableInfoById: function (b) { var e = null; q.some(this.getTableInfoArray(), function (a) { if (a.id === b) return e = a, !0 }); return e }, getLayerOrTableInfoById: function (b) { var e = null; this.traversalAll(function (a) { if (a.id === b) return e = a, !0 }); return e }, getLayerInfoByTopLayerId: function (b) { return this._findTopLayerInfoById(b) },
                                        moveUpLayer: function (b, e) { var a = null; e = e ? e : 1; b = this._getTopLayerInfoIndexById(b.id); 0 <= b - e && (a = this._finalLayerInfos[b - e].obtainLayerIndexesInMap().length, this._finalLayerInfos[b].moveRightOfIndex(this._finalLayerInfos[b - e].obtainLayerIndexesInMap()[a - 1].index), a = this._finalLayerInfos[b - e]); return a }, _reorderLayerInfosArray: function (b, e, a) {
                                                "moveup" === a ? (a = this._finalLayerInfos[b], this._finalLayerInfos.splice(b, 1), this._finalLayerInfos.splice(b - e, 0, a)) : (a = this._finalLayerInfos[b], this._finalLayerInfos.splice(b +
                                                        e + 1, 0, a), this._finalLayerInfos.splice(b, 1)); this._markFirstOrLastNode(); return a
                                        }, moveDownLayer: function (b, e) { var a = null; e = e ? e : 1; b = this._getTopLayerInfoIndexById(b.id); b + e <= this._finalLayerInfos.length - 1 && (this._finalLayerInfos[b].moveLeftOfIndex(this._finalLayerInfos[b + e].obtainLayerIndexesInMap()[0].index), a = this._finalLayerInfos[b + e]); return a }, getBasemapLayers: function () {
                                                var b = []; q.forEach(this.map.layerIds.concat(this.map.graphicsLayerIds || []), function (e) {
                                                        e = this.map.getLayer(e); "basemap" !== e._basemapGalleryLayerType &&
                                                                "reference" !== e._basemapGalleryLayerType || b.push(e)
                                                }, this); return b.reverse()
                                        }, getMapNotesLayerInfoArray: function () { return q.filter(this.getLayerInfoArray(), function (b) { return b.isMapNotesLayerInfo() }, this) }, restoreState: function (b) { var e = b && b.layerOptions ? b.layerOptions : null; q.forEach(this._finalLayerInfos, function (a) { a.resetLayerObjectVisibility(e) }, this) }, _getEncodedLayerIdsOfCurrentMap: function () {
                                                this._encodedLayerIds || (this._encodedLayerIds = { encodedToLayerIds: {}, layerIdsToEncoded: {} }, this.traversal(A.hitch(this,
                                                        function (b) { var e = this._encodeLayerId(b.id); this._encodedLayerIds.encodedToLayerIds[e] = b.id; this._encodedLayerIds.layerIdsToEncoded[b.id] = e }))); return this._encodedLayerIds
                                        }, _getShowOrHideLayerIdsBySimpleState: function (b) {
                                                var e = [], a = [], f = { showLayerIds: null, hideLayerIds: null }, h = this._getEncodedLayerIdsOfCurrentMap().encodedToLayerIds; b && b.showLayersEncoded && h ? (q.forEach(b.showLayersEncoded, function (p) { (p = h[p]) && e.push(p) }), f.showLayerIds = e) : b && b.showLayers ? f.showLayerIds = b.showLayers : b && b.hideLayersEncoded &&
                                                        h ? (q.forEach(b.hideLayersEncoded, function (p) { (p = h[p]) && a.push(p) }), f.hideLayerIds = a) : b && b.hideLayers && (f.hideLayerIds = b.hideLayers); return f
                                        }, _getSibilingLayerInfos: function (b) { return b.isRootLayer() ? this._finalLayerInfos : b.parentLayerInfo.getSubLayers() }, _revertSibilingLayersOnState: function (b, e, a) { b = this._getSibilingLayerInfos(b); q.some(b, A.hitch(this, function (f) { f = f.id; e.layerOptions[f] || (e.layerOptions[f] = { visible: a }) })) }, setSimplificationState: function (b) {
                                                var e = { layerOptions: {} }, a = this._getShowOrHideLayerIdsBySimpleState(b);
                                                this.traversal(A.hitch(this, function (f) {
                                                        var h = null; if (a.showLayerIds) { var p = a.showLayerIds; var B = !0 } else p = a.hideLayerIds, B = !1; q.some(p, function (t) { if (f.id === t) return h = f.id, !0; if (f.title.trim && t.trim && f.title.trim() === t.trim()) return h = f.id, !1 }); B ? null !== h ? (e.layerOptions[f.id] = { visible: !0 }, this._revertSibilingLayersOnState(f, e, !1)) : 0 === p.length && (e.layerOptions[f.id] = { visible: !1 }) : null !== h ? (e.layerOptions[f.id] = { visible: !1 }, this._revertSibilingLayersOnState(f, e, !0)) : 0 === p.length && (e.layerOptions[f.id] =
                                                                { visible: !0 })
                                                })); this.restoreState(e)
                                        }, getSimplificationState: function () { var b = { showLayers: [], showLayersEncoded: [], hideLayers: [], hideLayersEncoded: [] }; this.traversal(A.hitch(this, function (e) { e.isVisible() ? (b.showLayers.push(e.id), b.showLayersEncoded.push(this._encodeLayerId(e.id))) : (b.hideLayers.push(e.id), b.hideLayersEncoded.push(this._encodeLayerId(e.id))) })); return b }, _encodeLayerId: function (b) { var e = n.crc24; b = e(b); b = parseInt(b, 16); return b = b.toString(36) }, getUnreachableLayersTitle: function () { return this._unreachableLayersTitleOfWebmap },
                                        getObjectId: function () { return this._objectId }, _initLayerInfos: function () { this._layerInfos = []; this._initSpecifiedLayerInfos(this._operLayers, this._layerInfos) }, _initBasemapLayerInfos: function () { this._basemapLayerInfos = []; this._initSpecifiedLayerInfos(this._basemapLayers, this._basemapLayerInfos) }, _initSpecifiedLayerInfos: function (b, e) {
                                                var a; q.forEach(b, function (f) {
                                                        try { a = this._layerInfoFactory.create(f), a.init() } catch (h) { console.warn(h.message), a = null, 0 <= h.message.indexOf("declaredClass") && this._unreachableLayersTitleOfWebmap.push(f.title) } a &&
                                                                e.push(a)
                                                }, this)
                                        }, _extraSetLayerInfos: function () {
                                                this._removedLayerInfoIdsFromFeatureCollection = []; q.forEach(this._finalLayerInfos || this._layerInfos, function (b, e) {
                                                        if (b._needToRenew()) { try { var a = this._layerInfoFactory.create(b.originOperLayer); a.init() } catch (h) { console.warn(h.message), a = null } a && (b.destroy(), this._finalLayerInfos[e] = a) } else if (b.originOperLayer.featureCollection) {
                                                                var f = []; q.forEach(b.getSubLayers(), function (h) { f.push(h.id) }); q.forEach(f, function (h) { this.map.getLayer(h) || b.removeSubLayerById(h) },
                                                                        this); 1 === b.getSubLayers().length && (e = b.getSubLayers()[0], this.map.getLayer(e.id).title = b.title, b.removeSubLayerById(e.id), this._removedLayerInfoIdsFromFeatureCollection.push(e.id), b.id += "_logically_removed")
                                                        }
                                                }, this)
                                        }, _refineFinalLayerInfos: function () { this._finalLayerInfos && (this._finalLayerInfos = q.filter(this._finalLayerInfos, function (b) { return !b._flag._invalid })) }, _initFinalLayerInfos: function () {
                                                var b, e = this._finalLayerInfos || this._layerInfos; this._finalLayerInfos = []; for (b = this.map.graphicsLayerIds.length -
                                                        1; 0 <= b; b--) { var a = this.map.graphicsLayerIds[b]; this._isBasemap(a) || this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(a, e), a, !0) } for (b = this.map.layerIds.length - 1; 0 <= b; b--)a = this.map.layerIds[b], this._isBasemap(a) || this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(a, e), a, !1); this._refineFinalLayerInfos()
                                        }, _initTablesInfos: function () { this._tableInfos = []; var b = this._tables && this._tables.reverse(); b && this._addTables(b, this._tableInfos) }, _initFinalBasemapLayerInfos: function () {
                                                var b =
                                                        this._finalBasemapLayerInfos || this._basemapLayerInfos; this._finalBasemapLayerInfos = []; q.forEach(this.getBasemapLayers(), function (e) { var a; q.some(b, function (f) { if (f.id === e.id) return a = f, !0 }, this); this._addToFinalBasemapLayerInfos(a, e.id, !1) }, this)
                                        }, _isBasemap: function (b) { for (var e = !1, a = this.getBasemapLayers(), f = 0; f < a.length; f++)a[f].id === b && (e = !0); return e }, _addToFinalBasemapLayerInfos: function (b, e, a) { this._addToSpecifiedLayerInfos(b, e, a, this._finalBasemapLayerInfos) }, _addToFinalLayerInfos: function (b,
                                                e, a) { this._addToSpecifiedLayerInfos(b, e, a, this._finalLayerInfos) }, _addToSpecifiedLayerInfos: function (b, e, a, f) {
                                                        if (b) b._addedFlag || b.isGraphicLayer() !== a || (f.push(b), b._addedFlag = !0); else {
                                                                b = this.map.getLayer(e); if ("esri.layers.GraphicsLayer" !== b.declaredClass && "esri.layers.LabelLayer" !== b.declaredClass) {
                                                                        try { var h = { layerObject: b, title: this._getLayerTitle(b), id: b.id || " " }; A.mixin(h, A.getObject("_wabProperties.originOperLayer", !1, b)); var p = this._layerInfoFactory.create(h, this.map); p.init() } catch (B) {
                                                                                console.warn(B.message),
                                                                                p = null
                                                                        } p && (A.getObject("_wabProperties.isTemporaryLayer", !1, b) && (p._flag._isTemporaryLayerInfo = !0), f.push(p))
                                                                } ("esri.layers.ArcGISDynamicMapServiceLayer" === b.declaredClass || "esri.layers.ArcGISTiledMapServiceLayer" === b.declaredClass) && p && p._getServiceDefinition().then(A.hitch(this, function (B) { var t = []; q.forEach(B.tables, function (u) { u.url = p.getUrl() + "/" + u.id; u.id = p.id + "_" + u.id; u.title = this._getLayerTitle(u); t.push(u) }, this); this._addTables(t, this._tableInfos) }))
                                                        }
                                                }, _getLayerTitle: function (b) {
                                                        if (b.title) return b.title;
                                                        if (A.getObject("_wabProperties.originalLayerName", !1, b)) return b.name || b.id; var e = b.label || b.name || ""; if (b.url && !A.getObject("_wabProperties.itemLayerInfo", !1, b)) { var a = b.url.indexOf("/FeatureServer"); -1 === a && (a = b.url.indexOf("/MapServer")); -1 === a && (a = b.url.indexOf("/service")); -1 < a && (a = b.url.substring(0, a), a = a.substring(a.lastIndexOf("/") + 1, a.length), e = e ? a + " - " + e : a) } return e || b.id
                                                }, _findLayerInfoByIdAndReturnTopLayer: function (b, e) {
                                                        var a, f = null; e || (e = this._finalLayerInfos); for (a = 0; a < e.length; a++)if (f =
                                                                e[a].findLayerInfoById(b)) { f = e[a]; break } return f
                                                }, _findLayerInfoById: function (b, e) { var a, f = null; e || (e = this._finalLayerInfos); for (a = 0; a < e.length && !(f = e[a].findLayerInfoById(b)); a++); return f }, _findTopLayerInfoById: function (b) { var e, a = null, f = [].concat(this._finalLayerInfos || [], this._tableInfos || []); for (e = 0; e < f.length; e++)if (f[e].id === b) { a = f[e]; break } return a }, _getTopLayerInfoIndexById: function (b) { var e, a = -1; for (e = 0; e < this._finalLayerInfos.length; e++)if (this._finalLayerInfos[e].id === b) { a = e; break } return a },
                                        _clearAddedFlag: function (b) { q.forEach(b, function (e) { e._addedFlag = !1 }) }, _markFirstOrLastNode: function () {
                                                var b; if (this._finalLayerInfos.length) {
                                                        for (b = 0; b < this._finalLayerInfos.length; b++)this._finalLayerInfos[b].isFirst = !1, this._finalLayerInfos[b].isLast = !1; this._finalLayerInfos[0].isFirst = !0; this._finalLayerInfos[this._finalLayerInfos.length - 1].isLast = !0; for (b = 0; b < this._finalLayerInfos.length; b++)if (!this._finalLayerInfos[b].isGraphicLayer()) {
                                                                b && (this._finalLayerInfos[b - 1].isLast = !0); this._finalLayerInfos[b].isFirst =
                                                                        !0; break
                                                        }
                                                }
                                        }, _onReceiveBasemapGalleryeData: function (b, e, a) { "BasemapGallery" === b && (this._basemapLayers.length = 0, q.forEach(a, A.hitch(this, function (f) { this._basemapLayers.push({ layerObject: f, id: f.id }) }), this), this.update(), this.emit("layerInfosChanged")) }, _onBasemapChange: function (b) { var e; for (e = this._basemapLayers.length = 0; e < b.layers.length; e++)this._basemapLayers.push({ layerObject: b.layer[e], id: b.layers[e].id }) }, _destroyLayerInfos: function () { q.forEach(this._finalLayerInfos, A.hitch(this, function (b) { b.destroy() })) },
                                        _bindEvents: function () {
                                                var b = m(this.map, "layer-add-result", A.hitch(this, this._onLayersChange, d.ADDED)); var e = m(this.map, "layer-remove", A.hitch(this, this._onLayersChange, d.REMOVED)); var a = m(this.map, "layer-reorder", A.hitch(this, this._onLayerReorder)); var f = v.subscribe("layerInfos/layerInfo/isShowInMapChanged", A.hitch(this, this._onShowInMapChanged)); var h = v.subscribe("layerInfos/layerInfo/visibleChanged", A.hitch(this, this._onVisibleChanged)); var p = v.subscribe("layerInfos/layerInfo/filterChanged", A.hitch(this,
                                                        this._onFilterChanged)); var B = v.subscribe("layerInfos/layerInfo/rendererChanged", A.hitch(this, this._onRendererChanged)); var t = v.subscribe("layerInfos/layerInfo/opacityChanged", A.hitch(this, this._onOpacityChanged)); var u = v.subscribe("layerInfos/layerInfo/scaleRangeChanged", A.hitch(this, this._onScaleRangeChanged)); var z = v.subscribe("layerInfos/layerInfo/timeExtentChanged", A.hitch(this, this._onTimeExtentChanged)); var x = m(this.map, "before-unload", A.hitch(this, function () {
                                                                b.remove(); e.remove(); a.remove();
                                                                f.remove(); h.remove(); p.remove(); B.remove(); x.remove(); t.remove(); u.remove(); z.remove(); this._destroyLayerInfos()
                                                        }))
                                        }, _emitEvent: function () { try { this.emit.apply(this, arguments) } catch (b) { console.warn(b) } }, _emitEventForEveryLayerInfo: function (b, e, a) { try { q.forEach(e, function (f) { f.emitEvent(b, a) }, this) } catch (f) { console.warn(f) } }, _onLayersChange: function (b, e) {
                                                var a = null; if (!e.error && "esri.layers.GraphicsLayer" !== e.layer.declaredClass && "esri.layers.LabelLayer" !== e.layer.declaredClass) {
                                                        if (b === d.ADDED) {
                                                                this.update();
                                                                a = b = this._findLayerInfoById(e.layer.id, e.layer._basemapGalleryLayerType ? this._finalBasemapLayerInfos : this._finalLayerInfos); var f = d.ADDED; b && !b.isRootLayer() && (a = b.getRootLayerInfo(), f = d.SUBLAYER_ADDED)
                                                        } else a = b = this._findLayerInfoById(e.layer.id, e.layer._basemapGalleryLayerType ? this._finalBasemapLayerInfos : this._finalLayerInfos), f = d.REMOVED, b && !b.isRootLayer() && (a = b.getRootLayerInfo(), f = d.SUBLAYER_REMOVED), b && b.destroy(), this.update(); a && (e.layer._basemapGalleryLayerType ? (this._emitEvent("basemapLayersChanged"),
                                                                this._emitEvent("basemapLayerInfosChanged", a, f, b)) : this._emitEvent("layerInfosChanged", a, f, b))
                                                }
                                        }, _onTableChange: function (b, e) { this._emitEvent("tableInfosChanged", b, e, b) }, _onLayersUpdated: function (b, e) { b.isTable ? this._emitEvent("tableInfosChanged", [b], d.UPDATED, [e]) : this._emitEvent("layerInfosChanged", b, d.UPDATED, e) }, _onShowInMapChanged: function (b) { this._emitEvent("layerInfosIsShowInMapChanged", b); this._emitEventForEveryLayerInfo("isShowInMapChanged", b) }, _onVisibleChanged: function (b) {
                                                this._emitEvent("layerInfosIsVisibleChanged",
                                                        b); this._emitEventForEveryLayerInfo("isVisibleChanged", b)
                                        }, _onFilterChanged: function (b, e) { this._emitEvent("layerInfosFilterChanged", b, e); this._emitEventForEveryLayerInfo("filterChanged", b, e) }, _onLayerReorder: function () {
                                                var b = [].concat(this.map.layerIds, this.map.graphicsLayerIds), e = q.some(b, A.hitch(this, function (a, f) { return a === this._previousLayerOrder[f] ? !1 : !0 })); b.length === this._previousLayerOrder.length && e && (this.update(), this._emitEvent("layerInfosReorder", null, d.REORDERED)); this._previousLayerOrder =
                                                        b
                                        }, _onRendererChanged: function (b) { this._emitEvent("layerInfosRendererChanged", b); this._emitEventForEveryLayerInfo("rendererChanged", b) }, _onOpacityChanged: function (b) { this._emitEvent("layerInfosOpacityChanged", b); this._emitEventForEveryLayerInfo("opacityChanged", b) }, _onScaleRangeChanged: function (b) { this._emitEvent("layerInfosScaleRangeChanged", b); this._emitEventForEveryLayerInfo("scaleRangeChanged", b) }, _onTimeExtentChanged: function (b) {
                                                this._emitEvent("layerInfosTimeExtentChanged", b); this._emitEventForEveryLayerInfo("timeExtentChanged",
                                                        b)
                                        }
                                }); d.getLayerInfoArrayByType = function (b, e) { var a = new w, f = [], h = []; d.getInstance(b, b.iteminfo).then(function (p) { p.traversal(function (B) { var t = B.getLayerType(); t.layerInfo = B; f.push(t) }); l(f).then(function (B) { q.forEach(B, function (t, u) { e === t && h.push(f[u].layerInfo) }); a.resolve(h) }) }); return a }; var c = null, g = null; d.getInstance = function (b, e) { var a = new w; a.resolve(d.getInstanceSyncForInit(b, e)); return a }; d.getInstanceSyncForInit = function (b, e) { c && c !== b && (c = null, g = null); g || (g = new d(b, e.itemData), c = b); return g };
                                d.getInstanceSync = function () { return g }; d.setInstance = function (b, e) { c = b; g = e }; d.createInstance = function (b) { var e = null; return e = new d(b, b.itemInfo.itemData) }; A.mixin(d, { ADDED: "added", REMOVED: "removed", SUBLAYER_ADDED: "subLayerAdded", SUBLAYER_REMOVED: "subLayerRemoved", UPDATED: "updated", REORDERED: "reordered" }); return d
                        })
                }, "jimu/LayerInfos/LayerInfoFactory": function () {
                        define("dojo/_base/declare jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultDynamicShipFeatureLayer jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS jimu/LayerInfos/LayerInfoForDefaultTable jimu/LayerInfos/LayerInfoForDefaultImage jimu/LayerInfos/LayerInfoForDefaultStream jimu/LayerInfos/LayerInfoForDefaultKML".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                        return E(null, {
                                                constructor: function (a, f) { this.map = a; this.layerInfos = f }, create: function (a) {
                                                        var f = null; if (a.featureCollection) f = new q(a, this.map, this, this.layerInfos); else if ("esri.layers.KMLLayer" === a.layerObject.declaredClass) f = new w(a, this.map, this, this.layerInfos); else if ("esri.layers.GeoRSSLayer" === a.layerObject.declaredClass) f = new m(a, this.map, this, this.layerInfos); else if ("esri.layers.WMSLayer" !== a.layerObject.declaredClass || a.selfType) if ("esri.layers.ArcGISDynamicMapServiceLayer" ===
                                                                a.layerObject.declaredClass || "esri.layers.ArcGISTiledMapServiceLayer" === a.layerObject.declaredClass) f = new A(a, this.map, this, this.layerInfos); else if ("esri.layers.ArcGISImageServiceLayer" === a.layerObject.declaredClass || "esri.layers.ArcGISImageServiceVectorLayer" === a.layerObject.declaredClass) f = new g(a, this.map, this, this.layerInfos); else if ("esri.layers.StreamLayer" === a.layerObject.declaredClass) f = new b(a, this.map, this, this.layerInfos); else switch ("Table" === a.layerObject.type && (a.selfType = "table"),
                                                                        a.selfType) {
                                                                                case "mapservice_dynamic_ship_featurelayer": f = new k(a, this.map, this, this.layerInfos); break; case "mapservice_dynamic_group": case "mapservice_dynamic": f = new l(a, this.map, this, this.layerInfos); break; case "mapservice_tiled_group": case "mapservice_tiled": f = new n(a, this.map, this, this.layerInfos); break; case "wms": f = new d(a, this.map, this, this.layerInfos); break; case "kml": f = new e(a, this.map, this, this.layerInfos); break; case "table": f = new c(a, this.map, this, this.layerInfos); break; default: f = new v(a,
                                                                                        this.map, this, this.layerInfos)
                                                                        } else f = new r(a, this.map, this, this.layerInfos); return f
                                                }
                                        })
                                })
                }, "jimu/LayerInfos/LayerInfoForCollection": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/promise/all esri/lang jimu/utils ./LayerInfo".split(" "), function (E, q, A, w, m, v, r) {
                                return E(r, {
                                        constructor: function () { this.layerObject = { declaredClass: "esri.layers.FeatureCollection", type: "FeatureCollection", empty: !0 } }, _getExtent: function () {
                                                var l = null, k = []; q.forEach(this.getSubLayers(), function (n) { k.push(n._getExtent()) },
                                                        this); return w(k).then(A.hitch(this, function (n) { q.forEach(n, function (d) { v.isValidExtent(d) && (l = l ? l.union(d) : d) }, this); return l }))
                                        }, _resetLayerObjectVisiblity: function (l) { var k = l ? l[this.id] : null; if (k) { var n = {}, d; for (d in l) l.hasOwnProperty(d) && "function" !== typeof l[d] && (n[d] = l[d].visible); this._setSubLayerVisibleByCheckedInfo(n); this._setTopLayerVisible(k.visible) } }, _setSubLayerVisibleByCheckedInfo: function (l) {
                                                q.forEach(this.newSubLayers, function (k) { m.isDefined(l[k.id]) && k.layerObject.setVisibility(l[k.id]) },
                                                        this)
                                        }, _initVisible: function () { var l = !1, k; for (k = 0; k < this.newSubLayers.length; k++)l = l || this.newSubLayers[k].layerObject.visible; l && (this._visible = !0) }, _setTopLayerVisible: function (l) { this._visible = l ? !0 : !1; q.forEach(this.newSubLayers, function (k) { k.setLayerVisiblefromTopLayer() }, this); this._onVisibilityChanged() }, obtainNewSubLayers: function () {
                                                var l = []; q.forEach(this.originOperLayer.featureCollection.layers, function (k) {
                                                        this._getLayerIndexesInMapByLayerId(k.layerObject.id) && (A.setObject("_wabProperties.originOperLayer.showLegend",
                                                                this.originOperLayer.featureCollection.showLegend, k.layerObject), k = this._layerInfoFactory.create({ layerObject: k.layerObject, title: k.layerObject.label || k.layerObject.title || k.layerObject.name || k.layerObject.id || " ", id: k.id || "-", subId: k.id || "-", collection: { layerInfo: this }, selfType: "collection", showLegend: !0, parentLayerInfo: this }), l.push(k), k.init())
                                                }, this); l.reverse(); return l
                                        }, _obtainLayerIndexesInMap: function () {
                                                var l = [], k, n; for (n = this.newSubLayers.length - 1; 0 <= n; n--)(k = this._getLayerIndexesInMapByLayerId(this.newSubLayers[n].layerObject.id)) &&
                                                        l.push(k); return l
                                        }, moveLeftOfIndex: function (l) { var k; for (k = 0; k < this.newSubLayers.length; k++)this.map.reorderLayer(this.newSubLayers[k].layerObject, l) }, moveRightOfIndex: function (l) { var k; for (k = this.newSubLayers.length - 1; 0 <= k; k--)this.map.reorderLayer(this.newSubLayers[k].layerObject, l) }, _getShowLegendOfWebmap: function () { return void 0 !== this.originOperLayer.featureCollection.showLegend ? this.originOperLayer.featureCollection.showLegend : !0 }, getOpacity: function () {
                                                var l, k = 0; for (l = 0; l < this.newSubLayers.length; l++)if (this.newSubLayers[l].layerObject.opacity) k =
                                                        this.newSubLayers[l].layerObject.opacity > k ? this.newSubLayers[l].layerObject.opacity : k; else return 1; return k
                                        }, setOpacity: function (l) { q.forEach(this.newSubLayers, function (k) { k.layerObject.setOpacity && k.layerObject.setOpacity(l) }) }, getScaleRange: function () { var l = this.getSubLayers(); return l[0] ? l[0].getScaleRange() : { minScale: 0, maxScale: 0 } }
                                })
                        })
                }, "jimu/LayerInfos/LayerInfo": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/dom-construct dojo/topic dojo/aspect dojo/Evented dojo/request/script jimu/portalUrlUtils jimu/portalUtils jimu/LayerNode jimu/utils jimu/privilegeUtils ./RequestBuffer esri/kernel esri/tasks/query esri/request".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p) {
                                        var B = E([k], {
                                                declaredClass: "jimu.LayerInfo", originOperLayer: null, layerObject: null, map: null, title: null, id: null, subId: null, newSubLayers: null, parentLayerInfo: null, isTable: null, isTiled: null, _oldIsShowInMap: null, _oldFilter: null, _eventHandles: null, _subLayerInfoIndex: null, _serviceDefinitionBuffer: null, _flag: null, _objectId: null, _itemInfo: null, _adaptor: null, constructor: function (t, u, z, x) {
                                                        this.originOperLayer = t; this.layerObject = t.layerObject; this.map = u; this.title =
                                                                this.originOperLayer.title || this.originOperLayer.id || ""; this.id = this.originOperLayer.id; this.subId = void 0 !== this.originOperLayer.subId ? this.originOperLayer.subId : this.id; this.parentLayerInfo = t.parentLayerInfo ? t.parentLayerInfo : null; this.isTiled = this.isTable = !1; this._eventHandles = []; this._layerInfoFactory = z; this._layerInfos = x; this._flag = {}; this._objectId = Math.random(); this._adaptor = new g(this)
                                                }, init: function () {
                                                        this.newSubLayers = this.obtainNewSubLayers(); this._initSubLayerInfoIndex(); this._initVisible();
                                                        this.originOperLayer.popupInfo && (this.popupVisible = !0); this._oldIsShowInMap = this.isShowInMap(); this._initOldFilter(); this._initServiceDefinitionBuffer(); this._bindEvent()
                                                }, _initOldFilter: function () { this._oldFilter = null }, _initServiceDefinitionBuffer: function () { this._serviceDefinitionBuffer = new a(A.hitch(this, this._serviceDefinitionRequest)) }, isGraphicLayer: function () { var t = this._obtainLayerIndexesInMap(); return t.length ? t[0].isGraphicLayer : !1 }, obtainLayerIndexesInMap: function () { return this._obtainLayerIndexesInMap() },
                                                getObjectId: function () { return this._objectId }, getOpacity: function () { return this.layerObject.opacity ? this.layerObject.opacity : 1 }, setOpacity: function (t) { this.layerObject.setOpacity && this.layerObject.setOpacity(t) }, moveLeftOfIndex: function (t) { this.map.reorderLayer(this.layerObject, t) }, moveRightOfIndex: function (t) { this.map.reorderLayer(this.layerObject, t) }, traversal: function (t) { if (t(this)) return !0; for (var u = this.getSubLayers(), z = 0; z < u.length; z++)if (u[z].traversal(t)) return !0 }, findLayerInfoById: function (t) {
                                                        var u =
                                                                null, z = 0; if (this.id && this.id === t) return this; for (z = 0; z < this.newSubLayers.length && !(u = this.newSubLayers[z].findLayerInfoById(t)); z++); return u
                                                }, setTopLayerVisible: function (t) { this._setTopLayerVisible(t) }, _setTopLayerVisible: function (t) { }, _setSubLayerVisible: function (t, u) { }, setLayerVisiblefromTopLayer: function () { }, _resetLayerObjectVisiblity: function () { }, resetLayerObjectVisibility: function (t) { this.isRootLayer() && this._resetLayerObjectVisiblity(t) }, _initVisible: function () { }, isVisible: function () {
                                                        return this._visible ?
                                                                !0 : !1
                                                }, show: function () { this._setTopLayerVisible(!0) }, hide: function () { this._setTopLayerVisible(!1) }, _obtainLayerIndexesInMap: function () { var t = [], u; (u = this._getLayerIndexesInMapByLayerId(this.id)) && t.push(u); return t }, _getLayerIndexesInMapByLayerId: function (t) { var u; for (u = 0; u < this.map.graphicsLayerIds.length; u++)if (this.map.graphicsLayerIds[u] === t) return { isGraphicLayer: !0, index: u }; for (u = 0; u < this.map.layerIds.length; u++)if (this.map.layerIds[u] === t) return { isGraphicLayer: !1, index: u }; return null }, _isShowInMapChanged: function () {
                                                        var t =
                                                                !1, u = this.isShowInMap(); !1 === u && this.map.infoWindow.hide(); this._oldIsShowInMap !== u && (this._oldIsShowInMap = u, t = !0); return t
                                                }, _isShowInMapChanged2: function () { var t = []; this.traversal(function (u) { u._isShowInMapChanged() && t.push(u) }); r.publish("layerInfos/layerInfo/isShowInMapChanged", t) }, _visibleChanged: function () { r.publish("layerInfos/layerInfo/visibleChanged", [this]) }, _initSubLayerInfoIndex: function () {
                                                        var t = {}; this.isRootLayer() && this.traversal(function (u) { u.isRootLayer() || (t[u.subId] = u) }); this._subLayerInfoIndex =
                                                                t
                                                }, _getLayerInfosObj: function () { return this._layerInfos }, obtainNewSubLayers: function () { return [] }, createLegendsNode: function () { return v.create("div", { "class": "legends-div" }) }, drawLegends: function (t, u) { }, _getLayerTypesOfSupportTable: function () { return "FeatureLayer,CSVLayer,Table,ArcGISImageServiceLayer,StreamLayer,ArcGISImageServiceVectorLayer" }, _getShowLegendOfWebmap: function () { return void 0 !== this.originOperLayer.showLegend ? this.originOperLayer.showLegend : !0 }, _needToRenew: function () { return !1 }, _getServiceDefinition: function () {
                                                        var t =
                                                                new w; t.resolve(null); return t
                                                }, _serviceDefinitionRequest: function (t) { return this._normalRequest(t, { f: "json" }, "json") }, getServiceDefinition: function () { return this._getServiceDefinition() }, _normalRequest: function (t, u, z) { return p({ url: t, content: u, handleAs: z, callbackParamName: "callback" }) }, getLayerObject: function () { var t = new w; this.layerObject ? t.resolve(this.layerObject) : t.resolve(null); return t }, getLayerObjectTryUsingFeatureService: function () { return this.getLayerObject() }, getSubLayers: function () { return this.newSubLayers },
                                                isLeaf: function () { return 0 === this.getSubLayers().length ? !0 : !1 }, isRootLayer: function () { return this.parentLayerInfo ? !1 : !0 }, getLayerLevel: function () { for (var t = 0, u = this; u.parentLayerInfo;)t++, u = u.parentLayerInfo; return t }, getRootLayerInfo: function () { for (var t = this; t.parentLayerInfo;)t = t.parentLayerInfo; return t }, isShowInMap: function () { for (var t = !0, u = this; u;)t = t && u.isVisible(), u = u.parentLayerInfo; return t }, getLayerType: function () {
                                                        var t = [null], u = new w; this.layerObject.declaredClass && (t = this.layerObject.declaredClass.split("."));
                                                        u.resolve(t[t.length - 1]); return u
                                                }, getPopupInfo: function () { return this.originOperLayer.popupInfo }, getPopupInfoFromLayerObject: function () { var t = this.getInfoTemplate(), u = null; t && (u = t.info); return u }, loadPopupInfo: function () { var t = new w; this.loadInfoTemplate().then(A.hitch(this, function (u) { var z = null; u && (z = u.info); t.resolve(z) })); return t }, loadInfoTemplate: function () { var t = new w; t.resolve(null); return t }, getInfoTemplate: function () { return null }, getFilterOfWebmap: function () {
                                                        return this.originOperLayer.layerDefinition ?
                                                                this.originOperLayer.layerDefinition.definitionExpression : null
                                                }, getFilter: function () { return null }, setFilter: function () { }, getShowLegendOfWebmap: function () { for (var t = this, u = !0; t;)u = u && t._getShowLegendOfWebmap(), t = t.parentLayerInfo; return u }, getUrl: function () { return this.layerObject.url || this.layerObject._url }, hasLayerTypes: function (t) { }, getSupportTableInfo: function () {
                                                        var t = new w, u = { isSupportedLayer: !1, isSupportQuery: !1, layerType: null }, z = this.getLayerType(), x = this.getLayerObject(); m({ type: z, layerObject: x }).then(A.hitch(this,
                                                                function (y) { var D = y.type; y = y.layerObject; u.layerType = D; 0 <= this._getLayerTypesOfSupportTable().indexOf(D) && (u.isSupportedLayer = !0); if (!y) u.isSupportQuery = !1; else if (this.parentLayerInfo && this.parentLayerInfo.isMapNotesLayerInfo()) u.isSupportQuery = !1; else if (!y.url || y.capabilities && y.capabilities.indexOf && 0 <= y.capabilities.indexOf("Query")) u.isSupportQuery = !0; t.resolve(u) }), function () { t.resolve(u) }); return t
                                                }, getRelatedTableInfoArray: function (t) { t = new w; t.resolve([]); return t }, getRelatedRecords: function (t,
                                                        u) { t = new w; t.resolve([]); return t }, removeSubLayerById: function (t) { var u = []; q.forEach(this.newSubLayers, function (z) { z.id !== t ? u.push(z) : z.destroy() }); this.newSubLayers = u }, releaseResource: function () { q.forEach(this._eventHandles, function (t) { t.remove() }); this.destroyLabelLayer(); this._adaptor && this._adaptor.destroy() }, destroy: function () { q.forEach(this.newSubLayers, function (t) { t.destroy() }); this.releaseResource(); this.inherited(arguments) }, update: function () {
                                                                q.forEach(this.newSubLayers, function (t) { t.destroy() });
                                                                this.releaseResource(); this.init()
                                                        }, isMapNotesLayerInfo: function () { return this.originOperLayer.featureCollection && 0 === this.id.indexOf("mapNotes_") && "ArcGISFeatureLayer" === this.originOperLayer.layerType && !this.map.getLayer(this.id) ? !0 : !1 }, getMSShipFeatures: function () { var t = new w; t.resolve(null); return t }, _getExtent: function () { var t = new w; t.resolve(this.layerObject.fullExtent || this.layerObject.initialExtent); return t }, getExtent: function () {
                                                                var t = new w; this._getExtent().then(A.hitch(this, function (u) {
                                                                        b.projectToMapSpatialReference(this.map,
                                                                                u).then(A.hitch(this, function (z) { t.resolve(z) }), A.hitch(this, function () { t.resolve(null) }))
                                                                }), A.hitch(this, function () { t.resolve(null) })); return t
                                                        }, _requerySelectdFeatures: function () {
                                                                var t = new w; this.getLayerObject().then(A.hitch(this, function (u) {
                                                                        var z = []; if (u && u.isEditable && !u.isEditable()) {
                                                                                var x = u.objectIdField; z = u.getSelectedFeatures(); var y = u.on("update-end", A.hitch(this, function () {
                                                                                        var D = new h, H = []; q.forEach(z, function (I) { H.push(I.attributes[x]) }, this); D.objectIds = H; D.maxAllowableOffset = 0; u.queryFeatures(D,
                                                                                                A.hitch(this, function (I) { q.forEach(I.features, function (N) { q.some(z, function (T) { return T.attributes[x] === N.attributes[x] ? (T.setGeometry(N.geometry), !0) : !1 }) }, this); t.resolve() }), A.hitch(this, function () { t.resolve() })); y && y.remove && y.remove()
                                                                                }))
                                                                        }
                                                                })); return t
                                                        }, zoomTo: function (t) { this._requerySelectdFeatures(); return t ? b.projectToMapSpatialReference(this.map, t).then(A.hitch(this, function (u) { return this._zoomTo(u) })) : this.getExtent().then(A.hitch(this, function (u) { return this._zoomTo(u) })) }, _zoomTo: function (t) {
                                                                if (b.isValidExtent(t)) {
                                                                        t =
                                                                        A.clone(t); var u = this.getLayerScaleRange(), z = u.minScale; u = u.maxScale; if (t.isSinglePoint) { if (z = b.getTargetScale(this.map, 3, z, u)) t = b.adjustHeightToAspectRatio(this.map, t), t = b.getExtentForScale(t, this.map.width, z), this.map.setExtent(t) } else {
                                                                                t = b.adjustExtentToAspectRatio(this.map, t); var x = b.getScaleForExtent(t, this.map.width); 0 < z && x > z ? (z = b.getScaleForNextTileLevel(this.map, z, !0), t = b.adjustHeightToAspectRatio(this.map, t), t = b.getExtentForScale(t, this.map.width, z), this.map.setExtent(t)) : x < u ? (u = b.getScaleForNextTileLevel(this.map,
                                                                                        u, !1), t = b.adjustHeightToAspectRatio(this.map, t), t = b.getExtentForScale(t, this.map.width, u), this.map.setExtent(t)) : this.map.setExtent(t, !0)
                                                                        }
                                                                }
                                                        }, mergeScale: function (t, u, z, x) { var y = 0, D = 0; 0 === t && 0 < z ? y = z : 0 < t && 0 === z ? y = t : 0 < t && 0 < z && (y = Math.min(t, z)); D = Math.max(u, x); return { minScale: y, maxScale: D } }, unionScale: function (t, u, z, x) { var y = 0, D = 0; y = 0 === t || 0 === z ? 0 : Math.max(t, z); D = Math.min(u, x); return { minScale: y, maxScale: D } }, getScaleRange: function () {
                                                                return this.layerObject && 0 <= this.layerObject.minScale && 0 <= this.layerObject.maxScale ?
                                                                        { minScale: this.layerObject.minScale, maxScale: this.layerObject.maxScale } : { minScale: 0, maxScale: 0 }
                                                        }, setScaleRange: function (t, u) { this.layerObject && this.layerObject.setScaleRange && this.layerObject.setScaleRange(t, u) }, getLayerScaleRange: function () { var t, u = this.getScaleRange(); this.traversal(A.hitch(this, function (z) { z.id !== this.id && (z = z.getScaleRange(), t = t ? this.unionScale(t.minScale, t.maxScale, z.minScale, z.maxScale) : z) })); return t ? this.mergeScale(u.minScale, u.maxScale, t.minScale, t.maxScale) : u }, isCurrentScaleInTheScaleRange: function () {
                                                                var t =
                                                                        this.getScaleRange(), u = this.map.getScale(); return 0 === t.minScale && 0 === t.maxScale ? !0 : (0 === t.minScale || t.minScale >= u) && (0 === t.maxScale || u >= t.maxScale) ? !0 : !1
                                                        }, isInScale: function () { for (var t = !0, u = this; u && (t = u.isCurrentScaleInTheScaleRange(), u = u.parentLayerInfo, t);); return t }, enablePopup: function () { }, disablePopup: function () { }, isPopupEnabled: function () { return !1 }, enablePopupNested: function () { this.isLeaf() ? this.enablePopup() : this.traversal(A.hitch(this, function (t) { t.isLeaf() && t.enablePopup() })) }, isSupportPopup: function () {
                                                                var t =
                                                                        new w; t.resolve(!1); return t
                                                        }, disablePopupNested: function () { this.isLeaf() ? this.disablePopup() : this.traversal(A.hitch(this, function (t) { t.isLeaf() && t.disablePopup() })) }, isPopupNestedEnabled: function () { var t = !1; this.isLeaf() ? t = this.isPopupEnabled() : this.traversal(A.hitch(this, function (u) { return u.isLeaf() && u.isPopupEnabled() ? t = !0 : !1 })); return t }, isSupportPopupNested: function () {
                                                                var t = new w, u = []; this.traversal(function (z) { z.isLeaf() && u.push(z.isSupportPopup()) }); m(u).then(function (z) {
                                                                        q.some(z, function (x) {
                                                                                if (x) return t.resolve(!0),
                                                                                        !0; t.resolve(!1); return !1
                                                                        })
                                                                }); return t
                                                        }, getCapabilitiesOfWebMap: function () { return this.originOperLayer.capabilities }, isItemLayer: function () { return this._getBasicItemInfo() }, isPublicService: function () { var t = new w, u = this.getUrl(); (u = u && u + "?f\x3djson") ? ("https" === d.getProtocol(window.location.href) && (u = d.setHttpsProtocol(u)), n.get(u, { jsonp: "callback" }).then(A.hitch(this, function (z) { z && z.error ? t.resolve(!1) : t.resolve(!0) }), A.hitch(this, function () { t.resolve(!1) }))) : t.resolve(!0); return t }, _checkUserLicense: function (t) {
                                                                var u =
                                                                        ""; !window.isXT && window.queryObject && (window.queryObject.id && !/^(stemapp|stemapp3d)$/gi.test(window.queryObject.id) ? u = window.queryObject.id : window.queryObject.appid && (u = window.queryObject.appid)); return window.isXT || !u ? (t = new w, t.resolve(!0), t) : e.checkEssentialAppsLicense(u, t, !1).then(A.hitch(this, function (z) { return !(z && z.viewOnly) }), A.hitch(this, function () { return !1 }))
                                                        }, isEditable: function () {
                                                                var t = !1, u = !0, z = !0, x = getAppConfig().portalUrl, y = c.getPortal(x); x = this.isPublicService(); var D = new w, H = new w;
                                                                y.getUser().then(A.hitch(this, function (I) { H.resolve(I) }), A.hitch(this, function () { H.resolve(null) })); y = this._checkUserLicense(y); m({ user: H, isPublicService: x, license: y }).then(A.hitch(this, function (I) { var N = I.user && I.user.privileges, T = I.isPublicService; I = I.license; N && -1 === q.indexOf(N, "features:user:edit") && f.id && !T && (u = !1); T || I || (z = !1); t = this.layerObject && this.layerObject.isEditable ? this.layerObject.isEditable() && u && z ? !0 : !1 : !1; D.resolve(t) }), A.hitch(this, function () { D.resolve(!1) })); return D
                                                        }, _getBasicItemInfo: function () {
                                                                var t =
                                                                        null, u = this.getRootLayerInfo(), z = window.appConfig || window.getAppConfig(), x = A.getObject("_wabProperties.itemLayerInfo", !1, u.layerObject); u.originOperLayer.itemId ? (t = {}, t.itemId = u.originOperLayer.itemId, t.portalUrl = d.getStandardPortalUrl(z.map.portalUrl || z.portalUrl)) : x && x.portalUrl && x.itemId && (t = {}, t.itemId = x.itemId, t.portalUrl = d.getStandardPortalUrl(x.portalUrl)); return t
                                                        }, getItemInfo: function () {
                                                                var t = new w, u = this.getRootLayerInfo(); u.isItemLayer() ? (u._itemInfo || (u._itemInfo = new B.ItemInfo(this, u)),
                                                                        u._itemInfo.onLoad().then(A.hitch(this, function () { t.resolve(u._itemInfo) }), A.hitch(this, function () { t.resolve(null) }))) : t.resolve(null); return t
                                                        }, isHostedService: function () { var t = new w; this._getServiceDefinition().then(A.hitch(this, function (u) { t.resolve(u && u.serviceItemId ? !0 : !1) })); return t }, isHostedLayer: function () { if (this.isItemLayer()) var t = this.isHostedService(); else t = new w, t.resolve(!1); return t }, obtainLabelControl: function () { }, restoreLabelControl: function () { }, destroyRealtedLabelLayer: function () { },
                                                destroyLabelLayer: function () { }, canShowLabel: function () { }, isShowLabels: function () { }, showLabels: function () { }, hideLabels: function () { }, isBasemap: function () { return this.getRootLayerInfo().layerObject._basemapGalleryLayerType ? !0 : !1 }, emitEvent: function () { try { this.emit.apply(this, arguments), this._adaptor && this._adaptor.emitEvent.apply(this._adaptor, arguments) } catch (t) { console.error(t) } }, _bindEvent: function () {
                                                        if (this.layerObject && !this.layerObject.empty) {
                                                                var t = this.layerObject.on("visibility-change", A.hitch(this,
                                                                        this._onVisibilityChanged)); this._eventHandles.push(t); t = l.after(this.layerObject, "setDefinitionExpression", A.hitch(this, this._onFilterChanged)); this._eventHandles.push(t); t = l.after(this.layerObject, "setRenderer", A.hitch(this, this._onRendererChanged)); this._eventHandles.push(t); this.isRootLayer() && (t = this.layerObject.on("opacity-change", A.hitch(this, this._onOpacityChanged)), this._eventHandles.push(t)); t = this.layerObject.on("scale-range-change", A.hitch(this, this._onScaleRangeChanged)); this._eventHandles.push(t);
                                                                this.isRootLayer() && (t = this.map.on("time-extent-change", A.hitch(this, function () { this.layerObject && this.layerObject.useMapTime && this._onTimeExtentChanged() })), this._eventHandles.push(t)); this.isRootLayer() && (t = l.after(this.layerObject, "setTimeDefinition", A.hitch(this, function () { this.layerObject && this.layerObject.timeInfo && this.layerObject.mode === esri.layers.FeatureLayer.MODE_SNAPSHOT && this._onTimeExtentChanged() })), this._eventHandles.push(t))
                                                        }
                                                }, _onVisibilityChanged: function () {
                                                        this._initVisible(); this._visibleChanged();
                                                        this._isShowInMapChanged2()
                                                }, _onFilterChanged: function () { var t = this._oldFilter ? this._oldFilter : null, u = this.layerObject.getDefinitionExpression(); u = u ? u : null; t !== u && (r.publish("layerInfos/layerInfo/filterChanged", [this], A.getObject("_wabProperties.objectPassWithFilterChangeEvent", !0, this.layerObject)), this._oldFilter = u, A.setObject("_wabProperties.objectPassWithFilterChangeEvent", {}, this.layerObject)) }, _onRendererChanged: function () { r.publish("layerInfos/layerInfo/rendererChanged", [this]) }, _onOpacityChanged: function () {
                                                        r.publish("layerInfos/layerInfo/opacityChanged",
                                                                [this])
                                                }, _onScaleRangeChanged: function () { r.publish("layerInfos/layerInfo/scaleRangeChanged", [this]) }, _onTimeExtentChanged: function () { var t = [], u = []; this.traversal(function (z) { var x = z.getServiceDefinition().then(function (y) { y && y.timeInfo && t.push(z) }); u.push(x) }); m(u).then(A.hitch(this, function () { r.publish("layerInfos/layerInfo/timeExtentChanged", t) })) }
                                        }); B.ItemInfo = E(null, {
                                                _currentLayerInfo: null, _rootLayerInfo: null, _portalUrl: null, _itemId: null, _item: null, _itemData: null, _serviceDefinition: null, _itemInfoLoadedDef: null,
                                                constructor: function (t, u) { this._currentLayerInfo = t; this._rootLayerInfo = u; this._loadResource() }, _loadResource: function () {
                                                        this._itemInfoLoadedDef = new w; var t = this._rootLayerInfo.isItemLayer(); if (t) {
                                                                this._portalUrl = t.portalUrl; this._itemId = t.itemId; var u = c.getPortal(this._portalUrl); t = u.getItemById(this._itemId); u = u.getItemData(this._itemId); var z = this._currentLayerInfo._getServiceDefinition(); m({ item: t, itemData: u, serviceDefinition: z }).then(A.hitch(this, function (x) {
                                                                        this._item = x.item; this._itemData = x.itemData;
                                                                        this._serviceDefinition = x.serviceDefinition; this._itemInfoLoadedDef.resolve(this)
                                                                }), A.hitch(this, function (x) { x && x.message && console.log(x.message); this._itemInfoLoadedDef.reject() }))
                                                        } else this._itemInfoLoadedDef.reject()
                                                }, onLoad: function () { return this._itemInfoLoadedDef }, getPortalUrl: function () { return this._portalUrl }, getItemId: function () { return this._itemId }, getItem: function () { return this._item }, getItemData: function () { return this._itemData }, isHostedLayer: function () {
                                                        return this._serviceDefinition &&
                                                                this._serviceDefinition.serviceItemId ? !0 : !1
                                                }
                                        }); return B
                                })
                }, "jimu/portalUtils": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic dojo/json dojo/request/xhr esri/request ./Role ./utils ./portalUrlUtils ./tokenUtils ./ServiceDefinitionManager".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                var e = E([], {
                                        declaredClass: "jimu.Portal", selfUrl: null, user: null, selfInfo: null, portalUrl: null, credential: null, constructor: function (B) {
                                                this.portalUrl =
                                                c.getStandardPortalUrl(B); this.selfUrl = c.getPortalSelfInfoUrl(B)
                                        }, loadSelfInfo: function () { var B = this.selfUrl; this.isValidCredential() && (B = -1 < B.indexOf("?") ? B + ("\x26token\x3d" + this.credential.token) : B + ("?token\x3d" + this.credential.token)); return b.getInstance().getServiceDefinition(B).then(q.hitch(this, function (t) { var u = t.user; delete t.user; q.mixin(this, t); t.user = u; return t })) }, _checkCredential: function () { var B = g.isValidCredential(this.credential); B || this.clearCredentialAndUser(); return B }, isValidCredential: function () {
                                                this.updateCredential();
                                                return this._checkCredential()
                                        }, updateCredential: function () { this._checkCredential() || (this.credential = g.getPortalCredential(this.portalUrl)) }, signIn: function () { var B = new m; this.updateCredential(); this.isValidCredential() ? setTimeout(q.hitch(this, function () { B.resolve(this.credential) }), 0) : B = g.signInPortal(this.portalUrl); return B }, haveSignIn: function () { return g.userHaveSignInPortal(this.portalUrl) }, clearCredentialAndUser: function () { this.user = this.credential = null }, getSigninSettingsOfSelfInfo: function () {
                                                this.updateCredential();
                                                var B = new m, t = this.selfUrl + "/signinSettings"; this.isValidCredential() ? B = k({ url: t, handleAs: "json", content: { f: "json", token: this.credential.token }, callbackParamName: "callback" }) : B.resolve({}); return B
                                        }, getUser: function () {
                                                this.updateCredential(); var B = new m; this.user && "jimu.PortalUser" === this.user.declaredClass ? setTimeout(q.hitch(this, function () { this.user.updateCredential(); B.resolve(this.user) }), 0) : this.isValidCredential() ? this.credential.userId ? this._getUser(this.credential.userId).then(q.hitch(this,
                                                        function (t) { this.user = t; B.resolve(this.user) }), q.hitch(this, function (t) { console.error(t); B.reject(t) })) : g.getUserIdByToken(this.credential.token, this.portalUrl).then(q.hitch(this, function (t) { this.credential.userId = t; this._getUser(this.credential.userId).then(q.hitch(this, function (u) { this.user = u; B.resolve(this.user) }), q.hitch(this, function (u) { console.error(u); B.reject(u) })) }), q.hitch(this, function (t) { console.error(t); B.reject(t) })) : setTimeout(q.hitch(this, function () { B.reject("credential is null.") }),
                                                                0); return B
                                        }, queryItems: function (B) {
                                                this.updateCredential(); var t = new m, u = c.getBaseSearchUrl(this.portalUrl), z = { f: "json" }; B && (z = q.mixin(z, B)); this.isValidCredential() && (z.token = this.credential.token); z.sortField || z.sortOrder || (z.sortField = "title", z.sortOrder = "asc"); k({ url: u, handleAs: "json", content: z, callbackParamName: "callback" }).then(q.hitch(this, function (x) {
                                                        x.results = A.map(x.results, q.hitch(this, function (y) { y.portalUrl = this.portalUrl; y.credential = this.credential; y.portal = this; return new h(y) }));
                                                        t.resolve(x)
                                                }), q.hitch(this, function (x) { console.error(x); t.reject(x) })); return t
                                        }, getItemData: function (B) { this.updateCredential(); B = { url: c.getItemDataUrl(this.portalUrl, B), handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; return k(B) }, _getItemById: function (B, t) {
                                                B = { url: c.getItemUrl(this.portalUrl, B), handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; t && (B.content.token = t); return k(B).then(q.hitch(this, function (u) {
                                                        u.portalUrl = this.portalUrl; u.credential = this.credential;
                                                        u.portal = this; return new h(u)
                                                }))
                                        }, getItemById: function (B, t) { this.updateCredential(); return this._getItemById(B).then(q.hitch(this, function (u) { return t && u.owner && this.isValidCredential() && this.credential && this.credential.userId === u.owner ? this._getItemById(B, this.credential.token) : u })) }, getAppById: function (B) {
                                                var t = new m; this.updateCredential(); this.isValidCredential() ? (B = c.getAppIdUrl(this.portalUrl, B), t = k({ url: B, handleAs: "json", content: { f: "json", token: this.credential.token } })) : setTimeout(q.hitch(this,
                                                        function () { t.reject("token is null.") }), 0); return t
                                        }, queryGroups: function (B) {
                                                this.updateCredential(); var t = new m, u = c.getBaseGroupUrl(this.portalUrl), z = { f: "json" }; B && (z = q.mixin(z, B)); this.isValidCredential() && (z.token = this.credential.token); k({ url: u, handleAs: "json", content: z, callbackParamName: "callback" }).then(q.hitch(this, function (x) { x.results = A.map(x.results, q.hitch(this, function (y) { y.portalUrl = this.portalUrl; y.credential = this.credential; y.portal = this; return new f(y) })); t.resolve(x) }), q.hitch(this,
                                                        function (x) { console.error(x); t.reject(x) })); return t
                                        }, registerApp: function (B, t, u) { var z = new m; this.updateCredential(); if (this.isValidCredential()) { var x = this.credential && this.credential.token, y = c.getOAuth2Url(this.portalUrl); z = k({ url: y + "/registerApp", content: { itemId: B, appType: t, redirect_uris: r.stringify(u), token: x, f: "json" }, handleAs: "json" }, { usePost: !0 }) } else setTimeout(q.hitch(this, function () { z.reject("token is null.") }), 0); return z }, createAndRegisterApp: function (B) {
                                                var t = new m; this.updateCredential();
                                                this.isValidCredential() ? this.getUser().then(q.hitch(this, function (u) { u.addItem({ title: "ArcGIS Web AppBuilder", type: "Web Mapping Application", text: "", snippet: "", tags: "Registered App for OAuth" }, "").then(q.hitch(this, function (z) { z.success ? this.registerApp(z.id, "browser", B).then(q.hitch(this, function (x) { t.resolve(x) }), q.hitch(this, function (x) { console.error(x); t.reject(x) })) : t.reject("create app failed") }), q.hitch(this, function (z) { console.error(z); t.reject(z) })) }), q.hitch(this, function (u) {
                                                        console.error(u);
                                                        t.reject(u)
                                                })) : setTimeout(q.hitch(this, function () { t.reject("token is null.") }), 0); return t
                                        }, _getUser: function (B) {
                                                this.updateCredential(); var t = new m; B = { url: c.getUserUrl(this.portalUrl, B), content: { f: "json" }, handleAs: "json", callbackParamName: "callback" }; this.isValidCredential() && (B.content.token = this.credential && this.credential.token); k(B).then(q.hitch(this, function (u) { u.portalUrl = this.portalUrl; u.credential = this.credential; u.portal = this; this.user = new a(u); t.resolve(this.user) }), q.hitch(this, function (u) {
                                                        console.error(u);
                                                        t.reject(u)
                                                })); return t
                                        }, getHelpMap: function () { this.updateCredential(); var B = { url: c.getPortalHelpMapUrl(this.portalUrl), handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; return k(B) }
                                }), a = E([], {
                                        declaredClass: "jimu.PortalUser", portalUrl: null, credential: null, portal: null, constructor: function (B) { B && q.mixin(this, B) }, _checkCredential: function () { var B = g.isValidCredential(this.credential); B || (this.credential = null); return B }, isValidCredential: function () { this.updateCredential(); return this._checkCredential() },
                                        updateCredential: function () { this._checkCredential() || (this.portal.updateCredential(), this.credential = this.portal.credential) }, canCreateItem: function () { var B = new n({ id: this.roleId ? this.roleId : this.role, role: this.role }); this.privileges && B.setPrivileges(this.privileges); return B.canCreateItem() }, canCreateNotebooks: function () { var B = new n({ id: this.roleId ? this.roleId : this.role, role: this.role }); this.privileges && B.setPrivileges(this.privileges); return B.canCreateNotebooks() }, getGroups: function () {
                                                var B = [];
                                                this.groups && (B = A.map(this.groups, q.hitch(this, function (t) { t.portalUrl = this.portalUrl; t.credential = this.credential; t.portal = this.portal; return new f(t) }))); return B
                                        }, getItemsByKeywords: function (B, t) { return this.portal.queryItems({ start: t || 1, num: 100, q: "owner:" + this.username + ' AND typekeywords:"' + B + '"' }) }, getContent: function () {
                                                this.updateCredential(); var B = { url: c.getUserContentUrl(this.portalUrl, this.username), handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; this.isValidCredential &&
                                                        (B.content.token = this.credential.token); return k(B)
                                        }, getTags: function () { this.updateCredential(); var B = { url: c.getUserTagsUrl(this.portalUrl, this.username), handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; this.isValidCredential() && (B.content.token = this.credential.token); return k(B) }, addItem: function (B, t) {
                                                this.updateCredential(); var u = new m; if (this.isValidCredential()) {
                                                        var z = { f: "json", token: this.credential.token }; B && (z = q.mixin(z, B)); k({
                                                                url: c.getAddItemUrl(this.portalUrl, this.username,
                                                                        t), handleAs: "json", callbackParamName: "callback", content: z
                                                        }, { usePost: !0 }).then(q.hitch(this, function (x) { u.resolve(x) }), q.hitch(this, function (x) { console.error(x); u.reject(x) }))
                                                } else setTimeout(q.hitch(this, function () { u.reject("token is null.") }), 0); return u
                                        }, deleteItem: function (B) {
                                                this.updateCredential(); var t = new m; this.isValidCredential() ? (B = c.getDeleteItemUrl(this.portalUrl, this.username, B), t = k({ url: B, content: { token: this.credential.token, f: "json" }, handleAs: "json" }, { usePost: !0 })) : setTimeout(q.hitch(this,
                                                        function () { t.reject("token is null.") }), 0); return t
                                        }, getItemById: function (B, t) { this.updateCredential(); var u = new m; B = { url: c.getUserItemsUrl(this.portalUrl, this.username, t) + "/" + B, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; k(B).then(q.hitch(this, function (z) { z.portalUrl = this.portalUrl; z.credential = this.credential; z.portal = this; z = new h(z); u.resolve(z) }), q.hitch(this, function (z) { console.error(z); u.reject(z) })); return u }, shareItem: function (B, t, u) {
                                                this.updateCredential(); var z = new m;
                                                this.isValidCredential() ? (t = { url: c.shareItemUrl(this.portalUrl, this.username, t, u), handleAs: "json", callbackParamName: "callback", content: { f: "json", token: this.credential.token } }, B && (t.content = q.mixin(t.content, B)), k(t, { usePost: !0 }).then(q.hitch(this, function (x) { z.resolve(x) }), q.hitch(this, function (x) { console.error(x); z.reject(x) }))) : setTimeout(q.hitch(this, function () { z.reject("token is null.") }), 0); return z
                                        }, updateItem: function (B, t) {
                                                this.updateCredential(); var u = new m; this.isValidCredential() ? this.portal.getItemById(B).then(q.hitch(this,
                                                        function (z) { var x = { f: "json", token: this.credential.token }; t && (x = q.mixin(x, t)); k({ url: c.getUpdateItemUrl(this.portalUrl, z.owner, B, z.ownerFolder), handleAs: "json", callbackParamName: "callback", timeout: 1E5, content: x }, { usePost: !0 }).then(q.hitch(this, function (y) { u.resolve(y) }), q.hitch(this, function (y) { console.error(y); u.reject(y) })) }), q.hitch(this, function (z) { console.error(z); u.reject(z) })) : setTimeout(q.hitch(this, function () { u.reject("token is null.") }), 0); return u
                                        }, isAdminRole: function () {
                                                return "org_admin" ===
                                                        this.role || "account_admin" === this.role
                                        }, isPublisherRole: function () { return "org_publisher" === this.role || "account_publisher" === this.role }, isUserRole: function () { return "org_user" === this.role || "account_user" === this.role }, getRegisteredAppInfo: function (B, t) { var u = new m; this.updateCredential(); t = c.getUserItemsUrl(this.portalUrl, this.username, t); return u = k({ url: t + "/" + B + "/registeredAppInfo", content: { token: this.credential.token, f: "json" }, handleAs: "json" }, { usePost: !0 }) }, getRegisteredAppInfoWithXhr: function (B,
                                                t) { var u = new m; this.updateCredential(); t = c.getUserItemsUrl(this.portalUrl, this.username, t); return u = l(t + "/" + B + "/registeredAppInfo", { data: { token: this.credential.token, f: "json" }, method: "POST", handleAs: "json" }) }
                                }), f = E([], {
                                        declaredClass: "jimu.PortalGroup", portalUrl: null, credential: null, portal: null, constructor: function (B) { B && q.mixin(this, B) }, _checkCredential: function () { var B = g.isValidCredential(this.credential); B || (this.credential = null); return B }, isValidCredential: function () { this.updateCredential(); return this._checkCredential() },
                                        updateCredential: function () { this._checkCredential() || (this.portal.updateCredential(), this.credential = this.portal.credential) }, queryItems: function (B) { B.q = "group:" + this.id + " AND " + B.q; return this.portal.queryItems(B) }
                                }), h = E([], {
                                        declaredClass: "jimu.PortalItem", itemUrl: null, detailsPageUrl: null, ownerPageUrl: null, portalUrl: null, credential: null, portal: null, token: null, constructor: function (B) {
                                                B && q.mixin(this, B); this.itemUrl = c.getItemUrl(this.portalUrl, this.id); !this.thumbnailUrl && this.thumbnail && this.itemUrl &&
                                                        (this.thumbnailUrl = this.itemUrl + "/info/" + this.thumbnail); this.token = this.credential && this.credential.token; this.thumbnailUrl && this.token && (this.thumbnailUrl += "?token\x3d" + this.token); this.portalUrl && this.id && (this.detailsPageUrl = c.getItemDetailsPageUrl(this.portalUrl, this.id)); this.portalUrl && this.owner && (this.ownerPageUrl = c.getUserProfilePageUrl(this.portalUrl, this.owner))
                                        }, _checkCredential: function () { var B = g.isValidCredential(this.credential); B || (this.credential = null); return B }, isValidCredential: function () {
                                                this.updateCredential();
                                                return this._checkCredential()
                                        }, updateCredential: function () { this._checkCredential() || (this.portal.updateCredential(), this.credential = this.portal.credential) }, getItemData: function () { return this.portal.getItemData(this.id) }, getItemGroups: function () { this.updateCredential(); var B = { url: c.getItemGroupsUrl(this.portalUrl, this.id), handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }; this.isValidCredential() && (B.content.token = this.credential.token); return k(B) }
                                }), p = {
                                        portals: [], webMapQueryStr: " " +
                                                d.getItemQueryStringByTypes(["Web Map"]) + " ", webSceneQueryStr: " " + d.getItemQueryStringByTypes(["Web Scene"]) + " ", _findPortal: function (B) { for (var t = 0; t < this.portals.length; t++) { var u = this.portals[t]; if (c.isSamePortalUrl(B, u.portalUrl)) return u.updateCredential(), u } return null }, getPortal: function (B) {
                                                        if (!B || "string" !== typeof B || !q.trim(B)) return null; B = c.getStandardPortalUrl(B); var t = this._findPortal(B); t || (t = new e(B), t.credential = g.getPortalCredential(t.portalUrl), t.updateCredential(), this.portals.push(t));
                                                        return t
                                                }, getPortalSelfInfo: function (B) { return this.getPortal(B).loadSelfInfo() }, getBasemapGalleryGroup: function (B) { return this._getPortalSelfGroup(B, "basemapGalleryGroupQuery") }, getTemplatesGroup: function (B) { return this._getPortalSelfGroup(B, "templatesGroupQuery") }, getUnits: function (B) {
                                                        var t = "english", u = "", z = new m; this.getPortal(B).getUser().then(q.hitch(this, function (x) { x && x.units ? t = x.units : (u = w.locale, t = u.startWith("en") ? "english" : "metric"); z.resolve(t) }), q.hitch(this, function (x) {
                                                                console.warn(x);
                                                                this.getPortalSelfInfo(B).then(q.hitch(this, function (y) { var D = null; y && y.units ? D = y.units : (u = y && y.culture || w.locale, D = u.startWith("en") ? "english" : "metric"); z.resolve(D) }), q.hitch(this, function (y) { console.warn(y); u = w.locale; t = u.startWith("en") ? "english" : "metric"; z.resolve(t) }))
                                                        })); return z.promise
                                                }, _getPortalSelfGroup: function (B, t) {
                                                        var u = new m, z = this.getPortal(B); z || setTimeout(q.hitch(this, function () { u.reject() }), 0); this.getPortalSelfInfo(B).then(q.hitch(this, function (x) {
                                                                z.queryGroups({ f: "json", q: x[t] }).then(q.hitch(this,
                                                                        function (y) { 0 < y.results.length ? (y = y.results[0], y.portalUrl = z.portalUrl, y.credential = z.credential, y.portal = z, y = new f(y), u.resolve(y)) : u.reject("Can't find portal self group.") }), q.hitch(this, function (y) { console.error(y); u.reject(y) }))
                                                        }), q.hitch(this, function (x) { console.error(x); u.reject(x) })); return u
                                                }, getWebMapsFromBasemapGalleryGroup: function (B) {
                                                        var t = new m; this.getBasemapGalleryGroup(B).then(q.hitch(this, function (u) {
                                                                u ? u.queryItems({ start: 1, num: 100, f: "json", q: this.webMapQueryStr }).then(q.hitch(this,
                                                                        function (z) { t.resolve(z) }), q.hitch(this, function (z) { console.error(z); t.reject(z) })) : t.reject()
                                                        }), q.hitch(this, function (u) { console.error(u); t.reject(u) })); return t
                                                }, getDefaultWebScene: function (B) {
                                                        var t = c.getStandardPortalUrl(B); return this._searchWABDefaultWebScene(t).then(q.hitch(this, function (u) {
                                                                return u ? u : this._createWABDefaultWebScene(t).then(q.hitch(this, function (z) {
                                                                        return this.getPortal(t).getUser().then(q.hitch(this, function (x) {
                                                                                var y = !1; x && x.privileges && 0 < x.privileges.length && (y = A.some(x.privileges,
                                                                                        function (D) { return 0 <= D.indexOf("shareToPublic") })); return y ? x.shareItem({ everyone: !0 }, z).then(q.hitch(this, function () { return z }), q.hitch(this, function () { return z })) : z
                                                                        }), q.hitch(this, function (x) { console.error(x); return z }))
                                                                }))
                                                        }))
                                                }, _searchWABDefaultWebScene: function (B) {
                                                        var t = new m; B = c.getStandardPortalUrl(B); B = this.getPortal(B); B.queryItems({ q: 'typekeywords:"WABDefaultWebScene" orgid:' + B.user.orgId + " access:public " + this.webSceneQueryStr }).then(q.hitch(this, function (u) {
                                                                u && u.results && 0 < u.results.length ?
                                                                t.resolve(u.results[0].id) : t.resolve(null)
                                                        }), q.hitch(this, function (u) { console.error("_searchWABDefaultWebScene error:", u); t.reject(u) })); return t
                                                }, _createWABDefaultWebScene: function (B) {
                                                        var t = new m; B = c.getStandardPortalUrl(B); this.getPortal(B).getUser().then(q.hitch(this, function (u) {
                                                                var z = {
                                                                        title: "Default Web Scene", type: "Web Scene", typeKeywords: "WABDefaultWebScene", tags: "default", text: r.stringify({
                                                                                operationalLayers: [], baseMap: {
                                                                                        baseMapLayers: [{
                                                                                                id: "World_Hillshade_1081", opacity: 1, title: "World_Hillshade",
                                                                                                url: "https://services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer", visibility: !0, layerType: "ArcGISTiledMapServiceLayer"
                                                                                        }, { id: "VectorTile_3464", opacity: 1, title: "World Topographic Map", visibility: !0, layerType: "VectorTileLayer", styleUrl: "https://cdn.arcgis.com/sharing/rest/content/items/3c86f87a8aa848f290737c2e2b65393c/resources/styles/root.json" }], id: "1814b9f4bac-basemap-2", title: "Topographic", elevationLayers: [{
                                                                                                id: "globalElevation", listMode: "hide", title: "Terrain3D", url: "https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",
                                                                                                layerType: "ArcGISTiledElevationServiceLayer"
                                                                                        }]
                                                                                }, ground: { layers: [{ id: "globalElevation", listMode: "hide", title: "Terrain3D", url: "https://elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer", layerType: "ArcGISTiledElevationServiceLayer" }], transparency: 0, navigationConstraint: { type: "stayAbove" } }, heightModelInfo: { heightModel: "gravity_related_height", heightUnit: "meter" }, version: "1.28", authoringApp: "WebSceneViewer", authoringAppVersion: "10.2.0.0", initialState: {
                                                                                        environment: {
                                                                                                lighting: {
                                                                                                        type: "sun",
                                                                                                        datetime: 1647343627E3, displayUTCOffset: 1
                                                                                                }, atmosphereEnabled: !0, starsEnabled: !0, weather: { type: "sunny", cloudCover: .5 }
                                                                                        }, viewpoint: { camera: { position: { spatialReference: { latestWkid: 3857, wkid: 102100 }, x: 915287.4999997683, y: 5857832.06283967, z: 1.3939488740803137E7 }, heading: 0, tilt: .15695889139124297 } }
                                                                                }, spatialReference: { latestWkid: 3857, wkid: 102100 }, viewingMode: "global", authoringApp: "WebAppBuilder", authoringAppVersion: "2.25"
                                                                        }), snippet: ""
                                                                }; u.addItem(z, "").then(q.hitch(this, function (x) {
                                                                        x.success ? t.resolve(x.id) :
                                                                        (console.error("Can't create default web scene:", x), t.reject())
                                                                }))
                                                        }), q.hitch(this, function (u) { console.error("Can't create default web scene"); t.reject(u) })); return t
                                                }, getDefaultWebMap: function (B) {
                                                        var t = new m; this.getPortalSelfInfo(B).then(q.hitch(this, function (u) {
                                                                var z = u.defaultBasemap && u.defaultBasemap.id; z ? t.resolve(z) : this._getDefaultWebMapByBasemapGallery(B, u).then(q.hitch(this, function (x) {
                                                                        x ? t.resolve(x) : this._getMostNumViewsWebMap(B).then(q.hitch(this, function (y) { y ? t.resolve(y) : t.reject() }),
                                                                                q.hitch(this, function (y) { console.error(y); t.reject(y) }))
                                                                }), q.hitch(this, function (x) { console.error(x); t.reject(x) }))
                                                        }), q.hitch(this, function (u) { console.error(u); t.reject(u) })); return t
                                                }, _getDefaultWebMapByBasemapGallery: function (B, t) {
                                                        var u = new m, z = this.getPortal(B), x = t.defaultBasemap && t.defaultBasemap.title; z.queryGroups({ f: "json", q: t.basemapGalleryGroupQuery }).then(q.hitch(this, function (y) {
                                                                y = y.results; 0 < y.length ? z.queryItems({
                                                                        start: 1, num: 1, f: "json", q: this.webMapQueryStr + " AND group:" + y[0].id + " AND title:" +
                                                                                x
                                                                }).then(q.hitch(this, function (D) {
                                                                        D = D.results; D = A.filter(D, q.hitch(this, function (H) { return H.type && "web map" === H.type.toLowerCase() })); 0 < D.length ? u.resolve(D[0].id) : (console.log("Can't find web map under basemapGalleryGroupQuery."), z.queryItems({ start: 1, num: 1, f: "json", q: this.webMapQueryStr + " AND title:" + x }).then(q.hitch(this, function (H) {
                                                                                H = H.results; H = A.filter(H, q.hitch(this, function (N) { return N.type && "web map" === N.type.toLowerCase() })); if (0 < H.length) {
                                                                                        var I = H[0]; z.getItemData(I.id).then(q.hitch(this,
                                                                                                function (N) { N && (N.operationalLayers || N.baseMap || N.version) ? u.resolve(I.id) : u.resolve(null) }), q.hitch(this, function () { u.resolve(null) }))
                                                                                } else console.log("Can't find web map by defaultBasemap.title."), u.resolve(null)
                                                                        }), q.hitch(this, function (H) { console.error(H); u.reject(H) })))
                                                                }), q.hitch(this, function (D) { console.error(D); u.reject(D) })) : (console.log("Can't find group by basemapGalleryGroupQuery."), u.resolve(null))
                                                        }), q.hitch(this, function (y) { console.error(y); u.reject(y) })); return u
                                                }, _getMostNumViewsWebMap: function (B) {
                                                        var t =
                                                                new m; this.getPortal(B).queryItems({ start: 1, num: 1, f: "json", q: this.webMapQueryStr + " AND access:public AND owner:esri_en", sortField: "numViews", sortOrder: "desc" }).then(q.hitch(this, function (u) { u = u.results; u = A.filter(u, q.hitch(this, function (z) { return z.type && "web map" === z.type.toLowerCase() })); 0 < u.length ? t.resolve(u[0].id) : t.reject("Can't find most-num-views web map.") }), q.hitch(this, function (u) { console.error(u); t.reject(u) })); return t
                                                }, comparePortalVersion: function (B, t) {
                                                        var u = B.split("."); B = parseInt(u[0],
                                                                10); u = 1 < u.length ? parseInt(u[1], 10) : 0; var z = t.split("."); t = parseInt(z[0], 10); z = 1 < z.length ? parseInt(z[1], 10) : 0; return B > t ? 1 : B < t ? -1 : u > z ? 1 : u < z ? -1 : 0
                                                }, getItemResources: function (B, t, u) { u || (u = 100); B = c.getStandardPortalUrl(B); B = c.getItemResourceUrl(B, t); return k({ url: B, content: { f: "json", num: u } }).then(function (z) { if (z && z.resources) return z.resources }) }, addResource: function (B, t, u, z, x) {
                                                        B = c.getStandardPortalUrl(B); var y = this.getPortal(B), D = new FormData; D.append("file", u, z); D.append("fileName", z); D.append("f",
                                                                "json"); var H = ""; x ? (D.append("resourcesPrefix", x), H = x + "/" + z) : H = z; return y.getItemById(t, !0).then(function (I) { I = c.getUserContentItemUrl(B, I.owner, t); return k({ url: I + "/addResources", form: D }).then(function (N) { var T = ""; N && N.success && (T = c.getItemResourceUrl(B, "${itemId}", H)); return T }, function (N) { console.error(N.message || N); return N }) })
                                                }, removeResources: function (B, t, u, z) {
                                                        var x = { resource: z ? z + "/" + u : u, f: "json" }; B = c.getStandardPortalUrl(B); return this.getPortal(B).getItemById(t, !0).then(function (y) {
                                                                y = c.getUserContentItemUrl(B,
                                                                        y.owner, t); return k({ url: y + "/removeResources", content: x }, { usePost: !0 }).then(function (D) { return D }, function (D) { console.error(D.message || D); return D })
                                                        })
                                                }
                                }; v.subscribe("userSignOut", function (B) { (B = p._findPortal(B)) && B.clearCredentialAndUser() }); return p
                        })
                }, "jimu/Role": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/_base/array", "dojo/json", "esri/lang"], function (E, q, A, w, m) {
                                return E(null, {
                                        id: null, baseRole: null, name: null, description: null, privileges: [], privilegeObj: null, constructor: function (v) {
                                                v =
                                                v || {}; this.id = v.id; this.baseRole = v.role; this.name = v.name; this.description = v.description
                                        }, _initPrivilegesObject: function () {
                                                this.privilegeObj = {
                                                        portal: {
                                                                admin: { inviteUsers: !1, disableUsers: !1, viewUsers: !1, updateUsers: !1, deleteUsers: !1, changeUserRoles: !1, viewGroups: !1, updateGroups: !1, deleteGroups: !1, reassignGroups: !1, assignToGroups: !1, manageEnterpriseGroups: !1, viewItems: !1, updateItems: !1, deleteItems: !1, reassignItems: !1, manageLicenses: !1 }, publisher: { publishFeatures: !1, publishTiles: !1, publishScenes: !1 }, user: {
                                                                        createGroup: !1,
                                                                        joinGroup: !1, joinNonOrgGroup: !1, createItem: !1, shareToGroup: !1, shareToOrg: !1, shareToPublic: !1, shareGroupToOrg: !1, shareGroupToPublic: !1
                                                                }
                                                        }, features: { user: { edit: !1, fullEdit: !1 } }, opendata: { user: { openDataAdmin: !1, designateGroup: !1 } }, premium: { user: { geocode: !1, networkanalysis: !1, spatialanalysis: !1, geoenrichment: !1, demographics: !1, elevation: !1 }, publisher: { createNotebooks: !1 } }, marketplace: { admin: { manage: !1, purchase: !1, startTrial: !1 } }
                                                }
                                        }, _readPrivileges: function (v) {
                                                m.isDefined(v) && v instanceof Array && A.forEach(v,
                                                        q.hitch(this, function (r) { this._readPrivilege(r) }))
                                        }, _readPrivilege: function (v) { this._applyEffectToAction(!0, v) }, _applyEffectToAction: function (v, r) {
                                                switch (r) {
                                                        case "portal:admin:inviteUsers": this.privilegeObj.portal.admin.inviteUsers = v; break; case "portal:admin:disableUsers": this.privilegeObj.portal.admin.disableUsers = v; break; case "portal:admin:viewUsers": this.privilegeObj.portal.admin.viewUsers = v; break; case "portal:admin:updateUsers": this.privilegeObj.portal.admin.updateUsers = v; break; case "portal:admin:deleteUsers": this.privilegeObj.portal.admin.deleteUsers =
                                                                v; break; case "portal:admin:changeUserRoles": this.privilegeObj.portal.admin.changeUserRoles = v; break; case "portal:admin:viewGroups": this.privilegeObj.portal.admin.viewGroups = v; break; case "portal:admin:updateGroups": this.privilegeObj.portal.admin.updateGroups = v; break; case "portal:admin:deleteGroups": this.privilegeObj.portal.admin.deleteGroups = v; break; case "portal:admin:reassignGroups": this.privilegeObj.portal.admin.reassignGroups = v; break; case "portal:admin:assignToGroups": this.privilegeObj.portal.admin.assignToGroups =
                                                                        v; break; case "portal:admin:manageEnterpriseGroups": this.privilegeObj.portal.admin.manageEnterpriseGroups = v; break; case "portal:admin:viewItems": this.privilegeObj.portal.admin.viewItems = v; break; case "portal:admin:updateItems": this.privilegeObj.portal.admin.updateItems = v; break; case "portal:admin:deleteItems": this.privilegeObj.portal.admin.deleteItems = v; break; case "portal:admin:reassignItems": this.privilegeObj.portal.admin.reassignItems = v; break; case "portal:admin:manageLicenses": this.privilegeObj.portal.admin.manageLicenses =
                                                                                v; break; case "portal:publisher:publishFeatures": this.privilegeObj.portal.publisher.publishFeatures = v; break; case "portal:publisher:publishTiles": this.privilegeObj.portal.publisher.publishTiles = v; break; case "portal:publisher:publishScenes": this.privilegeObj.portal.publisher.publishScenes = v; break; case "portal:user:createGroup": this.privilegeObj.portal.user.createGroup = v; break; case "portal:user:joinGroup": this.privilegeObj.portal.user.joinGroup = v; break; case "portal:user:joinNonOrgGroup": this.privilegeObj.portal.user.joinNonOrgGroup =
                                                                                        v; break; case "portal:user:createItem": this.privilegeObj.portal.user.createItem = v; break; case "portal:user:shareToGroup": this.privilegeObj.portal.user.shareToGroup = v; break; case "portal:user:shareToOrg": this.privilegeObj.portal.user.shareToOrg = v; break; case "portal:user:shareToPublic": this.privilegeObj.portal.user.shareToPublic = v; break; case "portal:user:shareGroupToOrg": this.privilegeObj.portal.user.shareGroupToOrg = v; break; case "portal:user:shareGroupToPublic": this.privilegeObj.portal.user.shareGroupToPublic =
                                                                                                v; break; case "features:user:edit": this.privilegeObj.features.user.edit = v; break; case "features:user:fullEdit": this.privilegeObj.features.user.fullEdit = v; break; case "opendata:user:openDataAdmin": this.privilegeObj.opendata.user.openDataAdmin = v; break; case "opendata:user:designateGroup": this.privilegeObj.opendata.user.designateGroup = v; break; case "premium:user:geocode": this.privilegeObj.premium.user.geocode = v; break; case "premium:user:networkanalysis": this.privilegeObj.premium.user.networkanalysis = v; break;
                                                        case "premium:user:spatialanalysis": this.privilegeObj.premium.user.spatialanalysis = v; break; case "premium:user:geoenrichment": this.privilegeObj.premium.user.geoenrichment = v; break; case "premium:user:demographics": this.privilegeObj.premium.user.demographics = v; break; case "premium:user:elevation": this.privilegeObj.premium.user.elevation = v; break; case "premium:publisher:createNotebooks": this.privilegeObj.premium.publisher.createNotebooks = v; break; case "marketplace:admin:purchase": this.privilegeObj.marketplace.admin.purchase =
                                                                v; break; case "marketplace:admin:manage": this.privilegeObj.marketplace.admin.manage = v; break; case "marketplace:admin:startTrial": this.privilegeObj.marketplace.admin.startTrial = v
                                                }
                                        }, _applyToAll: function (v) {
                                                this.privilegeObj.portal.admin.inviteUsers = v; this.privilegeObj.portal.admin.disableUsers = v; this.privilegeObj.portal.admin.viewUsers = v; this.privilegeObj.portal.admin.updateUsers = v; this.privilegeObj.portal.admin.deleteUsers = v; this.privilegeObj.portal.admin.changeUserRoles = v; this.privilegeObj.portal.admin.viewGroups =
                                                        v; this.privilegeObj.portal.admin.updateGroups = v; this.privilegeObj.portal.admin.deleteGroups = v; this.privilegeObj.portal.admin.reassignGroups = v; this.privilegeObj.portal.admin.assignToGroups = v; this.privilegeObj.portal.admin.manageEnterpriseGroups = v; this.privilegeObj.portal.admin.viewItems = v; this.privilegeObj.portal.admin.updateItems = v; this.privilegeObj.portal.admin.deleteItems = v; this.privilegeObj.portal.admin.reassignItems = v; this.privilegeObj.portal.admin.manageLicenses = v; this.privilegeObj.portal.publisher.publishFeatures =
                                                                v; this.privilegeObj.portal.publisher.publishTiles = v; this.privilegeObj.portal.publisher.publishScenes = v; this.privilegeObj.portal.user.createGroup = v; this.privilegeObj.portal.user.joinGroup = v; this.privilegeObj.portal.user.joinNonOrgGroup = v; this.privilegeObj.portal.user.createItem = v; this.privilegeObj.portal.user.shareToGroup = v; this.privilegeObj.portal.user.shareToOrg = v; this.privilegeObj.portal.user.shareToPublic = v; this.privilegeObj.portal.user.shareGroupToOrg = v; this.privilegeObj.portal.user.shareGroupToPublic =
                                                                        v; this.privilegeObj.features.user.edit = v; this.privilegeObj.opendata.user.openDataAdmin = v; this.privilegeObj.opendata.user.designateGroup = v; this.privilegeObj.premium.user.geocode = v; this.privilegeObj.premium.user.networkanalysis = v; this.privilegeObj.premium.user.spatialanalysis = v; this.privilegeObj.premium.user.geoenrichment = v; this.privilegeObj.premium.user.demographics = v; this.privilegeObj.premium.user.elevation = v; this.privilegeObj.premium.publisher.createNotebooks = v; this.privilegeObj.marketplace.admin.purchase =
                                                                                v; this.privilegeObj.marketplace.admin.manage = v; this.privilegeObj.marketplace.admin.startTrial = v
                                        }, _buildPrivilegesArray: function () {
                                                var v = []; !0 === this.privilegeObj.portal.admin.inviteUsers && v.push("portal:admin:inviteUsers"); !0 === this.privilegeObj.portal.admin.disableUsers && v.push("portal:admin:disableUsers"); !0 === this.privilegeObj.portal.admin.viewUsers && v.push("portal:admin:viewUsers"); !0 === this.privilegeObj.portal.admin.updateUsers && v.push("portal:admin:updateUsers"); !0 === this.privilegeObj.portal.admin.deleteUsers &&
                                                        v.push("portal:admin:deleteUsers"); !0 === this.privilegeObj.portal.admin.changeUserRoles && v.push("portal:admin:changeUserRoles"); !0 === this.privilegeObj.portal.admin.viewGroups && v.push("portal:admin:viewGroups"); !0 === this.privilegeObj.portal.admin.updateGroups && v.push("portal:admin:updateGroups"); !0 === this.privilegeObj.portal.admin.deleteGroups && v.push("portal:admin:deleteGroups"); !0 === this.privilegeObj.portal.admin.reassignGroups && v.push("portal:admin:reassignGroups"); !0 === this.privilegeObj.portal.admin.assignToGroups &&
                                                                v.push("portal:admin:assignToGroups"); !0 === this.privilegeObj.portal.admin.manageEnterpriseGroups && v.push("portal:admin:manageEnterpriseGroups"); !0 === this.privilegeObj.portal.admin.viewItems && v.push("portal:admin:viewItems"); !0 === this.privilegeObj.portal.admin.updateItems && v.push("portal:admin:updateItems"); !0 === this.privilegeObj.portal.admin.deleteItems && v.push("portal:admin:deleteItems"); !0 === this.privilegeObj.portal.admin.reassignItems && v.push("portal:admin:reassignItems"); !0 === this.privilegeObj.portal.admin.manageLicenses &&
                                                                        v.push("portal:admin:manageLicenses"); !0 === this.privilegeObj.portal.publisher.publishFeatures && v.push("portal:publisher:publishFeatures"); !0 === this.privilegeObj.portal.publisher.publishTiles && v.push("portal:publisher:publishTiles"); !0 === this.privilegeObj.portal.publisher.publishScenes && v.push("portal:publisher:publishScenes"); !0 === this.privilegeObj.portal.user.createGroup && v.push("portal:user:createGroup"); !0 === this.privilegeObj.portal.user.joinGroup && v.push("portal:user:joinGroup"); !0 === this.privilegeObj.portal.user.joinNonOrgGroup &&
                                                                                v.push("portal:user:joinNonOrgGroup"); !0 === this.privilegeObj.portal.user.createItem && v.push("portal:user:createItem"); !0 === this.privilegeObj.portal.user.shareToGroup && v.push("portal:user:shareToGroup"); !0 === this.privilegeObj.portal.user.shareToOrg && v.push("portal:user:shareToOrg"); !0 === this.privilegeObj.portal.user.shareToPublic && v.push("portal:user:shareToPublic"); !0 === this.privilegeObj.portal.user.shareGroupToOrg && v.push("portal:user:shareGroupToOrg"); !0 === this.privilegeObj.portal.user.shareGroupToPublic &&
                                                                                        v.push("portal:user:shareGroupToPublic"); !0 === this.privilegeObj.features.user.edit && v.push("features:user:edit"); !0 === this.privilegeObj.features.user.fullEdit && v.push("features:user:fullEdit"); !0 === this.privilegeObj.opendata.user.openDataAdmin && v.push("opendata:user:openDataAdmin"); !0 === this.privilegeObj.opendata.user.designateGroup && v.push("opendata:user:designateGroup"); !0 === this.privilegeObj.premium.user.geocode && v.push("premium:user:geocode"); !0 === this.privilegeObj.premium.user.networkanalysis &&
                                                                                                v.push("premium:user:networkanalysis"); !0 === this.privilegeObj.premium.user.spatialanalysis && v.push("premium:user:spatialanalysis"); !0 === this.privilegeObj.premium.user.geoenrichment && v.push("premium:user:geoenrichment"); !0 === this.privilegeObj.premium.user.demographics && v.push("premium:user:demographics"); !0 === this.privilegeObj.premium.user.elevation && v.push("premium:user:elevation"); !0 === this.privilegeObj.premium.publisher.createNotebooks && v.push("premium:publisher:createNotebooks"); !0 === this.privilegeObj.marketplace.admin.purchase &&
                                                                                                        v.push("marketplace:admin:purchase"); !0 === this.privilegeObj.marketplace.admin.manage && v.push("marketplace:admin:manage"); !0 === this.privilegeObj.marketplace.admin.startTrial && v.push("marketplace:admin:startTrial"); return v
                                        }, isUser: function () { return m.isDefined(this.id) && ("org_user" === this.id || "account_user" === this.id) }, isPublisher: function () { return m.isDefined(this.id) && ("org_publisher" === this.id || "account_publisher" === this.id) }, isAdmin: function () {
                                                return m.isDefined(this.id) && ("org_admin" === this.id ||
                                                        "account_admin" === this.id)
                                        }, isBasedOnUser: function () { return this.isUser() || m.isDefined(this.baseRole) && ("org_user" === this.baseRole || "account_user" === this.baseRole) }, isBasedOnPublisher: function () { return this.isPublisher() || m.isDefined(this.baseRole) && ("org_publisher" === this.baseRole || "account_publisher" === this.baseRole) }, isBasedOnAdmin: function () { return this.isAdmin() || m.isDefined(this.baseRole) && ("org_admin" === this.baseRole || "account_admin" === this.baseRole) }, isCustom: function () {
                                                return !this.isUser() &&
                                                        !this.isPublisher() && !this.isAdmin() && m.isDefined(this.id) && 0 < this.id.length
                                        }, canInviteUsers: function () { return this.privilegeObj && this.privilegeObj.portal.admin.inviteUsers }, canDisableUsers: function () { return this.privilegeObj && this.privilegeObj.portal.admin.disableUsers }, canViewUsers: function () { return this.privilegeObj && this.privilegeObj.portal.admin.viewUsers }, canUpdateUsers: function () { return this.privilegeObj && this.privilegeObj.portal.admin.updateUsers }, canDeleteUsers: function () {
                                                return this.privilegeObj &&
                                                        this.privilegeObj.portal.admin.deleteUsers
                                        }, canChangeUserRoles: function () { return this.privilegeObj && this.privilegeObj.portal.admin.changeUserRoles }, canViewOrgGroups: function () { return this.privilegeObj && this.privilegeObj.portal.admin.viewGroups }, canUpdateOrgGroups: function () { return this.privilegeObj && this.privilegeObj.portal.admin.updateGroups }, canDeleteOrgGroups: function () { return this.privilegeObj && this.privilegeObj.portal.admin.deleteGroups }, canReassignOrgGroups: function () {
                                                return this.privilegeObj &&
                                                        this.privilegeObj.portal.admin.reassignGroups
                                        }, canAssignUsersToOrgGroups: function () { return this.privilegeObj && this.privilegeObj.portal.admin.assignToGroups }, canManageEnterpriseGroups: function () { return this.privilegeObj && this.privilegeObj.portal.admin.manageEnterpriseGroups }, canViewOrgItems: function () { return this.privilegeObj && this.privilegeObj.portal.admin.viewItems }, canUpdateOrgItems: function () { return this.privilegeObj && this.privilegeObj.portal.admin.updateItems }, canDeleteOrgItems: function () {
                                                return this.privilegeObj &&
                                                        this.privilegeObj.portal.admin.deleteItems
                                        }, canReassignOrgItems: function () { return this.privilegeObj && this.privilegeObj.portal.admin.reassignItems }, canManageLicenses: function () { return this.privilegeObj && this.privilegeObj.portal.admin.manageLicenses }, canCreateGroup: function () { return this.privilegeObj && this.privilegeObj.portal.user.createGroup }, canJoinOrgGroup: function () { return this.privilegeObj && this.privilegeObj.portal.user.joinGroup }, canJoinNonOrgGroup: function () { return this.privilegeObj && this.privilegeObj.portal.user.joinNonOrgGroup },
                                        canPublishFeatures: function () { return this.privilegeObj && this.privilegeObj.portal.publisher.publishFeatures }, canPublishTiles: function () { return this.privilegeObj && this.privilegeObj.portal.publisher.publishTiles }, canPublishScenes: function () { return this.privilegeObj && this.privilegeObj.portal.publisher.publishScenes }, canCreateItem: function () { return this.privilegeObj && this.privilegeObj.portal.user.createItem }, canShareItemToGroup: function () { return this.privilegeObj && this.privilegeObj.portal.user.shareToGroup },
                                        canShareItemToOrg: function () { return this.privilegeObj && this.privilegeObj.portal.user.shareToOrg }, canShareItemToPublic: function () { return this.privilegeObj && this.privilegeObj.portal.user.shareToPublic }, canShareGroupToOrg: function () { return this.privilegeObj && this.privilegeObj.portal.user.shareGroupToOrg }, canShareGroupToPublic: function () { return this.privilegeObj && this.privilegeObj.portal.user.shareGroupToPublic }, canEditFeatures: function () { return this.privilegeObj && this.privilegeObj.features.user.edit },
                                        canEditFeaturesFullControl: function () { return this.privilegeObj && this.privilegeObj.features.user.fullEdit }, canManageOpenData: function () { return this.privilegeObj && this.privilegeObj.opendata.user.openDataAdmin }, canDesignateOpenDataGroups: function () { return this.privilegeObj && this.privilegeObj.opendata.user.designateGroup }, canUseGeocode: function () { return this.privilegeObj && this.privilegeObj.premium.user.geocode }, canUseNetworkAnalysis: function () { return this.privilegeObj && this.privilegeObj.premium.user.networkanalysis },
                                        canUseSpatialAnalysis: function () { return this.privilegeObj && this.privilegeObj.premium.user.spatialanalysis }, canUseGeoenrichment: function () { return this.privilegeObj && this.privilegeObj.premium.user.geoenrichment }, canUseDemographics: function () { return this.privilegeObj && this.privilegeObj.premium.user.demographics }, canCreateNotebooks: function () { return this.privilegeObj && this.privilegeObj.premium.publisher.createNotebooks }, canPurchaseMarketplace: function () { return this.privilegeObj && this.privilegeObj.marketplace.admin.purchase },
                                        canManageMarketplace: function () { return this.privilegeObj && this.privilegeObj.marketplace.admin.manage }, canTrialMarketplace: function () { return this.privilegeObj && this.privilegeObj.marketplace.admin.startTrial }, setPrivileges: function (v) { this.privileges = v; this._initPrivilegesObject(); m.isDefined(v) && this._readPrivileges(v) }, stringify: function () { return w.stringify({ id: this.id, name: this.name, description: this.description, privileges: this._buildPrivilegesArray() }) }, stringifyRole: function () {
                                                return w.stringify({
                                                        id: this.id,
                                                        name: this.name, description: this.description
                                                })
                                        }, stringifyPrivileges: function () { return w.stringify({ privileges: this._buildPrivilegesArray() }) }, stringifyPretty: function () { return w.stringify({ id: this.id, name: this.name, description: this.description, privileges: this._buildPrivilegesArray() }, null, "  ") }
                                })
                        })
                }, "jimu/ServiceDefinitionManager": function () {
                        define(["dojo/_base/declare", "esri/request"], function (E, q) {
                                var A = null, w = E(null, {
                                        cache: {}, getServiceDefinition: function (m, v) {
                                                v || (v = "json"); var r = this.cache[m];
                                                0 >= this._getDefStatus(r) && (r = q({ url: m, handleAs: v, content: { f: v }, callbackParamName: "callback" }), this.cache[m] = r); return r
                                        }, _getDefStatus: function (m) { return m ? m.isFulfilled() ? m.isResolved() ? 2 : -1 : 1 : 0 }
                                }); w.getInstance = function () { A || (A = new w, window._serviceDefinitionManager = A); return A }; return w
                        })
                }, "jimu/LayerNode": function () {
                        define(["dojo/_base/declare", "dojo/_base/array", "dojo/_base/lang", "dojo/Deferred", "dojo/Evented"], function (E, q, A, w, m) {
                                var v = E([m], {
                                        declaredClass: "jimu.LayerNode", _layerInfo: null, map: null,
                                        title: null, id: null, subId: null, layerObject: null, constructor: function (r) { this._layerInfo = r; this.map = r.map; this.title = r.title; this.id = r.id; this.subId = r.subId }, isLeaf: function () { return this._layerInfo.isLeaf() }, isRoot: function () { return this._layerInfo.isRootLayer() }, toggle: function () { this._layerInfo.setTopLayerVisible(!this.isToggledOn()) }, isToggledOn: function () { return this._layerInfo.isVisible() }, show: function () { this._layerInfo.show() }, hide: function () { this._layerInfo.hide() }, isVisible: function () { return this._layerInfo.isShowInMap() },
                                        traversal: function (r) { return this._layerInfo.traversal(function (l) { return r(l._adaptor) }) }, getNodeById: function (r) { var l = null; if (r = this._layerInfo.findLayerInfoById(r)) l = r._adaptor; return l }, getExtent: function () { return this._layerInfo.getExtent() }, getOpacity: function () { return this._layerInfo.getOpacity() }, setOpacity: function (r) { this._layerInfo.setOpacity(r) }, getServiceDefinition: function () { return this._layerInfo.getServiceDefinition() }, getLayerObject: function () { return this._layerInfo.getLayerObject() },
                                        getRootNode: function () { return this._layerInfo.getRootLayerInfo()._adaptor }, getParentNode: function () { var r = this._layerInfo.parentLayerInfo; return r ? r._adaptor : null }, getSubNodes: function () { return this._getNodesArrayFromInfosArray(this._layerInfo.getSubLayers()) }, getNodeLevel: function () { return this._layerInfo.getLayerLevel() }, getLayerType: function () { return this._layerInfo.getLayerType() }, getPopupInfoFromWebmap: function () { return this._layerInfo.getPopupInfo() }, getPopupInfo: function () { return this._layerInfo.getPopupInfoFromLayerObject() },
                                        loadPopupInfo: function () { return this._layerInfo.loadPopupInfo() }, getInfoTemplate: function () { return this._layerInfo.getInfoTemplate() }, loadInfoTemplate: function () { return this._layerInfo.loadInfoTemplate() }, getFilterFromWebmap: function () { return this._layerInfo.getFilterOfWebmap() }, getFilter: function () { return this._layerInfo.getFilter() }, setFilter: function (r) { this._layerInfo.setFilter(r) }, isShowLegend: function () { return this.isShowLegendFromWebmap() }, isShowLegendFromWebmap: function () { return this._layerInfo.getShowLegendOfWebmap() },
                                        isToggledOnLegendFromWebMap: function () { return this._layerInfo._getShowLegendOfWebmap() }, getUrl: function () { return this._layerInfo.getUrl() }, getRelatedNodes: function () { var r = new w; this._layerInfo.getRelatedTableInfoArray().then(A.hitch(this, function (l) { r.resolve(this._getNodesArrayFromInfosArray(l)) })); return r }, isVisibleAtMapScale: function () { return this._layerInfo.isInScale() }, enablePopup: function () { return this._layerInfo.enablePopup() }, disablePopup: function () { return this._layerInfo.disablePopup() },
                                        isPopupEnabled: function () { return this._layerInfo.isPopupEnabled() }, isItemLayer: function () { return this._layerInfo.isItemLayer() }, getItemInfo: function () { return this._layerInfo.getItemInfo() }, isHostedService: function () { return this._layerInfo.isHostedService() }, isHostedLayer: function () { return this._layerInfo.isHostedLayer() }, canShowLabel: function () { return this._layerInfo.canShowLabel() }, isLabelVisble: function () { return this._layerInfo.isShowLabels() }, showLabel: function () { this._layerInfo.showLabels() },
                                        hideLabel: function () { this._layerInfo.hideLabels() }, isTable: function () { return !!this._layerInfo.isTable }, isTiled: function () { return !!this._layerInfo.isTiled }, isBasemap: function () { return this._layerInfo.isBasemap() }, isEditable: function (r) { return this._layerInfo.isEditable(r) }, zoomTo: function (r) { return this._layerInfo.zoomTo(r) }, emitEvent: function (r) {
                                                try {
                                                        var l = null; switch (r) {
                                                                case "isVisibleChanged": l = v.EVENT_TOOGLE_CHANGE; break; case "isShowInMapChanged": l = v.EVENT_VISIBILITY_CHANGE; break; case "filterChanged": l =
                                                                        v.EVENT_FILTER_CHANGE; break; case "rendererChanged": l = v.EVENT_RENDERER_CHANGE; break; case "opacityChanged": l = v.EVENT_OPACITY_CHANGE; break; case "timeExtentChanged": l = v.EVENT_TIME_EXTENT_CHANGE
                                                        }l && this.emit(l)
                                                } catch (k) { console.error(k) }
                                        }, destroy: function () { this.inherited(arguments) }, _getNodesArrayFromInfosArray: function (r) { var l = []; q.forEach(r, function (k) { l.push(k._adaptor) }, this); return l }
                                }); A.mixin(v, {
                                        EVENT_TOOGLE_CHANGE: "toggle-change", EVENT_VISIBILITY_CHANGE: "visibility-change", EVENT_FILTER_CHANGE: "filter-change",
                                        EVENT_RENDERER_CHANGE: "renderer-change", EVENT_OPACITY_CHANGE: "opacity-change", EVENT_TIME_EXTENT_CHANGE: "time-extent-change"
                                }); return v
                        })
                }, "jimu/privilegeUtils": function () {
                        define(["dojo/Deferred", "esri/IdentityManager", "esri/request", "jimu/tokenUtils", "jimu/portalUrlUtils"], function (E, q, A, w, m) {
                                return {
                                        checkEssentialAppsLicense: function (v, r, l) {
                                                var k = m.getStandardPortalUrl(r.portalUrl), n = m.getSharingUrl(k), d = new E; (l ? q.checkAppAccess(n, "arcgisWebApps") : r.getItemById(v).then(function (c) {
                                                        return "public" ===
                                                                c.access ? { isPublicApp: !0 } : q.checkAppAccess(n, "arcgisWebApps")
                                                })).then(function (c) { r.getSigninSettingsOfSelfInfo().then(function (g) { g && g.blockedApps && g.blockedApps.indexOf && -1 < g.blockedApps.indexOf("webappbuilder") ? d.reject({ message: "wab is blocked by org admin", isBlockedByOrg: !0 }) : d.resolve(c) }, function (g) { d.reject({ message: g && g.message, isBlockedByOrg: !1 }) }) }, function (c) { d.reject({ message: c && c.message, isBlockedByOrg: !1 }) }); return d
                                        }, checkIsSelfOrigin: function (v, r, l) {
                                                var k = !0, n = m.getPortalUrlFromLocation();
                                                n = m.getStandardPortalUrl(n); v = m.getItemUrl(n, v); var d = window.location.host; n = w.userHaveSignInPortal(n); d = 0 <= ["www.arcgis.com", "devext.arcgis.com", "qaext.arcgis.com"].indexOf(d); var c = window.location !== window.parent.location; if (r.isPortal || l || d || n || c) r = new E, r.resolve(k); else return A({ url: v, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }).then(function (g) { g.contentOrigin && "self" !== g.contentOrigin && (k = !1); return k }); return r
                                        }
                                }
                        })
                }, "jimu/LayerInfos/RequestBuffer": function () {
                        define(["dojo/_base/declare",
                                "dojo/_base/lang", "dojo/Deferred"], function (E, q, A) {
                                        var w = E(null, { _realRequest: null, _buffer: null, constructor: function (m) { this._buffer = {}; this._realRequest = m ? m : function () { return new A } }, getRequest: function (m) { this._buffer[m] || (this._buffer[m] = new w.RequestProxy(this._realRequest, m)); return this._buffer[m] }, request: function (m) { var v = Array.prototype.slice.apply(arguments); v.splice(0, 1); var r = this.getRequest(m); return r.request.apply(r, v) }, setResponse: function (m, v) { this.getRequest(m).setResponse(v) }, isResolved: function (m) { return this.getRequest(m).isResolved() } });
                                        w.RequestProxy = E(null, {
                                                _key: null, _deferred: null, _realRequest: null, constructor: function (m, v) { this._realRequest = m; this._key = v }, request: function () { this._deferred || (this._deferred = new A, this._realRequest.apply(null, arguments).then(q.hitch(this, function (m) { this._deferred.resolve(m) }), q.hitch(this, function (m) { m && console.warn(m.message || m); m = this._deferred; this._deferred = null; m.resolve(null) }))); return this._deferred }, fakeRequest: function () { this._deferred || (this._deferred = new A); return this._deferred }, setResponse: function (m,
                                                        v) { this._deferred || (this._deferred = new A); null === m || void 0 === m ? (this._deferred.resolve(null), v && (this._deferred = null)) : this._deferred.resolve(m) }, isResolved: function () { return this._deferred && this._deferred.isResolved() }
                                        }); return w
                                })
                }, "jimu/LayerInfos/LayerInfoForMapService": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json dojo/aspect dojo/topic ./LayerInfo esri/request esri/layers/FeatureLayer esri/lang".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                return E(l,
                                        {
                                                _legendInfo: null, _sublayerIdent: null, controlPopupInfo: null, _jsapiLayerInfos: null, _oldFilter: null, _subLayerVisible: null, constructor: function () { }, init: function () { this._initJsapiLayerInfos(); this._initSubLayerVisible(); this._initSubLayerIdent(); this._initControlPopup(); this.inherited(arguments); this._initAfterRootLayerInfo(); this._needToRefresh().then(A.hitch(this, function (c) { c && (this.update(), this._getLayerInfosObj()._onLayersUpdated(this, this)) })) }, _initAfterRootLayerInfo: function () {
                                                        this.traversal(function (c) {
                                                                !c.isRootLayer() &&
                                                                c._initAfterRootLayerInfo && c._initAfterRootLayerInfo()
                                                        })
                                                }, _needToRefresh: function () { var c = new w; this.layerObject.dynamicLayerInfos && this.isRootLayer() && this.isItemLayer() && !this.originOperLayer.thematicGroup ? this.getItemInfo().then(A.hitch(this, function (g) { (g = (g = g.getItemData()) && g.thematicGroup) ? (this.originOperLayer.thematicGroup = g, c.resolve(!0)) : c.resolve(!1) })) : c.resolve(!1); return c }, _initOldFilter: function () {
                                                        this._oldFilter = this.layerObject && this.layerObject.layerDefinitions ? this.layerObject.layerDefinitions :
                                                                []
                                                }, _initJsapiLayerInfos: function () {
                                                        var c = q.filter(this.originOperLayer.layers, function (g) { return d.isDefined(g.id) && d.isDefined(g.name) && d.isDefined(g.minScale) && d.isDefined(g.maxScale) && d.isDefined(g.parentLayerId) && d.isDefined(g.defaultVisibility) }); this._jsapiLayerInfos = this.layerObject.dynamicLayerInfos ? this.originOperLayer.thematicGroup && this.originOperLayer.thematicGroup.layerIds && 0 <= this.originOperLayer.thematicGroup.layerIds.length ? q.filter(this.layerObject.dynamicLayerInfos, function (g) {
                                                                return -1 <
                                                                        this.originOperLayer.thematicGroup.layerIds.indexOf(g.id) ? !0 : !1
                                                        }, this) : this.layerObject.dynamicLayerInfos : 0 < c.length ? c : this.layerObject.layerInfos
                                                }, _cloneInfoTemplates: function (c) { var g = {}, b; for (b in c) if (c.hasOwnProperty(b) && "function" !== typeof c[b]) { var e = c[b]; e.infoTemplate && e.infoTemplate.toJson && (g[b] = { infoTemplate: new e.infoTemplate.constructor(e.infoTemplate.toJson()), layerUrl: e.layerUrl, resourceInfo: e.resourceInfo }) } return g }, _initControlPopup: function () {
                                                        this.controlPopupInfo = {
                                                                enablePopup: void 0,
                                                                infoTemplates: this._cloneInfoTemplates(this.layerObject.infoTemplates)
                                                        }; this.layerObject._infoTemplates = this._cloneInfoTemplates(this.layerObject.infoTemplates); v.after(this.layerObject, "setInfoTemplates", A.hitch(this, function () { this.layerObject._infoTemplates = this._cloneInfoTemplates(this.layerObject.infoTemplates); this.controlPopupInfo.infoTemplates = this._cloneInfoTemplates(this.layerObject.infoTemplates); this.traversal(function (c) { c._afterSetInfoTemplates && c._afterSetInfoTemplates() }) }))
                                                }, _initSubLayerIdent: function () {
                                                        this._sublayerIdent =
                                                        { definitions: {}, empty: !0, defLoad: new w }
                                                }, _initSubLayerVisible: function (c) { this._subLayerVisible = {}; for (var g = 0; g < this._jsapiLayerInfos.length; g++)this._subLayerVisible[this._jsapiLayerInfos[g].id] = !1; c ? q.forEach(c, function (b) { this._subLayerVisible[b] = !0 }, this) : this.originOperLayer.visibleLayers ? q.forEach(this.originOperLayer.visibleLayers, function (b) { this._subLayerVisible[b] = !0 }, this) : q.forEach(this._jsapiLayerInfos, function (b) { b.defaultVisibility && (this._subLayerVisible[b.id] = !0) }, this) }, _initVisible: function () {
                                                        this._visible =
                                                        this.originOperLayer.layerObject.visible
                                                }, _setTopLayerVisible: function (c) { this.originOperLayer.layerObject.setVisibility(c); this._visible = c }, _setSubLayerVisible: function (c) {
                                                        var g = [-1, -1, -1], b = [], e = q.filter(this.originOperLayer.layerObject.visibleLayers, function (p) { return -1 !== p }); q.forEach(e, function (p) { if (!this._isGroupLayerBySubId(p)) { var B = this._subLayerInfoIndex[p]; B && B._isAllSubLayerVisibleOnPath() && b.push(p) } }, this); e = b; for (var a in c) if (c.hasOwnProperty(a) && "function" !== typeof c[a]) {
                                                                var f = Number(a);
                                                                if (c[a]) { var h = q.indexOf(e, f); 0 > h && e.push(f) } else h = q.indexOf(e, f), 0 <= h && e.splice(h, 1)
                                                        } g = g.concat(e); this.originOperLayer.layerObject.setVisibleLayers(g)
                                                }, _resetLayerObjectVisiblity: function (c) { var g = c ? c[this.id] : null, b = !1; if (c && (g && this.layerObject.setVisibility(g.visible), "esri.layers.ArcGISDynamicMapServiceLayer" === this.layerObject.declaredClass)) { g = {}; for (var e in c) c.hasOwnProperty(e) && "function" !== typeof c[e] && (b = !0, g[e] = c[e].visible); b && this._setSubLayerVisibleByCheckedInfo(g) } }, _setSubLayerVisibleByCheckedInfo: function (c) {
                                                        var g =
                                                                []; q.forEach(this._jsapiLayerInfos, function (e) { var a = this.id + "_" + e.id; d.isDefined(c[a]) ? c[a] && g.push(e.id) : this._subLayerVisible[e.id] && g.push(e.id) }, this); this._initSubLayerVisible(g); this.traversal(function (e) { e._initVisible() }); var b = {}; this.traversal(function (e) { 0 !== e.getSubLayers().length || e.isRootLayer() || (b[e.originOperLayer.mapService.subId] = e._isAllSubLayerVisibleOnPath()) }); this._setSubLayerVisible(b)
                                                }, _subLayerVisibleChanged: function () {
                                                        var c = []; this.traversal(function (g) { c.push(g) }); r.publish("layerInfos/layerInfo/visibleChanged",
                                                                c)
                                                }, obtainNewSubLayers: function () {
                                                        var c = [], g = this.originOperLayer.layerObject, b = null; b = "esri.layers.ArcGISDynamicMapServiceLayer" === g.declaredClass ? "dynamic" : "tiled"; q.forEach(this._jsapiLayerInfos, function (a) { this._addNewSubLayer(c, g.url + "/" + a.id, g.id + "_" + a.id, a, a.subLayerIds && 0 < a.subLayerIds.length ? b + "_group" : b) }, this); var e = []; q.forEach(this._jsapiLayerInfos, function (a, f) { a = a.parentLayerId; if (-1 !== a) { for (var h = null, p = 0; p < c.length; p++)if (c[p].mapService.subId === a) { h = c[p]; break } (a = h) && a.subLayers.push(c[f]) } },
                                                                this); q.forEach(this._jsapiLayerInfos, function (a, f) { -1 === a.parentLayerId && (a = this._layerInfoFactory.create(c[f]), e.push(a), a.init()) }, this); return e
                                                }, _addNewSubLayer: function (c, g, b, e, a) {
                                                        var f = e.source && e.source.mapLayerId; if (void 0 === f || null === f) f = e.id; var h = this.getMSShipFeatureLayer(g, e.id); c.push({
                                                                layerObject: { url: g, empty: !0 }, title: e.name || e.id || " ", id: b || "-", subId: e.id, subLayers: [], mapService: { layerInfo: this, subId: e.id, mapServiceSubId: f }, selfType: h ? "mapservice_" + a + "_ship_featurelayer" : "mapservice_" +
                                                                        a, msShipFLayerId: h && h.id, parentLayerInfo: this
                                                        })
                                                }, _handleErrorSubLayer: function (c, g, b, e, a, f) { c[g] = { layerObject: null, title: f.name || f.id || " ", id: b || " ", subLayers: [], mapService: { layerInfo: this, subId: e } } }, getMSShipFeatureLayer: function (c, g) {
                                                        var b = null, e = c.indexOf("/MapServer"); if (-1 < e) {
                                                                var a = this.map.graphicsLayerIds.map(A.hitch(this, function (h) { return this.map.getLayer(h) })), f = c.substring(0, e + 1); a.some(A.hitch(this, function (h) {
                                                                        var p = h.url; return p && -1 < p.indexOf(f + "FeatureServer/" + g) && h && !h.empty && h.mode ===
                                                                                n.MODE_SELECTION && !A.getObject("_wabProperties.isMSOwnedFeatureLayer", !1, h) ? (b = h, !0) : !1
                                                                }))
                                                        } return b
                                                }, getLegendInfo: function (c) { var g = new w; this._legendInfo ? g.resolve(this._legendInfo) : this._legendRequest(c).then(A.hitch(this, function (b) { this._legendInfo = b.layers; g.resolve(this._legendInfo) }), function () { g.reject() }); return g }, _legendRequest: function (c) { return 10.01 <= this.layerObject.version ? this._legendRequestServer() : this._legendRequestTools(c) }, _legendRequestServer: function () {
                                                        var c = this.layerObject.url +
                                                                "/legend", g = { f: "json" }; this.layerObject._params.dynamicLayers && (g.dynamicLayers = m.stringify(this._createDynamicLayers(this.layerObject)), "[{}]" === g.dynamicLayers && (g.dynamicLayers = "[]")); return k({ url: c, content: g, handleAs: "json", callbackParamName: "callback" })
                                                }, _legendRequestTools: function (c) { return k({ url: c + "sharing/tools/legend?soapUrl\x3d" + this.layerObject.url, content: { f: "json" }, handleAs: "json", callbackParamName: "callback" }) }, _createDynamicLayers: function (c) {
                                                        var g = [], b; q.forEach(c.dynamicLayerInfos ||
                                                                c.layerInfos, function (e) { b = { id: e.id }; b.source = e.source && e.source.toJson(); var a; c.layerDefinitions && c.layerDefinitions[e.id] && (a = c.layerDefinitions[e.id]); a && (b.definitionExpression = a); var f; c.layerDrawingOptions && c.layerDrawingOptions[e.id] && (f = c.layerDrawingOptions[e.id]); f && (b.drawingInfo = f.toJson()); b.minScale = e.minScale || 0; b.maxScale = e.maxScale || 0; g.push(b) }); return g
                                                }, _getServiceDefinition: function () { var c = this.getUrl(); return this._serviceDefinitionBuffer.getRequest(this.subId).request(c) },
                                                _getSubserviceDefinition: function (c) { return 10.11 <= this.layerObject.version ? this._getAllLayerAndTable(c) : this._getLayerAndTable(c) }, _getAllLayerAndTable: function (c) {
                                                        var g = this.layerObject.url + "/layers", b = this._serviceDefinitionBuffer.getRequest("_all_layer_and_table_request"); b.isResolved() || b.request(g).then(A.hitch(this, function (e) {
                                                                e || (e = { layers: [] }); this.traversal(A.hitch(this, function (a) {
                                                                        if (!a.isRootLayer()) {
                                                                                var f = a.originOperLayer.mapService.mapServiceSubId; a = this._serviceDefinitionBuffer.getRequest(f);
                                                                                var h = null; q.some(e.layers, function (p) { if (p.id === f) return h = p, !0 }, this); a.setResponse(h)
                                                                        }
                                                                }))
                                                        })); return this._serviceDefinitionBuffer.getRequest(c).fakeRequest()
                                                }, _getLayerAndTable: function (c) { var g = this.layerObject.url + "/" + c; return this._serviceDefinitionBuffer.getRequest(c).request(g) }, _getSublayerSettingOfWebmap: function (c) { var g = q.filter(this.originOperLayer.layers, function (b) { return b.id === c }); return 1 === g.length ? g[0] : null }, _getSublayerShowLegendOfWebmap: function (c) {
                                                        return (c = this._getSublayerSettingOfWebmap(c)) ?
                                                                void 0 !== c.showLegend ? c.showLegend : !0 : !0
                                                }, _idIsInJsapiLayerInfos: function (c) { return null === this._getJsapiLayerInfoById(c) ? !1 : !0 }, _getJsapiLayerInfoById: function (c) { for (var g = null, b = 0; b < this._jsapiLayerInfos.length; b++)if (this._jsapiLayerInfos[b].id === c) { g = this._jsapiLayerInfos[b]; break } return g }, _isGroupLayerBySubId: function (c) { return (c = this._getJsapiLayerInfoById(c)) && c.subLayerIds && 0 < c.subLayerIds.length ? !0 : !1 }, _bindEvent: function () {
                                                        this.inherited(arguments); if (this.layerObject && !this.layerObject.empty) {
                                                                var c =
                                                                        this.layerObject.on("visible-layers-change", A.hitch(this, this._onVisibleLayersChanged)); this._eventHandles.push(c); c = v.after(this.layerObject, "setLayerDefinitions", A.hitch(this, this._onFilterChanged)); this._eventHandles.push(c)
                                                        }
                                                }, _onVisibleLayersChanged: function (c) {
                                                        var g = c.visibleLayers; if (-1 === g[0] && -1 === g[1] && -1 === g[2]) this._subLayerVisibleChanged(), this._isShowInMapChanged2(); else {
                                                                c = []; var b = [-1, -1, -1]; g = this._converVisibleLayers(g); c = g.visibleLayersForUpdateSubLayerVisible; b = b.concat(g.visibleLayersForSetVisibleLayers);
                                                                this._initSubLayerVisible(c); this.traversal(function (e) { e._initVisible() }); this.layerObject.setVisibleLayers(b)
                                                        }
                                                }, _converVisibleLayers: function (c) {
                                                        var g = { visibleLayersForUpdateSubLayerVisible: [], visibleLayersForSetVisibleLayers: [] }; q.forEach(c, function (b) { var e = this.findLayerInfoById(this.id + "_" + b); if (this._isGroupLayerBySubId(b)) e.traversal(function (a) { c.push(a.originOperLayer.mapService.subId) }); else for (; e && e.originOperLayer.mapService;)c.push(e.originOperLayer.mapService.subId), e = e.parentLayerInfo },
                                                                this); q.forEach(c, function (b) { 0 <= b && 0 > g.visibleLayersForUpdateSubLayerVisible.indexOf(b) && g.visibleLayersForUpdateSubLayerVisible.push(b) }, this); q.forEach(g.visibleLayersForUpdateSubLayerVisible, function (b) { this._isGroupLayerBySubId(b) || g.visibleLayersForSetVisibleLayers.push(b) }, this); return g
                                                }, _onFilterChanged: function () {
                                                        for (var c, g = [], b = this.layerObject.layerDefinitions, e = b.length > this._oldFilter.length ? b.length : this._oldFilter.length, a = 0; a < e; a++)(b[a] ? b[a] : null) !== (this._oldFilter[a] ? this._oldFilter[a] :
                                                                null) && (c = this.findLayerInfoById(this.id + "_" + a)) && c.isLeaf() && g.push(c); 0 < g.length && (r.publish("layerInfos/layerInfo/filterChanged", g, A.getObject("_wabProperties.objectPassWithFilterChangeEvent", !0, this.layerObject)), this._oldFilter = b, A.setObject("_wabProperties.objectPassWithFilterChangeEvent", {}, this.layerObject))
                                                }
                                        })
                        })
                }, "jimu/LayerInfos/LayerInfoForKML": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/topic ./LayerInfo ./LayerInfoForDefault jimu/utils dojo/Deferred esri/lang".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d) {
                                        return E(r, {
                                                constructor: function () { }, _getExtentAsync: function () { var c = this.layerObject.getLayers(), g = null, b = null; if (0 < c.length && "esri.layers.KMLLayer" === c[0].declaredClass) { var e = []; this.traversal(A.hitch(this, function (a) { a.id !== this.id && "esri.layers.KMLLayer" === a.layerObject.declaredClass && e.push(a) })); q.forEach(e, function (a) { b = a._getExtentAsync(); g = g ? g.union(b) : b }, this) } else q.forEach(c, function (a) { b = k.graphicsExtent(a.graphics); g = g ? g.union(b) : b }, this); return g },
                                                _getExtent: function () { var c = new n; c.resolve(this._getExtentAsync()); return c }, _resetLayerObjectVisiblity: function (c) { var g = c ? c[this.id] : null; if (g) { var b = {}, e; for (e in c) c.hasOwnProperty(e) && "function" !== typeof c[e] && (b[e] = c[e].visible); this._setSubLayerVisibleByCheckedInfo(b); this._setTopLayerVisible(g.visible) } }, _setSubLayerVisibleByCheckedInfo: function (c) { this.traversal(A.hitch(this, function (g) { d.isDefined(c[g.id]) && g._setTopLayerVisible(c[g.id]) })) }, _initVisible: function () { this._visible = this.originOperLayer.layerObject.visible },
                                                _setTopLayerVisible: function (c) { c ? this.layerObject.show() : this.layerObject.hide() }, obtainNewSubLayers: function () { var c = []; q.forEach(this._getOperLayerByParentFolderId(-1, this), function (g) { g = this._layerInfoFactory.create(g); c.push(g); g.init() }, this); return c }, _getOperLayerByParentFolderId: function (c, g) {
                                                        var b = [], e = this.layerObject.getLayers() || [], a = q.filter(this.layerObject.folders || [], function (h) { return h.parentFolderId === c ? !0 : !1 }), f = []; f = 0 === a.length ? q.filter(e, function (h) {
                                                                return this._flag.kmzSubLayersWereHandled ?
                                                                        !1 : !0
                                                        }, this) : a; q.forEach(f, function (h) {
                                                                if ("esri.layers.KMLFolder" === h.declaredClass) var p = { layerObject: h, title: h.label || h.title || h.name || "\x26lt;no name\x26gt;", id: this._getSubLayerInfoIdForSubFolder(h), subId: h.id, kml: { layerInfo: this, currentFolder: h }, selfType: "kml", parentLayerInfo: g }; else "esri.layers.KMLLayer" === h.declaredClass ? (p = A.getObject("linkInfo.name", !1, h), p = {
                                                                        layerObject: h, title: h.label || h.title || p || h.name || h.id || " ", id: h.id || "-", subId: h.id || "-", kml: { layerInfo: this, currentFolder: null }, selfType: "kml",
                                                                        parentLayerInfo: g
                                                                }, A.setObject("_wabProperties.kmllayerWasHandled", !0, h), this._flag.kmzSubLayersWereHandled = !0) : (A.setObject("_wabProperties.kmllayerWasHandled", !0, h), A.setObject("_wabProperties.isTemporaryLayer", !0, h)); p && b.push(p)
                                                        }, this); return b
                                                }, _getAllSubLayerObject: function () { var c = []; this.traversal(A.hitch(this, function (g) { g.layerObject && g.layerObject.getLayers && (c = c.concat(g.layerObject.getLayers())) })); return c }, _getSubLayerInfoIdForSubFolder: function (c) { return this.id + "_folder_" + c.id }, _needToRenew: function () {
                                                        return q.some(this._getAllSubLayerObject(),
                                                                function (c) { if (!A.getObject("_wabProperties.kmllayerWasHandled", !1, c)) return !0 }, this)
                                                }, _bindEvent: function () { this.inherited(arguments); if (this.layerObject && !this.layerObject.empty) { var c = m.after(this.layerObject, "setFolderVisibility", A.hitch(this, this._onSubFolderVisibleChanged), !0); this._eventHandles.push(c) } }, _onSubFolderVisibleChanged: function (c) { c = this._getSubLayerInfoIdForSubFolder(c); (c = this.findLayerInfoById(c)) && v.publish("layerInfos/layerInfo/visibleChanged", [c]) }
                                        })
                                })
                }, "jimu/LayerInfos/LayerInfoForDefault": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/dom-class dojo/aspect jimu/portalUrlUtils jimu/portalUtils jimu/utils esri/symbols/jsonUtils esri/layers/LabelLayer esri/layers/LabelClass esri/dijit/PopupTemplate esri/dijit/Legend esri/graphic esri/geometry/Point esri/tasks/query esri/tasks/RelationshipQuery esri/tasks/QueryTask".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x) {
                                        return E(v, {
                                                _legendsNode: null, controlPopupInfo: null, constructor: function () { this._initControlPopup(); this._updateLayerObjectName(); try { this._initToShowLabels() } catch (y) { console.warn(y.message) } }, _updateLayerObjectName: function () {
                                                        if (this.layerObject && !this.layerObject.empty && this.layerObject.name && !A.getObject("_wabProperties.originalLayerName", !1, this.layerObject)) {
                                                                A.setObject("_wabProperties.originalLayerName", this.layerObject.name, this.layerObject);
                                                                this.layerObject.name = this.title; if (void 0 === this.layerObject.arcgisProps || null === this.layerObject.arcgisProps) this.layerObject.arcgisProps = {}; A.setObject("arcgisProps.title", this.title, this.layerObject)
                                                        }
                                                }, _initToShowLabels: function () {
                                                        var y = A.getObject("_wabProperties.itemLayerInfo", !1, this.layerObject); y && !this.layerObject.empty && g.getPortal(y.portalUrl).getItemData(y.itemId).then(A.hitch(this, function (D) {
                                                                var H; D && D.layers && (q.some(D.layers, function (I) {
                                                                        return I.id === this.layerObject.layerId ? (H = I,
                                                                                !0) : !1
                                                                }, this), H && H.showLabels && ((D = A.getObject("layerDefinition.drawingInfo.labelingInfo", !1, H)) && !this.layerObject.labelingInfo && this.layerObject.setLabelingInfo && (D = q.map(D, function (I) { return new f(I) }, this), this.layerObject.setLabelingInfo(D)), this.showLabels()))
                                                        }), A.hitch(this, function (D) { D && D.message && console.log(D.message) }))
                                                }, _initOldFilter: function () {
                                                        this._oldFilter = this.layerObject && !this.layerObject.empty && this.layerObject.getDefinitionExpression ? this.layerObject.getDefinitionExpression() :
                                                                null
                                                }, _getLayerOptionsForCreateLayerObject: function () { var y = {}; y.id = this.id; var D = [], H = this.getInfoTemplate(); H && H.info && H.info.fieldInfos ? q.forEach(H.info.fieldInfos, function (I) { I.visible && D.push(I.fieldName) }, this) : D = ["*"]; y.outFields = D; return y }, _getExtent: function () {
                                                        var y = new w; var D = this.layerObject.graphics && 0 < this.layerObject.graphics.length ? b.graphicsExtent(this.layerObject.graphics) : this.layerObject.fullExtent || this.layerObject.initialExtent; this.layerObject.url ? this.getServiceDefinition().then(A.hitch(this,
                                                                function (H) {
                                                                        var I = new x(this.layerObject.url), N = new u, T = this.getFilter(); N.where = T ? T : "1\x3d1"; N.outSpatialReference = this.map.spatialReference; N.returnGeometry = !0; H && H.advancedQueryCapabilities && H.advancedQueryCapabilities.supportsReturningQueryExtent ? I.executeForExtent(N, A.hitch(this, function (M) { var R = M.extent; 1 === M.count && "esriGeometryPoint" === this.layerObject.geometryType && (M = new t(M.extent.xmin, M.extent.ymin, M.extent.spatialReference), R = b.graphicsExtent([new B(M)])); y.resolve(R) }), A.hitch(this,
                                                                                function () { y.resolve(D); console.log("executeForExtent failed.") })) : this.getSupportTableInfo().then(A.hitch(this, function (M) { M.isSupportQuery ? I.execute(N).then(A.hitch(this, function (R) { R = b.graphicsExtent(R.features); y.resolve(R) }), A.hitch(this, function () { y.resolve(D); console.log("query execute failed.") })) : y.resolve(D) }))
                                                                })) : y.resolve(D); return y
                                                }, _resetLayerObjectVisiblity: function (y) {
                                                        y = y ? y[this.id] : null; !this.originOperLayer.collection && y && (this.layerObject.setVisibility(y.visible), this._visible =
                                                                this.layerObject.visible)
                                                }, _initVisible: function () { var y = !1; if (this.originOperLayer.collection && this._notFirstInitVisilbeFlag) { y = this.originOperLayer.collection.layerInfo; var D = this.layerObject.visible; if (y._oldIsShowInMap !== y.isShowInMap()) return; this._visible = D ? !0 : !1; y._onVisibilityChanged() } else this._visible = y = this.originOperLayer.layerObject.visible; this._notFirstInitVisilbeFlag = !0 }, _setTopLayerVisible: function (y) {
                                                        this.originOperLayer.collection ? this.originOperLayer.collection.layerInfo._visible ?
                                                                y ? (this.layerObject.show(), this._visible = !0) : (this.layerObject.hide(), this._visible = !1) : y ? (this.layerObject.hide(), this._visible = !0) : (this.layerObject.hide(), this._visible = !1) : (y ? this.layerObject.show() : this.layerObject.hide(), this._visible = y)
                                                }, setLayerVisiblefromTopLayer: function () { this.originOperLayer.collection.layerInfo._visible ? this._visible && this.layerObject.show() : this.layerObject.hide() }, _prepareCheckedInfoForShowOrHide: function (y) {
                                                        for (var D = {}, H = this; H.parentLayerInfo;)D[H.id] = y, H = H.parentLayerInfo;
                                                        return D
                                                }, show: function () { if (this.isRootLayer()) this._setTopLayerVisible(!0); else { var y = this.getRootLayerInfo(); if (y._setSubLayerVisibleByCheckedInfo) { var D = this._prepareCheckedInfoForShowOrHide(!0); y._setSubLayerVisibleByCheckedInfo(D); y.show() } } }, _initControlPopup: function () {
                                                        this.controlPopupInfo = { enablePopup: this.layerObject.infoTemplate ? !0 : !1, infoTemplate: this.layerObject.infoTemplate }; this.layerObject._infoTemplate = this.layerObject.infoTemplate; var y = d.after(this.layerObject, "setInfoTemplate",
                                                                A.hitch(this, function () { this.layerObject._infoTemplate = this.layerObject.infoTemplate; this.controlPopupInfo.infoTemplate = this.layerObject.infoTemplate; this.controlPopupInfo.enablePopup || (this.layerObject.infoTemplate = null) })); this._eventHandles.push(y)
                                                }, _getServiceDefinition: function () { var y; (y = this.getUrl()) && this.isRootLayer() && "esri.layers.FeatureLayer" === this.layerObject.declaredClass ? y = this._serviceDefinitionBuffer.getRequest(this.subId).request(y) : (y = new w, y.resolve(null)); return y }, createLegendsNode: function () {
                                                        var y =
                                                                l.create("div", { "class": "legends-div jimu-legends-div-flag jimu-leading-margin1", legendsDivId: this.id }, document.body); l.create("img", { "class": "legends-loading-img", src: require.toUrl("jimu") + "/images/loading.gif" }, y); return y
                                                }, drawLegends: function (y) { this._initLegendsNodeByLegendDijit(y) }, _initLegendsNodeByLegendDijit: function (y) {
                                                        if (this.layerObject && !this.layerObject.empty && (!this.originOperLayer.subLayer || 0 === this.originOperLayer.subLayers.length) && this.layerObject.loaded) {
                                                                l.empty(y); n.remove(y,
                                                                        "jimu-legends-div-flag"); var D = new p({ map: this.map, layerInfos: [{ layer: this.layerObject }], arrangement: p.ALIGN_LEFT, respectCurrentMapScale: !1, respectVisibility: !1 }, l.create("div", {}, y)); D.startup(); y._legendDijit = D
                                                        }
                                                }, _initLegendsNode: function (y) {
                                                        var D = [], H = this.layerObject; !this.layerObject || this.layerObject.empty || this.originOperLayer.subLayer && 0 !== this.originOperLayer.subLayers.length || (l.empty(y), H.renderer && (H.renderer.infos ? D = A.clone(H.renderer.infos) : D.push({ label: H.renderer.label, symbol: H.renderer.symbol }),
                                                                H.renderer && H.renderer.defaultSymbol && 0 < D.length && D.push({ label: H.renderer.defaultLabel || "others", symbol: H.renderer.defaultSymbol }), q.forEach(D, function (I) {
                                                                        I.legendDiv = l.create("div", { "class": "legend-div" }, y); I.symbolDiv = l.create("div", { "class": "legend-symbol jimu-float-leading" }, I.legendDiv); I.labelDiv = l.create("div", { "class": "legend-label jimu-float-leading", innerHTML: b.sanitizeHTML(I.label) || " " }, I.legendDiv); if ("textsymbol" === I.symbol.type) k.set(I.symbolDiv, "innerHTML", b.sanitizeHTML(I.symbol.text));
                                                                        else { var N = r.createSurface(I.symbolDiv, 50, 50); I = e.getShapeDescriptors(I.symbol); N.createShape(I.defaultShape).setFill(I.fill).setStroke(I.stroke).setTransform(r.matrix.translate(25, 25)) }
                                                                }, this)))
                                                }, obtainNewSubLayers: function () { var y = []; q.forEach(this.originOperLayer.subLayers, function (D) { D.parentLayerInfo = this; D = this._layerInfoFactory.create(D); y.push(D); D.init() }, this); return y }, _isAllSubLayerVisibleOnPath: function () { for (var y = !0, D = this; !D.isRootLayer();)y = y && D.isVisible(), D = D.parentLayerInfo; return y },
                                                _getCustomPopupInfo: function (y, D) { var H = null; y && y.fields && (H = { title: y.name, fieldInfos: [], description: null, showAttachments: !0, mediaInfos: [] }, q.forEach(y.fields, function (I) { var N = !1; D ? q.some(D, A.hitch(this, function (T) { return T && I.name.toLowerCase() === T.toLowerCase() })) && (N = !0) : N = !0; N && (N = b.getDefaultPortalFieldInfo(I), N.visible = !0, N.isEditable = I.editable, H.fieldInfos.push(N)) }, this)); return H }, _getDefaultPopupInfo: function (y) {
                                                        if (y = this._getCustomPopupInfo(y)) y.fieldInfos = q.filter(y.fieldInfos, A.hitch(this,
                                                                function (D) { return (D = D.fieldName && D.fieldName.toLowerCase()) && 0 > D.indexOf("object") && 0 > D.indexOf("globalid") && 0 > D.indexOf("shape") && 0 > D.indexOf("perimeter") ? !0 : !1 })); return y
                                                }, _getDefaultPopupTemplate: function (y) { var D = null; (y = this.getPopupInfo() || this._getDefaultPopupInfo(y)) && (D = new h(y)); return D }, enablePopup: function () {
                                                        return this.loadInfoTemplate().then(A.hitch(this, function () {
                                                                return this.controlPopupInfo.infoTemplate ? (this.controlPopupInfo.enablePopup = !0, this.layerObject.infoTemplate = this.controlPopupInfo.infoTemplate,
                                                                        !0) : !1
                                                        }))
                                                }, disablePopup: function () { this.controlPopupInfo.enablePopup = !1; this.layerObject.infoTemplate = null }, isPopupEnabled: function () { return this.controlPopupInfo && this.controlPopupInfo.enablePopup ? !0 : !1 }, isSupportPopup: function () { var y = new w; this.loadInfoTemplate().then(A.hitch(this, function (D) { D ? y.resolve(!0) : y.resolve(!1) })); return y }, loadInfoTemplate: function () {
                                                        var y = new w; this.controlPopupInfo.infoTemplate ? y.resolve(this.controlPopupInfo.infoTemplate) : this.getLayerObject().then(A.hitch(this,
                                                                function () { this.controlPopupInfo.infoTemplate = this._getDefaultPopupTemplate(this.layerObject); y.resolve(this.controlPopupInfo.infoTemplate) }), A.hitch(this, function () { y.resolve(null) })); return y
                                                }, getInfoTemplate: function () { return this.controlPopupInfo.infoTemplate }, _getRelatedUrls: function (y, D) {
                                                        var H = []; if (!y || !y.url || !y.relationships) return H; var I = y.url.lastIndexOf("/"), N = y.url.slice(0, I); q.forEach(y.relationships, function (T) {
                                                                D && T.role && "esriRelCardinalityManyToMany" !== T.cardinality && D !== T.role ||
                                                                H.push(N + "/" + T.relatedTableId.toString())
                                                        }, this); return H
                                                }, getRelatedTableInfoArray: function (y) {
                                                        var D = [], H = new w; this.getLayerObject().then(A.hitch(this, function (I) {
                                                                var N = this._getRelatedUrls(I, y); 0 !== N.length && this._getLayerInfosObj().traversalAll(A.hitch(this, function (T) {
                                                                        if (0 === N.length) return !0; q.forEach(N, function (M, R) {
                                                                                A.getObject("layerObject.url", !1, T) && M && c.removeProtocol(M.toString().toLowerCase()).replace(/\/+/g, "/") === c.removeProtocol(T.layerObject.url.toString().toLowerCase()).replace(/\/+/g,
                                                                                        "/") && (D.push(T), N[R] = "")
                                                                        }, this); return !1
                                                                })); H.resolve(D)
                                                        }), A.hitch(this, function () { H.resolve(D) })); return H
                                                }, _getOrderByFields: function (y) { var D = null; if (void 0 === y || null === y) return D; var H = this.getPopupInfo(); H && H.relatedRecordsInfo && H.relatedRecordsInfo.orderByFields && q.some(H.relatedRecordsInfo.orderByFields, function (I) { var N = I.field.split("/"); if (N[1] === y.toString()) return D = [N[2] + " " + I.order], !0 }, this); return D }, getOriRelationshipByDestLayer: function (y, D, H) {
                                                        var I = null; y = q.filter(y.relationships,
                                                                function (N) { if (N.relatedTableId === D.layerId) return !0 }, this); return I = y[H] ? y[H] : y[0]
                                                }, getRelatedRecords: function (y, D, H) {
                                                        var I = new w, N = new z, T = this.getLayerObject(), M = D.getLayerObject(); m({ originalLayerObject: T, relatedLayerObject: M }).then(A.hitch(this, function (R) {
                                                                R.originalLayerObject && R.relatedLayerObject || I.resolve([]); R = this.getOriRelationshipByDestLayer(this.layerObject, R.relatedLayerObject, H); N.outFields = ["*"]; N.relationshipId = R && R.id; var ca = y.attributes[this.layerObject.objectIdField]; N.objectIds =
                                                                        [ca]; N.definitionExpression = D.getFilter(); N.orderByFields = this._getOrderByFields(R && R.id); this.layerObject.queryRelatedFeatures(N, A.hitch(this, function (K) { (K = K[ca] && K[ca].features) ? I.resolve(K) : I.resolve([]) }), A.hitch(this, function () { I.resolve([]) }))
                                                        })); return I
                                                }, getFilter: function () { return this.layerObject && !this.layerObject.empty && this.layerObject.getDefinitionExpression ? this.layerObject.getDefinitionExpression() : null }, setFilter: function (y, D) {
                                                        this.layerObject && !this.layerObject.empty && this.layerObject.setDefinitionExpression &&
                                                        (D = A.mixin({}, D), A.setObject("_wabProperties.objectPassWithFilterChangeEvent", D, this.layerObject), this.layerObject.setDefinitionExpression(y))
                                                }, _isAlreadyInLabelLayerOfMap: function (y) { var D = !1; y && (D = q.some(y.getFeatureLayers(), function (H) { return this.id === H.id }, this)); return D }, _addToLabelLayerOfMap: function () { var y = this.getLabelLayerOfMap(); y && !this._isAlreadyInLabelLayerOfMap(y) && (y.addFeatureLayer(this.layerObject), this.map.removeLayer(y), this.map.addLayer(y)) }, _removeFromLabelLayerOfMap: function () { this.getLabelLayerOfMap().removeFeatureLayer(this.id) },
                                                _isSupportLabelControl: function () { return this.isRootLayer() && !this.layerObject.empty && "esri.layers.FeatureLayer" === this.layerObject.declaredClass && this.layerObject.labelingInfo && 0 < this.layerObject.labelingInfo.length ? !0 : !1 }, getLabelLayerOfMap: function () { if (this.map._labels) var y = this.map._labels; else y = this.map.getLayer("labels"), y || (y = new a({ id: "labels" }), this.map.addLayer(y)); return y }, obtainLabelControl: function () {
                                                        var y = this.id + "_labelLayer", D = this.map.getLayer(y); if (!D && this._isSupportLabelControl()) {
                                                                var H =
                                                                        this.getLabelLayerOfMap(); H && this._isAlreadyInLabelLayerOfMap(H) && (D = new a({ id: y }), D.addFeatureLayer(this.layerObject), this.map.addLayer(D), this._removeFromLabelLayerOfMap())
                                                        } return D ? D : null
                                                }, restoreLabelControl: function () { this._isSupportLabelControl() && (this.destroyRealtedLabelLayer(), this._addToLabelLayerOfMap()) }, destroyRealtedLabelLayer: function () { var y = this.map.getLayer(this.id + "_labelLayer"); y && this.map.removeLayer(y) }, destroyLabelLayer: function () {
                                                        this.map.getLayer(this.id) || (this._removeFromLabelLayerOfMap(),
                                                                this.destroyRealtedLabelLayer())
                                                }, canShowLabel: function () { return this._isSupportLabelControl() }, isShowLabels: function () { var y = this.map.getLayer(this.id + "_labelLayer"), D = this.getLabelLayerOfMap(); return this._isSupportLabelControl() && (y || D && this._isAlreadyInLabelLayerOfMap(D)) ? this.layerObject.showLabels : !1 }, showLabels: function () { this._isSupportLabelControl() && this.layerObject.setShowLabels && (this.map.getLayer(this.id + "_labelLayer") || this._addToLabelLayerOfMap(), this.layerObject.setShowLabels(!0)) },
                                                hideLabels: function () { this._isSupportLabelControl() && this.layerObject.setShowLabels && this.layerObject.setShowLabels(!1) }
                                        })
                                })
                }, "esri/layers/LabelLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/i18n!dojo/cldr/nls/number dojo/number dojo/has dojox/gfx/_base ../kernel ../lang ../graphic ../PopupInfo ../ArcadeExpression ../core/timerUtils ../symbols/TextSymbol ../symbols/ShieldLabelSymbol ../geometry/Extent ../geometry/Point ../geometry/webMercatorUtils ../renderers/SimpleRenderer ../arcadeProfiles/labelingProfile ./labelLayerUtils/DynamicLabelClass ./labelLayerUtils/StaticLabelClass ./GraphicsLayer ./LabelClass".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y) {
                                        function D(H) { return "sizeInfo" === H.type } E = E(x, {
                                                declaredClass: "esri.layers.LabelLayer", constructor: function (H) { this._refreshLabels = q.hitch(this, this._refreshLabels); this.id = "labels"; this.featureLayers = []; this._featureLayerInfos = []; this._preparedLabels = []; this._engineType = "STATIC"; this._mapEventHandlers = []; H && (H.id && (this.id = H.id), H.mode && (this._engineType = "DYNAMIC" === H.mode.toUpperCase() ? "DYNAMIC" : "STATIC")) }, _setMap: function (H) {
                                                        this._mapEventHandlers.push(H.on("extent-change",
                                                                q.hitch(this, "_handleLevelChange"))); var I = this.inherited(arguments); this.refresh(); return I
                                                }, _unsetMap: function () { var H; for (H = 0; H < this._mapEventHandlers.length; H++)w.disconnect(this._mapEventHandlers[H]); this.refresh(); b.clearTimeout(this._refreshHandle); this._refreshHandle = null; this.inherited(arguments) }, setAlgorithmType: function (H) { this._engineType = H && "DYNAMIC" === H.toUpperCase() ? "DYNAMIC" : "STATIC"; this.refresh() }, addFeatureLayer: function (H, I, N, T) {
                                                        if (!this.getFeatureLayer(H.layerId)) {
                                                                var M = []; M.push(H.on("update-end",
                                                                        q.hitch(this, "refresh"))); M.push(H.on("suspend", q.hitch(this, "refresh"))); M.push(H.on("resume", q.hitch(this, "refresh"))); M.push(H.on("edits-complete", q.hitch(this, "refresh"))); M.push(H.on("labeling-info-change", q.hitch(this, "refresh"))); M.push(H.on("time-extent-change", q.hitch(this, "refresh"))); M.push(H.on("show-labels-change", q.hitch(this, "refresh"))); M.push(H.on("feature-reduction-change", q.hitch(this, "refresh"))); this._featureLayerInfos.push({
                                                                                FeatureLayer: H, LabelExpressionInfo: N, LabelingOptions: T,
                                                                                LabelRenderer: I, EventHandlers: M
                                                                        }); this.featureLayers.push(H); this.refresh()
                                                        }
                                                }, getFeatureLayer: function (H) { var I; for (I = 0; I < this.featureLayers.length; I++) { var N = this.featureLayers[I]; if (void 0 !== N && N.id == H) return N } return null }, removeFeatureLayer: function (H) {
                                                        H = this.getFeatureLayer(H); if (void 0 !== H) {
                                                                var I = A.indexOf(this.featureLayers, H); if (-1 < I) {
                                                                        this.featureLayers.splice(I, 1); for (H = 0; H < this._featureLayerInfos[I].EventHandlers.length; H++)w.disconnect(this._featureLayerInfos[I].EventHandlers[H]); this._featureLayerInfos.splice(I,
                                                                                1); this.refresh()
                                                                }
                                                        }
                                                }, removeAllFeatureLayers: function () { var H; for (H = 0; H < this.featureLayers.length; H++) { for (var I = 0; I < this._featureLayerInfos[H].EventHandlers.length; I++)w.disconnect(this._featureLayerInfos[H].EventHandlers[I]); this.featureLayers = []; this._featureLayerInfos = [] } this.refresh() }, getFeatureLayers: function () { return this.featureLayers }, getFeatureLayerInfo: function (H) { var I; for (I = 0; I < this.featureLayers.length; I++) { var N = this.featureLayers[I]; if (void 0 !== N && N.id == H) return this._featureLayerInfos[I] } return null },
                                                refresh: function () { null == this._refreshHandle && (this._refreshHandle = b.setTimeout(this._refreshLabels, b.priority.LOW)) }, _handleLevelChange: function (H) { H.levelChange && this.clear(); this.refresh() }, _refreshLabels: function (H) {
                                                        this._refreshHandle = null; var I = [], N, T = "DYNAMIC" === this._engineType ? new u : new z; if (this._map) {
                                                                T.setMap(this._map, this); this._preparedLabels = []; for (H = 0; H < this.featureLayers.length; H++) {
                                                                        var M = this.featureLayers[H]; if (M.visible && M.showLabels && M.visibleAtMapScale && !M._suspended) {
                                                                                var R =
                                                                                        this._featureLayerInfos[H]; var ca = this._convertOptions(null); if (R.LabelRenderer) {
                                                                                                if (I = M.labelingInfo) if (N = I[0]) { var K = this._getLabelExpression(N); ca = this._convertOptions(N) } var Q = R.LabelRenderer; R.LabelExpressionInfo && (K = R.LabelExpressionInfo); R.LabelingOptions && (ca = this._convertOptions(null), void 0 !== R.LabelingOptions.pointPriorities && (I = R.LabelingOptions.pointPriorities, ca.pointPriorities = "above-center" == I || "AboveCenter" == I || "esriServerPointLabelPlacementAboveCenter" == I ? "AboveCenter" : "above-left" ==
                                                                                                        I || "AboveLeft" == I || "esriServerPointLabelPlacementAboveLeft" == I ? "AboveLeft" : "above-right" == I || "AboveRight" == I || "esriServerPointLabelPlacementAboveRight" == I ? "AboveRight" : "below-center" == I || "BelowCenter" == I || "esriServerPointLabelPlacementBelowCenter" == I ? "BelowCenter" : "below-left" == I || "BelowLeft" == I || "esriServerPointLabelPlacementBelowLeft" == I ? "BelowLeft" : "below-right" == I || "BelowRight" == I || "esriServerPointLabelPlacementBelowRight" == I ? "BelowRight" : "center-center" == I || "CenterCenter" == I || "esriServerPointLabelPlacementCenterCenter" ==
                                                                                                                I ? "CenterCenter" : "center-left" == I || "CenterLeft" == I || "esriServerPointLabelPlacementCenterLeft" == I ? "CenterLeft" : "center-right" == I || "CenterRight" == I || "esriServerPointLabelPlacementCenterRight" == I ? "CenterRight" : "AboveRight"), void 0 !== R.LabelingOptions.lineLabelPlacement && (ca.lineLabelPlacement = R.LabelingOptions.lineLabelPlacement), void 0 !== R.LabelingOptions.lineLabelPosition && (ca.lineLabelPosition = R.LabelingOptions.lineLabelPosition), void 0 !== R.LabelingOptions.labelRotation && (ca.labelRotation = R.LabelingOptions.labelRotation),
                                                                                                        void 0 !== R.LabelingOptions.howManyLabels && (ca.howManyLabels = R.LabelingOptions.howManyLabels)); Q instanceof y && (K = this._getLabelExpression(Q), Q = new B(Q.symbol), ca = this._convertOptions(Q)); this._addLabels(M, Q, K, ca)
                                                                                        } else if (I = M.labelingInfo) for (R = I.length - 1; 0 <= R; R--)if (N = I[R]) Q = new y(N instanceof y ? N.toJson() : N), K = this._getLabelExpression(N), ca = this._convertOptions(N), this._addLabels(M, Q, K, ca)
                                                                        }
                                                                } K = T._process(this._preparedLabels); this.clear(); this.drawLabels(this._map, K)
                                                        }
                                                }, drawLabels: function (H, I) {
                                                        this._scale =
                                                        (H.extent.xmax - H.extent.xmin) / H.width; var N; for (N = 0; N < I.length; N++) { var T = I[N], M = T.x, R = T.y, ca = T.text, K = T.angle, Q = T.layer.labelSymbol; "polyline" == T.layer.geometry.type && T.layer.options.labelRotation && Q.setAngle(180 / Math.PI * K); Q.setText(ca); Q instanceof e && (ca = Q.getHeight(), M -= .25 * ca * this._scale * Math.sin(K), R -= .33 * ca * this._scale); K = new d(new h(M, R, H.extent.spatialReference)); K.setParentGraphic(T.layer.graphic); K.setSymbol(Q); this.add(K) }
                                                }, _addLabels: function (H, I, N, T) {
                                                        var M; if (this._isWithinScaleRange(I.minScale,
                                                                I.maxScale) && N && "" !== N) { var R = this._map, ca = !H.url && !R.spatialReference.equals(H.spatialReference); for (M = 0; M < H.graphics.length; M++) { var K = H.graphics[M]; if (!1 !== K.visible && !K._suspended) { var Q = K.geometry; if (ca) { if (!p.canProject(Q, R)) continue; Q = p.project(Q, R) } if (Q && this._isWhere(I.where, K.attributes) && this._isWithinScreenArea(Q)) { var X = this._buildLabelText(N, K, H.fields, T); this._addLabel(X, I, H.renderer, K, T, Q, R) } } } }
                                                }, _isWithinScreenArea: function (H) {
                                                        H = "point" === H.type ? new f(H.x, H.y, H.x, H.y, H.spatialReference) :
                                                                H.getExtent(); if (void 0 === H) return !1; H = this._intersects(this._map, H); return null === H || 0 === H.length ? !1 : !0
                                                }, _isWithinScaleRange: function (H, I) { var N = this._map.getScale(); return 0 < H && N >= H || 0 < I && N < I ? !1 : !0 }, _isWhere: function (H, I) {
                                                        try {
                                                                if (!H) return !0; if (H) {
                                                                        var N = H.split(" "); if (3 === N.length) return this._sqlEquation(I[this._removeQuotes(N[0])], N[1], this._removeQuotes(N[2])); if (7 === N.length) {
                                                                                var T = this._sqlEquation(I[this._removeQuotes(N[0])], N[1], this._removeQuotes(N[2])), M = N[3], R = this._sqlEquation(I[this._removeQuotes(N[4])],
                                                                                        N[5], this._removeQuotes(N[6])); switch (M) { case "AND": return T && R; case "OR": return T || R }
                                                                        }
                                                                } return !1
                                                        } catch (ca) { console.log("Error.: can't parse \x3d " + H) }
                                                }, _sqlEquation: function (H, I, N) { switch (I) { case "\x3d": return H == N ? !0 : !1; case "\x3c\x3e": return H != N ? !0 : !1; case "\x3e": return H > N ? !0 : !1; case "\x3e\x3d": return H >= N ? !0 : !1; case "\x3c": return H < N ? !0 : !1; case "\x3c\x3d": return H <= N ? !0 : !1 }return !1 }, _removeQuotes: function (H) {
                                                        var I = H.indexOf('"'), N = H.lastIndexOf('"'); if (-1 != I && -1 != N) return H.substr(1, H.length -
                                                                2); I = H.indexOf("'"); N = H.lastIndexOf("'"); return -1 != I && -1 != N ? H.substr(1, H.length - 2) : H
                                                }, _getSizeInfo: function (H) { return H ? H.sizeInfo || A.filter(H.visualVariables, D)[0] : null }, _addLabel: function (H, I, N, T, M, R, ca) {
                                                        var K; if (H && "" !== q.trim(H) && I) {
                                                                H = H.replace(/[\f\n\r\t\v\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/g, " "); var Q = I.getSymbol(T); Q instanceof e ? (Q = new e(Q.toJson()), Q.setVerticalAlignment("baseline"), Q.setHorizontalAlignment("center")) : Q = Q instanceof a ? new a(Q.toJson()) : new e;
                                                                Q.setText(H); I.symbol = Q; if (K = this._getProportionalSize(I.sizeInfo, T.attributes)) Q instanceof e ? Q.setSize(K) : Q instanceof a && (Q.setWidth(K), Q.setHeight(K)); var X = K = 0; if (N) {
                                                                        var W = N.getSymbol(T); var fa = this._getSizeInfo(N); if ((N = fa ? N.getSize(T, { sizeInfo: fa, resolution: ca.getResolutionInMeters() }) : T.size) && null !== N) K = X = N; else if (W) if ("simplemarkersymbol" == W.type) X = K = W.size; else if ("picturemarkersymbol" == W.type) K = W.width, X = W.height; else if ("simplelinesymbol" == W.type || "cartographiclinesymbol" == W.type) K =
                                                                                W.width
                                                                } N = {}; N.graphic = T; N.options = M; N.geometry = R; N.labelRenderer = I; N.labelSymbol = Q; N.labelWidth = Q.getWidth() / 2; N.labelHeight = Q.getHeight() / 2; N.symbolWidth = l.normalizedLength(K) / 2; N.symbolHeight = l.normalizedLength(X) / 2; N.text = H; N.angle = Q.angle; this._preparedLabels.push(N)
                                                        }
                                                }, _buildLabelText: function (H, I, N, T) {
                                                        if (T.hasExpression) return H = t.getEvalOptions({ expression: T.arcadeExpr, feature: I, layer: I.getLayer(), spatialReference: this._map.spatialReference }), I = I.evaluateExpression(T.arcadeExpr, H), n.isDefined(I) ?
                                                                "" + I : ""; var M = I.attributes; return H.replace(/{[^}]*}/g, function (R) {
                                                                        var ca, K = R; for (ca = 0; ca < N.length; ca++)if ("{" + N[ca].name + "}" == R) {
                                                                                K = M[N[ca].name]; var Q = N[ca].domain; if (Q && q.isObject(Q)) { if ("codedValue" == Q.type && T.useCodedValues) for (ca = K, R = 0; R < Q.codedValues.length; R++)if (Q.codedValues[R].code == ca) { K = Q.codedValues[R].name; break } break } Q = N[ca].type; if (T.fieldInfos) {
                                                                                        var X = T.fieldInfos; for (ca = 0; ca < X.length; ca++)if ("{" + X[ca].fieldName + "}" == R) {
                                                                                                R = X[ca].format; "esriFieldTypeDate" == Q ? K = n.substitute({ myKey: K },
                                                                                                        "${myKey}", { format: { myKey: q.mixin({ formatType: "DateFormat" }, c.prototype._dateFormatsJson[R && R.dateFormat || "shortDate"]) } }) : "esriFieldTypeInteger" != Q && "esriFieldTypeSingle" != Q && "esriFieldTypeSmallInteger" != Q && "esriFieldTypeLong" != Q && "esriFieldTypeDouble" != Q || !R || (K = v.format(K, { places: R.places }), R.digitSeparator || m.group && (K = K.replace(new RegExp("\\" + m.group, "g"), ""))); break
                                                                                        }
                                                                                } break
                                                                        } else K = ""; return null == K ? "" : K
                                                                })
                                                }, _getLabelExpression: function (H) {
                                                        var I = ""; H.labelExpressionInfo ? I = H.labelExpressionInfo.value ||
                                                                H.labelExpressionInfo.expression : this._validSyntax(H.labelExpression) && (I = this._convertLabelExpression(H.labelExpression)); return I
                                                }, _validSyntax: function (H) { return /^(\s*\[[^\]]+\]\s*)+$/i.test(H) }, _convertLabelExpression: function (H) { return H.replace(/\[/g, "{").replace(/\]/g, "}") }, _getProportionalSize: function (H, I) {
                                                        if (!H) return null; I = n.substitute(I, "${" + H.field + "}", { first: !0 }); return !(H.minSize && H.maxSize && H.minDataValue && H.maxDataValue && I) || 0 >= H.maxDataValue - H.minDataValue ? null : (H.maxSize - H.minSize) /
                                                                (H.maxDataValue - H.minDataValue) * (I - H.minDataValue) + H.minSize
                                                }, _convertOptions: function (H) {
                                                        var I = !0, N = "shortDate", T = null, M = null, R = "", ca = !0; if (H && (H.format && (N = H.format.dateFormat, T = { places: H.format.places, digitSeparator: H.format.digitSeparator }), M = H.fieldInfos, R = H.labelPlacement, null != H.useCodedValues && (I = H.useCodedValues), H = H.labelExpressionInfo)) { var K = H.expression; if (K && !H.value) { var Q = !0; var X = new g({ expression: K, returnType: "string", profile: t }) } } if ("always-horizontal" == R || "esriServerPolygonPlacementAlwaysHorizontal" ==
                                                                R) ca = !1; return {
                                                                        useCodedValues: I, dateFormat: N, numberFormat: T, fieldInfos: M, pointPriorities: "above-center" == R || "esriServerPointLabelPlacementAboveCenter" == R ? "AboveCenter" : "above-left" == R || "esriServerPointLabelPlacementAboveLeft" == R ? "AboveLeft" : "above-right" == R || "esriServerPointLabelPlacementAboveRight" == R ? "AboveRight" : "below-center" == R || "esriServerPointLabelPlacementBelowCenter" == R ? "BelowCenter" : "below-left" == R || "esriServerPointLabelPlacementBelowLeft" == R ? "BelowLeft" : "below-right" == R || "esriServerPointLabelPlacementBelowRight" ==
                                                                                R ? "BelowRight" : "center-center" == R || "esriServerPointLabelPlacementCenterCenter" == R ? "CenterCenter" : "center-left" == R || "esriServerPointLabelPlacementCenterLeft" == R ? "CenterLeft" : "center-right" == R || "esriServerPointLabelPlacementCenterRight" == R ? "CenterRight" : "AboveRight", lineLabelPlacement: "above-start" == R || "below-start" == R || "center-start" == R ? "PlaceAtStart" : "above-end" == R || "below-end" == R || "center-end" == R ? "PlaceAtEnd" : "PlaceAtCenter", lineLabelPosition: "above-after" == R || "esriServerLinePlacementAboveAfter" ==
                                                                                        R || "above-along" == R || "esriServerLinePlacementAboveAlong" == R || "above-before" == R || "esriServerLinePlacementAboveBefore" == R || "above-start" == R || "esriServerLinePlacementAboveStart" == R || "above-end" == R || "esriServerLinePlacementAboveEnd" == R ? "Above" : "below-after" == R || "esriServerLinePlacementBelowAfter" == R || "below-along" == R || "esriServerLinePlacementBelowAlong" == R || "below-before" == R || "esriServerLinePlacementBelowBefore" == R || "below-start" == R || "esriServerLinePlacementBelowStart" == R || "below-end" == R || "esriServerLinePlacementBelowEnd" ==
                                                                                                R ? "Below" : "center-after" == R || "esriServerLinePlacementCenterAfter" == R || "center-along" == R || "esriServerLinePlacementCenterAlong" == R || "center-before" == R || "esriServerLinePlacementCenterBefore" == R || "center-start" == R || "esriServerLinePlacementCenterStart" == R || "center-end" == R || "esriServerLinePlacementCenterEnd" == R ? "OnLine" : "Above", labelRotation: ca, howManyLabels: "OneLabel", hasExpression: Q, arcadeExpr: X
                                                                }
                                                }
                                        }); r("extend-esri") && q.setObject("layers.LabelLayer", E, k); return E
                                })
                }, "esri/layers/labelLayerUtils/DynamicLabelClass": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Polygon".split(" "),
                                function (E, q, A, w, m, v) {
                                        E = E(null, {
                                                declaredClass: "esri.layers.labelLayerUtils.DynamicLabelClass", constructor: function () { this._preparedLabels = []; this._placedLabels = []; this._extent = null; this._y1 = this._x1 = this._y0 = this._x0 = this._ymax = this._ymin = this._xmax = this._xmin = 0; this._scale = 1 }, setMap: function (r, l) { this._labelLayer = l; this._xmin = r.extent.xmin; this._xmax = r.extent.xmax; this._ymin = r.extent.ymin; this._ymax = r.extent.ymax; this._scale = (this._xmax - this._xmin) / r.width }, _process: function (r) {
                                                        this._preparedLabels =
                                                        r; this._placedLabels = []; var l; for (r = this._preparedLabels.length - 1; 0 <= r; r--) {
                                                                var k = this._preparedLabels[r], n = Math.min(k.labelWidth, k.labelHeight), d = k.labelWidth + 0 * n; n = k.labelHeight + 0 * n; var c = (l = k.options) && void 0 !== l.lineLabelPlacement ? l.lineLabelPlacement : "PlaceAtCenter", g = l && void 0 !== l.lineLabelPosition ? l.lineLabelPosition : "Above", b = l && void 0 !== l.pointPriorities ? l.pointPriorities : "AboveRight", e = [2, 2, 1, 3, 0, 2, 3, 3, 2]; "AboveLeft" == b ? e = [1, 2, 2, 2, 0, 3, 2, 3, 3] : "AboveCenter" == b ? e = [2, 1, 2, 2, 0, 2, 3, 3, 3] : "AboveRight" ==
                                                                        b ? e = [2, 2, 1, 3, 0, 2, 3, 3, 2] : "CenterLeft" == b ? e = [2, 2, 3, 1, 0, 3, 2, 2, 3] : "CenterCenter" == b ? e = [0, 0, 0, 0, 1, 0, 0, 0, 0] : "CenterRight" == b ? e = [3, 2, 2, 3, 0, 1, 3, 2, 2] : "BelowLeft" == b ? e = [2, 3, 3, 2, 0, 3, 1, 2, 2] : "BelowCenter" == b ? e = [3, 3, 3, 2, 0, 2, 2, 1, 2] : "BelowRight" == b && (e = [3, 3, 2, 3, 0, 2, 2, 2, 1]); var a = l && void 0 !== l.labelRotation ? l.labelRotation : !0; b = Math.PI / 180 * k.angle; l = l && void 0 !== l.howManyLabels ? l.howManyLabels : "OneLabel"; if ("point" == k.geometry.type) this._generatePointPositions(k, k.geometry.x, k.geometry.y, k.text, b, d, n, k.symbolWidth,
                                                                                k.symbolHeight, e); else if ("multipoint" == k.geometry.type) for (c = k.geometry, g = 0; g < c.points.length; g++)this._generatePointPositions(k, c.points[g][0], c.points[g][1], k.text, b, d, n, k.symbolWidth, k.symbolHeight, e); else "polyline" == k.geometry.type ? this._generateLinePositions(k, k.geometry, k.text, d, n, 2 * k.symbolHeight + n, c, g, a) : "polygon" == k.geometry.type && this._generatePolygonPositions(k, l, k.geometry, k.text, b, d, n)
                                                        } return this._placedLabels
                                                }, _generatePointPositions: function (r, l, k, n, d, c, g, b, e, a) {
                                                        b = (b + c) * this._scale;
                                                        e = (e + g) * this._scale; var f, h; for (f = 1; 3 >= f; f++)for (h = 1; 9 >= h; h++)if (a[h - 1] == f) switch (h) {
                                                                case 1: if (this._findPlace(r, n, l - b, k + e, d, c, g)) return; break; case 2: if (this._findPlace(r, n, l, k + e, d, c, g)) return; break; case 3: if (this._findPlace(r, n, l + b, k + e, d, c, g)) return; break; case 4: if (this._findPlace(r, n, l - b, k, d, c, g)) return; break; case 5: if (this._findPlace(r, n, l, k, d, c, g)) return; break; case 6: if (this._findPlace(r, n, l + b, k, d, c, g)) return; break; case 7: if (this._findPlace(r, n, l - b, k - e, d, c, g)) return; break; case 8: if (this._findPlace(r,
                                                                        n, l, k - e, d, c, g)) return; break; case 9: if (this._findPlace(r, n, l + b, k - e, d, c, g)) return
                                                        }
                                                }, _generateLinePositions: function (r, l, k, n, d, c, g, b, e) {
                                                        var a = n * this._scale * n * this._scale, f, h; for (f = 0; f < l.paths.length; f++) {
                                                                var p = l.paths[f], B = p.length, t = Math.floor((B - 1) / 2), u = 0 !== (B - 1) % 2 ? 1 : -1; "PlaceAtStart" == g && (t = 0, u = 1); "PlaceAtEnd" == g && (t = B - 2, u = -1); for (; 0 <= t && t < B - 1;) {
                                                                        for (h = t; h < B; h++) {
                                                                                var z = p[t][0], x = p[t][1], y = p[h][0] - z, D = p[h][1] - x; if (y * y + D * D > a) {
                                                                                        for (var H = Math.atan2(D, y); H > Math.PI / 2;)H -= Math.PI; for (; H < -(Math.PI / 2);)H +=
                                                                                                Math.PI; var I = Math.sin(H), N = Math.cos(H), T = 0, M = 0; "Above" == b && (T = c * I * this._scale, M = c * N * this._scale); "Below" == b && (T = -c * I * this._scale, M = -c * N * this._scale); if (1 == h - t) {
                                                                                                        if (this._clipLine(z, x, p[h][0], p[h][1])) {
                                                                                                                z = this._x1 - this._x0; var R = this._y1 - this._y0; if (z * z + R * R > a && (h = Math.atan2(R, z), y = n / 2 + 2 * d, x = y * this._scale * Math.cos(h), y = y * this._scale * Math.sin(h), "PlaceAtStart" == g ? (z = this._x0 + x, R = this._y0 + y) : "PlaceAtEnd" == g ? (z = this._x1 - x, R = this._y1 - y) : (z = this._x0 + z / 2, R = this._y0 + R / 2), this._findPlace(r, k, z - T, R + M, e ? -h : 0,
                                                                                                                        n, d))) return
                                                                                                        }
                                                                                                } else { var ca = 0; for (R = t; R <= h; R++)ca = Math.max(ca, Math.abs((p[R][1] - x) * N - (p[R][0] - z) * I)); if (ca < d && this._findPlace(r, k, z + y / 2 - T, x + D / 2 + M, e ? -H : 0, n, d)) return } break
                                                                                }
                                                                        } t += u
                                                                }
                                                        }
                                                }, _generatePolygonPositions: function (r, l, k, n, d, c, g) {
                                                        if ("ManyLabels" == l) for (l = 0; l < k.rings.length; l++) { var b = k.rings[l]; v.prototype.isClockwise(b) && (b = this._findCentroid(b, this._xmin, this._ymin, this._xmax, this._ymax), this._findPlace(r, n, b[0], b[1], d, c, g)) } else {
                                                                b = this._findCentroidForFeature(k, this._xmin, this._ymin, this._xmax, this._ymax);
                                                                var e = b[1], a = 0; for (l = 0; 10 > l; l++) { a += g / 4; b = this._findCentroidForFeature(k, this._xmin, e + (a - g / 4), this._xmax, e + (a + g / 4)); if (this._findPlace(r, n, b[0], b[1], d, c, g)) break; b = this._findCentroidForFeature(k, this._xmin, e - (a + g / 4), this._xmax, e - (a - g / 4)); if (this._findPlace(r, n, b[0], b[1], d, c, g)) break }
                                                        }
                                                }, _findCentroid: function (r, l, k, n, d) {
                                                        var c = r.length, g = [0, 0], b = 0, e = r[0][0], a = r[0][1]; e > n && (e = n); e < l && (e = l); a > d && (a = d); a < k && (a = k); for (var f = 1; f < c - 1; f++) {
                                                                var h = r[f][0], p = r[f][1], B = r[f + 1][0], t = r[f + 1][1]; h > n && (h = n); h < l && (h =
                                                                        l); p > d && (p = d); p < k && (p = k); B > n && (B = n); B < l && (B = l); t > d && (t = d); t < k && (t = k); var u = (h - e) * (t - a) - (B - e) * (p - a); g[0] += u * (e + h + B); g[1] += u * (a + p + t); b += u
                                                        } g[0] /= 3 * b; g[1] /= 3 * b; if (isNaN(g[0]) || isNaN(g[1])) return g; k = []; this._fillBuffer(r, k, g); g[0] = this._sortBuffer(k, g[0], l, n); return g
                                                }, _findCentroidForFeature: function (r, l, k, n, d) {
                                                        for (var c, g = 0, b = [0, 0], e = 0; e < r.rings.length; e++) {
                                                                var a = r.rings[e], f = a.length, h = a[0][0], p = a[0][1]; h > n && (h = n); h < l && (h = l); p > d && (p = d); p < k && (p = k); for (c = 1; c < f - 1; c++) {
                                                                        var B = a[c][0], t = a[c][1], u = a[c + 1][0],
                                                                        z = a[c + 1][1]; B > n && (B = n); B < l && (B = l); t > d && (t = d); t < k && (t = k); u > n && (u = n); u < l && (u = l); z > d && (z = d); z < k && (z = k); var x = (B - h) * (z - p) - (u - h) * (t - p); b[0] += x * (h + B + u); b[1] += x * (p + t + z); g += x
                                                                }
                                                        } b[0] /= 3 * g; b[1] /= 3 * g; if (isNaN(b[0]) || isNaN(b[1])) return b; k = []; for (c = 0; c < r.rings.length; c++)this._fillBuffer(r.rings[c], k, b); b[0] = this._sortBuffer(k, b[0], l, n); return b
                                                }, _fillBuffer: function (r, l, k) {
                                                        for (var n = r.length - 1, d = r[0][1] >= r[n][1] ? 1 : -1, c = 0; c <= n; c++) {
                                                                var g = c, b = c + 1; c == n && (b = 0); var e = r[g][0]; g = r[g][1]; var a = r[b][0]; b = r[b][1]; var f =
                                                                        b >= g ? 1 : -1; if (g <= k[1] && k[1] <= b || b <= k[1] && k[1] <= g) k[1] != g && k[1] != b ? (l.push((k[1] - g) * (a - e) / (b - g) + e), d = f) : k[1] == g && k[1] != b ? (d != f && l.push(e), d = f) : k[1] != g && k[1] == b ? (l.push(a), d = f) : k[1] == g && k[1] == b && (1 == d && l.push(e), l.push(a), d = f)
                                                        }
                                                }, _sortBuffer: function (r, l, k, n) { var d = r.length; r.sort(); if (0 < d) { for (var c = 0, g = l = 0; g < d - 1; g += 2) { var b = Math.abs(r[g + 1] - r[g]); !(r[g] <= k && r[g + 1] <= k || r[g] >= n && r[g + 1] >= n) && b > c && (c = b, l = g) } d = r[l]; r = r[l + 1]; d > n && (d = n); d < k && (d = k); r > n && (r = n); r < k && (r = k); l = (d + r) / 2 } return l }, _findPlace: function (r,
                                                        l, k, n, d, c, g) {
                                                                if (isNaN(k) || isNaN(n)) return !1; for (var b = 0; b < this._placedLabels.length; b++) {
                                                                        var e = this._placedLabels[b].angle, a = this._placedLabels[b].width * this._scale, f = this._placedLabels[b].height * this._scale, h = this._placedLabels[b].x - k, p = this._placedLabels[b].y - n; if (0 === d && 0 === e) { if (this._findPlace2(-c * this._scale, -g * this._scale, c * this._scale, g * this._scale, h - a, p - f, h + a, p + f)) return !1 } else {
                                                                                var B = new m(-c * this._scale, -g * this._scale, c * this._scale, g * this._scale, null), t = 0, u = 1; 0 !== d && (t = Math.sin(d), u = Math.cos(d));
                                                                                var z = h * u - p * t; h = h * t + p * u; e -= d; t = Math.sin(e); u = Math.cos(e); var x = -a * u - -f * t; p = -a * t + -f * u; e = +a * u - -f * t; var y = +a * t + -f * u; a = z + x; f = h - p; t = z + e; u = h - y; x = z - x; p = h + p; z -= e; h += y; e = new v; e.addRing([[a, f], [t, u], [x, p], [z, h], [a, f]]); if (B.intersects(e)) return !1
                                                                        }
                                                                } for (; d > Math.PI / 2;)d -= Math.PI; for (; d < -(Math.PI / 2);)d += Math.PI; b = {}; b.layer = r; b.text = l; b.angle = d; b.x = k; b.y = n; b.width = c; b.height = g; this._placedLabels.push(b); return !0
                                                }, _findPlace2: function (r, l, k, n, d, c, g, b) {
                                                        return (r >= d && r <= g || k >= d && k <= g || r <= d && k >= g) && (l >= c && l <= b ||
                                                                n >= c && n <= b || l <= c && n >= b) ? !0 : !1
                                                }, _clipLine: function (r, l, k, n) {
                                                        for (var d = this._code(r, l), c = this._code(k, n); 0 !== d || 0 !== c;) {
                                                                if (0 !== (d & c)) return !1; var g = k - r, b = n - l; 0 !== d ? (r < this._xmin ? (l += b * (this._xmin - r) / g, r = this._xmin) : r > this._xmax ? (l += b * (this._xmax - r) / g, r = this._xmax) : l < this._ymin ? (r += g * (this._ymin - l) / b, l = this._ymin) : l > this._ymax && (r += g * (this._ymax - l) / b, l = this._ymax), d = this._code(r, l)) : (k < this._xmin ? (n += b * (this._xmin - k) / g, k = this._xmin) : k > this._xmax ? (n += b * (this._xmax - k) / g, k = this._xmax) : n < this._ymin ? (k +=
                                                                        g * (this._ymin - n) / b, n = this._ymin) : n > this._ymax && (k += g * (this._ymax - n) / b, n = this._ymax), c = this._code(k, n))
                                                        } this._x0 = r; this._y0 = l; this._x1 = k; this._y1 = n; return !0
                                                }, _code: function (r, l) { var k = 0; r < this._xmin && (k += 8); r > this._xmax && (k += 4); l < this._ymin && (k += 2); l > this._ymax && (k += 1); return k }
                                        }); A("extend-esri") && q.setObject("layers.labelLayerUtils.DynamicLabelClass", E, w); return E
                                })
                }, "esri/layers/labelLayerUtils/StaticLabelClass": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../geometry/Extent ../../geometry/Point ../../geometry/Polygon".split(" "),
                                function (E, q, A, w, m, v, r) {
                                        return E(null, {
                                                declaredClass: "esri.layers.labelLayerUtils.StaticLabel", constructor: function () { this._preparedLabels = []; this._placedLabels = []; this._extent = null; this._ymax = this._ymin = this._xmax = this._xmin = 0; this._scale = 1; this._LINE_STEP_CONST = 1.5; this._POLYGON_X_STEP_CONST = 1; this._POLYGON_Y_STEP_CONST = .75; this._OVERRUN = 2 }, setMap: function (l, k) {
                                                        this._labelLayer = k; this._map = l; this._xmin = l.extent.xmin; this._xmax = l.extent.xmax; this._ymin = l.extent.ymin; this._ymax = l.extent.ymax; this._scale =
                                                                (this._xmax - this._xmin) / l.width
                                                }, _process: function (l) {
                                                        var k; this._preparedLabels = l; this._placedLabels = []; for (l = this._preparedLabels.length - 1; 0 <= l; l--) {
                                                                var n = this._preparedLabels[l]; var d = n.labelWidth; var c = n.labelHeight; var g = (k = n.options) && k.lineLabelPlacement ? k.lineLabelPlacement : "PlaceAtCenter"; var b = k && k.lineLabelPosition ? k.lineLabelPosition : "Above"; var e = k && k.labelRotation ? k.labelRotation : !0; var a = Math.PI / 180 * n.angle; var f = k && k.howManyLabels ? k.howManyLabels : "OneLabel"; var h = []; if ("point" === n.geometry.type) this._generatePointPositions(n.geometry.x,
                                                                        n.geometry.y, n.text, a, d, c, n.symbolWidth, n.symbolHeight, k, h); else if ("multipoint" === n.geometry.type) for (e = 0; e < n.geometry.points.length; e++)this._generatePointPositions(n.geometry.points[e][0], n.geometry.points[e][1], n.text, a, d, c, n.symbolWidth, n.symbolHeight, k, h); else if ("polyline" === n.geometry.type) if ("PlaceAtStart" === g) this._generateLinePositionsPlaceAtStart(n.geometry, !0, n.text, d, c, 2 * n.symbolHeight + c, g, b, e, h); else if ("PlaceAtEnd" === g) this._generateLinePositionsPlaceAtEnd(n.geometry, !0, n.text, d, c,
                                                                                2 * n.symbolHeight + c, g, b, e, h); else {
                                                                                        k = []; var p = n.geometry.getExtent(), B = this._map.extent; if (p.getWidth() < d * this._scale / this._OVERRUN && p.getHeight() < d * this._scale / this._OVERRUN) continue; else .5 * p.getWidth() < B.getWidth() && .5 * p.getHeight() < B.getHeight() ? this._generateLinePositionsPlaceAtCenter(n.geometry, !1, .1 * Math.min(this._map.width, this._map.height) * this._scale, n.text, d, c, 2 * n.symbolHeight + c, g, b, e, k) : this._generateLinePositionsPlaceAtCenter(n.geometry, !0, .2 * Math.min(this._map.width, this._map.height) * this._scale,
                                                                                                n.text, d, c, 2 * n.symbolHeight + c, g, b, e, k); this._postSorting(B, k, h)
                                                                        } else if ("polygon" === n.geometry.type) {
                                                                                g = []; for (e = 0; e < n.geometry.rings.length; e++)b = n.geometry.rings[e], 1 < n.geometry.rings.length && !r.prototype.isClockwise(b) || (k = this._calcRingExtent(b), k.xmax - k.xmin < 4 * d * this._scale / this._OVERRUN && k.ymax - k.ymin < 4 * c * this._scale / this._OVERRUN || g.push(b)); g.sort(function (t, u) { return u.length - t.length }); for (e = 0; e < g.length; e++)this._generatePolygonPositionsForManyLabels(g[e], n.geometry.spatialReference, n.text,
                                                                                        a, d, c, h)
                                                                        } for (e = 0; e < h.length && (g = h[e].x, b = h[e].y, void 0 !== h[e].angle && (a = h[e].angle), k = this._findPlace(n, n.text, g, b, a, d, c), "OneLabel" !== f || !k || !this._labelLayer._isWithinScreenArea(new v(g, b, n.geometry.spatialReference))); e++);
                                                        } return this._placedLabels
                                                }, _generatePointPositions: function (l, k, n, d, c, g, b, e, a, f) {
                                                        n = a && a.pointPriorities ? a.pointPriorities : "AboveRight"; c = (b + c) * this._scale; g = (e + g) * this._scale; switch (n.toLowerCase()) {
                                                                case "aboveleft": l -= c; k += g; break; case "abovecenter": k += g; break; case "aboveright": l +=
                                                                        c; k += g; break; case "centerleft": l -= c; break; case "centercenter": break; case "centerright": l += c; break; case "belowleft": l -= c; k -= g; break; case "belowcenter": k -= g; break; case "belowright": l += c; k -= g; break; default: return
                                                        }f.push({ x: l, y: k })
                                                }, _generateLinePositionsPlaceAtStart: function (l, k, n, d, c, g, b, e, a, f) {
                                                        b = d * this._scale; var h = this._LINE_STEP_CONST * Math.min(this._map.width, this._map.height) * this._scale, p, B; for (p = 0; p < l.paths.length; p++) {
                                                                var t = l.paths[p], u = b, z = 0; for (B = 0; B < t.length - 1; B++) {
                                                                        var x = t[B][0]; var y = t[B][1];
                                                                        var D = t[B + 1][0]; var H = t[B + 1][1]; var I = D - x; var N = H - y; I = Math.sqrt(I * I + N * N); z + I > u ? (z = this._generatePositionsOnLine(l.spatialReference, k, u, h, z, x, y, D, H, n, d, c, g, e, a, f), u = h) : z += I
                                                                }
                                                        }
                                                }, _generateLinePositionsPlaceAtEnd: function (l, k, n, d, c, g, b, e, a, f) {
                                                        b = d * this._scale; var h = this._LINE_STEP_CONST * Math.min(this._map.width, this._map.height) * this._scale, p, B; for (p = 0; p < l.paths.length; p++) {
                                                                var t = l.paths[p], u = b, z = 0; for (B = t.length - 2; 0 <= B; B--) {
                                                                        var x = t[B + 1][0]; var y = t[B + 1][1]; var D = t[B][0]; var H = t[B][1]; var I = D - x; var N = H -
                                                                                y; I = Math.sqrt(I * I + N * N); z + I > u ? (z = this._generatePositionsOnLine(l.spatialReference, k, u, h, z, x, y, D, H, n, d, c, g, e, a, f), u = h) : z += I
                                                                }
                                                        }
                                                }, _generateLinePositionsPlaceAtCenter: function (l, k, n, d, c, g, b, e, a, f, h) {
                                                        var p; for (e = 0; e < l.paths.length; e++) {
                                                                var B = l.paths[e]; if (!(2 > B.length)) {
                                                                        if (2 == B.length) {
                                                                                var t = B[0]; var u = B[1]; var z = t[0]; t = t[1]; B = u[0]; var x = u[1]; var y = (B - z) * (B - z) + (x - t) * (x - t); var D = Math.atan2(x - t, B - z); x = Math.cos(D); D = Math.sin(D); B = []; var H = z; for (var I = t; (H - z) * (H - z) + (I - t) * (I - t) < y;)B.push([H, I]), H += n / 2 * x, I += n /
                                                                                        2 * D; B.push(u)
                                                                        } var N = 0; for (u = 0; u < B.length - 1; u++)z = B[u][0], t = B[u][1], y = B[u + 1][0], x = B[u + 1][1], D = y - z, H = x - t, N += Math.sqrt(D * D + H * H); for (u = I = 0; u < B.length - 1; u++) { z = B[u][0]; t = B[u][1]; y = B[u + 1][0]; x = B[u + 1][1]; D = y - z; H = x - t; D = Math.sqrt(D * D + H * H); if (I + D > N / 2) break; I += D } u == B.length - 1 && u--; z = B[u][0]; t = B[u][1]; y = B[u + 1][0]; x = B[u + 1][1]; D = y - z; H = x - t; I = N / 2 - I; D = Math.atan2(H, D); H = z + I * Math.cos(D); D = t + I * Math.sin(D); z = this._angleAndShifts(z, t, y, x, b, a, f); h.push({ x: H + z.shiftX, y: D + z.shiftY, angle: z.angle }); N = H; var T = D; I = 0; for (p = u; p <
                                                                                B.length - 1; p++)p == u ? (z = N, t = T) : (z = B[p][0], t = B[p][1]), y = B[p + 1][0], x = B[p + 1][1], D = y - z, H = x - t, D = Math.sqrt(D * D + H * H), I = I + D > n ? this._generatePositionsOnLine(l.spatialReference, k, n, n, I, z, t, y, x, d, c, g, b, a, f, h) : I + D; I = 0; for (p = u; 0 <= p; p--)p == u ? (z = N, t = T) : (z = B[p + 1][0], t = B[p + 1][1]), y = B[p][0], x = B[p][1], D = y - z, H = x - t, D = Math.sqrt(D * D + H * H), I = I + D > n ? this._generatePositionsOnLine(l.spatialReference, k, n, n, I, z, t, y, x, d, c, g, b, a, f, h) : I + D
                                                                }
                                                        }
                                                }, _generatePositionsOnLine: function (l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z) {
                                                        f = Math.atan2(a - b, e - g); h =
                                                                g; p = b; var x = h, y = p; do if (c = n - c, h += c * Math.cos(f), p += c * Math.sin(f), this._belongs(h, p, g, b, e, a)) c = this._angleAndShifts(g, b, e, a, B, t, u), n = h + c.shiftX, y = p + c.shiftY, k ? this._labelLayer._isWithinScreenArea(new m(n, y, n, y, l)) && z.push({ x: n, y: y, angle: c.angle }) : z.push({ x: n, y: y, angle: c.angle }), x = h, y = p, c = 0, n = d; else return l = e - x, a -= y, Math.sqrt(l * l + a * a); while (1)
                                                }, _postSorting: function (l, k, n) {
                                                        if (l && 0 < k.length) {
                                                                var d = .5 * (l.xmin + l.xmax); l = .5 * (l.ymin + l.ymax); for (var c = k[0].x, g = k[0].y, b = Math.sqrt((c - d) * (c - d) + (g - l) * (g - l)),
                                                                        e = k[0].angle, a = 0; a < k.length; a++) { var f = k[a].x, h = k[a].y, p = Math.sqrt((f - d) * (f - d) + (h - l) * (h - l)); p < b && (c = f, g = h, b = p, e = k[a].angle) } n.push({ x: c, y: g, angle: e })
                                                        }
                                                }, _belongs: function (l, k, n, d, c, g) { if (c == n && g == d) return !1; if (c > n) { if (l > c || l < n) return !1 } else if (l < c || l > n) return !1; if (g > d) { if (k > g || k < d) return !1 } else if (k < g || k > d) return !1; return !0 }, _angleAndShifts: function (l, k, n, d, c, g, b) {
                                                        for (l = Math.atan2(d - k, n - l); l > Math.PI / 2;)l -= Math.PI; for (; l < -(Math.PI / 2);)l += Math.PI; d = Math.sin(l); var e = Math.cos(l); n = k = 0; "Above" == g && (k =
                                                                c * d * this._scale, n = c * e * this._scale); "Below" == g && (k = -c * d * this._scale, n = -c * e * this._scale); c = []; c.angle = b ? -l : 0; c.shiftX = -k; c.shiftY = n; return c
                                                }, _generatePolygonPositionsForManyLabels: function (l, k, n, d, c, g, b) {
                                                        c = this._findCentroidForRing(l); d = c[0]; var e = c[1], a = this._calcRingExtent(l); c = a.xmin; g = a.ymin; var f = a.xmax; a = a.ymax; var h = (a - g) / (this._map.height * this._scale); if (!(10 < (f - c) / (this._map.width * this._scale) && 10 < h)) {
                                                                var p = !0; if (f - c > this._map.width * this._scale || a - g > this._map.height * this._scale) p = !1; h = this._map.width *
                                                                        this._scale * (p ? .1875 : .5); p = this._map.height * this._scale * (p ? .1875 : .5); var B = !0, t = !0, u = 0; do { e += (u % 2 ? -1 : 1) * u * p; if (this._scanRingByX(n, k, l, d, e, c, f, h, b)) break; e < g && (B = !1); e > a && (t = !1); u++ } while (B || t)
                                                        }
                                                }, _scanRingByX: function (l, k, n, d, c, g, b, e, a) {
                                                        var f = !0, h = !0, p = 0, B = 1E3; do { d += (p % 2 ? -1 : 1) * p * e; var t = this._movePointInsideRing(n, d, c), u = this._labelLayer._isWithinScreenArea(new m(t, c, t, c, k)), z = this._isPointWithinRing(l, n, t, c); if (u && z) return a.push({ x: t, y: c }), !0; d < g && (f = !1); d > b && (h = !1); p++; B--; if (0 >= B) return !0 } while (f ||
                                                                h); return !1
                                                }, _movePointInsideRing: function (l, k, n) {
                                                        for (var d = [], c = l.length - 1, g = l[0][1] >= l[c][1] ? 1 : -1, b = 0; b <= c; b++) { var e = b, a = b + 1; b == c && (a = 0); var f = l[e][0]; e = l[e][1]; var h = l[a][0]; a = l[a][1]; var p = a >= e ? 1 : -1; if (e <= n && n <= a || a <= n && n <= e) n != e && n != a ? (d.push((n - e) * (h - f) / (a - e) + f), g = p) : n == e && n != a ? (g != p && d.push(f), g = p) : n != e && n == a ? (d.push(h), g = p) : n == e && n == a && (1 == g && d.push(f), d.push(h), g = p) } d.sort(function (B, t) { return B - t }); l = d.length; if (0 < l) {
                                                                for (b = n = k = 0; b < l - 1; b += 2)c = Math.abs(d[b + 1] - d[b]), c > k && (k = c, n = b); k = (d[n] +
                                                                        d[n + 1]) / 2
                                                        } return k
                                                }, _calcRingExtent: function (l) { var k; var n = new m; for (k = 0; k < l.length - 1; k++) { var d = l[k][0], c = l[k][1]; if (void 0 === n.xmin || d < n.xmin) n.xmin = d; if (void 0 === n.ymin || c < n.ymin) n.ymin = c; if (void 0 === n.xmax || d > n.xmax) n.xmax = d; if (void 0 === n.ymax || c > n.ymax) n.ymax = c } return n }, _isPointWithinPolygon: function (l, k, n, d) { var c; for (c = 0; c < k.rings.length; c++)if (this._isPointWithinRing(l, k.rings[c], n, d)) return !0; return !1 }, _isPointWithinRing: function (l, k, n, d) {
                                                        var c = [], g = k.length; for (l = 0; l < g - 1; l++) {
                                                                var b = k[l][0];
                                                                var e = k[l][1]; var a = k[l + 1][0]; var f = k[l + 1][1]; if (b != a || e != f) { if (e == f) if (d == e) c.push(b); else continue; b == a ? (e < f && d >= e && d < f && c.push(b), e > f && d <= e && d > f && c.push(b)) : (e = (a - b) / (f - e) * (d - e) + b, b < a && e >= b && e < a && c.push(e), b > a && e <= b && e > a && c.push(e)) }
                                                        } c.sort(function (h, p) { return h - p }); for (l = 0; l < c.length - 1; l++)if (b = c[l], a = c[l + 1], n >= b && n < a) if (l % 2) break; else return !0; return !1
                                                }, _findCentroidForRing: function (l) {
                                                        for (var k = l.length, n = [0, 0], d = 0, c = l[0][0], g = l[0][1], b = 1; b < k - 1; b++) {
                                                                var e = l[b][0], a = l[b][1], f = l[b + 1][0], h = l[b +
                                                                        1][1], p = (e - c) * (h - g) - (f - c) * (a - g); n[0] += p * (c + e + f); n[1] += p * (g + a + h); d += p
                                                        } n[0] /= 3 * d; n[1] /= 3 * d; return n
                                                }, _findCentroidForFeature: function (l) { for (var k = 0, n = [0, 0], d = 0; d < l.rings.length; d++)for (var c = l.rings[d], g = c.length, b = c[0][0], e = c[0][1], a = 1; a < g - 1; a++) { var f = c[a][0], h = c[a][1], p = c[a + 1][0], B = c[a + 1][1], t = (f - b) * (B - e) - (p - b) * (h - e); n[0] += t * (b + f + p); n[1] += t * (e + h + B); k += t } n[0] /= 3 * k; n[1] /= 3 * k; return n }, _findPlace: function (l, k, n, d, c, g, b) {
                                                        if (isNaN(n) || isNaN(d)) return !1; for (var e = 0; e < this._placedLabels.length; e++) {
                                                                var a =
                                                                        this._placedLabels[e].angle, f = this._placedLabels[e].width * this._scale, h = this._placedLabels[e].height * this._scale, p = this._placedLabels[e].x - n, B = this._placedLabels[e].y - d; if (0 === c && 0 === a) { if (this._findPlace2(-g * this._scale, -b * this._scale, g * this._scale, b * this._scale, p - f, B - h, p + f, B + h)) return !1 } else {
                                                                                var t = new m(-g * this._scale, -b * this._scale, g * this._scale, b * this._scale, null), u = 0, z = 1; 0 !== c && (u = Math.sin(c), z = Math.cos(c)); var x = p * z - B * u; p = p * u + B * z; a -= c; u = Math.sin(a); z = Math.cos(a); var y = -f * z - -h * u; B = -f * u + -h * z;
                                                                                a = +f * z - -h * u; var D = +f * u + -h * z; f = x + y; h = p - B; u = x + a; z = p - D; y = x - y; B = p + B; x -= a; p += D; a = new r; a.addRing([[f, h], [u, z], [y, B], [x, p], [f, h]]); if (t.intersects(a)) return !1
                                                                        }
                                                        } for (; c > Math.PI / 2;)c -= Math.PI; for (; c < -(Math.PI / 2);)c += Math.PI; e = {}; e.layer = l; e.text = k; e.angle = c; e.x = n; e.y = d; e.width = g; e.height = b; this._placedLabels.push(e); return !0
                                                }, _findPlace2: function (l, k, n, d, c, g, b, e) { return (l >= c && l <= b || n >= c && n <= b || l <= c && n >= b) && (k >= g && k <= e || d >= g && d <= e || k <= g && d >= e) ? !0 : !1 }
                                        })
                                })
                }, "esri/dijit/Legend": function () {
                        define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/debounce dojo/has dojo/sniff dojo/Deferred dojo/DeferredList dojo/json dojo/dom dojo/dom-construct dojo/dom-style dojo/dom-class dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../numberUtils ../renderers/utils ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../renderers/VectorFieldRenderer ../renderers/HeatmapRenderer ../symbols/PictureFillSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/utils ../symbols/jsonUtils ../renderers/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y, D, H, I, N, T, M, R, ca, K, Q, X, W, fa, ma, ia, va, xa, na, ra) {
                                        var sa = H.getClassValuesForRelationship(), wa = { defaultShape: { type: "path", path: "M10,5 L5,0 0,5 M5,0 L5,15" }, stroke: { width: 1, color: "#555555" } }, aa = { HH: 315, HL: 45, LL: 135, LH: 225 }, Da = /^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i, Ca = q([na, h], {
                                                declaredClass: "esri.dijit.Legend", widgetsInTemplate: !1, layers: null, alignRight: !1, hoverLabelShowing: !1, dotDensitySwatchSize: 26, dotCoverage: 75, gradientHeight: 30, transparencyRampColor: new r([64,
                                                        64, 64]), defaultText: "Aa", sizeRampLightColor: new r([255, 255, 255]), sizeRampDarkColor: new r([128, 128, 128]), gradientWidth: 34, colorRampBorder: "1px solid", _specialChars: { lt: "\x3c", gt: "\x3e" }, _ieTimer: 100, _isRightToLeft: !1, _align: null, _legendAlign: null, _preserveCacheOnDestroy: !1, _layerConnects: null, _mapConnects: null, constructor: function (O, C) {
                                                                A.mixin(this, ra.widgets.legend); this._i18n = ra.widgets.legend; O = O || {}; O.map ? C ? (this.map = O.map, this.layerInfos = O.layerInfos, this._respectCurrentMapScale = !1 === O.respectCurrentMapScale ?
                                                                        !1 : !0, this._respectVisibility = !1 === O.respectVisibility ? !1 : !0, this._preserveCacheOnDestroy = O.preserveCacheOnDestroy ? !0 : !1, this.arrangement = O.arrangement === Ca.ALIGN_RIGHT ? Ca.ALIGN_RIGHT : Ca.ALIGN_LEFT, this.arrangement === Ca.ALIGN_RIGHT && (this.alignRight = !0), this.autoUpdate = !1 === O.autoUpdate ? !1 : !0, this._surfaceItems = [], this.hideLayersInLegend = {}, this.refresh = l(this.refresh, 0)) : console.error("esri.dijit.Legend: must specify a container for the legend") : console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")
                                                        },
                                                postMixInProperties: function () { this.inherited(arguments); var O = ["ar", "he"], C; for (C = 0; C < O.length; C += 1) { var G = O[C]; E.locale && -1 !== E.locale.indexOf(G) && (-1 !== E.locale.indexOf("-") ? -1 !== E.locale.indexOf(G + "-") && (this._isRightToLeft = !0) : this._isRightToLeft = !0) } this._isRightToLeft ? (this._align = this.alignRight ? "left" : "right", this._legendAlign = this.alignRight ? "esriLegendLeft" : "esriLegendRight") : (this._align = this.alignRight ? "right" : "left", this._legendAlign = this.alignRight ? "esriLegendRight" : "esriLegendLeft") },
                                                startup: function () { this.inherited(arguments); this._surfaceItems = []; this._initialize(); 9 > k("ie") && (this._repaintItems = A.hitch(this, this._repaintItems), setTimeout(this._repaintItems, this._ieTimer)) }, destroy: function () { this._deactivate(); this._removeCachedLegendResponses(); this._removeHoverHandlers(); this.inherited(arguments) }, _removeCachedLegendResponses: function () { this._preserveCacheOnDestroy || w.forEach(this.layers, function (O) { delete O.legendResponse }) }, refresh: function (O) {
                                                        if (this.domNode) {
                                                                O ? (this.layerInfos =
                                                                        O, this.layers = [], w.forEach(this.layerInfos, function (C) { this._isSupportedLayerType(C.layer) && (C.title && (C.layer._titleForLegend = C.title), C.layer._hideDefaultSymbol = !1 === C.defaultSymbol ? !0 : !1, C.hideLayers ? (this.hideLayersInLegend[C.layer.id] = C.hideLayers, this._addSubLayersToHide(C)) : this.hideLayersInLegend[C.layer.id] = [], C.hoverLabel && (C.layer._hoverLabel = C.hoverLabel), C.hoverLabels && (C.layer._hoverLabels = C.hoverLabels), this.layers.push(C.layer)) }, this)) : this.useAllMapLayers && (this.layers = this.layerInfos =
                                                                                null); for (O = this.domNode.children.length - 1; 0 <= O; O--)e.destroy(this.domNode.children[O]); this._removeHoverHandlers(); this.startup()
                                                        }
                                                }, _legendUrl: "http://utility.arcgis.com/sharing/tools/legend", _initialize: function () {
                                                        this.layerInfos && (this.layers = [], w.forEach(this.layerInfos, function (G) {
                                                                this._isSupportedLayerType(G.layer) && (G.title && (G.layer._titleForLegend = G.title), G.layer._hideDefaultSymbol = !1 === G.defaultSymbol ? !0 : !1, G.hideLayers ? (this.hideLayersInLegend[G.layer.id] = G.hideLayers, this._addSubLayersToHide(G)) :
                                                                        this.hideLayersInLegend[G.layer.id] = [], G.hoverLabel && (G.layer._hoverLabel = G.hoverLabel), G.hoverLabels && (G.layer._hoverLabels = G.hoverLabels), this.layers.push(G.layer))
                                                        }, this)); this.useAllMapLayers = !1; if (!this.layers) {
                                                                this.useAllMapLayers = !0; this.layers = []; var O = [], C = []; w.forEach(this.map.layerIds, function (G) {
                                                                        G = this.map.getLayer(G); this._isSupportedLayerType(G) && (G.arcgisProps && G.arcgisProps.title && (G._titleForLegend = G.arcgisProps.title), this.layers.push(G)); if ("esri.layers.KMLLayer" === G.declaredClass) {
                                                                                var L =
                                                                                        G.getLayers(); w.forEach(L, function (P) { O.push(P.id) }, this)
                                                                        } "esri.layers.GeoRSSLayer" === G.declaredClass && (L = G.getFeatureLayers(), w.forEach(L, function (P) { C.push(P.id) }, this))
                                                                }, this); w.forEach(this.map.graphicsLayerIds, function (G) { var L = this.map.getLayer(G); -1 === w.indexOf(O, G) && -1 === w.indexOf(C, G) && this._isSupportedLayerType(L) && this._isLayerDrawingEnabled(L) && (L.arcgisProps && L.arcgisProps.title && (L._titleForLegend = L.arcgisProps.title), this.layers.push(L)) }, this)
                                                        } this._createLegend()
                                                }, _isLayerDrawingEnabled: function (O) {
                                                        return O &&
                                                                (O._params && O._params.drawMode || O.isFeatureReductionActive && O.isFeatureReductionActive())
                                                }, _activate: function () {
                                                        this._deactivate(); if (this.autoUpdate) {
                                                                this._mapConnects = []; this._layerConnects = {}; var O = this._mapConnects; this._respectCurrentMapScale && O.push(m.connect(this.map, "onZoomEnd", this, "_refreshLayers")); this.useAllMapLayers && (O.push(m.connect(this.map, "onLayerAdd", this, "_updateAllMapLayers")), O.push(m.connect(this.map, "onLayerRemove", this, "_updateAllMapLayers")), O.push(m.connect(this.map, "onLayersReordered",
                                                                        this, "_updateAllMapLayers"))); w.forEach(this.layers, function (C) {
                                                                                var G = [m.connect(C, "onFeatureReductionRendererChange", this, "_refreshLayers"), m.connect(C, "onFeatureReductionChange", this, "_refreshLayers"), m.connect(C, "onVisibilityChange", this, "_refreshLayers"), m.connect(C, "onOpacityChange", this, "_refreshLayers"), m.connect(C, "onScaleRangeChange", this, "_refreshLayers")]; "esri.layers.ArcGISDynamicMapServiceLayer" === C.declaredClass && C.supportsDynamicLayers && G.push(m.connect(C, "_onDynamicLayersChange", A.hitch(this,
                                                                                        "_updateDynamicLayers", C))); if ("esri.layers.ArcGISImageServiceLayer" === C.declaredClass || "esri.layers.RasterXLayer" === C.declaredClass) G.push(m.connect(C, "onRenderingChange", A.partial(this._updateImageServiceLayers, this, C))), G.push(m.connect(C, "onRendererChange", A.partial(this._updateImageServiceLayers, this, C))); ("esri.layers.ArcGISImageServiceVectorLayer" === C.declaredClass || C.setWebGLEnabled) && G.push(m.connect(C, "onRendererChange", A.hitch(this, "_refreshLayers"))); this._layerConnects[C.id] = G
                                                                        }, this)
                                                        }
                                                },
                                                _deactivate: function () { w.forEach(this._mapConnects, function (O) { m.disconnect(O) }); w.forEach(this.layers, function (O) { var C = this._layerConnects; C && w.forEach(C[O.id], function (G) { m.disconnect(G) }) }, this); this._mapConnects = this._layerConnects = null }, _updateDynamicLayers: function (O) { delete O.legendResponse; this._refreshLayers() }, _updateImageServiceLayers: function (O, C) { delete C.legendResponse; O._refreshLayers() }, _refreshLayers: function () { this.refresh() }, _updateAllMapLayers: function () {
                                                        this.layers = []; w.forEach(this.map.layerIds,
                                                                function (O) { O = this.map.getLayer(O); this._isSupportedLayerType(O) && this.layers.push(O) }, this); w.forEach(this.map.graphicsLayerIds, function (O) { O = this.map.getLayer(O); this._isSupportedLayerType(O) && this._isLayerDrawingEnabled(O) && this.layers.push(O) }, this); this.refresh()
                                                }, _createLegend: function () {
                                                        var O = !1, C = !1; a.set(this.domNode, "position", "relative"); e.create("div", { id: this.id + "_msg", className: "esriLegendMsg", innerHTML: this.NLS_creatingLegend + "..." }, this.domNode); var G = []; w.forEach(this.layers, function (P) {
                                                                if ("esri.layers.KMLLayer" ===
                                                                        P.declaredClass || "esri.layers.GeoRSSLayer" === P.declaredClass) if (P.loaded) {
                                                                                if ("esri.layers.KMLLayer" === P.declaredClass) var S = P.getLayers(); else "esri.layers.GeoRSSLayer" === P.declaredClass && (S = P.getFeatureLayers(), this.hideLayersInLegend[P.id] && (S = w.filter(S, function (ha) { return -1 === w.indexOf(this.hideLayersInLegend[P.id], ha.id) }, this))); w.forEach(S, function (ha) {
                                                                                        "esri.layers.FeatureLayer" === ha.declaredClass && P._titleForLegend && (ha._titleForLegend = P._titleForLegend + " - ", "esriGeometryPoint" === ha.geometryType ?
                                                                                                ha._titleForLegend += this.NLS_points : "esriGeometryPolyline" === ha.geometryType ? ha._titleForLegend += this.NLS_lines : "esriGeometryPolygon" === ha.geometryType && (ha._titleForLegend += this.NLS_areas), G.push(ha))
                                                                                }, this)
                                                                        } else m.connect(P, "onLoad", A.hitch(this, function () { this.refresh(this.layerInfos) })); else if ("esri.layers.WMSLayer" === P.declaredClass) if (!P.loaded) m.connect(P, "onLoad", A.hitch(this, function () { this.refresh(this.layerInfos) })); else {
                                                                                if ((!this._respectVisibility || this._respectVisibility && P.visible) &&
                                                                                        0 < P.layerInfos.length && w.some(P.layerInfos, function (ha) { return ha.legendURL })) {
                                                                                                var Y = !1; w.forEach(P.layerInfos, function (ha) {
                                                                                                        if (ha.legendURL && -1 < w.indexOf(P.visibleLayers, ha.name)) {
                                                                                                                Y || (e.create("div", { innerHTML: "\x3cspan class\x3d'esriLegendServiceLabel'\x3e" + (P._titleForLegend || P.name || P.id) + "\x3c/span\x3e" }, this.domNode), Y = !0); var ja; ha = ha.legendURL; if (P.customParameters || P.customLayerParameters) {
                                                                                                                        var ka = A.clone(P.customParameters || {}); A.mixin(ka, P.customLayerParameters || {}); for (ja in ka) ha += (-1 ===
                                                                                                                                ha.indexOf("?") ? "?" : "\x26") + ja + "\x3d" + ka[ja]
                                                                                                                } e.create("div", { innerHTML: "\x3cimg src\x3d'" + ha + "'/\x3e" }, this.domNode); O = !0
                                                                                                        }
                                                                                                }, this)
                                                                                }
                                                                        } else "esri.layers.WFSLayer" !== P.declaredClass || P.renderer ? G.push(P) : (S = e.create("div", { id: this.id + "_" + P.id, "class": "esriLegendService" }), e.create("span", { innerHTML: this._getServiceTitle(P), "class": "esriLegendServiceLabel" }, e.create("td", { align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%" }, S))))), e.place(S, this.id, "first"), S = e.create("table",
                                                                                { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, S), S = e.create("tbody", {}, S), "esriGeometryComplex" === P.geometryType ? (this._buildRow_Renderer(P, P._pointSymbol, null, this.NLS_points, null, S), this._buildRow_Renderer(P, P._lineSymbol, null, this.NLS_lines, null, S), this._buildRow_Renderer(P, P._polygonSymbol, null, this.NLS_areas, null, S)) : "esriGeometryPoint" === P.geometryType ? this._buildRow_Renderer(P, P._pointSymbol, null, "", null, S) : "esriGeometryPolyline" === P.geometryType ? this._buildRow_Renderer(P,
                                                                                        P._lineSymbol, null, "", null, S) : "esriGeometryPolygon" === P.geometryType && this._buildRow_Renderer(P, P._polygonSymbol, null, "", null, S), C = !0)
                                                        }, this); var L = []; w.forEach(G, function (P) {
                                                                if (!P.loaded) var S = m.connect(P, "onLoad", this, function (ha) { m.disconnect(S); S = null; this.refresh() }); else if ((!this._respectVisibility || this._respectVisibility && P.visible) && (P.layerInfos || P.renderer || "esri.layers.ArcGISImageServiceLayer" === P.declaredClass || "esri.layers.RasterXLayer" === P.declaredClass)) {
                                                                        var Y = e.create("div", {
                                                                                id: this.id +
                                                                                        "_" + P.id, style: { display: "none" }, "class": "esriLegendService"
                                                                        }); e.create("span", { innerHTML: this._getServiceTitle(P), "class": "esriLegendServiceLabel" }, e.create("td", { align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%" }, Y))))); e.place(Y, this.id, "first"); P.legendResponse || P.renderer && "esri.renderer.StretchRenderer" !== P.renderer.declaredClass || P.renderer && "esri.renderer.StretchRenderer" === P.renderer.declaredClass && 1 === P.bandCount ? this._createLegendForLayer(P) : this.isHostedTileService(P) ?
                                                                                this._getLayerInfos(P).then(A.hitch(this, function (ha) { this._createLegendForLayer(ha) }), A.hitch(this, function (ha) { L.push(this._legendRequest(ha)) })) : "esri.layers.RasterXLayer" === P.declaredClass && -1 < P.capabilities.toLowerCase().indexOf("tilesonly") ? this._createLegendForTileOnlyService(P) : L.push(this._legendRequest(P))
                                                                }
                                                        }, this); 0 !== L.length || O || C ? (new c(L)).addCallback(A.hitch(this, function (P) { O || C ? b.byId(this.id + "_msg").innerHTML = "" : b.byId(this.id + "_msg").innerHTML = this.NLS_noLegend; this._activate() })) :
                                                                (b.byId(this.id + "_msg").innerHTML = this.NLS_noLegend, this._activate())
                                                }, _createLegendForTileOnlyService: function (O) {
                                                        function C(ka, ua) { var qa = ["red", "green", "blue"], V = [[255, 0, 0], [0, 255, 0], [0, 0, 255]]; (ua && ua.length >= S ? G(ua) : G()).forEach(function (da, Z) { var ea = new W(W.STYLE_SQUARE, 20, new fa(fa.STYLE_SOLID, new r([0, 0, 0]), 1), new r(V[Z])); ka._buildRow_Renderer(O, ea, null, qa[Z] + ": " + da, null, P) }, ka) } function G(ka) {
                                                                var ua = (O.bandIds && O.bandIds.length ? O.bandIds : [0, 1, 2]).map(function (qa) {
                                                                        return ka && ka[qa] && ka[qa].BandName ||
                                                                                "Band_" + (qa + 1)
                                                                }); 3 > ua.length ? ua.push(ua[1]) : 3 < ua.length && ua.splice(3); return ua
                                                        } var L = e.create("div", { id: this.id + "_" + O.id + "_clientLegend", "class": "esriLegendServiceLabel" }, b.byId(this.id + "_" + O.id)); e.create("td", { align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%", "class": "esriLegendLayerLabel" }, L)))); L = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, L); var P = e.create("tbody", {}, L), S = O.bandCount; if (1 < S && (!O.bandIds || 0 === O.bandIds.length ||
                                                                1 < O.bandIds.length)) O.getKeyProperties().then(A.hitch(this, function (ka) { C(this, ka.BandProperties) }), A.hitch(this, function (ka) { C(this) })); else {
                                                                        L = { colorRamp: { type: "algorithmic", fromColor: [0, 0, 0], toColor: [255, 255, 255] } }; var Y = O.renderer; if (Y && Y.statistics && Y.statistics.length) { var ha = null != Y.statistics[0].min ? Y.statistics[0].min : Y.statistics[0][0]; var ja = null != Y.statistics[0].max ? Y.statistics[0].max : Y.statistics[0][1] } else ha = O.serviceInfo.minValues.length ? O.serviceInfo.minValues[0] : 0, ja = O.serviceInfo.maxValues.length ?
                                                                                O.serviceInfo.maxValues[0] : 255; this._createStretchLegend(P, Y || L, ha, ja)
                                                        } a.set(b.byId(this.id + "_" + O.id), "display", "block"); a.set(b.byId(this.id + "_msg"), "display", "none")
                                                }, _createLegendForLayer: function (O) {
                                                        if (O.legendResponse || O.renderer || this.isHostedTileService(O)) {
                                                                var C = !1; if (O.legendResponse || this.isHostedTileService(O)) {
                                                                        var G = O.dynamicLayerInfos || O.layerInfos; if (G && G.length) w.forEach(G, function (L, P) {
                                                                                this.hideLayersInLegend[O.id] && -1 !== w.indexOf(this.hideLayersInLegend[O.id], L.id) || (L = this._buildLegendItems(O,
                                                                                        L, P), C = C || L)
                                                                        }, this); else if ("esri.layers.ArcGISImageServiceLayer" === O.declaredClass || "esri.layers.RasterXLayer" === O.declaredClass) C = this._buildLegendItems(O, { id: 0, name: null, title: O.name, subLayerIds: null, parentLayerId: -1 }, 0)
                                                                } else O.renderer && (G = O.url ? O.url.substring(O.url.lastIndexOf("/") + 1, O.url.length) : "fc_" + O.id, C = this._buildLegendItems(O, { id: G, name: null, subLayerIds: null, parentLayerId: -1 }, 0)); C && (a.set(b.byId(this.id + "_" + O.id), "display", "block"), a.set(b.byId(this.id + "_msg"), "display", "none"))
                                                        }
                                                },
                                                _legendRequest: function (O) { if (O.loaded) return 10.01 <= O.version ? this._legendRequestServer(O) : this._legendRequestTools(O); m.connect(O, "onLoad", A.hitch(this, "_legendRequest")) }, _legendRequestServer: function (O) {
                                                        var C = O.url, G = C.indexOf("?"); C = -1 < G ? C.substring(0, G) + "/legend" + C.substring(G) : C + "/legend"; (G = O._getToken()) && (C += "?token\x3d" + G); var L = A.hitch(this, "_processLegendResponse"), P = { f: "json" }; O._params.dynamicLayers && (P.dynamicLayers = g.stringify(this._createDynamicLayers(O)), "[{}]" === P.dynamicLayers &&
                                                                (P.dynamicLayers = "[]")); O._params.bandIds && (P.bandIds = O._params.bandIds); O._params.renderingRule ? P.renderingRule = O._params.renderingRule : O.rasterFunctionInfos && 0 < O.rasterFunctionInfos.length && w.forEach(O.rasterFunctionInfos, function (S) { S && S.name && "none" === S.name.toLowerCase() && (P.renderingRule = g.stringify({ rasterFunction: S.name })) }); (G = O._params.mosaicRule && JSON.parse(O._params.mosaicRule)) && G.multidimensionalDefinition && G.multidimensionalDefinition.length && (P.variable = G.multidimensionalDefinition[0].variableName);
                                                        return x({ url: C, content: P, callbackParamName: "callback", load: function (S, Y) { L(O, S, Y) }, error: z.defaults.io.errorHandler })
                                                }, _legendRequestTools: function (O) { var C = O.url.toLowerCase().indexOf("/rest/"); C = O.url.substring(0, C) + O.url.substring(C + 5, O.url.length); C = this._legendUrl + "?soapUrl\x3d" + window.escape(C); if (!k("ie") || 8 < k("ie")) C += "\x26returnbytes\x3dtrue"; var G = A.hitch(this, "_processLegendResponse"); return x({ url: C, content: { f: "json" }, callbackParamName: "callback", load: function (L, P) { G(O, L, P) }, error: z.defaults.io.errorHandler }) },
                                                _processLegendResponse: function (O, C) { C && C.layers ? (O.legendResponse = C, b.byId(this.id + "_" + O.id) && e.empty(b.byId(this.id + "_" + O.id)), e.create("span", { innerHTML: this._getServiceTitle(O), "class": "esriLegendServiceLabel" }, e.create("td", { align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%" }, b.byId(this.id + "_" + O.id)))))), this._createLegendForLayer(O)) : console.log("Legend could not get generated for " + O.url + ": " + v.toJson(C)) }, _buildLegendItems: function (O, C, G) {
                                                        var L = !1, P = b.byId(this.id +
                                                                "_" + O.id), S = C.parentLayerId; if (C.subLayerIds) O = e.create("div", { id: this.id + "_" + O.id + "_" + C.id + "_group", style: { display: "none" }, "class": -1 == S ? 0 < G ? "esriLegendGroupLayer" : "" : this._legendAlign }, -1 == S ? P : b.byId(this.id + "_" + O.id + "_" + S + "_group")), e.create("td", { innerHTML: t.encode(C.name), align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%", "class": "esriLegendLayerLabel" }, O)))); else {
                                                                        if (this._respectVisibility && O.visibleLayers) if (G = O.dynamicLayerInfos || O.layerInfos) if (O._params &&
                                                                                O._params.layers) { if (-1 === w.indexOf(O.visibleLayers, C.id)) return L } else { if (G = this._getReallyVisibleLayers(G, O.visibleLayers), -1 === w.indexOf(G, C.id)) return L } else if (-1 === w.indexOf(O.visibleLayers, C.id)) return L; P = e.create("div", { id: this.id + "_" + O.id + "_" + C.id, style: { display: "none" }, "class": -1 < S ? this._legendAlign : "" }, -1 == S ? P : b.byId(this.id + "_" + O.id + "_" + S + "_group")); e.create("td", { innerHTML: t.encode(C.name) || "", align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%", "class": "esriLegendLayerLabel" },
                                                                                        P)))); G = O.dynamicLayerInfos || O.layerInfos; S = !1; G && G.length && (S = w.some(G, function (Y) { return !!Y.drawingInfo })); if (O.legendResponse) L = L || this._buildLegendItems_Tools(O, C, P); else if (O.renderer || S) L = L || this._buildLegendItems_Renderer(O, C, P)
                                                                } return L
                                                }, _getReallyVisibleLayers: function (O, C) {
                                                        if (!O || !C || !C.length) return []; var G = [], L = [], P; for (P = 0; P < O.length; P++)if (O[P].subLayerIds) { if (-1 === w.indexOf(C, O[P].id) || -1 < w.indexOf(L, O[P].id)) L = L.concat(O[P].subLayerIds) } else -1 < w.indexOf(C, O[P].id) && -1 === w.indexOf(L,
                                                                O[P].id) && G.push(O[P].id); return G
                                                }, _buildLegendItems_Tools: function (O, C, G) {
                                                        var L = C.parentLayerId, P = this.map.getScale(), S = !1, Y = function (Z, ea) { var la, oa; for (la = 0; la < Z.length; la++)if (ea.dynamicLayerInfos) for (oa = 0; oa < ea.dynamicLayerInfos[oa].length; oa++) { if (ea.dynamicLayerInfos[oa].mapLayerId == Z[la].layerId) return Z[la] } else if (ea.id == Z[la].layerId) return Z[la]; return {} }; if (!this._respectCurrentMapScale || this._respectCurrentMapScale && this._isLayerInScale(O, C, P)) {
                                                                var ha = !0; if (this._respectCurrentMapScale &&
                                                                        ("esri.layers.ArcGISDynamicMapServiceLayer" === O.declaredClass || "esri.layers.ArcGISMapServiceLayer" === O.declaredClass)) { var ja = this._getEffectiveScale(O, C); if (ja.minScale && ja.minScale < P || ja.maxScale && ja.maxScale > P) ha = !1 } if (ha) {
                                                                                Y = Y(O.legendResponse.layers, C); var ka = Y.legendType, ua = Y.legend; P = Y.legendGroups; if (ua) {
                                                                                        "esri.layers.ArcGISImageServiceLayer" === O.declaredClass && "esri.layers.RasterXLayer" === O.declaredClass || this._sanitizeLegendResponse(O, Y, C); G = e.create("table", {
                                                                                                cellpadding: 0, cellspacing: 0, width: "95%",
                                                                                                "class": "esriLegendLayer"
                                                                                        }, G); var qa = e.create("tbody", {}, G), V = {}; P && 0 < P.length && (G.setAttribute("cellspacing", "10"), P.forEach(function (Z) { if (Z.heading) { var ea = e.create("tr", {}, qa); ea = e.create("td", {}, ea); e.create("div", { innerHTML: t.encode(Z.heading) }, ea) } ea = e.create("tr", {}, qa); ea = e.create("td", {}, ea); ea = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, ea); ea = e.create("tbody", {}, ea); V[Z.id] = ea })); (O._hoverLabel || O._hoverLabels) && this._createHoverAction(G, O, C); var da =
                                                                                                []; w.forEach(ua, function (Z) { if (!(10.1 <= O.version && !Z.values && 1 < ua.length) || !O._hideDefaultSymbol && "\x3call other values\x3e" !== Z.label) { var ea = Z.label; if (Z.url && 0 === Z.url.indexOf("http") || Z.imageData && 0 < Z.imageData.length) S = !0, ea && -1 !== w.indexOf(da, ea) || (da.push(ea), this._buildRow_Tools(Z, V[Z.groupId] || qa, O, C.id, ka)) } }, this)
                                                                                }
                                                                        }
                                                        } S && (a.set(b.byId(this.id + "_" + O.id + "_" + C.id), "display", "block"), -1 < L && (a.set(b.byId(this.id + "_" + O.id + "_" + L + "_group"), "display", "block"), this._findParentGroup(O.id, O, L))); return S
                                                },
                                                _getLayerInfos: function (O) {
                                                        var C = new d, G = O.dynamicLayerInfos || O.layerInfos; if (G && G.length) if (w.some(G, function (S) { return !!S.drawingInfo })) C.resolve(O); else {
                                                                var L = O.url, P = L.indexOf("?"); L = -1 === P ? L + "/layers" : L.substring(0, P) + "/layers" + L.substring(P, L.length); x({
                                                                        url: L, content: { f: "json" }, callbackParamName: "callback", load: function (S, Y) {
                                                                                S.layers ? (w.forEach(G, function (ha) {
                                                                                        var ja = w.filter(S.layers, function (ka) { return ha.source ? ka.id === ha.source.mapLayerId : ka.id === ha.id }); ja && ja[0] && ja[0].drawingInfo && (ha.drawingInfo =
                                                                                                ja[0].drawingInfo, ha.fields = ja[0].fields)
                                                                                }), C.resolve(O)) : C.reject(O)
                                                                        }, error: function (S) { C.reject(O) }
                                                                })
                                                        } return C
                                                }, _sanitizeLegendResponse: function (O, C, G) {
                                                        var L = C.legend; if (10.1 <= O.version && 1 < L.length && !C._sanitized) {
                                                                O = A.getObject("layerDefinition.drawingInfo.renderer", !1, G); var P, S; O || (O = A.getObject("drawingInfo.renderer", !1, G)); w.some(L, function (Y) { if (Y.values) return !0 }) && w.some(L, function (Y, ha) { Y.values || (S = ha, P = Y); return !!P }); O ? "uniqueValue" === O.type ? P && (L.splice(S, 1), L.push(P)) : "classBreaks" ===
                                                                        O.type && (P && L.splice(S, 1), L.reverse(), P && L.push(P)) : P && (L.splice(S, 1), L.push(P)); C._sanitized = !0
                                                        }
                                                }, _buildRow_Tools: function (O, C, G, L, P) {
                                                        var S = e.create("tr", {}, C); if (this.alignRight) { C = e.create("td", { align: this._isRightToLeft ? "left" : "right" }, S); var Y = e.create("td", { align: this._isRightToLeft ? "left" : "right", width: 35 }, S) } else Y = e.create("td", { width: 35, align: "center" }, S), C = e.create("td", {}, S); S = O.url; (!k("ie") || 9 <= k("ie") || 9 > k("ie") && ("esri.layers.ArcGISImageServiceLayer" === G.declaredClass || "esri.layers.RasterXLayer" ===
                                                                G.declaredClass)) && O.imageData && 0 < O.imageData.length ? S = "data:image/png;base64," + O.imageData : 0 !== O.url.indexOf("http") && (S = G.url + "/" + L + "/images/" + O.url, (L = G._getToken()) && (S += "?token\x3d" + L)); L = e.create("img", { src: S, border: 0, style: "opacity:" + G.opacity }, Y); O = e.create("td", { innerHTML: t.encode(O.label), align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%", dir: "ltr" }, C)))); P && "Stretched" === P && 10.3 <= G.version && ("esri.layers.ArcGISImageServiceLayer" === G.declaredClass || "esri.layers.RasterXLayer" ===
                                                                        G.declaredClass) && (O.style.verticalAlign = "top", O.style.lineHeight = "1", L.style.marginBottom = "-1px", L.style.display = "block", C.style.verticalAlign = "top"); 9 > k("ie") && (L.style.filter = "alpha(opacity\x3d" + 100 * G.opacity + ")")
                                                }, _getVariable: function (O, C, G) { if (O) var L = (O = O.getVisualVariablesForType(C, G)) && O[0]; return L }, _getVariables: function (O, C, G) {
                                                        O = [this._getVariable(O, "colorInfo", !1), this._getVariable(O, "opacityInfo", !1), this._getVariable(O, "sizeInfo", !1)]; return C ? w.filter(O, function (L) {
                                                                return !(!L || L.field !==
                                                                        C || L.normalizationField != G)
                                                        }) : O
                                                }, _getFieldAlias: function (O, C, G) { var L = C.infoTemplate || (C.infoTemplates && G && C.infoTemplates[G.id] ? C.infoTemplates[G.id].infoTemplate : null); L = L && L.getFieldInfo && L.getFieldInfo(O); O = A.isFunction(O) ? null : this.getField(C, O, G); C = L || O; G = ""; C && (G = L && L.label || O && O.alias || C.name || C.fieldName); return G }, _getDomainName: function (O, C, G, L) { if (O && !A.isFunction(O)) var P = (G = (O = this.getField(G, O, L)) && G.getDomain ? G.getDomain(O.name) : null) && G.codedValues ? G.getName(C) : null; return P }, _getRampTitle: function (O,
                                                        C, G) {
                                                                var L = O.field, P = O.normalizationField, S = !1, Y = !1, ha = !1; L = A.isFunction(L) ? null : L; P = A.isFunction(P) ? null : P; if (O.legendOptions && O.legendOptions.title) var ja = O.legendOptions.title; else if (O.valueExpressionTitle) ja = O.valueExpressionTitle; else {
                                                                        if (C.renderer && C.renderer.authoringInfo && C.renderer.authoringInfo.visualVariables) {
                                                                                var ka = C.renderer.authoringInfo.visualVariables; for (O = 0; O < ka.length; O++) {
                                                                                        var ua = ka[O]; if ("colorInfo" === ua.type && "ratio" === ua.style) { S = !0; break } else if ("colorInfo" === ua.type && "percent" ===
                                                                                                ua.style) { Y = !0; break } else if ("colorInfo" === ua.type && "percentTotal" === ua.style) { ha = !0; break }
                                                                                }
                                                                        } (S = ha && "showRatioPercentTotal" || Y && "showRatioPercent" || S && "showRatio" || P && "showNormField" || L && "showField" || null) && (ja = y.substitute({ field: L && this._getFieldAlias(L, C, G), normField: P && this._getFieldAlias(P, C, G) }, "showField" === S ? "${field}" : this._i18n[S]))
                                                                } return ja
                                                }, _getRendererTitle: function (O, C, G) {
                                                        if (O) {
                                                                if ("esri.renderer.ClassBreaksRenderer" === O.declaredClass) {
                                                                        var L = O.attributeField; var P = O.normalizationField;
                                                                        var S = "percent-of-total" === O.normalizationType
                                                                } L = A.isFunction(L) ? null : L; P = A.isFunction(P) ? null : P; if (O.legendOptions && O.legendOptions.title) var Y = O.legendOptions.title; else O.valueExpressionTitle ? Y = O.valueExpressionTitle : (O = P && "showNormField" || (S ? "showNormPct" : null) || L && "showField" || null) && (Y = y.substitute({ field: L && this._getFieldAlias(L, C, G), normField: P && this._getFieldAlias(P, C, G) }, "showField" === O ? "${field}" : this._i18n[O]))
                                                        } return Y
                                                }, _buildLegendItems_Renderer: function (O, C, G) {
                                                        function L() {
                                                                a.set(b.byId(Ma.id +
                                                                        "_" + O.id + "_" + C.id), "display", "block"); -1 < P && (a.set(b.byId(Ma.id + "_" + O.id + "_" + P + "_group"), "display", "block"), this._findParentGroup(O.id, P))
                                                        } var P = C.parentLayerId, S = this.map, Y = S.getScale(), ha = !1; if (!this._respectCurrentMapScale || this._isLayerInScale(O, C, Y)) {
                                                                var ja, ka, ua; var qa = "esri.layers.ArcGISImageServiceVectorLayer" === O.declaredClass ? O.renderer.renderer : C && C.drawingInfo ? xa.fromJson(A.clone(C.drawingInfo.renderer)) : O.isFeatureReductionActive && O.isFeatureReductionActive() ? O.getFeatureReductionRenderer() :
                                                                        O.renderer; if ("esri.renderer.ScaleDependentRenderer" === qa.declaredClass && (qa = (S = "zoom" === qa.rangeType ? qa.getRendererInfoByZoom(S.getZoom()) : qa.getRendererInfoByScale(Y)) && S.renderer, !qa)) return !1; S = qa && qa.authoringInfo && "relationship" === qa.authoringInfo.type; if ("esri.renderer.StretchRenderer" !== qa.declaredClass && "esri.renderer.ShadedReliefRenderer" !== qa.declaredClass) {
                                                                                Y = this._getVariables(qa); var V = w.filter(Y, function (Ia) { return !!Ia }).length, da = Y[0], Z = Y[1], ea = Y[2], la, oa = !1; if (da) {
                                                                                        var ya = this._getMedianColor(qa,
                                                                                                da); da.field && (ja = A.isFunction(da.field) ? null : this.getField(O, da.field, C)); var ta = !(da.legendOptions && !1 === da.legendOptions.showLegend)
                                                                                } if (Z) { Z.field && (ua = A.isFunction(Z.field) ? null : this.getField(O, Z.field, C)); var Ea = !(Z.legendOptions && !1 === Z.legendOptions.showLegend) } ea && (ea.field && (ka = A.isFunction(ea.field) ? null : this.getField(O, ea.field, C)), oa = (la = !(ea.legendOptions && !1 === ea.legendOptions.showLegend)) && Da.test(ea.valueExpression))
                                                                        } if ("esri.renderer.HeatmapRenderer" === qa.declaredClass) {
                                                                                var Aa = ha =
                                                                                        !0; this._showHeatRamp(O, C, qa, G)
                                                                        } else if ("esri.renderer.DotDensityRenderer" === qa.declaredClass) Aa = ha = !0, this._showDotDensityLegend(O, C, qa, G); else if ("esri.renderer.TemporalRenderer" === qa.declaredClass) {
                                                                                Aa = ha = !0; Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G); var za = e.create("tbody", {}, Y); (O._hoverLabel || O._hoverLabels) && this._createHoverAction(Y, O, C); qa.latestObservationRenderer && "esri.renderer.SimpleRenderer" === qa.latestObservationRenderer.declaredClass &&
                                                                                        this._buildRow_Renderer(O, qa.latestObservationRenderer.symbol, ya, t.encode(qa.latestObservationRenderer.label) || this.NLS_currentObservations, null, za); qa.observationRenderer && "esri.renderer.SimpleRenderer" === qa.observationRenderer.declaredClass && this._buildRow_Renderer(O, qa.observationRenderer.symbol, ya, t.encode(qa.observationRenderer.label) || this.NLS_previousObservations, null, za)
                                                                        } else if ("esri.renderer.UniqueValueRenderer" === qa.declaredClass) {
                                                                                if (qa.infos && 0 < qa.infos.length) {
                                                                                        Aa = ha = !0; if (qa.legendOptions &&
                                                                                                qa.legendOptions.title || qa.valueExpressionTitle) Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G), za = e.create("tbody", {}, Y), V = qa.legendOptions && qa.legendOptions.title ? qa.legendOptions.title : qa.valueExpressionTitle, this._buildRow_Renderer(O, null, ya, t.encode(V), null, za); Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G); za = e.create("tbody", {}, Y); (O._hoverLabel || O._hoverLabels) && this._createHoverAction(Y, O, C); qa.attributeField &&
                                                                                                        ea && this._addSubHeader(za, this._getFieldAlias(qa.attributeField, O, C)); if (S) {
                                                                                                                var Ha = qa.authoringInfo; var Na = Ha.focus; V = Ha.numClasses; var Pa = Ha.field1.field; Y = Ha.field2.field; if (V && Pa && Y) {
                                                                                                                        var Sa = Ha.field1.normalizationField; Ha = Ha.field2.normalizationField; var Ra = Sa && this._i18n.showNormField || Pa && "${field}", La = Ha && this._i18n.showNormField || Y && "${field}"; Pa = y.substitute({ field: this._getFieldAlias(Pa, O, C), normField: Sa && this._getFieldAlias(Sa, O, C) }, Ra); Y = y.substitute({
                                                                                                                                field: this._getFieldAlias(Y, O, C), normField: Ha &&
                                                                                                                                        this._getFieldAlias(Ha, O, C)
                                                                                                                        }, La); Sa = { shapeDescriptor: wa, rotation: this._getRotationAngleForFocus(Na) || 0 }; this._buildRow_Renderer(O, null, null, t.encode(Pa), null, za, null, Sa); Sa.rotation += 90; this._buildRow_Renderer(O, null, null, t.encode(Y), null, za, null, Sa); this._drawRelationshipLegend(G, { numClasses: V, focus: Na, uvInfos: qa.infos })
                                                                                                                }
                                                                                                        } else {
                                                                                                                var Wa = []; w.forEach(qa.infos, function (Ia) {
                                                                                                                        var Xa = null; this._isLayerEditable(O) && O.types && (Xa = this._getTemplateFromTypes(O.types, Ia.value)); var hb = Ia.label; null == hb && (hb = this._getDomainName(qa.attributeField,
                                                                                                                                Ia.value, O, C) || Ia.value); -1 === w.indexOf(Wa, hb) && (Wa.push(hb), Ia = Ia.symbol, Ia = this._applyScaleDrivenSymbolSize(Ia, qa, ea, oa), this._buildRow_Renderer(O, Ia, ya, t.encode(hb), Xa, za))
                                                                                                                }, this)
                                                                                        }
                                                                                } Na = !S && this._displayDefaultSymbol(O, qa, G, ea, oa)
                                                                        } else if ("esri.renderer.ClassBreaksRenderer" === qa.declaredClass) {
                                                                                if (qa.infos && 0 < qa.infos.length || "esri.layers.ArcGISImageServiceVectorLayer" === O.declaredClass) {
                                                                                        Aa = ha = !0; var gb = this._isUnclassedRenderer(qa); if (!da && 1 === qa.infos.length) var $a = ($a = qa.infos[0]) && $a.symbol; gb ||
                                                                                                (Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G), za = e.create("tbody", {}, Y), V = this._getRendererTitle(qa, O, C), this._buildRow_Renderer(O, null, ya, t.encode(V), null, za)); Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G); za = e.create("tbody", {}, Y); (O._hoverLabel || O._hoverLabels) && this._createHoverAction(Y, O, C); gb && ea && la && !oa || (S = qa.infos.slice(0).reverse(), w.forEach(S, function (Ia) {
                                                                                                        var Xa = Ia.label; null != Xa || gb || (Xa = Ia.minValue +
                                                                                                                " - " + Ia.maxValue); Ia = Ia.symbol; Ia = this._applyScaleDrivenSymbolSize(Ia, qa, ea, oa); this._buildRow_Renderer(O, Ia, ya, t.encode(Xa), null, za)
                                                                                                }, this)); "esri.layers.ArcGISImageServiceVectorLayer" !== O.declaredClass || O.renderer.style !== K.STYLE_SCALAR && O.renderer.style !== K.STYLE_SINGLE_ARROW || (this._buildRow_Renderer(O, qa.defaultSymbol, null, "", null, za), O._hideDefaultSymbol = !0)
                                                                                } gb || (Na = this._displayDefaultSymbol(O, qa, G, ea, oa))
                                                                        } else if ("esri.renderer.StretchRenderer" === qa.declaredClass) {
                                                                                Aa = ha = !0; Y = e.create("table",
                                                                                        { cellpadding: 0, cellspacing: 0, width: "95%", class: "esriLegendLayer" }, G); za = e.create("tbody", {}, Y); var Ma = this, Ja, Va, kb = function () { qa.statistics.length ? (Ja = qa.statistics[0][1], Va = qa.statistics[0][0]) : (Va = bb ? bb.minValues[0] : O.minValues[0], Ja = bb ? bb.maxValues[0] : O.maxValues[0]); "esri.layers.RasterXLayer" === O.declaredClass && O.hasStdTime() && (Va = O.getStdTimeValue(Va), Ja = O.getStdTimeValue(Ja)); Ma._createStretchLegend(za, qa, Va, Ja) }; if (O.renderingRule) O.getRenderingRuleServiceInfo(O.renderingRule).then(function (Ia) {
                                                                                                var Xa =
                                                                                                        Ia && Ia.minValues && 0 < Ia.minValues.length && Ia.maxValues && 0 < Ia.maxValues.length; Ia && 1 < Ia.bandCount || !Xa ? Ma._legendRequest(O).then(function (hb) { Ma._processLegendResponse(O, hb) }) : kb()
                                                                                        }); else {
                                                                                                var bb = O.serviceInfo; if ("esri.layers.RasterXLayer" === O.declaredClass && (bb = O.raster.serviceInfo, O.hasMultidimensions && (!qa.statistics || !qa.statistics.length))) return G = O.mosaicRule && O.mosaicRule.multidimensionalDefinition, O.getStatistics(G && G.length ? G[0].variableName : O._defaultMultidimensionalDefinition[0].variableName).then(A.hitch(this,
                                                                                                        function (Ia) { this._createStretchLegend(za, qa, Ia[0][0], Ia[0][1]); L() })), ha; kb()
                                                                                }
                                                                        } else "esri.renderer.ShadedReliefRenderer" === qa.declaredClass ? (Aa = ha = !0, Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", class: "esriLegendLayer" }, G), za = e.create("tbody", {}, Y), this._createStretchLegend(za, qa, 0, 255)) : "esri.renderer.SimpleRenderer" === qa.declaredClass ? (Aa = ha = !0, Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G), za = e.create("tbody", {}, Y), (O._hoverLabel || O._hoverLabels) &&
                                                                                this._createHoverAction(Y, O, C), $a = null, this._isLayerEditable(O) && O.templates && 0 < O.templates.length && ($a = O.templates[0]), S = 1 < V ? null : ja && ta || ua && Ea || ka && la, this._buildRow_Renderer(O, qa.symbol, ya, t.encode(S ? this._getRampTitle(1 < V ? null : da || Z || ea, O, C) : qa.label), $a, za), $a = da ? null : qa.symbol, S && (ja = ua = ka = null)) : "esri.renderer.ColormapRenderer" === qa.declaredClass && (qa.colormapInfos && qa.colormapInfos.length && (Aa = ha = !0), Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G),
                                                                                        za = e.create("tbody", {}, Y), qa.colormapInfos.forEach(function (Ia) { var Xa = new ma(ma.STYLE_SOLID, null, new r(Ia.color)); this._buildRow_Renderer(O, Xa, null, Ia.label, null, za) }, this), O._hideDefaultSymbol = !0); Aa && (da && ta && (da.field || da.valueExpression) && this._showGradientRamp(O, C, qa, null, G, da, ja, null, ea && la ? !0 : !1), ea && la && (ea.field || ea.valueExpression && !oa) && (Aa = da && ta || "esri.renderer.UniqueValueRenderer" === qa.declaredClass ? !1 : !0, this._showSizeLegend(O, C, qa, ea, ya, G, ka, null, Aa)), Z && Ea && (Z.field || Z.valueExpression) &&
                                                                                                this._showGradientRamp(O, C, qa, $a && !$a.url && $a.color ? $a.color : this.transparencyRampColor, G, Z, ua, null, !1)); Na || gb && !ta && !la && !Ea || (Na = this._displayDefaultSymbol(O, qa, G, ea, oa)); ha = ha || Na
                                                        } Ma = this; ha && L(); return ha
                                                }, _createStretchLegend: function (O, C, G, L) {
                                                        var P = e.create("tr", {}, O); var S = e.create("td", { rowspan: 2, "class": "esriStretchLegend" }, P); C = e.toDom(this._addColorRamp(C.colorRamp)); e.place(C, S); e.create("td", {}, P).innerHTML = this._i18n.high + ": " + ("string" === typeof L ? L : Math.round(L * Math.pow(10, 3)) / Math.pow(10,
                                                                3)); O = e.create("tr", {}, O); e.create("td", {}, O).innerHTML = this._i18n.low + ": " + ("string" === typeof G ? G : Math.round(G * Math.pow(10, 3)) / Math.pow(10, 3))
                                                }, _addColorRamp: function (O) { O || (O = { algorithm: "hsv", fromColor: [0, 0, 0, 1], toColor: [255, 255, 255, 1] }); var C = this._generateColorRampDivs(O); O.label = "\x3cdiv class\x3d'esriStretchLegendGradientLabel'\x3e" + C + "\x3c/div\x3e"; return O.label }, _generateColorRampDivs: function (O) {
                                                        if (O) {
                                                                var C = ""; if ("multipart" === O.type) {
                                                                        var G = 100 / O.colorRamps.length; var L = O.colorRamps; Object.keys(L).reverse().forEach(function (P) {
                                                                                C +=
                                                                                this._generateSingleGradientDiv(L[P].fromColor, L[P].toColor, G)
                                                                        }, this)
                                                                } else C = this._generateSingleGradientDiv(O.fromColor, O.toColor, 100); return C
                                                        }
                                                }, _generateSingleGradientDiv: function (O, C, G) {
                                                        if (O && C) {
                                                                var L = ""; O = O.toRgb ? O.toRgb() : O; C = C.toRgb ? C.toRgb() : C; var P = "(0deg, rgb(" + O.slice(0, 3).join() + "), rgb(" + C.slice(0, 3).join() + "));"; w.forEach(["-webkit-linear-gradient", "-o-linear-gradient", "-moz-linear-gradient", "linear-gradient"], function (S) { L += "background: " + S + P }); return "\x3cdiv class\x3d'esriStretchLegendSingleGradient' style\x3d'height:" +
                                                                        G + "%;" + L + "'\x3e\x3c/div\x3e"
                                                        }
                                                }, _isLayerEditable: function (O) { return "function" === typeof O.isEditable && O.isEditable() }, _isUnclassedRenderer: function (O, C) { var G = O.infos; G = G ? G.length : 0; if ("esri.renderer.ClassBreaksRenderer" === O.declaredClass && 1 === G) { G = O.attributeField; var L = O.normalizationField; O = C ? G === C : !!this._getVariables(O, G, L).length } else O = O.authoringInfo && O.authoringInfo.type, O = 2 === G && "univariateColorSize" === O; return O }, _displayDefaultSymbol: function (O, C, G, L, P) {
                                                        var S = C.defaultSymbol; if (!O._hideDefaultSymbol &&
                                                                S) { var Y = !0; G = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, G); G = e.create("tbody", {}, G); S = this._applyScaleDrivenSymbolSize(S, C, L, P); this._buildRow_Renderer(O, S, null, t.encode(C.defaultLabel) || "others", null, G) } return Y
                                                }, _applyScaleDrivenSymbolSize: function (O, C, G, L) { L && (O = va.fromJson(O.toJson()), this._applySize(O, C, G, null)); return O }, _showGradientRamp: function (O, C, G, L, P, S, Y, ha, ja) {
                                                        ja = e.create("table", {
                                                                cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" +
                                                                        (ja ? "" : " esriLegendSubFragment")
                                                        }, P); P = e.create("tbody", {}, ja); (O._hoverLabel || O._hoverLabels || ha) && this._createHoverAction(ja, O, C, ha); (Y || S.valueExpression || S.legendOptions && S.legendOptions.title) && this._addSubHeader(P, this._getRampTitle(S, O, C)); Y = S.field; var ka; Y && (ka = A.isFunction(Y) ? null : this.getField(O, Y, C)); if (S = (C = this._getRampStops(G, S, L, ka && "esriFieldTypeDate" === ka.type)) ? C.length : 0) S = 10 < S, this._drawGradientRamp(P, C, !S, O, this._getRampBorderColor(G), !!L, S)
                                                }, _getMedianColor: function (O, C) {
                                                        if (C.colors) {
                                                                var G =
                                                                        C.minDataValue; var L = C.maxDataValue
                                                        } else C.stops && (G = C.stops[0].value, L = C.stops[C.stops.length - 1].value); return O.getColor(G + (L - G) / 2, { colorInfo: C })
                                                }, _getRampStops: function (O, C, G, L) {
                                                        var P, S, Y = !1; if (C.colors || C.opacityValues) { var ha = C.maxDataValue - C.minDataValue; var ja = w.map([0, .25, .5, .75, 1], function (V) { P = C.minDataValue + V * ha; return Number(P.toFixed(6)) }); this._checkPrecision(0, 4, ja) } else C.stops && (ja = w.map(C.stops, function (V) { return V.value }), L || w.some(ja, function (V) { return 2 < D.getDigits(V).fractional }) &&
                                                                (ja = D.round(ja)), (Y = w.some(C.stops, function (V) { return !!V.label })) && (S = w.map(C.stops, function (V) { return V.label }))); var ka = ja[0], ua, qa; ha = ja[ja.length - 1] - ka; return w.map(ja, function (V, da) {
                                                                        G ? (ua = new r(G.toRgba()), qa = O.getOpacity(V, { opacityInfo: C }), null != qa && (ua.a = qa)) : ua = O.getColor(V, { colorInfo: C }); var Z = ""; if (Y) Z = S[da]; else { Z = L ? H.formatDate(V, H.timelineDateFormatOptions) : D.format(V); var ea = ""; 0 === da ? ea = this._specialChars.lt + " " : da === ja.length - 1 && (ea = this._specialChars.gt + " "); Z = ea + Z } return {
                                                                                value: V,
                                                                                color: ua, offset: 1 - (V - ka) / ha, label: Z
                                                                        }
                                                                }, this).reverse()
                                                }, _checkPrecision: function (O, C, G) { var L = O + (C - O) / 2, P = G[O], S = G[L], Y = G[C], ha = Math.floor(P), ja = Math.floor(S), ka = Math.floor(Y); ha === P && ka === Y && ja !== S && ha !== ja && ka !== ja && (G[L] = ja); O + 1 !== L && this._checkPrecision(O, L, G); L + 1 !== C && this._checkPrecision(L, C, G) }, _getRampBorderColor: function (O) {
                                                        if ("esri.renderer.SimpleRenderer" === O.declaredClass) var C = O.symbol; else if ("esri.renderer.UniqueValueRenderer" === O.declaredClass || "esri.renderer.ClassBreaksRenderer" ===
                                                                O.declaredClass) C = O.infos[0].symbol; return (O = C && -1 === C.type.indexOf("linesymbol") ? C.getStroke() : null) && O.color
                                                }, _drawGradientRamp: function (O, C, G, L, P, S, Y) {
                                                        var ha = e.create("tr", {}, O), ja = C.length - 1, ka; var ua = 0; if (this.alignRight) { O = e.create("td", { align: this._isRightToLeft ? "left" : "right" }, ha); var qa = e.create("td", { align: this._isRightToLeft ? "left" : "right", width: this.gradientWidth }, ha) } else qa = e.create("td", { width: this.gradientWidth, align: "center" }, ha), O = e.create("td", {}, ha); ha = P && 0 < P.a && !(240 <= P.r && 240 <=
                                                                P.g && 240 <= P.b); var V = e.create("div", { "class": ha ? "" : "esriLegendBorderLessColorRamp", style: "position: relative; width:" + this.gradientWidth + "px;" }, qa); qa = e.create("div", { "class": "esriLegendColorRamp" + (S ? " esriLegendTransparencyRamp" : "") }, V); S = a.get(qa, "width"); ha && (P = 9 > k("ie") ? P.toHex() : "rgba(" + P.toRgba().join(",") + ")", a.set(qa, "border", this.colorRampBorder + " " + P)); G ? (P = this.gradientHeight * ja, a.set(qa, "height", P + "px")) : P = a.get(qa, "height"); a.set(V, "height", P + "px"); ha = p.createSurface(qa, S, P); 9 > k("ie") &&
                                                                        (ua = ha.getEventSource(), a.set(ua, "position", "relative"), a.set(ua.parentNode, "position", "relative"), ua = 1); try { G && w.forEach(C, function (ea, la) { ea.offset = la / ja }); var da = ha.createRect({ x: -ua, y: -ua, width: S + ua, height: P + ua }); da.setFill({ type: "linear", x1: 0, y1: 0, x2: 0, y2: P, colors: C }).setStroke(null); ha.createRect({ width: S, height: P }).setFill(new r([255, 255, 255, 1 - L.opacity])).setStroke(null); this._surfaceItems.push(ha) } catch (ea) { ha.clear(), ha.destroy() } w.forEach(C, function (ea, la) {
                                                                                ea.label && (ka = "top:" + 100 * ea.offset +
                                                                                        "%;", ea = "", 0 === la && (ea += " esriLegendColorRampTickFirst"), la === C.length - 1 && (ea += " esriLegendColorRampTickLast"), e.create("div", { "class": "esriLegendColorRampTick" + ea, innerHTML: "\x26nbsp;", style: ka }, V))
                                                                        }); var Z = e.create("div", { "class": "esriLegendColorRampLabels", style: { height: P + this.gradientHeight + "px" } }, O); G ? w.forEach(C, function (ea) { e.create("div", { "class": "esriLegendColorRampLabel", innerHTML: t.encode(ea.label) || "\x26nbsp;" }, Z) }) : (e.create("div", {
                                                                                "class": "esriLegendColorRampLabel", innerHTML: Y ? t.encode(C[0].label) ||
                                                                                        "\x26nbsp;" : this._i18n.high
                                                                        }, Z), e.create("div", { "class": "esriLegendColorRampLabel", innerHTML: Y ? t.encode(C[C.length - 1].label) || "\x26nbsp;" : this._i18n.low, style: "top: " + (P + this.gradientHeight - 2 * this.gradientHeight) + "px;" }, Z))
                                                }, _showHeatRamp: function (O, C, G, L, P) {
                                                        var S = G.field; var Y = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" }, L); L = e.create("tbody", {}, Y); (O._hoverLabel || O._hoverLabels || P) && this._createHoverAction(Y, O, C, P); (S = S && this.getField(O, S, C)) && this._addSubHeader(L,
                                                                this._getFieldAlias(S.name, O, C)); C = this._getHeatmapStops(G); C.length && this._drawGradientRamp(L, C, !1, O)
                                                }, _getHeatmapStops: function (O) {
                                                        var C = O.colorStops; O = O.colors; if (C && C[0]) { var G = C.length - 1; if (O = C[0] && null != C[0].ratio) (O = C[G]) && 1 !== O.ratio && (C = C.slice(0), C.push({ ratio: 1, color: O.color }), G++); else { var L = C[0].value; var P = C[G].value - L; C = w.map(C, function (Y) { return { color: Y.color, ratio: (Y.value - L) / P } }) } } else if (O && O[0]) {
                                                                G = O.length - 1; var S = 1 / (O.length - 1); C = w.map(O, function (Y, ha) {
                                                                        return {
                                                                                color: Y, ratio: ha *
                                                                                        S
                                                                        }
                                                                })
                                                        } C = w.map(C, function (Y, ha) { var ja = ""; 0 === ha ? ja = "Low" : ha === G && (ja = "High"); return { color: Y.color, label: ja, offset: 1 - Y.ratio } }); return C.reverse()
                                                }, _showDotDensityLegend: function (O, C, G, L) {
                                                        var P = G.legendOptions, S, Y = this.dotDensitySwatchSize, ha = Math.round(Y / 2); if (P) { var ja = P.backgroundColor; var ka = P.outline; var ua = P.valueUnit; var qa = P.dotCoverage } qa = (qa || this.dotCoverage) / 100; var V = Math.round(Y * Y / Math.pow(G.dotSize, 2) * qa); L = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" },
                                                                L); var da = e.create("tbody", {}, L); (O._hoverLabel || O._hoverLabels) && this._createHoverAction(L, O, C); this._addSubHeader(da, y.substitute({ value: G.dotValue, unit: ua || "" }, this.NLS_dotValue)); w.forEach(G.fields, function (Z) {
                                                                        Z = A.mixin({}, Z); Z.numPoints = V; S = new X(G._generateImageSrc(Y, Y, [Z], { x: 0, y: 0 }, { x: Y, y: Y }, ja), ka || G.outline, Y, Y); Z = this.getField(O, Z.name, C) || Z; this._buildRow_Renderer(O, S, null, t.encode(this._getFieldAlias(Z.name, O, C)), null, da, {
                                                                                type: "path", path: "M " + -ha + "," + -ha + " L " + ha + "," + -ha + " L " + ha + "," +
                                                                                        ha + " L " + -ha + "," + ha + " L " + -ha + "," + -ha + " E"
                                                                        })
                                                                }, this)
                                                }, _showSizeLegend: function (O, C, G, L, P, S, Y, ha, ja) {
                                                        var ka = L.legendOptions; ka = ka && ka.customValues; P = this._getSizeSymbol(G, P); if ((!L.valueUnit || "unknown" === L.valueUnit) && P && (ka || null != L.minSize && null != L.maxSize && null != L.minDataValue && null != L.maxDataValue || L.stops && !(1 >= L.stops.length))) {
                                                                ja = e.create("table", { cellpadding: 0, cellspacing: 0, width: "95%", "class": "esriLegendLayer" + (ja ? "" : " esriLegendSubFragment") }, S); S = e.create("tbody", {}, ja); (O._hoverLabel || O._hoverLabels ||
                                                                        ha) && this._createHoverAction(ja, O, C, ha); (Y || L.valueExpression || L.legendOptions && L.legendOptions.title) && this._addSubHeader(S, this._getRampTitle(L, O, C)); Y = (ja = (ha = L.field) && !A.isFunction(ha)) && "cluster_count" === ha.toLowerCase(); C = (C = ja ? O.isFeatureReductionActive && O.isFeatureReductionActive() ? O.getFeatureReductionField(ha) : this.getField(O, ha, C) : null) && "esriFieldTypeDate" === C.type; ka = ka || this._getDataValues(G, P, L, C, Y); var ua = ka.length - 1; for (ha = ua; 0 <= ha; ha--) {
                                                                                ja = ka[ha]; P = va.fromJson(P.toJson()); this._applySize(P,
                                                                                        G, L, ja); ja = C ? H.formatDate(ja, H.timelineDateFormatOptions) : D.format(ja); var qa = ""; ha === ua ? qa = this._specialChars.gt + " " : 0 === ha && (qa = Y && 1 === ka[ha] ? "" : this._specialChars.lt + " "); qa = "\x3cspan class\x3d'esriLegendSizeRampLabel'\x3e" + t.encode(qa + ja) + "\x3c/span\x3e"; this._buildRow_Renderer(O, P, null, qa, null, S)
                                                                        }
                                                        }
                                                }, _getSizeSymbol: function (O, C) {
                                                        if ("esri.renderer.SimpleRenderer" === O.declaredClass) var G = O.symbol; else if ("esri.renderer.VectorFieldRenderer" === O.declaredClass) G = O.defaultSymbol; else if ("esri.renderer.UniqueValueRenderer" ===
                                                                O.declaredClass || "esri.renderer.ClassBreaksRenderer" === O.declaredClass) { G = O.infos[0].symbol; var L = 1 < O.infos.length } if (G = G && -1 !== G.type.indexOf("fillsymbol") ? null : G) if (G = va.fromJson(G.toJson()), C || L) -1 !== G.type.indexOf("linesymbol") ? G.setColor(new r(this.sizeRampDarkColor)) : (G.setColor(new r(this.sizeRampLightColor)), G.setOutline && (O = new fa, O.setColor(new r(this.sizeRampDarkColor)), O.setWidth(1.5), G.setOutline(O))); return G
                                                }, _getDataValues: function (O, C, G, L, P) {
                                                        if (P) {
                                                                var S; w.some([5, 3, 2], function (Y) {
                                                                        Y =
                                                                        this._getDataValuesByCount(O, C, G, L, Y); this._hasFractionalValues(Y) || (S = Y); return !!S
                                                                }, this); return S
                                                        } return (P = O.authoringInfo) && "univariateColorSize" === P.type && "above-and-below" === P.univariateTheme && G.stops ? this._getDataValuesFromStops(G, L) : this._getDataValuesByCount(O, C, G, L, 5)
                                                }, _getDataValuesFromStops: function (O, C) { O = w.map(O.stops, function (G) { return G.value }); return C ? O : D.round(O) }, _getDataValuesByCount: function (O, C, G, L, P, S) {
                                                        P = null == P ? 5 : P; S = null == S ? 20 : S; var Y = O.getSizeRangeAtScale(G, this.map.getScale());
                                                        P = this._interpolateSizeRange(Y, P); var ha = this._getDataRange(G), ja = w.map(P, function (ua) { return this._getDataValueFromSize(ua, ha, Y) }, this); if (!L) { var ka; ja = D.round(ja); for (L = 1; L < ja.length - 1; L++)if (ka = this._roundDataValue(O, C, G, ja[L], ja[L - 1], S)) ja[L] = ka[0], P[L] = ka[1] } return ja
                                                }, _hasFractionalValues: function (O) { return w.some(O, function (C) { return C !== Math.floor(C) }) }, _getDataRange: function (O) { var C = O.stops; return C ? { min: C[0].value, max: C[C.length - 1].value } : { min: O.minDataValue, max: O.maxDataValue } }, _interpolateSizeRange: function (O,
                                                        C) { var G = O.minSize; O = (O.maxSize - G) / (C - 1); var L, P = []; for (L = 0; L < C; L++)P.push(G + O * L); return P }, _getDataValueFromSize: function (O, C, G) { var L = G.minSize; G = G.maxSize; var P = C.min; C = C.max; return O <= L ? P : O >= G ? C : (O - L) / (G - L) * (C - P) + P }, _roundDataValue: function (O, C, G, L, P, S) {
                                                                var Y = this._getSize(C, O, G, L); P = this._getSize(C, O, G, P); var ha = D.getDigits(L), ja = ha.integer; ha = ha.fractional; var ka; if (0 < L && 1 > L) { var ua = Math.pow(10, ha); L *= ua; ja = D.getDigits(L).integer } for (--ja; 0 <= ja; ja--) {
                                                                        var qa = Math.pow(10, ja); ha = Math.floor(L / qa) *
                                                                                qa; qa *= Math.ceil(L / qa); null != ua && (ha /= ua, qa /= ua); var V = (ha + qa) / 2; V = D.round([ha, V, qa], { indexes: [1] })[1]; var da = this._getSize(C, O, G, ha); var Z = this._getSize(C, O, G, qa); var ea = this._getSize(C, O, G, V); var la = D.getPctChange(Y, da, P, null); var oa = D.getPctChange(Y, Z, P, null); var ya = D.getPctChange(Y, ea, P, null); var ta = la.prev <= S; var Ea = oa.prev <= S; ta && Ea && (la.prev <= oa.prev ? (ta = !0, Ea = !1) : (Ea = !0, ta = !1)); ta ? ka = [ha, da] : Ea ? ka = [qa, Z] : ya.prev <= S && (ka = [V, ea]); if (ka) break
                                                                } return ka
                                                        }, _applySize: function (O, C, G, L) {
                                                                var P = O.type;
                                                                C = this._getSize(O, C, G, L); switch (P) { case "simplemarkersymbol": O.setSize(C); break; case "picturemarkersymbol": P = O.width; G = O.height; O.setHeight(C); O.setWidth(P / G * C); break; case "simplelinesymbol": case "cartographiclinesymbol": O.setWidth(C); break; case "textsymbol": O.font && O.font.setSize(C) }
                                                        }, _getSize: function (O, C, G, L) { return C.getSize(L, { sizeInfo: G, scale: this.map.getScale(), shape: -1 !== O.type.indexOf("markersymbol") ? O.style : null }) }, _buildRow_Renderer: function (O, C, G, L, P, S, Y, ha) {
                                                                var ja = !!ha, ka = e.create("tr",
                                                                        {}, S); if (this.alignRight) { if (S = e.create("td", { align: this._isRightToLeft ? "left" : "right" }, ka), C || ja) var ua = e.create("td", { align: this._isRightToLeft ? "left" : "right", width: 35 }, ka) } else { if (C || ja) ua = e.create("td", { width: 35, align: "center" }, ka); S = e.create("td", {}, ka) } var qa = ka = 30; if (C) if ("simplemarkersymbol" === C.type) ka = Math.min(Math.max(ka, C.size + 12), 125), qa = Math.min(Math.max(qa, C.size + 12), 125); else if ("picturemarkersymbol" === C.type) ka = Math.min(Math.max(ka, C.width), 125), qa = Math.min(C.height || qa, 125); else if ("textsymbol" ===
                                                                                C.type) { if (!C.text) { var V = C.text; var da = !0; C.setText(this.defaultText) } ka = Math.min(Math.max(ka, C.getWidth() + 12), 125); qa = Math.min(Math.max(qa, C.getHeight() + 12), 125); da && C.setText(V) } if (C || ja) var Z = e.create("div", { style: "width:" + ka + "px;height:" + qa + "px;" }, ua); y.isDefined(L) && "number" === typeof L && (L = "" + L); e.create("td", { innerHTML: L || "", align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%" }, S)))); if (C || ja) O = this._drawSymbol(Z, C, G, ka, qa, P, O, Y, ha), this._surfaceItems.push(O)
                                                        },
                                                _addSubHeader: function (O, C) { O = e.create("tr", {}, O); O = e.create("td", { align: this._align, colspan: 2 }, O); e.create("td", { innerHTML: t.encode(C) || "", align: this._align }, e.create("tr", {}, e.create("tbody", {}, e.create("table", { width: "95%" }, O)))) }, _drawSymbol: function (O, C, G, L, P, S, Y, ha, ja) {
                                                        var ka = C && va.fromJson(C.toJson()), ua = Y.opacity; C = !!ja; if (ka) if (G && ka.setColor(new r(G.toRgba())), "simplelinesymbol" === ka.type || "cartographiclinesymbol" === ka.type || "textsymbol" === ka.type) {
                                                                if (!ka.color) return; G = ka.color.toRgba();
                                                                G[3] *= ua; ka.color.setColor(G)
                                                        } else "simplemarkersymbol" === ka.type || "simplefillsymbol" === ka.type ? (ka.color && (G = ka.color.toRgba(), G[3] *= ua, ka.color.setColor(G)), ka.outline && ka.outline.color && (G = ka.outline.color.toRgba(), G[3] *= ua, ka.outline.color.setColor(G))) : "picturemarkersymbol" === ka.type && (O.style.opacity = ua, O.style.filter = "alpha(opacity\x3d(" + 100 * ua + "))"); O = p.createSurface(O, L, P); 9 > k("ie") && (G = O.getEventSource(), a.set(G, "position", "relative"), a.set(G.parentNode, "position", "relative")); S = C ? ja.shapeDescriptor :
                                                                this._getDrawingToolShape(ka, S) || va.getShapeDescriptors(ka); ua = (G = S.defaultShape) && "text" === G.type; try { ua && !G.text && (G.text = this.defaultText); var qa = O.createShape(ha || G).setFill(S.fill).setStroke(S.stroke); ua && qa.setFont(S.font) } catch (Z) { O.clear(); O.destroy(); return } var V = qa.getBoundingBox(); ha = V.width; S = V.height; ua = -(V.x + ha / 2); var da = -(V.y + S / 2); G = O.getDimensions(); ua = { dx: ua + G.width / 2, dy: da + G.height / 2 }; if (ka && "simplemarkersymbol" === ka.type && "path" === ka.style) L = Y._getScaleMatrix(V, ka.size), qa.applyTransform(B.scaleAt(L.xx,
                                                                        L.yy, { x: G.width / 2, y: G.height / 2 })); else if (ha > L || S > P) Y = ha / L > S / P, L = ((Y ? L : P) - 5) / (Y ? ha : S), A.mixin(ua, { xx: L, yy: L }); qa.applyTransform(ua); C && qa.applyTransform(B.rotategAt(ja.rotation, ha / 2, S / 2)); return O
                                                }, _getDrawingToolShape: function (O, C) {
                                                        switch (C ? C.drawingTool || null : null) {
                                                                case "esriFeatureEditToolArrow": C = { type: "path", path: "M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 Z" }; break; case "esriFeatureEditToolTriangle": C = { type: "path", path: "M -10,14 L 2,-10 L 14,14 L -10,14 Z" }; break; case "esriFeatureEditToolRectangle": C =
                                                                        { type: "path", path: "M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z" }; break; case "esriFeatureEditToolCircle": C = { type: "circle", cx: 0, cy: 0, r: 10 }; break; case "esriFeatureEditToolEllipse": C = { type: "ellipse", cx: 0, cy: 0, rx: 10, ry: 5 }; break; default: return null
                                                        }return { defaultShape: C, fill: O.getFill(), stroke: O.getStroke() }
                                                }, _drawRelationshipLegend: function (O, C) {
                                                        var G = C.focus, L = C.numClasses, P = sa[L], S = !!G, Y = Math.sqrt(Math.pow(75, 2) + Math.pow(75, 2)), ha = {}; C.uvInfos.forEach(function (qa) { ha[qa.value] = { label: qa.label, fill: this._getSymbolColor(qa.symbol) } },
                                                                this); C = []; for (var ja = 0; ja < L; ja++) { for (var ka = [], ua = 0; ua < L; ua++)ka.push(ha[P[ja][ua]].fill); C.push(ka) } P = this._getRelationshipCornerLabels(G, ha); O = this._drawRampLayout(O, P, Y, S); O = p.createSurface(O, Y, Y); S || (O.rawNode.style.margin = "-15px -15px -18px -15px"); C = ia.create2DColorRamp({ surface: O, colors: C, numClasses: L, size: 75 }); L = (Y - 75) / 2; Y = (Y - 75) / 2; C.applyTransform(B.translate(L, Y)); S && C.applyTransform(B.rotategAt(this._getRotationAngleForFocus(G), 37.5, 37.5)); C = O.createGroup(); P = { width: 1, color: "#555555" };
                                                        ja = O.defNode; this._createArrowMarker(ja, "start"); this._createArrowMarker(ja, "end"); ja = C.createLine({ x1: -10, y1: 60, x2: -10, y2: 15 }).setStroke(P); P = C.createLine({ x1: 15, y1: 85, x2: 60, y2: 85 }).setStroke(P); this._setLineArrow(ja.rawNode, "left", G); this._setLineArrow(P.rawNode, "right", G); C.applyTransform(B.translate(L, Y)); S && C.applyTransform(B.rotategAt(-45, 37.5, 37.5)); this._surfaceItems.push(O)
                                                }, _drawRampLayout: function (O, C, G, L) {
                                                        var P = e.create("div", { style: { padding: "10px" } }, O); O = G + "px"; var S = G + "px"; G = "rtl" ===
                                                                document.dir; L ? (L = e.create("div", { style: { display: "flex" } }, P), e.create("div", { class: "esriLegendRelationshipLabel", style: { alignSelf: "center", maxWidth: O, textAlign: "right" }, innerHTML: G ? C.right : C.left }, L), P = e.create("div", { style: { display: "flex", flexDirection: "column", textAlign: "center" } }, L), e.create("div", { class: "esriLegendRelationshipLabel", style: { alignSelf: "center", maxWidth: O }, innerHTML: G ? C.left : C.right }, L), L = e.create("div", { class: "esriLegendRelationshipLabel", style: { alignSelf: "center", maxWidth: O }, innerHTML: C.top },
                                                                        P), L = e.create("div", { style: { height: S, width: S } }, P), P = e.create("div", { class: "esriLegendRelationshipLabel", style: { alignSelf: "center", maxWidth: O }, innerHTML: C.bottom }, P)) : (P = e.create("div", { style: { display: "table", color: "#555555" } }, P), L = e.create("div", { style: { display: "table-row" } }, P), S = e.create("div", { style: { display: "table-row" } }, P), P = e.create("div", { style: { display: "table-row" } }, P), e.create("div", {
                                                                                class: "esriLegendRelationshipLabel", style: { display: "table-cell", maxWidth: O, textAlign: "right", verticalAlign: "bottom" },
                                                                                innerHTML: G ? C.top : C.left
                                                                        }, L), e.create("div", { style: { display: "table-cell" } }, L), e.create("div", { class: "esriLegendRelationshipLabel", style: { display: "table-cell", maxWidth: O, textAlign: "left", verticalAlign: "bottom" }, innerHTML: G ? C.left : C.top }, L), e.create("div", { style: { display: "table-cell" } }, S), L = e.create("div", { style: { display: "table-cell" } }, S), e.create("div", { style: { display: "table-cell" } }, S), e.create("div", {
                                                                                class: "esriLegendRelationshipLabel", style: { display: "table-cell", maxWidth: O, textAlign: "right", verticalAlign: "top" },
                                                                                innerHTML: G ? C.right : C.bottom
                                                                        }, P), e.create("div", { style: { display: "table-cell" } }, P), e.create("div", { class: "esriLegendRelationshipLabel", style: { display: "table-cell", maxWidth: O, textAlign: "left", verticalAlign: "top" }, innerHTML: G ? C.bottom : C.right }, P)); return L
                                                }, _getSymbolColor: function (O) { if (O) return "simplelinesymbol" === O.type || "simplemarkersymbol" === O.type && (O.style === W.STYLE_X || O.style === W.STYLE_CROSS) ? (O = O.getStroke()) && O.color : O.getFill() }, _getRotationAngleForFocus: function (O) {
                                                        var C = aa[O]; O && null == C &&
                                                                (C = aa.HH); return C
                                                }, _setLineArrow: function (O, C, G) { var L = this.id + "_arrowStart", P = this.id + "_arrowEnd"; C = "left" === C; switch (G) { case "HL": O.setAttribute(C ? "marker-start" : "marker-end", "url(#" + (C ? P : L) + ")"); break; case "LL": O.setAttribute("marker-start", "url(#" + P + ")"); break; case "LH": O.setAttribute(C ? "marker-end" : "marker-start", "url(#" + (C ? L : P) + ")"); break; default: O.setAttribute("marker-end", "url(#" + L + ")") } }, _createArrowMarker: function (O, C) {
                                                        var G = "start" === C, L = this.id + (G ? "_arrowStart" : "_arrowEnd"); C = G ? "0,0 5,5 0,10" :
                                                                "5,0 0,5 5,10"; var P = G ? 5 : 0; G = document.createElementNS("http://www.w3.org/2000/svg", "marker"); G.setAttribute("id", L); G.setAttribute("markerWidth", "10"); G.setAttribute("markerHeight", "10"); G.setAttribute("refX", P); G.setAttribute("refY", "5"); G.setAttribute("markerUnits", "strokeWidth"); G.setAttribute("orient", "auto"); L = document.createElementNS("http://www.w3.org/2000/svg", "polyline"); L.setAttribute("points", C); L.setAttribute("fill", "none"); L.setAttribute("stroke", "#555555"); L.setAttribute("stroke-width",
                                                                        "1"); G.appendChild(L); O.appendChild(G)
                                                }, _getRelationshipCornerLabels: function (O, C) { var G = C.HH.label, L = C.LL.label, P = C.HL.label; C = C.LH.label; switch (O) { case "HH": return { top: G, bottom: L, left: P, right: C }; case "HL": return { top: P, bottom: C, left: L, right: G }; case "LL": return { top: L, bottom: G, left: C, right: P }; case "LH": return { top: C, bottom: P, left: G, right: L }; default: return { top: G, bottom: L, left: P, right: C } } }, _repaintItems: function () { w.forEach(this._surfaceItems, function (O) { this._repaint(O) }, this) }, _repaint: function (O) {
                                                        if (O) {
                                                                O.getStroke &&
                                                                O.setStroke && O.setStroke(O.getStroke()); try { O.getFill && O.setFill && O.setFill(O.getFill()) } catch (C) { } O.children && A.isArray(O.children) && w.forEach(O.children, this._repaint, this)
                                                        }
                                                }, _createHoverAction: function (O, C, G, L) {
                                                        if (L = C._hoverLabel || C._hoverLabels && C._hoverLabels[G.id] || L) L = t.encode(L), C.mouseMoveHandler = C.mouseMoveHandler || {}, C.mouseMoveHandler[G.id] = m.connect(O, "onmousemove", A.hitch(this, function (P, S) {
                                                                this.mouseX = S.clientX; this.mouseY = S.clientY; this.hoverLabelShowing && (this.hoverLabelShowing = !1,
                                                                        a.set(b.byId(this.id + "_hoverLabel"), "display", "none")); setTimeout(A.hitch(this, function (Y, ha, ja) {
                                                                                if (Y == this.mouseX && ha == this.mouseY && !this.hoverLabelShowing) if (this.hoverLabelShowing = !0, b.byId(this.id + "_hoverLabel")) { var ka = b.byId(this.id + "_hoverLabel"); ka.innerHTML = "\x3cspan\x3e" + ja + "\x3c/span\x3e"; a.set(ka, "top", ha + "px"); a.set(ka, "left", Y + 15 + "px"); a.set(ka, "display", "") } else e.create("div", {
                                                                                        innerHTML: "\x3cspan\x3e" + ja + "\x3c/span\x3e", id: this.id + "_hoverLabel", "class": "esriLegendHoverLabel", style: {
                                                                                                top: ha +
                                                                                                        "px", left: Y + 15 + "px"
                                                                                        }
                                                                                }, document.body)
                                                                        }, S.clientX, S.clientY, P), 500)
                                                        }, L)), C.mouseOutHandler = C.mouseOutHandler || {}, C.mouseOutHandler[G.id] = m.connect(O, "onmouseout", A.hitch(this, function (P) { this.mouseY = this.mouseX = -1; this.hoverLabelShowing && (this.hoverLabelShowing = !1, a.set(b.byId(this.id + "_hoverLabel"), "display", "none")) }))
                                                }, _removeHoverHandlers: function () { var O; w.forEach(this.layers, function (C) { if (C.mouseMoveHandler) for (O in C.mouseMoveHandler) m.disconnect(C.mouseMoveHandler[O]); if (C.mouseOutHandler) for (O in C.mouseOutHandler) m.disconnect(C.mouseOutHandler[O]) }) },
                                                _createDynamicLayers: function (O) { var C = [], G; w.forEach(O.dynamicLayerInfos || O.layerInfos, function (L) { G = { id: L.id }; G.source = L.source && L.source.toJson(); var P; O.layerDefinitions && O.layerDefinitions[L.id] && (P = O.layerDefinitions[L.id]); P && (G.definitionExpression = P); var S; O.layerDrawingOptions && O.layerDrawingOptions[L.id] && (S = O.layerDrawingOptions[L.id]); S && (G.drawingInfo = S.toJson()); G.minScale = L.minScale || 0; G.maxScale = L.maxScale || 0; C.push(G) }); return C }, _getTemplateFromTypes: function (O, C) {
                                                        var G; for (G = 0; G <
                                                                O.length; G++)if (O[G].id == C && O[G].templates && 0 < O[G].templates.length) return O[G].templates[0]; return null
                                                }, _findParentGroup: function (O, C, G) { var L, P = C.dynamicLayerInfos || C.layerInfos; for (L = 0; L < P.length; L++)if (G == P[L].id) { -1 < P[L].parentLayerId && (a.set(b.byId(this.id + "_" + O + "_" + P[L].parentLayerId + "_group"), "display", "block"), this._findParentGroup(O, C, P[L].parentLayerId)); break } }, _addSubLayersToHide: function (O) {
                                                        function C(G, L) {
                                                                var P = O.layer.dynamicLayerInfos || O.layer.layerInfos, S, Y; for (S = 0; S < P.length; S++)if (P[S].id ===
                                                                        G && P[S].subLayerIds) for (Y = 0; Y < P[S].subLayerIds.length; Y++) { var ha = P[S].subLayerIds[Y]; -1 === w.indexOf(L, ha) && (L.push(ha), C(ha, L)) }
                                                        } O.layer.layerInfos && w.forEach(this.hideLayersInLegend[O.layer.id], function (G) { C(G, this.hideLayersInLegend[O.layer.id]) }, this)
                                                }, _isLayerInScale: function (O, C, G) {
                                                        var L, P = !0; if (O.legendResponse && O.legendResponse.layers) for (L = 0; L < O.legendResponse.layers.length; L++) {
                                                                var S = O.legendResponse.layers[L]; if (C.id == S.layerId) {
                                                                        if (!O.minScale && 0 !== O.minScale || !O.maxScale && 0 !== O.maxScale) {
                                                                                if (0 ==
                                                                                        S.minScale && O.tileInfo) var Y = O.tileInfo.lods[0].scale; if (0 == S.maxScale && O.tileInfo) var ha = O.tileInfo.lods[O.tileInfo.lods.length - 1].scale
                                                                        } else Y = Math.min(O.minScale, S.minScale) || O.minScale || S.minScale, ha = Math.max(O.maxScale, S.maxScale); if (0 < Y && Y < G || ha > G) P = !1; break
                                                                }
                                                        } else if (O.minScale || O.maxScale) if (O.minScale && O.minScale < G || O.maxScale && O.maxScale > G) P = !1; return P
                                                }, _getServiceTitle: function (O) {
                                                        var C = O._titleForLegend; C || (C = O.url, O.url ? -1 < O.url.indexOf("/MapServer") ? (C = O.url.substring(0, O.url.indexOf("/MapServer")),
                                                                C = C.substring(C.lastIndexOf("/") + 1, C.length)) : -1 < O.url.indexOf("/ImageServer") ? (C = O.url.substring(0, O.url.indexOf("/ImageServer")), C = C.substring(C.lastIndexOf("/") + 1, C.length)) : -1 < O.url.indexOf("/FeatureServer") && (C = O.url.substring(0, O.url.indexOf("/FeatureServer")), C = C.substring(C.lastIndexOf("/") + 1, C.length)) : C = "", O.name && (C = 0 < C.length ? C + (" - " + O.name) : O.name)); "esri.layers.ArcGISImageServiceVectorLayer" === O.declaredClass && O.vectorFieldPixelFilter && (O = O.vectorFieldPixelFilter.outputUnit ? this["NLS_" +
                                                                        O.vectorFieldPixelFilter.outputUnit] : this["NLS_" + O.vectorFieldPixelFilter.inputUnit], y.isDefined(O) && (C += " (" + O + ")")); return t.encode(C)
                                                }, _getEffectiveScale: function (O, C) {
                                                        var G = C.minScale, L = C.maxScale; if (y.isDefined(C.parentLayerId)) {
                                                                O = O.layerInfos; C = C.parentLayerId; var P; for (P = O.length - 1; 0 <= P; P--)if (O[P].id == C) if (0 == G && 0 < O[P].minScale ? G = O[P].minScale : 0 < G && 0 == O[P].minScale || 0 < G && 0 < O[P].minScale && (G = Math.min(G, O[P].minScale)), L = Math.max(L || 0, O[P].maxScale || 0), -1 < O[P].parentLayerId) C = O[P].parentLayerId;
                                                                else break
                                                        } return { minScale: G, maxScale: L }
                                                }, _isSupportedLayerType: function (O) {
                                                        return !(!O || !("esri.layers.ArcGISDynamicMapServiceLayer" === O.declaredClass || "esri.layers.ArcGISImageServiceLayer" === O.declaredClass && 10.2 <= O.version || "esri.layers.RasterXLayer" === O.declaredClass || "esri.layers.ArcGISImageServiceVectorLayer" === O.declaredClass || "esri.layers.ArcGISTiledMapServiceLayer" === O.declaredClass || "esri.layers.FeatureLayer" === O.declaredClass || "esri.layers.StreamLayer" === O.declaredClass || "esri.layers.KMLLayer" ===
                                                                O.declaredClass || "esri.layers.GeoRSSLayer" === O.declaredClass || "esri.layers.WMSLayer" === O.declaredClass || "esri.layers.WFSLayer" === O.declaredClass || "esri.layers.CSVLayer" === O.declaredClass))
                                                }, isHostedTileService: function (O) { var C = /(https?:)?\/\/services.*\.arcgis\.com/i; return !("esri.layers.ArcGISTiledMapServiceLayer" !== O.declaredClass || !C.test(O.url)) }, getField: function (O, C, G) { if (O.getField) return O.getField(C); if (G && G.fields) { var L; w.forEach(G.fields, function (P) { P.name === C && (L = P) }); return L } return null }
                                        });
                                        A.mixin(Ca, { ALIGN_LEFT: 0, ALIGN_RIGHT: 1 }); k("extend-esri") && A.setObject("dijit.Legend", Ca, u); return Ca
                                })
                }, "dojo/debounce": function () { define([], function () { return function (E, q) { var A; return function () { A && clearTimeout(A); var w = this, m = arguments; A = setTimeout(function () { E.apply(w, m) }, q) } } }) }, "esri/numberUtils": function () {
                        define(["dojo/has", "dojo/number", "dojo/i18n!dojo/cldr/nls/number", "./kernel"], function (E, q, A, w) {
                                var m = function (r, l) { return r - l }, v = {
                                        _reNumber: /^-?(\d+)(\.(\d+))?$/i, getDigits: function (r) {
                                                var l =
                                                        String(r), k = l.match(v._reNumber); r = { integer: 0, fractional: 0 }; k && k[1] ? (r.integer = k[1].split("").length, r.fractional = k[3] ? k[3].split("").length : 0) : -1 < l.toLowerCase().indexOf("e") && (k = l.split("e"), l = k[0], k = k[1], l && k && (l = Number(l), k = Number(k), (r = 0 < k) || (k = Math.abs(k)), l = v.getDigits(l), r ? (l.integer += k, l.fractional = k > l.fractional ? 0 : l.fractional - k) : (l.fractional += k, l.integer = k > l.integer ? 1 : l.integer - k), r = l)); return r
                                        }, getFixedNumbers: function (r, l) {
                                                var k = Number(r.toFixed(l)); k < r ? r = k + 1 / Math.pow(10, l) : (r = k, k -=
                                                        1 / Math.pow(10, l)); k = Number(k.toFixed(l)); r = Number(r.toFixed(l)); return [k, r]
                                        }, getPctChange: function (r, l, k, n) { var d = { prev: null, next: null }; if (null != k) { var c = r - k; d.prev = Math.floor(Math.abs(100 * (l - k - c) / c)) } null != n && (c = n - r, d.next = Math.floor(Math.abs(100 * (n - l - c) / c))); return d }, round: function (r, l) {
                                                r = r.slice(0); var k, n, d = l && null != l.tolerance ? l.tolerance : 2, c = l && l.indexes, g = l && null != l.strictBounds ? l.strictBounds : !1; if (c) c.sort(m); else for (c = [], k = 0; k < r.length; k++)c.push(k); for (k = 0; k < c.length; k++) {
                                                        var b = c[k];
                                                        l = r[b]; var e = 0 === b ? null : r[b - 1]; var a = b === r.length - 1 ? null : r[b + 1]; var f = v.getDigits(l); if (f = f.fractional) { var h = 0; for (n = !1; h <= f && !n;) { var p = v.getFixedNumbers(l, h); p = g && 0 === k ? p[1] : p[0]; n = v.hasMinimalChange(l, p, e, a, d); h++ } n && (r[b] = p) }
                                                } return r
                                        }, hasMinimalChange: function (r, l, k, n, d) { r = v.getPctChange(r, l, k, n); l = null == r.prev || r.prev <= d; k = null == r.next || r.next <= d; return l && k || r.prev + r.next <= 2 * d }, _reAllZeros: new RegExp("\\" + A.decimal + "0+$", "g"), _reSomeZeros: /(\d)0*$/g, format: function (r, l) {
                                                l = l || { places: 20, round: -1 };
                                                (r = q.format(r, l)) && (r = r.replace(v._reSomeZeros, "$1").replace(v._reAllZeros, "")); return r
                                        }
                                }; E("extend-esri") && (w.numberUtils = v); return v
                        })
                }, "esri/renderers/utils": function () {
                        define("dojo/_base/lang dojo/_base/array dojo/has dojo/date/locale ../kernel ../numberUtils ../Color dojo/i18n!dojo/cldr/nls/gregorian".split(" "), function (E, q, A, w, m, v, r, l) {
                                function k(f) { return f && q.map(f, function (h) { return new r(h) }) } function n(f, h, p) { var B = ""; 0 === h ? B = c.lt + " " : h === p && (B = c.gt + " "); return B + f } var d = {}, c = {
                                        lte: "\x3c\x3d",
                                        gte: "\x3e\x3d", lt: "\x3c", gt: "\x3e", pct: "%"
                                }, g = { millisecond: 0, second: 1, minute: 2, hour: 3, day: 4, month: 5, year: 6 }, b = {
                                        millisecond: { dateOptions: { formatLength: "long" }, timeOptions: { formatLength: "medium" } }, second: { dateOptions: { formatLength: "long" }, timeOptions: { formatLength: "medium" } }, minute: { dateOptions: { formatLength: "long" }, timeOptions: { formatLength: "short" } }, hour: { dateOptions: { formatLength: "long" }, timeOptions: { formatLength: "short" } }, day: { selector: "date", dateOptions: { formatLength: "long" } }, month: {
                                                selector: "date",
                                                dateOptions: { formatLength: "long" }
                                        }, year: { selector: "date", dateOptions: { selector: "year" } }
                                }, e = { formatLength: "short", fullYear: !0 }, a = { formatLength: "short" }; E.mixin(d, {
                                        timelineDateFormatOptions: { selector: "date", dateOptions: { formatLength: "short", fullYear: !0 } }, formatDate: function (f, h) {
                                                var p = []; null == f || f instanceof Date || (f = new Date(f)); h = h || {}; h = E.mixin({}, h); var B = h.selector ? h.selector.toLowerCase() : null, t = !B || -1 < B.indexOf("time"); B = !B || -1 < B.indexOf("date"); t && (h.timeOptions = h.timeOptions || a, h.timeOptions &&
                                                        (h.timeOptions = E.mixin({}, h.timeOptions), h.timeOptions.selector = h.timeOptions.selector || "time", p.push(h.timeOptions))); B && (h.dateOptions = h.dateOptions || e, h.dateOptions && (h.dateOptions = E.mixin({}, h.dateOptions), h.dateOptions.selector = h.dateOptions.selector || "date", p.push(h.dateOptions))); p && p.length ? (p = q.map(p, function (u) { return w.format(f, u) }), h = 1 == p.length ? p[0] : l["dateTimeFormat-medium"].replace(/'/g, "").replace(/\{(\d+)\}/g, function (u, z) { return p[z] })) : h = w.format(f); return h
                                        }, createColorStops: function (f) {
                                                var h =
                                                        f.values, p = f.colors, B = f.labelIndexes, t = f.isDate, u = f.dateFormatOptions; f = []; return f = q.map(h, function (z, x) { var y = null; if (!B || -1 < q.indexOf(B, x)) { var D; (D = t ? d.formatDate(z, u) : v.format(z)) && (y = n(D, x, h.length - 1)) } return { value: z, color: p[x], label: y } })
                                        }, updateColorStops: function (f) {
                                                var h = f.stops, p = f.changes, B = f.isDate, t = f.dateFormatOptions, u = [], z = q.map(h, function (y) { return y.value }); q.forEach(p, function (y) { u.push(y.index); z[y.index] = y.value }); var x = v.round(z, { indexes: u }); q.forEach(h, function (y, D) {
                                                        y.value =
                                                        z[D]; if (null != y.label) { var H, I = null; (H = B ? d.formatDate(x[D], t) : v.format(x[D])) && (I = n(H, D, h.length - 1)); y.label = I }
                                                })
                                        }, createClassBreakLabel: function (f) { var h = f.minValue, p = f.maxValue, B = f.isFirstBreak ? "" : c.gt + " "; f = "percent-of-total" === f.normalizationType ? c.pct : ""; h = null == h ? "" : v.format(h); p = null == p ? "" : v.format(p); return B + h + f + " \u2013 " + p + f }, setLabelsForClassBreaks: function (f) {
                                                var h = f.classBreaks, p = f.classificationMethod, B = f.normalizationType, t = []; h && h.length && ("standard-deviation" === p ? console.log("setLabelsForClassBreaks: cannot set labels for class breaks generated using 'standard-deviation' method.") :
                                                        f.round ? (t.push(h[0].minValue), q.forEach(h, function (u) { t.push(u.maxValue) }), t = v.round(t), q.forEach(h, function (u, z) { u.label = d.createClassBreakLabel({ minValue: 0 === z ? t[0] : t[z], maxValue: t[z + 1], isFirstBreak: 0 === z, normalizationType: B }) })) : q.forEach(h, function (u, z) { u.label = d.createClassBreakLabel({ minValue: u.minValue, maxValue: u.maxValue, isFirstBreak: 0 === z, normalizationType: B }) }))
                                        }, updateClassBreak: function (f) {
                                                var h = f.classBreaks, p = f.normalizationType, B = f.change, t = B.index; B = B.value; var u = -1, z = -1, x = h.length;
                                                "standard-deviation" === f.classificationMethod ? console.log("updateClassBreak: cannot update labels for class breaks generated using 'standard-deviation' method.") : (0 === t ? u = t : t === x ? z = t - 1 : (z = t - 1, u = t), -1 < u && u < x && (f = h[u], f.minValue = B, f.label = d.createClassBreakLabel({ minValue: f.minValue, maxValue: f.maxValue, isFirstBreak: 0 === u, normalizationType: p })), -1 < z && z < x && (f = h[z], f.maxValue = B, f.label = d.createClassBreakLabel({ minValue: f.minValue, maxValue: f.maxValue, isFirstBreak: 0 === z, normalizationType: p })))
                                        }, calculateDateFormatInterval: function (f) {
                                                var h,
                                                p, B = f.length, t = Infinity; f = q.map(f, function (N) { return new Date(N) }); for (h = 0; h < B - 1; h++) { var u = f[h]; var z = []; var x = Infinity; var y = ""; for (p = h + 1; p < B; p++) { var D = f[p]; D = u.getFullYear() !== D.getFullYear() && "year" || u.getMonth() !== D.getMonth() && "month" || u.getDate() !== D.getDate() && "day" || u.getHours() !== D.getHours() && "hour" || u.getMinutes() !== D.getMinutes() && "minute" || u.getSeconds() !== D.getSeconds() && "second" || "millisecond"; var H = g[D]; H < x && (x = H, y = D); z.push(D) } if (x < t) { t = x; var I = y } } return I
                                        }, createUniqueValueLabel: function (f) {
                                                var h =
                                                        f.value, p = f.fieldInfo, B = f.domain; f = f.dateFormatInterval; var t = String(h); (B = B && B.codedValues ? B.getName(h) : null) ? t = B : "number" === typeof h && (t = p && "esriFieldTypeDate" === p.type ? d.formatDate(h, f && b[f]) : v.format(h)); return t
                                        }, cloneColorInfo: function (f) { if (f) { var h = E.mixin({}, f); h.colors = k(h.colors); h.stops = h.stops && q.map(h.stops, function (p) { p = E.mixin({}, p); p.color && (p.color = new r(p.color)); return p }); h.legendOptions && (h.legendOptions = E.mixin({}, h.legendOptions)) } return h }, cloneOpacityInfo: function (f) {
                                                if (f) {
                                                        var h =
                                                                E.mixin({}, f); if (f = h.opacityValues) h.opacityValues = f.slice(0); if (f = h.stops) h.stops = q.map(f, function (p) { return E.mixin({}, p) }); if (f = h.legendOptions) h.legendOptions = E.mixin({}, f)
                                                } return h
                                        }, cloneSizeInfo: function (f) {
                                                if (f) {
                                                        var h = E.mixin({}, f); h.stops && (h.stops = q.map(h.stops, function (p) { return E.mixin({}, p) })); (f = h.minSize) && "object" === typeof f && (h.minSize = d.cloneSizeInfo(f)); (f = h.maxSize) && "object" === typeof f && (h.maxSize = d.cloneSizeInfo(f)); if (f = h.legendOptions) if (h.legendOptions = E.mixin({}, f), f = f.customValues) h.legendOptions.customValues =
                                                                f.slice(0)
                                                } return h
                                        }, getClassCodesForRelationship: function () { return E.clone({ 2: ["L", "H"], 3: ["L", "M", "H"], 4: ["L", "M1", "M2", "H"] }) }, getClassValuesForRelationship: function () { return E.clone({ 2: [["HL", "HH"], ["LL", "LH"]], 3: [["HL", "HM", "HH"], ["ML", "MM", "MH"], ["LL", "LM", "LH"]], 4: [["HL", "HM1", "HM2", "HH"], ["M2L", "M2M1", "M2M2", "M2H"], ["M1L", "M1M1", "M1M2", "M1H"], ["LL", "LM1", "LM2", "LH"]] }) }
                                }); A("extend-esri") && E.setObject("renderer.utils", d, m); return d
                        })
                }, "jimu/LayerInfos/LayerInfoForGeoRSS": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/Deferred esri/lang jimu/utils ./LayerInfo".split(" "),
                                function (E, q, A, w, m, v) {
                                        return E(v, {
                                                constructor: function () { }, _getExtent: function () { var r = new A, l = this.layerObject.items, k = this.layerObject.fullExtent || this.layerObject.initialExtent; 0 === l.length ? r.resolve(k) : r.resolve(m.graphicsExtent(l)); return r }, _resetLayerObjectVisiblity: function (r) { var l = r ? r[this.id] : null; if (l) { var k = {}, n; for (n in r) r.hasOwnProperty(n) && "function" !== typeof r[n] && (k[n] = r[n].visible); this._setSubLayerVisibleByCheckedInfo(k); this._setTopLayerVisible(l.visible) } }, _setSubLayerVisibleByCheckedInfo: function (r) {
                                                        q.forEach(this.newSubLayers,
                                                                function (l) { w.isDefined(r[l.id]) && l.layerObject.setVisibility(r[l.id]) }, this)
                                                }, _initVisible: function () { var r = !1, l; for (l = 0; l < this.newSubLayers.length; l++)r = r || this.newSubLayers[l].layerObject.visible; r && (this._visible = !0) }, _setTopLayerVisible: function (r) { this._visible = r ? !0 : !1; q.forEach(this.newSubLayers, function (l) { l.setLayerVisiblefromTopLayer() }, this); this._onVisibilityChanged() }, obtainNewSubLayers: function () {
                                                        var r = [], l = this.layerObject.getFeatureLayers(); q.forEach(l, function (k) {
                                                                k = this._layerInfoFactory.create({
                                                                        layerObject: k,
                                                                        title: k.label || k.title || k.name || k.id || " ", id: k.id || " ", subId: k.id || " ", collection: { layerInfo: this }, selfType: "geo_rss", parentLayerInfo: this
                                                                }); r.push(k); k.init()
                                                        }, this); this._markInvalidSubLayerInfoThatAsRootLayer(l); return r
                                                }, _markInvalidSubLayerInfoThatAsRootLayer: function (r) { var l; q.forEach(r, function (k) { if (l = this._getLayerInfosObj()._findTopLayerInfoById(k.id)) l._flag._invalid = !0 }, this) }, _needToRenew: function () {
                                                        var r = this.layerObject.getFeatureLayers(); return (r ? r.length : 0) === this.newSubLayers.length ?
                                                                !1 : !0
                                                }, _obtainLayerIndexesInMap: function () { var r = [], l, k; for (k = 0; k < this.newSubLayers.length; k++)(l = this._getLayerIndexesInMapByLayerId(this.newSubLayers[k].layerObject.id)) && r.push(l); return r }, moveLeftOfIndex: function (r) { var l; for (l = this.newSubLayers.length - 1; 0 <= l; l--)this.map.reorderLayer(this.newSubLayers[l].layerObject, r) }, moveRightOfIndex: function (r) { var l; for (l = 0; l < this.newSubLayers.length; l++)this.map.reorderLayer(this.newSubLayers[l].layerObject, r) }
                                        })
                                })
                }, "jimu/LayerInfos/LayerInfoForWMS": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/topic dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS esri/layers/FeatureLayer esri/lang".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d) {
                                        return E(l, {
                                                constructor: function (c, g) { }, _getExtent: function () { var c = new m; c.resolve(this.layerObject.extent || this.layerObject.fullExtent); return c }, _initVisible: function () { this._visible = this.layerObject.visible }, _setTopLayerVisible: function (c) { this._visible = c; this.layerObject.setVisibility(c) }, _setSubLayerVisible: function (c) {
                                                        var g = []; g = A.clone(this.originOperLayer.layerObject.visibleLayers); for (var b in c) if (c.hasOwnProperty(b) && "function" !== typeof c[b]) {
                                                                var e = c[b],
                                                                a = b.toString(); var f = q.indexOf(g, a); e ? 0 > f && g.push(a) : 0 <= f && g.splice(f, 1)
                                                        } this._setVisibleLayersBySelfFlag = !0; this.layerObject.setVisibleLayers(g)
                                                }, _resetLayerObjectVisiblity: function (c) { var g = c ? c[this.id] : null, b = !1; if (c) { g && this.layerObject.setVisibility(g.visible); g = {}; for (var e in c) c.hasOwnProperty(e) && "function" !== typeof c[e] && (b = !0, g[e] = c[e].visible); b && this._setSubLayerVisibleByCheckedInfo(g) } }, _setSubLayerVisibleByCheckedInfo: function (c) {
                                                        var g = {}; this.traversal(function (b) {
                                                                b.isRootLayer() ||
                                                                d.isDefined(c[b.id]) && b._setVisible(c[b.id])
                                                        }); this.traversal(function (b) { 0 === b.getSubLayers().length && (g[b.subId] = b._isAllSubLayerVisibleOnPath()) }); this._setSubLayerVisible(g)
                                                }, _getServiceDefinition: function () { var c = this.getUrl(); return this._serviceDefinitionBuffer.getRequest(this.subId).request(c) }, _serviceDefinitionRequest: function (c) { return this._normalRequest(c, { SERVICE: "WMS", REQUEST: "GetCapabilities" }, "xml") }, obtainNewSubLayers: function () {
                                                        var c = []; q.forEach(this.layerObject.layerInfos, function (g,
                                                                b) { g = this._getOperLayerFromWMSLayerInfo(g, this); g = this._layerInfoFactory.create(g); c.push(g); g.init() }, this); c.reverse(); return c
                                                }, _getOperLayerFromWMSLayerInfo: function (c, g) { return { layerObject: this.layerObject, title: c.label || c.title || c.name || " ", id: this.id + "_" + (c.name || c.title + "-" + Math.random()), subId: c.name || "-", wms: { layerInfo: this, subId: c.name || "-", wmsLayerInfo: c }, selfType: "wms", parentLayerInfo: g } }, _bindEvent: function () {
                                                        this.inherited(arguments); this.layerObject && !this.layerObject.empty && r.after(this.layerObject,
                                                                "setVisibleLayers", A.hitch(this, this._onVisibleLayersChanged))
                                                }, _onVisibleLayersChanged: function () { var c = []; this._setVisibleLayersBySelfFlag || (this.traversal(function (g) { g.isRootLayer() || g._initVisible() }), this._setVisibleLayersBySelfFlag = !1); this.traversal(function (g) { g.isRootLayer() || c.push(g) }); this._setVisibleLayersBySelfFlag = !1; w.publish("layerInfos/layerInfo/visibleChanged", c); this._isShowInMapChanged2() }
                                        })
                                })
                }, "jimu/LayerInfos/LayerInfoForDefaultWMS": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/Deferred dojo/dom-construct dojo/on ./LayerInfoForDefault".split(" "),
                                function (E, q, A, w, m, v, r) {
                                        return E(r, {
                                                constructor: function (l, k) { this.layerObject = l.layerObject }, _resetLayerObjectVisiblity: function () { }, _initVisible: function () { var l = !1; this.traversal(function (k) { if (0 <= q.indexOf(k.layerObject.visibleLayers, k.subId)) return l = !0 }); this._visible = l }, _setVisible: function (l) { this._visible = l ? !0 : !1 }, _setTopLayerVisible: function (l) {
                                                        var k = this.originOperLayer.wms; this._visible = l ? !0 : !1; var n = {}; this.traversal(function (d) { 0 === d.getSubLayers().length && (n[d.subId] = d._isAllSubLayerVisibleOnPath()) });
                                                        k.layerInfo._setSubLayerVisible(n)
                                                }, _getServiceDefinition: function () { var l = this.getUrl(); return this._serviceDefinitionBuffer.getRequest(this.subId).request(l) }, _serviceDefinitionRequest: function (l) { return this._normalRequest(l, { SERVICE: "WMS", REQUEST: "GetCapabilities" }, "xml") }, obtainNewSubLayers: function () {
                                                        var l = [], k = this.originOperLayer.wms; q.forEach(k.wmsLayerInfo.subLayers, function (n) { n = k.layerInfo._getOperLayerFromWMSLayerInfo(n, this); n = this._layerInfoFactory.create(n); l.push(n); n.init() }, this);
                                                        return l
                                                }, drawLegends: function (l) { this._initLegendsNode(l) }, _initLegendsNode: function (l) { if (this.originOperLayer.wms.wmsLayerInfo.legendURL) { var k = m.create("img", { "class": "legend-div-image", src: this.originOperLayer.wms.wmsLayerInfo.legendURL }); v(k, "load", function () { m.empty(l); var n = m.create("div", { "class": "legend-div" }, l); A.place(k, n) }) } else m.empty(l) }, getOpacity: function () { }, setOpacity: function (l) { }, enablePopup: function () { this.originOperLayer.wms.wmsLayerInfo.showPopup = !0 }, disablePopup: function () {
                                                        this.originOperLayer.wms.wmsLayerInfo.showPopup =
                                                        !1
                                                }, isPopupEnabled: function () { return this.originOperLayer.wms.wmsLayerInfo.showPopup }, isSupportPopup: function () { var l = new w; this.originOperLayer.wms.wmsLayerInfo.queryable ? l.resolve(!0) : l.resolve(!1); return l }, _bindEvent: function () { }, _onVisibleLayersChanged: function () { }, getScaleRange: function () { return this.originOperLayer.wms.layerInfo.getScaleRange() }
                                        })
                                })
                }, "jimu/LayerInfos/LayerInfoForDefaultDynamic": function () {
                        define(["dojo/_base/declare", "./LayerInfoForDefaultService"], function (E, q) {
                                return E(q,
                                        { constructor: function (A, w) { }, _initVisible: function () { var A = !1, w = this.originOperLayer.mapService; w && w.layerInfo._subLayerVisible[w.subId] && (A = !0); this._visible = A }, _setTopLayerVisible: function (A) { var w = this.originOperLayer.mapService; if (w) { w.layerInfo._subLayerVisible[w.subId] = A ? !0 : !1; this._visible = A; var m = {}; this.traversal(function (v) { 0 === v.getSubLayers().length && (m[v.originOperLayer.mapService.subId] = v._isAllSubLayerVisibleOnPath()) }); w.layerInfo._setSubLayerVisible(m) } } })
                        })
                }, "jimu/LayerInfos/LayerInfoForDefaultService": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/topic dojo/dom-construct ./LayerInfoForDefault ./LayerObjectFacory ../utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        return E(r, {
                                                _legendsNode: null, _layerObjectFacory: null, constructor: function () { this._layerObjectFacory = new l(this) }, _resetLayerObjectVisiblity: function () { }, _loadLegends: function (n) { var d = new w; this.originOperLayer.mapService.layerInfo.getLegendInfo(n).then(A.hitch(this, function (c) { d.resolve(c) })); return d }, drawLegends: function (n, d) { this._loadLegends(d).then(A.hitch(this, function (c) { this._initLegendsNode(c, n) })) }, _initLegendsNode: function (n, d) {
                                                        var c = this.originOperLayer.mapService;
                                                        if (n) {
                                                                v.empty(d); for (var g = null, b = 0; b < n.length; b++)if (n[b].layerId === c.subId) { g = n[b]; break } if (g) {
                                                                        var e = v.create("table", { "class": "legend-table", style: "font-size: 12px" }, d); q.forEach(g.legend, function (a) {
                                                                                if ("\x3call other values\x3e" !== a.label) {
                                                                                        var f = v.create("tr", { "class": "legend-tr", style: "border: 1px solid" }, e), h = v.create("td", { "class": "legend-symbol-td", style: "" }, f), p = null; p = a.imageData ? "data:" + a.contentType + ";base64," + a.imageData : a.url; v.create("img", {
                                                                                                "class": "legend-symbol-image", style: "overflow:auto;margin:auto;top:0;left:0;bottom:0;right:0",
                                                                                                src: p
                                                                                        }, h); v.create("td", { "class": "legend-label-td", innerHTML: k.sanitizeHTML(a.label) || " ", style: "padding-left: 5px" }, f)
                                                                                }
                                                                        }, this)
                                                                }
                                                        }
                                                }, _initControlPopup: function () { var n = this.originOperLayer.mapService.layerInfo.layerObject, d = this.originOperLayer.mapService.subId; this.controlPopupInfo = { enablePopup: n.infoTemplates && n.infoTemplates[d] ? !0 : !1, infoTemplates: void 0 } }, _afterSetInfoTemplates: function () {
                                                        var n = this.originOperLayer.mapService.layerInfo.layerObject, d = this.originOperLayer.mapService.subId; !this.controlPopupInfo.enablePopup &&
                                                                n.infoTemplates && delete n.infoTemplates[d]
                                                }, _getShowLegendOfWebmap: function () { return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId) }, _getServiceDefinition: function () { return this.originOperLayer.mapService.layerInfo._getSubserviceDefinition(this.originOperLayer.mapService.mapServiceSubId) }, _getLayerObject: function (n) {
                                                        var d = new w; (n ? this._layerObjectFacory.getLayerObjectWithUrl(n) : this._layerObjectFacory.getLayerObject()).then(A.hitch(this,
                                                                function (c) { this.layerObject.empty && c && (this.layerObject = c); d.resolve(c) })); return d
                                                }, getLayerObject: function () { return this._getLayerObject() }, getLayerObjectTryUsingFeatureService: function () { var n; return this.isItemLayer() ? this.getItemInfo().then(A.hitch(this, function (d) { d && d.getItemData() && d.getItemData().layers && q.some(d.getItemData().layers, function (c) { if (c.id === this.subId) return n = c.layerUrl, !0 }, this); return n ? this._getLayerObject(n) : this._getLayerObject() })) : this.getLayerObject() }, getPopupInfo: function () {
                                                        var n =
                                                                null, d = this.originOperLayer.mapService.layerInfo.originOperLayer.layers; if (d) for (var c = 0; c < d.length; c++)if (d[c].id === this.originOperLayer.mapService.subId) { n = d[c].popupInfo; break } return n
                                                }, getFilterOfWebmap: function () { var n = null, d = this.originOperLayer.mapService.layerInfo.originOperLayer.layers; if (d) for (var c = 0; c < d.length; c++)if (d[c].id === this.originOperLayer.mapService.subId) { n = d[c].layerDefinition ? d[c].layerDefinition.definitionExpression : null; break } return n }, getFilter: function () {
                                                        var n = this.originOperLayer.mapService;
                                                        return n.layerInfo.layerObject && n.layerInfo.layerObject.layerDefinitions ? n.layerInfo.layerObject.layerDefinitions[n.subId] : null
                                                }, setFilter: function (n, d) {
                                                        var c = this.originOperLayer.mapService; if (c.layerInfo.layerObject && c.layerInfo.layerObject.setLayerDefinitions) {
                                                                var g = c.layerInfo.layerObject.layerDefinitions ? q.map(c.layerInfo.layerObject.layerDefinitions, function (b) { return b }) : []; d = A.mixin({}, d); A.setObject("_wabProperties.objectPassWithFilterChangeEvent", d, c.layerInfo.layerObject); g[c.subId] = n;
                                                                c.layerInfo.layerObject.setLayerDefinitions(g)
                                                        }
                                                }, getLayerType: function () { var n = new w; 0 < this.getSubLayers().length ? n.resolve("GroupLayer") : this._getServiceDefinition().then(A.hitch(this, function (d) { d ? n.resolve(d.type.replace(/ /g, "")) : n.resolve(null) }), function () { n.resolve(null) }); return n }, getSupportTableInfo: function () {
                                                        var n = new w, d = { isSupportedLayer: !1, isSupportQuery: !1, layerType: null }; this.getLayerType().then(A.hitch(this, function (c) {
                                                                d.layerType = c; 0 <= this._getLayerTypesOfSupportTable().indexOf(c) &&
                                                                        (d.isSupportedLayer = !0); this._getServiceDefinition().then(A.hitch(this, function (g) { g && g.capabilities && 0 <= g.capabilities.indexOf("Data") && (d.isSupportQuery = !0); n.resolve(d) }), function () { n.resolve(d) })
                                                        }), function () { n.resolve(d) }); return n
                                                }, enablePopup: function () {
                                                        var n = this.originOperLayer.mapService.layerInfo, d = n.layerObject, c = this.originOperLayer.mapService.subId; return this.loadInfoTemplate().then(A.hitch(this, function () {
                                                                return n.controlPopupInfo.infoTemplates && n.controlPopupInfo.infoTemplates[c] ?
                                                                        (this.controlPopupInfo.enablePopup = !0, d.infoTemplates || (d.infoTemplates = {}), d.infoTemplates[c] = n.controlPopupInfo.infoTemplates[c], !0) : !1
                                                        }))
                                                }, disablePopup: function () { var n = this.originOperLayer.mapService.layerInfo.layerObject, d = this.originOperLayer.mapService.subId; this.controlPopupInfo.enablePopup = !1; n.infoTemplates && delete n.infoTemplates[d] }, loadInfoTemplate: function () {
                                                        var n = new w, d = this.originOperLayer.mapService.layerInfo, c = this.originOperLayer.mapService.subId; d.controlPopupInfo.infoTemplates &&
                                                                d.controlPopupInfo.infoTemplates[c] && d.controlPopupInfo.infoTemplates[c].infoTemplate ? n.resolve(d.controlPopupInfo.infoTemplates[c].infoTemplate) : (d.controlPopupInfo.infoTemplates || (d.controlPopupInfo.infoTemplates = {}), this.getLayerObject().then(A.hitch(this, function (g) { g = this._getDefaultPopupTemplate(g); d.controlPopupInfo.infoTemplates[c] = { infoTemplate: g, layerUrl: null }; n.resolve(g) }), A.hitch(this, function () { n.resolve(null) }))); return n
                                                }, getInfoTemplate: function () {
                                                        var n = this.originOperLayer.mapService.layerInfo,
                                                        d = this.originOperLayer.mapService.subId; return n.controlPopupInfo.infoTemplates && n.controlPopupInfo.infoTemplates[d] && n.controlPopupInfo.infoTemplates[d].infoTemplate ? n.controlPopupInfo.infoTemplates[d].infoTemplate : null
                                                }, getScaleRange: function () { var n = this.originOperLayer.mapService; return (n = n.layerInfo._getJsapiLayerInfoById(n.subId)) && 0 <= n.minScale && 0 <= n.maxScale ? { minScale: n.minScale, maxScale: n.maxScale } : { minScale: 0, maxScale: 0 } }, setScaleRange: function (n, d) {
                                                        var c = this.originOperLayer.mapService,
                                                        g = c.layerInfo._getJsapiLayerInfoById(c.subId); c.layerInfo.layerObject && c.layerInfo.layerObject.supportsDynamicLayers && c.layerInfo.layerObject.setDynamicLayerInfos && g && (g.minScale !== n || g.maxScale !== d) && (g.minScale = n, g.maxScale = d, c.layerInfo.layerObject.setDynamicLayerInfos(c.layerInfo._jsapiLayerInfos), m.publish("layerInfos/layerInfo/scaleRangeChanged", [this]))
                                                }, _onVisibilityChanged: function () { }
                                        })
                                })
                }, "jimu/LayerInfos/LayerObjectFacory": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred ./RequestBuffer esri/layers/FeatureLayer esri/layers/RasterLayer esri/layers/StreamLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISImageServiceVectorLayer".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        return E(null, {
                                                _layerInfo: null, _layerObjectBuffer: null, constructor: function (d) { this._layerInfo = d; this._initLayerObjectBuffer() }, _initLayerObjectBuffer: function () { this._layerObjectBuffer = new m(q.hitch(this, this._getLayerObject)) }, getLayerObject: function () { var d = this._layerInfo.getUrl(); return this._layerObjectBuffer.getRequest(this._layerInfo.subId).request(d) }, getLayerObjectWithUrl: function (d) { return this._layerObjectBuffer.getRequest(this._layerInfo.subId + "_url").request(d) },
                                                _getLayerObject: function (d) {
                                                        var c, g = new w; this._layerInfo.getLayerType().then(q.hitch(this, function (b) {
                                                                var e = q.mixin(this._getLayerOptionsForCreateLayerObject(), this._layerInfo.originOperLayer.options || {}) || {}; switch (b) {
                                                                        case "FeatureLayer": c = new v(d, e); break; case "RasterLayer": c = new r(d); break; case "StreamLayer": c = new l(d); break; case "ArcGISImageServiceLayer": c = new k(d); break; case "ArcGISImageServiceVectorLayer": c = new n(d); break; case "Table": if (this._layerInfo.layerObject && !this._layerInfo.layerObject.empty) return this._setLayerObjectProperties(this._layerInfo.layerObject),
                                                                                g.resolve(this._layerInfo.layerObject), g; if (this._layerInfo.layerObject && this._layerInfo.layerObject.url) c = new v(d, e); else return this._layerInfo.layerObject && this._layerInfo.layerObject.featureCollectionData ? (c = new v(this._layerInfo.layerObject.featureCollectionData, e), this._setLayerObjectProperties(c), g.resolve(c)) : g.resolve(null), g; break; case "GroupLayer": return g = this._getGroupLayerObject(); default: return g.resolve(null), g
                                                                }var a = c.on("load", q.hitch(this, function () {
                                                                        this._setLayerObjectProperties(c);
                                                                        g.resolve(c); a.remove && a.remove()
                                                                })), f = c.on("error", q.hitch(this, function (h) { g.reject(h); f.remove && f.remove() }))
                                                        }), q.hitch(this, function () { g.reject() })); return g
                                                }, _getGroupLayerObject: function () { var d = new w; this._layerInfo._getServiceDefinition().then(q.hitch(this, function (c) { if (null === c) d.reject(); else { var g = this._layerInfo.getUrl(); c.url = g; c.id = this._layerInfo.id; d.resolve(c) } })); return d }, _getLayerOptionsForCreateLayerObject: function () {
                                                        var d = {}, c = [], g = this._layerInfo.getInfoTemplate(); g && g.info &&
                                                                g.info.fieldInfos ? A.forEach(g.info.fieldInfos, function (b) { b.visible && c.push(b.fieldName) }, this) : c = ["*"]; d.outFields = c; return d
                                                }, _setLayerObjectProperties: function (d) { d.name && !q.getObject("_wabProperties.originalLayerName", !1, d) && (q.setObject("_wabProperties.originalLayerName", d.name, d), d.name = this._layerInfo.title); d.id = this._layerInfo.id; this._layerInfo.loadInfoTemplate().then(q.hitch(this, function (c) { d.infoTemplate = c })) }
                                        })
                                })
                }, "esri/layers/RasterLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojo/number ../kernel ../lang ../domUtils ./BaseRasterLayer ./ImageServiceLayerMixin ./pixelFilters/StretchFilter ../SpatialReference ../geometry/Point".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a) {
                                        E = E([c, g], {
                                                declaredClass: "esri.layers.RasterLayer", constructor: function (f, h) { this.pixelData = null; null !== this.format && void 0 !== this.format || this.setImageFormat("LERC", !0) }, _setDefaultFilter: function () {
                                                        if (this.loaded && this.drawType && !this._isVectorData() && (!this.pixelFilter || this._isDefaultPixelFilter)) if ("jpeg" === this.format.toLowerCase() || "jpg" === this.format.toLowerCase() || -1 < this.format.toLowerCase().indexOf("png")) this._isDefaultPixelFilter && (this.pixelFilter =
                                                                null, this._isDefaultPixelFilter = !1); else {
                                                                        var f; if (this.minValues && this.maxValues && this.stdvValues && this.meanValues) { var h = []; for (f = 0; f < this.minValues.length; f++)h.push([this.minValues[f], this.maxValues[f], this.meanValues[f], this.stdvValues[f]]); this.bandCount !== h.length && (h = null) } f = 0; var p = !1; "U8" === this.pixelType ? (f = 5, p = h ? !1 : !0) : h ? (f = 5, p = !1) : (f = 6, p = !0); this.renderingRule && (f = 5, p = !0); this.pixelFilter = (new b({
                                                                                stretchType: f, min: 0, max: 255, dra: p, minPercent: .25, maxPercent: .25, useGamma: !1, computeGamma: !1,
                                                                                statistics: h, numberOfStandardDeviations: 2.5
                                                                        })).filter; this._isDefaultPixelFilter = !0
                                                        }
                                                }
                                        }); m("extend-esri") && q.setObject("layers.RasterLayer", E, k); return E
                                })
                }, "esri/layers/BaseRasterLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/sniff dojo/dom-construct dojo/dom-style dojox/gfx/matrix ../kernel ../config ../lang ../domUtils ../geometry/Point ./layer".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                var e = n.defaults.map.zoomDuration; return E([b],
                                        {
                                                declaredClass: "esri.layers.BaseRasterLayer", managedSuspension: !0, opacity: 1, constructor: function (a, f) { this.drawMode = f && void 0 !== f.drawMode ? f.drawMode : !0; this.drawType = f && f.drawType ? f.drawType : "2d"; this.pixelData = null; this._initialize(a, f) }, setDrawMode: function (a) { this.drawMode = a }, setOpacity: function (a) { this.opacity !== a && (this.opacity = a, this.onOpacityChange(a)) }, onOpacityChange: function () { }, refresh: function () {
                                                        if (!this._canDraw() || 10 > m("ie")) this.onError(Error("Unable to refresh. This layer is not supported in the current browser."));
                                                        else this._map && this._extentChangeHandler(this._map.extent)
                                                }, clear: function () { this._canDraw() && "2d" === this.drawType && this._context.clearRect(0, 0, this._mapWidth, this._mapHeight) }, getContext: function () { return this._context }, onResume: function () {
                                                        this.inherited(arguments); this._toggleTime(); if ("css-transforms" === this._map.navigationMode) { var a = this._map.__visibleDelta; this._left = this._tdx = a.x; this._top = this._tdy = a.y; r.set(this._div, k._css.names.transform, k._css.translate(this._left, this._top)) } this._displayTimer =
                                                                this._displayTimer || setTimeout(q.hitch(this, function () { this._extentChangeHandler(this._map.extent, null, !0) }), 0)
                                                }, onSuspend: function () { this.inherited(arguments); this._toggleTime(); clearTimeout(this._displayTimer); this._displayTimer = null }, redraw: function () { this.hasDataChanged = !1; this._setPixelData(this.originalPixelData) }, getCurrentResolution: function () { var a = this._map.extent; return new g((a.xmax - a.xmin) / this._map.width, (a.ymax - a.ymin) / this._map.height, a.spatialReference) }, setPixelFilter: function (a,
                                                        f) { this.pixelFilter = a; f || this.redraw() }, _toggleTime: function () { }, _setMap: function (a, f) {
                                                                this.inherited(arguments); this._dragOrigin = { x: 0, y: 0 }; var h = this._div = v.create("div", null, f), p = { width: a.width + "px", height: a.height + "px", position: "absolute" }; "css-transforms" === a.navigationMode ? (p[k._css.names.transform] = k._css.translate(a.__visibleDelta.x, a.__visibleDelta.y), this._left = a.__visibleDelta.x, this._top = a.__visibleDelta.y) : this._left = this._top = 0; r.set(h, p); this._canvas = v.create("canvas", {
                                                                        id: "canvas", width: a.width +
                                                                                "px", height: a.height + "px", style: "position: absolute;"
                                                                }, h); d.isDefined(this.opacity) && r.set(h, "opacity", this.opacity); (this._context = this._canvas.getContext(this.drawType)) || console.error("Unable to create the context. This browser might not support \x3ccanvas\x3e elements."); this._mapWidth = a.width; this._mapHeight = a.height; this._connects = []; this._connects.push(A.connect(a, "onPan", this, this._panHandler)); this._connects.push(A.connect(a, "onPanEnd", this, this._panEndHandler)); "css-transforms" === a.navigationMode ?
                                                                        this._connects.push(A.connect(a, "onScale", this, this._onScaleHandler)) : (this._connects.push(A.connect(a, "onZoom", this, this._onZoomHandler)), this._connects.push(A.connect(a, "onZoomEnd", this, this._onZoomEndHandler))); this._connects.push(A.connect(a, "onResize", this, this._onResizeHandler)); this._connects.push(A.connect(a, "onExtentChange", this, this._extentChangeHandler)); this._connects.push(A.connect(this, "onVisibilityChange", this, this._visibilityChangeHandler)); this._connects.push(A.connect(this, "onOpacityChange",
                                                                                this, this._opacityChangeHandler)); this._startRect = { left: 0, top: 0, width: a.width, height: a.height }; this.evaluateSuspension(); if (this.suspended && !a.loaded) var B = A.connect(a, "onLoad", this, function () { A.disconnect(B); B = null; this.evaluateSuspension() }); return h
                                                        }, _unsetMap: function (a, f) {
                                                                w.forEach(this._connects, A.disconnect, this); var h = this._div; h && (f.removeChild(h), v.destroy(h)); this.updating && a._jobs && a._jobs--; this._rasterReadPromise && this._rasterReadPromise.cancel(); this._map = this._canvas = this._context =
                                                                        this.data = this._connects = null; clearTimeout(this._displayTimer); this._displayTimer = null; this.inherited(arguments)
                                                        }, _canDraw: function () { return !!(this._map && this._canvas && this._context) }, _requestDataErrorHandler: function (a) { "CancelError" !== a.name && (this.clear(), this.onError(a)) }, _drawPixelData: function () {
                                                                if (this._map) {
                                                                        this._startRect = { left: 0, top: 0, width: this._map.width, height: this._map.height }; var a = this._useBrowserDecoding(); !a && this.drawMode || "css-transforms" !== this._map.navigationMode || (this._tdx =
                                                                                this._left, this._tdy = this._top, this._multiply = null, r.set(this._div, k._css.names.transform, k._css.translate(this._left, this._top)), r.set(this._canvas, k._css.names.transform, k._css.translate(-this._left, -this._top)), this._dragOrigin = { x: 0, y: 0 }); if (this._canDraw && this.drawMode) if (a) this._fireUpdateEnd(); else if (this.drawMode) if (this.pixelData && this.pixelData.pixelBlock) {
                                                                                        a = this.pixelData.pixelBlock; var f = this._context, h = f.createImageData(a.width, a.height); h.data.set(a.getAsRGBA()); var p = this.pixelData.extent,
                                                                                                B = this._map.extent, t = this.getCurrentResolution(), u = 0, z = 0; Math.abs(p.xmin - B.xmin) > t.x && (u = Math.round((p.xmin - B.xmin) / t.x)); Math.abs(B.ymax - p.ymax) > t.y && (z = Math.round((B.ymax - p.ymax) / t.y)); this.clear(); "css-transforms" === this._map.navigationMode ? (this._tdx = this._left, this._tdy = this._top, this._multiply = null, r.set(this._div, k._css.names.transform, k._css.translate(this._left, this._top)), r.set(this._canvas, k._css.names.transform, k._css.translate(-this._left, -this._top))) : (r.set(this._div, {
                                                                                                        left: "0px", top: "0px",
                                                                                                        width: this._map.width + "px", height: this._map.height + "px"
                                                                                                }), r.set(this._canvas, { left: "0px", top: "0px", width: this._map.width + "px", height: this._map.height + "px" })); this._dragOrigin = { x: 0, y: 0 }; f.putImageData(h, u, z, 0, 0, a.width, a.height); this._fireUpdateEnd()
                                                                                } else this.clear()
                                                                }
                                                        }, _panHandler: function (a, f) {
                                                                "css-transforms" === this._map.navigationMode ? (this._left = this._map.__visibleDelta.x + f.x, this._top = this._map.__visibleDelta.y + f.y, r.set(this._div, k._css.names.transform, k._css.translate(this._left, this._top))) :
                                                                r.set(this._div, { left: this._startRect.left + f.x + "px", top: this._startRect.top + f.y + "px" })
                                                        }, _panEndHandler: function (a, f) { f && (this._startRect.left += f.x, this._startRect.top += f.y) }, _onScaleHandler: function (a, f) {
                                                                var h = {}, p = k._css.names; r.set(this._canvas, p.transition, f ? "none" : p.transformName + " " + e + "ms ease"); this._matrix = a; a = this._multiply ? l.multiply(a, this._multiply) : a; if (this._tdx || this._tdy) a = l.multiply(a, { xx: 1, xy: 0, yx: 0, yy: 1, dx: -this._tdx, dy: -this._tdy }); h[p.transform] = k._css.matrix(a); r.set(this._canvas,
                                                                        h)
                                                        }, _onZoomHandler: function (a, f, h) { var p = this._startRect; a = p.width * f; f *= p.height; var B = p.left - (a - p.width) * (h.x - p.left) / p.width; h = p.top - (f - p.height) * (h.y - p.top) / p.height; r.set(this._canvas, { left: B + "px", top: h + "px", width: a + "px", height: f + "px" }); this._endRect = { left: B, top: h, width: a, height: f } }, _onZoomEndHandler: function () { this._endRect && (this._startRect = this._endRect) }, _onResizeHandler: function (a, f, h) {
                                                                r.set(this._div, { width: f + "px", height: h + "px" }); r.set(this._canvas, { width: f + "px", height: h + "px" }); this._startRect.width =
                                                                        this._canvas.width = f; this._startRect.height = this._canvas.height = h
                                                        }, _extentChangeHandler: function (a, f, h, p) {
                                                                this.suspended || f && 0 === f.x && 0 === f.y && !h || ("css-transforms" === this._map.navigationMode && (f && (this._dragOrigin.x += f.x, this._dragOrigin.y += f.y), h || (this._left = this._map.__visibleDelta.x, this._top = this._map.__visibleDelta.y, r.set(this._div, k._css.names.transform, k._css.translate(this._left, this._top))), h && (r.set(this._canvas, k._css.names.transition, "none"), this._multiply = this._multiply ? l.multiply(this._matrix,
                                                                        this._multiply) : this._matrix)), this._fireUpdateStart(), a = this._map, this._requestData(a.extent, a.width, a.height))
                                                        }, _visibilityChangeHandler: function (a) { a ? c.show(this._div) : c.hide(this._div) }, _opacityChangeHandler: function (a) { r.set(this._div, "opacity", a) }
                                        })
                        })
                }, "esri/layers/ImageServiceLayerMixin": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/json dojo/_base/config dojo/_base/connect dojo/has dojo/io-query dojo/DeferredList dojo/debounce ../kernel ../config ../lang ../request ../deferredUtils ../urlUtils ../geometry/Extent ../geometry/Point ../geometry/Polygon ../renderers/colorRampUtils ./MosaicRule ./RasterFunction ./DimensionalDefinition ./Raster ./PixelBlock ./pixelFilters/VectorFieldPixelFilter ./rasterFormats/ImageCanvasDecoder ./TimeInfo ./Field ../graphic ../tasks/ImageServiceIdentifyTask ../tasks/ImageServiceIdentifyParameters".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y, D, H, I, N, T, M, R, ca) {
                                        E = E(null, {
                                                declaredClass: "esri.layers.ImageServiceLayerMixin", _rasterFieldPrefix: "Raster.", _renderingRuleFieldSubPrefix: "ServicePixelValue.", _rasterFunctionServiceInfoProps: "bandCount pixelType hasRasterAttributeTable hasColormap hasHistograms minValues maxValues meanValues stdvValues serviceDataType".split(" "), _pixelTypeRanges: { U1: [0, 1], U2: [0, 3], U4: [0, 15], U8: [0, 255], S8: [-128, 127], U16: [0, 65535], S16: [-32768, 32767] }, _eventMap: {
                                                        "rendering-change": !0,
                                                        "mosaic-rule-change": !0, "spatial-reference-change": !0, "renderer-change": !0
                                                }, _cachedVariableStats: {}, _cachedVariableHistogram: {}, constructor: function (K, Q) { this.useMapTime = Q && Q.hasOwnProperty("useMapTime") ? !!Q.useMapTime : !0 }, _initialize: function (K, Q) {
                                                        this._url = f.urlToObject(K); this.raster = new y(this._url.path); this._rasterFunctionTemplateInfos = {}; this._rasterFunctionTemplatePromise = {}; this._customRenderingRuleId = {}; this.infoTemplate = Q && Q.infoTemplate; this.format = (K = Q && Q.imageServiceParameters) && K.format;
                                                        this.compressionTolerance = K && K.compressionTolerance ? K.compressionTolerance : .01; this.interpolation = K ? K.interpolation : null; this.compressionQuality = K ? K.compressionQuality : null; this.bandIds = K ? K.bandIds : null; this.mosaicRule = K ? K.mosaicRule : null; this.renderingRule = K ? K.renderingRule : null; this.renderer = K ? K.renderer : null; this.useMapDimensionValue = Q && Q.hasOwnProperty("useMapDimensionValue") ? !!Q.useMapDimensionValue : !0; this.hasImageFilter = Q && Q.hasImageFilter; this.activeMapDimensions = Q && Q.activeMapDimensions;
                                                        this._params = q.mixin({}, this._url.query, { f: "image", interpolation: this.interpolation, format: this.format, compressionQuality: this.compressionQuality, bandIds: this.bandIds ? this.bandIds.join(",") : null }, K ? K.toJson() : {}); this.pixelFilter = Q && Q.pixelFilter; this.originalPixelData = this.pixelData = null; this.hasDataChanged = !0; this._requestDataHandler = q.hitch(this, this._requestDataHandler); this._requestDataErrorHandler = q.hitch(this, this._requestDataErrorHandler); this._rasterReadPromise = null; this._initLayer = q.hitch(this,
                                                                this._initLayer); this._queryVisibleRastersHandler = q.hitch(this, this._queryVisibleRastersHandler); this._visibleRasters = []; this._rasterAttributeTableFields = []; this._rasterAttributeTableFeatures = []; this._renderingRuleAttributeTable = {}; this._renderingRuleColormap = {}; this._useRenderingRuleAttributeTable = !1; this._loadCallback = Q && Q.loadCallback; K && K.renderer && (K.renderer.outputUnit || K.renderer.inputUnit) && (this.vectorFieldPixelFilter = new H, this.vectorFieldPixelFilter.setUnits(K.renderer.inputUnit, K.renderer.outputUnit));
                                                        (Q = Q && Q.resourceInfo) ? this._initLayer(Q) : e({ url: this._url.path, content: q.mixin({ f: "json" }, this._url.query), callbackParamName: "callback", load: this._initLayer, error: this._errorHandler }); this.registerConnectEvents()
                                                }, disableClientCaching: !1, _initLayer: function (K, Q) {
                                                        if (null !== K && void 0 !== K) {
                                                                this._findCredential(); (this.credential && this.credential.ssl || K && K._ssl) && this._useSSL(); Q = this.minScale; var X = this.maxScale; q.mixin(this, K); this.minScale = Q; this.maxScale = X; this.initialExtent = this.fullExtent = this.extent =
                                                                        new h(K.extent); this.spatialReference = this.initialExtent.spatialReference; this.pixelSizeX = parseFloat(this.pixelSizeX); this.pixelSizeY = parseFloat(this.pixelSizeY); var W = this.minValues, fa = this.maxValues, ma = this.meanValues, ia = this.stdvValues, va = this.bands = []; Q = 0; for (X = this.bandCount; Q < X; Q++)va[Q] = { min: W[Q], max: fa[Q], mean: ma[Q], stddev: ia[Q] }; this.timeInfo = (Q = this.timeInfo) && Q.timeExtent ? new N(Q) : null; X = this.fields = []; if (W = K.fields) for (Q = 0; Q < W.length; Q++)X.push(new T(W[Q])); this._updateInfoTemplateFields(this.fields);
                                                                this.version = K.currentVersion; this.version || (this.version = "fields" in K || "objectIdField" in K || "timeInfo" in K ? 10 : 9.3); b.isDefined(K.minScale) && !this._hasMin && "Raster" !== K.cacheType && this.setMinScale(K.minScale); b.isDefined(K.maxScale) && !this._hasMax && "Raster" !== K.cacheType && this.setMaxScale(K.maxScale); Q = {}; K.defaultMosaicMethod ? (Q.method = K.defaultMosaicMethod, Q.operation = K.mosaicOperator, Q.sortField = K.sortField, Q.sortValue = K.sortValue) : Q.method = u.METHOD_NONE; this.defaultMosaicRule = new u(Q); this.defaultMosaicRule.ascending =
                                                                        !0; this._useRenderingRuleAttributeTable = 10 < this.version && "esriImageServiceDataTypeThematic" === this.serviceDataType; this._setDefaultRenderingRule(!0); this._getRenderingRuleAttributeTableAndColormap(); this._isScientificData() && (!this.mosaicRule || this.mosaicRule && !this.mosaicRule.multidimensionalDefinition) && this._setDefaultMultidimensionalDefinition(!0); 10 < this.version && this.hasRasterAttributeTable && this.getRasterAttributeTable().then(q.hitch(this, function (xa) {
                                                                                xa && (xa.features && xa.fields && (this.rasterAttributeTable =
                                                                                        q.clone(xa)), xa.features && 0 < xa.features.length && (this._rasterAttributeTableFeatures = q.clone(xa.features)), xa.fields && 0 < xa.fields.length && (this._rasterAttributeTableFields = q.clone(xa.fields)), this.renderingRule || !this.renderer || "esri.renderer.ClassBreaksRenderer" !== this.renderer.declaredClass && "esri.renderer.UniqueValueRenderer" !== this.renderer.declaredClass || this.refresh())
                                                                        })); this._initVectorPixelFilter(); this.bandIds || 2 !== this.bandCount || this.renderingRule || "esri.layers.ArcGISImageServiceLayer" !==
                                                                                this.declaredClass || this.setBandIds([0, 0, 0], !0); !(10.3 <= this.version && this.rasterFunctionInfos && this.rasterFunctionInfos.length) || this._url.query && this._url.query.raster || this.getRasterFunctionInfos().then(q.hitch(this, function (xa) { if (xa && xa.length) { this.rasterFunctionInfos = xa; var na = [], ra; w.forEach(xa, function (sa) { if (sa) { var wa = sa.functionType; ra = ra || 1 === wa || 2 === wa; na.push(sa.name) } }, this); this._hasItemLevelRFT = ra; this._rasterFunctionNames = na; ra && (this._initVectorPixelFilter(), this.refresh()) } }));
                                                                this.loaded = !0; this._setDefaultFilter(); this.onLoad(this); if (K = this._loadCallback) delete this._loadCallback, K(this)
                                                        }
                                                }, _updateInfoTemplateFields: function (K) {
                                                        if (K && !(1 > K.length) && this.infoTemplate && this.infoTemplate.info && this.infoTemplate.info.fieldInfos && !(1 > this.infoTemplate.info.fieldInfos.length)) {
                                                                var Q, X; var W = this.infoTemplate.info.fieldInfos; for (Q = 0; Q < K.length; Q++) {
                                                                        var fa = K[Q]; for (X = 0; X < W.length; X++)if (W[X].fieldName.toLowerCase() === fa.name.toLowerCase() && W[X].fieldName !== fa.name) {
                                                                                W[X].fieldName =
                                                                                fa.name; break
                                                                        }
                                                                }
                                                        }
                                                }, getKeyProperties: function (K) { var Q = this._url.path + "/keyProperties", X = new A(a._dfdCanceller), W = { f: "json" }; K && K.renderingRule && (W.renderingRule = m.toJson(K.renderingRule.toJson())); 10 < this.version ? (X._pendingDfd = e({ url: Q, content: W, handleAs: "json", callbackParamName: "callback" }), X._pendingDfd.then(function (fa) { X.callback(fa) }, function (fa) { X.errback(fa) })) : (K = Error("Layer does not have key properties"), K.log = !!v.isDebug, X.errback(K)); return X }, getRasterAttributeTable: function (K) {
                                                        var Q =
                                                                this._url.path + "/rasterAttributeTable", X = new A(a._dfdCanceller), W = { f: "json" }, fa = this.hasRasterAttributeTable; K && K.renderingRule && (W.renderingRule = m.toJson(K.renderingRule.toJson()), fa = !0); !this.loaded || 10 < this.version && fa ? (X._pendingDfd = e({ url: Q, content: W, handleAs: "json", callbackParamName: "callback" }), X._pendingDfd.then(function (ma) { X.callback(ma) }, function (ma) { X.errback(ma) })) : (K = Error("Layer does not support raster attribute table"), K.log = !!v.isDebug, X.errback(K)); return X
                                                }, getRenderingRuleAttributeTable: function (K) {
                                                        var Q =
                                                                new A(a._dfdCanceller); if (!K || !K.renderingRule) return Q.errback(Error("Rendering rule is not specified")), Q; K = K.renderingRule; var X = this._getRenderingRuleId(K); this._renderingRuleAttributeTable && X && this._renderingRuleAttributeTable.hasOwnProperty(X) ? Q.resolve(this._renderingRuleAttributeTable[X]) : Q = this.getRasterAttributeTable({ renderingRule: K }).then(q.hitch(this, function (W) {
                                                                        if (W && W.features && W.features.length && W.fields && W.fields.length) {
                                                                                var fa = { features: q.clone(W.features), fields: q.clone(W.fields) };
                                                                                X && (this._renderingRuleAttributeTable[X] = fa)
                                                                        } return fa
                                                                })); return Q
                                                }, _initVectorPixelFilter: function () {
                                                        var K; this._hasItemLevelRFT && this.renderingRule && (K = this._getItemLevelRenderingRule(this.renderingRule)); if (K = K || this.renderingRule) return this.getRenderingRuleServiceInfo(K).then(q.hitch(this, function (Q) {
                                                                !Q || !this._isVectorData(Q) && "esri.layers.ArcGISImageServiceVectorLayer" !== this.declaredClass || b.isDefined(this.pixelFilter) || (this.vectorFieldPixelFilter = this.vectorFieldPixelFilter || new H, this.vectorFieldPixelFilter.isDataUV =
                                                                        "esriImageServiceDataTypeVector-UV" === Q.serviceDataType, this.pixelFilter = this.vectorFieldPixelFilter.computeMagnitudeAndDirection, this.getKeyProperties().then(q.hitch(this, this._setFlowRepresentation)), this._applyVectorResamplingType(Q.serviceDataType))
                                                        }))
                                                }, _applyVectorResamplingType: function (K) { if (K) { var Q = this.renderingRule; Q && "Resample" === Q.functionName && ((Q.functionArguments || {}).ResamplingType = "esriImageServiceDataTypeVector-UV" === K ? 7 : 10, this.setRenderingRule(new z(Q.toJson()))) } }, _getRasterAttributeTableFeatures: function () {
                                                        var K =
                                                                new A; if (this._rasterAttributeTableFeatures && 0 < this._rasterAttributeTableFeatures.length) return K.resolve(this._rasterAttributeTableFeatures), K; if (10 < this.version && this.hasRasterAttributeTable) return K = this.getRasterAttributeTable(), K.then(q.hitch(this, function (Q) { Q && Q.features && 0 < Q.features.length && (this._rasterAttributeTableFeatures = q.clone(Q.features)) })), K; K.resolve(this._rasterAttributeTableFeatures); return K
                                                }, _getRenderingRuleAttributeTableFeatures: function (K) {
                                                        K = K && K.renderingRule; return K ?
                                                                this.getRenderingRuleAttributeTable({ renderingRule: K }).then(function (Q) { return Q && Q.features }) : (K = new A, K.errback(Error("Rendering rule is not specified")), K)
                                                }, _getRenderingRuleAttributeTableAndColormap: function () {
                                                        this.renderingRule && this.getRenderingRuleServiceInfo(this.renderingRule).then(q.hitch(this, function (K) {
                                                                K.hasRasterAttributeTable && this.getRenderingRuleAttributeTable({ renderingRule: this.renderingRule }).then(q.hitch(this, function () {
                                                                        !this.renderer || "esri.renderer.ClassBreaksRenderer" !== this.renderer.declaredClass &&
                                                                                "esri.renderer.UniqueValueRenderer" !== this.renderer.declaredClass || this.refresh()
                                                                })); K.hasColormap && this.getRenderingRuleColormap({ renderingRule: this.renderingRule }).then(q.hitch(this, function () { this.renderer && "esri.renderer.ColormapRenderer" === this.renderer.declaredClass && this.refresh() }))
                                                        }))
                                                }, getCustomRasterFields: function (K) {
                                                        var Q = K ? K.rasterAttributeTableFieldPrefix : this._rasterFieldPrefix; K = 10.3 <= this.version ? "esriFieldTypeDouble" : "esriFieldTypeString"; var X = {
                                                                name: this._rasterFieldPrefix + "ItemPixelValue",
                                                                alias: "Item Pixel Value", domain: null, editable: !1, length: 50, type: K
                                                        }, W = { name: this._rasterFieldPrefix + "ServicePixelValue", alias: "Service Pixel Value", domain: null, editable: !1, length: 50, type: K }, fa = { name: this._rasterFieldPrefix + "ServicePixelValue.Raw", alias: "Raw Service Pixel Value", domain: null, editable: !1, length: 50, type: "esriFieldTypeDouble" }, ma = this.fields ? q.clone(this.fields) : []; K = ma.length; ma[K] = W; 10.4 <= this.version && "esri.layers.ArcGISImageServiceLayer" === this.declaredClass && (!this.rasterFunctionInfos ||
                                                                !this.rasterFunctionInfos.length || this._isRenderingRuleAProcessingTemplate({ functionName: "none" })) && (K++, ma[K] = fa); if (this.capabilities && -1 < this.capabilities.toLowerCase().indexOf("catalog") || this.fields && 0 < this.fields.length) K++, ma[K] = X; !b.isDefined(this.pixelFilter) || "esriImageServiceDataTypeVector-UV" !== this.serviceDataType && "esriImageServiceDataTypeVector-MagDir" !== this.serviceDataType || (X = { name: this._rasterFieldPrefix + "Magnitude", alias: "Magnitude", domain: null, editable: !1, type: "esriFieldTypeDouble" },
                                                                        W = { name: this._rasterFieldPrefix + "Direction", alias: "Direction", domain: null, editable: !1, type: "esriFieldTypeDouble" }, K++, ma[K] = X, K++, ma[K] = W); K = this._rasterAttributeTableFields; (X = this.renderingRule && this._getRenderingRuleId(this.renderingRule)) && this._renderingRuleAttributeTable && this._renderingRuleAttributeTable.hasOwnProperty(X) && (K = this._renderingRuleAttributeTable[X].fields); K && 0 < K.length && (K = w.filter(K, function (va) { return "esriFieldTypeOID" !== va.type && "value" !== va.name.toLowerCase() }), K = w.map(K,
                                                                                function (va) { var xa = q.clone(va); xa.name = Q + va.name; return xa }), ma = ma.concat(K)); var ia = this._rasterFieldPrefix + this._renderingRuleFieldSubPrefix; 10.4 <= this.version && this.rasterFunctionInfos && w.forEach(this.rasterFunctionInfos, function (va) { va && va.name && "none" !== va.name.toLowerCase() && (va = { name: ia + va.name.replace(/ /gi, "_"), alias: va.name, domain: null, editable: !1, type: "esriFieldTypeDouble" }, ma.push(va)) }); return ma
                                                }, _applyTimeToMultidimensionalCRF: function (K, Q) {
                                                        var X = this._isTimeSupportedOnCRF(); if (X &&
                                                                (!K || !K.multidimensionalDefinition)) return K; var W = this.timeInfo && this.timeInfo.startTimeField; if ((Q = Q || this._params.time) && W && this._isMultidimensionalCRF()) {
                                                                        K = q.clone(K || this.defaultMosaicRule) || new u; K.multidimensionalDefinition = K.multidimensionalDefinition || []; var fa = K.multidimensionalDefinition.filter(function (ia) { return ia.dimensionName === W }), ma = Q.split(",").map(function (ia) { return parseInt(ia, 10) }); 2 === ma.length && ma[0] === ma[1] && (ma.length = 1); 0 < fa.length ? X ? K.multidimensionalDefinition.forEach(function (ia) {
                                                                                ia.dimensionName ===
                                                                                W && (ia.dimensionName = null, ia.isSlice = null, ia.values = null)
                                                                        }) : K.multidimensionalDefinition.forEach(function (ia) { ia.dimensionName === W && (ia.isSlice = 1 === ma.length, ia.values = 1 === ma.length ? ma : [ma]) }) : X || (K.multidimensionalDefinition.some(function (ia) { return null != ia.variableName && null == ia.dimensionName }) ? K.multidimensionalDefinition.forEach(function (ia) { null != ia.variableName && null == ia.dimensionName && (ia.dimensionName = W, ia.isSlice = 1 === ma.length, ia.values = 1 === ma.length ? ma : [ma]) }) : K.multidimensionalDefinition.push(new x({
                                                                                variableName: "",
                                                                                dimensionName: W, isSlice: 1 === ma.length, values: 1 === ma.length ? ma : [ma]
                                                                        }))); this._cleanupMultidimensionalDefinition(K)
                                                                } return K
                                                }, _prepareGetImageParameters: function (K, Q, X, W) {
                                                        W = b.isDefined(W) ? W : this._params; if (this.renderer || this._hasItemLevelRFT && this.renderingRule) { var fa = this.getExportImageRenderingRule(); W.renderingRule = fa ? m.toJson(fa.toJson()) : null } fa = this.getExportImageMosaicRule(W); W.mosaicRule = fa ? m.toJson(fa.toJson()) : null; fa = K.spatialReference.wkid || m.toJson(K.spatialReference.toJson(!1)); delete W._ts;
                                                        q.mixin(W, { bbox: K.xmin + "," + K.ymin + "," + K.xmax + "," + K.ymax, imageSR: fa, bboxSR: fa, size: Q + "," + X }, this.disableClientCaching ? { _ts: (new Date).getTime() } : {}); delete W.compressionTolerance; W.format && "LERC" === W.format.toUpperCase() && (W.compressionTolerance = this.compressionTolerance); W.token = this._getToken()
                                                }, getImageUrl: function (K, Q, X, W, fa) {
                                                        fa = b.isDefined(fa) ? fa : this._params; this._prepareGetImageParameters(K, Q, X, fa); K = q.clone(fa); this._cleanupRequestParams(K); Q = this._url.path + "/exportImage?"; X = f.addProxy(Q + k.objectToQuery(q.mixin(K,
                                                                { f: "image" }))); var ma = K.token; X.length > g.defaults.io.postLength || this.useMapImage ? this._jsonRequest = e({ url: Q, content: q.mixin(K, { f: "json" }), callbackParamName: "callback", load: function (ia, va) { ia = ia.href; ma && (ia += -1 === ia.indexOf("?") ? "?token\x3d" + ma : "\x26token\x3d" + ma); W(f.addProxy(ia)) }, error: this._errorHandler }) : W(X)
                                                }, onRenderingChange: function () { }, onMosaicRuleChange: function () { }, onRendererChange: function () { }, setInterpolation: function (K, Q) { this.interpolation = this._params.interpolation = K; Q || this.refresh(!0) },
                                                setCompressionQuality: function (K, Q) { this.compressionQuality = this._params.compressionQuality = K; Q || this.refresh(!0) }, setCompressionTolerance: function (K, Q) { this.compressionTolerance = K; Q || this.refresh(!0) }, setBandIds: function (K, Q) { var X = !1; this.bandIds !== K && (X = !0); this.bandIds = K; this._params.bandIds = K ? K.join(",") : null; if (X && !Q) this.onRenderingChange(); Q || this.refresh(!0) }, setDefaultBandIds: function (K) { this.bandIds = this._params.bandIds = null; K || this.refresh(!0) }, setDisableClientCaching: function (K) {
                                                        this.disableClientCaching =
                                                        K
                                                }, setMosaicRule: function (K, Q) { var X = !1; this.mosaicRule !== K && (X = !0); this.mosaicRule = K; this._params.mosaicRule = m.toJson(K.toJson()); if (X && !Q) this.onMosaicRuleChange(); Q || this.refresh(!0) }, getRasterFunctionInfos: function () { if (10.3 > this.version || !this.rasterFunctionInfos || !this.rasterFunctionInfos.length) console.log("Layer doesn't support /rasterFunctionInfos resource."); else return e({ url: this._url.path + "/rasterFunctionInfos", content: { f: "json" }, handleAs: "json", load: function (K) { return K && K.rasterFunctionInfos } }) },
                                                setRenderingRule: function (K, Q) { var X = !1; this.renderingRule !== K && (X = !0); this.renderingRule = K; this._params.renderingRule = K ? m.toJson(K.toJson()) : null; this._useRenderingRuleAttributeTable ? this.getRenderingRuleAttributeTable({ renderingRule: K }) : "esri.layers.RasterXLayer" !== this.declaredClass && this._getRenderingRuleAttributeTableAndColormap(); if (X) this.onRenderingChange(); this._setDefaultFilter(); Q || this.refresh(!0) }, setImageFormat: function (K, Q) {
                                                        this.format = this._params.format = K; this._setDefaultFilter();
                                                        Q || this.refresh(!0)
                                                }, setInfoTemplate: function (K) { this.infoTemplate = K; this._updateInfoTemplateFields(this.fields) }, setDefinitionExpression: function (K, Q) { var X = this.mosaicRule ? this.mosaicRule.toJson() : {}; this.mosaicRule || (this.defaultMosaicRule ? X = this.defaultMosaicRule.toJson() : X.method = u.METHOD_NONE); X.where = K; K = new u(X); this.setMosaicRule(K, Q); return this }, getDefinitionExpression: function () { return this.mosaicRule ? this.mosaicRule.where : null }, setPixelFilter: function (K) {
                                                        this.pixelFilter = K; this._isDefaultPixelFilter =
                                                                !1
                                                }, getPixelData: function (K) { return K ? (this._useBrowserDecoding() && (this.originalPixelData = { pixelBlock: this._getPixelBlockFromCanvas(this._context, this._map.width, this._map.height), extent: this._map.extent }), this.originalPixelData) : this.pixelData }, getExportImageRenderingRule: function () {
                                                        var K; this._hasItemLevelRFT && this.renderingRule && (K = this._getServiceLevelRenderingRule(this.renderingRule)); K = K || this.renderingRule; this._isItemLevelRasterFunction(this.renderingRule) && (K = void 0); return this._combineRenderingRule(this._convertRendererToRenderingRule(this.renderer),
                                                                K)
                                                }, getExportImageMosaicRule: function () { var K = this.mosaicRule, Q; this._hasItemLevelRFT && this.renderingRule && (Q = this._getItemLevelRenderingRule(this.renderingRule)); Q && (K = K || this.defaultMosaicRule || new u, K.itemRenderingRule = Q); return K = this._applyTimeToMultidimensionalCRF(K) }, redraw: function () { this.hasDataChanged = !1; this._setPixelData(this.originalPixelData) }, getHistograms: function (K) {
                                                        var Q = K.variableName, X = (K = (K = K.renderingRule || this.renderingRule || this.defaultRenderingRule) && "none" !== K.functionName.toLowerCase() ?
                                                                K.toJson() : null) ? K.functionName : "", W = new A(a._dfdCanceller); if ((Q || "" === Q) && this._cachedVariableHistogram[Q] && this._cachedVariableHistogram[Q][X]) return W.resolve(this._cachedVariableHistogram[Q][X]), W; if (this.hasHistograms) {
                                                                        var fa = { f: "json" }; Q && (fa.variable = Q); K && 10.9 < this.version && (fa.renderingRule = JSON.stringify(K)); W._pendingDfd = e({ url: this._url.path + "/histograms", content: fa, handleAs: "json", callbackParamName: "callback" }); W._pendingDfd.then(q.hitch(this, function (ma) {
                                                                                if (Q || "" === Q) this._cachedVariableHistogram[Q] =
                                                                                        this._cachedVariableHistogram[Q] || {}, this._cachedVariableHistogram[Q][X] = ma; W.callback(ma)
                                                                        }), function (ma) { W.errback(ma) })
                                                                } else K = Error("Layer does not have histograms."), K.log = !!v.isDebug, W.errback(K); return W
                                                }, computeHistograms: function (K) {
                                                        var Q = new A(a._dfdCanceller); if (10.1 <= this.currentVersion) {
                                                                K = K || {}; var X = K.geometry || this.fullExtent, W = (K.geometry || this.fullExtent).toJson(); X = "extent" === X.type ? "esriGeometryEnvelope" : "esriGeometryPolygon"; var fa = K.renderingRule || this.renderingRule || this.defaultRenderingRule;
                                                                fa = fa ? fa.toJson() : null; var ma = K.mosaicRule || this.mosaicRule || this.defaultMosaicRule; ma = ma ? ma.toJson() : null; K = K.pixelSize || { x: this.pixelSizeX, y: this.pixelSizeY }; Q._pendingDfd = e({ url: this._url.path + "/computeHistograms", content: q.mixin({ f: "json", geometry: JSON.stringify(W), geometryType: X, renderingRule: JSON.stringify(fa), mosaicRule: JSON.stringify(ma), pixelSize: JSON.stringify(K), callbackParamName: "callback" }), handleAs: "json" }); Q._pendingDfd.then(function (ia) { Q.callback(ia) }, function (ia) { Q.errback(ia) })
                                                        } else W =
                                                                Error("Layer doesn't support computeHistograms."), W.log = !!v.isDebug, Q.errback(W); return Q
                                                }, getRenderingRuleServiceInfo: function (K, Q) {
                                                        function X(ma) { return ma.name && ma.arguments && ma.function && ma.hasOwnProperty("functionType") } var W = new a._fixDfd(new A(a._dfdCanceller)); if (!K) return W.errback(Error("Rendering rule is not specified")), W; if (X(K)) "ClipFunction" === K.function.type && (K = this._handleClipFunctionInRenderingRule(K)); else {
                                                                var fa = this._getRenderingRuleId(K); if (fa) {
                                                                        if (this._rasterFunctionTemplateInfos[fa]) return W.resolve(this._rasterFunctionTemplateInfos[fa]),
                                                                                W; if (this._rasterFunctionTemplatePromise[fa]) return W = this._rasterFunctionTemplatePromise[fa]
                                                                }
                                                        } W = e({ url: this._url.path, content: q.mixin(q.mixin({ f: "json", renderingRule: JSON.stringify(K.toJson()) }, this._url.query)), callbackParamName: "callback", load: q.hitch(this, function (ma) { var ia = {}; w.forEach(this._rasterFunctionServiceInfoProps, function (va) { ia[va] = ma[va] }); X(K) || (this._rasterFunctionTemplateInfos[fa] = ia); return ia }), error: Q || this._errorHandler }); fa && !this._rasterFunctionTemplatePromise[fa] && (this._rasterFunctionTemplatePromise[fa] =
                                                                W); return W
                                                }, queryVisibleRasters: function (K, Q, X, W) {
                                                        var fa = this._map, ma = a._fixDfd(new A(a._dfdCanceller)); this._visibleRasters = []; var ia, va, xa = !0, na = !0, ra = null, sa = this.infoTemplate ? this.infoTemplate.info : null, wa = sa ? q.clone(this.infoTemplate.info.fieldInfos) : null; Q = Q || {}; if (sa && this.infoTemplate.info.mediaInfos && this.infoTemplate.info.mediaInfos.length) {
                                                                var aa = []; w.forEach(this.infoTemplate.info.mediaInfos, function (P) { aa = aa.concat(P && P.value && P.value.fields || []) }); aa.length && w.forEach(wa, function (P) {
                                                                        P &&
                                                                        -1 < aa.indexOf(P.fieldName) && (P.visible = !0)
                                                                })
                                                        } var Da = function (P) { var S = sa && sa.title && -1 < sa.title.toLowerCase().indexOf(P.toLowerCase()); P = sa && sa.description && -1 < sa.description.toLowerCase().indexOf(P.toLowerCase()); return S || P }; if (wa && 0 < wa.length) for (xa = !1, ia = 0; ia < wa.length; ia++)if ((va = wa[ia]) && va.fieldName.toLowerCase() !== this._rasterFieldPrefix.toLowerCase() + "servicepixelvalue" && (va.visible || Da(va.fieldName))) { xa = !0; break } this.infoTemplate && this.infoTemplate.info && this.infoTemplate.info.layerOptions &&
                                                                this.infoTemplate.info.layerOptions.hasOwnProperty("returnTopmostRaster") && (ra = this.infoTemplate.info.layerOptions.returnTopmostRaster ? 1 : null); wa && 0 < wa.length && (na = !1, w.some(wa, function (P) { if (P && P.fieldName.toLowerCase() === this._rasterFieldPrefix.toLowerCase() + "itempixelvalue" && P.visible) return na = !0 }, this), Da(this._rasterFieldPrefix.toLowerCase() + "itempixelvalue") && (na = !0)); var Ca = (va = this._removeVisualizationStretchFunction(this.renderingRule)) && va.functionName, O = []; if (10.4 <= this.version) {
                                                                        var C =
                                                                                !1; if (this.rasterFunctionInfos && wa) { var G = this._rasterFieldPrefix + this._renderingRuleFieldSubPrefix; w.forEach(this.rasterFunctionInfos, function (P) { var S = G + P.name.replace(/ /gi, "_"); w.some(wa, function (Y) { return Y.visible && Y.fieldName === S }) && (C = C || Ca && Ca === P.name, O.push(new z({ rasterFunction: P.name }))) }) } va && !C && O.push(va)
                                                                } ia = new ca; ia.geometry = K.geometry; ia.returnGeometry = this._map.spatialReference.equals(this.spatialReference); ia.returnCatalogItems = xa; ia.timeExtent = this.timeInfo ? K.timeExtent : null;
                                                        ia.returnPixelValues = na; ia.maxItemCount = ra || K.maxItemCount; this._params.time && this.mosaicRule ? (K = q.clone(this.mosaicRule), K = this._filterOutTimeDimension(K), ia.mosaicRule = K) : ia.mosaicRule = this.mosaicRule || null; this._isMultidimensionalCRF() && ia.timeExtent && (ia.mosaicRule = this._applyTimeToMultidimensionalCRF(ia.mosaicRule, ia.timeExtent.toJson().join(",")), this._isTimeSupportedOnCRF() || delete ia.timeExtent); ia.renderingRule = 10.4 > this.version && va || null; ia.renderingRules = O || null; 10.8 > this.version && (ia.returnPixelValues =
                                                                void 0, ia.maxItemCount = void 0); fa && (fa = new p((fa.extent.xmax - fa.extent.xmin) / fa.width, (fa.extent.ymax - fa.extent.ymin) / fa.height, fa.extent.spatialReference), ia.pixelSize = fa); Q.requestParams = ia; var L = this; fa = new R(this.url); (ma._pendingDfd = fa.execute(ia)).addCallbacks(function (P) { L._queryVisibleRastersHandler(P, Q, X, W, ma) }, function (P) { L._resolve([P], null, W, ma, !0) }); return ma
                                                }, _queryVisibleRastersHandler: function (K, Q, X, W, fa) {
                                                        function ma() {
                                                                var ua = this.getCustomRasterFields(Q), qa = this._getDomainFields(ua),
                                                                V = Q ? Q.returnDomainValues : !1, da = Q && Q.rasterAttributeTableFieldPrefix, Z, ea, la, oa, ya, ta, Ea, Aa, za, Ha; ua = (ua = this._getRenderingRuleId(this.renderingRule)) && this._rasterFunctionTemplateInfos[ua]; this.renderingRule && (this._useRenderingRuleAttributeTable || ua) ? (ua = this._getRenderingRuleAttributeTableFeatures({ renderingRule: this.renderingRule }), this.hasRasterAttributeTable || (Ha = ia)) : ua = this._getRasterAttributeTableFeatures(); ua.then(q.hitch(this, function (Na) {
                                                                        for (Z = 0; Z < L.length; Z++) {
                                                                                ja = L[Z]; ja.setInfoTemplate(this.infoTemplate);
                                                                                ja._layer = this; if (ia) {
                                                                                        za = ia.replace(/ /gi, "").split(","); ea = ia; la = za; P && P.length >= Z && (ea = P[Z].replace(/ /gi, ", "), la = P[Z].split(" ")); ja.attributes[this._rasterFieldPrefix + "ItemPixelValue"] = la; ja.attributes[this._rasterFieldPrefix + "ServicePixelValue"] = za; va && (ja.attributes[this._rasterFieldPrefix + "ServicePixelValue.Raw"] = va.replace(/ /gi, "").split(",")); if (this.pixelFilter) {
                                                                                                var Pa = new D({ height: 1, width: 1, pixelType: "F32", pixels: [], statistics: [] }); w.forEach(la, function (Ra) {
                                                                                                        Pa.addData({
                                                                                                                pixels: [Ra], statistics: {
                                                                                                                        minValue: Ra,
                                                                                                                        maxValue: Ra, noDataValue: null
                                                                                                                }
                                                                                                        })
                                                                                                }); this.pixelFilter({ pixelBlock: Pa, extent: new h(0, 0, 0, 0, this._map.spatialReference) }); if ("esriImageServiceDataTypeVector-UV" === this.serviceDataType || "esriImageServiceDataTypeVector-MagDir" === this.serviceDataType) ja.attributes[this._rasterFieldPrefix + "Magnitude"] = Pa.pixels[0][0], ja.attributes[this._rasterFieldPrefix + "Direction"] = Pa.pixels[1][0]
                                                                                        } w.forEach(wa, function (Ra) { ja.attributes[Ra.name] = Ra.value }); var Sa = 0 < this.fields.length ? Ha || ea : Ha || va; if (Na && 0 < Na.length && (oa =
                                                                                                w.filter(Na, function (Ra) { if (Ra && Ra.attributes) return Ra.attributes.hasOwnProperty("Value") ? Ra.attributes.Value == Sa : Ra.attributes.VALUE == Sa }), 0 < oa.length && (ya = q.clone(oa[0]), da && ya))) { Aa = {}; for (ta in ya.attributes) ya.attributes.hasOwnProperty(ta) && (Ea = da + ta, Aa[Ea] = ya.attributes[ta]); ya.attributes = Aa; ja.attributes = q.mixin(ja.attributes, ya.attributes) }
                                                                                } V && qa && 0 < qa.length && w.forEach(qa, function (Ra) {
                                                                                        if (Ra) {
                                                                                                var La = ja.attributes[Ra.name]; b.isDefined(La) && (La = this._getDomainValue(Ra.domain, La), b.isDefined(La) &&
                                                                                                        (ja.attributes[Ra.name] = La))
                                                                                        }
                                                                                }, this); ka.push(ja); this._visibleRasters.push(ja)
                                                                        } this._resolve([ka, null, !0], null, X, fa)
                                                                }))
                                                        } var ia = K.value, va = K.value, xa = 0, na = 0, ra = this, sa = this.objectIdField, wa = []; W = Q.requestParams.renderingRules; var aa = K.processedValues, Da = this.renderingRule && m.toJson(this._removeVisualizationStretchFunction(this.renderingRule).toJson()); if (W && aa && W.length === aa.length) {
                                                                var Ca = this._rasterFieldPrefix + this._renderingRuleFieldSubPrefix; w.forEach(W, function (ua, qa) {
                                                                        if (ua.functionName) {
                                                                                var V =
                                                                                        { name: Ca + ua.functionName.replace(/ /gi, "_"), value: aa[qa].replace(/ /gi, "").split(",") }; wa.push(V); Da && Da === m.toJson(ua.toJson()) && (ia = aa[qa])
                                                                        }
                                                                })
                                                        } W = this.infoTemplate && this.infoTemplate.info && this.infoTemplate.info.layerOptions && this.infoTemplate.info.layerOptions.hasOwnProperty("showNoDataRecords") ? this.infoTemplate.info.layerOptions.showNoDataRecords : !0; if (K.catalogItems) {
                                                                var O = 0, C = K.catalogItems.features.length; var G = 0; var L = Array(C); var P = Array(C); var S = Array(C); if (K.properties && K.properties.Values) {
                                                                        C =
                                                                        K.properties.Values.length; for (xa = 0; xa < C; xa++)-1 < K.properties.Values[xa].toLowerCase().indexOf("nodata") && G++; var Y = C - G; for (xa = 0; xa < C; xa++) { G = !0; if (-1 < K.properties.Values[xa].toLowerCase().indexOf("nodata")) { var ha = Y++; W || (G = !1, L.length--, P.length--, S.length--) } else ha = O++; G && (L[ha] = K.catalogItems.features[xa], P[ha] = K.properties.Values[xa], S[ha] = L[ha].attributes[sa]) }
                                                                } else { for (xa = 0; xa < C; xa++)L[xa] = K.catalogItems.features[xa], S[xa] = L[xa].attributes[sa]; P = null }
                                                        } this._visibleRasters = []; (K = -1 < ia.toLowerCase().indexOf("nodata")) &&
                                                                !W && (L = [], P = [], S = []); if (ia && !L && !K) { sa = "ObjectId"; L = []; var ja = new M(new h(this.fullExtent), null, { ObjectId: 0 }); L.push(ja) } var ka = []; L ? !this._map.spatialReference.equals(this.spatialReference) && S && 0 < S.length ? e({
                                                                        url: this._url.path + "/query", content: { f: "json", objectIds: S.join(","), returnGeometry: !0, outSR: m.toJson(ra._map.spatialReference.toJson()), outFields: sa }, handleAs: "json", callbackParamName: "callback", load: function (ua) {
                                                                                if (0 === ua.features.length) ra._resolve([ka, null, null], null, X, fa); else {
                                                                                        for (xa = 0; xa <
                                                                                                ua.features.length; xa++)for (na = 0; na < L.length; na++)L[na].attributes[sa] == ua.features[xa].attributes[sa] && (L[na].geometry = new B(ua.features[xa].geometry), L[na].geometry.setSpatialReference(ra._map.spatialReference)); ma.call(ra)
                                                                                }
                                                                        }, error: function (ua) { ra._resolve([ka, null, null], null, X, fa) }
                                                                }) : ma.call(this) : this._resolve([ka, null, null], null, X, fa)
                                                }, getVisibleRasters: function () { var K = this._visibleRasters, Q = [], X; for (X in K) K.hasOwnProperty(X) && Q.push(K[X]); return Q }, _getDomainFields: function (K) {
                                                        if (K) {
                                                                var Q =
                                                                        []; w.forEach(K, function (X) { if (X.domain) { var W = {}; W.name = X.name; W.domain = X.domain; Q.push(W) } }); return Q
                                                        }
                                                }, _getDomainValue: function (K, Q) { if (K && K.codedValues) { var X; w.some(K.codedValues, function (W) { return W.code === Q ? (X = W.name, !0) : !1 }); return X } }, _requestData: function (K, Q, X) {
                                                        this._rasterReadPromise && this._rasterReadPromise.cancel(); K = q.clone(K); var W = K._normalize(!0); this._prepareGetImageParameters(W, Q, X); Q = q.clone(this._params); this._cleanupRequestParams(Q); Q.extent = K; Q.format = Q.format || (10.3 <= this.version ?
                                                                "lerc" : "jpgpng"); "lerc" === Q.format.toLowerCase() && !Q.lercVersion && 10.5 <= this.version && (Q.lercVersion = 2); this._params.time && this._isMultidimensionalCRF() && !this._isTimeSupportedOnCRF() && delete Q.time; X = null; this._useBrowserDecoding() && (X = new I({ ctx: this._context })); Q = { imageServiceParameters: Q, nBands: Math.min(this.bandCount, 3), pixelType: this.pixelType, decodeFunc: X ? q.hitch(X, "decode") : null }; this._rasterReadPromise = this.raster.read(Q, this._requestDataHandler, this._requestDataErrorHandler)
                                                }, _requestDataHandler: function (K) {
                                                        this._rasterReadPromise &&
                                                        this._rasterReadPromise.isCanceled() || (this.originalPixelData = K, this.hasDataChanged = !0, this._setPixelData(K))
                                                }, _setPixelData: function (K) { K = this._clonePixelData(K); this.pixelFilter && this.pixelFilter(K); this.pixelData = K; this._rasterReadPromise && this._rasterReadPromise.isCanceled() || (this._drawPixelData(), this._rasterReadPromise = null) }, _clonePixelData: function (K) {
                                                        if (null === K || void 0 === K) return K; var Q = {}; K.extent && (Q.extent = q.clone(K.extent)); K = K.pixelBlock; if (null === K || void 0 === K) return Q; Q.pixelBlock =
                                                                K.clone(); return Q
                                                }, _setDefaultFilter: function () { }, _getPixelBlockFromCanvas: function (K, Q, X) {
                                                        K = K.getImageData(0, 0, Q, X).data; var W = Q * X, fa = 0, ma = 0, ia = new Uint8Array(W), va = new Uint8Array(W), xa = new Uint8Array(W), na = new Uint8Array(W), ra = Infinity, sa = Infinity, wa = Infinity, aa = -Infinity, Da = -Infinity, Ca = -Infinity; for (fa = 0; fa < W; fa++) { var O = K[ma++]; var C = K[ma++]; var G = K[ma++]; ra = ra < O ? ra : O; aa = aa > O ? aa : O; sa = sa < C ? sa : C; Da = Da > C ? Da : C; wa = wa < G ? wa : G; Ca = Ca > G ? Ca : G; ia[fa] = O; va[fa] = C; xa[fa] = G; na[fa] = K[ma++] & 1 } return new D({
                                                                width: Q,
                                                                height: X, pixels: [ia, va, xa], pixelType: "U8", mask: na, statistics: [{ minValue: ra, maxValue: aa }, { minValue: sa, maxValue: Da }, { minValue: wa, maxValue: Ca }]
                                                        })
                                                }, _useBrowserDecoding: function () { return (void 0 === this.pixelFilter || null === this.pixelFilter) && ("jpeg" === this.format.toLowerCase() || "jpg" === this.format.toLowerCase() || -1 < this.format.toLowerCase().indexOf("png")) }, getMultidimensionalInfo: function () {
                                                        var K = this._url.path + "/multiDimensionalInfo", Q = new A(a._dfdCanceller); if (this._multidimensionalInfo) return Q.resolve(this._multidimensionalInfo),
                                                                Q; !this.loaded || 10.3 <= this.version && this.hasMultidimensions ? (Q._pendingDfd = e({ url: K, content: { f: "json" }, handleAs: "json", callbackParamName: "callback" }), Q._pendingDfd.then(q.hitch(this, function (X) { this._multidimensionalInfo = X.multidimensionalInfo; Q.callback(X.multidimensionalInfo) }), function (X) { Q.errback(X) })) : (K = Error("Layer does not support multidimensional info"), K.log = !!v.isDebug, Q.errback(K)); return Q
                                                }, getStatistics: function (K) {
                                                        var Q = new A(a._dfdCanceller); if (K && this._cachedVariableStats[K]) Q.resolve(this._cachedVariableStats[K]);
                                                        else {
                                                                var X = { f: "json" }; K && (X.variable = K); Q._pendingDfd = e({ url: this._url.path + "/statistics", content: X, handleAs: "json", callbackParamName: "callback" }); Q._pendingDfd.then(q.hitch(this, function (W) {
                                                                        W = W.statistics || W.statitsics; var fa = []; W && W[0] && null != W[0].min ? W.forEach(function (ma) { fa.push([ma.min, ma.max, ma.mean, ma.standardDeviation]) }) : fa = this.minValues && this.minValues.length ? this.minValues.map(function (ma, ia) { return [ma, this.maxValues[ia], this.meanValues[ia], this.stdvValues[ia]] }.bind(this)) : W; K && (this._cachedVariableStats[K] =
                                                                                fa); Q.callback(fa)
                                                                }), function (W) { Q.errback(W) })
                                                        } return Q
                                                }, getDefaultMultidimensionalDefinition: function () { var K = new A(a._dfdCanceller); if (this._defaultMultidimensionalDefinition) return K.resolve(q.clone(this._defaultMultidimensionalDefinition)), K; K._pendingDfd = this.getMultidimensionalInfo(); K._pendingDfd.then(q.hitch(this, function (Q) { Q = this._getDefaultMultidimensionalDefinition(Q); K.callback(Q) }), function (Q) { K.errback(Q) }); return K }, _getDefaultMultidimensionalDefinition: function (K, Q, X) {
                                                        var W, fa = [],
                                                        ma = this.defaultVariable || this.raster && this.raster.defaultVariable; variableName = ma || ""; dimensions = variableName.length ? K.variables.filter(function (ia) { return ia.name === variableName })[0].dimensions : K.variables[0].dimensions; X && (variableName = ma || K.variables[0].name); for (W in dimensions) dimensions.hasOwnProperty(W) && (Q || "StdTime" !== dimensions[W].name) && (K = dimensions[W], fa.push(new x({ variableName: variableName, dimensionName: K.name, isSlice: !K.hasRanges, values: [this._getDefaultDimensionValue(K)] }))); this._defaultMultidimensionalDefinition =
                                                                fa; return q.clone(fa)
                                                }, _getDefaultDimensionValue: function (K) { if (K && K.values && K.values.length) { var Q = Infinity, X; if (K.hasRanges) return K.values[0]; if (K.name && "stdz" === K.name.toLowerCase()) { for (X = 0; X < K.values.length; X++) { var W = K.values[X]; var fa = Math.abs(W - 0); if (fa < Q) { Q = fa; var ma = W } if (0 === fa) break } return ma } return K.extent[0] } }, _setDefaultMultidimensionalDefinition: function (K) {
                                                        var Q, X = {}; this.getDefaultMultidimensionalDefinition().then(q.hitch(this, function (W) {
                                                                Q = W; 0 < Q.length && (this.mosaicRule ? (X = q.clone(this.mosaicRule),
                                                                        X.multidimensionalDefinition = Q) : this.defaultMosaicRule ? (X = q.clone(this.defaultMosaicRule), X.multidimensionalDefinition = Q) : X = new u({ multidimensionalDefinition: Q }), this.setMosaicRule(X, K))
                                                        }))
                                                }, _setDefaultRenderingRule: function (K) {
                                                        var Q = {}, X = this.renderingRule; if (!X && "esri.layers.ArcGISImageServiceVectorLayer" !== this.declaredClass && !this.bandIds && this.rasterFunctionInfos && this.rasterFunctionInfos.length && "none" !== this.rasterFunctionInfos[0].name.toLowerCase()) Q.rasterFunction = this.rasterFunctionInfos[0].name;
                                                        else if ("esri.layers.ArcGISImageServiceVectorLayer" === this.declaredClass && 10.3 < this.version && (!X || "Resample" !== X.functionName)) { var W = "esriImageServiceDataTypeVector-UV" === this.serviceDataType ? 7 : 10; Q.rasterFunction = "Resample"; Q.rasterFunctionArguments = { ResamplingType: W, InputCellSize: { x: this.pixelSizeX, y: this.pixelSizeY } }; X && (Q.rasterFunctionArguments.Raster = X.toJson()) } Q.hasOwnProperty("rasterFunction") && (this.defaultRenderingRule = new z(Q), this.setRenderingRule(this.defaultRenderingRule, K))
                                                }, _cleanupRequestParams: function (K) {
                                                        if (!K) return K;
                                                        if (K.time && K.mosaicRule) { var Q = new u(m.fromJson(K.mosaicRule)); Q = this._filterOutTimeDimension(Q); K.mosaicRule = m.toJson(Q.toJson()) } Q = "displayOnPan drawMode styling id opacity visible resourceInfo useMapDimensionValue extent renderer".split(" "); for (var X in Q) K.hasOwnProperty(Q[X]) && delete K[Q[X]]; return K
                                                }, _filterOutTimeDimension: function (K) {
                                                        if (this._isMultidimensionalCRF()) return K; if (K && K.multidimensionalDefinition && 0 < K.multidimensionalDefinition.length) {
                                                                var Q = w.filter(K.multidimensionalDefinition,
                                                                        function (X) { return "StdTime" !== X.dimensionName }); K.multidimensionalDefinition = Q
                                                        } return K
                                                }, _removeVisualizationStretchFunction: function (K) { var Q = K && K.functionName; if (!Q || "stretch" !== Q.toLowerCase()) return K; var X = K.functionArguments.Raster; return X && X.functionName && w.some(this.rasterFunctionInfos, function (W) { return X.functionName === W.name }) ? X : K }, _isMultidimensionalCRF: function () { return 10.71 <= this.version && this.hasMultidimensions && this.timeInfo && !(this.objectIdField && this.fields && 1 < this.fields.length) },
                                                _isTimeSupportedOnCRF: function () { return 10.8 <= this.version }, _cleanupMultidimensionalDefinition: function (K) { K && K.multidimensionalDefinition && (K.multidimensionalDefinition = K.multidimensionalDefinition.filter(function (Q) { return !(!Q.variableName && !Q.dimensionName) }), 0 === K.multidimensionalDefinition.length && (K.multidimensionalDefinition = null)) }, _isScientificData: function () {
                                                        return "esriImageServiceDataTypeVector-UV" === this.serviceDataType || "esriImageServiceDataTypeVector-MagDir" === this.serviceDataType ||
                                                                "esriImageServiceDataTypeScientific" === this.serviceDataType || this.hasMultidimensions
                                                }, _isVectorData: function (K) { K = (K = K || this) && K.serviceDataType; return "esriImageServiceDataTypeVector-UV" === K || "esriImageServiceDataTypeVector-MagDir" === K }, _isRenderingRuleAProcessingTemplate: function (K) { var Q = K && K.functionName; return !Q || K.functionArguments ? !1 : w.some(Q && (this.rasterFunctionInfos || []), function (X) { return X && X.name && X.name.toLowerCase() === Q.toLowerCase() }) }, _getRenderingRuleId: function (K) {
                                                        var Q = K && K.functionName;
                                                        if (Q) { if (this._isRenderingRuleAProcessingTemplate(K)) return Q; var X = this._customRenderingRuleId[Q]; if (X) { if (X !== K) { for (var W in this._customRenderingRuleId) if (this._customRenderingRuleId[W] === K) return W; for (X = 0; this._customRenderingRuleId[fa];)X += 1; var fa; this._customRenderingRuleId[Q + X] = K } } else this._customRenderingRuleId[Q] = K; return Q }
                                                }, _createPixelData: function (K) {
                                                        K = new D({ width: 2, height: 2, pixels: K, pixelType: this.pixelType, statistics: K }); var Q = this.fullExtent.getCenter(); Q = new h(Q.x, Q.y, Q.x + this.pixelSizeX,
                                                                Q.y + this.pixelSizeY, this.spatialReference); return { pixelBlock: K, extent: Q }
                                                }, _convertRendererToRenderingRule: function (K) {
                                                        var Q = K && K.declaredClass; if (!Q || "esri.renderer.UniqueValueRenderer" !== Q && "esri.renderer.ClassBreaksRenderer" !== Q && "esri.renderer.StretchRenderer" !== Q && "esri.renderer.ShadedReliefRenderer" !== Q && "esri.renderer.ColormapRenderer" !== Q) return null; var X = null; "esri.renderer.StretchRenderer" === Q ? X = K.toRenderingRule({ convertToColormap: 10.6 > this.version }) : "esri.renderer.ClassBreaksRenderer" ===
                                                                Q ? X = this._convertClassifyRenderer(K) : "esri.renderer.UniqueValueRenderer" === Q ? X = this._convertUniqueValueRenderer(K) : "esri.renderer.ShadedReliefRenderer" === Q ? X = this._convertShadedReliefRenderer(K) : "esri.renderer.ColormapRenderer" === Q && (X = this._convertColormapRenderer(K)); return X
                                                }, _getValueField: function (K) { if (K && K.length) { var Q, X; w.some(K, function (W) { if ((X = W.name) && "value" === X.toLowerCase()) return Q = X, !0 }); return Q } }, _convertColormapRenderer: function (K) {
                                                        var Q = new z; Q.functionName = "Colormap"; Q.functionArguments =
                                                                {}; K = K.colormapInfos.map(function (X) { return [X.value].concat(X.color) }); Q.functionArguments.Colormap = K; return Q
                                                }, _convertShadedReliefRenderer: function (K) {
                                                        var Q = new z; Q.functionName = "Hillshade"; var X = "traditional" === K.hillshadeType ? 0 : 1, W = "none" === K.scalingType ? 1 : 3, fa = { HillshadeType: X, SlopeType: W, ZFactor: K.zFactor }; 0 === X && (fa.Azimuth = K.azimuth, fa.Altitude = K.altitude); 3 === W && (fa.PSPower = K.pixelSizePower, fa.PSZFactor = K.pixelSizeFactor); Q.functionArguments = fa; Q.variableName = "Raster"; K.colorRamp && (Q.functionName =
                                                                "ShadedRelief", fa.Colormap = t.convertColorRampToColormap(K.colorRamp, 256)); return Q
                                                }, _convertClassifyRenderer: function (K) {
                                                        var Q = [], X = [], W = [], fa = [], ma; var ia = this.renderingRule && this._getRenderingRuleId(this.renderingRule); var va = this.hasRasterAttributeTable; if (ia) { va = this._rasterFunctionTemplateInfos[ia] ? this._rasterFunctionTemplateInfos[ia].hasRasterAttributeTable : this.hasRasterAttributeTable; var xa = this._renderingRuleAttributeTable[ia]; var na = this._rasterFunctionTemplateInfos[ia] } var ra = xa && xa.features ?
                                                                xa.features : this._rasterAttributeTableFeatures; var sa = this._getValueField(xa && xa.fields ? xa.fields : this._rasterAttributeTableFields); va && ra ? (w.forEach(K.infos, function (wa, aa) { var Da, Ca = wa.symbol.color; Ca.a && w.forEach(ra, function (O) { Da = O.attributes[K.attributeField]; (Da >= wa.minValue && Da < wa.maxValue || aa === K.infos.length - 1 && Da >= wa.minValue) && fa.push([O.attributes[sa], Ca.r, Ca.g, Ca.b]) }, this) }, this), ia = na && na.pixelType || this.pixelType, this._adjustColormapToPixelTypeRange(fa, ia), ia = new z, ia.functionName =
                                                                        "Colormap", ia.functionArguments = {}, ia.functionArguments.Colormap = fa, ia.variableName = "Raster") : (w.forEach(K.infos, function (wa, aa) { ma = wa.symbol && wa.symbol.color; ma.a ? (0 === aa ? Q.push.call(Q, wa.minValue, wa.maxValue + 1E-4) : Q.push.call(Q, wa.minValue + 1E-4, wa.maxValue + 1E-4), X.push(aa), fa.push([aa, ma.r, ma.g, ma.b])) : W.push(wa.minValue, wa.maxValue) }), ia = na && na.pixelType || this.pixelType, this._adjustColormapToPixelTypeRange(fa, ia), ia = new z, ia.functionName = "Remap", ia.functionArguments = {
                                                                                InputRanges: Q, OutputValues: X,
                                                                                NoDataRanges: W
                                                                        }, ia.variableName = "Raster", xa = new z, xa.functionName = "Colormap", xa.functionArguments = { Colormap: fa, Raster: ia }, ia = xa); return ia
                                                }, _convertUniqueValueRenderer: function (K) {
                                                        var Q = [], X = this.renderingRule && this._getRenderingRuleId(this.renderingRule); if (X) { var W = this._renderingRuleAttributeTable[X]; var fa = this._rasterFunctionTemplateInfos[X] } var ma = W && W.features ? W.features : this._rasterAttributeTableFeatures; var ia = (X = W && W.fields ? W.fields : this._rasterAttributeTableFields) && X.length ? this._getValueField(X) :
                                                                "Value"; w.forEach(K.infos, function (va) { var xa = va.symbol.color; xa.a && (K.attributeField !== ia && ma ? w.forEach(ma, function (na) { na.attributes[K.attributeField] == va.value && Q.push([na.attributes[ia], xa.r, xa.g, xa.b]) }, this) : Q.push([va.value, xa.r, xa.g, xa.b])) }, this); this._adjustColormapToPixelTypeRange(Q, fa && fa.pixelType || this.pixelType); fa = new z; fa.functionName = "Colormap"; fa.functionArguments = {}; fa.functionArguments.Colormap = Q; fa.variableName = "Raster"; return fa
                                                }, _adjustColormapToPixelTypeRange: function (K, Q) {
                                                        (Q =
                                                                this._pixelTypeRanges[Q]) && K.push([Math.floor(Q[0] - 1), 0, 0, 0], [Math.ceil(Q[1] + 1), 0, 0, 0]); return K
                                                }, _combineRenderingRule: function (K, Q) { if (!K || !Q) return K || Q; var X = function (W) { var fa = W.Raster; return fa = fa && "esri.layers.RasterFunction" === fa.declaredClass ? X(fa.functionArguments) : W }; K = q.clone(K); "none" !== Q.functionName.toLocaleLowerCase() && (X(K.functionArguments).Raster = Q); return K }, _isItemLevelRasterFunction: function (K) {
                                                        var Q = K && K.functionName; if (!Q || !this._hasItemLevelRFT) return !1; var X = !1; w.some(this.rasterFunctionInfos,
                                                                function (W) { if (W && W.name === Q) { if (1 === W.functionType || 2 === W.functionType) X = !0; return !0 } }); return X
                                                }, _getServiceLevelRenderingRule: function (K) { if (!this._hasItemLevelRFT || !K) return K; K = new z(K.toJson()); var Q = K.functionArguments; for (var X; ;)if ((X = Q && Q.Raster) && X.functionArguments && X.functionArguments.Raster) Q = X, Q = Q.functionArguments; else { this._isItemLevelRasterFunction(X) && delete Q.Raster; break } return K }, _getItemLevelRenderingRule: function (K) {
                                                        if (!this._hasItemLevelRFT || !K) return null; if (this._isItemLevelRasterFunction(K)) return K;
                                                        K = new z(K.toJson()); for (K = K.functionArguments; ;)if ((K = K && K.Raster) && K.functionArguments && K.functionArguments.Raster) K = K.functionArguments; else { if (this._isItemLevelRasterFunction(K)) return K; break }
                                                }, _resolve: function (K, Q, X, W, fa) { Q && this[Q].apply(this, K); X && X.apply(null, K); W && a._resDfd(W, K, fa) }, _toggleTime: function () {
                                                        var K = this._map; this.timeInfo && this.useMapTime && K && !this.suspended ? (this._timeConnect || (this._timeConnect = r.connect(K, "onTimeExtentChange", this, this._onTimeExtentChangeHandler)), this._setTime(K.timeExtent)) :
                                                                (r.disconnect(this._timeConnect), this._timeConnect = null, this._setTime(null))
                                                }, setUseMapTime: function (K, Q) { this.useMapTime = K; this._toggleTime(); !Q && this._map && this.refresh(!0) }, _setTime: function (K) { this._params && (this._params.time = K ? K.toJson().join(",") : null) }, onResume: function () {
                                                        if (this._isScientificData() || this.timeInfo) this._originalGetImageUrl = this._originalGetImageUrl || this.getImageUrl.bind(this), this.getImageUrl = d(this._originalGetImageUrl, 200), this._debounceGetImageTimer && clearTimeout(this._debounceGetImageTimer),
                                                                this._debounceGetImageTimer = setTimeout(function () { this.getImageUrl = this._originalGetImageUrl }.bind(this), 5E3); this.inherited(arguments)
                                                }, _onTimeExtentChangeHandler: function (K) { this.suspended || (this._setTime(K), this.refresh(!0)) }, handleSpatialReferenceChange: function () { this.onSpatialReferenceChange() }, getColormap: function (K) {
                                                        var Q = this._url.path + "/colormap", X = new A(a._dfdCanceller), W = { f: "json" }; K && K.renderingRule && (W.renderingRule = m.toJson(K.renderingRule.toJson())); this.hasColormap ? (X._pendingDfd =
                                                                e({ url: Q, content: W, handleAs: "json", callbackParamName: "callback" }), X._pendingDfd.then(function (fa) { X.callback(fa) }, function (fa) { X.errback(fa) })) : (K = Error("Layer does not support colormap"), K.log = !!v.isDebug, X.errback(K)); return X
                                                }, getRenderingRuleColormap: function (K) {
                                                        var Q = new A(a._dfdCanceller); if (!K || !K.renderingRule) return Q.errback(Error("Rendering rule is not specified")), Q; K = K.renderingRule; var X = this._getRenderingRuleId(K); this._renderingRuleColormap && X && this._renderingRuleColormap.hasOwnProperty(X) ?
                                                                Q.resolve(this._renderingRuleColormap[X]) : Q = this.getColormap({ renderingRule: K }).then(q.hitch(this, function (W) { W = W && W.colormap; X && (this._renderingRuleColormap[X] = W); return W })); return Q
                                                }, _handleClipFunctionInRenderingRule: function (K) {
                                                        K = q.clone(K); var Q = K.arguments, X = Q.ClippingGeometry && Q.ClippingGeometry.value, W = Q.Extent && Q.Extent.value; Q.ClippingRaster && Q.ClippingRaster.value || X || W || (Q = this._map.extent.toJson(), K.arguments.Extent.value = Q, K.functionArguments.Extent.value = Q, K._isTemplate && (K._templateJson.arguments.Extent.value =
                                                                Q)); return K
                                                }
                                        }); l("extend-esri") && q.setObject("layers.ImageServiceLayerMixin", E, c); return E
                                })
                }, "esri/layers/MosaicRule": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ../geometry/Point ./RasterFunction".split(" "), function (E, q, A, w, m, v, r) {
                                var l = E(null, {
                                        declaredClass: "esri.layers.MosaicRule", method: null, where: null, sortField: null, sortValue: null, ascending: !1, lockRasterIds: null, viewpoint: null, objectIds: null, operation: null, multidimensionalDefinition: [], itemRenderingRule: null,
                                        constructor: function (k) {
                                                q.isObject(k) && (q.mixin(this, k), k.mosaicMethod && (this.method = k.mosaicMethod), this.method && "esri" !== this.method.toLowerCase().substring(0, 4) && (this.method = this._getMethodEnum(this.method)), k.mosaicOperation && (this.operation = k.mosaicOperation), this.operation && "MT_" !== this.operation.toUpperCase().substring(0, 3) && (this.operation = this._getOperatorEnum(this.operation)), k.fids && (this.objectIds = k.fids), k.viewpoint && (this.viewpoint = new v(k.viewpoint)), k.itemRenderingRule && (this.itemRenderingRule =
                                                        new r(k.itemRenderingRule)), this.multidimensionalDefinition = k.multidimensionalDefinition || [])
                                        }, toJson: function () {
                                                var k = null, n = this.multidimensionalDefinition ? this.multidimensionalDefinition.length : 0; if (n) { k = []; for (var d = 0; d < n; d++)k.push("esri.layers.DimensionalDefinition" === this.multidimensionalDefinition[d].declaredClass ? this.multidimensionalDefinition[d].toJson() : this.multidimensionalDefinition[d]) } k = {
                                                        mosaicMethod: this.method, where: this.where, sortField: this.sortField, sortValue: this.sortValue, ascending: this.ascending,
                                                        lockRasterIds: q.clone(this.lockRasterIds), viewpoint: this.viewpoint ? this.viewpoint.toJson() : null, fids: q.clone(this.objectIds), mosaicOperation: this.operation, multidimensionalDefinition: k, itemRenderingRule: this.itemRenderingRule ? this.itemRenderingRule.toJson() : null
                                                }; return m.filter(k, function (c) { if (null !== c) return !0 })
                                        }, _getMethodEnum: function (k) {
                                                if (k) {
                                                        var n = l.METHOD_NONE; switch (k.toLowerCase()) {
                                                                case "byattribute": n = l.METHOD_ATTRIBUTE; break; case "center": n = l.METHOD_CENTER; break; case "lockraster": n = l.METHOD_LOCKRASTER;
                                                                        break; case "nadir": n = l.METHOD_NADIR; break; case "northwest": n = l.METHOD_NORTHWEST; break; case "seamline": n = l.METHOD_SEAMLINE; break; case "viewpoint": n = l.METHOD_VIEWPOINT
                                                        }return n
                                                }
                                        }, _getOperatorEnum: function (k) { if (k) switch (k.toLowerCase()) { case "first": return l.OPERATION_FIRST; case "last": return l.OPERATION_LAST; case "max": return l.OPERATION_MAX; case "min": return l.OPERATION_MIN; case "blend": return l.OPERATION_BLEND; case "mean": return l.OPERATION_MEAN; case "sum": return l.OPERATION_SUM } }
                                }); q.mixin(l, {
                                        METHOD_NONE: "esriMosaicNone",
                                        METHOD_CENTER: "esriMosaicCenter", METHOD_NADIR: "esriMosaicNadir", METHOD_VIEWPOINT: "esriMosaicViewpoint", METHOD_ATTRIBUTE: "esriMosaicAttribute", METHOD_LOCKRASTER: "esriMosaicLockRaster", METHOD_NORTHWEST: "esriMosaicNorthwest", METHOD_SEAMLINE: "esriMosaicSeamline", OPERATION_FIRST: "MT_FIRST", OPERATION_LAST: "MT_LAST", OPERATION_MIN: "MT_MIN", OPERATION_MAX: "MT_MAX", OPERATION_MEAN: "MT_MEAN", OPERATION_BLEND: "MT_BLEND", OPERATION_SUM: "MT_SUM"
                                }); A("extend-esri") && q.setObject("layers.MosaicRule", l, w); return l
                        })
                },
                "esri/layers/DimensionalDefinition": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/has", "../kernel", "../lang"], function (E, q, A, w, m) {
                                E = E(null, {
                                        declaredClass: "esri.layers.DimensionalDefinition", variableName: null, dimensionName: null, values: [], isSlice: !1, constructor: function (v) { q.isObject(v) && q.mixin(this, v) }, toJson: function () {
                                                var v = { variableName: this.variableName, dimensionName: this.dimensionName, values: q.clone(this.values), isSlice: this.isSlice }; return m.filter(v, function (r) {
                                                        return null !==
                                                                r
                                                })
                                        }
                                }); A("extend-esri") && q.setObject("layers.DimensionalDefinition", E, w); return E
                        })
                }, "esri/layers/Raster": function () {
                        define("require dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/_base/array dojo/_base/config dojo/json dojo/sniff ../kernel ../Evented ../request ../geometry/Extent ../SpatialReference ../deferredUtils ./PixelBlock ./rasterFormats/LercCodec ./rasterFormats/Lerc2Codec".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                var h, p, B, t, u, z; q = q(n, {
                                        declaredClass: "esri.layers.Raster",
                                        imageServiceUrl: null, validPixelTypes: "U1 U2 U4 U8 U16 U32 S8 S16 S32 F32".split(" "), validFormats: "lerc jpeg jpg jpgpng png png8 png24 png32 bip bsq tiff".split(" "), _eventMap: { "raster-read-complete": ["pixelData", "params"] }, constructor: function (I) { this.imageServiceUrl = I; this.registerConnectEvents(); this._loadRasterFormatModules() }, read: function (I, N, T) {
                                                var M = this, R = new w(b._dfdCanceller); if (10 > l("ie")) throw "This browser is not supported."; if (!I.imageServiceParameters) throw "Insufficient parameters to read data";
                                                var ca = A.clone(I.imageServiceParameters), K = I.pixelType; m.some(this.validPixelTypes, function (ia) { return ia === K }) || (ca.pixelType = "F32"); m.some(this.validFormats, function (ia) { return ia.toLowerCase() === ca.format.toLowerCase() }) || (ca.format = "lerc"); var Q = I.decodeFunc, X; this._prepareGetImageParameters(ca); var W = ca.width, fa = ca.height, ma = ca.extent; delete ca.width; delete ca.height; delete ca.extent; R._pendingDfd = d({
                                                        url: this.imageServiceUrl + "/exportImage", handleAs: "arraybuffer", content: A.mixin(ca, { f: "image" }),
                                                        load: function (ia) { M.decode(ia, { width: W, height: fa, planes: null, pixelType: K, noDataValue: ca.noData, format: ca.format, decodeFunc: Q }).then(function (va) { X = { pixelBlock: va, extent: ma }; M._resolve([X, ca], "onRasterReadComplete", N, R) }, function (va) { M._resolve([va], null, T, R, !0) }) }, error: function (ia) { M._resolve([ia], null, T, R, !0) }
                                                }); return R.promise
                                        }, decode: function (I, N) {
                                                if (void 0 === N || null === N) throw "missing decode options"; var T; N.format && (T = N.format.toUpperCase()); "BSQ" !== T && "BIP" !== T && (T = this._getFormat(I)); var M =
                                                        N.decodeFunc; if (void 0 === M || null === M) M = this._getFormatDecoderDfd(T); return M(I, N)
                                        }, onRasterReadComplete: function () { }, _prepareGetImageParameters: function (I) {
                                                if (I.size && I.bbox) { var N = I.size.split(","); I.width = parseFloat(N[0]); I.height = parseFloat(N[1]); I.extent || (N = I.bbox.split(","), I.extent = new c(parseFloat(N[0]), parseFloat(N[1]), parseFloat(N[2]), parseFloat(N[3]), new g(I.bboxSR))) } else {
                                                        if (!I.width || Math.floor(I.width) !== I.width || !I.height || Math.floor(I.height) !== I.height) throw "Incorrect Image Dimensions";
                                                        if (!I.extent || "esri.geometry.Extent" !== I.extent.declaredClass) throw "Incorrect extent"; N = I.extent; var T = N.spatialReference.wkid || r.toJson(N.spatialReference.toJson()); delete I._ts; A.mixin(I, { bbox: N.xmin + "," + N.ymin + "," + N.xmax + "," + N.ymax, imageSR: T, bboxSR: T, size: I.width + "," + I.height }, I.disableClientCaching ? { _ts: (new Date).getTime() } : {})
                                                }
                                        }, _adjustExtent: function (I, N, T) { var M = I.ymax - I.ymin, R = I.xmax - I.xmin; T >= N ? I.ymax = I.ymin + R * N / T : I.xmax = I.xmin + M * T / N; return I }, _resolve: function (I, N, T, M, R) {
                                                N && this[N].apply(this,
                                                        I); T && T.apply(null, I); M && b._resDfd(M, I, R)
                                        }, _getFormatDecoderDfd: function (I) {
                                                var N = null; switch (I) { case "LERC": N = this._decodeLerc; break; case "LERC2": N = this._decodeLerc2; break; case "JPEG": N = this._decodeJpeg; break; case "PNG": N = this._decodePng; break; case "BSQ": N = this._decodeBsq; break; case "BIP": N = this._decodeBip; break; case "TIFF": N = this._decodeTiff; break; default: N = function (T, M) { throw "The raster format is not supported"; } }N = A.hitch(this, N); return function (T, M) {
                                                        var R = new w; try {
                                                                if ("LERC" === I || !0 === u) {
                                                                        var ca =
                                                                                N(T, M); R.resolve(ca)
                                                                } else z.then(function () { ca = N(T, M); R.resolve(ca) })
                                                        } catch (K) { R.reject(K) } return R
                                                }
                                        }, _getFormat: function (I) {
                                                I = new Uint8Array(I, 0, 10); var N = ""; if (255 === I[0] && 216 === I[1]) N = "JPEG"; else if (137 === I[0] && 80 === I[1] && 78 === I[2] && 71 === I[3]) N = "PNG"; else if (67 === I[0] && 110 === I[1] && 116 === I[2] && 90 === I[3] && 73 === I[4] && 109 === I[5] && 97 === I[6] && 103 === I[7] && 101 === I[8] && 32 === I[9]) N = "LERC"; else if (76 === I[0] && 101 === I[1] && 114 === I[2] && 99 === I[3] && 50 === I[4] && 32 === I[5]) N = "LERC2"; else if (-1 < String.fromCharCode.apply(null,
                                                        I).toLowerCase().indexOf("error")) N = "ERROR"; else if (73 === I[0] && 73 === I[1] && 42 === I[2] && 0 === I[3] || 77 === I[0] && 77 === I[1] && 0 === I[2] && 42 === I[3]) N = "TIFF"; return N
                                        }, _validateDecodeParams: function (I) { if (!I.height || Math.floor(I.height) !== I.height) throw "Height not provided."; if (!I.width || Math.floor(I.width) !== I.width) throw "Width not provided."; }, _decodeJpeg: function (I, N) {
                                                if (!h) throw "The jpeg decoder module is not loaded."; this._validateDecodeParams(N); I = (new h).decode(I); if (!H(I, N)) throw "The decoded image dimensions are incorrect.";
                                                N = []; var T; for (T = 0; T < I.pixels.length; T++) { var M = I.pixels[T]; N.push(this._calculateBandStatistics(M)) } return new e({ width: I.width, height: I.height, pixels: I.pixels, pixelType: "U8", mask: I.mask, statistics: N })
                                        }, _decodePng: function (I, N) {
                                                if (!p) throw "The png decoder module is not loaded."; this._validateDecodeParams(N); I = new Uint8Array(I); var T = new p(I); I = new Uint8Array(N.width * N.height * 4); T.copyToImageData(I, T.decodePixels()); var M = T = 0; M = new Uint8Array(N.width * N.height); for (T = 0; T < N.width * N.height; T++)M[T] =
                                                        I[4 * T + 3]; var R = new e({ width: N.width, height: N.height, pixels: [], pixelType: "U8", mask: M, statistics: [] }); for (T = 0; 3 > T; T++) { var ca = new Uint8Array(N.width * N.height); for (M = 0; M < N.width * N.height; M++)ca[M] = I[4 * M + T]; R.addData({ pixels: ca, statistics: this._calculateBandStatistics(ca) }) } return R
                                        }, _decodeBsq: function (I, N) {
                                                if (!B) throw "The bsq decoder module is not loaded."; this._validateDecodeParams(N); y = N.noDataValue; N.pixelType = D(N.pixelType); I = B.decodeBSQ(I, {
                                                        bandCount: N.planes, width: N.width, height: N.height, pixelType: x,
                                                        noDataValue: y
                                                }); var T = [], M, R = null; for (M = 0; M < I.pixels.length; M++)R = I.pixels[M], T.push(this._calculateBandStatistics(R)); return new e({ width: N.width, height: N.height, pixels: I.pixels, pixelType: N.pixelType, mask: I.maskData, statistics: T })
                                        }, _decodeBip: function (I, N) {
                                                this._validateDecodeParams(N); y = N.noDataValue; N.pixelType = D(N.pixelType); I = B.decodeBIP(I, { bandCount: N.planes, width: N.width, height: N.height, pixelType: x, noDataValue: y }); var T = [], M, R = null; for (M = 0; M < I.pixels.length; M++)R = I.pixels[M], T.push(this._calculateBandStatistics(R));
                                                return new e({ width: N.width, height: N.height, pixels: I.pixels, pixelType: N.pixelType, mask: I.maskData, statistics: T })
                                        }, _decodeTiff: function (I, N) { this._validateDecodeParams(N); y = N.noDataValue; N.pixelType = D(N.pixelType); I = t.decode(I); N = []; var T, M = null; for (T = 0; T < I.pixels.length; T++)M = I.pixels[T], N.push(this._calculateBandStatistics(M, I.maskData)); return new e({ width: I.width, height: I.height, pixels: I.pixels, pixelType: I.pixelType, mask: I.maskData, statistics: N }) }, _decodeLerc: function (I, N) {
                                                this._validateDecodeParams(N);
                                                y = N.noDataValue; N.pixelType = D(N.pixelType); for (var T = 0, M, R = 0, ca, K = I.byteLength - 10; R < K;) {
                                                        var Q = a.decode(I, { inputOffset: R, encodedMaskData: M, returnMask: 0 === T ? !0 : !1, returnEncodedMask: 0 === T ? !0 : !1, returnFileInfo: !0, pixelType: x, noDataValue: y }); R = Q.fileInfo.eofOffset; 0 === T && (M = Q.encodedMaskData, ca = new e({ width: N.width, height: N.height, pixels: [], pixelType: N.pixelType, mask: Q.maskData, statistics: [] })); T++; if (!H(Q, N)) throw "The decoded image dimensions are incorrect"; ca.addData({
                                                                pixels: Q.pixelData, statistics: {
                                                                        minValue: Q.minValue,
                                                                        maxValue: Q.maxValue, noDataValue: Q.noDataValue
                                                                }
                                                        })
                                                } return ca
                                        }, _decodeLerc2: function (I, N) {
                                                this._validateDecodeParams(N); y = N.noDataValue; N.pixelType = D(N.pixelType); for (var T = 0, M, R, ca = 0, K, Q = I.byteLength - 10, X = []; ca < Q;) {
                                                        R = f.decode(I, { inputOffset: ca, maskData: M, returnFileInfo: !0 }); ca = R.fileInfo.eofOffset; 0 === T && (M = R.maskData, K = new e({ width: N.width, height: N.height, pixels: [], pixelType: R.fileInfo.pixelType, mask: R.maskData, statistics: [] })); R.fileInfo.mask && 0 < R.fileInfo.mask.numBytes && X.push(R.maskData); T++; if (!H(R,
                                                                N)) throw "The decoded image dimensions are incorrect"; if (1 < R.dimCount && R.pixelData && R.pixelData.length === R.width * R.height * R.dimCount) { R.pixelData = R.pixelData.slice(-R.width * R.height); var W = R.dimStats && R.dimStats.minValues && R.dimStats.minValues[R.dimCount - 1], fa = R.dimStats && R.dimStats.maxValues && R.dimStats.maxValues[R.dimCount - 1]; null != W && null != fa && (R.minValue = W, R.maxValue = fa) } K.addData({ pixels: R.pixelData, statistics: { minValue: R.minValue, maxValue: R.maxValue, noDataValue: R.noDataValue } })
                                                } if (1 < X.length) {
                                                        R =
                                                        K.width * K.height; K.bandMasks = X; M = new Uint8Array(R); M.set(X[0]); for (N = 1; N < X.length; N++)for (I = X[N], T = 0; T < R; T++)M[T] &= I[T]; K.maskData = M
                                                } return K
                                        }, _calculateBandStatistics: function (I, N) { var T = Infinity, M = -Infinity, R = I.length, ca, K = 0; if (N) for (ca = 0; ca < R; ca++)N[ca] && (K = I[ca], T = K < T ? K : T, M = K > M ? K : M); else for (ca = 0; ca < R; ca++)K = I[ca], T = K < T ? K : T, M = K > M ? K : M; return { minValue: T, maxValue: M } }, _loadRasterFormatModules: function () {
                                                u || (z || (z = new w), 10 > l("ie") ? z.isRejected() || z.reject("unsupported browser version") : E(["./rasterFormats/JpgPlus",
                                                        "./rasterFormats/Png", "./rasterFormats/Raw", "./rasterFormats/TiffDecoder", "./rasterFormats/Zlib"], function (I, N, T, M) { h = I; p = N; B = T; t = M; u = !0; z.isResolved() || z.resolve(!0) }))
                                        }
                                }); var x = null, y = null, D = function (I) {
                                        if ("U1" === I || "U2" === I || "U4" === I || "U8" === I) return y = Math.pow(2, 8) - 1, x = Uint8Array, "U8"; "U16" === I ? (y = y || Math.pow(2, 16) - 1, x = Uint16Array) : "U32" === I ? (y = y || Math.pow(2, 32) - 1, x = Uint32Array) : "S8" === I ? (y = y || 0 - Math.pow(2, 7), x = Int8Array) : "S16" === I ? (y = y || 0 - Math.pow(2, 15), x = Int16Array) : "S32" === I ? (y = y || 0 - Math.pow(2,
                                                31), x = Int32Array) : x = Float32Array; return I
                                }, H = function (I, N) { return I.height !== N.height || I.width !== N.width ? !1 : !0 }; l("extend-esri") && A.setObject("layers.Raster", q, k); return q
                        })
                }, "esri/layers/PixelBlock": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/has", "../kernel"], function (E, q, A, w) {
                                E = E([], {
                                        declaredClass: "esri.layers.PixelBlock", planes: null, width: null, height: null, pixelType: null, pixels: [], statistics: [], maskIsAlpha: !1, validPixelCount: null, constructor: function (m) {
                                                if (m) {
                                                        if (!m.width || Math.floor(m.width) !==
                                                                m.width) throw "PixelBlock: incorrect width"; if (!m.height || Math.floor(m.height) !== m.height) throw "PixelBlock: incorrect height"; if (!m.pixels) throw "PixelBlock: pixel data not present"; this.width = m.width; this.height = m.height; this.pixels = m.pixels; this.pixelType = m.pixelType || null; this.statistics = m.statistics; this.mask = m.mask || null; this.maskIsAlpha = m.maskIsAlpha || !1; m = m.validPixelCount; null == m && (m = this.mask ? this._getValidPixelCount(this.mask) : this.width * this.height); this.validPixelCount = m
                                                }
                                        }, getPlaneCount: function () {
                                                return this.pixels.length !==
                                                        this.statistics.length ? console.error("Inconsistent pixel data and statistics") : this.statistics.length
                                        }, addData: function (m) { if (!m.pixels || !m.statistics) throw "Pixel data or statistics are not present"; if (m.pixels.length !== this.width * this.height) throw "Inconsistent pixel data size"; this.statistics.push(m.statistics); this.pixels.push(m.pixels) }, getAsRGBA: function () {
                                                var m = new ArrayBuffer(this.width * this.height * 4); switch (this.pixelType) {
                                                        case "S8": case "S16": case "U16": case "S32": case "U32": case "F32": case "F64": this._fillFromNon8Bit(m);
                                                                break; default: this._fillFrom8Bit(m)
                                                }return new Uint8ClampedArray(m)
                                        }, getAsRGBAFloat: function () { var m = new Float32Array(this.width * this.height * 4); this._fillFrom32Bit(m); return m }, clone: function (m) {
                                                m = m || this; var v = new this.constructor; v.width = m.width; v.height = m.height; v.pixelType = m.pixelType; v.maskIsAlpha = m.maskIsAlpha; m.mask && (v.mask = new Uint8Array(m.mask)); var r, l; if (m.pixels) {
                                                        v.pixels = []; var k = (l = m.pixels.length) && m.pixels[0].slice; for (r = 0; r < l; r++)v.pixels[r] = k ? m.pixels[r].slice(0, m.pixels[r].length) :
                                                                new m.pixels[r].constructor(m.pixels[r])
                                                } if (m.statistics) for (v.statistics = [], l = m.statistics.length, r = 0; r < l; r++)v.statistics[r] = q.clone(m.statistics[r]); m = m.validPixelCount; null == m && (m = v.mask ? this._getValidPixelCount(v.mask) : v.width * v.height); return v
                                        }, clamp: function (m) {
                                                if ("F64" !== m && "F32" !== m) {
                                                        switch (m) {
                                                                case "U8": var v = [0, 255]; break; case "U16": v = [0, 65535]; break; case "U32": v = [0, 4294967295]; break; case "S8": v = [-128, 127]; break; case "S16": v = [-32768, 32767]; break; case "S32": v = [-2147483648, 2147483647]; break;
                                                                default: v = [-3.4 * 1E39, 3.4 * 1E39]
                                                        }var r = v[0]; v = v[1]; var l = this.pixels, k = this.width * this.height, n = l.length, d, c, g = []; for (d = 0; d < n; d++) { var b = this._createEmptyBand(m, k); var e = l[d]; for (c = 0; c < k; c++) { var a = e[c]; b[c] = a > v ? v : a < r ? r : a } g.push(b) } this.pixels = g; this.pixelType = m
                                                }
                                        }, calculateStatistics: function () { var m, v = [], r = this.mask; for (m = 0; m < this.pixels.length; m++) { var l = this.pixels[m]; v.push(this._calculateBandStatistics(l, r)) } this.statistics = v }, _getValidPixelCount: function (m) {
                                                var v, r = 0; for (v = 0; v < m.length; v++)m[v] &&
                                                        r++; return r
                                        }, _createEmptyBand: function (m, v) { switch (m) { case "U8": m = new Uint8Array(v); break; case "U16": m = new Uint16Array(v); break; case "U32": m = new Uint32Array(v); break; case "S8": m = new Int8Array(v); break; case "S16": m = new Int16Array(v); break; case "S32": m = new Int32Array(v); break; case "U32": m = new Uint32Array(v); break; case "F32": m = new Float32Array(v); break; case "F64": m = new Float64Array(v); break; default: m = new Float32Array(v) }return m }, _fillFrom8Bit: function (m) {
                                                var v = this.pixels, r = this.mask; if (!m || !v || !v.length) return console.error("Unable to convert to RGBA. The input pixel block is empty.");
                                                var l, k; var n = l = k = v[0]; 3 <= v.length && (l = v[1], k = v[2]); v = new Uint32Array(m); var d = this.width * this.height; if (n.length !== d) return console.error("Unable to convert to RGBA. The pixelblock is invalid."); if (r && r.length === d) if (this.maskIsAlpha) for (m = 0; m < d; m++)r[m] && (v[m] = r[m] << 24 | k[m] << 16 | l[m] << 8 | n[m]); else for (m = 0; m < d; m++)r[m] && (v[m] = -16777216 | k[m] << 16 | l[m] << 8 | n[m]); else for (m = 0; m < d; m++)v[m] = -16777216 | k[m] << 16 | l[m] << 8 | n[m]
                                        }, _fillFromNon8Bit: function (m) {
                                                var v = this.pixels, r = this.mask, l = this.statistics; if (!m ||
                                                        !v || !v.length) return console.error("Unable to convert to RGBA. The input pixel block is empty."); var k = 1, n = 0; k = 1; l && 0 < l.length ? (n = l.map(function (b) { return b.minValue }).reduce(function (b, e) { return Math.min(b, e) }), k = l.map(function (b) { return b.maxValue - b.minValue }).reduce(function (b, e) { return Math.max(b, e) }), k = 255 / k) : (k = 255, "S8" === this.pixelType ? (n = -128, k = 127) : "U16" === this.pixelType ? k = 65535 : "S16" === this.pixelType ? (n = -32768, k = 32767) : "U32" === this.pixelType ? k = 4294967295 : "S32" === this.pixelType ? (n = -2147483648,
                                                                k = 2147483647) : "F32" === this.pixelType ? (n = -3.4 * 1E39, k = 3.4 * 1E39) : "F64" === this.pixelType && (n = -Number.MAX_VALUE, k = Number.MAX_VALUE), k = 255 / (k - n)); m = new Uint32Array(m); l = this.width * this.height; var d = v[0]; if (d.length !== l) return console.error("Unable to convert to RGBA. The pixelblock is invalid."); if (3 <= v.length) {
                                                                        var c = v[1]; var g = v[2]; if (r && r.length === l) for (v = 0; v < l; v++)r[v] && (m[v] = -16777216 | (g[v] - n) * k << 16 | (c[v] - n) * k << 8 | (d[v] - n) * k); else for (v = 0; v < l; v++)m[v] = -16777216 | (g[v] - n) * k << 16 | (c[v] - n) * k << 8 | (d[v] - n) *
                                                                                k
                                                                } else if (r && r.length === l) for (v = 0; v < l; v++)c = (d[v] - n) * k, r[v] && (m[v] = -16777216 | c << 16 | c << 8 | c); else for (v = 0; v < l; v++)c = (d[v] - n) * k, m[v] = -16777216 | c << 16 | c << 8 | c
                                        }, _fillFrom32Bit: function (m) {
                                                var v = this.pixels, r = this.mask; if (!m || !v || !v.length) return console.error("Unable to convert to RGBA. The input pixel block is empty."); var l, k; var n = l = k = v[0]; 3 <= v.length && (l = v[1], k = v[2]); var d = this.width * this.height; if (n.length !== d) return console.error("Unable to convert to RGBA. The pixelblock is invalid."); var c = 0; if (r &&
                                                        r.length === d) for (v = 0; v < d; v++)m[c++] = n[v], m[c++] = l[v], m[c++] = k[v], m[c++] = r[v] & 1; else for (v = 0; v < d; v++)m[c++] = n[v], m[c++] = l[v], m[c++] = k[v], m[c++] = 1
                                        }, _calculateBandStatistics: function (m, v) { var r = Infinity, l = -Infinity, k = m.length, n, d = 0; if (v) for (n = 0; n < k; n++)v[n] && (d = m[n], r = d < r ? d : r, l = d > l ? d : l); else for (n = 0; n < k; n++)d = m[n], r = d < r ? d : r, l = d > l ? d : l; return { minValue: r, maxValue: l } }
                                }); A("extend-esri") && q.setObject("layers.PixelBlock", E, w); return E
                        })
                }, "esri/layers/rasterFormats/LercCodec": function () {
                        define([], function () {
                                var E =
                                {
                                        defaultNoDataValue: -3.4027999387901484E38, decode: function (A, w) {
                                                w = w || {}; var m = w.inputOffset || 0, v = w.encodedMaskData || null === w.encodedMaskData, r = {}, l = new Uint8Array(A, m, 10); r.fileIdentifierString = String.fromCharCode.apply(null, l); if ("CntZImage" != r.fileIdentifierString.trim()) throw "Unexpected file identifier string: " + r.fileIdentifierString; m += 10; l = new DataView(A, m, 24); r.fileVersion = l.getInt32(0, !0); r.imageType = l.getInt32(4, !0); r.height = l.getUint32(8, !0); r.width = l.getUint32(12, !0); r.maxZError = l.getFloat64(16,
                                                        !0); m += 24; if (!v) if (l = new DataView(A, m, 16), r.mask = {}, r.mask.numBlocksY = l.getUint32(0, !0), r.mask.numBlocksX = l.getUint32(4, !0), r.mask.numBytes = l.getUint32(8, !0), r.mask.maxValue = l.getFloat32(12, !0), m += 16, 0 < r.mask.numBytes) {
                                                                v = new Uint8Array(Math.ceil(r.width * r.height / 8)); l = new DataView(A, m, r.mask.numBytes); var k = l.getInt16(0, !0), n = 2, d = 0; do { if (0 < k) for (; k--;)v[d++] = l.getUint8(n++); else { var c = l.getUint8(n++); for (k = -k; k--;)v[d++] = c } k = l.getInt16(n, !0); n += 2 } while (n < r.mask.numBytes); if (-32768 !== k || d < v.length) throw "Unexpected end of mask RLE encoding";
                                                                r.mask.bitset = v; m += r.mask.numBytes
                                                        } else 0 === (r.mask.numBytes | r.mask.numBlocksY | r.mask.maxValue) && (v = new Uint8Array(Math.ceil(r.width * r.height / 8)), r.mask.bitset = v); l = new DataView(A, m, 16); r.pixels = {}; r.pixels.numBlocksY = l.getUint32(0, !0); r.pixels.numBlocksX = l.getUint32(4, !0); r.pixels.numBytes = l.getUint32(8, !0); r.pixels.maxValue = l.getFloat32(12, !0); m += 16; v = r.pixels.numBlocksX; l = r.pixels.numBlocksY; v += 0 < r.width % v ? 1 : 0; k = l + (0 < r.height % l ? 1 : 0); r.pixels.blocks = Array(v * k); for (d = n = 0; d < k; d++)for (c = 0; c < v; c++) {
                                                                var g =
                                                                        0; l = new DataView(A, m, Math.min(10, A.byteLength - m)); var b = {}; r.pixels.blocks[n++] = b; var e = l.getUint8(0); g++; b.encoding = e & 63; if (3 < b.encoding) throw "Invalid block encoding (" + b.encoding + ")"; if (2 === b.encoding) m++; else {
                                                                                if (0 !== e && 2 !== e) {
                                                                                        e >>= 6; b.offsetType = e; if (2 === e) b.offset = l.getInt8(1), g++; else if (1 === e) b.offset = l.getInt16(1, !0), g += 2; else if (0 === e) b.offset = l.getFloat32(1, !0), g += 4; else throw "Invalid block offset type"; if (1 === b.encoding) if (e = l.getUint8(g), g++, b.bitsPerPixel = e & 63, e >>= 6, b.numValidPixelsType =
                                                                                                e, 2 === e) b.numValidPixels = l.getUint8(g), g++; else if (1 === e) b.numValidPixels = l.getUint16(g, !0), g += 2; else if (0 === e) b.numValidPixels = l.getUint32(g, !0), g += 4; else throw "Invalid valid pixel count type";
                                                                                } m += g; if (3 != b.encoding) if (0 === b.encoding) { e = (r.pixels.numBytes - 1) / 4; if (e !== Math.floor(e)) throw "uncompressed block has invalid length"; l = new ArrayBuffer(4 * e); g = new Uint8Array(l); g.set(new Uint8Array(A, m, 4 * e)); l = new Float32Array(l); b.rawData = l; m += 4 * e } else 1 === b.encoding && (e = Math.ceil(b.numValidPixels * b.bitsPerPixel /
                                                                                        8), l = new ArrayBuffer(4 * Math.ceil(e / 4)), g = new Uint8Array(l), g.set(new Uint8Array(A, m, e)), b.stuffedData = new Uint32Array(l), m += e)
                                                                        }
                                                        } r.eofOffset = m; A = null != w.noDataValue ? w.noDataValue : E.defaultNoDataValue; v = w.encodedMaskData; e = w.returnMask; k = 0; n = r.pixels.numBlocksX; d = r.pixels.numBlocksY; c = Math.floor(r.width / n); b = Math.floor(r.height / d); g = 2 * r.maxZError; m = Number.MAX_VALUE; v = v || (r.mask ? r.mask.bitset : null); var a; l = new (w.pixelType || Float32Array)(r.width * r.height); e && v && (a = new Uint8Array(r.width * r.height)); e =
                                                                new Float32Array(c * b); for (var f, h, p = 0; p <= d; p++) {
                                                                        var B = p !== d ? b : r.height % d; if (0 !== B) for (var t = 0; t <= n; t++) {
                                                                                var u = t !== n ? c : r.width % n; if (0 !== u) {
                                                                                        var z = p * r.width * b + t * c, x = r.width - u, y = r.pixels.blocks[k], D; if (2 > y.encoding) {
                                                                                                if (0 === y.encoding) var H = y.rawData; else {
                                                                                                        var I = D = H = void 0; f = y.stuffedData; h = y.bitsPerPixel; var N = y.numValidPixels, T = y.offset, M = g, R = e, ca = r.pixels.maxValue, K = (1 << h) - 1, Q = 0, X = 0, W = Math.ceil((ca - T) / M); f[f.length - 1] <<= 8 * (4 * f.length - Math.ceil(h * N / 8)); for (I = 0; I < N; I++)0 === X && (H = f[Q++], X = 32), X >= h ? (D = H >>>
                                                                                                                X - h & K, X -= h) : (X = h - X, D = (H & K) << X & K, H = f[Q++], X = 32 - X, D += H >>> X), R[I] = D < W ? T + D * M : ca; H = e
                                                                                                } D = 0
                                                                                        } else var fa = 2 === y.encoding ? 0 : y.offset; if (v) for (h = 0; h < B; h++) { if (z & 7) { var ma = v[z >> 3]; ma <<= z & 7 } for (f = 0; f < u; f++)z & 7 || (ma = v[z >> 3]), ma & 128 ? (a && (a[z] = 1), I = 2 > y.encoding ? H[D++] : fa, m = m > I ? I : m, l[z++] = I) : (a && (a[z] = 0), l[z++] = A), ma <<= 1; z += x } else if (2 > y.encoding) for (h = 0; h < B; h++) { for (f = 0; f < u; f++)I = H[D++], m = m > I ? I : m, l[z++] = I; z += x } else for (m = m > fa ? fa : m, h = 0; h < B; h++) { for (f = 0; f < u; f++)l[z++] = fa; z += x } if (1 === y.encoding && D !== y.numValidPixels) throw "Block and Mask do not match";
                                                                                        k++
                                                                                }
                                                                        }
                                                                } fa = a; a = { width: r.width, height: r.height, pixelData: l, minValue: m, maxValue: r.pixels.maxValue, noDataValue: A }; fa && (a.maskData = fa); w.returnEncodedMask && r.mask && (a.encodedMaskData = r.mask.bitset ? r.mask.bitset : null); if (w.returnFileInfo && (a.fileInfo = q(r), w.computeUsedBitDepths)) { w = a.fileInfo; fa = r.pixels.numBlocksX * r.pixels.numBlocksY; ma = {}; for (H = 0; H < fa; H++)D = r.pixels.blocks[H], 0 === D.encoding ? ma.float32 = !0 : 1 === D.encoding ? ma[D.bitsPerPixel] = !0 : ma[0] = !0; r = Object.keys(ma); w.bitDepths = r } return a
                                        }
                                }, q = function (A) {
                                        return {
                                                fileIdentifierString: A.fileIdentifierString,
                                                fileVersion: A.fileVersion, imageType: A.imageType, height: A.height, width: A.width, maxZError: A.maxZError, eofOffset: A.eofOffset, mask: A.mask ? { numBlocksX: A.mask.numBlocksX, numBlocksY: A.mask.numBlocksY, numBytes: A.mask.numBytes, maxValue: A.mask.maxValue } : null, pixels: { numBlocksX: A.pixels.numBlocksX, numBlocksY: A.pixels.numBlocksY, numBytes: A.pixels.numBytes, maxValue: A.pixels.maxValue, noDataValue: this.noDataValue }
                                        }
                                }; return E
                        })
                }, "esri/layers/rasterFormats/Lerc2Codec": function () {
                        define([], function () {
                                var E = {
                                        unstuff: function (w,
                                                m, v, r, l, k, n, d) { var c = (1 << v) - 1, g = 0, b, e = 0; w[w.length - 1] <<= 8 * (4 * w.length - Math.ceil(v * r / 8)); if (l) for (b = 0; b < r; b++) { if (0 === e) { var a = w[g++]; e = 32 } if (e >= v) { var f = a >>> e - v & c; e -= v } else e = v - e, f = (a & c) << e & c, a = w[g++], e = 32 - e, f += a >>> e; m[b] = l[f] } else for (l = Math.ceil((d - k) / n), b = 0; b < r; b++)0 === e && (a = w[g++], e = 32), e >= v ? (f = a >>> e - v & c, e -= v) : (e = v - e, f = (a & c) << e & c, a = w[g++], e = 32 - e, f += a >>> e), m[b] = f < l ? k + f * n : d }, unstuffLUT: function (w, m, v, r, l, k) {
                                                        var n = (1 << m) - 1, d = 0, c = 0, g = 0, b = g = 0, e = []; w[w.length - 1] <<= 8 * (4 * w.length - Math.ceil(m * v / 8)); var a =
                                                                Math.ceil((k - r) / l); for (c = 0; c < v; c++) { if (0 === g) { var f = w[d++]; g = 32 } g >= m ? (b = f >>> g - m & n, g -= m) : (g = m - g, b = (f & n) << g & n, f = w[d++], g = 32 - g, b += f >>> g); e[c] = b < a ? r + b * l : k } e.unshift(r); return e
                                                }, unstuff2: function (w, m, v, r, l, k, n, d) {
                                                        var c = (1 << v) - 1, g = 0, b, e = 0, a = 0; if (l) for (b = 0; b < r; b++) { if (0 === e) { var f = w[g++]; e = 32; a = 0 } if (e >= v) { var h = f >>> a & c; e -= v; a += v } else { var p = v - e; h = f >>> a & c; f = w[g++]; e = 32 - p; h |= (f & (1 << p) - 1) << v - p; a = p } m[b] = l[h] } else for (l = Math.ceil((d - k) / n), b = 0; b < r; b++)0 === e && (f = w[g++], e = 32, a = 0), e >= v ? (h = f >>> a & c, e -= v, a += v) : (p = v -
                                                                e, h = f >>> a & c, f = w[g++], e = 32 - p, h |= (f & (1 << p) - 1) << v - p, a = p), m[b] = h < l ? k + h * n : d; return m
                                                }, unstuffLUT2: function (w, m, v, r, l, k) { var n = (1 << m) - 1, d = 0, c = 0, g = 0, b = 0, e = 0, a = 0, f = [], h = Math.ceil((k - r) / l); for (c = 0; c < v; c++) { if (0 === b) { var p = w[d++]; b = 32; a = 0 } b >= m ? (e = p >>> a & n, b -= m, a += m) : (g = m - b, e = p >>> a & n, p = w[d++], b = 32 - g, e |= (p & (1 << g) - 1) << m - g, a = g); f[c] = e < h ? r + e * l : k } f.unshift(r); return f }, originalUnstuff: function (w, m, v, r) {
                                                        var l = (1 << v) - 1, k = 0, n, d = 0; w[w.length - 1] <<= 8 * (4 * w.length - Math.ceil(v * r / 8)); for (n = 0; n < r; n++) {
                                                                if (0 === d) {
                                                                        var c = w[k++];
                                                                        d = 32
                                                                } if (d >= v) { var g = c >>> d - v & l; d -= v } else d = v - d, g = (c & l) << d & l, c = w[k++], d = 32 - d, g += c >>> d; m[n] = g
                                                        } return m
                                                }, originalUnstuff2: function (w, m, v, r) { var l = (1 << v) - 1, k = 0, n, d = 0, c = 0; for (n = 0; n < r; n++) { if (0 === d) { var g = w[k++]; d = 32; c = 0 } if (d >= v) { var b = g >>> c & l; d -= v; c += v } else { var e = v - d; b = g >>> c & l; g = w[k++]; d = 32 - e; b |= (g & (1 << e) - 1) << v - e; c = e } m[n] = b } return m }
                                }, q = {
                                        HUFFMAN_LUT_BITS_MAX: 12, computeChecksumFletcher32: function (w) {
                                                for (var m = 65535, v = 65535, r = w.length, l = Math.floor(r / 2), k = 0; l;) {
                                                        var n = 359 <= l ? 359 : l; l -= n; do m += w[k++] << 8, v += m +=
                                                                w[k++]; while (--n); m = (m & 65535) + (m >>> 16); v = (v & 65535) + (v >>> 16)
                                                } r & 1 && (v += m += w[k] << 8); return ((v & 65535) + (v >>> 16) << 16 | (m & 65535) + (m >>> 16)) >>> 0
                                        }, readHeaderInfo: function (w, m) {
                                                var v = m.ptr, r = new Uint8Array(w, v, 6), l = {}; l.fileIdentifierString = String.fromCharCode.apply(null, r); if (0 !== l.fileIdentifierString.lastIndexOf("Lerc2", 0)) throw "Unexpected file identifier string (expect Lerc2 ): " + l.fileIdentifierString; v += 6; r = new DataView(w, v, 8); var k = r.getInt32(0, !0); l.fileVersion = k; v += 4; 3 <= k && (l.checksum = r.getUint32(4,
                                                        !0), v += 4); r = new DataView(w, v, 12); l.height = r.getUint32(0, !0); l.width = r.getUint32(4, !0); v += 8; 4 <= k ? (l.numDims = r.getUint32(8, !0), v += 4) : l.numDims = 1; r = new DataView(w, v, 40); l.numValidPixel = r.getUint32(0, !0); l.microBlockSize = r.getInt32(4, !0); l.blobSize = r.getInt32(8, !0); l.imageType = r.getInt32(12, !0); l.maxZError = r.getFloat64(16, !0); l.zMin = r.getFloat64(24, !0); l.zMax = r.getFloat64(32, !0); v += 40; m.headerInfo = l; m.ptr = v; if (3 <= k && (w = this.computeChecksumFletcher32(new Uint8Array(w, v - (4 <= k ? 52 : 48), l.blobSize - 14)), w !==
                                                                l.checksum)) throw "Checksum failed."; return !0
                                        }, checkMinMaxRanges: function (w, m) { var v = m.headerInfo, r = this.getDataTypeArray(v.imageType), l = v.numDims * this.getDataTypeSize(v.imageType), k = this.readSubArray(w, m.ptr, r, l); w = this.readSubArray(w, m.ptr + l, r, l); m.ptr += 2 * l; l = !0; for (m = 0; m < v.numDims; m++)if (k[m] !== w[m]) { l = !1; break } v.minValues = k; v.maxValues = w; return l }, readSubArray: function (w, m, v, r) {
                                                if (v === Uint8Array) w = new Uint8Array(w, m, r); else {
                                                        var l = new ArrayBuffer(r); (new Uint8Array(l)).set(new Uint8Array(w, m, r));
                                                        w = new v(l)
                                                } return w
                                        }, readMask: function (w, m) {
                                                var v = m.ptr, r = m.headerInfo, l = r.width * r.height, k = r.numValidPixel, n = new DataView(w, v, 4); r = {}; r.numBytes = n.getUint32(0, !0); v += 4; if ((0 === k || l === k) && 0 !== r.numBytes) throw "invalid mask"; if (0 === k) k = new Uint8Array(Math.ceil(l / 8)), r.bitset = k, n = new Uint8Array(l), m.pixels.resultMask = n, v += r.numBytes; else if (0 < r.numBytes) {
                                                        k = new Uint8Array(Math.ceil(l / 8)); n = new DataView(w, v, r.numBytes); w = n.getInt16(0, !0); var d = 2, c = 0, g = 0; do {
                                                                if (0 < w) for (; w--;)k[c++] = n.getUint8(d++); else for (g =
                                                                        n.getUint8(d++), w = -w; w--;)k[c++] = g; w = n.getInt16(d, !0); d += 2
                                                        } while (d < r.numBytes); if (-32768 !== w || c < k.length) throw "Unexpected end of mask RLE encoding"; n = new Uint8Array(l); for (d = d = w = 0; d < l; d++)d & 7 ? (w = k[d >> 3], w <<= d & 7) : w = k[d >> 3], w & 128 && (n[d] = 1); m.pixels.resultMask = n; r.bitset = k; v += r.numBytes
                                                } m.ptr = v; m.mask = r; return !0
                                        }, readDataOneSweep: function (w, m, v, r) {
                                                var l = m.ptr, k = m.headerInfo, n = k.numDims, d = k.width * k.height; k = k.numValidPixel * q.getDataTypeSize(k.imageType) * n; var c = m.pixels.resultMask; if (v === Uint8Array) w =
                                                        new Uint8Array(w, l, k); else { var g = new ArrayBuffer(k); (new Uint8Array(g)).set(new Uint8Array(w, l, k)); w = new v(g) } if (w.length === d * n) m.pixels.resultPixels = r ? q.swapDimensionOrder(w, d, n, v, !0) : w; else { m.pixels.resultPixels = new v(d * n); var b = g = v = 0, e = 0; if (1 < n) if (r) for (g = 0; g < d; g++) { if (c[g]) for (e = g, b = 0; b < n; b++, e += d)m.pixels.resultPixels[e] = w[v++] } else for (g = 0; g < d; g++) { if (c[g]) for (e = g * n, b = 0; b < n; b++)m.pixels.resultPixels[e + b] = w[v++] } else for (g = 0; g < d; g++)c[g] && (m.pixels.resultPixels[g] = w[v++]) } m.ptr = l + k; return !0
                                        },
                                        readHuffmanTree: function (w, m) {
                                                var v = this.HUFFMAN_LUT_BITS_MAX, r = new DataView(w, m.ptr, 16); m.ptr += 16; if (2 > r.getInt32(0, !0)) throw "unsupported Huffman version"; var l = r.getInt32(4, !0), k = r.getInt32(8, !0); r = r.getInt32(12, !0); if (k >= r) return !1; var n = new Uint32Array(r - k); q.decodeBits(w, m, n); var d = [], c; for (c = k; c < r; c++) { var g = c - (c < l ? 0 : l); d[g] = { first: n[c - k], second: null } } c = w.byteLength - m.ptr; n = new ArrayBuffer(4 * Math.ceil(c / 4)); (new Uint8Array(n)).set(new Uint8Array(w, m.ptr, c)); w = new Uint32Array(n); m = 0; n = 0; var b =
                                                        w[0]; for (c = k; c < r; c++) { g = c - (c < l ? 0 : l); var e = d[g].first; 0 < e && (d[g].second = b << m >>> 32 - e, 32 - m >= e ? (m += e, 32 === m && (m = 0, n++, b = w[n])) : (m += e - 32, n++, b = w[n], d[g].second |= b >>> 32 - m)) } var a = b = 0, f = new A; for (c = 0; c < d.length; c++)void 0 !== d[c] && (b = Math.max(b, d[c].first)); a = b >= v ? v : b; v = []; var h; for (c = k; c < r; c++)if (g = c - (c < l ? 0 : l), e = d[g].first, 0 < e) if (k = [e, g], e <= a) { g = d[g].second << a - e; var p = 1 << a - e; for (e = 0; e < p; e++)v[g | e] = k } else for (g = d[g].second, p = f, --e; 0 <= e; e--)(h = g >>> e & 1) ? (p.right || (p.right = new A), p = p.right) : (p.left || (p.left =
                                                                new A), p = p.left), 0 !== e || p.val || (p.val = k[1]); return { decodeLut: v, numBitsLUTQick: a, numBitsLUT: b, tree: f, stuffedData: w, srcPtr: n, bitPos: m }
                                        }, readHuffman: function (w, m, v, r) {
                                                var l = m.headerInfo.numDims, k = m.headerInfo.height, n = m.headerInfo.width, d = n * k, c = this.readHuffmanTree(w, m); w = c.decodeLut; var g = c.tree, b = c.stuffedData, e = c.srcPtr, a = c.bitPos, f = c.numBitsLUTQick; c = c.numBitsLUT; var h = 0 === m.headerInfo.imageType ? 128 : 0, p = m.pixels.resultMask, B, t, u, z, x, y, D = 0; 0 < a && (e++, a = 0); var H = b[e], I = 1 === m.encodeMode, N = new v(d * l),
                                                        T = N, M; if (2 > l || I) for (M = 0; M < l; M++)if (1 < l && (T = new v(N.buffer, d * M, d), D = 0), m.headerInfo.numValidPixel === n * k) for (u = x = 0; u < k; u++)for (z = 0; z < n; z++, x++) { var R = 0; var ca = B = H << a >>> 32 - f; 32 - a < f && (ca = B |= b[e + 1] >>> 64 - a - f); if (w[ca]) R = w[ca][1], a += w[ca][0]; else for (ca = B = H << a >>> 32 - c, 32 - a < c && (ca = B |= b[e + 1] >>> 64 - a - c), ca = g, y = 0; y < c; y++)if (ca = (t = B >>> c - y - 1 & 1) ? ca.right : ca.left, !ca.left && !ca.right) { R = ca.val; a = a + y + 1; break } 32 <= a && (a -= 32, e++, H = b[e]); R -= h; I ? (R = 0 < z ? R + D : 0 < u ? R + T[x - n] : R + D, R &= 255, D = T[x] = R) : T[x] = R } else for (u = x = 0; u < k; u++)for (z =
                                                                0; z < n; z++, x++) { if (p[x]) { R = 0; ca = B = H << a >>> 32 - f; 32 - a < f && (ca = B |= b[e + 1] >>> 64 - a - f); if (w[ca]) R = w[ca][1], a += w[ca][0]; else for (ca = B = H << a >>> 32 - c, 32 - a < c && (ca = B |= b[e + 1] >>> 64 - a - c), ca = g, y = 0; y < c; y++)if (ca = (t = B >>> c - y - 1 & 1) ? ca.right : ca.left, !ca.left && !ca.right) { R = ca.val; a = a + y + 1; break } 32 <= a && (a -= 32, e++, H = b[e]); R -= h; I ? (R = 0 < z && p[x - 1] ? R + D : 0 < u && p[x - n] ? R + T[x - n] : R + D, R &= 255, D = T[x] = R) : T[x] = R } } else for (u = x = 0; u < k; u++)for (z = 0; z < n; z++)if (x = u * n + z, !p || p[x]) for (M = 0; M < l; M++, x += d) {
                                                                        R = 0; ca = B = H << a >>> 32 - f; 32 - a < f && (ca = B |= b[e + 1] >>> 64 - a - f);
                                                                        if (w[ca]) R = w[ca][1], a += w[ca][0]; else for (ca = B = H << a >>> 32 - c, 32 - a < c && (ca = B |= b[e + 1] >>> 64 - a - c), ca = g, y = 0; y < c; y++)if (ca = (t = B >>> c - y - 1 & 1) ? ca.right : ca.left, !ca.left && !ca.right) { R = ca.val; a = a + y + 1; break } 32 <= a && (a -= 32, e++, H = b[e]); R -= h; T[x] = R
                                                                } m.ptr = m.ptr + 4 * (e + 1) + (0 < a ? 4 : 0); m.pixels.resultPixels = N; 1 < l && !r && (m.pixels.resultPixels = q.swapDimensionOrder(N, d, l, v))
                                        }, decodeBits: function (w, m, v, r, l) {
                                                var k = m.headerInfo, n = k.fileVersion, d = 0, c = new DataView(w, m.ptr, 5 <= w.byteLength - m.ptr ? 5 : w.byteLength - m.ptr), g = c.getUint8(0); d++;
                                                var b = g >> 6, e = 0 === b ? 4 : 3 - b, a = 0 < (g & 32) ? !0 : !1; b = g & 31; g = 0; if (1 === e) g = c.getUint8(d), d++; else if (2 === e) g = c.getUint16(d, !0), d += 2; else if (4 === e) g = c.getUint32(d, !0), d += 4; else throw "Invalid valid pixel count type"; e = 2 * k.maxZError; l = 1 < k.numDims ? k.maxValues[l] : k.zMax; if (a) {
                                                        m.counter.lut++; a = c.getUint8(d); d++; k = Math.ceil((a - 1) * b / 8); var f = Math.ceil(k / 4); f = new ArrayBuffer(4 * f); var h = new Uint8Array(f); m.ptr += d; h.set(new Uint8Array(w, m.ptr, k)); d = new Uint32Array(f); m.ptr += k; for (c = 0; a - 1 >>> c;)c++; k = Math.ceil(g * c / 8); f =
                                                                Math.ceil(k / 4); f = new ArrayBuffer(4 * f); h = new Uint8Array(f); h.set(new Uint8Array(w, m.ptr, k)); w = new Uint32Array(f); m.ptr += k; m = 3 <= n ? E.unstuffLUT2(d, b, a - 1, r, e, l) : E.unstuffLUT(d, b, a - 1, r, e, l); 3 <= n ? E.unstuff2(w, v, c, g, m) : E.unstuff(w, v, c, g, m)
                                                } else m.counter.bitstuffer++, c = b, m.ptr += d, 0 < c && (k = Math.ceil(g * c / 8), f = Math.ceil(k / 4), f = new ArrayBuffer(4 * f), h = new Uint8Array(f), h.set(new Uint8Array(w, m.ptr, k)), w = new Uint32Array(f), m.ptr += k, 3 <= n ? null == r ? E.originalUnstuff2(w, v, c, g) : E.unstuff2(w, v, c, g, !1, r, e, l) : null == r ? E.originalUnstuff(w,
                                                        v, c, g) : E.unstuff(w, v, c, g, !1, r, e, l))
                                        }, readTiles: function (w, m, v, r) {
                                                var l = m.headerInfo, k = l.width, n = l.height, d = k * n, c = l.microBlockSize, g = l.imageType, b = q.getDataTypeSize(g), e = Math.ceil(k / c), a = Math.ceil(n / c); m.pixels.numBlocksY = a; m.pixels.numBlocksX = e; var f = m.pixels.ptr = 0, h = 0, p = 0, B = 0, t = 0, u = 0, z = 0, x = 0, y = f = 0, D = 0, H = 0, I = z = 0; z = z = 0; var N = new v(c * c); n = n % c || c; var T = k % c || c, M = l.numDims, R, ca = m.pixels.resultMask, K = m.pixels.resultPixels, Q = 5 <= l.fileVersion ? 14 : 15, X = l.zMax; for (p = 0; p < a; p++)for (t = p !== a - 1 ? c : n, B = 0; B < e; B++)for (u =
                                                        B !== e - 1 ? c : T, D = p * k * c + B * c, H = k - u, R = 0; R < M; R++) {
                                                                1 < M ? (I = K, D = p * k * c + B * c, K = new v(m.pixels.resultPixels.buffer, d * R * b, d), X = l.maxValues[R]) : I = null; z = w.byteLength - m.ptr; h = new DataView(w, m.ptr, Math.min(10, z)); var W = {}; z = 0; x = h.getUint8(0); z++; var fa = 5 <= l.fileVersion ? x & 4 : 0; f = x >> 6 & 255; y = x >> 2 & Q; if (y !== (B * c >> 3 & Q)) throw "integrity issue"; if (fa && 0 === R) throw "integrity issue"; x &= 3; if (3 < x) throw m.ptr += z, "Invalid block encoding (" + x + ")"; if (2 === x) {
                                                                        if (fa) if (ca) for (f = 0; f < t; f++)for (h = 0; h < u; h++)ca[D] && (K[D] = I[D]), D++; else for (f =
                                                                                0; f < t; f++)for (h = 0; h < u; h++)K[D] = I[D], D++; m.counter.constant++; m.ptr += z
                                                                } else if (0 === x) { if (fa) throw "integrity issue"; m.counter.uncompressed++; m.ptr += z; z = t * u * b; I = w.byteLength - m.ptr; z = z < I ? z : I; I = new ArrayBuffer(0 === z % b ? z : z + b - z % b); fa = new Uint8Array(I); fa.set(new Uint8Array(w, m.ptr, z)); I = new v(I); z = 0; if (ca) for (f = 0; f < t; f++) { for (h = 0; h < u; h++)ca[D] && (K[D] = I[z++]), D++; D += H } else for (f = 0; f < t; f++) { for (h = 0; h < u; h++)K[D++] = I[z++]; D += H } m.ptr += z * b } else if (f = q.getDataTypeUsed(fa && 6 > g ? 4 : g, f), W = q.getOnePixel(W, z, f, h), z +=
                                                                        q.getDataTypeSize(f), 3 === x) if (m.ptr += z, m.counter.constantoffset++, ca) for (f = 0; f < t; f++) { for (h = 0; h < u; h++)ca[D] && (K[D] = fa ? Math.min(X, I[D] + W) : W), D++; D += H } else for (f = 0; f < t; f++) { for (h = 0; h < u; h++)K[D] = fa ? Math.min(X, I[D] + W) : W, D++; D += H } else if (m.ptr += z, q.decodeBits(w, m, N, W, R), z = 0, fa) if (ca) for (f = 0; f < t; f++) { for (h = 0; h < u; h++)ca[D] && (K[D] = N[z++] + I[D]), D++; D += H } else for (f = 0; f < t; f++) { for (h = 0; h < u; h++)K[D] = N[z++] + I[D], D++; D += H } else if (ca) for (f = 0; f < t; f++) { for (h = 0; h < u; h++)ca[D] && (K[D] = N[z++]), D++; D += H } else for (f = 0; f < t; f++) {
                                                                                for (h =
                                                                                        0; h < u; h++)K[D++] = N[z++]; D += H
                                                                        }
                                                } 1 < M && !r && (m.pixels.resultPixels = q.swapDimensionOrder(m.pixels.resultPixels, d, M, v))
                                        }, formatFileInfo: function (w) {
                                                return {
                                                        fileIdentifierString: w.headerInfo.fileIdentifierString, fileVersion: w.headerInfo.fileVersion, imageType: w.headerInfo.imageType, height: w.headerInfo.height, width: w.headerInfo.width, numValidPixel: w.headerInfo.numValidPixel, microBlockSize: w.headerInfo.microBlockSize, blobSize: w.headerInfo.blobSize, maxZError: w.headerInfo.maxZError, pixelType: q.getPixelType(w.headerInfo.imageType),
                                                        eofOffset: w.eofOffset, mask: w.mask ? { numBytes: w.mask.numBytes } : null, pixels: { numBlocksX: w.pixels.numBlocksX, numBlocksY: w.pixels.numBlocksY, maxValue: w.headerInfo.zMax, minValue: w.headerInfo.zMin, noDataValue: w.noDataValue }
                                                }
                                        }, constructConstantSurface: function (w, m) {
                                                var v = w.headerInfo.zMax, r = w.headerInfo.zMin, l = w.headerInfo.maxValues, k = w.headerInfo.numDims, n = w.headerInfo.height * w.headerInfo.width, d = 0, c = 0, g = 0, b = w.pixels.resultMask; w = w.pixels.resultPixels; if (b) if (1 < k) if (m) for (d = 0; d < k; d++)for (g = d * n, v = l[d], c =
                                                        0; c < n; c++)b[c] && (w[g + c] = v); else for (c = 0; c < n; c++) { if (b[c]) for (g = c * k, d = 0; d < k; d++)w[g + k] = l[d] } else for (c = 0; c < n; c++)b[c] && (w[c] = v); else if (1 < k && r !== v) if (m) for (d = 0; d < k; d++)for (g = d * n, v = l[d], c = 0; c < n; c++)w[g + c] = v; else for (c = 0; c < n; c++)for (g = c * k, d = 0; d < k; d++)w[g + d] = l[d]; else for (c = 0; c < n * k; c++)w[c] = v
                                        }, getDataTypeArray: function (w) {
                                                switch (w) {
                                                        case 0: w = Int8Array; break; case 1: w = Uint8Array; break; case 2: w = Int16Array; break; case 3: w = Uint16Array; break; case 4: w = Int32Array; break; case 5: w = Uint32Array; break; case 6: w = Float32Array;
                                                                break; case 7: w = Float64Array; break; default: w = Float32Array
                                                }return w
                                        }, getPixelType: function (w) { switch (w) { case 0: w = "S8"; break; case 1: w = "U8"; break; case 2: w = "S16"; break; case 3: w = "U16"; break; case 4: w = "S32"; break; case 5: w = "U32"; break; case 6: w = "F32"; break; case 7: w = "F64"; break; default: w = "F32" }return w }, isValidPixelValue: function (w, m) {
                                                if (null == m) return !1; switch (w) {
                                                        case 0: w = -128 <= m && 127 >= m; break; case 1: w = 0 <= m && 255 >= m; break; case 2: w = -32768 <= m && 32767 >= m; break; case 3: w = 0 <= m && 65536 >= m; break; case 4: w = -2147483648 <=
                                                                m && 2147483647 >= m; break; case 5: w = 0 <= m && 4294967296 >= m; break; case 6: w = -3.4027999387901484E38 <= m && 3.4027999387901484E38 >= m; break; case 7: w = 4.9E-324 <= m && 1.7976931348623157E308 >= m; break; default: w = !1
                                                }return w
                                        }, getDataTypeSize: function (w) { var m = 0; switch (w) { case 0: case 1: m = 1; break; case 2: case 3: m = 2; break; case 4: case 5: case 6: m = 4; break; case 7: m = 8; break; default: m = w }return m }, getDataTypeUsed: function (w, m) {
                                                var v = w; switch (w) {
                                                        case 2: case 4: v = w - m; break; case 3: case 5: v = w - 2 * m; break; case 6: v = 0 === m ? w : 1 === m ? 2 : 1; break;
                                                        case 7: v = 0 === m ? w : w - 2 * m + 1; break; default: v = w
                                                }return v
                                        }, getOnePixel: function (w, m, v, r) { w = 0; switch (v) { case 0: w = r.getInt8(m); break; case 1: w = r.getUint8(m); break; case 2: w = r.getInt16(m, !0); break; case 3: w = r.getUint16(m, !0); break; case 4: w = r.getInt32(m, !0); break; case 5: w = r.getUInt32(m, !0); break; case 6: w = r.getFloat32(m, !0); break; case 7: w = r.getFloat64(m, !0); break; default: throw "the decoder does not understand this pixel type"; }return w }, swapDimensionOrder: function (w, m, v, r, l) {
                                                var k = 0, n = 0, d = 0, c = 0, g = w; if (1 < v) if (g =
                                                        new r(m * v), l) for (k = 0; k < m; k++)for (c = k, d = 0; d < v; d++, c += m)g[c] = w[n++]; else for (k = 0; k < m; k++)for (c = k, d = 0; d < v; d++, c += m)g[n++] = w[c]; return g
                                        }
                                }, A = function (w, m, v) { this.val = w; this.left = m; this.right = v }; return {
                                        decode: function (w, m) {
                                                m = m || {}; var v = m.noDataValue, r = 0, l = {}; l.ptr = m.inputOffset || 0; l.pixels = {}; if (q.readHeaderInfo(w, l)) {
                                                        r = l.headerInfo; var k = r.fileVersion, n = q.getDataTypeArray(r.imageType); if (5 < k) throw "unsupported lerc version 2." + k; q.readMask(w, l); r.numValidPixel === r.width * r.height || l.pixels.resultMask ||
                                                                (l.pixels.resultMask = m.maskData); var d = r.width * r.height; l.pixels.resultPixels = new n(d * r.numDims); l.counter = { onesweep: 0, uncompressed: 0, lut: 0, bitstuffer: 0, constant: 0, constantoffset: 0 }; var c = !m.returnPixelInterleavedDims; if (0 !== r.numValidPixel) if (r.zMax === r.zMin) q.constructConstantSurface(l, c); else if (4 <= k && q.checkMinMaxRanges(w, l)) q.constructConstantSurface(l, c); else {
                                                                        var g = new DataView(w, l.ptr, 2), b = g.getUint8(0); l.ptr++; if (b) q.readDataOneSweep(w, l, n, c); else if (1 < k && 1 >= r.imageType && 1E-5 > Math.abs(r.maxZError -
                                                                                .5)) { g = g.getUint8(1); l.ptr++; l.encodeMode = g; if (2 < g || 4 > k && 1 < g) throw "Invalid Huffman flag " + g; g ? q.readHuffman(w, l, n, c) : q.readTiles(w, l, n, c) } else q.readTiles(w, l, n, c)
                                                                } l.eofOffset = l.ptr; m.inputOffset ? (w = l.headerInfo.blobSize + m.inputOffset - l.ptr, 1 <= Math.abs(w) && (l.eofOffset = m.inputOffset + l.headerInfo.blobSize)) : (w = l.headerInfo.blobSize - l.ptr, 1 <= Math.abs(w) && (l.eofOffset = l.headerInfo.blobSize)); w = {
                                                                        width: r.width, height: r.height, pixelData: l.pixels.resultPixels, minValue: r.zMin, maxValue: r.zMax, validPixelCount: r.numValidPixel,
                                                                        dimCount: r.numDims, dimStats: { minValues: r.minValues, maxValues: r.maxValues }, maskData: l.pixels.resultMask
                                                                }; if (l.pixels.resultMask && q.isValidPixelValue(r.imageType, v)) { k = l.pixels.resultMask; for (r = 0; r < d; r++)k[r] || (w.pixelData[r] = v); w.noDataValue = v } l.noDataValue = v; m.returnFileInfo && (w.fileInfo = q.formatFileInfo(l)); return w
                                                }
                                        }, getBandCount: function (w) { for (var m = 0, v = 0, r = { ptr: 0, pixels: {} }; v < w.byteLength - 58;)q.readHeaderInfo(w, r), v += r.headerInfo.blobSize, m++, r.ptr = v; return m }
                                }
                        })
                }, "esri/layers/pixelFilters/VectorFieldPixelFilter": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../../kernel ../../lang dojo/_base/array".split(" "),
                                function (E, q, A, w, m, v) {
                                        E = E(null, {
                                                declaredClass: "esri.layers.pixelFilters.VectorFieldPixelFilter", speedUnits: ["esriMetersPerSecond", "esriKilometersPerHour", "esriKnots", "esriFeetPerSecond", "esriMilesPerHour"], constructor: function (r) { q.mixin(this, r); this.isDataUV = r && r.isDataUV ? r.isDataUV : !1; this.computeMagnitudeAndDirection = q.hitch(this, this.computeMagnitudeAndDirection); this.unitConversionFactor = 1; this._updateUnitConvFactor() }, setUnits: function (r, l) {
                                                        this.inputUnit = r; this.outputUnit = l; this.unitConversionFactor =
                                                                1; this._updateUnitConvFactor()
                                                }, _updateUnitConvFactor: function () { var r = v.indexOf(this.speedUnits, this.inputUnit), l = v.indexOf(this.speedUnits, this.outputUnit); if (this.inputUnit && this.outputUnit && 0 <= r && 0 <= l) { var k = [1, .277778, .514444, .3048, .44704, 0]; this.unitConversionFactor = k[r] / k[l] } }, computeMagnitudeAndDirection: function (r) {
                                                        if (!m.isDefined(r)) throw "Could not compute magnitude and direction. No pixel data is available."; var l = r.pixelBlock; if (!m.isDefined(l) || 2 !== l.getPlaneCount()) throw "Could not compute magnitude and direction. Pixel data does not contain two bands.";
                                                        var k = r.extent, n = (k.xmax - k.xmin) / l.width, d = (k.ymax - k.ymin) / l.height, c = k.xmin + n / 2; k = k.ymax - d / 2; l.statistics[0].minValue = 0; l.statistics[0].maxValue = 0; var g = 180 / Math.PI, b = [], e = 0, a = 0, f = 0, h = !m.isDefined(l.mask), p, B, t, u; var z = t = Infinity; var x = u = -Infinity; for (e = 0; e < l.height; e++)for (a = 0; a < l.width; a++, f++)if (b.push([c + n * a, k - d * e]), h || l.mask[f]) {
                                                                var y = p = l.pixels[0][f]; var D = B = l.pixels[1][f]; this.isDataUV && (y = Math.sqrt(p * p + B * B), D = 90 - g * Math.atan2(B, p)); l.pixels[0][f] = y * this.unitConversionFactor; l.pixels[1][f] =
                                                                        D; y > x && (x = y); y < z && (z = y); D > u && (u = D); D < t && (t = D)
                                                        } l.statistics[0].maxValue = x; l.statistics[0].minValue = z; l.statistics[1].maxValue = u; l.statistics[1].minValue = t; r.locations = b; return r
                                                }
                                        }); A("extend-esri") && q.setObject("layers.pixelFilters.VectorFieldPixelFilter", E, w); return E
                                })
                }, "esri/layers/rasterFormats/ImageCanvasDecoder": function () {
                        define(["require", "dojo/_base/declare", "dojo/Deferred", "dojo/sniff"], function (E, q, A, w) {
                                var m; return q(null, {
                                        constructor: function (v) { this.ctx = v.ctx; this._loadRasterFormatModule() },
                                        decode: function (v, r) {
                                                if (!r.width || !r.height) throw "Native decoding requires the image format, width and height"; var l = new A, k, n = new Uint8Array(v); v = this._getFormat(v); if ("error" === v) throw "invalid format"; "jpeg" === v && (k = this._getMask(n, r)); var d = "", c; for (c = 0; c < n.length; c += 65535) { var g = n.subarray(c, c + 65535 > n.length - 1 ? n.length - 1 : c + 65535); d += String.fromCharCode.apply(null, g) } n = "data:image/" + v + ";base64," + window.btoa(d); var b = new Image, e; b.src = n; var a = this; b.onload = function () {
                                                        a.ctx.clearRect(0, 0, r.width,
                                                                r.height); a.ctx.drawImage(b, 0, 0); var f = a.ctx.getImageData(0, 0, b.width, b.height); e = f.data; if (k) for (c = 0; c < k.length; c++)e[4 * c + 3] = k[c] ? 255 : 0; a.ctx.putImageData(f, 0, 0); l.resolve(null)
                                                }; b.onerror = function () { l.reject("cannot load image") }; return l
                                        }, _getFormat: function (v) { v = new Uint8Array(v, 0, 10); var r = "error"; 255 === v[0] && 216 === v[1] ? r = "jpeg" : 137 === v[0] && 80 === v[1] && 78 === v[2] && 71 === v[3] && (r = "png"); return r }, _getMask: function (v, r) {
                                                try {
                                                        if (!m) throw "The zlib decoder module is not loaded."; var l = 0, k = 0, n = Math.round(v.length /
                                                                2); 1 === n % 2 && (n += 1); var d = v.length - 2; for (l = n; l < d && (255 !== v[l] || 217 !== v[l + 1]); l++); n = l += 2; if (n < v.length - 1) { var c = (new m(v.subarray(n))).getBytes(); var g = new Uint8Array(r.width * r.height); for (l = v = 0; l < c.length; l++)for (k = 7; 0 <= k; k--)g[v++] = c[l] >> k & 1 }
                                                } catch (b) { } return g
                                        }, _loadRasterFormatModule: function () { 10 > w("ie") || E(["./Zlib"], function (v) { m = v }) }
                                })
                        })
                }, "esri/tasks/ImageServiceIdentifyTask": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../request ../geometry/normalizeUtils ./Task ./ImageServiceIdentifyResult".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        E = E(r, {
                                                declaredClass: "esri.tasks.ImageServiceIdentifyTask", constructor: function (k) { this._url.path += "/identify"; this._handler = q.hitch(this, this._handler) }, __msigns: [{ n: "execute", c: 3, a: [{ i: 0, p: ["geometry"] }], e: 2 }], _handler: function (k, n, d, c, g) { try { var b = new l(k); this._successHandler([b], "onComplete", d, g) } catch (e) { this._errorHandler(e, c, g) } }, execute: function (k, n, d, c) {
                                                        var g = c.assembly; k = this._encode(q.mixin({}, this._url.query, { f: "json" }, k.toJson(g && g[0]))); var b = this._handler,
                                                                e = this._errorHandler; return m({ url: this._url.path, content: k, callbackParamName: "callback", load: function (a, f) { b(a, f, n, d, c.dfd) }, error: function (a) { e(a, d, c.dfd) } })
                                                }, onComplete: function () { }
                                        }); v._createWrappers(E); A("extend-esri") && q.setObject("tasks.ImageServiceIdentifyTask", E, w); return E
                                })
                }, "esri/tasks/ImageServiceIdentifyResult": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../geometry/jsonUtils ./FeatureSet".split(" "), function (E, q, A, w, m, v) {
                                E = E(null, {
                                        declaredClass: "esri.tasks.ImageServiceIdentifyResult",
                                        constructor: function (r) { r.catalogItems && (this.catalogItems = new v(r.catalogItems)); r.location && (this.location = m.fromJson(r.location)); this.catalogItemVisibilities = r.catalogItemVisibilities; this.name = r.name; this.objectId = r.objectId; this.value = r.value; this.processedValues = r.processedValues; this.properties = r.properties }
                                }); A("extend-esri") && q.setObject("tasks.ImageServiceIdentifyResult", E, w); return E
                        })
                }, "esri/tasks/ImageServiceIdentifyParameters": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/_base/array dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        E = E(null, {
                                                declaredClass: "esri.tasks.ImageServiceIdentifyParameters", geometry: null, mosaicRule: null, renderingRule: null, renderingRules: null, pixelSizeX: null, pixelSizeY: null, pixelSize: null, returnGeometry: !1, returnCatalogItems: !0, timeExtent: null, maxItemCount: null, returnPixelValues: !0, toJson: function (k) {
                                                        var n = k && k.geometry || this.geometry; k = {
                                                                geometry: n, returnGeometry: this.returnGeometry, returnCatalogItems: this.returnCatalogItems, mosaicRule: this.mosaicRule ? A.toJson(this.mosaicRule.toJson()) :
                                                                        null, renderingRule: this.renderingRule ? A.toJson(this.renderingRule.toJson()) : null
                                                        }; n && (k.geometryType = l.getJsonType(n)); n = this.timeExtent; k.time = n ? n.toJson().join(",") : null; r.isDefined(this.pixelSizeX) && r.isDefined(this.pixelSizeY) ? k.pixelSize = A.toJson({ x: parseFloat(this.pixelSizeX), y: parseFloat(this.pixelSizeY) }) : this.pixelSize && (k.pixelSize = this.pixelSize ? A.toJson(this.pixelSize.toJson()) : null); this.renderingRules && (k.renderingRules = A.toJson(w.map(this.renderingRules, function (d) { return d.toJson() })));
                                                        r.isDefined(this.returnPixelValues) && (k.returnPixelValues = this.returnPixelValues); r.isDefined(this.maxItemCount) && (k.maxItemCount = this.maxItemCount); return k
                                                }
                                        }); m("extend-esri") && q.setObject("tasks.ImageServiceIdentifyParameters", E, v); return E
                                })
                }, "esri/layers/pixelFilters/StretchFilter": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "../PixelBlock"], function (E, q, A) {
                                var w; return E(null, {
                                        stretchType: 0, min: 0, max: 255, numberOfStandardDeviations: 2, statistics: null, histograms: null, dra: !1, minPercent: .25,
                                        maxPercent: .5, useGamma: !1, gamma: null, raster: null, outputPixelType: "U8", computeGamma: !1, constructor: function (m) {
                                                this.stretchType = m.stretchType || m.StretchType || this.stretchType; this.min = m.min || m.Min || this.min; this.max = m.max || m.Max || this.max; this.numberOfStandardDeviations = m.numberOfStandardDeviations || m.NumberOfStandardDeviations || this.numberOfStandardDeviations; this.statistics = m.statistics || m.Statistics || this.statistics; this.dra = m.dra || m.DRA || m.dRA || this.dra; this.minPercent = m.minPercent || m.MinPercent ||
                                                        this.minPercent; this.maxPercent = m.maxPercent || m.MaxPercent || this.maxPercent; this.useGamma = m.useGamma || m.UseGamma || this.useGamma; this.gamma = m.gamma || m.Gamma || this.gamma; this.computeGamma = m.computeGamma || m.ComputeGamma || this.computeGamma; this.raster = m.raster || m.Raster || this.raster; this.outputPixelType = m.outputPixelType || m.OutputPixelType || this.outputPixelType; this.raster = m.raster || m.Raster || this.raster; w = this
                                        }, filter: function (m) {
                                                if (void 0 !== m && null !== m && null !== m.pixelBlock && null !== m.pixelBlock.pixels) {
                                                        var v =
                                                                m.pixelBlock, r = v.pixels, l = v.width * v.height, k = r.length, n; (n = 6 === w.stretchType || 3 === w.stretchType && w.dra) && w._calculateStatisticsHistograms(m); if (w.dra) if (n) w._statistics = v.statistics, w._histograms = v.histograms; else { var d = v.statistics; w._statistics = []; for (n = 0; n < k; n++)w._statistics[n] = [d[n].minValue, d[n].maxValue, 0, 0] } else w._statistics = w.statistics, w._histograms = w.histograms; w.computeGamma && (w.gamma = w._computeGammaValues(v.pixelType), w.useGamma = !0); w._createLUT(m); if (void 0 === w.LUT || null === w.LUT) return w._filterNoLUT(m);
                                                        d = w.LUT; var c = w.LUTOffset; for (n = 0; n < k; n++) { var g = d[n]; for (v = 0; v < l; v++) { var b = r[n][v]; r[n][v] = g[b - c] } } m.pixelBlock.pixelType = "U8"; return m
                                                }
                                        }, _calculateStatisticsHistograms: function (m) {
                                                m = m.pixelBlock; var v = m.pixelType, r = m.pixels, l = m.mask, k = r.length, n, d, c = function (u) { this.min = -.5; this.max = 255.5; this.size = 256; q.mixin(this, u); this.counts = this.counts || new Uint32Array(this.size) }, g = [], b, e; for (n = 0; n < k; n++) {
                                                        var a = new c; var f = a.counts; var h = r[n]; if ("U8" === v) if (l) for (d = 0; d < m.width * m.height; d++)l[d] && f[h[d]]++;
                                                        else for (d = 0; d < m.width * m.height; d++)f[h[d]]++; else { var p = m.statistics[n].minValue; var B = m.statistics[n].maxValue; a.min = p; a.max = B; B = (B - p) / 256; var t = new Uint32Array(257); if (l) for (d = 0; d < m.width * m.height; d++)l[d] && t[Math.floor((h[d] - p) / B)]++; else for (d = 0; d < m.width * m.height; d++)t[Math.floor((h[d] - p) / B)]++; for (d = 0; 255 > d; d++)f[d] = t[d]; f[255] = t[255] + t[256] } g.push(a); h = []; p = m.statistics[n].minValue; B = m.statistics[n].maxValue; for (d = e = b = t = 0; d < a.size; d++)t += f[d], b += d * f[d]; b /= t; for (d = 0; d < a.size; d++)e += f[d] * Math.pow(d -
                                                                b, 2); f = Math.sqrt(e / (t - 1)); d = (b + .5) * (a.max - a.min) / a.size + a.min; a = f * (a.max - a.min) / a.size; h.push(p); h.push(B); h.push(d); h.push(a); m.statistics[n] = h
                                                } m.histograms = g
                                        }, _getCutOffPoints: function (m) {
                                                m = m.pixelBlock.pixels.length; var v = [], r = [], l, k, n; switch (w.stretchType) {
                                                        case 5: for (k = 0; k < m; k++)v[k] = w._statistics[k][0], r[k] = w._statistics[k][1]; break; case 3: for (k = 0; k < m; k++)v[k] = w._statistics[k][2] - w.numberOfStandardDeviations * w._statistics[k][3], r[k] = w._statistics[k][2] + w.numberOfStandardDeviations * w._statistics[k][3],
                                                                v[k] < w._statistics[k][0] && (v[k] = w._statistics[k][0]), r[k] > w._statistics[k][1] && (r[k] = w._statistics[k][1]); break; case 6: for (k = 0; k < m; k++) { var d = w._histograms[k]; var c = new Uint32Array(d.size); var g = d.counts; for (n = l = 0; n < d.size; n++)l += g[n], c[n] = l; g = w.minPercent * l / 100; for (n = 1; n < d.size; n++)if (c[n] > g) { v[k] = d.min + (d.max - d.min) / d.size * (n - .5); break } g = (1 - w.maxPercent / 100) * l; for (n = d.size - 2; 0 <= n; n--)if (c[n] < g) { r[k] = d.min + (d.max - d.min) / d.size * (n + .5); break } } break; default: for (k = 0; k < m; k++)v[k] = 0, r[k] = 255
                                                }return {
                                                        minCutOff: v,
                                                        maxCutOff: r
                                                }
                                        }, _createLUT: function (m) {
                                                var v = m.pixelBlock, r = v.pixelType; if ("U8" === r || "U16" === r || "S8" === r || "S16" === r) {
                                                        if (w._LUTSignature && (r = w._computeLutSignature(), r.length === w._LUTSignature.length && !r.some(function (z, x) { return z !== w._LUTSignature[x] }))) return; r = v.pixels.length; var l = [], k = [], n = [], d, c = w.max, g = w.min, b = w.gamma, e = c - g, a = w._getCutOffPoints(m); m = a.minCutOff; a = a.maxCutOff; var f = 0, h = 256; "S8" === v.pixelType ? f = -127 : "S16" === v.pixelType && (f = -32767); if ("U16" === v.pixelType || "S16" === v.pixelType) h =
                                                                65536; for (v = 0; v < r; v++)l[v] = a[v] - m[v]; if (w.useGamma && null !== b && b.length === r) for (v = 0; v < r; v++)n[v] = 1 < b[v] ? 2 < b[v] ? 6.5 + Math.pow(b[v] - 2, 2.5) : 6.5 + 100 * Math.pow(2 - b[v], 4) : 1; if (w.useGamma) for (v = 0; v < r; v++) { var p = []; for (d = 0; d < h; d++) { var B = d + f; var t = (B - m[v]) / l[v]; var u = 1; 1 < b[v] && (u -= Math.pow(1 / e, t * n[v])); B < a[v] && B > m[v] ? p[d] = Math.floor(u * e * Math.pow(t, 1 / b[v])) + g : B > a[v] ? p[d] = c : B < m[v] && (p[d] = g) } k[v] = p } else for (v = 0; v < r; v++) { p = []; for (d = 0; d < h; d++)B = d + f, p[d] = B < m[v] ? g : B > a[v] ? c : Math.floor((B - m[v]) / l[v] * e) + g; k[v] = p } w.LUT =
                                                                        k; w.LUTOffset = f; w._LUTSignature = w._computeLutSignature()
                                                }
                                        }, _computeLutSignature: function () { var m = [], v, r; m.push(w.stretchType); m.push(w.min); m.push(w.max); m.push(w.numberOfStandardDeviations); if (w._statistics) for (v = 0; v < w._statistics.length; v++)for (r = 0; r < w._statistics[v].length; r++)m.push(w._statistics[v][r]); m.push(w.dra ? 1 : 0); m.push(w.minPercent); m.push(w.maxPercent); if (w.gamma) for (v = 0; v < w._statistics.length; v++)m.push(w.gamma[v]); m.push(w.useGamma ? 1 : 0); return m }, _filterNoLUT: function (m) {
                                                if (null !==
                                                        m && null !== m.pixelBlock && null !== m.pixelBlock.pixels) {
                                                                var v = m.pixelBlock, r = v.pixels, l = v.mask; v = v.width * v.height; var k = r.length, n = [], d = [], c, g = w.max, b = w.min, e = w.gamma, a = g - b; var f = w._getCutOffPoints(m); var h = f.minCutOff, p = f.maxCutOff; for (f = 0; f < k; f++)n[f] = p[f] - h[f]; if (w.useGamma && null !== e && e.length === k) for (f = 0; f < k; f++)d[f] = 1 < e[f] ? 2 < e[f] ? 6.5 + Math.pow(e[f] - 2, 2.5) : 6.5 + 100 * Math.pow(2 - e[f], 4) : 1; if (w.useGamma) if (void 0 !== l && null !== l) for (c = 0; c < v; c++) {
                                                                        if (l[c]) for (f = 0; f < k; f++) {
                                                                                var B = r[f][c]; var t = (B - h[f]) / n[f];
                                                                                var u = 1; 1 < e[f] && (u -= Math.pow(1 / a, t * d[f])); B < p[f] && B > h[f] ? r[f][c] = Math.floor(u * a * Math.pow(t, 1 / e[f])) + b : B > p[f] ? r[f][c] = g : B < h[f] && (r[f][c] = b)
                                                                        }
                                                                } else for (c = 0; c < v; c++)for (f = 0; f < k; f++)B = r[f][c], t = (B - h[f]) / n[f], u = 1, 1 < e[f] && (u -= Math.pow(1 / a, t * d[f])), B < p[f] && B > h[f] ? r[f][c] = Math.floor(u * a * Math.pow(t, 1 / e[f])) + b : B > p[f] ? r[f][c] = g : B < h[f] && (r[f][c] = b); else if (void 0 !== l && null !== l) for (c = 0; c < v; c++) {
                                                                        if (l[c]) for (f = 0; f < k; f++)B = r[f][c], B < p[f] && B > h[f] ? r[f][c] = Math.floor((B - h[f]) / n[f] * a) + b : B > p[f] ? r[f][c] = g : B < h[f] && (r[f][c] =
                                                                                b)
                                                                } else for (c = 0; c < v; c++)for (f = 0; f < k; f++)B = r[f][c], B < p[f] && B > h[f] ? r[f][c] = Math.floor((B - h[f]) / n[f] * a) + b : B > p[f] ? r[f][c] = g : B < h[f] && (r[f][c] = b); m.pixelBlock.pixelType = "U8"; return m
                                                }
                                        }, _computeGammaValues: function (m) { var v = this._statistics.length, r, l = []; for (r = 0; r < v; r++) { var k = this._statistics[r][2]; "U8" !== m && (k = 255 * (k - this._statistics[r][0]) / (this._statistics[r][1] - this._statistics[r][0])); l.push(this._computeGammaValue(k)) } return l }, _computeGammaValue: function (m) {
                                                if (0 !== m && !(255 < m || 0 > m)) {
                                                        var v = 0; 0 < m &&
                                                                150 != m && 255 > m && (v = 150 >= m ? 45 * Math.cos(.01047 * m) : 17 * Math.sin(.021 * m)); v = Math.log((m + v) / 255); if (0 !== v && (m = Math.log(m / 255) / v, !isNaN(m))) return Math.min(9.9, Math.max(.01, m))
                                                }
                                        }
                                })
                        })
                }, "esri/layers/StreamLayer": function () {
                        define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/Deferred dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u) {
                                        E = E([b], {
                                                declaredClass: "esri.layers.StreamLayer", _preventInit: !0, constructor: function (z, x) {
                                                        x = x || {}; x.mode && x.mode !== b.MODE_STREAM || (this._isStream = !0, this.currentMode = this.mode = b.MODE_STREAM, this._mode = new e(this)); this.purgeOptions = new u(this, x.purgeOptions || {}); this.purgeInterval = x.purgeInterval || 0; this._reconnectAttempts = 0; this.maxReconnectAttempts = 10; this.socket = this._reconnectTimeoutId = null; this._keepLatestQueried = !1; this._keepLatestUrl = null;
                                                        this._relatedQueried = !1; this._joinField = this._relatedUrl = null; this._refreshing = !1; this._attemptReconnect = m.hitch(this, this._attemptReconnect); this._purge = m.hitch(this, this._purge); this._processServiceJson = m.hitch(this, this._processServiceJson); if (m.isObject(z) && z.layerDefinition) this._initFeatureLayer(z, x); else { var y = this; c({ url: z, content: m.mixin({ f: "json" }), callbackParamName: "callback" }).then(function (D) { y._processServiceJson(D, x) }, function (D) { y._errorHandler(D) }) }
                                                }, _processServiceJson: function (z,
                                                        x) {
                                                                var y = this; z.relatedFeatures && z.relatedFeatures.featuresUrl && z.relatedFeatures.joinField ? (this._relatedUrl = z.relatedFeatures.featuresUrl, this.objectIdField = this._joinField = z.relatedFeatures.joinField, c({ url: this._relatedUrl, content: { f: "json" }, callbackParamName: "callback" }).then(function (D) { D = D.fields || []; var H = A.map(z.fields, function (I) { return I.name.toLowerCase() }); A.forEach(D, function (I) { -1 === A.indexOf(H, I.name.toLowerCase()) && z.fields.push(I) }); x.resourceInfo = z; y._initFeatureLayer(y._url, x) },
                                                                        function (D) { y.onError({ error: D }) })) : (x.resourceInfo = z, this._initFeatureLayer(this._url, x))
                                                }, _initLayer: function (z, x) {
                                                        this.inherited(arguments); if (z) {
                                                                var y; if (z.layerDefinition) this.purgeOptions = new u(this, this._params.purgeOptions || {}), this.socketUrl = this._params.socketUrl || z.layerDefinition.socketUrl || void 0; else {
                                                                        if (this._params.socketUrl) this.socketUrl = this._params.socketUrl; else {
                                                                                var D = this._getWebsocketConnectionInfo(z), H = D.urls; H && H.length ? (this._socketUrls = H, this.socketUrl = H[0], this.socketDirection =
                                                                                        "broadcast" === this._params.socketDirection ? "broadcast" : "subscribe", this.socketUrl += "/" + this.socketDirection, this._websocketToken = D.token, H.length > this.maxReconnectAttempts && (this.maxReconnectAttempts = H.length)) : (this.socketUrl = void 0, D = "No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.", "https:" === location.protocol && (D += " An insecure web socket connection cannot be made from a secure web page."), this.onError(Error(D)))
                                                                        } if (this._params.filter) try {
                                                                                this._filter =
                                                                                y = this._makeFilter(this._params.filter)
                                                                        } catch (I) { this.onError(Error("Error trying to create filter object: " + I + ". Layer will not have filter applied")), this._filter = null } if (this._params.geometryDefinition || this._outFields || this._defnExpr) {
                                                                                y = y || {}; y.geometry = this._params.geometryDefinition; y.outFields = this._outFields; y.where = this._defnExpr; try { this._filter = y = this._makeFilter(y) } catch (I) {
                                                                                        this.onError(Error("Error trying to create filter object: " + I + ". Layer will not have filter applied")), this._filter =
                                                                                                null
                                                                                }
                                                                        }
                                                                } this.maximumTrackPoints = this._params.maximumTrackPoints || 0 === this._params.maximumTrackPoints ? this._params.maximumTrackPoints : 1; (this._params.refreshRate || 0 === this._params.refreshRate) && this._mode && this._mode._setRefreshRate && this._mode._setRefreshRate(this._params.refreshRate); this._keepLatestUrl = z.keepLatestArchive ? z.keepLatestArchive.featuresUrl : null; z.relatedFeatures && z.relatedFeatures.featuresUrl && z.relatedFeatures.joinField && (this._relatedUrl = z.relatedFeatures.featuresUrl, this.objectIdField =
                                                                        this._joinField = z.relatedFeatures.joinField); this.objectIdField || this._makeObjectIdField(); this._map && this.socketUrl && !this._connected && this.connect()
                                                        }
                                                }, _isWebGLCompatible: function () { return !1 }, _setMap: function (z) { var x = this.inherited(arguments), y = this._getRenderer(); this.timeInfo && (this._trackIdField || y && (y.latestObservationRenderer || y.trackRenderer)) && (this._trackManager = new a(this), this._trackManager.initialize(z)); this.socketUrl && !this._connected && this._map && this.connect(); return x }, _unsetMap: function (z,
                                                        x) { A.forEach(this._connects, q.disconnect); (this._connected || this._reconnecting || this.socket) && this.disconnect(); this._togglePurgeT(); this.inherited(arguments); this._map = null }, _suspend: function () { this._togglePurgeT(); this.inherited(arguments) }, _resume: function () { this.inherited(arguments); this._togglePurgeT(!0) }, clear: function () {
                                                                try {
                                                                        this._mode && this._mode._clearDrawBuffer && this._mode._clearDrawBuffer(), this._mode && this._mode._clearTimeBin && this._mode._clearTimeBin(), this._mode && this._mode._clearFeatureMap &&
                                                                                this._mode._clearFeatureMap(), this._trackManager && this._trackManager.clearTracks()
                                                                } catch (z) { } this.inherited(arguments); this._trackManager && this._trackManager.createTracklineContainer()
                                                        }, redraw: function () { this._mode && this._mode._flushDrawBuffer && this._mode._flushDrawBuffer(); this.inherited(arguments) }, setDefinitionExpression: function (z) { this.setFilter({ where: z }) }, getDefinitionExpression: function () { if (this._filter) var z = this._filter.where; return z }, destroy: function () { this.disconnect(); this.inherited(arguments) },
                                                onResume: function (z) { this.inherited(arguments) }, setGeometryDefinition: function (z) { this.setFilter({ geometry: z }) }, getGeometryDefinition: function () { if (this._filter) var z = this._filter.geometry; return z }, connect: function (z) {
                                                        var x = new v, y = {}, D = this._filter, H, I, N = this.socketUrl, T; try {
                                                                this._connected || this._connecting ? x.reject(Error("Cannot start new connection process. Layer is connecting.")) : (this._connecting = !0, this._getRelatedFeatures().then(function () { return this._getKeepLatestFeatures() }.bind(this)).then(function () {
                                                                        this._websocketToken &&
                                                                        (y.token = this._websocketToken); this._map && this._map.spatialReference && this.spatialReference && this._map.spatialReference.wkid !== this.spatialReference.wkid && (y.outSR = this._map.spatialReference.wkid); if (D) for (I in D) null !== D[I] && (H = "geometry" === I ? JSON.stringify(D[I]) : D[I], y[I] = H); N += "?" + l.objectToQuery(y); T = this._createConnection(N, z); x.resolve(T)
                                                                }.bind(this)).otherwise(function (M) { x.reject(M) }))
                                                        } catch (M) { z && (z(M, !1), x.reject(M)), this.onConnectionError({ error: M }) } return x.promise
                                                }, disconnect: function (z) {
                                                        var x =
                                                                this._refreshing ? "Disconnecting as part of layer refresh cycle" : "Connection closed from client", y = this._refreshing ? !0 : !1; this._reconnectTimeoutId && clearTimeout(this._reconnectTimeoutId); this._refreshing = this._reconnecting = this._connecting = this._connected = !1; this.socket && this.socket.close(); this.onDisconnect({ willReconnect: y, message: x }); z && z(null, !0)
                                                }, setFilter: function (z) {
                                                        if (this._collection) return this.onError("Filter can only be set when the source of the layer is a Stream Service"), !1; try {
                                                                if (void 0 !==
                                                                        z.outFields) { var x = Error("Outfields property cannot be changed after layer is created"); this.onFilterChange({ filter: this.getFilter(), error: x }); return !1 } var y = this._makeFilter(z)
                                                        } catch (D) { return x = Error(D), this.onFilterChange({ filter: this.getFilter(), error: x }), !1 } if (this.socket) z = { filter: y }, this.socket.send(JSON.stringify(z)); else k.once(this, "connect", function (D) { this.setFilter(y) }); return !0
                                                }, getFilter: function () {
                                                        var z = this._filter, x = {}, y = ["geometry", "outFields", "where"]; z && A.forEach(y, function (D) {
                                                                var H =
                                                                        z[D]; H && ("geometry" === D ? H = f.fromJson(H) : "outFields" === D && (H = H.split(",")), x[D] = H)
                                                        }); return x
                                                }, setMaximumTrackPoints: function (z) { if (!z && 0 !== z) return !1; this.maximumTrackPoints = z; this._mode.propertyChangeHandler(3) }, getUniqueValues: function (z) { var x = {}, y = []; var D = this._getField(z, !0); if (!D) return y; z = D.name; A.forEach(this.graphics || [], function (H) { H = (H.attributes || {})[z]; void 0 === H || x[H] || (x[H] = 1, y.push(H)) }); y.sort(function (H, I) { return H < I ? -1 : H > I ? 1 : 0 }); return y }, getLatestObservations: function () {
                                                        var z =
                                                                []; return z = this._trackManager ? this._trackManager.getLatestObservations() : this.graphics
                                                }, setPurgeInterval: function (z) { var x = this.purgeInterval; this.purgeInterval = z; this._togglePurgeT(); z && this._togglePurgeT(!0); if (x !== z) this.onPurgeIntervalChange(); return this }, _togglePurgeT: function (z) {
                                                        if (z && this.purgeInterval) {
                                                                var x = this; clearTimeout(this._purgeT); this._mode && this._mode._flushDrawBuffer && (this._purgeT = setTimeout(function () { x.updating || x.suspended || (x._mode._flushDrawBuffer(), x._togglePurgeT(!0)) },
                                                                        6E4 * this.purgeInterval))
                                                        } else this._purgeT && (clearTimeout(this._purgeT), this._purgeT = null)
                                                }, onMessage: function () { }, onConnect: function () { }, onDisconnect: function () { }, onFilterChange: function () { }, onAttemptReconnect: function () { }, onConnectionError: function () { }, onPurgeIntervalChange: function () { }, _createConnection: function (z, x) {
                                                        var y = this, D = new WebSocket(z); D.onopen = function () { y.socket = D; y._connected = !0; y._connecting = !1; y._reconnecting = !1; y._reconnectAttempts = 0; y._bind(); y.onConnect(); x && x(null, !0) }; D.onclose =
                                                                function (H) {
                                                                        var I = !0, N = y._connected, T = null; if (y._connected || y._reconnecting) {
                                                                                if (H.code) { var M = "Connection failed: "; if (1001 === H.code) M += H.reason || "Service is going away.", I = !1; else if (4400 === H.code) M += H.reason || "Invalid url parameters. Check filter properties.", I = !1; else if (4404 === H.code) M += "Service not found", I = !1; else if (4401 === H.code || 4403 === H.code) M += "Not authorized", I = !1 } I && (y._reconnectAttempts += 1, y._reconnectAttempts > y.maxReconnectAttempts && (M = "Maximum reconnect attempts exceeded", I = !1, N = !0));
                                                                                y._connected = !1; N && (M && (T = Error(M)), y.onDisconnect({ error: T, willReconnect: I })); I ? y._attemptReconnect() : y.socket = null
                                                                        } else y.socket || (T = Error("Could not make connection to service"), y.onConnectionError({ error: T })), y.socket = null, y._connected = !1
                                                                }; D.onerror = function (H) { console.log("Socket error") }; return D
                                                }, _getKeepLatestFeatures: function () {
                                                        var z = new v; this._map && this._keepLatestUrl && !this._keepLatestQueried && this._mode._fetchArchive ? this._mode._fetchArchive(this._keepLatestUrl).then(function () { z.resolve() }.bind(this)).otherwise(function (x) { z.reject(x) }).always(function () {
                                                                this._keepLatestQueried =
                                                                !0
                                                        }.bind(this)) : z.resolve(); return z.promise
                                                }, _getRelatedFeatures: function () { var z = new v; this._map && this._relatedUrl && !this._relatedQueried && this._mode._fetchArchive ? this._mode._fetchArchive(this._relatedUrl).then(function () { z.resolve() }.bind(this)).otherwise(function (x) { z.reject(x) }).always(function () { this._relatedQueried = !0 }.bind(this)) : z.resolve(); return z.promise }, _purge: function () {
                                                        var z, x = []; if (this.purgeOptions.displayCount && this.graphics.length > this.purgeOptions.displayCount) for (z = 0; z < this.graphics.length -
                                                                this.purgeOptions.displayCount; z++) { var y = this.graphics[z]; x.push(y) } 0 < x.length && (this._mode._removeFeatures(x), this._trackManager && this._trackManager.removeFeatures(x))
                                                }, _bind: function () { var z = this; this.socket.onmessage = function (x) { z._onMessage(JSON.parse(x.data)) } }, _onMessage: function (z) {
                                                        var x = this; this.onMessage(z); var y = { create: function (D) { x._create(D) }, update: function (D) { x._update(D) }, "delete": function (D) { x._delete(D) } }; if (z.type) y[z.type](z.feature); else z.hasOwnProperty("filter") ? x._handleFilterMessage(z) :
                                                                this._create(z)
                                                }, _create: function (z) { function x(H) { if (!y._featureHasOID(H, D)) { if (!H.geometry) return !1; H.attributes = H.attributes || {}; H.attributes[D] = y._nextId++ } H = H.declaredClass ? H : new g(H); y._mode.drawFeature(H) } var y = this, D = y.objectIdField; z.length ? z.forEach(function (H) { H && x(H) }) : z && x(z) }, _delete: function (z) { var x = this, y = z[x.objectIdField] || z.attributes[x.objectIdField], D = !1; this.graphics.forEach(function (H) { H.attributes[x.objectIdField] == y && (D = H) }); D && this.remove(D) }, _update: function (z) {
                                                        var x = this,
                                                        y = !1; this.graphics.forEach(function (D) { D.attributes[x.objectIdField] == z.attributes[x.objectIdField] && (y = D) }); y && (z.attributes && y.setAttributes(z.attributes), z.geometry && y.setGeometry(f.fromJson(z.geometry)))
                                                }, _makeFilter: function (z) {
                                                        var x = null; z = z || {}; if (void 0 !== z.geometry) if (x = x || {}, null === z.geometry) x.geometry = null; else {
                                                                var y = "string" === typeof z.geometry ? f.fromJson(JSON.parse(z.geometry)) : z.geometry.declaredClass ? z.geometry : f.fromJson(z.geometry); if (!y || "point" === y.type) throw "Query object contains invalid geometry";
                                                                "extent" !== y.type && (y = y.getExtent()); if (!y || 0 === y.getHeight() && 0 === y.getWidth()) throw "Invalid filter geometry: Extent cannot have a height and width of 0"; x.spatialRel = "esriSpatialRelIntersects"; x.geometryType = "esriGeometryEnvelope"; x.geometry = y.toJson()
                                                        } void 0 !== z.where && (x = x || {}, x.where = z.where); if (void 0 !== z.outFields && (x = x || {}, z = "string" === typeof z.outFields ? "*" === z.outFields ? null : z.outFields.replace(/,\s+/g, ",").split(",") : null === z.outFields ? null : z.outFields, z = this._makeOutFields(z))) {
                                                                if (z.errors &&
                                                                        0 < z.errors.length) throw "Invalid filter outFields. " + z.errors.join(","); x.outFields = z.fields ? z.fields.join(",") : null
                                                        } return x
                                                }, _makeOutFields: function (z) { var x = this, y = [], D = [], H = { fields: null }; if (!z || 0 === z.length) return H; A.forEach(z, function (I) { if ("*" === I) return H; var N = x._getField(I, !0); N ? y.push(N.name) : D.push("Field named " + I + " not found in schema.") }); z = x._getOutFields(); A.forEach(z, function (I) { x._getField(I) && -1 === A.indexOf(y, I) && y.push(I) }); H.fields = y; H.errors = D; return H }, _handleFilterMessage: function (z) {
                                                        z.error ?
                                                        (z = Error(z.error.join(",")), this.onFilterChange({ filter: this.getFilter(), error: z })) : (z = z.filter, z.geometry && "string" === typeof z.geometry && (z.geometry = JSON.parse(z.geometry)), this._filter = z, this.onFilterChange({ filter: this.getFilter() }))
                                                }, _getWebsocketConnectionInfo: function (z) {
                                                        var x = { urls: [] }, y, D = [], H = [], I; z.streamUrls && A.forEach(z.streamUrls, function (M) { "ws" === M.transport && (y = M.urls, x.token = M.token) }); if (!y) return x; A.forEach(y, function (M) { 0 === M.lastIndexOf("wss", 0) ? H.push(M) : D.push(M) }); z = "https:" ===
                                                                location.protocol || 0 === this.url.lastIndexOf("https:", 0) ? H : 0 === D.length ? H : D; if (1 < z.length) for (I = 0; I < z.length - 1; I++) { var N = I + Math.floor(Math.random() * (z.length - I)); var T = z[N]; z[N] = z[I]; z[I] = T } x.urls = z; return x
                                                }, _attemptReconnect: function () {
                                                        var z = this; this._reconnectTimeoutId = null; z._connected = !1; if (!z._socketUrls) return !1; if (!z._collection && !z._reconnecting && z.socket && z.credential) return z._reconnecting = !0, z._getServiceConnectionMetadata(z._attemptReconnect), !1; z._reconnecting = !0; z.socket = null; if (z._reconnectAttempts >
                                                                z.maxReconnectAttempts) return z._reconnecting = !1; z.socketUrl = z._socketUrls[z._reconnectAttempts > z._socketUrls.length - 1 ? z._reconnectAttempts % z._socketUrls.length : z._reconnectAttempts]; z.socketUrl += "/" + z.socketDirection; var x = z._randomIntFromInterval(0, 1E3); this._reconnectTimeoutId = setTimeout(function () { z.onAttemptReconnect({ count: z._reconnectAttempts, url: z.socketUrl }); z.connect() }, 1E3 * z._reconnectAttempts + x)
                                                }, _getServiceConnectionMetadata: function (z) {
                                                        var x = this, y = x._url.path; z = "function" === typeof z ?
                                                                z : null; c({ url: y, content: m.mixin({ f: "json" }, this._url.query), callbackParamName: "callback" }).then(function (D) { D = x._getWebsocketConnectionInfo(D); x._websocketToken = D.token; z && z() }, function (D) { x.onError(Error(D)) })
                                                }, _setDefaultRenderer: function () {
                                                        var z = this.geometryType, x = new w([5, 112, 176, .8]), y = new w([255, 255, 255]); y = new p(p.STYLE_SOLID, y, 1); if ("esriGeometryPoint" === z || "esriGeometryMultipoint" === z) var D = new B(B.STYLE_CIRCLE, 10, y, x); else if ("esriGeometryPolyline" === z) D = new p(p.STYLE_SOLID, x, 2); else if ("esriGeometryPolygon" ===
                                                                z || "esriGeometryEnvelope" === z) x = new w([5, 112, 176, .2]), y = new w([5, 112, 176, .8]), y = new p(p.STYLE_SOLID, y, 1), D = new h(h.STYLE_SOLID, y, x); D && this.setRenderer(new t(D))
                                                }, _makeObjectIdField: function () { var z = 1, x, y = []; if (!this.objectIdField) { var D = this.fields.length; for (x = 0; x < D; x++)y.push(this.fields[x].name.toLowerCase()); for (; -1 !== A.indexOf(y, "objectid_" + z);)z += 1; this.objectIdField = "objectid_" + z; this.fields.push({ name: "objectid_" + z, type: "esriFieldTypeOID", alias: "objectid_" + z, nullable: !1 }) } }, _featureHasOID: function (z,
                                                        x) { return z.attributes && (z.attributes[x] || 0 === z.attributes[x]) }, _randomIntFromInterval: function (z, x) { return Math.floor(Math.random() * (x - z + 1) + z) }
                                        }); r("extend-esri") && m.setObject("layers.StreamLayer", E, d); return E
                                })
                }, "esri/layers/StreamTrackManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Point ../geometry/Polyline ./TrackManager".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                E = E([k], {
                                        declaredClass: "esri.layers._StreamTrackManager", constructor: function (n) {
                                                this.inherited(arguments);
                                                var d = n.getMap().spatialReference; this.isWebMercator = d.isWebMercator(); this.canWrap = d._isWrappable(); this.wrapThreshold = this.isWebMercator ? 2.0037508342788905E7 : 180
                                        }, initialize: function (n) { this.inherited(arguments) }, addFeatures: function (n, d) {
                                                function c(B, t) { var u, z; a[B] || (a[B] = []); B = a[B]; if (0 < p) { t.length > p && t.splice(0, t.length - p); var x = t.length + B.length; x > p && (u = B.splice(0, x - p)) } x = t.length; for (z = 0; z < x; z += 1)B.push(t[z]); return { deletes: u, adds: t } } var g = {}, b = {}, e; if (d) return this.inherited(arguments), g;
                                                var a = this.trackMap; var f = this.layer; var h = f._trackIdField; var p = f.maximumTrackPoints || 0; A.forEach(n, function (B) { var t = B.attributes[h]; B.visible && (b[t] || (b[t] = []), b[t].push(B)) }); for (e in b) b.hasOwnProperty(e) && (f = c(e, b[e]), g[e] = f); return g
                                        }, removeFeatures: function (n) {
                                                var d = [], c = this.layer.objectIdField, g = this.layer._trackIdField; n && (A.forEach(n, function (b) {
                                                        var e; var a = b.attributes[g]; var f = b.attributes[c]; if (e = this.trackMap[a]) for (b = 0; b < e.length; b += 1) {
                                                                var h = e[b]; if (h.attributes[c] === f) {
                                                                        this.trackMap[a].splice(b,
                                                                                1); -1 === A.indexOf(a) && d.push(a); break
                                                                }
                                                        }
                                                }, this), 0 < n.length && this.refreshTracks(d))
                                        }, drawTracks: function (n) {
                                                function d(h) {
                                                        var p = e[h], B = p && 1 < p.length, t = c.trackLineMap[h]; t && !B && (g.remove(t), delete c.trackLineMap[h], t = null); if (!B) return !1; B = []; for (var u = [], z, x = p.length, y = 0; y < x; y++)if (z = p[y].geometry) { z = z.normalize(); var D = z.x, H = 0, I = !1; N && c.canWrap && (H = D - N.x, Math.abs(H) > c.wrapThreshold && (I = !0)); I ? (u.push([c.getWrappedX(D), z.y]), B.push(u.slice(0)), u = [[D, z.y]]) : u.push([D, z.y]); var N = new r(D, z.y, a) } 1 < u.length &&
                                                                B.push(u); p = {}; p[f] = h; if (B.length) if (t) { for (var T = t.geometry; T.paths.length;)T.removePath(T.paths.length - 1); B.forEach(function (M) { T.addPath(M) }); t.setGeometry(T) } else t = new v(new l({ paths: B, spatialReference: a }), null, p), g.add(t), c.trackLineMap[h] = t
                                                } var c = this, g = this.container, b; if (g) { var e = this.trackMap; var a = this.map.spatialReference; var f = this.layer._trackIdField; if (n) A.forEach(n, function (h) { d(h) }); else for (b in e) e.hasOwnProperty(b) && d(b) }
                                        }, refreshTracks: function (n) {
                                                function d(e) {
                                                        var a; e = c[e] ||
                                                                []; var f = e.length; for (a = 0; a < f; a++)g._repaint(e[a], null, !0)
                                                } var c = this.trackMap, g = this.layer, b; this.drawTracks(n); if (n) A.forEach(n, function (e) { d(e) }); else for (b in c) c.hasOwnProperty(b) && d(b)
                                        }, getLatestObservations: function () { var n, d = this.trackMap, c = []; for (n in d) if (d.hasOwnProperty(n)) { var g = d[n]; c.push(g[g.length - 1]) } return c }, destroy: function () { this.inherited(arguments); this.trackLineMap = null }, getWrappedX: function (n) {
                                                var d = this.isWebMercator, c = d ? 2.0037508342788905E7 : 180; d = d ? -2.0037508342788905E7 :
                                                        -180; return (0 < n ? d : c) - ((0 < n ? c : d) - n)
                                        }
                                }); w("extend-esri") && q.setObject("layers._StreamTrackManager", E, m); return E
                        })
                }, "esri/layers/PurgeOptions": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/Stateful", "dojo/has", "../kernel"], function (E, q, A, w, m) {
                                E = E([A], { declaredClass: "esri.layers.PurgeOptions", constructor: function (v, r) { this.parent = v; for (var l in r) this[l] = r[l] }, _displayCountSetter: function (v) { this.displayCount = v; this.parent.refresh() } }); w("extend-esri") && q.setObject("layers.PurgeOptions",
                                        E, m); return E
                        })
                }, "esri/layers/ArcGISImageServiceLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "), function (E, q, A, w, m, v, r) {
                                E = E([v, r], {
                                        declaredClass: "esri.layers.ArcGISImageServiceLayer", constructor: function (l, k) { this._initialize(l, k); this.useMapImage = k && k.useMapImage || !1 }, refresh: function (l) {
                                                if (!0 === l) this.inherited(arguments); else {
                                                        var k = this.disableClientCaching; this.disableClientCaching = !0; this.inherited(arguments);
                                                        this.disableClientCaching = k
                                                }
                                        }, setRenderer: function (l, k) { this.renderer = l; this.onRendererChange(); k || this.refresh(!0) }, exportMapImage: function (l, k) { var n = m.defaults.map; l = q.mixin({ size: n.width + "," + n.height }, this._params, l ? l.toJson(this.normalization) : {}, { f: "json" }); delete l._ts; this._exportMapImage(this._url.path + "/exportImage", l, k) }
                                }); A("extend-esri") && q.setObject("layers.ArcGISImageServiceLayer", E, w); return E
                        })
                }, "esri/layers/ArcGISImageServiceVectorLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/json dojo/sniff ../kernel ../lang ./GraphicsLayer ./ImageServiceLayerMixin ./pixelFilters/VectorFieldPixelFilter ../renderers/VectorFieldRenderer ../geometry/Point ../geometry/Extent ../graphic dojox/gfx".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                        E = E([l, k], {
                                                declaredClass: "esri.layers.ArcGISImageServiceVectorLayer", constructor: function (a, f) {
                                                        this.symbolTileSize = f && f.symbolTileSize ? f.symbolTileSize : 50; this._maxMag = this._minMag = null; var h = q.clone(this._params); delete h.imageServiceParameters; delete h.pixelFilter; delete h.rendererStyle; delete h.symbolTileSize; this._initialize(a, f); this.renderer || this.setVectorRendererStyle(f && f.rendererStyle ? f.rendererStyle : d.STYLE_SINGLE_ARROW); this.geometryType = "esriGeometryPoint";
                                                        this.symbolTileSizeUnits = "Pixels"; q.mixin(this._params, h)
                                                }, getField: function (a) { return this._getField(a, !0) }, setVectorRendererStyle: function (a) { this.rendererStyle = a; this._updateVectorFieldRenderer(); this.useDefaultRenderer = !0 }, setRenderer: function (a) { a && (this.vectorFieldPixelFilter = this.vectorFieldPixelFilter || new n, this.vectorFieldPixelFilter.setUnits(a.inputUnit, a.outputUnit)); this.useDefaultRenderer = !1; this.inherited(arguments) }, getFlowRepresentation: function () {
                                                        return this.renderer && this.renderer.flowRepresentation ||
                                                                this._vectorFlowRepresentation
                                                }, onResume: function () { this.inherited(arguments); this._toggleTime() }, onSuspend: function () { this.inherited(arguments); this._toggleTime() }, _fixSymbolTileSize: function () { this.renderer && (this.renderer.symbolTileSize ? this.symbolTileSize = this.renderer.symbolTileSize : this.renderer.symbolTileSize = this.symbolTileSize) }, _refresh: function (a) {
                                                        if (10 > m("ie")) this.onError(Error("Unable to refresh. This layer is not supported in the current browser.")); else if (this._map) {
                                                                this._fixSymbolTileSize();
                                                                this.setImageFormat("LERC", !0); a = this.fullExtent && this.fullExtent.xmin; var f = this.fullExtent && this.fullExtent.ymax, h = q.clone(this._map.extent), p = 1 / this.symbolTileSize * this._map.width; p = p ? Math.ceil(p) : 50; var B = 1 / this.symbolTileSize * this._map.height; B = B ? Math.ceil(B) : Math.ceil((h.ymax - h.ymin) / (h.xmax - h.xmin) * p); var t = (h.xmax - h.xmin) / p, u = (h.ymax - h.ymin) / B; h.xmin = a + Math.floor((h.xmin - a) / t) * t; h.xmax = a + Math.ceil((h.xmax - a) / t) * t; h.ymin = f + Math.floor((h.ymin - f) / u) * u; h.ymax = f + Math.ceil((h.ymax - f) / u) * u; this._requestData(h,
                                                                        p, B)
                                                        }
                                                }, _drawPixelData: function () {
                                                        this.clear(); if (this.pixelData) {
                                                                var a = this.pixelData.pixelBlock, f = this.pixelData.extent, h = this.pixelData.locations, p = r.isDefined(a.mask) && 0 < a.mask.length; if (a && f && h) {
                                                                        if (this.useDefaultRenderer && this.renderer && (!r.isDefined(this._minMag) || !r.isDefined(this._maxMag))) {
                                                                                var B = this._getServiceMinMaxStats(); B ? (this._minMag = B.min, this._maxMag = B.max) : (this._minMag = a.statistics[0].minValue, this._maxMag = a.statistics[0].maxValue); B = {
                                                                                        type: "sizeInfo", minSize: e.px2pt(.2 * this.symbolTileSize),
                                                                                        maxSize: e.px2pt(.8 * this.symbolTileSize), minDataValue: this._minMag, maxDataValue: this._maxMag
                                                                                }; var t = []; t.push(B); t.push({ type: "colorInfo" }); this.renderer.setVisualVariables(t)
                                                                        } var u = t = B = 0, z = f.spatialReference ? f.spatialReference._getInfo() : null; for (B = 0; B < a.height; B++)for (t = 0; t < a.width; t++, u++) {
                                                                                var x = h[u]; if ((!p || a.mask[u]) && x && 2 === x.length) {
                                                                                        x = new c(x[0], x[1], f.spatialReference); z && (x.x = g.prototype._normalizeX(x.x, z).x); var y = { Magnitude: a.pixels[0][u], Direction: a.pixels[1][u], Location: w.toJson(x.toJson()) };
                                                                                        x = new b(x, null, y); this.add(x)
                                                                                }
                                                                        }
                                                                }
                                                        }
                                                }, _getServiceMinMaxStats: function () {
                                                        if (!r.isDefined(this.minValues) || !r.isDefined(this.maxValues) || 2 > this.minValues.length || 2 > this.maxValues.length) return null; var a = this.minValues[0], f = this.maxValues[0], h = this.minValues[1], p = this.maxValues[1]; if (this.pixelFilter && a && f && h && p) { var B = []; B.push([a, f]); B.push([h, p]); h = this._createPixelData(B); this.pixelFilter(h); h && h.pixelBlock && h.pixelBlock.pixels && 0 < h.pixelBlock.pixels.length && (a = h.pixelBlock.pixels[0][0], f = h.pixelBlock.pixels[0][1]) } return a &&
                                                                f ? { min: a, max: f } : null
                                                }, _updateVectorFieldRenderer: function () { var a = { type: "sizeInfo", minSize: e.px2pt(.2 * this.symbolTileSize), maxSize: e.px2pt(.8 * this.symbolTileSize), minDataValue: this._minMag, maxDataValue: this._maxMag }, f = []; f.push(a); a = new d({ style: this.rendererStyle, visualVariables: f, flowRepresentation: this._vectorFlowRepresentation }); this.setRenderer(a) }, _getField: function (a, f) {
                                                        if (r.isDefined(a)) return f && (a = a.toLowerCase()), "magnitude" !== a && "direction" !== a ? null : {
                                                                name: a, alias: a, domain: null, editable: !1,
                                                                length: 50, type: "esriFieldTypeDouble"
                                                        }
                                                }, _requestDataErrorHandler: function (a) { "CancelError" !== a.name && (this.clear(), this.onError(a)) }, _setFlowRepresentation: function (a) {
                                                        this.renderer && this.renderer.flowRepresentation ? this._vectorFlowRepresentation = this.renderer.flowRepresentation : a && this.renderer && r.isDefined(a.FlowDirection) && a.FlowDirection && (this._vectorFlowRepresentation = "oceanographic" === a.FlowDirection.toLowerCase() ? this.renderer.FLOW_TO : this.renderer.FLOW_FROM); this.renderer && (this.renderer.flowRepresentation =
                                                                this._vectorFlowRepresentation)
                                                }
                                        }); m("extend-esri") && q.setObject("layers.ArcGISImageServiceVectorLayer", E, v); return E
                                })
                }, "jimu/LayerInfos/LayerInfoForDefaultDynamicShipFeatureLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/Deferred esri/layers/FeatureLayer esri/tasks/query ./LayerInfoForDefaultDynamic".split(" "), function (E, q, A, w, m, v) {
                                return E(v, {
                                        _msShipFeatureLayerId: null, _msOwnedFeatureLayerDef: null, _msOwnedLayerInfo: null, constructor: function (r, l) { this._msShipFeatureLayerId = r.msShipFLayerId },
                                        _initAfterRootLayerInfo: function () { var r = this.map.getLayer(this._msShipFeatureLayerId); r && this._initPopupInfo(r) }, _initPopupInfo: function (r) { var l = this.originOperLayer.mapService.layerInfo, k = this.originOperLayer.mapService.subId; r && (r.infoTemplate ? (l.controlPopupInfo.infoTemplates[k] = { infoTemplate: r.infoTemplate, layerUrl: this.getUrl() }, this.enablePopup()) : (l.controlPopupInfo.infoTemplates[k] = { infoTemplate: null, layerUrl: this.getUrl() }, this.disablePopup())) }, _initMSOwnedFeatureLayer: function () {
                                                var r =
                                                        this.map.getLayer(this.id), l = this.map.getLayer(this._msShipFeatureLayerId); if (l && !r) { this._msOwnedFeatureLayerDef = new A; r = new w(l.url, q.mixin({}, l)); r.id = this.id; r.visible = this.isShowInMap(); q.setObject("_wabProperties.isMSOwnedFeatureLayer", !0, r); this.map.addLayer(r); this._initMsOwnedLayerInfo(r); var k = r.on("load", q.hitch(this, function () { this.layerObject = r; this._msOwnedFeatureLayerDef.resolve(r); k.remove && k.remove() })) }
                                        }, _initMsOwnedLayerInfo: function (r) {
                                                this._msOwnedLayerInfo = this._layerInfoFactory.create({
                                                        layerObject: r,
                                                        title: this.title + "_owned_", id: r.id
                                                }, this.map)
                                        }, _msShipIsValid: function () { var r = this.map.getLayer(this._msShipFeatureLayerId), l = this.map.getLayer(this.id); return r && l }, getMSShipFeatures: function (r) { var l = new A, k = this.map.getLayer(this._msShipFeatureLayerId); if (r && k) { var n = new m; n.objectIds = r.map(q.hitch(this, function (d) { return d.attributes[k.objectIdField] })); k.queryFeatures(n, q.hitch(this, function (d) { l.resolve(d.features) }), q.hitch(this, function () { l.resolve(null) })) } else l.resolve(null); return l }
                                })
                        })
                },
                "jimu/LayerInfos/LayerInfoForDefaultTile": function () { define(["dojo/_base/declare", "./LayerInfoForDefaultService"], function (E, q) { return E(q, { constructor: function (A, w) { this.isTiled = !0 }, _initVisible: function () { }, _setTopLayerVisible: function (A) { }, setLayerVisiblefromTopLayer: function () { }, getOpacity: function () { }, setOpacity: function (A) { }, isShowInMap: function () { return this.originOperLayer.mapService.layerInfo.layerObject.visible } }) }) }, "jimu/LayerInfos/LayerInfoForDefaultTable": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred dojo/aspect ./LayerInfoForDefault ./LayerObjectFacory esri/dijit/PopupTemplate".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        return E(v, {
                                                _layerObjectFacory: null, constructor: function () { this.newSubLayers = []; this.isTable = !0; this._layerObjectFacory = new r(this) }, init: function () { }, _getLayerObject: function () { var k = new w; this._layerObjectFacory.getLayerObject().then(q.hitch(this, function (n) { this.layerObject.empty && n && (this.layerObject = n, this._bindEventAfterLayerObjectLoaded()); k.resolve(n) })); return k }, getLayerObject: function () { return this._getLayerObject() }, getPopupInfoFromLayerObject: function () {
                                                        var k =
                                                                this.getPopupInfo(); k || !this.layerObject || this.layerObject.empty || (k = this._getDefaultPopupInfo(this.layerObject)); return k
                                                }, loadPopupInfo: function () { var k = new w, n = this.getPopupInfo(); n ? k.resolve(n) : this.getLayerObject().then(q.hitch(this, function () { n = this._getDefaultPopupInfo(this.layerObject); k.resolve(n) })); return k }, getLayerType: function () { var k = new w; k.resolve("Table"); return k }, isVisible: function () { return !1 }, isLeaf: function () { return !0 }, isRootLayer: function () { return !1 }, createLegendsNode: function () {
                                                        return A.create("div",
                                                                { "class": "legends-div" })
                                                }, _initControlPopup: function () { this.inherited(arguments); this.controlPopupInfo = { enablePopup: this.originOperLayer.popupInfo ? !0 : !1, infoTemplate: this.originOperLayer.popupInfo ? new l(this.originOperLayer.popupInfo) : null } }, _bindEventAfterLayerObjectLoaded: function () { var k = m.after(this.layerObject, "setDefinitionExpression", q.hitch(this, this._onFilterChanged)); this._eventHandles.push(k) }, getFilter: function () {
                                                        if (this.layerObject && !this.layerObject.empty && this.layerObject.getDefinitionExpression) {
                                                                var k =
                                                                        this.layerObject.getDefinitionExpression(); void 0 === k && (k = this.getFilterOfWebmap())
                                                        } else k = this.getFilterOfWebmap(); return k
                                                }
                                        })
                                })
                }, "jimu/LayerInfos/LayerInfoForDefaultImage": function () {
                        define("dojo/_base/declare dojo/dom-construct dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/aspect esri/request ./LayerInfoForDefault ../utils".split(" "), function (E, q, A, w, m, v, r, l, k, n) {
                                return E(k, {
                                        constructor: function () { this._addImageServiceLayerType() }, _addImageServiceLayerType: function () {
                                                this.layerObject.type =
                                                !this.layerObject.serviceDataType || "esriImageServiceDataTypeVector-UV" !== this.layerObject.serviceDataType && "esriImageServiceDataTypeVector-MagDir" !== this.layerObject.serviceDataType ? "ArcGISImageServiceLayer" : "ArcGISImageServiceVectorLayer"
                                        }, _initLegendsNode: function (d) {
                                                10.2 <= this.layerObject.version ? this._legendRequestServer().then(w.hitch(this, function (c) {
                                                        q.empty(d); A.forEach(c.layers, function (g) {
                                                                A.forEach(g.legend, function (b) {
                                                                        if ("\x3call other values\x3e" !== b.label) {
                                                                                var e = q.create("div", { "class": "legend-div" },
                                                                                        d), a = q.create("div", { "class": "legend-symbol jimu-float-leading", style: "width:50px;height:50px;position:relative" }, e), f = null; f = b.imageData ? "data:" + b.contentType + ";base64," + b.imageData : b.url; q.create("img", { "class": "legend-symbol-image", style: "overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0", src: f }, a); q.create("div", { "class": "legend-label jimu-float-leading", innerHTML: n.sanitizeHTML(b.label) || " " }, e)
                                                                        }
                                                                }, this)
                                                        }, this)
                                                }), w.hitch(this, function () { q.empty(d) })) : q.empty(d)
                                        }, _legendRequestServer: function () {
                                                var d =
                                                        this.layerObject.url + "/legend", c = { f: "json" }; this.layerObject._params.bandIds && (c.bandIds = this.layerObject._params.bandIds); this.layerObject._params.renderingRule && (c.renderingRule = this.layerObject._params.renderingRule); return l({ url: d, content: c, handleAs: "json", callbackParamName: "callback" })
                                        }, getSupportTableInfo: function () {
                                                var d = new m, c = { isSupportedLayer: !1, isSupportQuery: !1, layerType: null }, g = this.getLayerType(), b = this.getLayerObject(); v({ type: g, layerObject: b }).then(w.hitch(this, function (e) {
                                                        var a =
                                                                e.type; e = e.layerObject; c.layerType = a; 0 <= this._getLayerTypesOfSupportTable().indexOf(a) && (c.isSupportedLayer = !0); e.capabilities && 0 <= e.capabilities.indexOf("Catalog") ? c.isSupportQuery = !0 : c.isSupportedLayer = !1; d.resolve(c)
                                                }), function () { d.resolve(c) }); return d
                                        }, _getServiceDefinition: function () { var d = this.getUrl(); return this._serviceDefinitionBuffer.getRequest(this.subId).request(d) }, _bindEvent: function () {
                                                this.inherited(arguments); if (this.layerObject && !this.layerObject.empty) {
                                                        var d = r.after(this.layerObject,
                                                                "setRenderingRule", w.hitch(this, this._onRendererChanged)); this._eventHandles.push(d)
                                                }
                                        }
                                })
                        })
                }, "jimu/LayerInfos/LayerInfoForDefaultStream": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/Deferred", "dojo/promise/all", "./LayerInfoForDefault"], function (E, q, A, w, m) {
                                return E(m, {
                                        getSupportTableInfo: function () {
                                                var v = new A, r = { isSupportedLayer: !1, isSupportQuery: !0, layerType: null, otherReasonCanNotSupport: !0 }, l = this.getLayerType(), k = this.getLayerObject(); w({ type: l, layerObject: k }).then(q.hitch(this,
                                                        function (n) { var d = n.type; n = n.layerObject; r.layerType = d; 0 <= this._getLayerTypesOfSupportTable().indexOf(d) && (r.isSupportedLayer = !0); (d = n.getLatestObservations()) && 0 < d.length && (r.otherReasonCanNotSupport = !1); v.resolve(r) }), function () { v.resolve(r) }); return v
                                        }
                                })
                        })
                }, "jimu/LayerInfos/LayerInfoForDefaultKML": function () {
                        define(["dojo/_base/declare", "dojo/_base/array", "dojo/dom-construct", "./LayerInfoForDefault"], function (E, q, A, w) {
                                return E(w, {
                                        constructor: function (m, v) { this.layerObject = m.layerObject }, _resetLayerObjectVisiblity: function () { },
                                        _initVisible: function () { var m = this.originOperLayer.kml, v = m.layerInfo.originOperLayer.visibleFolders; m.layerInfo.isRootLayer() && v ? -1 < v.indexOf(this.subId) ? this._visible = !0 : this._visible = !1 : this._visible = this.originOperLayer.kml.currentFolder.visible }, _setTopLayerVisible: function (m) { var v = this.originOperLayer.kml.currentFolder; this._visible = m; this.originOperLayer.kml.layerInfo.layerObject.setFolderVisibility(v, m) }, obtainNewSubLayers: function () {
                                                var m = [], v = this.originOperLayer.kml; v.currentFolder && q.forEach(v.layerInfo._getOperLayerByParentFolderId(v.currentFolder.id,
                                                        this), function (r) { r = this._layerInfoFactory.create(r); m.push(r); r.init() }, this); return m
                                        }, getOpacity: function () { }, setOpacity: function (m) { }, drawLegends: function (m) { A.empty(m) }, _bindEvent: function () { }, _onVisibleLayersChanged: function () { }, getScaleRange: function () { return this.getRootLayerInfo().getScaleRange() }
                                })
                        })
                }, "libs/crc": function () {
                        (function () {
                                var E = "object" === typeof window ? window : {}; !E.JS_CRC_NO_NODE_JS && "object" === typeof process && process.versions && process.versions.node && (E = global); var q = !E.JS_CRC_NO_COMMON_JS &&
                                        "object" === typeof module && module.exports, A = "function" === typeof define && define.amd, w = !E.JS_CRC_NO_ARRAY_BUFFER && "undefined" !== typeof ArrayBuffer, m = "0123456789abcdef".split(""), v = [{ name: "crc32", polynom: 3988292384, initValue: -1, bytes: 4 }, { name: "crc16", polynom: 40961, initValue: 0, bytes: 2 }, { name: "crc24", polynom: 720895, initValue: 1, bytes: 3 }], r, l, k; for (r = 0; r < v.length; ++r) {
                                                var n = v[r]; n.method = function (g) {
                                                        return function (b) {
                                                                var e = b, a = "string" !== typeof e; a && w && e instanceof ArrayBuffer && (e = new Uint8Array(e)); b = g.initValue;
                                                                var f, h = e.length, p = g.table; if (a) for (f = 0; f < h; ++f)b = p[(b ^ e[f]) & 255] ^ b >>> 8; else for (f = 0; f < h; ++f)a = e.charCodeAt(f), 128 > a ? b = p[(b ^ a) & 255] ^ b >>> 8 : (2048 > a ? b = p[(b ^ (192 | a >> 6)) & 255] ^ b >>> 8 : (55296 > a || 57344 <= a ? b = p[(b ^ (224 | a >> 12)) & 255] ^ b >>> 8 : (a = 65536 + ((a & 1023) << 10 | e.charCodeAt(++f) & 1023), b = p[(b ^ (240 | a >> 18)) & 255] ^ b >>> 8, b = p[(b ^ (128 | a >> 12 & 63)) & 255] ^ b >>> 8), b = p[(b ^ (128 | a >> 6 & 63)) & 255] ^ b >>> 8), b = p[(b ^ (128 | a & 63)) & 255] ^ b >>> 8); b ^= g.initValue; e = ""; 3 < g.bytes ? e += m[b >> 28 & 15] + m[b >> 24 & 15] + m[b >> 20 & 15] + m[b >> 16 & 15] : 2 < g.bytes && (e += m[b >>
                                                                        20 & 15] + m[b >> 16 & 15]); return e += m[b >> 12 & 15] + m[b >> 8 & 15] + m[b >> 4 & 15] + m[b & 15]
                                                        }
                                                }(n); n.table = []; for (l = 0; 256 > l; ++l) { var d = l; for (k = 0; 8 > k; ++k)d = d & 1 ? n.polynom ^ d >>> 1 : d >>> 1; n.table[l] = d >>> 0 }
                                        } var c = {}; for (r = 0; r < v.length; ++r)n = v[r], c[n.name] = n.method; if (q) module.exports = c; else { for (r = 0; r < v.length; ++r)n = v[r], E[n.name] = n.method; A && define(function () { return c }) }
                        })()
                }, "jimu/filterUtils": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale dojo/number esri/lang dojo/data/ItemFileWriteStore jimu/utils moment/moment".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        var n = E([], {
                                                _stringFieldType: "esriFieldTypeString", _dateFieldType: "esriFieldTypeDate", _numberFieldTypes: ["esriFieldTypeOID", "esriFieldTypeSmallInteger", "esriFieldTypeInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"], _supportFieldTypes: [], dayInMS: 864E5, HourInMS: 36E5, MinuteInMS: 6E4, SecInMS: 1E3, fieldsStore: null, isHosted: !1, constructor: function () {
                                                        String.prototype.startsWith = function (d) { return 0 === this.indexOf(d) }; String.prototype.endsWith = function (d) {
                                                                return this.substring(this.length -
                                                                        d.length) === d
                                                        }; String.prototype.count = function (d) { return this.split(d).length - 1 }; String.prototype.trim || (String.prototype.trim = q.trim); this._supportFieldTypes = []; this._supportFieldTypes.push(this._stringFieldType); this._supportFieldTypes.push(this._dateFieldType); this._supportFieldTypes = this._supportFieldTypes.concat(this._numberFieldTypes); this.filterBuilderNls = window.jimuNls.filterBuilder
                                                }, OPERATORS: {
                                                        stringOperatorIs: "stringOperatorIs", stringOperatorIsNot: "stringOperatorIsNot", stringOperatorStartsWith: "stringOperatorStartsWith",
                                                        stringOperatorEndsWith: "stringOperatorEndsWith", stringOperatorContains: "stringOperatorContains", stringOperatorDoesNotContain: "stringOperatorDoesNotContain", stringOperatorIsAnyOf: "stringOperatorIsAnyOf", stringOperatorIsNoneOf: "stringOperatorIsNoneOf", stringOperatorIsBlank: "stringOperatorIsBlank", stringOperatorIsNotBlank: "stringOperatorIsNotBlank", numberOperatorIs: "numberOperatorIs", numberOperatorIsNot: "numberOperatorIsNot", numberOperatorIsAtLeast: "numberOperatorIsAtLeast", numberOperatorIsLessThan: "numberOperatorIsLessThan",
                                                        numberOperatorIsAtMost: "numberOperatorIsAtMost", numberOperatorIsGreaterThan: "numberOperatorIsGreaterThan", numberOperatorIsBetween: "numberOperatorIsBetween", numberOperatorIsNotBetween: "numberOperatorIsNotBetween", numberOperatorIsAnyOf: "numberOperatorIsAnyOf", numberOperatorIsNoneOf: "numberOperatorIsNoneOf", numberOperatorIsBlank: "numberOperatorIsBlank", numberOperatorIsNotBlank: "numberOperatorIsNotBlank", dateOperatorIsOn: "dateOperatorIsOn", dateOperatorIsNotOn: "dateOperatorIsNotOn", dateOperatorIsBefore: "dateOperatorIsBefore",
                                                        dateOperatorIsAfter: "dateOperatorIsAfter", dateOperatorIsOnOrBefore: "dateOperatorIsOnOrBefore", dateOperatorIsOnOrAfter: "dateOperatorIsOnOrAfter", dateOperatorIsBetween: "dateOperatorIsBetween", dateOperatorIsNotBetween: "dateOperatorIsNotBetween", dateOperatorIsBlank: "dateOperatorIsBlank", dateOperatorIsNotBlank: "dateOperatorIsNotBlank", dateOperatorInTheLast: "dateOperatorInTheLast", dateOperatorNotInTheLast: "dateOperatorNotInTheLast", dateOperatorIsIn: "dateOperatorIsIn", dateOperatorIsNotIn: "dateOperatorIsNotIn",
                                                        dateOperatorMinutes: "dateOperatorMinutes", dateOperatorHours: "dateOperatorHours", dateOperatorDays: "dateOperatorDays", dateOperatorWeeks: "dateOperatorWeeks", dateOperatorMonths: "dateOperatorMonths", dateOperatorYears: "dateOperatorYears"
                                                }, prepare: function (d, c) { this.isHosted = l.isHostedService(d); c = c || []; this.setFieldsStoreByFieldInfos(c) }, isPartsObjHasError: function (d) {
                                                        var c = !1; d && (c = d.parts && 0 <= d.parts.length ? A.every(d.parts, q.hitch(this, function (g) {
                                                                return g.parts ? 0 < g.parts.length ? A.every(g.parts, q.hitch(this,
                                                                        function (b) { return !b.error })) : !1 : !g.error
                                                        })) : !1); return !c
                                                }, isAskForValues: function (d) { return n.isAskForValues(d) }, hasVirtualDate: function (d) { return n.hasVirtualDate(d) }, setFieldsStoreByFieldInfos: function (d) {
                                                        d = A.filter(d, q.hitch(this, function (c) { return 0 <= this._supportFieldTypes.indexOf(c.type) })); d = A.map(d, function (c, g) {
                                                                switch (c.type) { case "esriFieldTypeString": var b = "string"; break; case "esriFieldTypeDate": b = "date"; break; default: b = "number" }return {
                                                                        id: g, label: c.name, shortType: b, alias: c.alias, editable: c.editable,
                                                                        name: c.name, nullable: c.nullable, type: c.type
                                                                }
                                                        }, this); this.fieldsStore = new r({ data: { identifier: "id", label: "label", items: d } }); return d.length
                                                }, _validatePartsObj: function (d) { return d && "object" === typeof d }, _isObject: function (d) { return d && "object" === typeof d }, _isString: function (d) { return d && "string" === typeof d }, containsNonLatinCharacter: function (d) { for (var c = 0; c < d.length; c++)if (255 < d.charCodeAt(c)) return !0; return !1 }, isBigDataLayer: function (d) {
                                                        return !!d.url && -1 !== d.url.indexOf("BigDataCatalogServer") && ("featureClass" ===
                                                                d.type || "table" === d.type)
                                                }, useStandardizedQueries: function (d) { return d ? 10.2 <= d.version && (d.useStandardizedQueries || this.isBigDataLayer(d)) : !this.isHosted }, getExprByFilterObj: function (d) {
                                                        if (!A.every(d.parts, function (h) { return !!h })) return null; if (!this.isPartsObjReadyToBuild(d)) return d.expr = "", d.displaySQL = "", d.expr; this._handleVirtualDate(d); var c = "", g = "", b; if (0 === d.parts.length) g = c = "1\x3d1"; else if (1 === d.parts.length) {
                                                                var e = d.parts[0]; e.valueObj && q.isArray(e.valueObj.value) && "multiple" !== e.valueObj.type ?
                                                                        (b = this._checkIfValObjArrayAndChecked(e.valueObj.value)) ? (c = this.builtFilterString(e), g = e.displaySQL) : g = c = "1\x3d1" : (c = this.builtFilterString(e), g = e.displaySQL)
                                                        } else for (var a = "", f = 0; f < d.parts.length; f++) {
                                                                e = d.parts[f]; e.valueObj && q.isArray(e.valueObj.value) && "multiple" !== e.valueObj.type ? (b = this._checkIfValObjArrayAndChecked(e.valueObj.value)) ? (b = this.builtFilterString(e), e = e.displaySQL) : e = b = "1\x3d1" : (b = this.builtFilterString(e), e = e.displaySQL); if (!v.isDefined(b)) return null; c += a + "(" + b + ")"; g += a + "(" +
                                                                        e + ")"; a = a || " " + d.logicalOperator + " "
                                                        } d.expr = c; d.displaySQL = g; return c
                                                }, _checkIfValObjArrayAndChecked: function (d) { var c = !1, g; for (g in d) if (d[g].isChecked) { c = !0; break } return c }, _handleVirtualDate: function (d) { this.hasVirtualDate(d) && A.forEach(d.parts, q.hitch(this, function (c) { c.parts ? A.forEach(c.parts, q.hitch(this, function (g) { this._updateRealDateByVirtualDate(g) })) : this._updateRealDateByVirtualDate(c) })) }, _updateRealDateByVirtualDate: function (d) {
                                                        var c = [this.OPERATORS.dateOperatorIsOn, this.OPERATORS.dateOperatorIsNotOn,
                                                        this.OPERATORS.dateOperatorIsBefore, this.OPERATORS.dateOperatorIsAfter, this.OPERATORS.dateOperatorIsOnOrBefore, this.OPERATORS.dateOperatorIsOnOrAfter]; d.valueObj.virtualDate ? d.operator === this.OPERATORS.dateOperatorIsIn || d.operator === this.OPERATORS.dateOperatorIsNotIn ? (c = n.getRealDateByVirtualDate(d.valueObj.virtualDate), d.value1 = c[0], d.value2 = c[1], d.valueObj.value1 = l.getDateTimeStr(c[0]), d.valueObj.value2 = l.getDateTimeStr(c[1])) : -1 < c.indexOf(d.operator) && (c = n.getRealDateByVirtualDate(d.valueObj.virtualDate),
                                                                d.value = c, d.valueObj.value = l.getDateTimeStr(c)) : (d.valueObj.virtualDate1 && (c = n.getRealDateByVirtualDate(d.valueObj.virtualDate1), d.value1 = c, d.valueObj.value1 = l.getDateTimeStr(c)), d.valueObj.virtualDate2 && (c = n.getRealDateByVirtualDate(d.valueObj.virtualDate2), d.value2 = c, d.valueObj.value2 = l.getDateTimeStr(c)))
                                                }, isPartsObjReadyToBuild: function (d) { return A.every(d.parts, q.hitch(this, function (c) { return c.parts ? A.every(c.parts, q.hitch(this, function (g) { return this._isPartReadyToBuild(g) })) : this._isPartReadyToBuild(c) })) },
                                                _isPartReadyToBuild: function (d) {
                                                        var c = d.fieldObj.shortType, g = d.operator, b = d.valueObj; d = b.type || "value"; var e = b.value, a = b.value1; b = b.value2; if ("value" === d) {
                                                                if ("string" === c) return g === this.OPERATORS.stringOperatorIsBlank || g === this.OPERATORS.stringOperatorIsNotBlank ? !0 : l.isNotEmptyString(e); if ("number" === c) return g === this.OPERATORS.numberOperatorIsBlank || g === this.OPERATORS.numberOperatorIsNotBlank ? !0 : g === this.OPERATORS.numberOperatorIsBetween || g === this.OPERATORS.numberOperatorIsNotBetween ? l.isValidNumber(a) &&
                                                                        l.isValidNumber(b) : l.isValidNumber(e); if ("date" === c) return g === this.OPERATORS.dateOperatorIsBlank || g === this.OPERATORS.dateOperatorIsNotBlank ? !0 : g === this.OPERATORS.dateOperatorIsBetween || g === this.OPERATORS.dateOperatorIsNotBetween || g === this.OPERATORS.dateOperatorIsIn || g === this.OPERATORS.dateOperatorIsNotIn ? l.isNotEmptyString(a) && l.isNotEmptyString(b) : g === this.OPERATORS.dateOperatorInTheLast || g === this.OPERATORS.dateOperatorNotInTheLast ? void 0 !== e && null !== e : l.isNotEmptyString(e)
                                                        } else {
                                                                if ("field" === d) return l.isNotEmptyString(e);
                                                                if ("unique" === d) { if ("string" === c) return l.isNotEmptyString(e); if ("number" === c) return l.isValidNumber(e); if ("date" === c) return l.isValidDate(e) } else if ("multiple" === d) { if ("string" === c) return l.isNotEmptyStringArray(e); if ("number" === c) return l.isValidNumberArray(e) } else if ("values" !== d && ("uniquePredefined" === d || "multiplePredefined" === d)) { if ("string" === c) return l.isNotEmptyStringArray(e); if ("number" === c) return l.isValidNumberArray(e) }
                                                        } return !1
                                                }, builtFilterString: function (d) {
                                                        var c = "", g = ""; if (d.parts) for (var b =
                                                                "", e = 0; e < d.parts.length; e++) { var a = d.parts[e], f = this.builtSingleFilterString(a); a.expr = f.whereClause; if (!v.isDefined(f.whereClause)) return null; c += b + f.whereClause; g += b + a.displaySQL; b = " " + d.logicalOperator + " " } else d && d.valueObj && "multiple" === d.valueObj.type && 0 === d.valueObj.value.length ? c = g = "1\x3d1" : (c = this.builtSingleFilterString(d).whereClause, g = d.displaySQL); d.expr = c; d.displaySQL = g; return c
                                                }, _preBuiltSingleFilterString: function (d) {
                                                        if ("string" === d.fieldObj.shortType && "\x3cNull\x3e" === d.valueObj.value) {
                                                                if (d.operator ===
                                                                        this.OPERATORS.stringOperatorIs) return { whereClause: d.fieldObj.name + " IS NULL" }; if (d.operator === this.OPERATORS.stringOperatorIsNot) return { whereClause: d.fieldObj.name + " IS NOT NULL" }
                                                        } if ("number" === d.fieldObj.shortType && "\x3cNull\x3e" === d.valueObj.value) { if (d.operator === this.OPERATORS.numberOperatorIs) return { whereClause: d.fieldObj.name + " IS NULL" }; if (d.operator === this.OPERATORS.numberOperatorIsNot) return { whereClause: d.fieldObj.name + " IS NOT NULL" } } return null
                                                }, _handlePrefixStringsForIn: function (d, c) {
                                                        for (var g =
                                                                [], b = 0; b < d.length; b++) { var e = d[b]; e = e.replace(/'/g, "''"); var a = this.isHosted && this.containsNonLatinCharacter(e) ? "N" : ""; e = c || this.isHosted ? e : e.toLowerCase(); e = "" + a + "'" + e + "'"; g.push(e) } return g.join(",")
                                                }, builtSingleFilterString: function (d) {
                                                        this.isHosted && (d.caseSensitive = !1); if (v.isDefined(d.valueObj.isValid) && !d.valueObj.isValid) return { whereClause: null }; var c = this._preBuiltSingleFilterString(d); if (c) return c; c = d.valueObj.value; var g = d.valueObj.value1, b = d.valueObj.value2, e = "", a = "", f = []; if ("string" ===
                                                                d.fieldObj.shortType) {
                                                                        g = ""; c && "field" !== d.valueObj.type && this.isHosted && !q.isArray(c) && this.containsNonLatinCharacter(c) && (g = "N"); !c || "multiplePredefined" !== d.valueObj.type && "uniquePredefined" !== d.valueObj.type || (f = [], A.forEach(c, q.hitch(this, function (t) { t.isChecked && f.push(t.value) })), d.operator === this.OPERATORS.stringOperatorIs || d.operator === this.OPERATORS.stringOperatorIsNot ? (c = f[0], this.isHosted && this.containsNonLatinCharacter(c) && (g = "N")) : c = f); var h = []; switch (d.operator) {
                                                                                case this.OPERATORS.stringOperatorIs: e =
                                                                                        "field" === d.valueObj.type ? d.fieldObj.name + " \x3d " + c : d.caseSensitive || this.isHosted ? d.fieldObj.name + " \x3d " + g + "'" + c.replace(/'/g, "''") + "'" : "LOWER(" + d.fieldObj.name + ") \x3d " + g + "'" + c.replace(/'/g, "''").toLowerCase() + "'"; break; case this.OPERATORS.stringOperatorIsNot: e = "field" === d.valueObj.type ? d.fieldObj.name + " \x3c\x3e " + c : d.caseSensitive || this.isHosted ? d.fieldObj.name + " \x3c\x3e " + g + "'" + c.replace(/'/g, "''") + "'" : "LOWER(" + d.fieldObj.name + ") \x3c\x3e " + g + "'" + c.replace(/'/g, "''").toLowerCase() + "'"; break;
                                                                                case this.OPERATORS.stringOperatorStartsWith: h = []; "multiplePredefined" === d.valueObj.type || "uniquePredefined" === d.valueObj.type ? (A.forEach(c, q.hitch(this, function (t) { var u = this.isHosted && this.containsNonLatinCharacter(t) ? "N" : ""; d.caseSensitive || this.isHosted ? h.push(d.fieldObj.name + " LIKE " + u + "'" + t.replace(/'/g, "''") + "%'") : h.push("LOWER(" + d.fieldObj.name + ") LIKE " + u + "'" + t.replace(/'/g, "''").toLowerCase() + "%'") })), e = "((" + h.join(") OR (") + "))") : e = d.caseSensitive || this.isHosted ? d.fieldObj.name + " LIKE " +
                                                                                        g + "'" + c.replace(/'/g, "''") + "%'" : "LOWER(" + d.fieldObj.name + ") LIKE " + g + "'" + c.replace(/'/g, "''").toLowerCase() + "%'"; break; case this.OPERATORS.stringOperatorEndsWith: h = []; "multiplePredefined" === d.valueObj.type || "uniquePredefined" === d.valueObj.type ? (A.forEach(c, q.hitch(this, function (t) {
                                                                                                var u = this.isHosted && this.containsNonLatinCharacter(t) ? "N" : ""; d.caseSensitive || this.isHosted ? h.push(d.fieldObj.name + " LIKE " + u + "'%" + t.replace(/'/g, "''") + "'") : h.push("LOWER(" + d.fieldObj.name + ") LIKE " + u + "'%" + t.replace(/'/g,
                                                                                                        "''").toLowerCase() + "'")
                                                                                        })), e = "((" + h.join(") OR (") + "))") : e = d.caseSensitive || this.isHosted ? d.fieldObj.name + " LIKE " + g + "'%" + c.replace(/'/g, "''") + "'" : "LOWER(" + d.fieldObj.name + ") LIKE " + g + "'%" + c.replace(/'/g, "''").toLowerCase() + "'"; break; case this.OPERATORS.stringOperatorContains: h = []; "multiplePredefined" === d.valueObj.type || "uniquePredefined" === d.valueObj.type ? (A.forEach(c, q.hitch(this, function (t) {
                                                                                                var u = this.isHosted && this.containsNonLatinCharacter(t) ? "N" : ""; d.caseSensitive || this.isHosted ? h.push(d.fieldObj.name +
                                                                                                        " LIKE " + u + "'%" + t.replace(/'/g, "''") + "%'") : h.push("LOWER(" + d.fieldObj.name + ") LIKE " + u + "'%" + t.replace(/'/g, "''").toLowerCase() + "%'")
                                                                                        })), e = "((" + h.join(") OR (") + "))") : e = d.caseSensitive || this.isHosted ? d.fieldObj.name + " LIKE " + g + "'%" + c.replace(/'/g, "''") + "%'" : "LOWER(" + d.fieldObj.name + ") LIKE " + g + "'%" + c.replace(/'/g, "''").toLowerCase() + "%'"; break; case this.OPERATORS.stringOperatorDoesNotContain: h = []; "multiplePredefined" === d.valueObj.type || "uniquePredefined" === d.valueObj.type ? (A.forEach(c, q.hitch(this,
                                                                                                function (t) { var u = this.isHosted && this.containsNonLatinCharacter(t) ? "N" : ""; d.caseSensitive || this.isHosted ? h.push(d.fieldObj.name + " NOT LIKE " + u + "'%" + t.replace(/'/g, "''") + "%'") : h.push("LOWER(" + d.fieldObj.name + ") NOT LIKE " + u + "'%" + t.replace(/'/g, "''").toLowerCase() + "%'") })), e = "((" + h.join(") AND (") + "))") : e = d.caseSensitive || this.isHosted ? d.fieldObj.name + " NOT LIKE " + g + "'%" + c.replace(/'/g, "''") + "%'" : "LOWER(" + d.fieldObj.name + ") NOT LIKE " + g + "'%" + c.replace(/'/g, "''").toLowerCase() + "%'"; break; case this.OPERATORS.stringOperatorIsAnyOf: c =
                                                                                                        this._handlePrefixStringsForIn(c, d.caseSensitive); e = d.caseSensitive || this.isHosted ? d.fieldObj.name + " IN (" + c + ")" : "LOWER(" + d.fieldObj.name + ") IN (" + c + ")"; break; case this.OPERATORS.stringOperatorIsNoneOf: c = this._handlePrefixStringsForIn(c, d.caseSensitive); e = d.caseSensitive || this.isHosted ? d.fieldObj.name + " NOT IN (" + c + ")" : "LOWER(" + d.fieldObj.name + ") NOT IN (" + c + ")"; break; case this.OPERATORS.stringOperatorIsBlank: e = d.fieldObj.name + " IS NULL"; break; case this.OPERATORS.stringOperatorIsNotBlank: e = d.fieldObj.name +
                                                                                                                " IS NOT NULL"
                                                                        }
                                                        } else if ("number" === d.fieldObj.shortType) switch (!c || "uniquePredefined" !== d.valueObj.type && "multiplePredefined" !== d.valueObj.type ? c && "multiple" === d.valueObj.type && (c = c.join(",")) : (f = [], A.forEach(c, q.hitch(this, function (t) { t.isChecked && f.push(t.value) })), c = f.join(",")), d.operator) {
                                                                case this.OPERATORS.numberOperatorIs: e = d.fieldObj.name + " \x3d " + c; break; case this.OPERATORS.numberOperatorIsNot: e = d.fieldObj.name + " \x3c\x3e " + c; break; case this.OPERATORS.numberOperatorIsAtLeast: e = d.fieldObj.name +
                                                                        " \x3e\x3d " + c; break; case this.OPERATORS.numberOperatorIsLessThan: e = d.fieldObj.name + " \x3c " + c; break; case this.OPERATORS.numberOperatorIsAtMost: e = d.fieldObj.name + " \x3c\x3d " + c; break; case this.OPERATORS.numberOperatorIsGreaterThan: e = d.fieldObj.name + " \x3e " + c; break; case this.OPERATORS.numberOperatorIsAnyOf: e = d.fieldObj.name + " IN (" + c + ")"; break; case this.OPERATORS.numberOperatorIsNoneOf: e = d.fieldObj.name + " NOT IN (" + c + ")"; break; case this.OPERATORS.numberOperatorIsBetween: e = d.fieldObj.name + " BETWEEN " +
                                                                                g + " AND " + b; break; case this.OPERATORS.numberOperatorIsNotBetween: e = d.fieldObj.name + " NOT BETWEEN " + g + " AND " + b; break; case this.OPERATORS.numberOperatorIsBlank: e = d.fieldObj.name + " IS NULL"; break; case this.OPERATORS.numberOperatorIsNotBlank: e = d.fieldObj.name + " IS NOT NULL"
                                                        } else {
                                                                a = d._useStandardizedQueries; "field" !== d.valueObj.type && (c && (c = l.getDateByDateTimeStr(c)), g && (g = l.getDateByDateTimeStr(g)), b && (b = l.getDateByDateTimeStr(b))); var p = d.valueObj.enableTime, B = d.valueObj.timeAccuracy; switch (d.operator) {
                                                                        case this.OPERATORS.dateOperatorIsOn: "field" ===
                                                                                d.valueObj.type ? e = d.fieldObj.name + " \x3d " + c : (e = "unique" === d.valueObj.type ? this._getEndDateByTimeForUnique(c, d.fieldObj.dateFormat) : this._getEndDateByTime(c, p, B), e = "(" + d.fieldObj.name + " BETWEEN " + (a ? "timestamp " : "") + "'" + this.formatDate(c) + "' AND " + (a ? "timestamp " : "") + "'" + e + "') AND (" + d.fieldObj.name + " \x3c\x3e " + (a ? "timestamp " : "") + "'" + e + "')"); break; case this.OPERATORS.dateOperatorIsNotOn: "field" === d.valueObj.type ? e = d.fieldObj.name + " \x3c\x3e " + c : (e = "unique" === d.valueObj.type ? this._getEndDateByTimeForUnique(c,
                                                                                        d.fieldObj.dateFormat) : this._getEndDateByTime(c, p, B), e = "(" + d.fieldObj.name + " \x3c " + (a ? "timestamp " : "") + "'" + this.formatDate(c) + "') OR (" + d.fieldObj.name + " \x3e\x3d " + (a ? "timestamp " : "") + "'" + e + "')"); break; case this.OPERATORS.dateOperatorIsBefore: e = "field" === d.valueObj.type ? d.fieldObj.name + " \x3c " + c : d.fieldObj.name + " \x3c " + (a ? "timestamp " : "") + "'" + this.formatDate(c) + "'"; break; case this.OPERATORS.dateOperatorIsAfter: "field" === d.valueObj.type ? e = d.fieldObj.name + " \x3e " + c : (e = "unique" === d.valueObj.type ?
                                                                                                this._getEndDateByTimeForUnique(c, d.fieldObj.dateFormat) : this._getEndDateByTime(c, p, B), e = d.fieldObj.name + " \x3e\x3d " + (a ? "timestamp " : "") + "'" + e + "'"); break; case this.OPERATORS.dateOperatorIsOnOrBefore: "field" === d.valueObj.type ? e = d.fieldObj.name + " \x3c\x3d " + c : (e = "unique" === d.valueObj.type ? this._getEndDateByTimeForUnique(c, d.fieldObj.dateFormat) : this._getEndDateByTime(c, p, B), e = d.fieldObj.name + " \x3c " + (a ? "timestamp " : "") + "'" + e + "'"); break; case this.OPERATORS.dateOperatorIsOnOrAfter: e = "field" === d.valueObj.type ?
                                                                                                        d.fieldObj.name + " \x3e\x3d " + c : d.fieldObj.name + " \x3e\x3d " + (a ? "timestamp " : "") + "'" + this.formatDate(c) + "'"; break; case this.OPERATORS.dateOperatorInTheLast: e = d.fieldObj.name + " BETWEEN CURRENT_TIMESTAMP - " + this._convertRangeToDays(d.valueObj.value, d.valueObj.range) + " AND CURRENT_TIMESTAMP"; break; case this.OPERATORS.dateOperatorNotInTheLast: e = d.fieldObj.name + " NOT BETWEEN CURRENT_TIMESTAMP - " + this._convertRangeToDays(d.valueObj.value, d.valueObj.range) + " AND CURRENT_TIMESTAMP"; break; case this.OPERATORS.dateOperatorIsBetween: case this.OPERATORS.dateOperatorIsIn: e =
                                                                                                                this._getEndDateByTime(b, d.valueObj.enableTime2, d.valueObj.timeAccuracy2); e = "(" + d.fieldObj.name + " BETWEEN " + (a ? "timestamp " : "") + "'" + this.formatDate(g) + "' AND " + (a ? "timestamp " : "") + "'" + e + "') AND (" + d.fieldObj.name + " \x3c\x3e " + (a ? "timestamp " : "") + "'" + e + "')"; break; case this.OPERATORS.dateOperatorIsNotBetween: case this.OPERATORS.dateOperatorIsNotIn: e = this._getEndDateByTime(b, d.valueObj.enableTime2, d.valueObj.timeAccuracy2); e = "(" + d.fieldObj.name + " \x3c " + (a ? "timestamp " : "") + "'" + this.formatDate(g) + "') OR (" +
                                                                                                                        d.fieldObj.name + " \x3e\x3d " + (a ? "timestamp " : "") + "'" + e + "')"; break; case this.OPERATORS.dateOperatorIsBlank: e = d.fieldObj.name + " IS NULL"; break; case this.OPERATORS.dateOperatorIsNotBlank: e = d.fieldObj.name + " IS NOT NULL"
                                                                }
                                                        } "date" === d.fieldObj.shortType ? (c = q.clone(d.valueObj), c.dateFormat = d.fieldObj.dateFormat, a = this.getDisplaySQL(d.fieldObj.name, c, d.operator)) : a = e; d.displaySQL = a; return { whereClause: e }
                                                }, _getEndDateByTime: function (d, c, g) {
                                                        d = c ? "s" === g ? this.addSec(d) : "m" === g ? this.addMinute(d) : this.addHour(d) :
                                                                this.addDay(d); return this.formatDate(d)
                                                }, _getEndDateByTimeForUnique: function (d, c) { d = c && 0 <= c.indexOf("ShortTime") ? this.addMinute(d) : c && 0 <= c.indexOf("LongTime") ? this.addSec(d) : this.addDay(d); return this.formatDate(d) }, _getDisplayDates: function (d) {
                                                        var c = { value: d.virtualDate, value1: d.virtualDate1, value2: d.virtualDate2 }, g = "" === d.dateFormat ? {} : { format: { dateFormat: d.dateFormat } }; c.value = "" === d.virtualDate || void 0 === d.virtualDate ? "field" === d.type ? d.value : "unique" === d.type ? l.localizeDateByFieldInfo(l.getDateByDateTimeStr(d.value),
                                                                g) : l.localizeDateTimeByFieldInfo(l.getDateByDateTimeStr(d.value), g, d.enableTime, d.timeAccuracy) : this.filterBuilderNls[d.virtualDate]; c.value1 = "" === d.virtualDate1 ? l.localizeDateTimeByFieldInfo(l.getDateByDateTimeStr(d.value1), g, d.enableTime1, d.timeAccuracy1) : this.filterBuilderNls[d.virtualDate1]; c.value2 = "" === d.virtualDate2 ? l.localizeDateTimeByFieldInfo(l.getDateByDateTimeStr(d.value2), g, d.enableTime2, d.timeAccuracy2) : this.filterBuilderNls[d.virtualDate2]; return c
                                                }, getDisplaySQL: function (d, c, g) {
                                                        var b =
                                                                ""; 0 < g.indexOf("InTheLast") ? b = this.filterBuilderNls[g] + " " + c.value + " " + this._getDateRangeEnum(c.value, c.range) : (c = this._getDisplayDates(c, g), b = 0 < g.indexOf("Between") ? this.filterBuilderNls[g] + " " + c.value1 + " " + this.filterBuilderNls.and + " " + c.value2 : 0 < g.indexOf("Blank") ? this.filterBuilderNls[g] : this.filterBuilderNls[g] + " " + c.value); return d + " " + b
                                                }, _getDateRangeEnum: function (d, c) {
                                                        c = {
                                                                dateOperatorYears: "year", dateOperatorDays: "day", dateOperatorMonths: "month", dateOperatorWeeks: "week", dateOperatorHours: "hour",
                                                                dateOperatorMinutes: "minute"
                                                        }[c]; return window.jimuNls.timeUnit[1 < d ? c + "s" : c].toLowerCase()
                                                }, _convertRangeToDays: function (d, c) { var g = d; c === this.OPERATORS.dateOperatorYears ? g = 365 * d : c === this.OPERATORS.dateOperatorMonths ? g = 30 * d : c === this.OPERATORS.dateOperatorWeeks ? g = 7 * d : c === this.OPERATORS.dateOperatorHours ? g = d / 24 : c === this.OPERATORS.dateOperatorMinutes && (g = d / 1440); return g = Math.round(1E6 * g) / 1E6 }, formatDate: function (d) {
                                                        d = new Date(d); return "" + d.getUTCFullYear() + "-" + m.format(d.getUTCMonth() + 1, { pattern: "00" }) +
                                                                "-" + m.format(d.getUTCDate(), { pattern: "00" }) + " " + m.format(d.getUTCHours(), { pattern: "00" }) + ":" + m.format(d.getUTCMinutes(), { pattern: "00" }) + ":" + m.format(d.getUTCSeconds(), { pattern: "00" })
                                                }, addDay: function (d) { return new Date(d.getTime() + this.dayInMS) }, addHour: function (d) { return new Date(d.getTime() + this.HourInMS) }, addMinute: function (d) { return new Date(d.getTime() + this.MinuteInMS) }, addSec: function (d) { return new Date(d.getTime() + this.SecInMS) }, getFilterObjByExpr: function (d) {
                                                        if (d && this.fieldsStore) {
                                                                var c =
                                                                        this.replaceStrings(d); d = c.defExpr; var g = this.findParts(d, "AND"); 1 === g.parts.length && (g = this.findParts(d, "OR"), 1 === g.parts.length && (g.logicalOperator = "AND")); A.forEach(g.parts, function (b) {
                                                                                b.expr = b.expr.trim(); if (b.expr.startsWith("(") && -1 < b.expr.search(/\)$/)) { var e = b.expr.substring(1, b.expr.length - 1), a = e.indexOf("("), f = e.indexOf(")"); if (-1 === a && -1 === f || a < f) b.expr = e } e = this.findParts(b.expr, "AND"); 1 === e.parts.length && (e = this.findParts(b.expr, "OR")); 1 < e.parts.length && (b.parts = e.parts, b.logicalOperator =
                                                                                        e.logicalOperator)
                                                                        }, this); this.parseExpr(g); this.reReplaceStrings(c, g, q.hitch(this, function () { g && g.parts && A.forEach(g.parts, q.hitch(this, function (b) { b && (b.parts ? A.forEach(b.parts, q.hitch(this, function (e) { this._handleParsedValuesForSinglePart(e); this._addDefalutValueTypeForSinglePart(e) })) : (this._handleParsedValuesForSinglePart(b), this._addDefalutValueTypeForSinglePart(b))) })) })); this.isPartsObjHasError(g) && (g = null); return g
                                                        }
                                                }, _handleParsedValuesForSinglePart: function (d) {
                                                        d && d.fieldObj && "number" ===
                                                                d.fieldObj.shortType && d.valueObj && (d.valueObj.hasOwnProperty("value") && (d.valueObj.value = parseFloat(d.valueObj.value)), d.valueObj.hasOwnProperty("value1") && (d.valueObj.value1 = parseFloat(d.valueObj.value1)), d.valueObj.hasOwnProperty("value2") && (d.valueObj.value2 = parseFloat(d.valueObj.value2)))
                                                }, _addDefalutValueTypeForSinglePart: function (d) { d && d.valueObj && !d.valueObj.type && (d.valueObj.type = "value") }, replaceStrings: function (d) {
                                                        for (var c = d, g = function (p, B, t) {
                                                                var u = -1; u = p.indexOf("'", t + 1); return u === t +
                                                                        1 ? (u = p.indexOf("'", u + 1), g(p, B, u)) : t
                                                        }, b = [], e = d.indexOf("'"); -1 < e;) { var a = e; e = d.indexOf("'", e + 1); var f = 0; e = g(d, a, e); "%" === d[a + 1] && a++; "%" === d[e - 1] && (--e, f++); var h = d.substring(a + 1, e); "N" === d[a - 1] && (d = d.substring(0, a - 1) + d.substring(a), --a, --e); this.isDateString(h) || -1 !== h.indexOf("{") ? e = d.indexOf("'", e + 1 + f) : (b.push(h), d = d.substring(0, a + 1) + "#" + (b.length - 1) + "#" + d.substring(e), e = d.indexOf("'", d.lastIndexOf("#") + 2 + f)) } return { origDefExpr: c, defExpr: d, savedStrings: b }
                                                }, reReplaceStrings: function (d, c, g) {
                                                        var b =
                                                                d.savedStrings; if (!b.length) g && "function" === typeof g && g(); else if (b.length) {
                                                                        var e = function (f, h) { if (void 0 === f.valueObj || null === f.valueObj || void 0 === f.valueObj.value || null === f.valueObj.value || "string" !== f.fieldObj.shortType) return !1; var p = f.valueObj.value.indexOf("#"), B = f.valueObj.value.lastIndexOf("#"); return v.isDefined(f.valueObj.value) && -1 < p ? (f.valueObj.value = h[parseInt(f.valueObj.value.substring(p + 1, B), 10)].replace(/''/g, "'"), this.builtSingleFilterString(f), !0) : !1 }; e = q.hitch(this, e); var a = !1;
                                                                        A.forEach(c.parts, function (f) { if (f.parts) { var h = !1; A.forEach(f.parts, function (p) { h = e(p, b) || h }); h && (a = h, f.expr = this.builtFilterString(f)) } else (a = e(f, b) || a) && this.builtFilterString(f) }, this); g && "function" === typeof g && g(); a && (c.expr = null, this.getExprByFilterObj(c))
                                                                }
                                                }, isDateString: function (d) { return 19 === d.length && "-" === d.charAt(4) && "-" === d.charAt(7) && " " === d.charAt(10) && ":" === d.charAt(13) && ":" === d.charAt(16) ? !0 : !1 }, findParts: function (d, c) {
                                                        for (var g = d.toLowerCase(), b = " " + c.toLowerCase() + " ", e = [], a = 0,
                                                                f = g.indexOf(b); 0 < f;) { var h = d.substring(a, f), p = h.toLowerCase(), B = h.count("("), t = h.count(")"), u = h.count("'"); B !== t || 1 === u % 2 ? f = g.indexOf(b, f + 1) : -1 < p.indexOf(" between ") && -1 === p.indexOf(" and ") ? f = g.indexOf(b, f + 1) : (e.push({ expr: h }), a = f + b.length, f = g.indexOf(b, a)) } e.push({ expr: d.substring(a) }); for (g = e.length - 1; 0 <= g; g--)!this.hasOperator(e[g].expr) && 0 < g && (e[g - 1].expr += " " + c + " " + e[g].expr, e.splice(g, 1)); return { expr: d, parts: e, logicalOperator: c }
                                                }, hasOperator: function (d) {
                                                        d = d.toLowerCase(); return -1 < d.indexOf("{") &&
                                                                -1 < d.indexOf("}") || -1 < d.indexOf(" \x3d ") || -1 < d.indexOf(" \x3c ") || -1 < d.indexOf(" \x3e ") || -1 < d.indexOf(" \x3c\x3e ") || -1 < d.indexOf(" \x3c\x3d ") || -1 < d.indexOf(" \x3e\x3d ") || -1 < d.indexOf(" like ") || -1 < d.indexOf(" between ") || -1 < d.indexOf(" date") || -1 < d.indexOf(" is null") || -1 < d.indexOf(" is not null") ? !0 : !1
                                                }, parseExpr: function (d) { A.forEach(d.parts, function (c) { c.parts ? this.parseExpr(c) : this.parseSingleExpr(c) }, this) }, _preParseSingleExpr: function (d) {
                                                        var c = null; try {
                                                                if (c = q.clone(d), c.expr = c.expr.trim(),
                                                                        /^LOWER\((.*)\)(\s+|\s+NOT\s+)LIKE\s+LOWER\(N?'(.*)'\)$/i.test(c.expr)) { var g = d = "", b = c.expr.match(/^LOWER\((.*)\)\s+/i); if (b && 2 <= b.length) d = b[1]; else return null; var e = c.expr.match(/LOWER\(N?'(.*)'\)$/i); if (e && 2 <= e.length) g = "'" + e[1] + "'"; else return null; c.expr = c.expr.replace(/^LOWER\((.*)\)\s+/i, d + " "); c.expr = c.expr.replace(/LOWER\(N?'(.*)'\)$/i, g); c.caseSensitive = !1 } else /^(.+)(\s+|\s+NOT\s+)LIKE\s+N?'(.*)'$/i.test(c.expr) && (c.caseSensitive = !0)
                                                        } catch (a) { return console.log(a), null } c && this.isHosted &&
                                                                (c.caseSensitive = !1); return c
                                                }, _removeOperator: function (d, c, g) { c = c.substring(g).trim(); "date" === d && !this.isHosted && c.toLowerCase().startsWith("timestamp ") && (c = c.substring(10).trim()); return c }, parseSingleExpr: function (d) {
                                                        var c = this._preParseSingleExpr(d); c && (d = q.mixin(d, c)); c = d.expr.trim(); var g = c.indexOf(" "), b = c.substring(0, g); d.fieldObj = { name: b }; d.valueObj = {}; this.getFieldItemByName({ name: b }, function (e) { d.fieldObj.shortType = e.shortType[0]; d.fieldObj.label = e.label[0] }, function () {
                                                                d.error = {
                                                                        msg: "unknown field name (" +
                                                                                b + ")", code: 1
                                                                }
                                                        }); c = c.substring(g + 1).trim(); g = c.toLowerCase(); g.startsWith("\x3d ") ? (c = this._removeOperator(d.fieldObj.shortType, c, 2), this.storeValue(c, d), d.operator = "date" === d.fieldObj.shortType ? this.OPERATORS.dateOperatorIsOn : "string" === d.fieldObj.shortType ? this.OPERATORS.stringOperatorIs : this.OPERATORS.numberOperatorIs) : g.startsWith("\x3c ") ? (c = this._removeOperator(d.fieldObj.shortType, c, 2), this.storeValue(c, d), "date" === d.fieldObj.shortType ? d.operator = this.OPERATORS.dateOperatorIsBefore : "number" ===
                                                                d.fieldObj.shortType ? d.operator = this.OPERATORS.numberOperatorIsLessThan : d.error = { msg: "operator (" + g + ") not supported for string", code: 3 }) : g.startsWith("\x3e ") ? (c = this._removeOperator(d.fieldObj.shortType, c, 2), this.storeValue(c, d), "date" === d.fieldObj.shortType ? d.operator = this.OPERATORS.dateOperatorIsAfter : "number" === d.fieldObj.shortType ? d.operator = this.OPERATORS.numberOperatorIsGreaterThan : d.error = { msg: "operator (" + g + ") not supported for string", code: 3 }) : g.startsWith("\x3c\x3e ") ? (c = this._removeOperator(d.fieldObj.shortType,
                                                                        c, 3), this.storeValue(c, d), d.operator = "date" === d.fieldObj.shortType ? this.OPERATORS.dateOperatorIsNotOn : "string" === d.fieldObj.shortType ? this.OPERATORS.stringOperatorIsNot : this.OPERATORS.numberOperatorIsNot) : g.startsWith("\x3c\x3d ") ? (c = this._removeOperator(d.fieldObj.shortType, c, 3), this.storeValue(c, d), "date" === d.fieldObj.shortType ? d.operator = this.OPERATORS.dateOperatorIsOnOrBefore : "number" === d.fieldObj.shortType ? d.operator = this.OPERATORS.numberOperatorIsAtMost : d.error = {
                                                                                msg: "operator (" + g + ") not supported for string",
                                                                                code: 3
                                                                        }) : g.startsWith("\x3e\x3d ") ? (c = this._removeOperator(d.fieldObj.shortType, c, 3), this.storeValue(c, d), "date" === d.fieldObj.shortType ? d.operator = this.OPERATORS.dateOperatorIsOnOrAfter : "number" === d.fieldObj.shortType ? d.operator = this.OPERATORS.numberOperatorIsAtLeast : d.error = { msg: "operator (" + g + ") not supported for string", code: 3 }) : g.startsWith("like ") ? (c = c.substring(5).trim(), c.startsWith("N'") && (c = c.substring(1, c.length)), c.startsWith("'%") && c.endsWith("%'") ? (this.storeValue(c.substring(2, c.length -
                                                                                2), d), d.operator = this.OPERATORS.stringOperatorContains) : c.startsWith("'%") && c.endsWith("'") ? (this.storeValue(c.substring(2, c.length - 1), d), d.operator = this.OPERATORS.stringOperatorEndsWith) : c.startsWith("'") && c.endsWith("%'") ? (this.storeValue(c.substring(1, c.length - 2), d), d.operator = this.OPERATORS.stringOperatorStartsWith) : d.error = { msg: "value (" + g + ") not supported for LIKE", code: 3 }) : g.startsWith("not like ") ? (c = c.substring(9).trim(), c.startsWith("N'") && (c = c.substring(1, c.length)), c.startsWith("'%") &&
                                                                                        c.endsWith("%'") ? (this.storeValue(c.substring(2, c.length - 2), d), d.operator = this.OPERATORS.stringOperatorDoesNotContain) : d.error = { msg: "value (" + g + ") not supported for NOT LIKE", code: 3 }) : g.startsWith("between ") ? this._updatePartForBetween(c, !0, d) : g.startsWith("not between ") ? this._updatePartForBetween(c, !1, d) : "is null" === g ? (d.valueObj.value = null, d.operator = "date" === d.fieldObj.shortType ? this.OPERATORS.dateOperatorIsBlank : "string" === d.fieldObj.shortType ? this.OPERATORS.stringOperatorIsBlank : this.OPERATORS.numberOperatorIsBlank) :
                                                                                                "is not null" === g ? (d.valueObj.value = null, d.operator = "date" === d.fieldObj.shortType ? this.OPERATORS.dateOperatorIsNotBlank : "string" === d.fieldObj.shortType ? this.OPERATORS.stringOperatorIsNotBlank : this.OPERATORS.numberOperatorIsNotBlank) : d.error = { msg: "unknown operator (" + g + ")", code: 2 }; if (v.isDefined(d.valueObj.value) && "string" === typeof d.valueObj.value && d.valueObj.value.startsWith("{") && d.valueObj.value.endsWith("}") || v.isDefined(d.valueObj.value1) && "string" === typeof d.valueObj.value1 && d.valueObj.value1.startsWith("{") &&
                                                                                                        d.valueObj.value1.endsWith("}")) d.isInteractive = !0
                                                }, getFieldItemByName: function (d, c, g) { this.fieldsStore.fetch({ query: d, onComplete: q.hitch(this, function (b) { b && b.length ? c(b[0]) : g() }) }) }, subtractDay: function (d) { return new Date(d.getTime() - this.dayInMS) }, _updatePartForBetween: function (d, c, g) {
                                                        d = this._removeOperator(g.fieldObj.shortType, d, (c ? "between " : "not between ").length); var b = d.toLowerCase().indexOf(" and "); if (-1 < b) {
                                                                var e = d.substring(0, b).trim(); if (e.startsWith("CURRENT_TIMESTAMP ")) if (e = e.substring(18).trim(),
                                                                        e.startsWith("-")) {
                                                                                g.operator = c ? this.OPERATORS.dateOperatorInTheLast : this.OPERATORS.dateOperatorNotInTheLast; try {
                                                                                        var a = parseFloat(e.substring(1).trim()); if (1 <= a) { var f = this.OPERATORS.dateOperatorDays; var h = a / 365; 1E-4 > Math.abs(h - Math.round(h)) ? (a = Math.round(h), f = this.OPERATORS.dateOperatorYears) : (h = a / 30, 1E-4 > Math.abs(h - Math.round(h)) ? (a = Math.round(h), f = this.OPERATORS.dateOperatorMonths) : (h = a / 7, 1E-4 > Math.abs(h - Math.round(h)) && (a = Math.round(h), f = this.OPERATORS.dateOperatorWeeks))) } else f = this.OPERATORS.dateOperatorMinutes,
                                                                                                a *= 24, 1E-4 > Math.abs(a - Math.round(a)) ? f = this.OPERATORS.dateOperatorHours : a *= 60; g.valueObj.value = a; g.valueObj.range = f
                                                                                } catch (p) { g.error = { msg: "missing count for '" + (c ? "" : "not ") + "in the last'", code: 3 } }
                                                                } else g.error = { msg: "'" + (c ? "" : "not ") + "in the next' not supported", code: 3 }; else if (d = this._removeOperator(g.fieldObj.shortType, d.substring(b), 5), this.storeValue1(e, g), this.storeValue2(d, g), "date" === g.fieldObj.shortType) {
                                                                        if (g.operator = c ? this.OPERATORS.dateOperatorIsBetween : this.OPERATORS.dateOperatorIsNotBetween,
                                                                                "object" === typeof g.valueObj.value1 && "object" === typeof g.valueObj.value2) try { 1E3 > Math.abs(this.subtractDay(g.valueObj.value2).getTime() - g.valueObj.value1.getTime()) && (g.valueObj.value = g.valueObj.value1, delete g.valueObj.value1, delete g.valueObj.value2, g.operator = c ? this.OPERATORS.dateOperatorIsOn : this.OPERATORS.dateOperatorIsNotOn) } catch (p) { }
                                                                } else "number" === g.fieldObj.shortType || "oid" === g.fieldObj.shortType ? g.operator = c ? this.OPERATORS.numberOperatorIsBetween : this.OPERATORS.numberOperatorIsNotBetween :
                                                                        g.error = { msg: g.fieldObj.shortType + " field not supported for " + (c ? "" : "NOT ") + "BETWEEN", code: 3 }
                                                        } else g.error = { msg: "missing AND operator for " + (c ? "" : "NOT ") + "BETWEEN", code: 3 }
                                                }, storeValue: function (d, c) {
                                                        if (d.startsWith("{") && d.endsWith("}")) c.valueObj.value = d; else if (d.startsWith("'{") && d.endsWith("}'")) c.valueObj.value = d.substring(1, d.length - 1); else if ("date" === c.fieldObj.shortType) if (d.startsWith("'") && d.endsWith("'")) { var g = d.substring(1, d.length - 1); c.valueObj.value = this.parseDate(g) } else c.valueObj.value =
                                                                d, c.valueObj.type = "field"; else "string" === c.fieldObj.shortType ? (d.startsWith("#") || d.startsWith("%#")) && (d.endsWith("#") || d.endsWith("#%")) ? c.valueObj.value = d : d.startsWith("'") && d.endsWith("'") ? c.valueObj.value = d.substring(1, d.length - 1).replace(/''/g, "'") : (c.valueObj.value = d, c.valueObj.type = "field", this.getFieldItemByName({ name: d }, function (b) { c.valueObj.label = b.label[0] }, function () { c.error = { msg: "unknown field name (" + d + ")", code: 1 } })) : (c.valueObj.value = d, isNaN(d) && (c.valueObj.type = "field", this.getFieldItemByName({ name: d },
                                                                        function (b) { c.valueObj.label = b.label[0] }, function () { c.error = { msg: "unknown field name (" + d + ")", code: 1 } })))
                                                }, storeValue1: function (d, c) { d.startsWith("{") && d.endsWith("}") ? c.valueObj.value1 = d : d.startsWith("'{") && d.endsWith("}'") ? c.valueObj.value1 = d.substring(1, d.length - 1) : "date" === c.fieldObj.shortType ? d.startsWith("'") && d.endsWith("'") ? (d = d.substring(1, d.length - 1), c.valueObj.value1 = this.parseDate(d)) : (c.valueObj.value1 = d, c.valueObj.type = "field") : (c.valueObj.value1 = d, isNaN(d) && (c.valueObj.type = "field")) },
                                                storeValue2: function (d, c) { d.startsWith("{") && d.endsWith("}") ? c.valueObj.value2 = d : d.startsWith("'{") && d.endsWith("}'") ? c.valueObj.value2 = d.substring(1, d.length - 1) : "date" === c.fieldObj.shortType ? d.startsWith("'") && d.endsWith("'") ? (d = d.substring(1, d.length - 1), c.valueObj.value2 = this.parseDate(d)) : (c.valueObj.value2 = d, c.valueObj.type = "field") : (c.valueObj.value2 = d, isNaN(d) && (c.valueObj.type = "field")) }, parseDate: function (d) {
                                                        var c = w.parse(d, { datePattern: "yyyy-MM-dd", timePattern: "HH:mm:ss" }); c || (c = w.parse(d.replace(" ",
                                                                ", "), { datePattern: "yyyy-MM-dd", timePattern: "HH:mm:ss" })) || (c = w.parse(d.replace(" ", " - "), { datePattern: "yyyy-MM-dd", timePattern: "HH:mm:ss" })); return c
                                                }
                                        }); n.VIRTUAL_DATE_CUSTOM = "custom"; n.VIRTUAL_DATE_TODAY = "today"; n.VIRTUAL_DATE_YESTERDAY = "yesterday"; n.VIRTUAL_DATE_TOMORROW = "tomorrow"; n.VIRTUAL_DATE_THIS_WEEK = "thisWeek"; n.VIRTUAL_DATE_THIS_MONTH = "thisMonth"; n.VIRTUAL_DATE_THIS_QUARTER = "thisQuarter"; n.VIRTUAL_DATE_THIS_YEAR = "thisYear"; n.isAskForValues = function (d) {
                                                var c = !1; return c = A.some(d.parts,
                                                        function (g) { return g.parts ? A.some(g.parts, function (b) { return !!b.interactiveObj }) : !!g.interactiveObj })
                                        }; n.hasVirtualDate = function (d) { var c = !1; return c = A.some(d.parts, function (g) { return g.parts ? A.some(g.parts, function (b) { return !!b.valueObj.virtualDate || !!b.valueObj.virtualDate1 || !!b.valueObj.virtualDate2 }) : !!g.valueObj.virtualDate || !!g.valueObj.virtualDate1 || !!g.valueObj.virtualDate2 }) }; n.getRealDateByVirtualDate = function (d) {
                                                var c = null, g = new Date, b = g.getTime(); switch (d) {
                                                        case n.VIRTUAL_DATE_TODAY: c =
                                                                g; break; case n.VIRTUAL_DATE_YESTERDAY: c = new Date(b - 864E5); break; case n.VIRTUAL_DATE_TOMORROW: c = new Date(b + 864E5); break; case n.VIRTUAL_DATE_THIS_WEEK: c = [k().startOf("week").toDate(), k().endOf("week").toDate()]; break; case n.VIRTUAL_DATE_THIS_MONTH: c = [k().startOf("month").toDate(), k().endOf("month").toDate()]; break; case n.VIRTUAL_DATE_THIS_QUARTER: c = [k().startOf("quarter").toDate(), k().endOf("quarter").toDate()]; break; case n.VIRTUAL_DATE_THIS_YEAR: c = [k().startOf("year").toDate(), k().endOf("year").toDate()]
                                                }return c
                                        };
                                        return n
                                })
                }, "dojo/data/ItemFileWriteStore": function () {
                        define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "), function (E, q, A, w, m, v, r) {
                                return q("dojo.data.ItemFileWriteStore", v, {
                                        constructor: function (l) {
                                                this._features["dojo.data.api.Write"] = !0; this._features["dojo.data.api.Notification"] = !0; this._pending = { _newItems: {}, _modifiedItems: {}, _deletedItems: {} }; this._datatypeMap.Date.serialize || (this._datatypeMap.Date.serialize = function (k) {
                                                        return r.toISOString(k,
                                                                { zulu: !0 })
                                                }); l && !1 === l.referenceIntegrity && (this.referenceIntegrity = !1); this._saveInProgress = !1
                                        }, referenceIntegrity: !0, _assert: function (l) { if (!l) throw Error("assertion failed in ItemFileWriteStore"); }, _getIdentifierAttribute: function () { return this.getFeatures()["dojo.data.api.Identity"] }, newItem: function (l, k) {
                                                this._assert(!this._saveInProgress); this._loadFinished || this._forceLoad(); if ("object" != typeof l && "undefined" != typeof l) throw Error("newItem() was passed something other than an object"); var n =
                                                        null, d = this._getIdentifierAttribute(); if (d === Number) n = this._arrayOfAllItems.length; else { n = l[d]; if ("undefined" === typeof n) throw Error("newItem() was not passed an identity for the new item"); if (E.isArray(n)) throw Error("newItem() was not passed an single-valued identity"); } this._itemsByIdentity && this._assert("undefined" === typeof this._itemsByIdentity[n]); this._assert("undefined" === typeof this._pending._newItems[n]); this._assert("undefined" === typeof this._pending._deletedItems[n]); var c = {}; c[this._storeRefPropName] =
                                                                this; c[this._itemNumPropName] = this._arrayOfAllItems.length; this._itemsByIdentity && (this._itemsByIdentity[n] = c, c[d] = [n]); this._arrayOfAllItems.push(c); d = null; if (k && k.parent && k.attribute) {
                                                                        d = { item: k.parent, attribute: k.attribute, oldValue: void 0 }; var g = this.getValues(k.parent, k.attribute); if (g && 0 < g.length) { var b = g.slice(0, g.length); d.oldValue = 1 === g.length ? g[0] : g.slice(0, g.length); b.push(c); this._setValueOrValues(k.parent, k.attribute, b, !1); d.newValue = this.getValues(k.parent, k.attribute) } else this._setValueOrValues(k.parent,
                                                                                k.attribute, c, !1), d.newValue = c
                                                                } else c[this._rootItemPropName] = !0, this._arrayOfTopLevelItems.push(c); this._pending._newItems[n] = c; for (var e in l) { if (e === this._storeRefPropName || e === this._itemNumPropName) throw Error("encountered bug in ItemFileWriteStore.newItem"); k = l[e]; E.isArray(k) || (k = [k]); c[e] = k; if (this.referenceIntegrity) for (n = 0; n < k.length; n++)g = k[n], this.isItem(g) && this._addReferenceToMap(g, c, e) } this.onNew(c, d); return c
                                        }, _removeArrayElement: function (l, k) {
                                                k = A.indexOf(l, k); return -1 != k ? (l.splice(k,
                                                        1), !0) : !1
                                        }, deleteItem: function (l) {
                                                this._assert(!this._saveInProgress); this._assertIsItem(l); var k = l[this._itemNumPropName], n = this.getIdentity(l); if (this.referenceIntegrity) {
                                                        var d = this.getAttributes(l); l[this._reverseRefMap] && (l["backup_" + this._reverseRefMap] = E.clone(l[this._reverseRefMap])); A.forEach(d, function (f) {
                                                                A.forEach(this.getValues(l, f), function (h) {
                                                                        this.isItem(h) && (l["backupRefs_" + this._reverseRefMap] || (l["backupRefs_" + this._reverseRefMap] = []), l["backupRefs_" + this._reverseRefMap].push({
                                                                                id: this.getIdentity(h),
                                                                                attr: f
                                                                        }), this._removeReferenceFromMap(h, l, f))
                                                                }, this)
                                                        }, this); if (d = l[this._reverseRefMap]) for (var c in d) { var g = null; if (g = this._itemsByIdentity ? this._itemsByIdentity[c] : this._arrayOfAllItems[c]) for (var b in d[c]) { var e = this.getValues(g, b) || [], a = A.filter(e, function (f) { return !(this.isItem(f) && this.getIdentity(f) == n) }, this); this._removeReferenceFromMap(l, g, b); a.length < e.length && this._setValueOrValues(g, b, a, !0) } }
                                                } this._arrayOfAllItems[k] = null; l[this._storeRefPropName] = null; this._itemsByIdentity && delete this._itemsByIdentity[n];
                                                this._pending._deletedItems[n] = l; l[this._rootItemPropName] && this._removeArrayElement(this._arrayOfTopLevelItems, l); this.onDelete(l); return !0
                                        }, setValue: function (l, k, n) { return this._setValueOrValues(l, k, n, !0) }, setValues: function (l, k, n) { return this._setValueOrValues(l, k, n, !0) }, unsetAttribute: function (l, k) { return this._setValueOrValues(l, k, [], !0) }, _setValueOrValues: function (l, k, n, d) {
                                                this._assert(!this._saveInProgress); this._assertIsItem(l); this._assert(E.isString(k)); this._assert("undefined" !== typeof n);
                                                var c = this._getIdentifierAttribute(); if (k == c) throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier."); c = this._getValueOrValues(l, k); var g = this.getIdentity(l); if (!this._pending._modifiedItems[g]) { var b = {}; for (e in l) b[e] = e === this._storeRefPropName || e === this._itemNumPropName || e === this._rootItemPropName ? l[e] : e === this._reverseRefMap ? E.clone(l[e]) : l[e].slice(0, l[e].length); this._pending._modifiedItems[g] = b } g = !1; if (E.isArray(n) && 0 === n.length) {
                                                        if (g = delete l[k],
                                                                n = void 0, this.referenceIntegrity && c) { var e = c; E.isArray(e) || (e = [e]); for (var a = 0; a < e.length; a++)b = e[a], this.isItem(b) && this._removeReferenceFromMap(b, l, k) }
                                                } else {
                                                        g = E.isArray(n) ? n.slice(0, n.length) : [n]; if (this.referenceIntegrity) if (c) {
                                                                e = c; E.isArray(e) || (e = [e]); var f = {}; A.forEach(e, function (h) { this.isItem(h) && (h = this.getIdentity(h), f[h.toString()] = !0) }, this); A.forEach(g, function (h) { if (this.isItem(h)) { var p = this.getIdentity(h); f[p.toString()] ? delete f[p.toString()] : this._addReferenceToMap(h, l, k) } }, this);
                                                                for (a in f) this._removeReferenceFromMap(this._itemsByIdentity ? this._itemsByIdentity[a] : this._arrayOfAllItems[a], l, k)
                                                        } else for (a = 0; a < g.length; a++)b = g[a], this.isItem(b) && this._addReferenceToMap(b, l, k); l[k] = g; g = !0
                                                } if (d) this.onSet(l, k, c, n); return g
                                        }, _addReferenceToMap: function (l, k, n) { k = this.getIdentity(k); var d = l[this._reverseRefMap]; d || (d = l[this._reverseRefMap] = {}); (l = d[k]) || (l = d[k] = {}); l[n] = !0 }, _removeReferenceFromMap: function (l, k, n) {
                                                k = this.getIdentity(k); var d = l[this._reverseRefMap], c; if (d) {
                                                        for (c in d) c ==
                                                                k && (delete d[c][n], this._isEmpty(d[c]) && delete d[c]); this._isEmpty(d) && delete l[this._reverseRefMap]
                                                }
                                        }, _dumpReferenceMap: function () { var l; for (l = 0; l < this._arrayOfAllItems.length; l++) { var k = this._arrayOfAllItems[l]; k && k[this._reverseRefMap] && console.log("Item: [" + this.getIdentity(k) + "] is referenced by: " + w.toJson(k[this._reverseRefMap])) } }, _getValueOrValues: function (l, k) { var n = void 0; this.hasAttribute(l, k) && (l = this.getValues(l, k), n = 1 == l.length ? l[0] : l); return n }, _flatten: function (l) {
                                                if (this.isItem(l)) return { _reference: this.getIdentity(l) };
                                                if ("object" === typeof l) for (var k in this._datatypeMap) { var n = this._datatypeMap[k]; if (E.isObject(n) && !E.isFunction(n)) { if (l instanceof n.type) { if (!n.serialize) throw Error("ItemFileWriteStore:  No serializer defined for type mapping: [" + k + "]"); return { _type: k, _value: n.serialize(l) } } } else if (l instanceof n) return { _type: k, _value: l.toString() } } return l
                                        }, _getNewFileContentString: function () {
                                                var l = {}, k = this._getIdentifierAttribute(); k !== Number && (l.identifier = k); this._labelAttr && (l.label = this._labelAttr); l.items =
                                                        []; for (k = 0; k < this._arrayOfAllItems.length; ++k) { var n = this._arrayOfAllItems[k]; if (null !== n) { var d = {}, c; for (c in n) if (c !== this._storeRefPropName && c !== this._itemNumPropName && c !== this._reverseRefMap && c !== this._rootItemPropName) { var g = this.getValues(n, c); if (1 == g.length) d[c] = this._flatten(g[0]); else for (var b = [], e = 0; e < g.length; ++e)b.push(this._flatten(g[e])), d[c] = b } l.items.push(d) } } return w.toJson(l, !0)
                                        }, _isEmpty: function (l) {
                                                var k = !0; if (E.isObject(l)) for (var n in l) { k = !1; break } else E.isArray(l) && 0 < l.length &&
                                                        (k = !1); return k
                                        }, save: function (l) {
                                                this._assert(!this._saveInProgress); this._saveInProgress = !0; var k = this, n = function () { k._pending = { _newItems: {}, _modifiedItems: {}, _deletedItems: {} }; k._saveInProgress = !1; l && l.onComplete && l.onComplete.call(l.scope || m.global) }, d = function (g) { k._saveInProgress = !1; l && l.onError && l.onError.call(l.scope || m.global, g) }; if (this._saveEverything) { var c = this._getNewFileContentString(); this._saveEverything(n, d, c) } this._saveCustom && this._saveCustom(n, d); this._saveEverything || this._saveCustom ||
                                                        n()
                                        }, revert: function () {
                                                this._assert(!this._saveInProgress); for (var l in this._pending._modifiedItems) { var k = this._pending._modifiedItems[l], n = null; n = this._itemsByIdentity ? this._itemsByIdentity[l] : this._arrayOfAllItems[l]; k[this._storeRefPropName] = this; for (var d in n) delete n[d]; E.mixin(n, k) } for (l in this._pending._deletedItems) {
                                                        var c = this._pending._deletedItems[l]; c[this._storeRefPropName] = this; k = c[this._itemNumPropName]; c["backup_" + this._reverseRefMap] && (c[this._reverseRefMap] = c["backup_" + this._reverseRefMap],
                                                                delete c["backup_" + this._reverseRefMap]); this._arrayOfAllItems[k] = c; this._itemsByIdentity && (this._itemsByIdentity[l] = c); c[this._rootItemPropName] && this._arrayOfTopLevelItems.push(c)
                                                } for (l in this._pending._deletedItems) c = this._pending._deletedItems[l], c["backupRefs_" + this._reverseRefMap] && (A.forEach(c["backupRefs_" + this._reverseRefMap], function (g) { this._addReferenceToMap(this._itemsByIdentity ? this._itemsByIdentity[g.id] : this._arrayOfAllItems[g.id], c, g.attr) }, this), delete c["backupRefs_" + this._reverseRefMap]);
                                                for (l in this._pending._newItems) k = this._pending._newItems[l], k[this._storeRefPropName] = null, this._arrayOfAllItems[k[this._itemNumPropName]] = null, k[this._rootItemPropName] && this._removeArrayElement(this._arrayOfTopLevelItems, k), this._itemsByIdentity && delete this._itemsByIdentity[l]; this._pending = { _newItems: {}, _modifiedItems: {}, _deletedItems: {} }; return !0
                                        }, isDirty: function (l) {
                                                return l ? (l = this.getIdentity(l), (new Boolean(this._pending._newItems[l] || this._pending._modifiedItems[l] || this._pending._deletedItems[l])).valueOf()) :
                                                        !this._isEmpty(this._pending._newItems) || !this._isEmpty(this._pending._modifiedItems) || !this._isEmpty(this._pending._deletedItems)
                                        }, onSet: function (l, k, n, d) { }, onNew: function (l, k) { }, onDelete: function (l) { }, close: function (l) { if (this.clearOnClose) { if (this.isDirty()) throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close."); this.inherited(arguments) } }
                                })
                        })
                }, "dojo/data/ItemFileReadStore": function () {
                        define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        A = A("dojo.data.ItemFileReadStore", [v], {
                                                constructor: function (n) {
                                                        this._arrayOfAllItems = []; this._arrayOfTopLevelItems = []; this._loadFinished = !1; this.url = this._ccUrl = this._jsonFileUrl = n.url; this._jsonData = n.data; this.data = null; this._datatypeMap = n.typeMap || {}; this._datatypeMap.Date || (this._datatypeMap.Date = { type: Date, deserialize: function (d) { return k.fromISOString(d) } }); this._features = { "dojo.data.api.Read": !0, "dojo.data.api.Identity": !0 }; this._itemsByIdentity = null; this._storeRefPropName =
                                                                "_S"; this._itemNumPropName = "_0"; this._rootItemPropName = "_RI"; this._reverseRefMap = "_RRM"; this._loadInProgress = !1; this._queuedFetches = []; void 0 !== n.urlPreventCache && (this.urlPreventCache = n.urlPreventCache ? !0 : !1); void 0 !== n.hierarchical && (this.hierarchical = n.hierarchical ? !0 : !1); n.clearOnClose && (this.clearOnClose = !0); "failOk" in n && (this.failOk = n.failOk ? !0 : !1)
                                                }, url: "", _ccUrl: "", data: null, typeMap: null, clearOnClose: !1, urlPreventCache: !1, failOk: !1, hierarchical: !0, _assertIsItem: function (n) {
                                                        if (!this.isItem(n)) throw Error(this.declaredClass +
                                                                ": Invalid item argument.");
                                                }, _assertIsAttribute: function (n) { if ("string" !== typeof n) throw Error(this.declaredClass + ": Invalid attribute argument."); }, getValue: function (n, d, c) { n = this.getValues(n, d); return 0 < n.length ? n[0] : c }, getValues: function (n, d) { this._assertIsItem(n); this._assertIsAttribute(d); return (n[d] || []).slice(0) }, getAttributes: function (n) {
                                                        this._assertIsItem(n); var d = [], c; for (c in n) c !== this._storeRefPropName && c !== this._itemNumPropName && c !== this._rootItemPropName && c !== this._reverseRefMap &&
                                                                d.push(c); return d
                                                }, hasAttribute: function (n, d) { this._assertIsItem(n); this._assertIsAttribute(d); return d in n }, containsValue: function (n, d, c) { var g = void 0; "string" === typeof c && (g = r.patternToRegExp(c, !1)); return this._containsValue(n, d, c, g) }, _containsValue: function (n, d, c, g) { return w.some(this.getValues(n, d), function (b) { if (null !== b && !q.isObject(b) && g) { if (b.toString().match(g)) return !0 } else if (c === b) return !0 }) }, isItem: function (n) {
                                                        return n && n[this._storeRefPropName] === this && this._arrayOfAllItems[n[this._itemNumPropName]] ===
                                                                n ? !0 : !1
                                                }, isItemLoaded: function (n) { return this.isItem(n) }, loadItem: function (n) { this._assertIsItem(n.item) }, getFeatures: function () { return this._features }, getLabel: function (n) { if (this._labelAttr && this.isItem(n)) return this.getValue(n, this._labelAttr) }, getLabelAttributes: function (n) { return this._labelAttr ? [this._labelAttr] : null }, filter: function (n, d, c) {
                                                        var g = []; if (n.query) {
                                                                var b = n.queryOptions ? n.queryOptions.ignoreCase : !1; var e = {}; for (p in n.query) {
                                                                        var a = n.query[p]; "string" === typeof a ? e[p] = r.patternToRegExp(a,
                                                                                b) : a instanceof RegExp && (e[p] = a)
                                                                } for (b = 0; b < d.length; ++b) { var f = !0, h = d[b]; if (null === h) f = !1; else for (p in n.query) a = n.query[p], this._containsValue(h, p, a, e[p]) || (f = !1); f && g.push(h) }
                                                        } else for (b = 0; b < d.length; ++b) { var p = d[b]; null !== p && g.push(p) } c(g, n)
                                                }, _fetchItems: function (n, d, c) {
                                                        var g = this; if (this._loadFinished) this.filter(n, this._getItemsArray(n.queryOptions), d); else if (this._jsonFileUrl !== this._ccUrl ? (E.deprecated(this.declaredClass + ": ", "To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),
                                                                this.url = this._ccUrl = this._jsonFileUrl) : this.url !== this._ccUrl && (this._ccUrl = this._jsonFileUrl = this.url), null != this.data && (this._jsonData = this.data, this.data = null), this._jsonFileUrl) if (this._loadInProgress) this._queuedFetches.push({ args: n, filter: q.hitch(g, "filter"), findCallback: q.hitch(g, d) }); else {
                                                                        this._loadInProgress = !0; var b = m.get({ url: g._jsonFileUrl, handleAs: "json-comment-optional", preventCache: this.urlPreventCache, failOk: this.failOk }); b.addCallback(function (a) {
                                                                                try {
                                                                                        g._getItemsFromLoadedData(a),
                                                                                        g._loadFinished = !0, g._loadInProgress = !1, g.filter(n, g._getItemsArray(n.queryOptions), d), g._handleQueuedFetches()
                                                                                } catch (f) { g._loadFinished = !0, g._loadInProgress = !1, c(f, n) }
                                                                        }); b.addErrback(function (a) { g._loadInProgress = !1; c(a, n) }); var e = null; n.abort && (e = n.abort); n.abort = function () { var a = b; a && -1 === a.fired && (a.cancel(), a = null); e && e.call(n) }
                                                                } else if (this._jsonData) try { this._loadFinished = !0, this._getItemsFromLoadedData(this._jsonData), this._jsonData = null, g.filter(n, this._getItemsArray(n.queryOptions), d) } catch (a) {
                                                                        c(a,
                                                                                n)
                                                                } else c(Error(this.declaredClass + ": No JSON source data was provided as either URL or a nested Javascript object."), n)
                                                }, _handleQueuedFetches: function () { if (0 < this._queuedFetches.length) { for (var n = 0; n < this._queuedFetches.length; n++) { var d = this._queuedFetches[n], c = d.args, g = d.filter; d = d.findCallback; g ? g(c, this._getItemsArray(c.queryOptions), d) : this.fetchItemByIdentity(c) } this._queuedFetches = [] } }, _getItemsArray: function (n) { return n && n.deep ? this._arrayOfAllItems : this._arrayOfTopLevelItems }, close: function (n) {
                                                        this.clearOnClose &&
                                                        this._loadFinished && !this._loadInProgress && ("" != this._jsonFileUrl && null != this._jsonFileUrl || "" != this.url && null != this.url || null != this.data || console.debug(this.declaredClass + ": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"), this._arrayOfAllItems = [], this._arrayOfTopLevelItems = [], this._loadFinished = !1, this._itemsByIdentity = null, this._loadInProgress = !1, this._queuedFetches = [])
                                                }, _getItemsFromLoadedData: function (n) {
                                                        function d(x) {
                                                                return null !==
                                                                        x && "object" === typeof x && (!q.isArray(x) || g) && !q.isFunction(x) && (x.constructor == Object || q.isArray(x)) && "undefined" === typeof x._reference && "undefined" === typeof x._type && "undefined" === typeof x._value && b.hierarchical
                                                        } function c(x) { b._arrayOfAllItems.push(x); for (var y in x) { var D = x[y]; if (D) if (q.isArray(D)) for (var H = 0; H < D.length; ++H) { var I = D[H]; d(I) && c(I) } else d(D) && c(D) } } var g = !1, b = this; this._labelAttr = n.label; var e; this._arrayOfAllItems = []; this._arrayOfTopLevelItems = n.items; for (e = 0; e < this._arrayOfTopLevelItems.length; ++e) {
                                                                var a =
                                                                        this._arrayOfTopLevelItems[e]; q.isArray(a) && (g = !0); c(a); a[this._rootItemPropName] = !0
                                                        } var f = {}, h; for (e = 0; e < this._arrayOfAllItems.length; ++e)for (h in a = this._arrayOfAllItems[e], a) { if (h !== this._rootItemPropName) { var p = a[h]; null !== p ? q.isArray(p) || (a[h] = [p]) : a[h] = [null] } f[h] = h } for (; f[this._storeRefPropName];)this._storeRefPropName += "_"; for (; f[this._itemNumPropName];)this._itemNumPropName += "_"; for (; f[this._reverseRefMap];)this._reverseRefMap += "_"; if (f = n.identifier) for (this._itemsByIdentity = {}, this._features["dojo.data.api.Identity"] =
                                                                f, e = 0; e < this._arrayOfAllItems.length; ++e)if (a = this._arrayOfAllItems[e], n = a[f], n = n[0], Object.hasOwnProperty.call(this._itemsByIdentity, n)) {
                                                                        if (this._jsonFileUrl) throw Error(this.declaredClass + ":  The json data as specified by: [" + this._jsonFileUrl + "] is malformed.  Items within the list have identifier: [" + f + "].  Value collided: [" + n + "]"); if (this._jsonData) throw Error(this.declaredClass + ":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: [" + f + "].  Value collided: [" +
                                                                                n + "]");
                                                                } else this._itemsByIdentity[n] = a; else this._features["dojo.data.api.Identity"] = Number; for (e = 0; e < this._arrayOfAllItems.length; ++e)a = this._arrayOfAllItems[e], a[this._storeRefPropName] = this, a[this._itemNumPropName] = e; for (e = 0; e < this._arrayOfAllItems.length; ++e)for (h in a = this._arrayOfAllItems[e], a) for (n = a[h], f = 0; f < n.length; ++f)if (p = n[f], null !== p && "object" == typeof p) {
                                                                        if ("_type" in p && "_value" in p) {
                                                                                var B = p._type, t = this._datatypeMap[B]; if (t) if (q.isFunction(t)) n[f] = new t(p._value); else if (q.isFunction(t.deserialize)) n[f] =
                                                                                        t.deserialize(p._value); else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function"); else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '" + B + "'");
                                                                        } if (p._reference) {
                                                                                p = p._reference; if (q.isObject(p)) for (B = 0; B < this._arrayOfAllItems.length; ++B) { t = this._arrayOfAllItems[B]; var u = !0, z; for (z in p) t[z] != p[z] && (u = !1); u && (n[f] = t) } else n[f] = this._getItemByIdentity(p);
                                                                                this.referenceIntegrity && (p = n[f], this.isItem(p) && this._addReferenceToMap(p, a, h))
                                                                        } else this.isItem(p) && this.referenceIntegrity && this._addReferenceToMap(p, a, h)
                                                                }
                                                }, _addReferenceToMap: function (n, d, c) { }, getIdentity: function (n) { var d = this._features["dojo.data.api.Identity"]; return d === Number ? n[this._itemNumPropName] : (n = n[d]) ? n[0] : null }, fetchItemByIdentity: function (n) {
                                                        if (this._loadFinished) { var d = this._getItemByIdentity(n.identity); if (n.onItem) { var c = n.scope ? n.scope : E.global; n.onItem.call(c, d) } } else {
                                                                var g =
                                                                        this; this._jsonFileUrl !== this._ccUrl ? (E.deprecated(this.declaredClass + ": ", "To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"), this.url = this._ccUrl = this._jsonFileUrl) : this.url !== this._ccUrl && (this._ccUrl = this._jsonFileUrl = this.url); null != this.data && null == this._jsonData && (this._jsonData = this.data, this.data = null); this._jsonFileUrl ? this._loadInProgress ? this._queuedFetches.push({ args: n }) : (this._loadInProgress = !0, c = m.get({
                                                                                url: g._jsonFileUrl,
                                                                                handleAs: "json-comment-optional", preventCache: this.urlPreventCache, failOk: this.failOk
                                                                        }), c.addCallback(function (b) { var e = n.scope ? n.scope : E.global; try { g._getItemsFromLoadedData(b), g._loadFinished = !0, g._loadInProgress = !1, d = g._getItemByIdentity(n.identity), n.onItem && n.onItem.call(e, d), g._handleQueuedFetches() } catch (a) { g._loadInProgress = !1, n.onError && n.onError.call(e, a) } }), c.addErrback(function (b) { g._loadInProgress = !1; n.onError && n.onError.call(n.scope ? n.scope : E.global, b) })) : this._jsonData && (g._getItemsFromLoadedData(g._jsonData),
                                                                                g._jsonData = null, g._loadFinished = !0, d = g._getItemByIdentity(n.identity), n.onItem && (c = n.scope ? n.scope : E.global, n.onItem.call(c, d)))
                                                        }
                                                }, _getItemByIdentity: function (n) { var d = null; this._itemsByIdentity ? Object.hasOwnProperty.call(this._itemsByIdentity, n) && (d = this._itemsByIdentity[n]) : Object.hasOwnProperty.call(this._arrayOfAllItems, n) && (d = this._arrayOfAllItems[n]); void 0 === d && (d = null); return d }, getIdentityAttributes: function (n) { n = this._features["dojo.data.api.Identity"]; return n === Number ? null : [n] }, _forceLoad: function () {
                                                        var n =
                                                                this; this._jsonFileUrl !== this._ccUrl ? (E.deprecated(this.declaredClass + ": ", "To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"), this.url = this._ccUrl = this._jsonFileUrl) : this.url !== this._ccUrl && (this._ccUrl = this._jsonFileUrl = this.url); null != this.data && (this._jsonData = this.data, this.data = null); if (this._jsonFileUrl) {
                                                                        var d = m.get({
                                                                                url: this._jsonFileUrl, handleAs: "json-comment-optional", preventCache: this.urlPreventCache, failOk: this.failOk,
                                                                                sync: !0
                                                                        }); d.addCallback(function (c) { try { if (!0 !== n._loadInProgress && !n._loadFinished) n._getItemsFromLoadedData(c), n._loadFinished = !0; else if (n._loadInProgress) throw Error(this.declaredClass + ":  Unable to perform a synchronous load, an async load is in progress."); } catch (g) { throw console.log(g), g; } }); d.addErrback(function (c) { throw c; })
                                                                } else this._jsonData && (n._getItemsFromLoadedData(n._jsonData), n._jsonData = null, n._loadFinished = !0)
                                                }
                                        }); q.extend(A, l); return A
                                })
                }, "dojo/data/util/filter": function () {
                        define(["../../_base/lang"],
                                function (E) { var q = {}; E.setObject("dojo.data.util.filter", q); q.patternToRegExp = function (A, w) { for (var m = "^", v = null, r = 0; r < A.length; r++)switch (v = A.charAt(r), v) { case "\\": m += v; r++; m += A.charAt(r); break; case "*": m += ".*"; break; case "?": m += "."; break; case "$": case "^": case "/": case "+": case ".": case "|": case "(": case ")": case "{": case "}": case "[": case "]": m += "\\"; default: m += v }m += "$"; return w ? new RegExp(m, "mi") : new RegExp(m, "m") }; return q })
                }, "dojo/data/util/simpleFetch": function () {
                        define(["../../_base/lang",
                                "../../_base/kernel", "./sorter"], function (E, q, A) {
                                        var w = {}; E.setObject("dojo.data.util.simpleFetch", w); w.errorHandler = function (m, v) { v.onError && v.onError.call(v.scope || q.global, m, v) }; w.fetchHandler = function (m, v) {
                                                var r = v.abort || null, l = !1, k = v.start ? v.start : 0, n = v.count && Infinity !== v.count ? k + v.count : m.length; v.abort = function () { l = !0; r && r.call(v) }; var d = v.scope || q.global; v.store || (v.store = this); v.onBegin && v.onBegin.call(d, m.length, v); v.sort && m.sort(A.createSortFunction(v.sort, this)); if (v.onItem) for (var c =
                                                        k; c < m.length && c < n; ++c) { var g = m[c]; l || v.onItem.call(d, g, v) } v.onComplete && !l && (c = null, v.onItem || (c = m.slice(k, n)), v.onComplete.call(d, c, v))
                                        }; w.fetch = function (m) { m = m || {}; m.store || (m.store = this); this._fetchItems(m, E.hitch(this, "fetchHandler"), E.hitch(this, "errorHandler")); return m }; return w
                                })
                }, "dojo/data/util/sorter": function () {
                        define(["../../_base/lang"], function (E) {
                                var q = {}; E.setObject("dojo.data.util.sorter", q); q.basicComparator = function (A, w) {
                                        var m = -1; null === A && (A = void 0); null === w && (w = void 0); if (A ==
                                                w) m = 0; else if (A > w || null == A) m = 1; return m
                                }; q.createSortFunction = function (A, w) { function m(g, b, e, a) { return function (f, h) { f = a.getValue(f, g); h = a.getValue(h, g); return b * e(f, h) } } for (var v = [], r, l = w.comparatorMap, k = q.basicComparator, n = 0; n < A.length; n++) { r = A[n]; var d = r.attribute; if (d) { r = r.descending ? -1 : 1; var c = k; l && ("string" !== typeof d && "toString" in d && (d = d.toString()), c = l[d] || k); v.push(m(d, r, c, w)) } } return function (g, b) { for (var e = 0; e < v.length;) { var a = v[e++](g, b); if (0 !== a) return a } return 0 } }; return q
                        })
                }, "jimu/Query": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred jimu/utils jimu/ServiceDefinitionManager esri/tasks/query esri/tasks/QueryTask esri/tasks/FeatureSet".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        var d = E(null, {
                                                queryType: 0, nextPageIndex: 1, pageSizeOption: null, layerDefinition: null, layerDefinitionDef: null, type1CountDef: null, type2ObjectIdsDef: null, type3QueryDef: null, sdf: null, url: null, query: null, pageSize: 1E3, constructor: function (c) { this.sdf = r.getInstance(); this.url = c.url; this.query = c.query; this.pageSizeOption = c.pageSize; this.query.outFields && 0 !== this.query.outFields.length || (this.query.outFields = ["*"]); this.pageSize = 0 < c.pageSize ? c.pageSize : 1E3; this.getFeatureCount() },
                                                getFeatureCount: function () { return this._getQueryType().then(q.hitch(this, function (c) { return 1 === c ? this._getCountForQueryType1() : 2 === c ? this._getCountForQueryType2() : this._getCountForQueryType3() })) }, getPageCount: function () { return this.getFeatureCount().then(q.hitch(this, function (c) { return 0 === c ? 0 : Math.ceil(c / this.pageSize) })) }, getAllFeatures: function () {
                                                        return this.getPageCount().then(q.hitch(this, function (c) {
                                                                if (0 < c) {
                                                                        for (var g = [], b = 1; b <= c; b++)g.push(this.queryByPage(b)); return w(g).then(q.hitch(this,
                                                                                function (e) { for (var a = [], f = 0; f < e.length; f++)e[f].features && 0 < e[f].features.length && (a = a.concat(e[f].features)); a = this._setOrderByFieldValue(a); e = e[0]; e.features = a; return e }))
                                                                } this._getEmptyFeatureSet().then(q.hitch(this, function (e) { return e }))
                                                        }))
                                                }, _setOrderByFieldValue: function (c) { if (2 === this.queryType || 3 === this.queryType) { var g = this.query.outFields; c.sort(function (b, e) { b = b.attributes[g]; e = e.attributes[g]; return "string" === typeof b && "string" === typeof e ? b.localeCompare(e) : b < e ? -1 : b === e ? 0 : 1 }) } return c },
                                                _getEmptyFeatureSet: function () { var c = new m; this.layerDefinition && this.layerDefinition.geometryType ? c.resolve(this._getEmptyFeatureSetHandler()) : this._getLayerDefinition().then(q.hitch(this, function () { c.resolve(this._getEmptyFeatureSetHandler()) })); return c }, _getEmptyFeatureSetHandler: function () {
                                                        var c = new n; c.features = []; c.geometryType = this.layerDefinition.geometryType; c.fields = []; var g = q.clone(this.layerDefinition.fields); 0 <= this.query.outFields.indexOf("*") ? c.fields = g : c.fields = A.filter(g, q.hitch(this,
                                                                function (b) { return 0 <= this.query.outFields.indexOf(b.name) })); return c
                                                }, getCurrentPageIndex: function () { return this.nextPageIndex }, queryNextPage: function () { var c = this.nextPageIndex; this.nextPageIndex++; return this.queryByPage(c) }, queryByPage: function (c) {
                                                        var g = null; 0 >= c ? (g = new m, this._getEmptyFeatureSet().then(q.hitch(this, function (b) { g.resolve(b) }))) : g = this.getPageCount().then(q.hitch(this, function (b) {
                                                                c > b && this._getEmptyFeatureSet().then(q.hitch(this, function (e) { return e })); return 1 === this.queryType ?
                                                                        this._queryPageForType1(c) : 2 === this.queryType ? this._queryPageForType2(c) : this._queryPageForType3(c)
                                                        })); return g
                                                }, _getQueryType: function () { var c = new m; if (0 < this.queryType) c.resolve(this.queryType); else return this._getLayerDefinition().then(q.hitch(this, function (g) { return this.queryType = d.getQueryType(g) })); return c }, _getDefStatus: function (c) { return c ? c.isFulfilled() ? c.isResolved() ? 2 : -1 : 1 : 0 }, _getLayerDefinition: function () {
                                                        0 >= this._getDefStatus(this.layerDefinitionDef) && (this.layerDefinitionDef = this.sdf.getServiceDefinition(this.url).then(q.hitch(this,
                                                                function (c) { this.layerDefinition = c; var g = c.maxRecordCount; 0 < g && (!(0 < this.pageSizeOption) || this.pageSize > c.maxRecordCount) && (this.pageSize = g); return this.layerDefinition }))); return this.layerDefinitionDef
                                                }, _getCountForQueryType1: function () { 0 >= this._getDefStatus(this.type1CountDef) && (this.type1CountDef = this._queryCount()); return this.type1CountDef }, _getCountForQueryType2: function () { return this._getObjectIdsForQueryType2().then(q.hitch(this, function (c) { return c.length })) }, _getObjectIdsForQueryType2: function () {
                                                        0 >=
                                                        this._getDefStatus(this.type2ObjectIdsDef) && (this.type2ObjectIdsDef = this._queryIds()); return this.type2ObjectIdsDef
                                                }, _getCountForQueryType3: function () { return this._doQueryForQueryType3().then(q.hitch(this, function (c) { return (c.features || []).length })) }, _doQueryForQueryType3: function () { 0 >= this._getDefStatus(this.type3QueryDef) && (this.type3QueryDef = this._query()); return this.type3QueryDef }, _queryPageForType1: function (c) { return this._queryWithPaginationAndOrder((c - 1) * this.pageSize) }, _queryPageForType2: function (c) {
                                                        return this._getObjectIdsForQueryType2().then(q.hitch(this,
                                                                function (g) { var b = (c - 1) * this.pageSize; g = g.slice(b, b + this.pageSize); return this._queryByObjectIds(g) }))
                                                }, _queryPageForType3: function (c) { return this._doQueryForQueryType3().then(q.hitch(this, function (g) { var b = q.mixin({}, g); b.features = []; var e = (c - 1) * this.pageSize; b.features = (g.features || []).slice(e, e + this.pageSize); return b })) }, _tryLocaleNumber: function (c) { var g = v.localizeNumber(c); if (null === g || void 0 === g) g = c; return g }, _tryLocaleDate: function (c) {
                                                        var g = v.localizeDate(c); g || (g = c.toLocaleDateString());
                                                        return g
                                                }, _getLayerIndexByLayerUrl: function (c) { var g = c.lastIndexOf("/"); c = c.slice(g + 1, c.length); return parseInt(c, 10) }, _getServiceUrlByLayerUrl: function (c) { var g = c.lastIndexOf("/"); return c.slice(0, g) }, _isImageServiceLayer: function (c) { return -1 < c.indexOf("/ImageServer") }, _isTable: function (c) { return "Table" === c.type }, _getObjectIdField: function () { return this.layerDefinition.objectIdField }, _query: function (c) {
                                                        var g = new l; g.where = c || this.query.where; g.geometry = this.query.geometry; g.outSpatialReference = this.query.outSpatialReference;
                                                        g.returnGeometry = this.query.returnGeometry; g.spatialRelationship = this.query.spatialRelationship; g.outFields = this.query.outFields; g.returnDistinctValues = this.query.returnDistinctValues; return (new k(this.url)).execute(g)
                                                }, _queryIds: function () {
                                                        var c = new l; c.where = this.query.where; c.geometry = this.query.geometry; c.returnGeometry = !1; c.spatialRelationship = this.query.spatialRelationship; c.outSpatialReference = this.query.outSpatialReference; return (new k(this.url)).executeForIds(c).then(q.hitch(this, function (g) {
                                                                g ||
                                                                (g = []); return g
                                                        }))
                                                }, _queryByObjectIds: function (c) {
                                                        var g = new m, b = new l; b.returnGeometry = this.query.returnGeometry; b.outSpatialReference = this.query.outSpatialReference; b.spatialRelationship = this.query.spatialRelationship; b.outFields = this.query.outFields; b.objectIds = c; (new k(this.url)).execute(b).then(q.hitch(this, function (e) { g.resolve(e) }), q.hitch(this, function (e) {
                                                                if (400 === e.code) {
                                                                        var a = this._getObjectIdField(), f = "", h = c.length; A.forEach(c, q.hitch(this, function (p, B) { f += a + " \x3d " + p; B !== h - 1 && (f += " OR ") }));
                                                                        this._query(f).then(q.hitch(this, function (p) { g.resolve(p) }), q.hitch(this, function (p) { g.reject(p) }))
                                                                } else g.reject(e)
                                                        })); return g
                                                }, _queryCount: function () { var c = new l; c.where = this.query.where; c.geometry = this.query.geometry; c.outSpatialReference = this.query.outSpatialReference; c.spatialRelationship = this.query.spatialRelationship; c.returnGeometry = !1; return (new k(this.url)).executeForCount(c) }, _queryWithPaginationAndOrder: function (c) {
                                                        var g = new l; g.where = this.query.where; g.geometry = this.query.geometry; g.outSpatialReference =
                                                                this.query.outSpatialReference; g.returnGeometry = this.query.returnGeometry; g.spatialRelationship = this.query.spatialRelationship; g.outFields = this.query.outFields; g.returnDistinctValues = this.query.returnDistinctValues; g.start = c; g.num = this.pageSize; (c = this.query.orderByFields) && 0 < c.length && (g.orderByFields = c, c = A.map(c, q.hitch(this, function (b) { return b.split(" ")[0] })), A.forEach(c, q.hitch(this, function (b) { 0 > g.outFields.indexOf(b) && g.outFields.push(b) }))); return (new k(this.url)).execute(g)
                                                }
                                        }); d._isServiceSupportsOrderBy =
                                                function (c) { var g = !1; c.advancedQueryCapabilities && c.advancedQueryCapabilities.supportsOrderBy && (g = !0); return g }; d._isServiceSupportsPagination = function (c) { var g = !1; c.advancedQueryCapabilities && c.advancedQueryCapabilities.supportsPagination && (g = !0); return g }; d._isSupportObjectIds = function (c) { var g = 0; c = c.currentVersion ? c : c.toJson().layerDefinition; c.currentVersion && (g = parseFloat(c.currentVersion)); return 10 <= g || c.hasOwnProperty("typeIdField") }; d.getQueryType = function (c) {
                                                        var g = -1; return g = d._isServiceSupportsOrderBy(c) &&
                                                                d._isServiceSupportsPagination(c) ? 1 : d._isSupportObjectIds(c) ? 2 : 3
                                                }; return d
                                })
                }, "jimu/shared/AppVersionManager": function () {
                        define(["./BaseVersionManager", "./utils"], function (E, q) {
                                function A() {
                                        this.versions = [{ version: "1.0", description: "The version embedded in portal 10.3 final.", upgrader: function (w) { return w }, compatible: !0 }, {
                                                version: "1.1", description: "The version embedded in online3.6, and used in developer edition 1.0.", upgrader: function (w) {
                                                        w.widgetOnScreen && w.widgetOnScreen.panel && ("themes/FoldableTheme/panels/TitlePanel/Panel" ===
                                                                w.widgetOnScreen.panel.uri || "jimu/BaseWidgetPanel" === w.widgetOnScreen.panel.uri) && (w.widgetOnScreen.panel.uri = "jimu/PreloadWidgetIconPanel"); return w
                                                }, compatible: !0
                                        }, {
                                                version: "1.2", description: "The version embedded in online3.7.", upgrader: function (w) {
                                                        var m = 0; if (w.widgetOnScreen && w.widgetOnScreen.widgets) {
                                                                var v = !1; for (m = 0; m < w.widgetOnScreen.widgets.length; m++)"widgets/Splash/Widget" === w.widgetOnScreen.widgets[m].uri && (v = !0); v || w.widgetOnScreen.widgets.push({
                                                                        uri: "widgets/Splash/Widget", visible: !1, positionRelativeTo: "browser",
                                                                        version: "1.2"
                                                                }); v = !1; for (m = 0; m < w.widgetOnScreen.widgets.length; m++)"widgets/TimeSlider/Widget" === w.widgetOnScreen.widgets[m].uri && (v = !0); v || w.widgetOnScreen.widgets.push({ uri: "widgets/TimeSlider/Widget", visible: !1, position: { bottom: 55, left: 7 }, version: "1.2" }); v = !1; for (m = 0; m < w.widgetOnScreen.widgets.length; m++)"widgets/Swipe/Widget" === w.widgetOnScreen.widgets[m].uri && (v = !0); v || w.widgetOnScreen.widgets.push({ uri: "widgets/Swipe/Widget", visible: !1, position: { top: 145, left: 7 }, version: "1.2" })
                                                        } return w
                                                }, compatible: !0
                                        },
                                        {
                                                version: "1.3", description: "The version embedded in online3.8 \x26 online3.9.", upgrader: function (w) {
                                                        (function (m) {
                                                                q.visitElement(m, function (r) { r.positionRelativeTo && (r.position ? r.position.relativeTo = r.positionRelativeTo : r.position = { relativeTo: r.positionRelativeTo }, r.panel && (r.panel.position ? r.panel.position.relativeTo = r.panel.positionRelativeTo : r.panel.position = { relativeTo: r.panel.positionRelativeTo })) }); var v = m.widgetOnScreen; v && v.panel && v.panel.positionRelativeTo && (v.panel.position ? v.panel.position.relativeTo =
                                                                        v.panel.positionRelativeTo : v.panel.position = { relativeTo: v.panel.positionRelativeTo }); (v = m.widgetPool) && v.panel && v.panel.positionRelativeTo && (v.panel.position ? v.panel.position.relativeTo = v.panel.positionRelativeTo : v.panel.position = { relativeTo: v.panel.positionRelativeTo })
                                                        })(w); w.widgetOnScreen && w.widgetOnScreen.panel && "jimu/PreloadWidgetIconPanel" === w.widgetOnScreen.panel.uri && (w.widgetOnScreen.panel.uri = "jimu/OnScreenWidgetPanel"); (function (m) {
                                                                if (m.widgetOnScreen && m.widgetOnScreen.widgets && m.theme &&
                                                                        "FoldableTheme" === m.theme.name) { var v = null, r = null; if (v = m.widgetOnScreen.widgets[4]) void 0 !== v.position.top ? (v = { position: { left: 205, top: 45 } }, r = { position: { left: 255, top: 45 } }) : (v = { position: { left: 205, bottom: 55 } }, r = { position: { left: 255, bottom: 55 } }), m.widgetOnScreen.widgets.splice(7, 0, v, r) }
                                                        })(w); (function () {
                                                                var m = 0, v = 0, r = !1; for (m = 0; m < w.widgetOnScreen.widgets.length; m++)if ("widgets/Geocoder/Widget" === w.widgetOnScreen.widgets[m].uri) { r = !0; break } var l = !1; for (v = 0; v < w.widgetOnScreen.widgets.length; v++)if ("widgets/Search/Widget" ===
                                                                        w.widgetOnScreen.widgets[v].uri) { l = !0; break } !l && r && (m = w.widgetOnScreen.widgets[m], m.uri = "widgets/Search/Widget", m.name = "Search")
                                                        })(w); (function (m) {
                                                                var v = 0; for (v = m.widgetOnScreen.widgets.length - 1; 0 <= v; v--) {
                                                                        var r = m.widgetOnScreen.widgets[v]; if ("widgets/Swipe/Widget" === r.uri && !r.closeable && (m.widgetOnScreen.widgets.splice(v, 1), !1 !== r.visible)) {
                                                                                r.closeable = !0; var l; a: { for (l = l = 0; l < m.widgetOnScreen.widgets.length; l++)if (!m.widgetOnScreen.widgets[l].uri) break a; l = -1 } 0 <= l && (r.position = m.widgetOnScreen.widgets[l].position,
                                                                                        m.widgetOnScreen.widgets[l] = r)
                                                                        } "widgets/TimeSlider/Widget" === r.uri && (!1 === r.visible ? m.widgetOnScreen.widgets.splice(v, 1) : r.closeable = !0)
                                                                }
                                                        })(w); w.widgetOnScreen.widgets.push({ uri: "widgets/ZoomSlider/Widget", position: { top: 5, left: 7 }, version: "1.3" }); w.loadingPage || (w.loadingPage = { backgroundColor: "#508dca", backgroundImage: { visible: !1 }, loadingGif: { visible: !0, uri: "configs/loading/images/predefined_loading_1.gif", width: 58, height: 58 } }); return w
                                                }, compatible: !0
                                        }, {
                                                version: "1.4", description: "The version embedded in online3.10.",
                                                upgrader: function (w) { if (w.theme) { var m = w.theme.name; if (("FoldableTheme" === m || "JewelryBoxTheme" === m) && w.widgetOnScreen) { var v = w.widgetOnScreen.widgets; if (v && 0 < v.length) { m = "themes/" + m + "/widgets/HeaderController/Widget"; for (var r = null, l = 0; l < v.length; l++)(r = v[l]) && r.uri === m && r.position && 310 === r.position.paddingRight && (r.position.paddingRight = 275) } } } return w }, compatible: !0
                                        }, { version: "2.0beta", description: "The version for Developer Edition beta 2.0.", upgrader: function (w) { w.keepAppState = !0; return w }, compatible: !0 },
                                        { version: "2.0", description: "The version for Online 4.1.", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.0.1", description: "The version for Developer Edition 2.0.", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.1", description: "The version for Online 4.2.", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.2", description: "The version for Online 4.3.", upgrader: function (w) { return w }, compatible: !0 }, {
                                                version: "2.3", description: "The version for Online 4.4.", upgrader: function (w) {
                                                        function m(l,
                                                                k) { if (!l || !k) return !1; for (var n in k) if (k.hasOwnProperty(n)) if ("object" === typeof k[n]) { if (!m(l[n], k[n])) return !1 } else if (l[n] !== k[n]) return !1; return !0 } function v(l) {
                                                                        function k() { var c = m(l[3], { uri: "widgets/MyLocation/Widget", position: { left: 15, top: 120 } }), g = m(l[12], { position: { top: 10, right: 195 } }); return c && g } function n() { var c = m(l[3], { uri: "widgets/MyLocation/Widget", position: { left: 15, bottom: 45 } }), g = m(l[12], { position: { left: 15, top: 233 } }); return c && g } function d() {
                                                                                var c = m(l[3], {
                                                                                        uri: "widgets/MyLocation/Widget",
                                                                                        position: { left: 15, top: 120 }
                                                                                }), g = m(l[12], { position: { right: 15, top: 195 } }); return c && g
                                                                        } (function () { var c = m(l[3], { uri: "widgets/MyLocation/Widget", position: { left: 15, top: 120 } }), g = m(l[12], { position: { left: 240, top: 53 } }); return c && g })() ? l.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { left: 15, top: 159 }, version: "2.3" }) : k() ? l.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { left: 15, top: 159 }, version: "2.3" }) : n() ? l.push({
                                                                                uri: "widgets/ExtentNavigate/Widget", visible: !1, position: {
                                                                                        left: 15,
                                                                                        bottom: 195
                                                                                }, version: "2.3"
                                                                        }) : d() && l.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { left: 15, top: 159 }, version: "2.3" })
                                                                } function r(l) {
                                                                        function k() { var d = m(l[9], { uri: "widgets/MyLocation/Widget", position: { left: 7, top: 110 } }), c = m(l[2], { uri: "widgets/Search/Widget", position: { left: 55, top: 5 } }), g = m(l[4], { position: { left: 7, bottom: 70 } }); return d && c && g } function n() {
                                                                                var d = m(l[9], { uri: "widgets/MyLocation/Widget", position: { left: 7, top: 110 } }), c = m(l[2], {
                                                                                        uri: "widgets/Search/Widget", position: {
                                                                                                right: 2, top: 2,
                                                                                                relativeTo: "browser"
                                                                                        }
                                                                                }), g = m(l[4], { position: { left: 7, bottom: 70 } }); return d && c && g
                                                                        } (function () { var d = m(l[9], { uri: "widgets/MyLocation/Widget", position: { left: 7, top: 110 } }), c = m(l[2], { uri: "widgets/Search/Widget", position: { left: 55, top: 5 } }), g = m(l[4], { position: { left: 55, top: 45 } }); return d && c && g }() || k() || n()) && l.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { top: 148, left: 7 }, version: "2.3" })
                                                                } (function (l, k, n) {
                                                                        l = l.theme && l.theme.name; if ("FoldableTheme" === l) if (m(k[11], {
                                                                                uri: "widgets/MyLocation/Widget",
                                                                                position: { left: 7, top: 110 }
                                                                        })) k.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { top: 150, left: 7 }, version: "2.3" }); else if (m(k[11], { uri: "widgets/MyLocation/Widget", position: { left: 12, bottom: 164 } })) k.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { left: 12, bottom: 203 }, version: "2.3" }), n && n.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { right: 12, top: 211 }, version: "2.3" }); else {
                                                                                if (m(k[11], { uri: "widgets/MyLocation/Widget", position: { left: 164, bottom: 14 } })) {
                                                                                        k.push({
                                                                                                uri: "widgets/ExtentNavigate/Widget",
                                                                                                visible: !1, position: { left: 203, bottom: 14, height: 30 }, version: "2.3"
                                                                                        }); for (l = 0; l < k.length; l++) { var d = k[l]; m(d, { uri: "widgets/Scalebar/Widget", position: { left: 220, bottom: 5 } }) && (d.position.left = 288); m(d, { uri: "widgets/Coordinate/Widget", position: { left: 395, bottom: 5 } }) && (d.position.left = 463) } n && n.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { top: 209, left: 12 }, version: "2.3" })
                                                                                }
                                                                        } else if ("BillboardTheme" === l) v(k); else if ("BoxTheme" === l) k.push({
                                                                                uri: "widgets/ExtentNavigate/Widget", visible: !1, position: {
                                                                                        left: 10,
                                                                                        top: 131
                                                                                }, version: "2.3"
                                                                        }); else if ("JewelryBoxTheme" === l) r(k); else if ("LaunchpadTheme" === l) { if (m(k[6], { uri: "widgets/MyLocation/Widget", position: { left: 25, top: 215 } }) || m(k[6], { uri: "widgets/MyLocation/Widget", position: { left: 25, top: 215 } })) k.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { top: 255, left: 25 }, version: "2.3" }), n && n.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { right: 10, bottom: 238 }, version: "2.3" }) } else "PlateauTheme" === l ? (m(k[6], {
                                                                                uri: "widgets/MyLocation/Widget", position: {
                                                                                        left: 7,
                                                                                        top: 110
                                                                                }
                                                                        }) && k.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { top: 149, left: 7 }, version: 2.3 }), m(k[6], { uri: "widgets/MyLocation/Widget", position: { left: 12, bottom: 164 } }) && k.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { left: 12, bottom: 201 }, version: 2.3 })) : "TabTheme" === l && m(k[11], { uri: "widgets/MyLocation/Widget", position: { left: 7, top: 110 } }) && k.push({ uri: "widgets/ExtentNavigate/Widget", visible: !1, position: { top: 149, left: 7 }, version: "2.3" })
                                                                })(w, w.widgetOnScreen.widgets, w.mobileLayout &&
                                                                        w.mobileLayout.widgetOnScreen && w.mobileLayout.widgetOnScreen.widgets); return w
                                                }, compatible: !0
                                        }, { version: "2.4", description: "The version for Online 5.1.", upgrader: function (w) { return w }, compatible: !0 }, {
                                                version: "2.5", description: "The version for Online 5.2.", upgrader: function (w) {
                                                        function m(v, r) { if (!v || !r) return !1; for (var l in r) if (r.hasOwnProperty(l)) if ("object" === typeof r[l]) { if (!m(v[l], r[l])) return !1 } else if (v[l] !== r[l]) return !1; return !0 } (function (v, r) {
                                                                v = v.theme && v.theme.name; if ("BillboardTheme" ===
                                                                        v) { v = m(r[8], { position: { left: 60, top: 53 } }); var l = m(r[8], { position: { left: 15, top: 53 } }); v || l ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, bottom: 55 }, version: "2.5" }) } else if ("BoxTheme" === v) {
                                                                                a: { v = 0; for (l = r.length; v < l; v++) { var k = r[v]; if (k && k.uri && "themes/BoxTheme/widgets/BoxController/Widget" === k.uri) { v = k; break a } } v = null } m(v, { position: { right: 0, bottom: 0 } }) ? r.push({
                                                                                        uri: "widgets/FullScreen/Widget",
                                                                                        visible: !1, position: { right: 8, top: 8 }, version: "2.5"
                                                                                }) : r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, bottom: 8 }, version: "2.5" })
                                                                        } else "DartTheme" === v ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : "FoldableTheme" === v ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : "DashboardTheme" === v ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : "JewelryBoxTheme" ===
                                                                                v ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : "LaunchpadTheme" === v ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 70, top: 20 }, version: "2.5" }) : "PlateauTheme" === v ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : "TabTheme" === v && (m(r[7], { position: { left: 45, top: 45 } }) ? r.push({ uri: "widgets/FullScreen/Widget", visible: !1, position: { right: 8, top: 8 }, version: "2.5" }) : r.push({
                                                                                        uri: "widgets/FullScreen/Widget",
                                                                                        visible: !1, position: { right: 8, bottom: 55 }, version: "2.5"
                                                                                }))
                                                        })(w, w.widgetOnScreen.widgets); return w
                                                }, compatible: !0
                                        }, { version: "2.6", description: "The version for Online 5.3.", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.7", description: "The version for Online 5.4.", upgrader: function (w) { return w }, compatible: !0 }, {
                                                version: "2.8", description: "The version for Online 6.1.", upgrader: function (w) {
                                                        function m(v) { var r = []; if ("object" === typeof v) for (var l in v) { var k = v[l]; "FeatureStatistics" === k.type && r.push(k) } return r }
                                                        (function (v) { (v = v.dataSource && v.dataSource.dataSources) && (v = m(v)) && v.length && v.forEach(function (r) { (r = r.dataSchema && r.dataSchema.statistics) && r.length && r.forEach(function (l) { if (l && "count" === l.statisticType && "count" === l.outStatisticFieldName) l.outStatisticFieldName = "STAT_COUNT"; else { var k = (k = l.outStatisticFieldName) && k.toUpperCase(); l.outStatisticFieldName = k } }) }) })(w); return w
                                                }, compatible: !0
                                        }, { version: "2.9", description: "The version for Online 6.2.", upgrader: function (w) { return w }, compatible: !0 }, {
                                                version: "2.10",
                                                description: "The version for Online 6.3.", upgrader: function (w) { return w }, compatible: !0
                                        }, { version: "2.11", description: "The version for Online 6.4.", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.12", description: "The version for Online 7.1", upgrader: function (w) { return w }, compatible: !0 }, {
                                                version: "2.13", description: "The version for Online 7.2", upgrader: function (w) {
                                                        if (w.theme && "PlateauTheme" === w.theme.name && w.widgetOnScreen && w.widgetOnScreen.widgets) for (var m = w.widgetOnScreen.widgets, v = 0; v < m.length; v++)if ("widgets/AttributeTable/Widget" ===
                                                                m[v].uri && m[v].position) { m[v].position.relativeTo = "browser"; break } return w
                                                }, compatible: !0
                                        }, { version: "2.14", description: "The version for Online 7.3", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.15", description: "The version for Online 7.4", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.16", description: "The version for Online 8.1", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.17", description: "The version for Online 8.2", upgrader: function (w) { return w }, compatible: !0 },
                                        { version: "2.18", description: "The version for Online 8.3", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.19", description: "The version for Online 8.4", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.20", description: "The version for Online 9.1", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.21", description: "The version for Online 9.2", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.22", description: "The version for Online 9.3", upgrader: function (w) { return w }, compatible: !0 },
                                        { version: "2.23", description: "The version for Online 9.4", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.24", description: "The version for Online 10.1", upgrader: function (w) { return w }, compatible: !0 }, { version: "2.25", description: "The version for Online 10.2", upgrader: function (w) { return w }, compatible: !0 }]; this.isCompatible = function (w, m) { w = this.getVersionIndex(w); m = this.getVersionIndex(m); for (w += 1; w <= m; w++)if (!1 === this.versions[w].compatible) return !1; return !0 }
                                } A.prototype = new E; return A.prototype.constructor =
                                        A
                        })
                }, "jimu/shared/BaseVersionManager": function () {
                        define(function () {
                                return function () {
                                        this.versions = []; this.upgrade = function (E, q, A) { q = this.getVersionIndex(q); A = this.getVersionIndex(A); if (q > A) throw Error("New version should be higher than the old version."); for (q += 1; q <= A; q++)this.versions[q].upgrader && (E = this.versions[q].upgrader(E)); return E }; this.getVersionIndex = function (E) {
                                                E = this.fixVersion(E); var q, A; for (A = 0; A < this.versions.length; A++)this.versions[A].version === E && (q = A); null === E && (q = -1); void 0 ===
                                                        q && (q = this.versions.length - 1); return q
                                        }; this.fixVersion = function (E) { return E ? E : null }
                                }
                        })
                }, "jimu/ConfigLoader": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/config dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr dojo/request/script ./utils ./privilegeUtils ./WidgetManager ./shared/utils ./tokenUtils ./portalUtils ./appConfigResourceUtils ./portalUrlUtils ./AppStateManager esri/IdentityManager esri/config esri/urlUtils esri/arcgis/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z) {
                                        var x = null; var y = E(null, {
                                                urlParams: null, appConfig: null, rawAppConfig: null, configFile: null, _configLoaded: !1, portalSelf: null, constructor: function (D, H) { this._removeHash(D); this.urlParams = D || {}; this.widgetManager = g.getInstance(); q.mixin(this, H) }, loadConfig: function () {
                                                        console.time("Load Config"); return this._tryLoadConfig().then(q.hitch(this, function (D) {
                                                                var H = this.checkConfig(D); if (H) throw Error(H); this.rawAppConfig = q.clone(D); p.getInstance().setRawAppConfig(this.rawAppConfig);
                                                                D = this._upgradeAppConfig(D); this._processAfterTryLoad(D); this.appConfig = D; if (this.urlParams.id) return this.loadWidgetsManifest(D).then(q.hitch(this, function () { return this.loadAndUpgradeAllWidgetsConfig(D) })).then(q.hitch(this, function (I) { return this.updateNecessaryAttrOfResourceUrlInAppConfig(I, this.urlParams.id) })).then(q.hitch(this, function () { this._configLoaded = !0; this._setDocumentTitle(D); this._readAndSetSharedTheme(D); return this.getAppConfig() })); e.setPortalUrl(D.portalUrl); z.arcgisUrl = h.getBaseItemUrl(D.portalUrl);
                                                                return this._proesssWebTierAndSignin(D).then(q.hitch(this, function () {
                                                                        if (this.urlParams.appid) {
                                                                                if (window.appInfo.isRunInPortal) {
                                                                                        var I = h.getStandardPortalUrl(D.portalUrl), N = a.getPortal(I); return c.checkIsSelfOrigin(this.urlParams.appid, N, e.isInBuilderWindow()).then(q.hitch(this, function (T) { if (!T) throw T = Error(window.jimuNls.orgUrlMessage), T.isSelfOrigin = !1, T; })).then(q.hitch(this, function () {
                                                                                                return c.checkEssentialAppsLicense(this.urlParams.appid, N, e.isInBuilderWindow()).then(q.hitch(this, function () {
                                                                                                        return this._getAppConfigFromTemplateAppId(D.portalUrl,
                                                                                                                this.urlParams.appid).then(q.hitch(this, function (T) { this._tryUpdateAppConfigByLocationUrl(T); return this._processInPortalAppProtocol(T) }))
                                                                                                }), q.hitch(this, function (T) { console.error(T); if (T.isBlockedByOrg) throw Error(window.jimuNls.blockedByAdminErrorForApp); throw Error(window.jimuNls.essentialAppsLicenseErrorForApp); }))
                                                                                        }))
                                                                                } return this._processNotInPortalAppProtocol(D).then(q.hitch(this, function (T) {
                                                                                        return this._getAppDataAddTemplateDataFromTemplateAppId(T.portalUrl, this.urlParams.appid).then(q.hitch(this,
                                                                                                function (M) { M.appData.appConfig && (T = M.appData.appConfig); T._appData = M.appData; T.templateConfig = M.templateData; T.isTemplateApp = !0; return T }))
                                                                                }))
                                                                        } return this._processNotInPortalAppProtocol(D)
                                                                })).then(q.hitch(this, function (I) { this._processAfterTryLoad(I); this.appConfig = I; return I.map.itemId ? I : (I.map["3D"] ? a.getDefaultWebScene(I.portalUrl) : a.getDefaultWebMap(I.portalUrl)).then(function (N) { I.map.itemId = N; return I }) })).then(q.hitch(this, function (I) { return this.loadWidgetsManifest(I) })).then(q.hitch(this,
                                                                        function (I) { return I._appData ? I._appData.values && I._appData.values.webmap ? a.getPortal(I.portalUrl).getItemById(I._appData.values.webmap).then(q.hitch(this, function (N) { return d.template.mergeTemplateAppConfigToAppConfig(I, I._appData, N) })) : d.template.mergeTemplateAppConfigToAppConfig(I, I._appData) : I })).then(q.hitch(this, function (I) { return this.loadAndUpgradeAllWidgetsConfig(I) })).then(q.hitch(this, function (I) {
                                                                                return I._wabAppId ? this.processResourceInAppConfigForConfigLoader(I, this.urlParams) : I.appItemId &&
                                                                                        -1 < window.JSON.stringify(I).indexOf("${itemId}") ? this.updateNecessaryAttrOfResourceUrlInAppConfig(I, I.appItemId) : I
                                                                        })).then(q.hitch(this, function (I) { this.appConfig = I; this._configLoaded = !0; this._setDocumentTitle(I); this._readAndSetSharedTheme(I); return this.getAppConfig() }))
                                                        }), q.hitch(this, function (D) { var H = new r; H.reject(D); return H }))
                                                }, processResourceInAppConfigForConfigLoader: function (D, H) {
                                                        var I = D.portalUrl, N = D.appItemId, T = H.appid, M = new r, R = q.clone(D); this.updateNecessaryAttrOfResourceUrlInAppConfig(R,
                                                                T).then(function () { if ("config" === H.mode) { var ca = this.getResourceUrlsOfAppConfig(D).result; 0 !== ca.length ? a.getItemResources(I, T).then(function (K) { if (0 === K.length) return ca = ca.map(function (Q) { return { resUrl: Q } }), f.AddResourcesToItemForAppSave(I, ca, N, T).then(function () { M.resolve(R) }, function (Q) { console.warn("Add resource to template based app error:" + Q.message || Q); M.resolve(R) }); M.resolve(R) }, function (K) { console.warn("Get resource of template based item error:" + K.message || K); M.resolve(R) }) : M.resolve(R) } else M.resolve(R) }.bind(this),
                                                                        function (ca) { console.warn("Insert appId to resource url of appConfig error:" + ca.message || ca); M.resolve(R) }); return M
                                                }, getResourceUrlsOfAppConfig: function (D) { var H = { test: function (I) { return /^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(I) }, func: q.hitch(this, function (I) { return I.value }) }; return d.processItemResourceOfAppConfig(D, H) }, updateNecessaryAttrOfResourceUrlInAppConfig: function (D, H) {
                                                        function I(R) { return /^https?:\/\/(.)+\/sharing\/rest\/content\/items\/(.)+\/resources\/inConfig\//.test(R) }
                                                        function N(R, ca) { R = M.processItemIDAndTokenOfResources(ca.value, R); R = M.setResouceProtocolForHttps(R); var K = ca.obj, Q = ca.key; "number" === typeof ca.i ? K[Q][ca.i] = R : K[Q] = R; return !0 } var T = D.portalUrl, M = this; return a.getPortal(T).getItemById(H).then(q.hitch(this, function (R) { R = { test: I, func: q.hitch(this, N, { appId: H, isPublic: "public" === R.access, portalUrl: T }) }; return d.processItemResourceOfAppConfig(D, R).appConfig }))
                                                }, setResouceProtocolForHttps: function (D) {
                                                        var H = D; "https:" === window.location.protocol && (H = D.replace(/^http(s?):\/\//i,
                                                                "https://")); return H
                                                }, processItemIDAndTokenOfResources: function (D, H) { 0 < D.indexOf("${itemId}") && (D = D.replace("${itemId}", H.appId)); /(\?|&)token=.+/.test(D) && (D = D.replace(/(\?|&)token=.+/, "")); H.isPublic || (H = e.getPortalCredential(H.portalUrl)) && (D += "?token\x3d" + H.token); return D }, _setDocumentTitle: function (D) { !window.isBuilder && D && D.title && (document.title = d.stripHTML(D.title)) }, getAppConfig: function () {
                                                        var D = q.clone(this.appConfig); D.getConfigElementById = function (H) {
                                                                return d.getConfigElementById(this,
                                                                        H)
                                                        }; D.getConfigElementsByName = function (H) { return d.getConfigElementsByName(this, H) }; D.visitElement = function (H) { d.visitElement(this, H) }; this._addAuthorizedCrossOriginDomains(this.portalSelf, D); return D
                                                }, _addAuthorizedCrossOriginDomains: function (D, H) { D && D.authorizedCrossOriginDomains && e.addAuthorizedCrossOriginDomains(D.authorizedCrossOriginDomains); H && H.authorizedCrossOriginDomains && e.addAuthorizedCrossOriginDomains(H.authorizedCrossOriginDomains) }, checkConfig: function () { return !1 }, processProxy: function (D) {
                                                        t.defaults.io.alwaysUseProxy =
                                                        D.httpProxy && D.httpProxy.useProxy && D.httpProxy.alwaysUseProxy; t.defaults.io.proxyUrl = ""; t.defaults.io.proxyRules = []; D.httpProxy && D.httpProxy.useProxy && D.httpProxy.url && (t.defaults.io.proxyUrl = D.httpProxy.url); D.httpProxy && D.httpProxy.useProxy && D.httpProxy.rules && A.forEach(D.httpProxy.rules, function (H) { u.addProxyRule(H) })
                                                }, addNeedValues: function (D) { this._processNoUriWidgets(D); this._processEmptyGroups(D); this._addElementId(D); this._fixRepeatedId(D) }, showError: function (D) {
                                                        D && D.message && (w.create("div",
                                                                { "class": "app-error", innerHTML: d.sanitizeHTML(D.message) }, document.body), w.setStyle(jimuConfig.loadingId, "display", "none"))
                                                }, _tryLoadConfig: function () {
                                                        "stemapp" === this.urlParams.id && (this.urlParams.config = window.appInfo.appPath + "config.json", delete this.urlParams.id); if (this.urlParams.config) return this.configFile = this.urlParams.config, k(this.configFile, { handleAs: "json", headers: { "X-Requested-With": null } }).then(q.hitch(this, function (N) {
                                                                e.setPortalUrl(N.portalUrl); N.portalUrl && (window.portalUrl = N.portalUrl);
                                                                return this.urlParams.token ? e.registerToken(this.urlParams.token).then(function () { return N }) : N
                                                        })); if (this.urlParams.id) {
                                                                window.appInfo.isRunInPortal = !0; var D = h.getPortalUrlFromLocation(), H = new r; e.setPortalUrl(D); window.portalUrl = D; z.arcgisUrl = h.getBaseItemUrl(D); if (this.urlParams.token) var I = e.registerToken(this.urlParams.token); else I = new r, I.resolve(); I.then(q.hitch(this, function () {
                                                                        var N = a.getPortal(D); N.loadSelfInfo().then(q.hitch(this, function (T) {
                                                                                this.portalSelf = T; T.allSSL && "http:" === window.location.protocol ?
                                                                                        (console.log("redirect from http to https"), window.location.href = h.setHttpsProtocol(window.location.href), H.reject()) : this._processSignIn(D).then(q.hitch(this, function () {
                                                                                                this._getAppConfigFromAppId(D, this.urlParams.id).then(q.hitch(this, function (M) { return c.checkIsSelfOrigin(this.urlParams.id, N, e.isInBuilderWindow()).then(q.hitch(this, function (R) { if (R) return M; R = Error(window.jimuNls.orgUrlMessage); R.isSelfOrigin = !1; throw R; })) })).then(q.hitch(this, function (M) {
                                                                                                        return c.checkEssentialAppsLicense(this.urlParams.id,
                                                                                                                N, e.isInBuilderWindow()).then(q.hitch(this, function () { this._tryUpdateAppConfigByLocationUrl(M); return this._processInPortalAppProtocol(M) }), q.hitch(this, function (R) { console.error(R); if (R.isBlockedByOrg) throw Error(window.jimuNls.blockedByAdminErrorForApp); throw Error(window.jimuNls.essentialAppsLicenseErrorForApp); }))
                                                                                                })).then(function (M) { H.resolve(M) }, function (M) { H.reject(M) })
                                                                                        }))
                                                                        }))
                                                                }), q.hitch(this, function (N) { this.showError(N) })); return H
                                                        } this.configFile = "config.json"; return k(this.configFile, { handleAs: "json" }).then(q.hitch(this,
                                                                function (N) { e.setPortalUrl(N.portalUrl); N.portalUrl && (window.portalUrl = N.portalUrl); return this.urlParams.token ? e.registerToken(this.urlParams.token).then(function () { return N }) : N }))
                                                }, _upgradeAppConfig: function (D) { var H = window.wabVersion, I = D.wabVersion; D.configWabVersion = D.wabVersion; if (H === I) return D; var N = this.versionManager.getVersionIndex(I), T = this.versionManager.getVersionIndex(H); if (N > T) throw Error("Bad version number, " + I); D = this.versionManager.upgrade(D, I, H); D.wabVersion = H; return D }, loadAndUpgradeAllWidgetsConfig: function (D) {
                                                        var H =
                                                                new r, I = []; b.visitElement(D, q.hitch(this, function (N) { N.uri && (N = this.widgetManager.tryLoadWidgetConfig(N), I.push(N)) })); l(I).then(q.hitch(this, function () { H.resolve(D) }), function (N) { H.reject(N) }); return H
                                                }, _processAfterTryLoad: function (D) { this._setPortalUrl(D); this._tryUpdateAppConfigByLocationUrl(D); this._processUrlParams(D); this.addNeedValues(D); this.processProxy(D); B.tokenValidity = 10080; return D }, _readAndSetSharedTheme: function (D) {
                                                        D.theme.sharedTheme ? this.portalSelf.portalProperties && this.portalSelf.portalProperties.sharedTheme ||
                                                                (D.theme.sharedTheme.isPortalSupport = !1) : (D.theme.sharedTheme = { useHeader: !1, useLogo: !1 }, D.theme.sharedTheme.isPortalSupport = this.portalSelf.portalProperties && this.portalSelf.portalProperties.sharedTheme ? !0 : !1); D.theme.sharedTheme.useHeader && (D.theme.sharedTheme.isPortalSupport && this.portalSelf.portalProperties ? (D.theme.customStyles = { mainBackgroundColor: this.portalSelf.portalProperties.sharedTheme.header.background }, D.titleColor = this.portalSelf.portalProperties.sharedTheme.header.text) : console.error("Portal does not support sharedTheme."));
                                                        D.theme.sharedTheme.useLogo && (D.theme.sharedTheme.isPortalSupport && this.portalSelf.portalProperties ? (D.logo = this.portalSelf.portalProperties.sharedTheme.logo.small ? this.portalSelf.portalProperties.sharedTheme.logo.small : "images/app-logo.png", !D.logoLink && this.portalSelf.portalProperties.sharedTheme.logo.link && (D.logoLink = this.portalSelf.portalProperties.sharedTheme.logo.link)) : (console.error("Portal does not support sharedTheme, use default logo."), D.logo = "images/app-logo.png"))
                                                }, _tryUpdateAppConfigByLocationUrl: function (D) {
                                                        if (!(this.urlParams.config &&
                                                                -1 < this.urlParams.config.indexOf("arcgis.com/sharing/rest/content/items/"))) { var H = h.getPortalUrlFromLocation(); H = h.getStandardPortalUrl(H); h.isOnline(H) && (H = h.updateUrlProtocolByOtherUrl(H, D.portalUrl), D.map.portalUrl && h.isSamePortalUrl(D.portalUrl, D.map.portalUrl) && (D.map.portalUrl = H), D.portalUrl = H, D.httpProxy && D.httpProxy.url && (D.httpProxy.url = h.getPortalProxyUrl(H))) }
                                                }, _processWidgetJsons: function (D) { b.visitElement(D, function (H, I) { I.isWidget && H.uri && d.widgetJson.processWidgetJson(H) }) }, _processNoUriWidgets: function (D) {
                                                        var H =
                                                                0; b.visitElement(D, function (I, N) { N.isWidget && !I.uri && (H++, I.placeholderIndex = H) })
                                                }, _processEmptyGroups: function (D) { var H = 0; D.widgetOnScreen.groups && A.forEach(D.widgetOnScreen.groups, function (I) { if (!I.widgets || I.widgets && 0 === I.widgets.length) H++, I.placeholderIndex = H }) }, _addElementId: function (D) {
                                                        var H = 0, I; b.visitElement(D, function (N) { if (N.id) { N.id = N.id.replace(/\//g, "_"); var T = N.id.lastIndexOf("_"); -1 < T && (I = N.id.substr(T + 1), H = Math.max(H, I)) } }); b.visitElement(D, function (N) {
                                                                N.id || (H++, N.id = N.itemId ? N.itemId +
                                                                        "_" + H : N.uri ? N.uri.replace(/\//g, "_") + "_" + H : "_" + H)
                                                        })
                                                }, _setPortalUrl: function (D) { if (D.portalUrl) { var H = h.getPortalUrlFromLocation(), I = h.isOnline(H); h.isSamePortalUrl(D.portalUrl, H) || I || (window.appInfo.isRunInPortal = !1) } else window.isXT && v("wab_portalurl") ? D.portalUrl = v("wab_portalurl") : (window.appInfo.isRunInPortal = !0, D.portalUrl = h.getPortalUrlFromLocation()) }, _changePortalUrlProtocol: function (D, H) {
                                                        D.portalUrl = h.setProtocol(D.portalUrl, H); D.map.portalUrl && (D.map.portalUrl = h.setProtocol(D.map.portalUrl,
                                                                H)); D.httpProxy && (D.httpProxy.url = h.setProtocol(D.httpProxy.url, H), D.httpProxy && D.httpProxy.rules && A.forEach(D.httpProxy.rules, q.hitch(this, function (I) { I.proxyUrl = h.setProtocol(I.proxyUrl, H) })))
                                                }, _processInPortalAppProtocol: function (D) {
                                                        var H = new r, I = a.getPortal(D.portalUrl), N = q.hitch(this, function (T) {
                                                                if ("https:" === window.location.protocol) this._changePortalUrlProtocol(D, "https"); else {
                                                                        if (T) {
                                                                                console.log("redirect from http to https"); window.location.href = h.setHttpsProtocol(window.location.href); H.reject();
                                                                                return
                                                                        } this._changePortalUrlProtocol(D, "http")
                                                                } this._checkLocale(); H.resolve(D)
                                                        }); I.loadSelfInfo().then(q.hitch(this, function (T) { this.portalSelf = T; "private" === T.access ? (T = 0 === D.portalUrl.toLowerCase().indexOf("https://"), N(T)) : N(T.allSSL) }), q.hitch(this, function (T) { H.reject(T) })); return H
                                                }, _processNotInPortalAppProtocol: function (D) {
                                                        var H = new r; D.portalUrl ? a.getPortal(D.portalUrl).loadSelfInfo().then(q.hitch(this, function (I) {
                                                                this.portalSelf = I; var N = "https:" === window.location.protocol; (I.allSSL || N) &&
                                                                        this._changePortalUrlProtocol(D, "https"); 0 !== D.portalUrl.toLowerCase().indexOf("https://") || N || e.isInConfigOrPreviewWindow() ? H.resolve(D) : (console.log("redirect from http to https"), window.location.href = h.setHttpsProtocol(window.location.href), H.reject())
                                                        }), q.hitch(this, function (I) { H.reject(I) })) : H.resolve(D); return H
                                                }, _proesssWebTierAndSignin: function (D) {
                                                        var H = new r, I = !1, N = D.portalUrl; this._processWebTier(D).then(q.hitch(this, function (T) { I = T; return a.getPortal(N).loadSelfInfo() })).then(q.hitch(this,
                                                                function (T) { this.portalSelf = T; return this._processSignIn(N, I) })).then(q.hitch(this, function () { H.resolve() }), function (T) { H.reject(T) }); return H
                                                }, _processWebTier: function (D) {
                                                        var H = new r, I = D.portalUrl; D.isWebTier ? (e.addAuthorizedCrossOriginDomains([I]), e.isWebTierPortal(I).then(q.hitch(this, function () {
                                                                var N = e.getPortalCredential(I); N && N.ssl && "http:" === window.location.protocol && !e.isInConfigOrPreviewWindow() ? (console.log("redirect from http to https"), window.location.href = h.setHttpsProtocol(window.location.href)) :
                                                                        H.resolve(D.isWebTier)
                                                        }), q.hitch(this, function (N) { H.reject(N) }))) : H.resolve(!1); return H
                                                }, _processSignIn: function (D, H) {
                                                        var I = new r, N = a.getPortal(D), T = h.getSharingUrl(D), M = h.setHttpsProtocol(D + "/sharing/generateToken?f\x3djson"); window.appInfo.isRunInPortal ? (H = B.checkSignInStatus(T), H.promise.then(q.hitch(this, function (R) {
                                                                R.token ? (window.postMessageToSw({ type: "to_sw_credential", credential: R.toJson() }), I.resolve()) : n.get(M, { jsonp: "callback" }).then(q.hitch(this, function (ca) {
                                                                        ca && ca.token && (R.token = ca.token,
                                                                                R.expires || (R.expires = ca.expires)); I.resolve()
                                                                }), q.hitch(this, function (ca) { console.error(ca); I.resolve() }))
                                                        }), q.hitch(this, function () { window.postMessageToSw({ type: "to_sw_no_credential" }); window.isCredentialSettled = !0; I.resolve() }))) : (window.postMessageToSw({ type: "to_sw_no_credential" }), window.isCredentialSettled = !0, !e.isInBuilderWindow() && !e.isInConfigOrPreviewWindow() && this.portalSelf.supportsOAuth && this.rawAppConfig && this.rawAppConfig.appId && !H && e.registerOAuthInfo(D, this.rawAppConfig.appId, this.portalSelf.currentVersion),
                                                                H = B.checkSignInStatus(T), H.promise.always(q.hitch(this, function () { e.xtGetCredentialFromCookie(D); N.loadSelfInfo().then(q.hitch(this, function (R) { this.portalSelf = R; this._checkLocale(); I.resolve() })) }))); return I
                                                }, _checkLocale: function () { if (!e.isInConfigOrPreviewWindow()) { var D = this.portalSelf.user && this.portalSelf.user.culture || m.locale; D = "hi" === D ? "en" : D.toLowerCase(); !this.urlParams.locale && d.isLocaleChanged(m.locale, D) && (v("wab_app_locale", D), window.location.reload()) } }, _getAppConfigFromTemplateAppId: function (D,
                                                        H) { var I = a.getPortal(D); return this._getWabAppIdAndDataFromTemplateAppId(D, H).then(q.hitch(this, function (N) { var T = N.appId, M = N.appData; return l([this._getAppConfigFromAppId(D, T), I.getItemData(M.source)]).then(q.hitch(this, function (R) { if (M.appConfig) { var ca = M.appConfig; delete M.appConfig } else ca = R[0]; ca = this._upgradeAppConfig(ca); R = R[1]; ca._appData = M; ca._wabAppId = T; ca.templateConfig = R; ca.isTemplateApp = !0; return ca })) })) }, _getAppDataAddTemplateDataFromTemplateAppId: function (D, H) {
                                                                var I = a.getPortal(D);
                                                                return I.getItemData(H).then(function (N) { return I.getItemData(N.source).then(function (T) { return { appData: N, templateData: T } }) })
                                                        }, _getWabAppIdAndDataFromTemplateAppId: function (D, H) { var I = new r, N = a.getPortal(D); N.getItemData(H).then(q.hitch(this, function (T) { N.getItemById(T.source).then(q.hitch(this, function (M) { M = u.urlToObject(M.url); I.resolve({ appId: M.query.id, appData: T }) })) }), function (T) { I.reject(T) }); return I }, _getAppConfigFromAppId: function (D, H) { return a.getPortal(D).getItemData(H) }, _removeHash: function (D) {
                                                                for (var H in D) D[H] &&
                                                                        (D[H] = D[H].replace("#", ""))
                                                        }, loadWidgetsManifest: function (D) {
                                                                function H(M, R) { return M.loadWidgetManifest(R).then(function (ca) { return ca }, function (ca) { console.log("Widget failed to load, it is removed.", R.name); ca.stack ? console.error(ca.stack) : console.log(ca); I(D, R) }) } function I(M, R) {
                                                                        function ca(K) {
                                                                                M[K] && M[K].widgets && (M[K].widgets = M[K].widgets.filter(function (Q) { if (R) return Q.id !== R.id; Q.uri && !Q.manifest && console.error("Widget is removed because it is not loaded successfully.", Q.uri); return Q.manifest }));
                                                                                M[K] && M[K].groups && M[K].groups.forEach(function (Q) { Q.widgets && (Q.widgets = Q.widgets.filter(function (X) { if (R) return X.id !== R.id; X.uri && !X.manifest && console.error("Widget is removed because it is not loaded successfully.", X.uri); return X.manifest })) })
                                                                        } ca("widgetOnScreen"); ca("widgetPool")
                                                                } var N = [], T = new r; this.urlParams.manifest && D._buildInfo && D._buildInfo.widgetManifestsMerged && delete D._buildInfo.widgetManifestsMerged; D._buildInfo && D._buildInfo.widgetManifestsMerged ? this._loadMergedWidgetManifests().then(q.hitch(this,
                                                                        function (M) { b.visitElement(D, q.hitch(this, function (R) { R.widgets || !R.uri && !R.itemId || (R.uri && M[R.uri] ? (this._addNeedValuesForManifest(M[R.uri], R.uri), d.widgetJson.addManifest2WidgetJson(R, M[R.uri])) : N.push(H(this.widgetManager, R))) })); l(N).then(function () { T.resolve(D) }) })) : (b.visitElement(D, q.hitch(this, function (M) { M.widgets || !M.uri && !M.itemId || N.push(H(this.widgetManager, M)) })), l(N).then(function () { T.resolve(D) })); setTimeout(function () { T.isResolved() || (I(D), T.resolve(D)) }, 6E4); return T
                                                        }, _addNeedValuesForManifest: function (D,
                                                                H) { q.mixin(D, d.getUriInfo(H)); d.manifest.addManifestProperies(D); d.manifest.processManifestLabel(D, m.locale) }, _loadMergedWidgetManifests: function () { return k(window.appInfo.appPath + "widgets/widgets-manifest.json", { handleAs: "json" }) }, _fixRepeatedId: function (D) { var H = []; b.visitElement(D, function (I) { 0 <= H.indexOf(I.id) && (I.id += "_"); H.push(I.id) }) }, _processUrlParams: function (D) {
                                                                        var H = this.urlParams.itemid || this.urlParams.webmap; H && D.map.itemId !== H && (D.map.mapOptions && d.deleteMapOptions(D.map.mapOptions),
                                                                                D.map.itemId = H); this.urlParams.mode && (D.mode = this.urlParams.mode); D.map.mapOptions || (D.map.mapOptions = {}); this.urlParams.scale && (D.map.mapOptions.scale = this.urlParams.scale); if (this.urlParams.level || this.urlParams.zoom) D.map.mapOptions.zoom = this.urlParams.level || this.urlParams.zoom
                                                                }
                                        }); y.getInstance = function (D, H) { null === x ? x = new y(D, H) : (x.urlParams = D || {}, x.options = H); return x }; return y
                                })
                }, "jimu/appConfigResourceUtils": function () {
                        define(["dojo/Deferred", "dojo/promise/all", "jimu/portalUtils", "jimu/utils"],
                                function (E, q, A, w) {
                                        return {
                                                AddResourcesToItemForAppSave: function (m, v, r, l) {
                                                        v = v || []; if (0 === v.length) { var k = new E; k.resolve(v); return k } v = v.map(function (n) {
                                                                var d = n.resUrl.split("resources/")[1], c = new E; n.b64 ? (n = w.b64toBlob(n.b64), c.resolve({ blob: n, fileName: d.split("/")[1], prefixName: d.split("/")[0] })) : (n = n.resUrl, 0 < n.indexOf("${itemId}") && (n = n.replace("${itemId}", r)), w.resourcesUrlToBlob(n).then(function (g) {
                                                                        c.resolve({ blob: g, fileName: d.split("/")[1], prefixName: d.split("/")[0] }, function (b) {
                                                                                console.error(b.message ||
                                                                                        b); c.reject(b)
                                                                        })
                                                                })); return c
                                                        }); return q(v).then(function (n) { if (n instanceof Array && 0 < n.length) return n = n.map(function (d) { var c = r; l && (c = l); return A.addResource(m, c, d.blob, d.fileName, d.prefixName) }.bind(this)), q(n).then(function (d) { return d }) }.bind(this))
                                                }
                                        }
                                })
                }, "jimu/AppStateManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/json esri/geometry/Extent esri/SpatialReference libs/storejs/store libs/md5/md5 jimu/tokenUtils".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                var n = null,
                                d = E(null, {
                                        rawAppConfig: null, mapMd5: null, appStateKey: null, setRawAppConfig: function (c) { this.rawAppConfig = c }, _getAppStateMd5: function () { if ("string" !== typeof this.mapMd5) { var c = w.stringify(this.rawAppConfig.map); this.mapMd5 = l(c) } return this.mapMd5 }, _getAppStateKey: function () { return this.appStateKey ? this.appStateKey : this.appStateKey = "wab_appstate_" + this.urlParams.id || this.urlParams.appid || window.path }, getWabAppState: function () {
                                                var c = new A, g = {}; if (k.isInConfigOrPreviewWindow() || !this.rawAppConfig || !this.rawAppConfig.map) return c.resolve(g),
                                                        c; var b = this._getAppStateKey(), e = r.get(b); e && e.appStateMd5 === this._getAppStateMd5() ? (b = e.map && e.map.extent, e = e.map && e.map.layers, b && (g.extent = new m(b.xmin, b.ymin, b.xmax, b.ymax, new v(b.spatialReference))), e && (g.layers = e)) : r.remove(b); c.resolve(g); return c
                                        }, saveWabAppState: function (c, g) {
                                                if (c && !k.isInConfigOrPreviewWindow()) {
                                                        var b = this._getAppStateKey(), e = {
                                                                extent: { xmin: c.extent.xmin, xmax: c.extent.xmax, ymin: c.extent.ymin, ymax: c.extent.ymax, spatialReference: { wkid: c.extent.spatialReference.wkid, wkt: c.extent.spatialReference.wkt } },
                                                                layers: {}
                                                        }; g && g.traversal && g.traversal(q.hitch(this, function (a) { e.layers[a.id] = { visible: a.isVisible() } })); r.set(b, { map: e, appStateMd5: this._getAppStateMd5() })
                                                }
                                        }
                                }); d.getInstance = function (c) { null === n && (n = new d); n.urlParams = c; return n }; return d
                        })
                }, "libs/storejs/store": function () {
                        !function (E) {
                                "object" == typeof exports && "undefined" != typeof module ? module.exports = E() : "function" == typeof define && define.amd ? define([], E) : ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ?
                                        self : this).store = E()
                        }(function () {
                                return function m(q, A, w) { function v(k, n) { if (!A[k]) { if (!q[k]) { var d = "function" == typeof require && require; if (!n && d) return d(k, !0); if (r) return r(k, !0); n = Error("Cannot find module '" + k + "'"); throw n.code = "MODULE_NOT_FOUND", n; } n = A[k] = { exports: {} }; q[k][0].call(n.exports, function (c) { var g = q[k][1][c]; return v(g ? g : c) }, n, n.exports, m, q, A, w) } return A[k].exports } for (var r = "function" == typeof require && require, l = 0; l < w.length; l++)v(w[l]); return v }({
                                        1: [function (q, A, w) {
                                                w = q("../src/store-engine");
                                                var m = q("../storages/all"); q = q("../plugins/all"); A.exports = w.createStore(m, q)
                                        }, { "../plugins/all": 2, "../src/store-engine": 15, "../storages/all": 17 }], 2: [function (q, A, w) { A.exports = [q("./defaults"), q("./dump"), q("./events"), q("./observe"), q("./expire"), q("./json2"), q("./operations"), q("./update"), q("./v1-backcompat")] }, { "./compression": 3, "./defaults": 4, "./dump": 5, "./events": 6, "./expire": 7, "./json2": 8, "./observe": 11, "./operations": 12, "./update": 13, "./v1-backcompat": 14 }], 3: [function (q, A, w) {
                                                var m = q("./lib/lz-string");
                                                A.exports = function () { return { get: function (v, r) { v = v(r); if (!v) return v; r = m.decompress(v); return null == r ? v : this._deserialize(r) }, set: function (v, r, l) { l = m.compress(this._serialize(l)); v(r, l) } } }
                                        }, { "./lib/lz-string": 10 }], 4: [function (q, A, w) { A.exports = function () { var m = {}; return { defaults: function (v, r) { m = r }, get: function (v, r) { v = v(); return void 0 !== v ? v : m[r] } } } }, {}], 5: [function (q, A, w) { A.exports = function () { return { dump: function (m) { var v = {}; return this.each(function (r, l) { v[l] = r }), v } } } }, {}], 6: [function (q, A, w) {
                                                q = q("../src/util");
                                                var m = q.bind, v = q.each, r = q.create, l = q.slice; A.exports = function () { var n = r(k, { _id: 0, _subSignals: {}, _subCallbacks: {} }); return { watch: function (d, c, g) { return n.on(c, m(this, g)) }, unwatch: function (d, c) { n.off(c) }, once: function (d, c, g) { n.once(c, m(this, g)) }, set: function (d, c, g) { var b = this.get(c); d(); n.fire(c, g, b) }, remove: function (d, c) { var g = this.get(c); d(); n.fire(c, void 0, g) }, clearAll: function (d) { var c = {}; this.each(function (g, b) { c[b] = g }); d(); v(c, function (g, b) { n.fire(b, void 0, g) }) } } }; var k = {
                                                        _id: null, _subCallbacks: null,
                                                        _subSignals: null, on: function (n, d) { return this._subCallbacks[n] || (this._subCallbacks[n] = {}), this._id += 1, this._subCallbacks[n][this._id] = d, this._subSignals[this._id] = n, this._id }, off: function (n) { delete this._subCallbacks[this._subSignals[n]][n]; delete this._subSignals[n] }, once: function (n, d) { var c = this.on(n, m(this, function () { d.apply(this, arguments); this.off(c) })) }, fire: function (n) { var d = l(arguments, 1); v(this._subCallbacks[n], function (c) { c.apply(this, d) }) }
                                                }
                                        }, { "../src/util": 16 }], 7: [function (q, A, w) {
                                                A.exports =
                                                function () {
                                                        function m(r) { v.get(r, Number.MAX_VALUE) <= (new Date).getTime() && (this.raw.remove(r), v.remove(r)) } var v = this.createStore(this.storage, null, this._namespacePrefix + "expire_mixin"); return {
                                                                set: function (r, l, k, n) { return this.hasNamespace("expire_mixin") || v.set(l, n), r() }, get: function (r, l) { return this.hasNamespace("expire_mixin") || m.call(this, l), r() }, remove: function (r, l) { return this.hasNamespace("expire_mixin") || v.remove(l), r() }, getExpiration: function (r, l) { return v.get(l) }, removeExpiredKeys: function (r) {
                                                                        var l =
                                                                                []; this.each(function (k, n) { l.push(n) }); for (r = 0; r < l.length; r++)m.call(this, l[r])
                                                                }
                                                        }
                                                }
                                        }, {}], 8: [function (q, A, w) { A.exports = function () { return q("./lib/json2"), {} } }, { "./lib/json2": 9 }], 9: [function (q, A, w) {
                                                var m = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (v) { return typeof v } : function (v) { return v && "function" == typeof Symbol && v.constructor === Symbol && v !== Symbol.prototype ? "symbol" : typeof v }; "object" !== ("undefined" == typeof JSON ? "undefined" : m(JSON)) && (JSON = {}); (function () {
                                                        function v(B) {
                                                                return 10 >
                                                                        B ? "0" + B : B
                                                        } function r() { return this.valueOf() } function l(B) { return b.lastIndex = 0, b.test(B) ? '"' + B.replace(b, function (t) { var u = h[t]; return "string" == typeof u ? u : "\\u" + ("0000" + t.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + B + '"' } function k(B, t) {
                                                                var u, z, x, y = a, D = t[B]; switch (D && "object" === ("undefined" == typeof D ? "undefined" : m(D)) && "function" == typeof D.toJSON && (D = D.toJSON(B)), "function" == typeof p && (D = p.call(t, B, D)), "undefined" == typeof D ? "undefined" : m(D)) {
                                                                        case "string": return l(D); case "number": return isFinite(D) ?
                                                                                String(D) : "null"; case "boolean": case "null": return String(D); case "object": if (!D) return "null"; if (a += f, x = [], "[object Array]" === Object.prototype.toString.apply(D)) { t = D.length; for (B = 0; B < t; B += 1)x[B] = k(B, D) || "null"; return z = 0 === x.length ? "[]" : a ? "[\n" + a + x.join(",\n" + a) + "\n" + y + "]" : "[" + x.join(",") + "]", a = y, z } if (p && "object" === ("undefined" == typeof p ? "undefined" : m(p))) for (t = p.length, B = 0; B < t; B += 1)"string" == typeof p[B] && (u = p[B], z = k(u, D), z && x.push(l(u) + (a ? ": " : ":") + z)); else for (u in D) Object.prototype.hasOwnProperty.call(D,
                                                                                        u) && (z = k(u, D), z && x.push(l(u) + (a ? ": " : ":") + z)); return z = 0 === x.length ? "{}" : a ? "{\n" + a + x.join(",\n" + a) + "\n" + y + "}" : "{" + x.join(",") + "}", a = y, z
                                                                }
                                                        } var n = /^[\],:{}\s]*$/, d = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, c = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, g = /(?:^|:|,)(?:\s*\[)+/g, b = /[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, e = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
                                                        "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function () { return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + v(this.getUTCMonth() + 1) + "-" + v(this.getUTCDate()) + "T" + v(this.getUTCHours()) + ":" + v(this.getUTCMinutes()) + ":" + v(this.getUTCSeconds()) + "Z" : null }, Boolean.prototype.toJSON = r, Number.prototype.toJSON = r, String.prototype.toJSON = r); var a, f, h, p; "function" != typeof JSON.stringify && (h = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, JSON.stringify = function (B,
                                                                t, u) { var z; if (a = "", f = "", "number" == typeof u) for (z = 0; z < u; z += 1)f += " "; else "string" == typeof u && (f = u); if (p = t, t && "function" != typeof t && ("object" !== ("undefined" == typeof t ? "undefined" : m(t)) || "number" != typeof t.length)) throw Error("JSON.stringify"); return k("", { "": B }) }); "function" != typeof JSON.parse && (JSON.parse = function (B, t) {
                                                                        function u(x, y) {
                                                                                var D, H, I = x[y]; if (I && "object" === ("undefined" == typeof I ? "undefined" : m(I))) for (D in I) Object.prototype.hasOwnProperty.call(I, D) && (H = u(I, D), void 0 !== H ? I[D] = H : delete I[D]);
                                                                                return t.call(x, y, I)
                                                                        } var z; if (B = String(B), e.lastIndex = 0, e.test(B) && (B = B.replace(e, function (x) { return "\\u" + ("0000" + x.charCodeAt(0).toString(16)).slice(-4) })), n.test(B.replace(d, "@").replace(c, "]").replace(g, ""))) return z = eval("(" + B + ")"), "function" == typeof t ? u({ "": z }, "") : z; throw new SyntaxError("JSON.parse");
                                                                })
                                                })()
                                        }, {}], 10: [function (q, A, w) {
                                                q = function () {
                                                        function m(k, n) { if (!r[k]) { r[k] = {}; for (var d = 0; d < k.length; d++)r[k][k.charAt(d)] = d } return r[k][n] } var v = String.fromCharCode, r = {}, l = {
                                                                compressToBase64: function (k) {
                                                                        if (null ==
                                                                                k) return ""; k = l._compress(k, 6, function (n) { return "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(n) }); switch (k.length % 4) { default: case 0: return k; case 1: return k + "\x3d\x3d\x3d"; case 2: return k + "\x3d\x3d"; case 3: return k + "\x3d" }
                                                                }, decompressFromBase64: function (k) { return null == k ? "" : "" == k ? null : l._decompress(k.length, 32, function (n) { return m("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d", k.charAt(n)) }) }, compressToUTF16: function (k) {
                                                                        return null == k ? "" : l._compress(k,
                                                                                15, function (n) { return v(n + 32) }) + " "
                                                                }, decompressFromUTF16: function (k) { return null == k ? "" : "" == k ? null : l._decompress(k.length, 16384, function (n) { return k.charCodeAt(n) - 32 }) }, compressToUint8Array: function (k) { k = l.compress(k); for (var n = new Uint8Array(2 * k.length), d = 0, c = k.length; d < c; d++) { var g = k.charCodeAt(d); n[2 * d] = g >>> 8; n[2 * d + 1] = g % 256 } return n }, decompressFromUint8Array: function (k) {
                                                                        if (null === k || void 0 === k) return l.decompress(k); for (var n = Array(k.length / 2), d = 0, c = n.length; d < c; d++)n[d] = 256 * k[2 * d] + k[2 * d + 1]; var g =
                                                                                []; return n.forEach(function (b) { g.push(v(b)) }), l.decompress(g.join(""))
                                                                }, compressToEncodedURIComponent: function (k) { return null == k ? "" : l._compress(k, 6, function (n) { return "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$".charAt(n) }) }, decompressFromEncodedURIComponent: function (k) { return null == k ? "" : "" == k ? null : (k = k.replace(/ /g, "+"), l._decompress(k.length, 32, function (n) { return m("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$", k.charAt(n)) })) }, compress: function (k) {
                                                                        return l._compress(k,
                                                                                16, function (n) { return v(n) })
                                                                }, _compress: function (k, n, d) {
                                                                        if (null == k) return ""; var c, g, b = {}, e = {}, a = "", f = "", h = "", p = 2, B = 3, t = 2, u = [], z = 0, x = 0; for (g = 0; g < k.length; g += 1)if (a = k.charAt(g), Object.prototype.hasOwnProperty.call(b, a) || (b[a] = B++, e[a] = !0), f = h + a, Object.prototype.hasOwnProperty.call(b, f)) h = f; else {
                                                                                if (Object.prototype.hasOwnProperty.call(e, h)) {
                                                                                        if (256 > h.charCodeAt(0)) {
                                                                                                for (c = 0; c < t; c++)z <<= 1, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++; var y = h.charCodeAt(0); for (c = 0; 8 > c; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++,
                                                                                                        y >>= 1
                                                                                        } else { y = 1; for (c = 0; c < t; c++)z = z << 1 | y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y = 0; y = h.charCodeAt(0); for (c = 0; 16 > c; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y >>= 1 } p--; 0 == p && (p = Math.pow(2, t), t++); delete e[h]
                                                                                } else for (y = b[h], c = 0; c < t; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y >>= 1; p--; 0 == p && (p = Math.pow(2, t), t++); b[f] = B++; h = String(a)
                                                                        } if ("" !== h) {
                                                                                if (Object.prototype.hasOwnProperty.call(e, h)) {
                                                                                        if (256 > h.charCodeAt(0)) {
                                                                                                for (c = 0; c < t; c++)z <<= 1, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++; y = h.charCodeAt(0); for (c =
                                                                                                        0; 8 > c; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y >>= 1
                                                                                        } else { y = 1; for (c = 0; c < t; c++)z = z << 1 | y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y = 0; y = h.charCodeAt(0); for (c = 0; 16 > c; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y >>= 1 } p--; 0 == p && (p = Math.pow(2, t), t++); delete e[h]
                                                                                } else for (y = b[h], c = 0; c < t; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y >>= 1; p--; 0 == p && (p = Math.pow(2, t), t++)
                                                                        } y = 2; for (c = 0; c < t; c++)z = z << 1 | 1 & y, x == n - 1 ? (x = 0, u.push(d(z)), z = 0) : x++, y >>= 1; for (; ;) { if (z <<= 1, x == n - 1) { u.push(d(z)); break } x++ } return u.join("")
                                                                },
                                                                decompress: function (k) { return null == k ? "" : "" == k ? null : l._decompress(k.length, 32768, function (n) { return k.charCodeAt(n) }) }, _decompress: function (k, n, d) {
                                                                        var c, g, b = [], e = 4, a = 4, f = 3; var h = ""; var p = [], B = d(0), t = n, u = 1; for (c = 0; 3 > c; c += 1)b[c] = c; h = 0; var z = Math.pow(2, 2); for (g = 1; g != z;) { var x = B & t; t >>= 1; 0 == t && (t = n, B = d(u++)); h |= (0 < x ? 1 : 0) * g; g <<= 1 } switch (h) {
                                                                                case 0: h = 0; z = Math.pow(2, 8); for (g = 1; g != z;)x = B & t, t >>= 1, 0 == t && (t = n, B = d(u++)), h |= (0 < x ? 1 : 0) * g, g <<= 1; var y = v(h); break; case 1: h = 0; z = Math.pow(2, 16); for (g = 1; g != z;)x = B & t, t >>= 1,
                                                                                        0 == t && (t = n, B = d(u++)), h |= (0 < x ? 1 : 0) * g, g <<= 1; y = v(h); break; case 2: return ""
                                                                        }c = b[3] = y; for (p.push(y); ;) {
                                                                                if (u > k) return ""; h = 0; z = Math.pow(2, f); for (g = 1; g != z;)x = B & t, t >>= 1, 0 == t && (t = n, B = d(u++)), h |= (0 < x ? 1 : 0) * g, g <<= 1; switch (y = h) { case 0: h = 0; z = Math.pow(2, 8); for (g = 1; g != z;)x = B & t, t >>= 1, 0 == t && (t = n, B = d(u++)), h |= (0 < x ? 1 : 0) * g, g <<= 1; b[a++] = v(h); y = a - 1; e--; break; case 1: h = 0; z = Math.pow(2, 16); for (g = 1; g != z;)x = B & t, t >>= 1, 0 == t && (t = n, B = d(u++)), h |= (0 < x ? 1 : 0) * g, g <<= 1; b[a++] = v(h); y = a - 1; e--; break; case 2: return p.join("") }if (0 == e && (e = Math.pow(2,
                                                                                        f), f++), b[y]) h = b[y]; else { if (y !== a) return null; h = c + c.charAt(0) } p.push(h); b[a++] = c + h.charAt(0); e--; c = h; 0 == e && (e = Math.pow(2, f), f++)
                                                                        }
                                                                }
                                                        }; return l
                                                }(); "undefined" != typeof A && null != A && (A.exports = q)
                                        }, {}], 11: [function (q, A, w) { q = q("./events"); A.exports = [q, function () { return { observe: function (m, v, r) { m = this.watch(v, r); return r(this.get(v)), m }, unobserve: function (m, v) { this.unwatch(v) } } }] }, { "./events": 6 }], 12: [function (q, A, w) {
                                                var m = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (l) { return typeof l } :
                                                        function (l) { return l && "function" == typeof Symbol && l.constructor === Symbol && l !== Symbol.prototype ? "symbol" : typeof l }; w = q("../src/util"); var v = w.slice, r = w.assign; q = q("./update"); A.exports = [q, function () {
                                                                function l(k, n) { var d, c = n[1], g = v(n, 2); return this.update(c, [], function (b) { d = Array.prototype[k].apply(b, g) }), d } return {
                                                                        push: function (k, n, d, c, g, b) { return l.call(this, "push", arguments) }, pop: function (k, n) { return l.call(this, "pop", arguments) }, shift: function (k, n) { return l.call(this, "shift", arguments) }, unshift: function (k,
                                                                                n, d, c, g, b) { return l.call(this, "unshift", arguments) }, assign: function (k, n, d, c, g, b) { var e = v(arguments, 2); return this.update(n, {}, function (a) { if ("object" != ("undefined" == typeof a ? "undefined" : m(a))) throw Error('store.assign called for non-object value with key "' + n + '"'); return e.unshift(a), r.apply(Object, e) }) }
                                                                }
                                                        }]
                                        }, { "../src/util": 16, "./update": 13 }], 13: [function (q, A, w) {
                                                A.exports = function () {
                                                        return {
                                                                update: function (m, v, r, l) {
                                                                        3 == arguments.length && (l = r, r = void 0); var k = this.get(v, r), n = l(k); this.set(v, void 0 != n ?
                                                                                n : k)
                                                                }
                                                        }
                                                }
                                        }, {}], 14: [function (q, A, w) {
                                                function m(c, g) { return void 0 !== this.get(g) } function v(c, g, b, e) { null == e && (e = b, b = null); null == b && (b = {}); c = this.get(g, b); e = e(c); this.set(g, void 0 === e ? c : e) } function r(c) { return this.clearAll.call(this) } function l(c, g) { return this.each.call(this, function (b, e) { g(e, b) }) } function k(c) { return this.dump.call(this) } function n(c, g) { return JSON.stringify(g) } function d(c, g) { if ("string" == typeof g) try { return JSON.parse(g) } catch (b) { return g || void 0 } } w = q("./dump"); q = q("./json2"); A.exports =
                                                        [w, q, function () { return this.disabled = !this.enabled, { has: m, transact: v, clear: r, forEach: l, getAll: k, serialize: n, deserialize: d } }]
                                        }, { "./dump": 5, "./json2": 8 }], 15: [function (q, A, w) {
                                                function m() { var a = "undefined" == typeof console ? null : console; a && (a.warn ? a.warn : a.log).apply(a, arguments) } function v(a, f, h) {
                                                        h || (h = ""); a && !c(a) && (a = [a]); f && !c(f) && (f = [f]); var p = h ? "__storejs_" + h + "_" : "", B = h ? new RegExp("^" + p) : null; if (!/^[a-zA-Z0-9_\-]*$/.test(h)) throw Error("store.js namespaces can only have alphanumerics + underscores and dashes");
                                                        var t = d({
                                                                _namespacePrefix: p, _namespaceRegexp: B, _testStorage: function (u) { try { u.write("__storejs__test__", "__storejs__test__"); var z = "__storejs__test__" === u.read("__storejs__test__"); return u.remove("__storejs__test__"), z } catch (x) { return !1 } }, _assignPluginFnProp: function (u, z) { var x = this[z]; this[z] = function () { var y = r(arguments, 0), D = this, H = [function () { if (x) return k(arguments, function (I, N) { y[N] = I }), x.apply(D, y) }].concat(y); return u.apply(D, H) } }, _serialize: function (u) { return JSON.stringify(u) }, _deserialize: function (u,
                                                                        z) { if (!u) return z; var x = ""; try { x = JSON.parse(u) } catch (y) { x = u } return void 0 !== x ? x : z }, _addStorage: function (u) { this.enabled || this._testStorage(u) && (this.storage = u, this.enabled = !0) }, _addPlugin: function (u) {
                                                                                var z = this; if (c(u)) return void k(u, function (y) { z._addPlugin(y) }); if (!l(this.plugins, function (y) { return u === y })) {
                                                                                        if (this.plugins.push(u), !g(u)) throw Error("Plugins must be function values that return objects"); var x = u.call(this); if (!b(x)) throw Error("Plugins must return an object of function properties");
                                                                                        k(x, function (y, D) { if (!g(y)) throw Error("Bad plugin property: " + D + " from plugin " + u.name + ". Plugins should only return functions."); z._assignPluginFnProp(y, D) })
                                                                                }
                                                                        }, addStorage: function (u) { m("store.addStorage(storage) is deprecated. Use createStore([storages])"); this._addStorage(u) }
                                                        }, e, { plugins: [] }); return t.raw = {}, k(t, function (u, z) { g(u) && (t.raw[z] = n(t, u)) }), k(a, function (u) { t._addStorage(u) }), k(f, function (u) { t._addPlugin(u) }), t
                                                } q = q("./util"); var r = q.slice, l = q.pluck, k = q.each, n = q.bind, d = q.create, c = q.isList,
                                                        g = q.isFunction, b = q.isObject; A.exports = { createStore: v }; var e = {
                                                                version: "2.0.12", enabled: !1, get: function (a, f) { a = this.storage.read(this._namespacePrefix + a); return this._deserialize(a, f) }, set: function (a, f) { return void 0 === f ? this.remove(a) : (this.storage.write(this._namespacePrefix + a, this._serialize(f)), f) }, remove: function (a) { this.storage.remove(this._namespacePrefix + a) }, each: function (a) { var f = this; this.storage.each(function (h, p) { a.call(f, f._deserialize(h), (p || "").replace(f._namespaceRegexp, "")) }) }, clearAll: function () { this.storage.clearAll() },
                                                                hasNamespace: function (a) { return this._namespacePrefix == "__storejs_" + a + "_" }, createStore: function () { return v.apply(this, arguments) }, addPlugin: function (a) { this._addPlugin(a) }, namespace: function (a) { return v(this.storage, this.plugins, a) }
                                                        }
                                        }, { "./util": 16 }], 16: [function (q, A, w) {
                                                (function (m) {
                                                        function v(g, b) { return Array.prototype.slice.call(g, b || 0) } function r(g, b) { l(g, function (e, a) { return b(e, a), !1 }) } function l(g, b) {
                                                                if (k(g)) for (var e = 0; e < g.length; e++) { if (b(g[e], e)) return g[e] } else for (e in g) if (g.hasOwnProperty(e) &&
                                                                        b(g[e], e)) return g[e]
                                                        } function k(g) { return null != g && "function" != typeof g && "number" == typeof g.length } var n = function () { return Object.assign ? Object.assign : function (g, b, e, a) { for (var f = 1; f < arguments.length; f++)r(Object(arguments[f]), function (h, p) { g[p] = h }); return g } }(), d = function () { if (Object.create) return function (b, e, a, f) { var h = v(arguments, 1); return n.apply(this, [Object.create(b)].concat(h)) }; var g = function () { }; return function (b, e, a, f) { var h = v(arguments, 1); return g.prototype = b, n.apply(this, [new g].concat(h)) } }(),
                                                                c = function () { return String.prototype.trim ? function (g) { return String.prototype.trim.call(g) } : function (g) { return g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "") } }(); A.exports = {
                                                                        assign: n, create: d, trim: c, bind: function (g, b) { return function () { return b.apply(g, Array.prototype.slice.call(arguments, 0)) } }, slice: v, each: r, map: function (g, b) { var e = k(g) ? [] : {}; return l(g, function (a, f) { return e[f] = b(a, f), !1 }), e }, pluck: l, isList: k, isFunction: function (g) { return g && "[object Function]" === {}.toString.call(g) }, isObject: function (g) {
                                                                                return g &&
                                                                                        "[object Object]" === {}.toString.call(g)
                                                                        }, Global: "undefined" != typeof window ? window : m
                                                                }
                                                }).call(this, "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {})
                                        }, {}], 17: [function (q, A, w) { A.exports = [q("./localStorage"), q("./oldFF-globalStorage"), q("./oldIE-userDataStorage"), q("./cookieStorage"), q("./sessionStorage"), q("./memoryStorage")] }, { "./cookieStorage": 18, "./localStorage": 19, "./memoryStorage": 20, "./oldFF-globalStorage": 21, "./oldIE-userDataStorage": 22, "./sessionStorage": 23 }],
                                        18: [function (q, A, w) {
                                                function m(n) { for (var d = k.cookie.split(/; ?/g), c = d.length - 1; 0 <= c; c--)if (l(d[c])) { var g = d[c].split("\x3d"), b = unescape(g[0]); g = unescape(g[1]); n(g, b) } } function v(n) { n && r(n) && (k.cookie = escape(n) + "\x3d; expires\x3dThu, 01 Jan 1970 00:00:00 GMT; path\x3d/") } function r(n) { return (new RegExp("(?:^|;\\s*)" + escape(n).replace(/[\-\.\+\*]/g, "\\$\x26") + "\\s*\\\x3d")).test(k.cookie) } q = q("../src/util"); w = q.Global; var l = q.trim; A.exports = {
                                                        name: "cookieStorage", read: function (n) {
                                                                if (!n || !r(n)) return null;
                                                                n = "(?:^|.*;\\s*)" + escape(n).replace(/[\-\.\+\*]/g, "\\$\x26") + "\\s*\\\x3d\\s*((?:[^;](?!;))*[^;]?).*"; return unescape(k.cookie.replace(new RegExp(n), "$1"))
                                                        }, write: function (n, d) { n && (k.cookie = escape(n) + "\x3d" + escape(d) + "; expires\x3dTue, 19 Jan 2038 03:14:07 GMT; path\x3d/") }, each: m, remove: v, clearAll: function () { m(function (n, d) { v(d) }) }
                                                }; var k = w.document
                                        }, { "../src/util": 16 }], 19: [function (q, A, w) {
                                                function m(r) { return v.localStorage.getItem(r) } var v = q("../src/util").Global; A.exports = {
                                                        name: "localStorage",
                                                        read: m, write: function (r, l) { return v.localStorage.setItem(r, l) }, each: function (r) { for (var l = v.localStorage.length - 1; 0 <= l; l--) { var k = v.localStorage.key(l); r(m(k), k) } }, remove: function (r) { return v.localStorage.removeItem(r) }, clearAll: function () { return v.localStorage.clear() }
                                                }
                                        }, { "../src/util": 16 }], 20: [function (q, A, w) {
                                                A.exports = {
                                                        name: "memoryStorage", read: function (v) { return m[v] }, write: function (v, r) { m[v] = r }, each: function (v) { for (var r in m) m.hasOwnProperty(r) && v(m[r], r) }, remove: function (v) { delete m[v] }, clearAll: function (v) {
                                                                m =
                                                                {}
                                                        }
                                                }; var m = {}
                                        }, {}], 21: [function (q, A, w) { function m(r) { for (var l = v.length - 1; 0 <= l; l--) { var k = v.key(l); r(v[k], k) } } q = q("../src/util").Global; A.exports = { name: "oldFF-globalStorage", read: function (r) { return v[r] }, write: function (r, l) { v[r] = l }, each: m, remove: function (r) { return v.removeItem(r) }, clearAll: function () { m(function (r, l) { delete v[r] }) } }; var v = q.globalStorage }, { "../src/util": 16 }], 22: [function (q, A, w) {
                                                function m(d) { return d.replace(/^\d/, "___$\x26").replace(n, "___") } q = q("../src/util").Global; A.exports = {
                                                        name: "oldIE-userDataStorage",
                                                        write: function (d, c) { if (!k) { var g = m(d); l(function (b) { b.setAttribute(g, c); b.save(v) }) } }, read: function (d) { if (!k) { var c = m(d), g = null; return l(function (b) { g = b.getAttribute(c) }), g } }, each: function (d) { l(function (c) { for (var g = c.XMLDocument.documentElement.attributes, b = g.length - 1; 0 <= b; b--) { var e = g[b]; d(c.getAttribute(e.name), e.name) } }) }, remove: function (d) { var c = m(d); l(function (g) { g.removeAttribute(c); g.save(v) }) }, clearAll: function () {
                                                                l(function (d) {
                                                                        var c = d.XMLDocument.documentElement.attributes; d.load(v); for (var g =
                                                                                c.length - 1; 0 <= g; g--)d.removeAttribute(c[g].name); d.save(v)
                                                                })
                                                        }
                                                }; var v = "storejs", r = q.document, l = function () {
                                                        if (!r || !r.documentElement || !r.documentElement.addBehavior) return null; try { var d = new ActiveXObject("htmlfile"); d.open(); d.write('\x3cscript\x3edocument.w\x3dwindow\x3c/script\x3e\x3ciframe src\x3d"/favicon.ico"\x3e\x3c/iframe\x3e'); d.close(); var c = d.w.frames[0].document; var g = c.createElement("div") } catch (b) { g = r.createElement("div"), c = r.body } return function (b) {
                                                                var e = [].slice.call(arguments, 0); e.unshift(g);
                                                                c.appendChild(g); g.addBehavior("#default#userData"); g.load(v); b.apply(this, e); c.removeChild(g)
                                                        }
                                                }(), k = (q.navigator ? q.navigator.userAgent : "").match(/ (MSIE 8|MSIE 9|MSIE 10)\./), n = /[!"#$%&'()*+,/\\:;<=>?@[\]^`{|}~]/g
                                        }, { "../src/util": 16 }], 23: [function (q, A, w) {
                                                function m(r) { return v.sessionStorage.getItem(r) } var v = q("../src/util").Global; A.exports = {
                                                        name: "sessionStorage", read: m, write: function (r, l) { return v.sessionStorage.setItem(r, l) }, each: function (r) {
                                                                for (var l = v.sessionStorage.length - 1; 0 <= l; l--) {
                                                                        var k =
                                                                                v.sessionStorage.key(l); r(m(k), k)
                                                                }
                                                        }, remove: function (r) { return v.sessionStorage.removeItem(r) }, clearAll: function () { return v.sessionStorage.clear() }
                                                }
                                        }, { "../src/util": 16 }]
                                }, {}, [1])(1)
                        })
                }, "libs/md5/md5": function () {
                        (function (E) {
                                function q(b, e) { var a = (b & 65535) + (e & 65535); return (b >> 16) + (e >> 16) + (a >> 16) << 16 | a & 65535 } function A(b, e, a, f, h, p) { b = q(q(e, b), q(f, p)); return q(b << h | b >>> 32 - h, a) } function w(b, e, a, f, h, p, B) { return A(e & a | ~e & f, b, e, h, p, B) } function m(b, e, a, f, h, p, B) { return A(e & f | a & ~f, b, e, h, p, B) } function v(b, e,
                                        a, f, h, p, B) { return A(a ^ (e | ~f), b, e, h, p, B) } function r(b, e) {
                                                b[e >> 5] |= 128 << e % 32; b[(e + 64 >>> 9 << 4) + 14] = e; var a = 1732584193, f = -271733879, h = -1732584194, p = 271733878; for (e = 0; e < b.length; e += 16) {
                                                        var B = a; var t = f; var u = h; var z = p; a = w(a, f, h, p, b[e], 7, -680876936); p = w(p, a, f, h, b[e + 1], 12, -389564586); h = w(h, p, a, f, b[e + 2], 17, 606105819); f = w(f, h, p, a, b[e + 3], 22, -1044525330); a = w(a, f, h, p, b[e + 4], 7, -176418897); p = w(p, a, f, h, b[e + 5], 12, 1200080426); h = w(h, p, a, f, b[e + 6], 17, -1473231341); f = w(f, h, p, a, b[e + 7], 22, -45705983); a = w(a, f, h, p, b[e + 8], 7, 1770035416);
                                                        p = w(p, a, f, h, b[e + 9], 12, -1958414417); h = w(h, p, a, f, b[e + 10], 17, -42063); f = w(f, h, p, a, b[e + 11], 22, -1990404162); a = w(a, f, h, p, b[e + 12], 7, 1804603682); p = w(p, a, f, h, b[e + 13], 12, -40341101); h = w(h, p, a, f, b[e + 14], 17, -1502002290); f = w(f, h, p, a, b[e + 15], 22, 1236535329); a = m(a, f, h, p, b[e + 1], 5, -165796510); p = m(p, a, f, h, b[e + 6], 9, -1069501632); h = m(h, p, a, f, b[e + 11], 14, 643717713); f = m(f, h, p, a, b[e], 20, -373897302); a = m(a, f, h, p, b[e + 5], 5, -701558691); p = m(p, a, f, h, b[e + 10], 9, 38016083); h = m(h, p, a, f, b[e + 15], 14, -660478335); f = m(f, h, p, a, b[e + 4], 20, -405537848);
                                                        a = m(a, f, h, p, b[e + 9], 5, 568446438); p = m(p, a, f, h, b[e + 14], 9, -1019803690); h = m(h, p, a, f, b[e + 3], 14, -187363961); f = m(f, h, p, a, b[e + 8], 20, 1163531501); a = m(a, f, h, p, b[e + 13], 5, -1444681467); p = m(p, a, f, h, b[e + 2], 9, -51403784); h = m(h, p, a, f, b[e + 7], 14, 1735328473); f = m(f, h, p, a, b[e + 12], 20, -1926607734); a = A(f ^ h ^ p, a, f, b[e + 5], 4, -378558); p = A(a ^ f ^ h, p, a, b[e + 8], 11, -2022574463); h = A(p ^ a ^ f, h, p, b[e + 11], 16, 1839030562); f = A(h ^ p ^ a, f, h, b[e + 14], 23, -35309556); a = A(f ^ h ^ p, a, f, b[e + 1], 4, -1530992060); p = A(a ^ f ^ h, p, a, b[e + 4], 11, 1272893353); h = A(p ^ a ^ f, h, p, b[e +
                                                                7], 16, -155497632); f = A(h ^ p ^ a, f, h, b[e + 10], 23, -1094730640); a = A(f ^ h ^ p, a, f, b[e + 13], 4, 681279174); p = A(a ^ f ^ h, p, a, b[e], 11, -358537222); h = A(p ^ a ^ f, h, p, b[e + 3], 16, -722521979); f = A(h ^ p ^ a, f, h, b[e + 6], 23, 76029189); a = A(f ^ h ^ p, a, f, b[e + 9], 4, -640364487); p = A(a ^ f ^ h, p, a, b[e + 12], 11, -421815835); h = A(p ^ a ^ f, h, p, b[e + 15], 16, 530742520); f = A(h ^ p ^ a, f, h, b[e + 2], 23, -995338651); a = v(a, f, h, p, b[e], 6, -198630844); p = v(p, a, f, h, b[e + 7], 10, 1126891415); h = v(h, p, a, f, b[e + 14], 15, -1416354905); f = v(f, h, p, a, b[e + 5], 21, -57434055); a = v(a, f, h, p, b[e + 12], 6, 1700485571);
                                                        p = v(p, a, f, h, b[e + 3], 10, -1894986606); h = v(h, p, a, f, b[e + 10], 15, -1051523); f = v(f, h, p, a, b[e + 1], 21, -2054922799); a = v(a, f, h, p, b[e + 8], 6, 1873313359); p = v(p, a, f, h, b[e + 15], 10, -30611744); h = v(h, p, a, f, b[e + 6], 15, -1560198380); f = v(f, h, p, a, b[e + 13], 21, 1309151649); a = v(a, f, h, p, b[e + 4], 6, -145523070); p = v(p, a, f, h, b[e + 11], 10, -1120210379); h = v(h, p, a, f, b[e + 2], 15, 718787259); f = v(f, h, p, a, b[e + 9], 21, -343485551); a = q(a, B); f = q(f, t); h = q(h, u); p = q(p, z)
                                                } return [a, f, h, p]
                                        } function l(b) {
                                                var e, a = ""; for (e = 0; e < 32 * b.length; e += 8)a += String.fromCharCode(b[e >>
                                                        5] >>> e % 32 & 255); return a
                                        } function k(b) { var e, a = []; a[(b.length >> 2) - 1] = void 0; for (e = 0; e < a.length; e += 1)a[e] = 0; for (e = 0; e < 8 * b.length; e += 8)a[e >> 5] |= (b.charCodeAt(e / 8) & 255) << e % 32; return a } function n(b) { return l(r(k(b), 8 * b.length)) } function d(b, e) { var a = k(b), f = [], h = []; f[15] = h[15] = void 0; 16 < a.length && (a = r(a, 8 * b.length)); for (b = 0; 16 > b; b += 1)f[b] = a[b] ^ 909522486, h[b] = a[b] ^ 1549556828; e = r(f.concat(k(e)), 512 + 8 * e.length); return l(r(h.concat(e), 640)) } function c(b) {
                                                var e = "", a; for (a = 0; a < b.length; a += 1) {
                                                        var f = b.charCodeAt(a);
                                                        e += "0123456789abcdef".charAt(f >>> 4 & 15) + "0123456789abcdef".charAt(f & 15)
                                                } return e
                                        } function g(b, e, a) { e ? a ? b = d(unescape(encodeURIComponent(e)), unescape(encodeURIComponent(b))) : (b = d(unescape(encodeURIComponent(e)), unescape(encodeURIComponent(b))), b = c(b)) : b = a ? n(unescape(encodeURIComponent(b))) : c(n(unescape(encodeURIComponent(b)))); return b } "function" === typeof define && define.amd ? define(function () { return g }) : E.md5 = g
                        })(this)
                }, "jimu/dijit/AGOLLoading": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/AGOLLoading.html dojo/_base/html ../utils".split(" "),
                                function (E, q, A, w, m, v) {
                                        return E([q, A], {
                                                baseClass: "jimu-agol-loading", declaredClass: "jimu.dijit.AGOLLoading", templateString: w, loadingText: null, hidden: !1, showLoading: !0, postMixInProperties: function () { this.nls = window.jimuNls.loadingShelter }, postCreate: function () {
                                                        this.inherited(arguments); this.hidden && m.setStyle(this.domNode, "display", "none"); m.setStyle(this.domNode, { width: "100%", height: "100%" }); this.showLoading || m.setStyle(this.imgDiv, "display", "none"); "string" === typeof this.loadingText && (this.textNode.innerHTML =
                                                                v.sanitizeHTML(this.loadingText))
                                                }, show: function (r) { this.domNode && this.hidden && ("string" === typeof r && (this.textNode.innerHTML = r), m.setStyle(this.domNode, "display", "block"), this.hidden = !1) }, hide: function () { this.domNode && !this.hidden && (m.setStyle(this.domNode, "display", "none"), this.hidden = !0) }
                                        })
                                })
                }, "jimu/LayoutManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dojo/topic dojo/on dojo/query dojo/Deferred dojo/promise/all dojo/debounce require ./MapManager ./utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                        var b = null; var e = E([w], {
                                                constructor: function (a, f) {
                                                        this.own(m.subscribe("appConfigLoaded", q.hitch(this, this._onAppConfigLoaded))); this.own(m.subscribe("appConfigChanged", q.hitch(this, this._onAppConfigChanged))); this.own(m.subscribe("mapLoaded", q.hitch(this, this._onMapLoaded))); this.own(m.subscribe("mapChanged", q.hitch(this, this._onMapChanged))); this.own(m.subscribe("beforeMapDestory", q.hitch(this, this._onBeforeMapDestory))); this.own(m.subscribe("preloadModulesLoaded",
                                                                q.hitch(this, this._onPreloadModulesLoaded))); this.own(m.subscribe("openWidget", q.hitch(this, this._onOpenWidgetRequest))); this.own(m.subscribe("builder/actionTriggered", q.hitch(this, this._onActionTriggered))); g.isMobileUa() || this.own(v(window, "resize", n(q.hitch(this, this.resize), 200))); this.id = f; this.preloadModulesLoadDef = new l
                                                }, postCreate: function () { this.containerNode = this.domNode }, map: null, mapId: "map", mapDiv: null, hlDiv: null, layoutManager: null, animTime: 500, resize: function () { this.layoutManager && this.layoutManager.resize() },
                                                _onAppConfigLoaded: function (a) { this.appConfig = q.clone(a); this.preloadModulesLoadDef.then(q.hitch(this, function () { this._loadLayoutManager(this.appConfig).then(q.hitch(this, function (f) { this.layoutManager = f; this.layoutManager.onEnter(this.appConfig, this.mapId).then(q.hitch(this, function () { this.mapDiv = this.layoutManager.getMapDiv(); this._loadingAnim(); this._loadMap(this.mapId); this.appConfig.theme && this._loadTheme(this.appConfig.theme) })) })) })) }, _loadLayoutManager: function (a) {
                                                        a = a.layoutDefinition ? a.layoutDefinition.manager :
                                                                "jimu/layoutManagers/AbsolutePositionLayoutManager"; var f = new l; d([a], q.hitch(this, function (h) { h = h.getInstance(); this.map && h.setMap(this.map); f.resolve(h) })); return f
                                                }, _loadingAnim: function () { window.isXT && "config" === this.appConfig.mode || (A.addClass(jimuConfig.loadingId, "loading-fadeOut"), this.own(v(document.getElementById(jimuConfig.loadingId), "animationend", q.hitch(this, function () { A.setStyle(jimuConfig.loadingId, "display", "none") })))) }, _loadMap: function (a) {
                                                        this.mapManager = c.getInstance({
                                                                appConfig: this.appConfig,
                                                                urlParams: this.urlParams
                                                        }, a); this.mapManager.showMap(); this._lazyLoadResources()
                                                }, _lazyLoadResources: function () { jimuConfig.lazyLoadCss && d(jimuConfig.lazyLoadCss); d(["dynamic-modules/commonResources"]) }, _onMapLoaded: function (a) { this.map = a; this.layoutManager.setMap(a); this.layoutManager.loadAndLayout(this.appConfig) }, _onPreloadModulesLoaded: function () { this.preloadModulesLoadDef.resolve() }, _loadTheme: function (a) {
                                                        var f = new l; d(["themes/" + a.name + "/main"], q.hitch(this, function () {
                                                                k([this._loadThemeCommonStyle(a),
                                                                this._loadThemeCurrentStyle(a)]).then(q.hitch(this, function () { this._addCustomStyle(a); this.layoutManager.onThemeLoad(); f.resolve() }))
                                                        })); return f
                                                }, _loadThemeCommonStyle: function (a) { A.addClass(this.domNode, a.name); return g.loadStyleLink(this._getThemeCommonStyleId(a), "themes/" + a.name + "/common.css") }, _loadThemeCurrentStyle: function (a) { A.addClass(this.domNode, a.styles[0]); return g.loadStyleLink(this._getThemeCurrentStyleId(a), "themes/" + a.name + "/styles/" + a.styles[0] + "/style.css") }, _addCustomStyle: function (a) {
                                                        var f =
                                                                q.getObject("customStyles", !1, a); if (f) { var h = ".jimu-main-background{background-color: ${mainBackgroundColor} !important;}"; (a = this._getFixedThemeStyles(a)) && (h += a); h = q.replace(h, f, /\$\{([^\}]+)\}/g); f = A.create("style", { type: "text/css" }); try { f.appendChild(document.createTextNode(h)) } catch (p) { f.styleSheet.cssText = h } f.setAttribute("source", "custom"); document.head.appendChild(f) }
                                                }, _getFixedThemeStyles: function (a) {
                                                        var f = ".esriPopup .titlePane {background-color: ${mainBackgroundColor} !important;}"; if (a.customStyles.mainBackgroundColor &&
                                                                g.isLightColor(a.customStyles.mainBackgroundColor)) { var h = d.toUrl("jimu") + "/css/images/api_popup_light.png"; f += ".esriPopup .titleButton {background: url(" + h + ") no-repeat}.esriPopup .titlePane {color: black}" } "PlateauTheme" === a.name ? f += ".jimu-widget-header-controller .jimu-title, .jimu-widget-header-controller .jimu-subtitle{color: ${mainBackgroundColor} !important;}.jimu-widget-header-controller .links .jimu-link{color: ${mainBackgroundColor} !important;}.jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation, .jimu-widget-mylocation .place-holder, .jimu-widget-zoomslider.vertical .zoom-in, .jimu-widget-zoomslider.vertical .zoom-out, .jimu-widget-extent-navigate.vertical .operation{background-color: ${mainBackgroundColor} !important;}.jimu-preload-widget-icon-panel \x3e .jimu-panel-title, .jimu-foldable-panel \x3e .jimu-panel-title, .jimu-title-panel \x3e .title{color: ${mainBackgroundColor} !important;}.jimu-panel{border-color: ${mainBackgroundColor} !important;}.jimu-widget-header-controller{border-bottom-color: ${mainBackgroundColor} !important;}.jimu-tab\x3e.control\x3e.tab{color: ${mainBackgroundColor} !important; border-color: ${mainBackgroundColor} !important} .popup-links .title, .popup-links a, .popup-links, .popup-links .line { color: ${mainBackgroundColor} ; border-color: ${mainBackgroundColor};}" :
                                                                        "BillboardTheme" === a.name ? f += ".jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation .place-holder, .jimu-widget-zoomslider.vertical .zoom-in, .jimu-widget-zoomslider.vertical .zoom-out, .jimu-widget-extent-navigate .operation, .jimu-widget-fullScreen .fullScreen, .jimu-widget-mylocation .place-holder.nohttps:hover, .jimu-widget-extent-navigate .operation.jimu-state-disabled:hover{background-color: ${mainBackgroundColor} !important; opacity: 0.8;}.jimu-widget-onscreen-icon{background-color: ${mainBackgroundColor} !important; opacity: 0.8;}.jimu-widget-homebutton .HomeButton .home:hover, .jimu-widget-mylocation .place-holder:not(.nohttps):hover, .jimu-widget-zoomslider.vertical .zoom-in:hover, .jimu-widget-zoomslider.vertical .zoom-out:hover, .jimu-widget-extent-navigate .operation:not(.jimu-state-disabled):hover, .jimu-widget-fullScreen .fullScreen:hover, .jimu-widget-onscreen-icon:hover, .jimu-widget-onscreen-icon.jimu-state-selected{opacity: 1;}" :
                                                                                "BoxTheme" === a.name ? f += ".jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation .place-holder, .jimu-widget-zoomslider.vertical .zoom-in, .jimu-widget-zoomslider.vertical .zoom-out, .jimu-widget-extent-navigate .operation, .jimu-widget-fullScreen .fullScreen{background-color: ${mainBackgroundColor} !important; opacity: 0.8;}.jimu-main-background.jimu-widget-zoomslider{background-color: transparent !important}.jimu-widget-homebutton .HomeButton .home:hover, .jimu-widget-mylocation .place-holder:not(.nohttps):hover, .jimu-widget-zoomslider.vertical .zoom-in:hover, .jimu-widget-zoomslider.vertical .zoom-out:hover, .jimu-widget-zoomslider .zoom:hover, .jimu-widget-extent-navigate .operation:not(.jimu-state-disabled):hover, .jimu-widget-fullScreen .fullScreen:hover{background-color: ${mainBackgroundColor} !important; opacity: 1;}" :
                                                                                        "TabTheme" === a.name ? f += ".tab-widget-frame .title-label{color: ${mainBackgroundColor} !important;}" : "DartTheme" === a.name ? f += ".jimu-widget-fullScreen .fullScreen{background-color: ${mainBackgroundColor} !important;}.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation.jimu-state-disabled,.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation.jimu-state-disabled:hover{color: ${mainBackgroundColor} !important; opacity: 0.6;}.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation,.dart-controller-extent-navigate .jimu-widget-extent-navigate .operation:hover{color: ${mainBackgroundColor} !important; opacity: 1;}" :
                                                                                                "PocketTheme" === a.name && (f += ".jimu-main-background, .jimu-widget-homebutton, .jimu-widget-mylocation, .jimu-widget-onscreen-icon, .jimu-widget-onscreen-icon.jimu-state-selected, .jimu-widget-zoomslider .zoom, .jimu-widget-homebutton .HomeButton .home, .jimu-widget-mylocation .place-holder, .jimu-widget-extent-navigate .operation, .jimu-widget-fullScreen .fullScreen, .esriPopup .titlePane, .esriPopupMobile .titlePane, .esriPopup .pointer.top{background-color: ${mainBackgroundColor} !important;}.esriMobileNavigationBar{background-color: ${mainBackgroundColor} !important; background-image: none !important;}");
                                                        return f
                                                }, _onAppConfigChanged: function (a, f, h) {
                                                        a = q.clone(a); switch (f) {
                                                                case "themeChange": this._onThemeChange(a); break; case "styleChange": this._onStyleChange(a); break; case "layoutChange": this._onLayoutChange(a); break; case "widgetChange": this._onWidgetChange(a, h); break; case "groupChange": this._onGroupChange(a, h); break; case "widgetPoolChange": this._onWidgetPoolChange(a, h); break; case "resetConfig": this._onResetConfig(a); break; case "loadingPageChange": this._onLoadingPageChange(a, h); break; case "layoutDefinitionChange": this._onLayoutDefinitionChange(a,
                                                                        h); break; case "onScreenGroupsChange": this._onOnScreenGroupsChange(a, h); break; case "onScreenOrderChange": this._onOnScreenOrderChange(a, h)
                                                        }this.appConfig = a
                                                }, _onMapChanged: function (a) { this.map = a; this.layoutManager.setMap(a); this.layoutManager.loadAndLayout(this.appConfig) }, _onBeforeMapDestory: function () { this.layoutManager.destroyOnScreenWidgetsAndGroups() }, _onThemeChange: function (a) {
                                                        this.layoutManager.destroyOnScreenWidgetsAndGroups(); this._removeThemeCommonStyle(this.appConfig.theme); this._removeThemeCurrentStyle(this.appConfig.theme);
                                                        this._removeCustomStyle(); k([this._loadLayoutManager(a), this._loadTheme(a.theme)]).then(q.hitch(this, function (f) { var h = f[0]; this.layoutManager.name !== h.name ? (this.layoutManager.onLeave(), h.onEnter(a, this.mapId).then(q.hitch(this, function () { this.layoutManager = h; this.layoutManager.loadAndLayout(a) }))) : this.layoutManager.loadAndLayout(a) }))
                                                }, _onResetConfig: function (a) {
                                                        var f = this.appConfig; m.publish("appConfigChanged", a, "mapChange", a); this.appConfig = f; this._loadLayoutManager(a).then(q.hitch(this, function (h) {
                                                                this.layoutManager =
                                                                h; this._removeThemeCommonStyle(this.appConfig.theme); this._removeThemeCurrentStyle(this.appConfig.theme); this._removeCustomStyle(); this._loadTheme(this.appConfig.theme)
                                                        }))
                                                }, _onLoadingPageChange: function (a, f) {
                                                        "backgroundColor" in f ? A.setStyle(jimuConfig.loadingId, "background-color", a.loadingPage.backgroundColor) : "backgroundImage" in f ? (a = a.loadingPage.backgroundImage, a.visible && a.uri ? (A.setStyle(jimuConfig.loadingImageId, "background-image", "url('" + a.uri + "')"), A.setStyle(jimuConfig.loadingImageId, "width",
                                                                a.width + "px"), A.setStyle(jimuConfig.loadingImageId, "height", a.height + "px")) : (A.setStyle(jimuConfig.loadingImageId, "background-image", "url('')"), A.setStyle(jimuConfig.loadingImageId, "width", "0px"), A.setStyle(jimuConfig.loadingImageId, "height", "0px"))) : "loadingGif" in f && (a = a.loadingPage.loadingGif, a.visible && a.uri ? (A.setStyle(jimuConfig.loadingGifId, "background-image", "url('" + a.uri + "')"), A.setStyle(jimuConfig.loadingGifId, "width", a.width + "px"), A.setStyle(jimuConfig.loadingGifId, "height", a.height + "px")) :
                                                                        (A.setStyle(jimuConfig.loadingGifId, "background-image", "url('')"), A.setStyle(jimuConfig.loadingGifId, "width", "0px"), A.setStyle(jimuConfig.loadingGifId, "height", "0px")))
                                                }, _onStyleChange: function (a) { this._removeThemeCurrentStyle(this.appConfig.theme); this._loadThemeCurrentStyle(a.theme); this._removeCustomStyle(); this._addCustomStyle(a.theme) }, _onLayoutChange: function (a) { this.layoutManager.onLayoutChange(a) }, _onWidgetChange: function (a, f) { this.layoutManager.onWidgetChange(a, f) }, _onGroupChange: function (a,
                                                        f) { this.layoutManager.onGroupChange(a, f) }, _onWidgetPoolChange: function (a, f) { this.layoutManager.onWidgetPoolChange(a, f) }, _onActionTriggered: function (a) { this.layoutManager.onActionTriggered(a) }, _onLayoutDefinitionChange: function (a, f) { this.layoutManager.onLayoutDefinitionChange(a, f) }, _onOnScreenGroupsChange: function (a, f) { this.layoutManager.onOnScreenGroupsChange(a, f) }, _onOnScreenOrderChange: function (a, f) { this.layoutManager.onOnScreenOrderChange(a, f) }, _removeThemeCommonStyle: function (a) {
                                                                A.removeClass(this.domNode,
                                                                        a.name); A.destroy(this._getThemeCommonStyleId(a))
                                                        }, _removeThemeCurrentStyle: function (a) { A.removeClass(this.domNode, a.styles[0]); A.destroy(this._getThemeCurrentStyleId(a)) }, _removeCustomStyle: function () { r('style[source\x3d"custom"]', document.head).forEach(function (a) { A.destroy(a) }) }, _getThemeCommonStyleId: function (a) { return "theme_" + a.name + "_style_common" }, _getThemeCurrentStyleId: function (a) { return "theme_" + a.name + "_style_" + a.styles[0] }, _onOpenWidgetRequest: function (a) { this.layoutManager.openWidget(a) }
                                        });
                                        e.getInstance = function (a, f) { null === b && (b = new e(a, f), window._layoutManager = b); return b }; return e
                                })
                }, "jimu/MapManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/topic dojo/on dojo/aspect dojo/keys dojo/i18n dojo/_base/config esri/dijit/InfoWindow esri/dijit/PopupMobile esri/InfoTemplate esri/request esri/arcgis/utils esri/geometry/Extent esri/geometry/Point esri/layers/FeatureLayer require ./utils jimu/LayerInfos/LayerInfos jimu/dijit/Message jimu/dijit/AppStatePopup ./MapUrlParamsHandler ./AppStateManager ./PopupManager ./FilterManager".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y, D, H, I) {
                                        var N = null, T = E(null, {
                                                appConfig: null, mapDivId: "", map: null, previousInfoWindow: null, mobileInfoWindow: null, isMobileInfoWindow: !1, layerInfosObj: null, constructor: function (M, R) {
                                                        this.appConfig = M.appConfig; this.urlParams = M.urlParams; this.id = this.mapDivId = R; this.appStateManager = D.getInstance(this.urlParams); this.popupManager = H.getInstance(this); this.filterManager = I.getInstance(); this.nls = window.jimuNls; v.subscribe("appConfigChanged", q.hitch(this,
                                                                this.onAppConfigChanged)); v.subscribe("syncExtent", q.hitch(this, this.onSyncExtent)); v.subscribe("mapContentModified", q.hitch(this, this.onMapContentModified)); r(window, "resize", q.hitch(this, this.onWindowResize)); r(window, "unload", q.hitch(this, this.onUnload))
                                                }, showMap: function () { this._showMap(this.appConfig) }, _showMap: function (M) { console.time("Load Map"); M.map["3D"] ? M.map.itemId ? this._show3DWebScene(M) : this._show3DLayersMap(M) : M.map.itemId ? this._show2DWebMap(M) : console.log("No webmap found. Please set map.itemId in config.json.") },
                                                onUnload: function () { this.appConfig.keepAppState && this.appStateManager.saveWabAppState(this.map, this.layerInfosObj) }, onWindowResize: function () { this.map && this.map.resize && (this.map.resize(), this.resetInfoWindow(!1)) }, getMapInfoWindow: function () { return { mobile: this._mapMobileInfoWindow, bigScreen: this._mapInfoWindow } }, resetInfoWindow: function (M) {
                                                        M && (this._mapInfoWindow = this.map.infoWindow, this._mapMobileInfoWindow && (this._mapMobileInfoWindow.destroy(), m("div.esriMobileInfoView.esriMobilePopupInfoView").forEach(function (R) { w.destroy(R) }),
                                                                m("div.esriMobileNavigationBar").forEach(function (R) { w.destroy(R) })), this._mapMobileInfoWindow = new g(null, w.create("div", null, null, this.map.root)), this.isMobileInfoWindow = !1); t.inMobileSize() && !this.isMobileInfoWindow ? (this.map.infoWindow.hide(), this.map.setInfoWindow(this._mapMobileInfoWindow), this.isMobileInfoWindow = !0) : !t.inMobileSize() && this.isMobileInfoWindow && (this.map.infoWindow.hide(), this.map.setInfoWindow(this._mapInfoWindow), this.isMobileInfoWindow = !1)
                                                }, onSyncExtent: function (M) {
                                                        this.map &&
                                                        (M = new f(M.extent), this.map.setExtent(M))
                                                }, _visitConfigMapLayers: function (M, R) { A.forEach(M.map.basemaps, function (ca, K) { ca.isOperationalLayer = !1; R(ca, K) }, this); A.forEach(M.map.operationallayers, function (ca, K) { ca.isOperationalLayer = !0; R(ca, K) }, this) }, _show3DLayersMap: function (M) { B(["esri3d/Map"], q.hitch(this, function (R) { var ca = new R(this.mapDivId, { camera: M.map.mapOptions.camera }); this._visitConfigMapLayers(M, q.hitch(this, function (K) { this.createLayer(ca, "3D", K) })); ca.usePlugin = R.usePlugin; this._publishMapEvent(ca) })) },
                                                _show3DWebScene: function (M) {
                                                        this._getWebsceneData(M.map.itemId).then(q.hitch(this, function (R) {
                                                                B(["esri3d/Map"], q.hitch(this, function (ca) {
                                                                        var K = new ca(this.mapDivId, M.map.mapOptions); A.forEach(R.itemData.operationalLayers, function (Q) { this.createLayer(K, "3D", Q) }, this); A.forEach(R.itemData.baseMap.baseMapLayers, function (Q) { Q.type = "tile"; this.createLayer(K, "3D", Q) }, this); A.forEach(R.itemData.baseMap.elevationLayers, function (Q) { Q.type = "elevation"; this.createLayer(K, "3D", Q) }, this); K.toc = R.itemData.toc;
                                                                        K.bookmarks = R.itemData.bookmarks; K.tours = R.itemData.tours
                                                                }))
                                                        }))
                                                }, _publishMapEvent: function (M) { window._viewerMap = M; y.postProcessUrlParams(this.urlParams, M); console.timeEnd("Load Map"); this.map ? (this.map = M, this.resetInfoWindow(!0), console.log("map changed."), v.publish("mapChanged", this.map, this.layerInfosObj)) : (this.map = M, this.resetInfoWindow(!0), v.publish("mapLoaded", this.map, this.layerInfosObj)) }, _getWebsceneData: function (M) {
                                                        return e({
                                                                url: "http://184.169.133.166/sharing/rest/content/items/" + M + "/data",
                                                                handleAs: "json"
                                                        })
                                                }, _show2DWebMap: function (M) {
                                                        this._increasePointCount(M); M.map.mapOptions || (M.map.mapOptions = {}); var R = this._processMapOptions(M.map.mapOptions) || {}; R.slider = !1; if ("1" === window.queryObject.mapUseClassicNavMode || "true" === window.queryObject.mapUseClassicNavMode) R.navigationMode = "classic"; var ca = M.map.portalUrl, K = M.map.itemId; R = { mapOptions: R, bingMapsKey: M.bingMapsKey, usePopupManager: !0 }; if (!window.isBuilder && !M.mode && M.map.appProxy && M.map.appProxy.mapItemId === M.map.itemId) {
                                                                var Q = []; A.forEach(M.map.appProxy.proxyItems,
                                                                        function (X) { X.useProxy && X.proxyUrl && Q.push({ url: X.sourceUrl, mixin: { url: X.proxyUrl } }) }); 0 < Q.length && (R.layerMixins = Q)
                                                        } this._createWebMapRaw(ca, K, this.mapDivId, R).then(q.hitch(this, function (X) {
                                                                var W = X.map; W.hideZoomSlider(); W.infoWindow.resize(270, 316); W.itemId = M.map.itemId; W.itemInfo = X.itemInfo; W.webMapResponse = X; W.enableSnapping({ snapKey: k.copyKey }); w.setStyle(W.root, "zIndex", 0); W._initialExtent = W.extent; this.layerInfosObj = u.getInstanceSyncForInit(W, W.itemInfo); this.layerInfosObj.getLayerInfoArrayOfWebmap().forEach(function (fa) {
                                                                        fa.getLayerObject().then(q.hitch(this,
                                                                                function (ma) { ma && q.setObject("_wabProperties.originalRefreshinterval", ma.refreshInterval, ma) }), q.hitch(this, function (ma) { console.error("can't get layerObject", ma) }))
                                                                }, this); M.map.mapRefreshInterval && !M.map.mapRefreshInterval.useWebMapRefreshInterval && this._updateRefreshInterval(M.map.mapRefreshInterval); this._showUnreachableLayersTitleMessage(); this._publishMapEvent(W); setTimeout(q.hitch(this, this._checkAppState), 500); this._addDataLoadingOnMapUpdate(W); this._hideError()
                                                        }), q.hitch(this, function (X) {
                                                                console.error(X);
                                                                this._showError(X); v.publish("mapCreatedFailed")
                                                        }))
                                                }, _increasePointCount: function (M) { if ("1" !== window.queryObject.disableLargePointCountForTimeSlider && "true" !== window.queryObject.disableLargePointCountForTimeSlider) { var R = !1; t.visitElement(M, function (ca) { "widgets/TimeSlider/Widget" === ca.uri && (R = !0) }); R && (p.prototype.maxPointCountForAuto = 35E3) } }, _handleRefreshLayer: function (M) {
                                                        var R = M._mode._drawFeatures, ca = M._mode._clearIIf, K = null; M._mode._drawFeatures = function (Q, X) {
                                                                X && "number" === typeof X.row && "number" ===
                                                                        typeof X.col && M._mode._removeCell(X.row, X.col); R.apply(M._mode, arguments)
                                                        }; l.before(M, "refresh", function () { K = M._mode._cellMap; M._mode._clearIIf = function () { } }); l.after(M, "refresh", function () { M._mode._cellMap = K; M._mode._clearIIf = ca }); r(M, "update-start", function () { M.isUpdating = !0 }); r(M, "update-end", function () { M.isUpdating = !1 })
                                                }, _showError: function (M) { M && M.message && w.create("div", { "class": "app-error load-map-error", innerHTML: M.message }, document.body) }, _hideError: function () { m("div.load-map-error", document.body).forEach(function (M) { document.body.removeChild(M) }) },
                                                _createWebMapRaw: function (M, R, ca, K) {
                                                        return t.createWebMap(M, R, ca, K).then(q.hitch(this, function (Q) { return Q }), q.hitch(this, function (Q) {
                                                                console.error(Q); if (Q && Q instanceof Error && Q.message) {
                                                                        var X = q.getObject("arcgis.utils.baseLayerError", !1, n.cache["esri/nls/jsapi/" + d.locale]); if (X && 0 <= Q.message.indexOf(X)) return new z({ message: window.jimuNls.map.basemapNotAvailable + window.jimuNls.map.displayDefaultBasemap }), a.getItem(R).then(q.hitch(this, function (W) {
                                                                                W.itemData.spatialReference = { wkid: 102100, latestWkid: 3857 };
                                                                                W.itemData.baseMap = { baseMapLayers: [{ url: "http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer", opacity: 1, layerType: "ArcGISTiledMapServiceLayer", visibility: !0, id: "defaultBasemap_0" }], title: "Topographic" }; return t.createWebMap(M, W, ca, K)
                                                                        }))
                                                                } throw Q;
                                                        }))
                                                }, _showUnreachableLayersTitleMessage: function () {
                                                        var M = this.layerInfosObj.getUnreachableLayersTitle(), R = "", ca = window.jimuNls.map.layerLoadedError || "The layer, ${layers} cannot be added to the map."; ca && M && 0 < M.length && (A.forEach(M,
                                                                q.hitch(this, function (K) { R = R + K + ", " })), new z({ message: ca.replace("${layers}", R) }))
                                                }, _addDataLoadingOnMapUpdate: function (M) { var R = w.toDom('\x3cdiv class\x3d"map-loading"\x3eLoading...\x3c/div\x3e'); w.place(R, M.root); M.updating && w.addClass(R, "loading"); r(M, "update-start", q.hitch(this, function () { w.addClass(R, "loading") })); r(M, "update-end", q.hitch(this, function () { w.removeClass(R, "loading") })); r(M, "unload", q.hitch(this, function () { w.destroy(R); R = null })) }, _checkAppState: function () {
                                                        var M = "extent center marker find query scale level".split(" "),
                                                        R = this.appConfig.keepAppState; R && A.forEach(M, function (ca) { ca in this.urlParams && (R = !1) }, this); R && this.appStateManager.getWabAppState().then(q.hitch(this, function (ca) { if (ca.extent || ca.layers) { var K = new x({ nls: { title: this.nls.appState.title, restoreMap: this.nls.appState.restoreMap } }); K.placeAt("main-page"); r(K, "applyAppState", q.hitch(this, function () { this._applyAppState(ca, this.map) })); K.startup(); K.show() } }))
                                                }, _applyAppState: function (M, R) {
                                                        this.layerInfosObj.restoreState({ layerOptions: M.layers || null });
                                                        M.extent && R.setExtent(M.extent)
                                                }, _processMapOptions: function (M) { if (M) return M.lods || delete M.lods, M.lods && 0 === M.lods.length && delete M.lods, M = q.clone(M), M.extent && (M.extent = new f(M.extent)), M.center && !q.isArrayLike(M.center) && (M.center = new h(M.center)), M.infoWindow && (M.infoWindow = new c(M.infoWindow, w.create("div", {}, this.mapDivId))), M }, createLayer: function (M, R, ca) {
                                                        B([{
                                                                "2D_tiled": "esri/layers/ArcGISTiledMapServiceLayer", "2D_dynamic": "esri/layers/ArcGISDynamicMapServiceLayer", "2D_image": "esri/layers/ArcGISImageServiceLayer",
                                                                "2D_feature": "esri/layers/FeatureLayer", "2D_rss": "esri/layers/GeoRSSLayer", "2D_kml": "esri/layers/KMLLayer", "2D_webTiled": "esri/layers/WebTiledLayer", "2D_wms": "esri/layers/WMSLayer", "2D_wmts": "esri/layers/WMTSLayer", "3D_tiled": "esri3d/layers/ArcGISTiledMapServiceLayer", "3D_dynamic": "esri3d/layers/ArcGISDynamicMapServiceLayer", "3D_image": "esri3d/layers/ArcGISImageServiceLayer", "3D_feature": "esri3d/layers/FeatureLayer", "3D_elevation": "esri3d/layers/ArcGISElevationServiceLayer", "3D_3dmodle": "esri3d/layers/SceneLayer"
                                                        }[R +
                                                        "_" + ca.type]], q.hitch(this, function (K) {
                                                                var Q = {}; var X = "label url type icon infoTemplate isOperationalLayer".split(" "); for (var W in ca) 0 > X.indexOf(W) && (Q[W] = ca[W]); ca.infoTemplate ? (X = new b(ca.infoTemplate.title, ca.infoTemplate.content), Q.infoTemplate = X, K = new K(ca.url, Q), ca.infoTemplate.width && ca.infoTemplate.height && l.after(K, "onClick", q.hitch(this, function () { M.infoWindow.resize(ca.infoTemplate.width, ca.infoTemplate.height) }), !0)) : K = new K(ca.url, Q); K.isOperationalLayer = ca.isOperationalLayer; K.label =
                                                                        ca.label; K.icon = ca.icon; M.addLayer(K)
                                                        }))
                                                }, onAppConfigChanged: function (M, R, ca) { this.appConfig = M; "mapChange" === R ? this._recreateMap(M) : "mapOptionsChange" === R ? ca.lods && this._recreateMap(M) : "mapRefreshIntervalChange" === R && this.map && this.map.itemInfo.itemData && this.layerInfosObj && this._updateRefreshInterval(ca) }, onMapContentModified: function () { this._recreateMap(this.appConfig) }, _updateRefreshInterval: function (M) {
                                                        var R = -1; R = M.useWebMapRefreshInterval ? -1 : M.minutes; this.layerInfosObj.getLayerInfoArrayOfWebmap().forEach(function (ca) {
                                                                ca.getLayerObject().then(q.hitch(this,
                                                                        function (K) { if (K) { var Q = q.getObject("_wabProperties.originalRefreshinterval", !1, K); 0 < Q && "function" === typeof K.setRefreshInterval && (0 > R ? K.setRefreshInterval(Q) : K.setRefreshInterval(R)) } }), q.hitch(this, function (K) { console.error("can't get layerObject", K) }))
                                                        }, this)
                                                }, _recreateMap: function (M) { this.map && (v.publish("beforeMapDestory", this.map), this.map.destroy()); this._showMap(M) }, disableWebMapPopup: function () { this.map.setInfoWindowOnClick(!1) }, enableWebMapPopup: function () { this.map.setInfoWindowOnClick(!0) }
                                        });
                                        T.getInstance = function (M, R) { null === N && (N = new T(M, R)); return N }; return T
                                })
                }, "esri/dijit/InfoWindow": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-style dijit/_Widget dijit/_Templated dijit/_Container ../kernel ../domUtils ../InfoWindowBase ./_EventedWidget dojo/text!./templates/InfoWindow.html".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p) {
                                var B = E([h, c,
                                        g, b, f], {
                                                declaredClass: "esri.dijit.InfoWindow", isContainer: !0, templateString: p, anchor: "upperright", fixedAnchor: null, coords: null, isShowing: !0, isContentShowing: !0, isTitleBarShowing: !0, width: 250, height: 150, title: "Info Window", setMap: function (t) { this.inherited(arguments); n.place(this.domNode, t.root) }, startup: function () {
                                                        if (!this._started) {
                                                                this.inherited(arguments); this._ANCHORS = [B.ANCHOR_UPPERRIGHT, B.ANCHOR_LOWERRIGHT, B.ANCHOR_LOWERLEFT, B.ANCHOR_UPPERLEFT]; if (7 > v("ie")) {
                                                                        var t = "progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'" +
                                                                                d.getComputedStyle(this._sprite).backgroundImage.replace(/url\("/i, "").replace(/"\)/, "") + "')", u = n.create("div", null, w.body()); d.set(u, { width: "1px", height: "1px", display: "none", backgroundImage: "none", filter: t }); var z = setTimeout(function () { n.destroy(u); clearTimeout(z); z = u = null }, 100); m.query(".sprite", this.domNode).forEach(function (x) { x.style.backgroundImage = "none"; x.style.filter = t })
                                                                } this.resize(this.width, this.height); this.hide()
                                                        }
                                                }, destroy: function () {
                                                        this._destroyed || (this.__unregisterMapListeners(),
                                                                this.destroyDijits(this._title), this.destroyDijits(this._content), this._title.innerHTML = this._content.innerHTML = "", this.inherited(arguments))
                                                }, resize: function (t, u) {
                                                        if (t && u) {
                                                                var z = d.set; z(this._topleft, { height: u + "px", marginLeft: t + "px" }); z(this._topright, { width: t + "px", height: u + "px" }); z(this._user, "width", t - 8 + "px"); z(this._hide, "marginLeft", t - 22 + "px"); z(this._title, "width", t - 25 + "px"); z(this._content, "height", u - 37 + "px"); z(this._bottomleft, { marginLeft: t + "px", marginTop: u + "px" }); z(this._bottomright, {
                                                                        width: t -
                                                                                5 + "px", marginTop: u + "px"
                                                                }); this.width = t; this.height = u; this.coords && this._adjustPosition(this.coords, this.anchor); this.onResize(t, u)
                                                        }
                                                }, _adjustPosition: function (t, u) {
                                                        var z = d.set; z(this._infowindow, { left: Math.round(t.x) + "px", top: Math.round(t.y) + "px" }); u === B.ANCHOR_UPPERLEFT ? z(this._window, { left: null, right: this.width + 18 + "px", top: null, bottom: this.height + 50 + "px" }) : u === B.ANCHOR_UPPERRIGHT ? z(this._window, { left: "6px", right: null, top: null, bottom: this.height + 50 + "px" }) : u === B.ANCHOR_LOWERRIGHT ? z(this._window, {
                                                                left: "6px",
                                                                right: null, top: "43px", bottom: null
                                                        }) : u === B.ANCHOR_LOWERLEFT && z(this._window, { left: null, right: this.width + 18 + "px", top: "43px", bottom: null })
                                                }, _getAnchor: function (t) { var u = this.map; return u && t ? (t.y < u.height / 2 ? "lower" : "upper") + (t.x < u.width / 2 ? "right" : "left") : "upperright" }, show: function (t, u, z) {
                                                        if (t) {
                                                                t.spatialReference ? (this.mapCoords = t, t = this.coords = this.map.toScreen(t, !0)) : (this.mapCoords = null, this.coords = t); var x = this.map._getFrameWidth(); if (-1 !== x && (t.x %= x, 0 > t.x && (t.x += x), this.map.width > x)) for (var y = (this.map.width -
                                                                        x) / 2; t.x < y;)t.x += x; u && -1 !== A.indexOf(this._ANCHORS, u) || (u = this._getAnchor(t)); k.remove(this._pointer, this.anchor); u = this.anchor = this.fixedAnchor || u; this._adjustPosition(t, u); k.add(this._pointer, u); a.show(this.domNode); this.isShowing = !0; if (!z) this.onShow()
                                                        }
                                                }, hide: function (t, u) { a.hide(this.domNode); this.isShowing = !1; if (!u) this.onHide() }, showTitleBar: function () { a.show(this._titlebar); a.show(this._border); this.isTitleBarShowing = !0 }, hideTitleBar: function () {
                                                        a.hide(this._titlebar); a.hide(this._border); this.isTitleBarShowing =
                                                                !1
                                                }, showContent: function () { a.show(this._content); a.show(this._border); this.isContentShowing = !0 }, hideContent: function () { a.hide(this._content); a.hide(this._border); this.isContentShowing = !1 }, move: function (t, u) { u ? t = this.coords.offset(t.x, t.y) : (this.coords = t, this.mapCoords && (this.mapCoords = this.map.toMap(t))); d.set(this._infowindow, { left: Math.round(t.x) + "px", top: Math.round(t.y) + "px" }) }, setFixedAnchor: function (t) {
                                                        t && -1 === A.indexOf(this._ANCHORS, t) || (this.fixedAnchor = t, this.isShowing && this.show(this.mapCoords ||
                                                                this.coords, t), this.onAnchorChange(t))
                                                }, setTitle: function (t) { this.destroyDijits(this._title); this.__setValue("_title", t); return this }, setContent: function (t) { this.destroyDijits(this._content); this.__setValue("_content", t); return this }, onShow: function () { this.__registerMapListeners(); this.startupDijits(this._title); this.startupDijits(this._content) }, onHide: function () { this.__unregisterMapListeners() }, onResize: function () { }, onAnchorChange: function () { }
                                }); q.mixin(B, {
                                        ANCHOR_UPPERRIGHT: "upperright", ANCHOR_LOWERRIGHT: "lowerright",
                                        ANCHOR_LOWERLEFT: "lowerleft", ANCHOR_UPPERLEFT: "upperleft"
                                }); v("extend-esri") && q.setObject("dijit.InfoWindow", B, e); return B
                        })
                }, "esri/dijit/PopupMobile": function () {
                        define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../lang ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z) {
                                        E = q([a, f], {
                                                declaredClass: "esri.dijit.PopupMobile", offsetX: 3, offsetY: 3, zoomFactor: 4, marginLeft: 10, marginTop: 10, highlight: !0, popupNavigationBar: null, popupInfoView: null, location: null, xIcon: E.toUrl("./images/whitex.png"), dArrowIcon: E.toUrl("./images/whitedown.png"), lArrowIcon: E.toUrl("./images/whitel.png"), rArrowIcon: E.toUrl("./images/whiter.png"), constructor: function (x, y) {
                                                        this.initialize(); A.mixin(this, x); this.domNode = n.byId(y); this._nls = A.mixin({},
                                                                z.widgets.popup); x = this.domNode; c.add(x, "esriPopupMobile"); (this._isRTL = !b.isBodyLtr()) && e.set(x, "direction", "rtl"); d.set(x, "innerHTML", "\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
                                                        y = r.query(".titlePane", x)[0]; this._arrowButton = r.query(".arrow", y)[0]; this._pointerTop = r.query(".top", x)[0]; this._pointerBottom = r.query(".bottom", x)[0]; this._title = r.query(".title", y)[0]; this._footer = r.query(".footer", y)[0]; this._prev = r.query(".prev", y)[0]; this._next = r.query(".next", y)[0]; this._spinner = r.query(".spinner", y)[0]; this._eventConnections = [w.connect(r.query(".close", y)[0], "onclick", this, this.hide), w.connect(this._arrowButton, "onclick", this, this._toggleView), w.connect(this._prev, "onclick",
                                                                this, function () { this.selectPrevious(); this._updateUI() }), w.connect(this._next, "onclick", this, function () { this.selectNext(); this._updateUI() })]; this._initPopupNavigationBar(); this._initPopupInfoView(); u.hide(x); this.isShowing = !1
                                                }, setMap: function (x) { this.inherited(arguments); g.place(this.domNode, x.root); this.highlight && this.enableHighlight(x) }, unsetMap: function () { this.disableHighlight(this.map); this.inherited(arguments) }, setTitle: function (x, y) {
                                                        this.destroyDijits(this._title); this.place(x, this._title);
                                                        this.destroyDijits(this._footer); this.place(y, this._footer); this.isShowing && (this.startupDijits(this._title), this.startupDijits(this._footer))
                                                }, setContent: function (x) { this.destroyDijits(this._contentPane); this.place(x, this._contentPane); this.startupDijits(this._contentPane) }, show: function (x) {
                                                        if (x) { var y = this.map; x.spatialReference ? (this.location = x, x = y.toScreen(x)) : this.location = y.toMap(x); this._maximized ? this.restore() : this._setPosition(x); this.isShowing || (u.show(this.domNode), this.isShowing = !0, this.onShow()) } else u.show(this.domNode),
                                                                this.isShowing = !0
                                                }, hide: function () { this.isShowing && (u.hide(this.domNode), this.isShowing = !1, this.onHide()) }, onShow: function () { this._followMap(); this.startupDijits(this._title); this.showHighlight() }, onHide: function () { this._unfollowMap(); this.hideHighlight() }, destroy: function () { this.map && this.unsetMap(); this.cleanup(); this.isShowing && this.hide(); this.destroyDijits(this._title); this.destroyDijits(this._footer); m.forEach(this._eventConnections, w.disconnect); g.destroy(this.domNode) }, selectNext: function () {
                                                        this.select(this.selectedIndex +
                                                                1)
                                                }, selectPrevious: function () { this.select(this.selectedIndex - 1) }, setFeatures: function () { this.inherited(arguments); this._updateUI() }, onSetFeatures: function () { }, onClearFeatures: function () { this.setTitle("\x26nbsp;", "\x26nbsp;"); c.add(this._arrowButton, "hidden"); this._updateUI(); this.hideHighlight() }, onSelectionChange: function () { var x = this.selectedIndex; this._updateUI(); 0 <= x && (this.setContent(this.features[x].getContent()), this.updateHighlight(this.map, this.features[x]), this.isShowing && this.showHighlight()) },
                                                onDfdComplete: function () { this._updateUI() }, _followMap: function () { this._unfollowMap(); var x = this.map; this._handles = [w.connect(x, "onPanStart", this, this._onPanStart), w.connect(x, "onPan", this, this._onPan), w.connect(x, "onZoomStart", this, this._onZoomStart), w.connect(x, "onExtentChange", this, this._onExtentChange)] }, _unfollowMap: function () { var x = this._handles; x && (m.forEach(x, w.disconnect), this._handles = null) }, _onPanStart: function () {
                                                        var x = this.domNode.style; this._panOrigin = {
                                                                left: x.left, top: x.top, right: x.right,
                                                                bottom: x.bottom
                                                        }
                                                }, _onPan: function (x, y) { var D = this._panOrigin; x = y.x; y = y.y; var H = D.left, I = D.top, N = D.right; D = D.bottom; H && (H = parseFloat(H) + x + "px"); I && (I = parseFloat(I) + y + "px"); N && (N = parseFloat(N) - x + "px"); D && (D = parseFloat(D) - y + "px"); e.set(this.domNode, { left: H, top: I, right: N, bottom: D }) }, _onZoomStart: function () { u.hide(this.domNode) }, _onExtentChange: function (x, y, D) { D && (u.show(this.domNode), this.show(this._targetLocation || this.location), this._targetLocation = null) }, _setPosition: function (x) {
                                                        var y = x.x; x = x.y; var D =
                                                                b.getContentBox(this.map.container), H = D.w; D = D.h; var I = 0, N = x + 10, T = 118, M = H - 18; 18 < y && y < M ? (I = y - 130, 0 > I ? I = 0 : I > H - 260 && (I = H - 260)) : 18 >= y ? I = y - 18 : y >= M && (I = H - 260 + (y - M)); 118 < y && y < H - 130 ? T = 118 : 118 >= y ? 18 < y ? T = y - 12 : 18 >= y && (T = 6) : y >= H - 130 && (y < M ? T = 118 + y - (H - 130) : y >= M && (T = 118 + M - (H - 130))); x <= D / 2 ? (e.set(this.domNode, { left: I + "px", top: N + "px", bottom: null }), e.set(this._pointerTop, { left: T + "px" }), c.add(this._pointerBottom, "hidden"), c.remove(this._pointerTop, "hidden")) : (e.set(this.domNode, { left: I + "px", top: N - 64 + "px", bottom: null }),
                                                                        e.set(this._pointerBottom, { left: T + "px" }), c.add(this._pointerTop, "hidden"), c.remove(this._pointerBottom, "hidden"))
                                                }, _showPointer: function (x) { m.forEach(["topLeft", "topRight", "bottomRight", "bottomLeft"], function (y) { y === x ? r.query(".pointer." + y, this.domNode).removeClass("hidden") : r.query(".pointer." + y, this.domNode).addClass("hidden") }, this) }, _toggleView: function () {
                                                        this.popupNavigationBar || this._initPopupNavigationBar(); this.popupInfoView || this._initPopupInfoView(); this.hide(); u.show(this.popupNavigationBar.container);
                                                        u.show(this.popupInfoView.container); 0 <= this.selectedIndex && this.setContent(this.features[this.selectedIndex].getContent())
                                                }, _handleNavigationBar: function (x) {
                                                        this.popupInfoView.animateTo(0); switch (x.name) {
                                                                case "CloseButton": u.hide(this.popupNavigationBar.container); u.hide(this.popupInfoView.container); this.hide(); break; case "ToggleButton": u.hide(this.popupNavigationBar.container); u.hide(this.popupInfoView.container); this.show(this.location); break; case "PreviousButton": this.selectPrevious(); this._updateUI();
                                                                        break; case "NextButton": this.selectNext(), this._updateUI()
                                                        }
                                                }, _initPopupNavigationBar: function () {
                                                        var x = {}, y = this._isRTL ? this.rArrowIcon : this.lArrowIcon, D = this._isRTL ? this.lArrowIcon : this.rArrowIcon; x.items = [{ name: "CloseButton", type: "img", src: this.xIcon, srcAlt: this.xIcon, position: "left" }, { name: "Title", type: "span", text: "", position: "center" }, { name: "ToggleButton", type: "img", src: this.dArrowIcon, srcAlt: this.dArrowIcon, position: "right", toggleGroup: "toggle" }, {
                                                                name: "PreviousButton", type: "img", src: y, srcAlt: y,
                                                                position: "right2", toggleGroup: "previous"
                                                        }, { name: "NextButton", type: "img", src: D, srcAlt: D, position: "right1", toggleGroup: "next" }]; this.popupNavigationBar = new p(x, g.create("div", {}, v.body())); w.connect(this.popupNavigationBar, "onCreate", this, function (H) { this._prevFeatureButton = H[3]._node; this._nextFeatureButton = H[4]._node }); w.connect(this.popupNavigationBar, "onSelect", this, this._handleNavigationBar); w.connect(this.popupNavigationBar, "onUnSelect", this, this._handleNavigationBar); this.popupNavigationBar.startup();
                                                        u.hide(this.popupNavigationBar.container)
                                                }, _initPopupInfoView: function () {
                                                        this.popupInfoView = new h({ items: [{ name: "Navigator", type: "div", text: "" }, { name: "content", type: "div", text: "" }, { name: "attachment", type: "div", text: "" }] }, g.create("div", {}, v.body())); c.add(this.popupInfoView.container, "esriMobilePopupInfoView"); this.popupInfoView.enableTouchScroll(); w.connect(this.popupInfoView, "onCreate", this, function (x) { this._contentPane = x[1]._node; 0 <= this.selectedIndex && this.setContent(this.features[this.selectedIndex].getContent()) });
                                                        w.connect(this.popupInfoView, "onSwipeLeft", this, function () { }); w.connect(this.popupInfoView, "onSwipeRight", this, function () { }); this.popupInfoView.startup()
                                                }, _updateUI: function () {
                                                        var x = "\x26nbsp;", y = "\x26nbsp;", D = this.selectedIndex, H = this.features, I = this.deferreds, N = this._prevFeatureButton.parentNode, T = this._nextFeatureButton.parentNode, M = this._spinner, R = this._nls; H && 1 <= H.length ? (x = H[D].getTitle(), y = t.substitute({ index: D + 1, total: H.length }, R.NLS_pagingInfo), c.remove(this._arrowButton, "hidden"), 0 === D ?
                                                                (c.add(N, "hidden"), c.add(this._prev, "hidden")) : (c.remove(N, "hidden"), c.remove(this._prev, "hidden")), D === H.length - 1 ? (c.add(T, "hidden"), c.add(this._next, "hidden")) : (c.remove(T, "hidden"), c.remove(this._next, "hidden"))) : (c.add(this._arrowButton, "hidden"), c.add(N, "hidden"), c.add(T, "hidden"), c.add(this._prev, "hidden"), c.add(this._next, "hidden")); this.setTitle(x, y); this.popupNavigationBar.getItems()[1]._node.innerHTML = y; I && I.length ? (c.remove(M, "hidden"), this.setTitle(R.NLS_searching + "...", "\x26nbsp;")) :
                                                                        (c.add(M, "hidden"), H && H.length || this.setTitle("No Information", "\x26nbsp;"))
                                                }
                                        }); l("extend-esri") && A.setObject("dijit.PopupMobile", E, B); return E
                                })
                }, "esri/dijit/InfoView": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                E = E(null, {
                                        declaredClass: "esri.dijit.InfoView", _items: [], _top: null, _sections: [],
                                        _isDecelerate: !1, constructor: function (b, e) {
                                                this.container = l.byId(e); this._touchBase = g(this.container, null); this._slideDiv = n.create("div", null, this.container, "first"); this.events = []; this._items = b.items; b.sections && (this._sections = b.sections); k.add(this.container, "esriMobileInfoView"); if (0 === this._sections.length) n.create("div", {}, this._slideDiv); else for (b = 0; b < this._sections.length; b++)e = n.create("div", { "class": "esriMobileInfoViewSection" }, this._slideDiv), n.create("div", { innerHTML: this._sections[b].title },
                                                        e); for (b = 0; b < this._items.length; b++) { e = 0; this._items[b].section && (e = this._items[b].section); switch (this._items[b].type) { case "div": var a = n.create("div", { "class": "esriMobileInfoViewItem", style: this._items[b].style }, this._slideDiv.childNodes[e]); a = n.create("div", { innerHTML: this._items[b].text }, a) }this._items[b].className && k.add(a, this._items[b].className); a._index = b; a._item = this._items[b]; this._items[b]._node = a } this.startTouchY = 0
                                        }, startup: function () { this.onCreate(this._items); this._animateTo(0) }, destroy: function () {
                                                A.forEach(this.events,
                                                        w.disconnect); this._touchBase = null; m.query("img", this.container).forEach(function (b) { b._index = null; b._item = null; n.destroy(b); b = null }); this._items = null; n.destroy(this._slideDiv); n.destroy(this.container); this.container = this._slideDiv = null
                                        }, getItems: function () { return this._items }, setPreventDefault: function (b) { this._touchBase.setPreventDefault(b) }, enableTouchScroll: function () {
                                                this._touchBase.setPreventDefault(!0); this.events.push(w.connect(this._touchBase, "onTouchStart", this, this._onTouchStartHandler));
                                                this.events.push(w.connect(this._touchBase, "onTouchMove", this, this._onTouchMoveHandler)); this.events.push(w.connect(this._touchBase, "onTouchEnd", this, this._onTouchEndHandler)); this._slideDiv.style.webkitTransform = "translate3d(0," + this._top + "px, 0)"
                                        }, disableTouchScroll: function () { w.disconnect(this.events.pop()); w.disconnect(this.events.pop()); w.disconnect(this.events.pop()); this._touchBase.setPreventDefault(!1); this._slideDiv.style.webkitTransform = "translate3d(0, 0px, 0)" }, animateTo: function () {
                                                this._slideDiv.style.WebkitTransitionDuration =
                                                "0s"; this._animateTo(0)
                                        }, onSelect: function (b) { }, onUnSelect: function (b) { }, onCreate: function (b) { }, onClick: function (b) { }, onSwipeLeft: function () { }, onSwipeRight: function () { }, _onTouchStartHandler: function (b) { this._slideDiv.style.WebkitTransitionDuration = "0s"; this._moveDirection = null; this._startTime = new Date; this.startTouchY = b.touches[0].clientY; this.contentStartOffsetY = this.contentOffsetY }, _onTouchMoveHandler: function (b) {
                                                this._moveDirection || (this._moveDirection = Math.abs(b.curY) > Math.abs(b.curX) ? "vertical" :
                                                        "horizontal"); "horizontal" !== this._moveDirection && "vertical" === this._moveDirection && this._animateTo(b.touches[0].clientY - this.startTouchY + this.contentStartOffsetY)
                                        }, _onTouchEndHandler: function (b) { this._endTime = new Date; this._deltaMovement = b.curY; if ("vertical" === this._moveDirection) this._shouldStartMomentum() ? this._doMomentum() : this._snapToBounds(); else if ("horizontal" === this._moveDirection) if ("left" === b.swipeDirection) this.onSwipeLeft(); else if ("right" === b.swipeDirection) this.onSwipeRight() }, _shouldStartMomentum: function () {
                                                this._diff =
                                                this._endTime - this._startTime; this._velocity = this._deltaMovement / this._diff; return .2 < Math.abs(this._velocity) && 200 > this._diff ? !0 : !1
                                        }, _doMomentum: function () {
                                                var b = d.getContentBox(this.container); var e = 0 > this._velocity ? .001 : -.001; var a = -(this._velocity * this._velocity) / (2 * e); var f = -this._velocity / e; e = 3 * .6; var h = 1 - e, p = 0, B = 0; if (b.h > this._slideDiv.scrollHeight) this.contentOffsetY = 0, B = 300; else if (0 < this.contentOffsetY + a) {
                                                        b = 0; for (a = Math.floor(f / 20); b < a; b++)if (p = (20 * h * b ^ 3) + (20 * e * b ^ 2) + 0 * b, p = 0 > this._velocity ?
                                                                -p : p, 0 < this.contentOffsetY + p) { B = 20 * b; break } 0 === B && (B = 300); this.contentOffsetY = 0
                                                } else if (Math.abs(this.contentOffsetY + a) + b.h > this._slideDiv.scrollHeight) for (this.contentOffsetY = b.h - this._slideDiv.scrollHeight, b = 0, a = Math.floor(f / 20); b < a; b++) { if (p = (20 * h * b ^ 3) + (20 * e * b ^ 2) + 0 * b, p = 0 > this._velocity ? -p : p, Math.abs(this.contentOffsetY + p) > this._slideDiv.scrollHeight) { B = 20 * b; break } } else B = f, this.contentOffsetY += a; this._slideDiv.style.webkitTransition = "-webkit-transform " + B + "ms cubic-bezier(0, 0.3, 0.6, 1)"; this._animateTo(this.contentOffsetY)
                                        },
                                        _snapToBounds: function () { var b = d.getContentBox(this.container); b.h > this._slideDiv.scrollHeight ? this.contentOffsetY = 0 : 0 < this.contentOffsetY ? this.contentOffsetY = 0 : Math.abs(this.contentOffsetY) + b.h > this._slideDiv.scrollHeight && (this.contentOffsetY = b.h - this._slideDiv.scrollHeight); this._slideDiv.style.WebkitTransitionDuration = "0.5s"; this._animateTo(this.contentOffsetY) }, _animateTo: function (b) { this.contentOffsetY = b; this._slideDiv.style.webkitTransform = "translate3d(0, " + b + "px, 0)" }, _stopMomentum: function () {
                                                if (this._isDecelerating()) {
                                                        var b =
                                                                document.defaultView.getComputedStyle(this._slideDiv, null); b = new WebKitCSSMatrix(b.webkitTransform); this._slideDiv.style.webkitTransition = ""; this.animateTo(b.m42)
                                                }
                                        }, _isDecelerating: function () { return this.isDecelerate ? !0 : !1 }, _toggleNode: function (b, e) { "ON" === e.toggleState ? (e.toggleState = "OFF", e.src && (b.src = e.src.toString()), this.onUnSelect(e)) : (e.toggleState = "ON", e.srcAlt && (b.src = e.srcAlt), this.onSelect(e)) }
                                }); v("extend-esri") && q.setObject("dijit.InfoView", E, c); return E
                        })
                }, "esri/dijit/_TouchBase": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),
                                function (E, q, A, w, m, v) {
                                        E = E(null, {
                                                declaredClass: "esri.dijit._TouchBase", _preventDefault: !0, _swipeThreshold: 20, constructor: function (r, l) { this.domNode = w.byId(r); this.events = [A.connect(this.domNode, "touchstart", this, this._touchStartHandler), A.connect(this.domNode, "touchmove", this, this._touchMoveHandler), A.connect(this.domNode, "touchend", this, this._touchEndHandler), A.connect(this.domNode, "onclick", this, this._clickHandler)] }, setPreventDefault: function (r) { this._preventDefault = r }, disableOnClick: function () { A.disconnect(this.events.pop()) },
                                                _clickHandler: function (r) { if (this._moved) r.preventDefault(); else this.onclick(r) }, _touchStartHandler: function (r) { this._moved = !1; this.client_x = r.targetTouches[0].clientX; this.client_y = r.targetTouches[0].clientY; this.down_x = r.targetTouches[0].pageX; this.down_y = r.targetTouches[0].pageY; r.downX = this.down_x; r.downY = this.down_y; this.onTouchStart(r) }, _touchMoveHandler: function (r) {
                                                        this._preventDefault && r.preventDefault(); this._moved = !0; this.up_x = r.targetTouches[0].pageX; this.cur_x = r.targetTouches[0].pageX -
                                                                this.down_x; this.cur_y = r.targetTouches[0].pageY - this.down_y; r.curX = this.cur_x; r.curY = this.cur_y; this.onTouchMove(r)
                                                }, _touchEndHandler: function (r) { this._moved ? (r.curX = this.cur_x, r.curY = this.cur_y, this.down_x - this.up_x > this._swipeThreshold ? r.swipeDirection = "left" : this.up_x - this.down_x > this._swipeThreshold && (r.swipeDirection = "right")) : (r.clientX = this.client_x, r.clientY = this.client_y); this.onTouchEnd(r) }, onTouchStart: function (r) { }, onTouchMove: function (r) { }, onTouchEnd: function (r) { }, onclick: function (r) { }
                                        });
                                        m("extend-esri") && q.setObject("dijit._TouchBase", E, v); return E
                                })
                }, "esri/dijit/NavigationBar": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                E = E(null, {
                                        declaredClass: "esri.dijit.NavigationBar", _items: [], constructor: function (g, b) {
                                                this.container = l.byId(b); this._touchBase = d(this.container, null); this._slideDiv = n.create("div",
                                                        {}, this.container, "first"); this.events = [A.connect(this._touchBase, "onclick", this, this._onClickHandler)]; this._items = g.items; k.add(this.container, "esriMobileNavigationBar"); b = n.create("div", {}, this._slideDiv); for (g = 0; g < this._items.length; g++) {
                                                                switch (this._items[g].type) {
                                                                        case "img": var e = n.create("div", { "class": "esriMobileNavigationItem" }, b); var a = n.create("img", { src: this._items[g].src.toString(), style: { width: "100%", height: "100%" } }, e); break; case "span": e = n.create("div", { "class": "esriMobileNavigationItem" },
                                                                                b); a = n.create("span", { innerHTML: this._items[g].text }, e); break; case "div": e = n.create("div", { "class": "esriMobileNavigationInfoPanel" }, b), a = n.create("div", { innerHTML: this._items[g].text }, e)
                                                                }k.add(e, this._items[g].position); this._items[g].className && k.add(a, this._items[g].className); a._index = g; a._item = this._items[g]; this._items[g]._node = a
                                                        }
                                        }, startup: function () { this.onCreate(this._items) }, destroy: function () {
                                                w.forEach(this.events, A.disconnect); this._touchBase = null; m.query("img", this.container).forEach(function (g) {
                                                        g._index =
                                                        null; g._item = null; n.destroy(g); g = null
                                                }); this._items = null; n.destroy(this._slideDiv); n.destroy(this.container); this.container = this._slideDiv = null
                                        }, getItems: function () { return this._items }, select: function (g) { this._markSelected(g._node, g) }, onSelect: function (g) { }, onUnSelect: function (g) { }, onCreate: function (g) { }, _onClickHandler: function (g) {
                                                if ("img" === g.target.tagName.toLowerCase()) {
                                                        var b = g.target, e = b._item; m.query("img", this.container).forEach(function (a) {
                                                                a !== b && a._item.toggleGroup === e.toggleGroup && this._markUnSelected(a,
                                                                        a._item)
                                                        }, this); this._toggleNode(b, e)
                                                }
                                        }, _toggleNode: function (g, b) { "ON" === b.toggleState ? (b.toggleState = "OFF", b.src && (g.src = b.src.toString()), this.onUnSelect(b)) : (b.toggleState = "ON", b.srcAlt && (g.src = b.srcAlt), this.onSelect(b)) }, _markSelected: function (g, b) { b.toggleState = "ON"; b.srcAlt && (g.src = b.srcAlt); this.onSelect(b) }, _markUnSelected: function (g, b) { "ON" === b.toggleState && (b.toggleState = "OFF", b.src && (g.src = b.src.toString()), this.onUnSelect(b)) }
                                }); v("extend-esri") && q.setObject("dijit.NavigationBar", E, c);
                                return E
                        })
                }, "jimu/dijit/AppStatePopup": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/on dojo/mouse dojo/_base/fx dojo/topic dojo/Evented".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                var n = 1E3, d = 1E4; return E([q, k], {
                                        baseClass: "jimu-appstate-popup", declaredClass: "jimu.dijit.AppStatePopup", currentState: 0, timeoutHandler: void 0, constructor: function (c) { this.inherited(arguments); "animationDuration" in c && (n = c.animationDuration); "autoCloseInterval" in c && (d = c.autoCloseInterval) },
                                        postCreate: function () {
                                                window.appInfo.isRunInMobile && w.addClass(this.domNode, "mobile"); var c = w.create("div", { "class": "appstate-header" }); w.create("div", { "class": "appstate-title", innerHTML: this.nls.title }, c); var g = w.create("div", { "class": "appstate-close" }, c); w.place(c, this.domNode); c = w.create("div", { "class": "appstate-tips", innerHTML: this.nls.restoreMap }); w.place(c, this.domNode); this.own(m(c, "click", A.hitch(this, function () { this.emit("applyAppState"); this.hide() }))); this.own(m(g, "click", A.hitch(this,
                                                        function () { this.hide() }))); this.own(m(this.domNode, v.enter, A.hitch(this, function () { this._timerStop() }))); this.own(m(this.domNode, v.leave, A.hitch(this, function () { this._timerStart() })))
                                        }, show: function () {
                                                r.animateProperty({ node: this.domNode, duration: n, properties: window.appInfo.isRunInMobile ? { top: { start: -120, end: 0 } } : { bottom: { start: -100, end: 10 } }, onEnd: A.hitch(this, function () { this.currentState = 1 }) }).play(); l.subscribe("splashPopupShow", A.hitch(this, function () { this._timerStop() })); l.subscribe("splashPopupHide",
                                                        A.hitch(this, function () { this._timerStart() })); this.timeoutHandler = setTimeout(A.hitch(this, this.hide), d)
                                        }, hide: function () { 0 !== this.currentState && r.animateProperty({ node: this.domNode, duration: n, properties: window.appInfo.isRunInMobile ? { top: { start: 0, end: -120 } } : { bottom: { start: 10, end: -100 } }, onEnd: A.hitch(this, function () { this.currentState = 0; w.setStyle(this.domNode, "display", "none") }) }).play() }, _timerStart: function () {
                                                1 !== this.currentState || this.timeoutHandler || (this.timeoutHandler = setTimeout(A.hitch(this,
                                                        this.hide), d))
                                        }, _timerStop: function () { this.timeoutHandler && (clearTimeout(this.timeoutHandler), this.timeoutHandler = void 0) }
                                })
                        })
                }, "jimu/MapUrlParamsHandler": function () {
                        define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/topic dojo/promise/all esri/geometry/Point esri/geometry/Extent esri/geometry/scaleUtils esri/SpatialReference esri/tasks/ProjectParameters esri/config esri/geometry/webMercatorUtils esri/symbols/jsonUtils esri/graphic esri/layers/GraphicsLayer esri/InfoTemplate esri/tasks/query ./utils ./LayerInfos/LayerInfos ./shareUtils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B) {
                                        function t(Q, X) { var W = Q.center.split(";"); 1 === W.length && (W = Q.center.split(",")); if (2 === W.length || 3 === W.length) { Q = parseFloat(W[0]); var fa = parseFloat(W[1]); if (isNaN(Q) || isNaN(fa)) Q = parseFloat(W[0]), fa = parseFloat(W[1]); if (!isNaN(Q) && !isNaN(fa)) { var ma = 4326; 3 !== W.length || isNaN(W[2]) || (ma = parseInt(W[2], 10)); W = new v(Q, fa, new k(ma)); R(W.spatialReference, X.spatialReference) ? X.centerAt(W) : M(W, X.spatialReference, function (ia) { X.centerAt(ia[0]) }, function () { console.error("Project center point error.") }) } } }
                                        function u(Q, X) {
                                                var W = Q.extent.split("wkt\x3d"), fa = null; 2 === W.length ? (fa = W[1], W = W[0], W = W.split(",")) : (W = Q.extent.split(";"), 1 === W.length && (W = Q.extent.split(","))); if (4 === W.length || 5 === W.length) {
                                                        Q = parseFloat(W[0]); var ma = parseFloat(W[1]), ia = parseFloat(W[2]), va = parseFloat(W[3]); if (isNaN(Q) || isNaN(Q) || isNaN(Q) || isNaN(Q)) Q = parseFloat(W[0]), ma = parseFloat(W[1]), ia = parseFloat(W[2]), va = parseFloat(W[3]); if (isNaN(Q) || isNaN(ma) || isNaN(ia) || isNaN(va)) console.error("Wrong extent parameters."); else {
                                                                var xa = 4326;
                                                                5 !== W.length || isNaN(W[4]) || (xa = parseInt(W[4], 10)); W = null; W = fa ? new r(Q, ma, ia, va, new k({ wkt: fa })) : new r(Q, ma, ia, va, new k({ wkid: xa })); R(X.spatialReference, W.spatialReference) ? X.setExtent(W) : M(W, X.spatialReference, function (na) { X.setExtent(na[0]) }, function () { console.error("Project extent error.") })
                                                        }
                                                } else console.error("Wrong extent parameters.")
                                        } function z(Q, X) {
                                                var W = null; if (Q.markertemplate) {
                                                        W = { title: "", content: "", isIncludeShareUrl: !1 }; try {
                                                                var fa = JSON.parse(decodeURIComponent(Q.markertemplate)); E.mixin(W,
                                                                        fa)
                                                        } catch (wa) { console.error("urlParams: \x26markertemplate JSON.parse error." + wa.stack) }
                                                } fa = Q.marker.split(";"); 1 === fa.length && (fa = Q.marker.split(",")); if (2 <= fa.length && 6 >= fa.length && fa[0].length && !isNaN(fa[0]) && fa[1].length && !isNaN(fa[1])) {
                                                        var ma = parseFloat(fa[0]), ia = parseFloat(fa[1]), va = 4326; 3 <= fa.length && fa[2].length && !isNaN(fa[2]) && (va = parseInt(fa[2], 10)); var xa = ""; 4 <= fa.length && (xa = fa[3]); Q = null; 5 <= fa.length && 0 === fa[4].indexOf("http") && (Q = fa[4]); var na = null; 6 === fa.length && (na = fa[5]); var ra = g.fromJson({
                                                                type: "esriPMS",
                                                                url: Q, contentType: "image/png"
                                                        }), sa = null; na && (sa = g.fromJson({ color: [0, 0, 0, 255], type: "esriTS", verticalAlignment: "baseline", horizontalAlignment: "left", angle: 0, xoffset: 0, yoffset: 0, rotated: !1, kerning: !0, font: { size: 12, style: "normal", weight: "bold", family: "Arial" }, text: na })); y(ra).then(function () { var wa = new v(ma, ia, new k({ wkid: va })); R(wa.spatialReference, X.spatialReference) ? x(wa, ra, sa, xa, W, X) : M(wa, X.spatialReference, function (aa) { x(aa[0], ra, sa, xa, W, X) }, function () { console.error("Project center point error.") }) })
                                                }
                                        }
                                        function x(Q, X, W, fa, ma, ia) { fa = new a("", fa); if (ma) { var va = B.getXyContent(ma); ma.isIncludeShareUrl && (ma = B.getShareUrl(ia, ma, !0), ma = B.getShareUrlContent(ma), va += ma); fa.setContent(va) } va = new e({ id: "marker-feature-action-layer" }); ia.addLayer(va); fa = new b(Q, X, null, fa); va.add(fa); W && (W.xoffset = X.width / 2, W.yoffset = X.height / 2 + X.yoffset, X = new b(new v(Q.toJson()), W), va.add(X), fa._textSymbol = X); ia.centerAt(Q) } function y(Q) {
                                                var X = new A; Q.url ? h.getImagesSize(Q.url).then(function (W) { Q.width = W[0]; Q.height = W[1]; X.resolve(Q) },
                                                        function () { Q.url = require.toUrl("jimu") + "/images/EsriBluePinCircle26.png"; Q.width = 26; Q.height = 26; Q.setOffset(0, Q.height / 2); X.resolve(Q) }) : (Q.url = require.toUrl("jimu") + "/images/EsriBluePinCircle26.png", Q.width = 26, Q.height = 26, Q.setOffset(0, Q.height / 2), X.resolve(Q)); return X
                                        } function D(Q, X) {
                                                var W = Q.query.split(";"); 1 === W.length && (W = Q.query.split(",")); if (2 !== W.length && 3 !== W.length) console.error("query URL parameter is not correct."); else {
                                                        var fa = W[0]; T("name", fa, X).then(function (ma) {
                                                                null === ma ? T("id", fa,
                                                                        X).then(function (ia) { null === ia ? console.error("Invalid layer name or id.") : H(X, ia, W) }) : H(X, ma, W)
                                                        })
                                                }
                                        } function H(Q, X, W) {
                                                var fa = new f, ma = ""; fa.outSpatialReference = Q.spatialReference; if (2 === W.length) fa.where = W[1]; else if (3 === W.length && (X.layerObject.url && h.isHostedService(X.layerObject.url) && h.containsNonLatinCharacter(W[2]) && (ma = "N"), q.forEach(X.layerObject.fields, function (ia) {
                                                        if (ia.alias.toLowerCase() === W[1].toLowerCase() || ia.name.toLowerCase() === W[1].toLowerCase()) -1 < ["esriFieldTypeSmallInteger", "esriFieldTypeInteger",
                                                                "esriFieldTypeSingle", "esriFieldTypeDouble", "esriFieldTypeOID"].indexOf(ia.type) ? fa.where = ia.name + "\x3d" + W[2] : -1 < ["esriFieldTypeString"].indexOf(ia.type) && (fa.where = W[1] + "\x3d" + ma + "'" + W[2].replace(/'/g, "''") + "'")
                                                }, this), !fa.where)) { console.error("Invalid field name or type in query URL parameter."); return } fa.maxAllowableOffset = 1E-5; X.layerObject.queryFeatures(fa).then(function (ia) {
                                                        ia = ia.features; if (0 === ia.length) console.log("No result from query URL parameter."); else {
                                                                if ("esriGeometryPoint" === X.layerObject.geometryType &&
                                                                        1 === ia.length) Q.setExtent(l.getExtentForScale(Q, 1E3)), Q.centerAt(ia[0].geometry); else { var va = h.graphicsExtent(ia); Q.setExtent(va) } I(Q, X, ia)
                                                        }
                                                }, function (ia) { console.error(ia) })
                                        } function I(Q, X, W) { function fa(va) { q.forEach(W, function (xa) { xa.setInfoTemplate(va) }) } function ma() { Q.infoWindow.setFeatures(W); Q.infoWindow.show(N(W[0])) } if (Q.getLayer(X.layerInfo.id)) ma(); else { var ia = X.layerInfo.getInfoTemplate(); ia ? (fa(ia), ma()) : X.layerInfo.loadInfoTemplate().then(function (va) { fa(va); ma() }) } } function N(Q) {
                                                Q =
                                                Q.geometry; if ("point" !== Q.type) if ("multipoint" === Q.type) Q = Q.getPoint(0); else if ("polyline" === Q.type) Q = Q.getExtent().getCenter(); else if ("polygon" === Q.type) Q = Q.getExtent().getCenter(); else if ("extent" === Q.type) Q = Q.getCenter(); else return console.error("Can not get layer geometry type, unknow error."), null; return Q
                                        } function T(Q, X, W) {
                                                var fa = new A, ma = []; p.getInstance(W, W.itemInfo).then(function (ia) {
                                                        ia.traversal(function (va) {
                                                                if (fa.isResolved()) return !0; ("id" === Q && va.id.toLowerCase() === X.toLowerCase() ||
                                                                        "name" === Q && va.title.toLowerCase() === X.toLowerCase()) && ma.push(m({ layerType: va.getLayerType(), layerObject: va.getLayerObject() }).then(function (xa) { "FeatureLayer" === xa.layerType && fa.resolve({ layerInfo: va, layerObject: xa.layerObject }) }, function (xa) { console.error("Find layer error from query URL parameter", xa); fa.resolve(null) }))
                                                        }); m(ma).then(function () { fa.isResolved() || fa.resolve(null) })
                                                }); return fa
                                        } function M(Q, X, W, fa) {
                                                var ma = [102113, 102100, 3857]; if (4326 === Q.spatialReference.wkid && ca(ma, X.wkid)) {
                                                        Q.ymin =
                                                        Math.max(Q.ymin, -89.99); Q.ymax = Math.min(Q.ymax, 89.99); Q = c.geographicToWebMercator(Q); if ((fa = Q.spatialReference._getInfo()) && Q.xmin > Q.xmax) { ma = fa.valid[1] - Q.xmin; var ia = Q.xmax - fa.valid[0]; ma > ia ? Q.xmax = fa.valid[1] + ia : Q.xmin = fa.valid[0] - ma } Q.spatialReference.wkid = X.wkid; W([Q], null)
                                                } else ca(ma, Q.spatialReference.wkid) && 4326 === X.wkid ? (Q = c.webMercatorToGeographic(Q), (fa = Q.spatialReference._getInfo()) && Q.xmin > Q.xmax && (ma = fa.valid[1] - Q.xmin, ia = Q.xmax - fa.valid[0], ma > ia ? Q.xmax = fa.valid[1] + ia : Q.xmin = fa.valid[0] -
                                                        ma), W([Q], null)) : (ma = new n, ma.geometries = [Q], ma.outSR = X, d.defaults.geometryService.project(ma, function (va) { !(va && 0 < va.length && va[0] && "extent" === va[0].type) || isNaN(va[0].xmin) || isNaN(va[0].ymin) || isNaN(va[0].xmax) || isNaN(va[0].ymax) ? va && 0 < va.length && va[0] && "point" === va[0].type && !isNaN(va[0].x) && !isNaN(va[0].y) && W(va, null) : W(va, null) }, fa))
                                        } function R(Q, X) {
                                                var W = [102113, 102100, 3857]; return Q && X && Q.wkt === X.wkt && (Q.wkid === X.wkid || Q.latestWkid && Q.latestWkid === X.wkid || X.latestWkid && Q.wkid === X.latestWkid ||
                                                        Q.latestWkid && Q.latestWkid === X.latestWkid) || Q && X && Q.wkid && X.wkid && ca(W, Q.wkid) && ca(W, X.wkid) ? !0 : !1
                                        } function ca(Q, X) { for (var W = Q.length; W--;)if (Q[W] === X) return !0; return !1 } function K(Q, X, W, fa) { var ma = []; Q && Q[X] && Q[X].split && (ma = Q[X].split(";")); if (ma && 0 <= ma.length) { var ia = {}; ia[W] = ma; p.getInstance(fa, fa.itemInfo).then(function (va) { va.setSimplificationState(ia) }) } } return {
                                                postProcessUrlParams: function (Q, X) {
                                                        a: for (var W = ["showLayers", "hideLayers", "showLayersEncoded", "hideLayersEncoded"], fa = 0, ma = W.length; fa <
                                                                ma; fa++) { var ia = W[fa], va = ia.toLowerCase(), xa; for (xa in Q) { var na = xa.toLowerCase(); if (va === na) { K(Q, xa, ia, X); break a } } } if ("extent" in Q) return u(Q, X); if ("center" in Q) return t(Q, X); if ("marker" in Q) return z(Q, X); if ("find" in Q) w.publish("publishData", "framework", "framework", { searchString: Q.find }, !0); else if ("query" in Q) return D(Q, X)
                                                }
                                        }
                                })
                }, "jimu/shareUtils": function () {
                        define("dojo/_base/lang esri/request dojo/promise/all jimu/shared/basePortalUrlUtils dojo/Deferred esri/lang jimu/portalUtils jimu/Role jimu/utils esri/urlUtils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        var d = {
                                                getBaseHrefUrl: function (c) { var g = "HTML3D" === window.appInfo.appType ? "webappviewer3d" : "webappviewer", b = ""; window.isXT ? b = window.location.protocol + "//" + window.location.host + window.appInfo.appPath : (b = k.urlToObject(window.location.href).query || {}, b = b.appid ? c + "apps/" + g + "/index.html?appid\x3d" + b.appid : b.id ? c + "apps/" + g + "/index.html?id\x3d" + b.id : k.getAppHref()); return b }, addQueryParamToUrl: function (c, g, b, e) {
                                                        c = n.urlToObject(c); c.query || (c.query = {}); c.query[g] = b; g = c.path;
                                                        for (var a in c.query) b = c.query[a], !0 === e && (b = encodeURIComponent(b)), g = g === c.path ? g + "?" + a + "\x3d" + b : g + "\x26" + a + "\x3d" + b; return g
                                                }, getQueryParamFromUrl: function (c, g) { c = n.urlToObject(c); c.query || (c.query = {}); return c.query[g] }, removeQueryParamFromUrl: function (c, g, b) { c = n.urlToObject(c); c.query && delete c.query[g]; g = c.path; for (var e in c.query) { var a = c.query[e]; !0 === b && (a = encodeURIComponent(a)); g = g === c.path ? g + "?" + e + "\x3d" + a : g + "\x26" + e + "\x3d" + a } return g }, getShareUrlContent: function (c) {
                                                        return "\x3cdiv class\x3d'marker-feature-action-popup'\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title jimu-float-leading'\x3e" +
                                                                window.jimuNls.common.url + "\x3c/span\x3e\x3cinput type\x3d'text' class\x3d'jimu-float-leading' readonly\x3d'readonly' value\x3d" + c + "\x3e\x3c/input\x3e\x3c/div\x3e\x3c/div\x3e"
                                                }, getShareUrl: function (c, g, b) {
                                                        var e = d.getBaseHrefUrl(window.portalUrl), a = ""; if (g) if (g.longitude && g.latitude) { var f = g.longitude; var h = g.latitude; a = g.longitude + "," + g.latitude + "," } else if (g.x && g.y && g.spatialReference && g.spatialReference.wkid) { var p = g.x; var B = g.y; var t = g.spatialReference.wkid; a = g.x + "," + g.y + "," + g.spatialReference.wkid } e =
                                                                d.addQueryParamToUrl(e, "marker", a, !0); e = d.addQueryParamToUrl(e + ",,,", "markertemplate", encodeURIComponent(JSON.stringify({ title: g.title, x: p, y: B, wkid: t, longitude: f, latitude: h, isIncludeShareUrl: b }))); g = c.getLevel(); return e = "number" === typeof g && -1 !== g ? d.addQueryParamToUrl(e, "level", c.getLevel(), !0) : d.addQueryParamToUrl(e, "scale", c.getScale(), !0)
                                                }, getXyContent: function (c) {
                                                        var g = "\x3cdiv class\x3d'marker-feature-action-popup'\x3e"; c.longitude && c.latitude ? g += "\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e" +
                                                                window.jimuNls.common.longitude + "\x3c/span\x3e\x3cspan class\x3d'val'\x3e" + k.localizeNumber(parseFloat(c.longitude).toFixed(4)) + "\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3e" + window.jimuNls.common.latitude + "\x3c/span\x3e\x3cspan class\x3d'val'\x3e" + k.localizeNumber(parseFloat(c.latitude).toFixed(4)) + "\x3c/span\x3e\x3c/div\x3e" : c.x && c.y && (g += "\x3cdiv class\x3d'item clearFix'\x3e\x3cspan class\x3d'sub-title'\x3ex\x3c/span\x3e\x3cspan class\x3d'val'\x3e" +
                                                                        k.localizeNumber(parseFloat(c.x).toFixed(4)) + "\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d'item'\x3e\x3cspan class\x3d'sub-title'\x3ey\x3c/span\x3e\x3cspan class\x3d'val'\x3e" + k.localizeNumber(parseFloat(c.y).toFixed(4)) + "\x3c/span\x3e\x3c/div\x3e"); return g + "\x3c/div\x3e"
                                                }, _isUserOwnTheApp: function (c) { return c && c.username && c.username === window.appInfo.appOwner ? !0 : !1 }, getItemByUserAndItemId: function (c, g, b, e) {
                                                        var a = new m; e = w.getStandardPortalUrl(e); e = e + "/sharing/rest/content/users/" + (g ? g.username ? g.username :
                                                                g.email : b.email); if (v.isDefined(c.folderId) && "/" !== c.folderId || v.isDefined(c.ownerFolder) && "/" !== c.ownerFolder) e += "/" + (c.folderId || c.ownerFolder); e += "/items/" + c.id; q({ url: e, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }).then(E.hitch(this, function (f) { a.resolve(f) }), E.hitch(this, function (f) { console.error(f); a.reject(f) })); return a
                                                }, _getProfile: function (c, g) {
                                                        var b = new m; c = w.getUserUrl(g, c.owner); q({ url: c, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }).then(E.hitch(this,
                                                                function (e) { b.resolve(e) }), E.hitch(this, function (e) { console.error(e); b.reject(e) })); return b
                                                }, _unshareItemById: function (c, g, b) { var e = new m; b = w.getStandardPortalUrl(b); b += "/sharing/rest/content/items/" + g + "/unshare"; g = { f: "json" }; g = E.mixin(g, c); q({ url: b, handleAs: "json", content: g, callbackParamName: "callback" }, { usePost: !0 }).then(E.hitch(this, function (a) { e.resolve(a) }), E.hitch(this, function (a) { console.error(a); e.reject(a) })); return e }, canSharePublic: function (c) {
                                                        return !c.selfUrl || !0 !== c.canSharePublic &&
                                                                !1 !== c.canSharePublic ? !0 : c.canSharePublic
                                                }, unshareItemsByUser: function (c, g, b) { var e = new m; b = w.getStandardPortalUrl(b); b += "/sharing/rest/content/users/" + c + "/unshareItems"; c = { f: "json" }; c = E.mixin(c, g); q({ url: b, handleAs: "json", content: c, callbackParamName: "callback" }, { usePost: !0 }).then(E.hitch(this, function (a) { e.resolve(a) }), E.hitch(this, function (a) { console.error(a); e.reject(a) })); return e }, unshareItems: function (c, g, b) {
                                                        var e = new m; b = w.getStandardPortalUrl(b); b += "/sharing/rest/content/users/" + (g.owner ||
                                                                c.email) + "/unshareItems"; c = { f: "json" }; c = E.mixin(c, g); q({ url: b, handleAs: "json", content: c, callbackParamName: "callback" }, { usePost: !0 }).then(E.hitch(this, function (a) { e.resolve(a) }), E.hitch(this, function (a) { console.error(a); e.reject(a) })); return e
                                                }, shareItemsByUser: function (c, g, b) {
                                                        var e = new m; b = w.getStandardPortalUrl(b); b += "/sharing/rest/content/users/" + c + "/shareItems"; c = { f: "json" }; c = E.mixin(c, g); q({ url: b, handleAs: "json", content: c, callbackParamName: "callback" }, { usePost: !0 }).then(E.hitch(this, function (a) { e.resolve(a) }),
                                                                E.hitch(this, function (a) { console.error(a); e.reject(a) })); return e
                                                }, shareItems: function (c, g, b) { var e = new m; b = w.getStandardPortalUrl(b); b += "/sharing/rest/content/users/" + (g.owner || c.email) + "/shareItems"; c = { f: "json" }; c = E.mixin(c, g); q({ url: b, handleAs: "json", content: c, callbackParamName: "callback" }, { usePost: !0 }).then(E.hitch(this, function (a) { e.resolve(a) }), E.hitch(this, function (a) { console.error(a); e.reject(a) })); return e }, getItemsGroups: function (c, g) {
                                                        var b = new m; g = w.getStandardPortalUrl(g); g += "/sharing/rest/content/items/" +
                                                                c.id + "/groups"; q({ url: g, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }, { usePost: !0 }).then(E.hitch(this, function (e) { b.resolve(e) }), E.hitch(this, function (e) { console.error(e); b.reject(e) })); return b
                                                }, isSharedToPublic: function (c) { return window.isXT ? !1 : null === c ? !0 : "undefined" !== typeof c && "undefined" !== typeof c.item && "undefined" !== typeof c.item.access && "public" === c.item.access ? !0 : !1 }, isShowSocialMediaLinks: function (c) {
                                                        return window.isXT ? !0 : null === c ? !0 : "undefined" !== typeof c && "undefined" !==
                                                                typeof c.item && "undefined" !== typeof c.item.access && "private" === c.item.access ? !1 : !0
                                                }, getItemShareInfo: function (c) {
                                                        var g = new m, b = ""; if (window.isXT) return g.resolve(null); b = k.urlToObject(k.getAppHref()).query || {}; b = b.id || b.appid; if ("undefined" === typeof b || "" === b) return g.resolve(null); r.getPortal(c).getItemById(b).then(E.hitch(this, function (e) { var a = {}; a.item = e; a.item && "undefined" === typeof a.item.sharing && a.item.access && (a.item.sharing = { access: a.item.access }); g.resolve(a) }), E.hitch(this, function (e) {
                                                                console.log(e);
                                                                g.resolve(null)
                                                        })); return g
                                                }, getShareInfo: function (c) {
                                                        var g = r.getPortal(c), b = new m, e = ""; if (window.isXT) return b.resolve(null); e = k.urlToObject(k.getAppHref()).query || {}; e = e.id || e.appid; if ("undefined" === typeof e || "" === e) return b.resolve(null); A({ getUser: g.getUser(), loadSelfInfo: g.loadSelfInfo(), getItem: g.getItemById(e) }).then(E.hitch(this, function (a) {
                                                                var f = {}; f.item = a.getItem; f.item && f.item.ownerFolder && f.item.ownerFolder.length && "/" !== f.item.ownerFolder && (f.item.folderId = f.item.ownerFolder); "undefined" ===
                                                                        typeof f.item.sharing && f.item.access && (f.item.sharing = { access: f.item.access }); f.user = a.getUser; d._setUserRole(a.loadSelfInfo, f); f.currentUser = f.user; f.isAdmin = !1; f.userRole && (f.userRole.isAdmin() || f.userRole.isCustom() && f.userRole.canUpdateOrgItems()) ? (f.isAdmin = !0, f.item.owner !== f.currentUser.name ? d._getProfile(f.item, c).then(E.hitch(this, function (h) { f.itemUser = h; f.itemUser.orgId !== f.currentUser.orgId && (f.isAdmin = !1); b.resolve(f) })) : (f.itemUser = f.currentUser, b.resolve(f))) : (f.currentUser && (f.itemUser =
                                                                                f.currentUser), b.resolve(f))
                                                        }), E.hitch(this, function (a) { console.log(a); b.resolve(null) })); return b
                                                }, _setUserRole: function (c, g) {
                                                        g.userPortalUrl = c.urlKey ? c.urlKey + "." + c.customBaseUrl : this.portalUrl; !c || c.code || c.message || (g.organization = c); if (c && c.user) g.userRole = new l({ id: c.user.roleId ? c.user.roleId : c.user.role, role: c.user.role }), g._isCustomRole = g.userRole.isCustom(), g._roleCanShareToGroup = g._isCustomRole && g.userRole.canShareItemToGroup(), g._roleCanShareToOrg = g._isCustomRole && g.userRole.canShareItemToOrg(),
                                                                g._roleCanSharePublic = g._isCustomRole && g.userRole.canShareItemToPublic(), g._roleCanShare = g._roleCanShareToGroup || g._roleCanShareToOrg || g._roleCanShareToPublic, g._roleCanUpdateItems = g._isCustomRole && g.userRole.canUpdateOrgItems(), g._roleCanShareOthersItemsToGroup = g._isCustomRole && g.userRole.canShareOthersItemsToGroup(), g._roleCanShareOthersItemsToOrg = g._isCustomRole && g.userRole.canShareOthersItemsToOrg(), g._roleCanShareOthersItemsToPublic = g._isCustomRole && g.userRole.canShareOthersItemsToPublic(), g._roleCanShareOthersItems =
                                                                g._isCustomRole && (g.userRole.canShareOthersItemsToGroup() || g.userRole.canShareOthersItemsToOrg() || g._roleCanShareOthersItemsToPublic), g._orgUserCanSharePublicOrOverride = g.organization && (!0 === g.organization.canSharePublic && (!g._isCustomRole || g._roleCanSharePublic || g._roleCanShareOthersItemsToPublic) || g.userRole.isAdmin()); else return !1
                                                }, getItemById: function (c, g) {
                                                        var b = new m; g = w.getStandardPortalUrl(g); g += "/sharing/rest/content/items/" + c.id; q({ url: g, handleAs: "json", content: { f: "json" }, callbackParamName: "callback" }).then(E.hitch(this,
                                                                function (e) { b.resolve(e) }), E.hitch(this, function (e) { console.error(e); b.reject(e) })); return b
                                                }, disableWebMapPopup: function (c) { c && c.setInfoWindowOnClick && c.setInfoWindowOnClick(!1) }, enableWebMapPopup: function (c) { c && c.setInfoWindowOnClick && c.setInfoWindowOnClick(!0) }
                                        }; return d
                                })
                }, "jimu/PopupManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Deferred dojo/topic dojo/on dojo/query ./FeatureActionManager ./utils ./dijit/FeatureActionPopupMenu ./RelatedRecordsPopupProjector ./LayerInfos/LayerInfos".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                        var g = null, b = E(null, {
                                                mapManager: null, popupUnion: null, _relatedRecordsPopupProjector: null, constructor: function (e) {
                                                        q.mixin(this, e); this.popupMenu = n.getInstance(); this.isInited = !1; this.featureActionManager = l.getInstance(); m.subscribe("mapLoaded", q.hitch(this, this.onMapLoadedOrChanged)); m.subscribe("mapChanged", q.hitch(this, this.onMapLoadedOrChanged)); m.subscribe("appConfigChanged", q.hitch(this, this._onAppConfigChanged)); m.subscribe("widgetsActionsRegistered", q.hitch(this,
                                                                this._onWidgetsActionsRegistered))
                                                }, init: function () { this.popupUnion = this.mapManager.getMapInfoWindow(); this.popupUnion.bigScreen && this.popupUnion.mobile && this.popupUnion.bigScreen.domNode && this.popupUnion.mobile.domNode && !this.isInited && (this._createPopupMenuButton(), this._bindSelectionChangeEvent(), this.isInited = !0) }, _createPopupMenuButton: function () {
                                                        this.popupMenuButtonDesktop && A.destroy(this.popupMenuButtonDesktop); this.popupMenuButtonMobile && A.destroy(this.popupMenuButtonMobile); this.popupMenuButtonDesktop =
                                                                A.create("span", { "class": "popup-menu-button" }, r(".actionList", this.popupUnion.bigScreen.domNode)[0]); var e = r("div.esriMobileInfoView.esriMobilePopupInfoView .esriMobileInfoViewItem").parent()[0]; e = A.create("div", { "class": "esriMobileInfoViewItem" }, e); this.popupMenuButtonMobile = A.create("span", { "class": "popup-menu-button" }, e); v(this.popupMenuButtonMobile, "click", q.hitch(this, this._onPopupMenuButtonClick)); v(this.popupMenuButtonDesktop, "click", q.hitch(this, this._onPopupMenuButtonClick))
                                                }, _onPopupMenuButtonClick: function (e) {
                                                        e =
                                                        A.position(e.target); this.menuActionsOfSelectedFeature && this.popupMenu.setActions(this.menuActionsOfSelectedFeature); this.popupMenu.show(e)
                                                }, _bindSelectionChangeEvent: function () { v(this.popupUnion.bigScreen, "selection-change", q.hitch(this, this._onSelectionChange)); v(this.popupUnion.mobile, "selection-change", q.hitch(this, this._onSelectionChange)) }, _onSelectionChange: function (e) {
                                                        (this.selectedFeature = e.target.getSelectedFeature()) ? (this.initPopupMenu([this.selectedFeature]), e = this.selectedFeature.getLayer(),
                                                                (this.selectedFeature.infoTemplate || e && e.infoTemplate) && this._createRelatedRecordsPopupProjector(this.selectedFeature)) : this._disablePopupMenu()
                                                }, _disablePopupMenu: function () { A.addClass(this.popupMenuButtonDesktop, "disabled"); A.addClass(this.popupMenuButtonMobile, "disabled") }, _enablePopupMenu: function () { A.removeClass(this.popupMenuButtonDesktop, "disabled"); A.removeClass(this.popupMenuButtonMobile, "disabled") }, convertFeatures: function (e) {
                                                        var a = new w, f = c.getInstanceSync(), h = e && e[0] && e[0].getLayer();
                                                        (f = f.getLayerInfoById(h && h.id)) ? a = f.getMSShipFeatures(e) : a.resolve(null); return a
                                                }, initPopupMenu: function (e) {
                                                        e ? this.convertFeatures(e).then(q.hitch(this, function (a) {
                                                                var f = k.toFeatureSet(a || e); this.featureActionManager.getSupportedActions(f).then(q.hitch(this, function (h) {
                                                                        var p = "ZoomTo ShowPopup Flash ExportToCSV ExportToFeatureCollection ExportToGeoJSON ShowRelatedRecords SaveToMyContent CreateLayer".split(" "); h = h.filter(q.hitch(this, function (B) { return 0 > p.indexOf(B.name) })); 0 === h.length ? this._disablePopupMenu() :
                                                                                this._enablePopupMenu(); this.menuActionsOfSelectedFeature = h = h.map(q.hitch(this, function (B) { B.data = f; return B })); this.popupMenu.setActions(h)
                                                                }))
                                                        })) : (this._disablePopupMenu(), this.popupMenu.setActions([]))
                                                }, onMapLoadedOrChanged: function () { this.isInited = !1; this.init() }, _onAppConfigChanged: function () {
                                                        this.popupUnion && (this.popupUnion.bigScreen && this.popupUnion.bigScreen.hide && (this.popupUnion.bigScreen.hide(), this.popupMenu.hide()), this.popupUnion.mobile && this.popupUnion.mobile.hide && (this.popupUnion.mobile.hide(),
                                                                this.popupMenu.hide()))
                                                }, _onWidgetsActionsRegistered: function () { this.init() }, _createRelatedRecordsPopupProjector: function (e) { try { this._relatedRecordsPopupProjector && this._relatedRecordsPopupProjector.domNode && (this._relatedRecordsPopupProjector.destroy(), this._relatedRecordsPopupProjector = null), this._relatedRecordsPopupProjector = new d({ originalFeature: e, popup: this.mapManager.map.infoWindow, popupManager: this }) } catch (a) { console.warn(a.message) } }
                                        }); b.getInstance = function (e) {
                                                null === g && (g = new b({ mapManager: e }));
                                                return g
                                        }; return b
                                })
                }, "jimu/FeatureActionManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dojo/Deferred dojo/promise/all ./featureActions/main ./utils".split(" "), function (E, q, A, w, m, v, r, l) {
                                var k = null, n = E(null, {
                                        constructor: function () {
                                                this._actions = []; window.isBuilder ? (w.subscribe("app/mapLoaded", q.hitch(this, this._onMapLoaded)), w.subscribe("app/mapChanged", q.hitch(this, this._onMapChanged))) : (w.subscribe("mapLoaded", q.hitch(this, this._onMapLoaded)), w.subscribe("mapChanged",
                                                        q.hitch(this, this._onMapChanged))); window.isBuilder ? (w.subscribe("app/appConfigLoaded", q.hitch(this, this._onAppConfigLoaded)), w.subscribe("app/appConfigChanged", q.hitch(this, this._onAppConfigChanged))) : (w.subscribe("appConfigLoaded", q.hitch(this, this._onAppConfigLoaded)), w.subscribe("appConfigChanged", q.hitch(this, this._onAppConfigChanged))); this._registerFrameworkActions()
                                        }, getAllActions: function () { return this._actions }, getSupportedActions: function (d) {
                                                d = this._getFeatureSet(d); var c = []; A.forEach(this._actions,
                                                        function (g) { var b = this.testActionSupportFeature(g, d); b.action = g; c.push(b) }, this); return v(c).then(q.hitch(this, function (g) { return g.map(q.hitch(this, function (b, e) { return { result: b, action: this._actions[e] } })).filter(function (b) { return b.result }).map(function (b) { return b.action }) }))
                                        }, testActionSupportFeature: function (d, c) {
                                                c = this._getFeatureSet(c); var g; c.features && 0 < c.features.length && (g = c.features[0].getLayer()); d = d.isFeatureSupported(c, g); var b = new m; d && "function" === typeof d.then ? d.then(function (e) { b.resolve(e) },
                                                        function (e) { console.error(e); b.resolve(!1) }) : b.resolve(d); return b
                                        }, registerAction: function (d) {
                                                var c = new m; require([d.uri], q.hitch(this, function (g) { var b = new g({ map: this.map, appConfig: this.appConfig, label: d.label, name: d.name, widgetId: d.widgetId }); A.some(this._actions, function (e) { return b.name === e.name && b.widgetId === e.widgetId }) ? (console.warn("Feature/FeatureSet action has been registered.", b.name), c.reject("Feature/FeatureSet action has been registered.", b.name)) : (this._actions.push(b), c.resolve(b)) }));
                                                return c
                                        }, removeActionsByWidgetId: function (d) { this._actions = A.filter(this._actions, function (c) { return c.widgetId !== d }, this) }, getActionsByWidgetId: function (d) { return A.filter(this._actions, function (c) { return c.widgetId === d }, this) }, getActionsByActionName: function (d) { return A.filter(this._actions, function (c) { return c.name === d }, this) }, registerWidgetFeatureActions: function (d) {
                                                var c = new m; if (!d.featureActions || !d.uri) return c.resolve(), c; var g = []; A.forEach(d.featureActions, function (b) {
                                                        var e = d.manifest["i18nLabels_featureAction_" +
                                                                b.name]; g.push(this.registerAction({ uri: d.isRemote ? d.amdFolder + b.uri + ".js" : d.amdFolder + b.uri, widgetId: d.id, name: b.name, label: e[window.dojoConfig.locale] || e[window.dojoConfig.locale.split("-")[0]] || e.defaultLabel }))
                                                }, this); return v(g)
                                        }, registerAllWidgetFeatureActions: function (d) { var c = []; d.visitElement(q.hitch(this, function (g) { g.uri && g.visible && c.push(this.registerWidgetFeatureActions(g)) })); return v(c).then(function () { w.publish("widgetsActionsRegistered") }) }, _reRegisterWidgetActions: function (d) {
                                                var c =
                                                        []; A.forEach(this.getAllActions(), function (g) { var b = d.getConfigElementById(g.widgetId); "framework" === g.widgetId || b && b.uri && !1 !== b.visible || this.removeActionsByWidgetId(g.widgetId) }, this); d.visitElement(q.hitch(this, function (g) { g.uri && g.visible && 0 === this.getActionsByWidgetId(g.id).length && c.push(this.registerWidgetFeatureActions(g)) })); 0 < c.length && v(c).then(function () { w.publish("widgetsActionsRegistered") })
                                        }, _registerFrameworkActions: function () {
                                                A.forEach(r, function (d) {
                                                        this.registerAction({
                                                                uri: d.uri,
                                                                widgetId: "framework", label: window.jimuNls.featureActions[d.name], name: d.name
                                                        })
                                                }, this)
                                        }, _getFeatureSet: function (d) { return "[object Object]" === Object.prototype.toString.call(d) ? d.features ? d : l.toFeatureSet([d]) : l.toFeatureSet(d) }, _onAppConfigLoaded: function (d) { this.appConfig = d = q.clone(d); this._setActionsAppConfig(d); this.registerAllWidgetFeatureActions(this.appConfig) }, _onAppConfigChanged: function (d) { this.appConfig = d = q.clone(d); this._reRegisterWidgetActions(this.appConfig); this._setActionsAppConfig(d) },
                                        _onMapLoaded: function (d) { this.map = d; this._setActionsMap(d) }, _onMapChanged: function (d) { this.map = d; this._setActionsMap(d) }, _setActionsMap: function (d) { A.forEach(this._actions, function (c) { c.setMap(d) }, this) }, _setActionsAppConfig: function (d) { A.forEach(this._actions, function (c) { c.setAppConfig(d) }, this) }
                                }); n.getInstance = function () { null === k && (k = new n, window._featureActionManager = k); return k }; return n
                        })
                }, "jimu/featureActions/main": function () {
                        define("./ZoomTo ./PanTo ./Flash ./ShowPopup ./ExportToCSV ./ExportToFeatureCollection ./ExportToGeoJSON ./ShowStatistics ./CreateLayer ./AddMarker ./RemoveMarker ./SaveToMyContent".split(" "),
                                function () {
                                        return [{ name: "ZoomTo", uri: "jimu/featureActions/ZoomTo" }, { name: "PanTo", uri: "jimu/featureActions/PanTo" }, { name: "Flash", uri: "jimu/featureActions/Flash" }, { name: "ShowPopup", uri: "jimu/featureActions/ShowPopup" }, { name: "ExportToCSV", uri: "jimu/featureActions/ExportToCSV" }, { name: "ExportToFeatureCollection", uri: "jimu/featureActions/ExportToFeatureCollection" }, { name: "ExportToGeoJSON", uri: "jimu/featureActions/ExportToGeoJSON" }, { name: "ShowStatistics", uri: "jimu/featureActions/ShowStatistics" }, {
                                                name: "CreateLayer",
                                                uri: "jimu/featureActions/CreateLayer"
                                        }, { name: "AddMarker", uri: "jimu/featureActions/AddMarker" }, { name: "RemoveMarker", uri: "jimu/featureActions/RemoveMarker" }, { name: "SaveToMyContent", uri: "jimu/featureActions/SaveToMyContent" }]
                                })
                }, "jimu/featureActions/ZoomTo": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "jimu/utils"], function (E, q, A) {
                                return E(q, {
                                        name: "ZoomTo", iconClass: "icon-zoomto", isFeatureSupported: function (w) { return 0 < w.features.length && w.features[0].geometry }, onExecute: function (w) {
                                                A.featureAction.zoomTo(this.map,
                                                        w.features)
                                        }
                                })
                        })
                }, "jimu/BaseFeatureAction": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang"], function (E, q) {
                                return E(null, {
                                        name: void 0, label: void 0, iconFormat: "svg", iconClass: "", map: null, appConfig: {}, widgetId: null, constructor: function (A) { q.mixin(this, A) }, isFeatureSupported: function (A, w) { return !0 }, onExecute: function (A, w) { }, setMap: function (A) { this.map = A }, setAppConfig: function (A) { this.appConfig = A }, getIcon: function (A) {
                                                return "framework" === this.widgetId ? require.toUrl("jimu") + "/images/feature_actions/" +
                                                        this.name + "_" + A + "." + this.iconFormat : this.appConfig.getConfigElementById(this.widgetId).folderUrl + "images/" + this.name + "_" + A + "." + this.iconFormat
                                        }
                                })
                        })
                }, "jimu/featureActions/PanTo": function () { define(["dojo/_base/declare", "../BaseFeatureAction", "jimu/utils"], function (E, q, A) { return E(q, { name: "PanTo", iconClass: "icon-panto", isFeatureSupported: function (w) { return 0 < w.features.length && w.geometryType }, onExecute: function (w) { A.featureAction.panTo(this.map, w.features) } }) }) }, "jimu/featureActions/Flash": function () {
                        define(["dojo/_base/declare",
                                "dojo/_base/lang", "../BaseFeatureAction", "jimu/utils"], function (E, q, A, w) { return E([A], { name: "Flash", iconClass: "icon-flash", isFeatureSupported: function (m, v) { if (1 > m.features.length || !v) return !1; m = m.features[0]; var r = q.getObject("renderer.symbol", !1, v); return m && m.geometry && (m.symbol || r) && this.map.getLayer(v.id) }, onExecute: function (m, v) { w.featureAction.flash(m && m.features, v) } }) })
                }, "jimu/featureActions/ShowPopup": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "jimu/utils"], function (E,
                                q, A) { return E([q], { name: "ShowPopup", iconClass: "icon-show-popup", isFeatureSupported: function (w, m) { return w && w.features && 1 === w.features.length && m && m.infoTemplate }, onExecute: function (w) { A.featureAction.showPopup(this.map, w.features) } }) })
                }, "jimu/featureActions/ExportToCSV": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "../exportUtils"], function (E, q, A) {
                                return E(q, {
                                        name: "ExportToCSV", iconClass: "icon-export", isFeatureSupported: function (w) { return 0 < w.features.length }, onExecute: function (w) {
                                                w =
                                                A.createDataSource({ type: A.TYPE_FEATURESET, filename: "features", data: w }); w.setFormat(A.FORMAT_CSV); w.download()
                                        }
                                })
                        })
                }, "jimu/exportUtils": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/json dojo/Deferred esri/tasks/query esri/tasks/QueryTask esri/tasks/FeatureSet esri/graphic esri/SpatialReference esri/tasks/ProjectParameters esri/config esri/geometry/webMercatorUtils jimu/LayerInfos/LayerInfos ./utils ./CSVUtils ./GeojsonConverters libs/polyfills/FileSaver".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                        function h(t, u) { 10 > dojo.isIE ? saveTextAs(u, t, "utf-8") : (u = new Blob([u], { type: "text/plain;charset\x3dutf-8" }), saveAs(u, t, !0)) } var p = { createDataSource: function (t) { return new B(t) }, TYPE_TABLE: "table", TYPE_FEATURESET: "FeatureSet", FORMAT_CSV: "CSV", FORMAT_FEATURESET: "FeatureSet", FORMAT_GEOJSON: "GeoJSON" }, B = E(null, {
                                                filename: void 0, format: void 0, nls: void 0, data: null, url: null, constructor: function (t) {
                                                        this.nls = window.jimuNls.exportTo; this.data = t.data; this.url = t.url;
                                                        this.filename = t.filename
                                                }, setFormat: function (t) { this.format = t }, download: function () { if (this.format === p.FORMAT_CSV) return this.exportCSV(); if (this.format === p.FORMAT_FEATURESET) return this.exportFeatureCollection(); if (this.format === p.FORMAT_GEOJSON) return this.exportGeoJSON() }, getFeatureSet: function () {
                                                        var t = new m; if (this.data) t.resolve(this.data); else if (this.url) {
                                                                var u = new v; u.returnGeometry = !0; u.outFields = ["*"]; this.queryTask = new r(this.url); this.queryTask.execute(u, q.hitch(this, function (z) { t.resolve(z) }),
                                                                        q.hitch(this, function () { t.resolve(null) }))
                                                        } else t.resolve(null); return t
                                                }, findPopupInfo: function (t) { if (!t || !t.features || 0 === t.features.length) return null; t = t.features[0]; if (t._layer && (t = t._layer.id, t = b.getInstanceSync().getLayerInfoById(t))) { var u = t.getPopupInfo(); u || (u = t.layerObject.infoTemplate && t.layerObject.infoTemplate.info); return u } return null }, findLayerDefinition: function (t) {
                                                        if (!t || !t.features || 0 === t.features.length) return null; var u = t.features[0]; if (u._layer) return {
                                                                drawingInfo: u._layer.drawingInfo,
                                                                geometryType: t.geometryType, fields: u._layer.fields, objectIdField: u._layer.objectIdField, typeIdField: u._layer.typeIdField, types: u._layer.types
                                                        }; var z = []; u = u.attributes; for (var x in u) u.hasOwnProperty(x) && z.push({ name: x }); return { geometryType: t.geometryType, fields: z }
                                                }, _getOutFields: function (t, u) { return q.clone(t.fields && 0 < t.fields.length ? t.fields : u.fields) }, formatAttributes: function (t) {
                                                        var u = new m, z = this.findPopupInfo(t), x = this.findLayerDefinition(t); if (z && x) {
                                                                var y = A.map(t.features, function (D) { return D.attributes });
                                                                a._formattedData(t.features[0]._layer, { data: y, outFields: this._getOutFields(t, x) }, { formatNumber: !0, formatDate: !0, formatCodedValue: !0, popupInfo: z, richText: {} }).then(q.hitch(this, function (D) { var H = D.datas; D = new l; var I = []; A.forEach(t.features, function (N, T) { N = new k(N.toJson()); N.attributes = H[T]; I.push(N) }); D.features = I; D.geometryType = t.geometryType; D.fieldAliases = t.fieldAliases; D.fields = t.fields; u.resolve(D) }))
                                                        } else u.resolve(t); return u
                                                }, exportCSV: function () {
                                                        return this.getFeatureSet().then(q.hitch(this,
                                                                function (t) { var u = this.findPopupInfo(t), z = this.findLayerDefinition(t), x = t.features; if (z && z.fields) { var y = this._getOutFields(t, z); this._addXYAttribute(y, "x"); this._addXYAttribute(y, "y"); z.fields = y; x = []; A.forEach(t.features, q.hitch(this, function (D) { D = new k(D.toJson()); D.attributes = this._getAttrsWithXY(D); x.push(D) })) } else for (y in z.fields = [], x[0].attributes) z.fields.push({ name: y, alias: y }); return a.exportCSVByGraphics(this.filename, z, x, { formatNumber: !0, formatDate: !0, formatCodedValue: !0, popupInfo: u }) }))
                                                },
                                                exportGeoJSON: function () { return this.getFeatureSet().then(q.hitch(this, function (t) { return this.formatAttributes(t) })).then(q.hitch(this, function (t) { return this._projectToWGS84(t) })).then(q.hitch(this, function (t) { var u = ""; if (t && t.features && 0 < t.features.length) { var z = { type: "FeatureCollection", features: [] }; A.forEach(t.features, function (x) { z.features.push(f.arcgisToGeoJSON(x)) }); u = w.stringify(z) } return u })).then(q.hitch(this, function (t) { h(this.filename + ".geojson", t) })) }, exportFeatureCollection: function () {
                                                        return this.getFeatureSet().then(q.hitch(this,
                                                                function (t) { return this.formatAttributes(t) })).then(q.hitch(this, function (t) { var u = ""; t && (t = t.toJson()) && (u = w.stringify(t)); return u })).then(q.hitch(this, function (t) { h(this.filename + ".json", t) }))
                                                }, exportToPortal: function (t, u) { }, _projectToWGS84: function (t) {
                                                        var u = new m, z = this._getSpatialReference(t); if (z) if (4326 === parseInt(z.wkid, 10)) u.resolve(t); else if (z.isWebMercator()) {
                                                                z = new l; var x = []; A.forEach(t.features, function (D) { var H = new k(D.toJson()); H.geometry = g.webMercatorToGeographic(D.geometry); x.push(H) });
                                                                z.features = x; z.geometryType = t.geometryType; z.fieldAliases = t.fieldAliases; z.fields = t.fields; u.resolve(z)
                                                        } else {
                                                                z = new d; z.geometries = A.map(t.features, function (D) { return D.geometry }); z.outSR = new n(4326); var y = c && c.defaults && c.defaults.geometryService; y && "esri.tasks.GeometryService" === y.declaredClass || (y = e.getArcGISDefaultGeometryService()); y.project(z).then(function (D) {
                                                                        var H = new l, I = []; A.forEach(t.features, function (N, T) { N = new k(N.toJson()); N.geometry = D[T]; I.push(N) }); H.features = I; H.geometryType = t.geometryType;
                                                                        H.fieldAliases = t.fieldAliases; H.fields = t.fields; u.resolve(H)
                                                                }, function (D) { console.error(D); u.resolve([]) })
                                                        } else u.resolve([]); return u
                                                }, _getSpatialReference: function (t) { if (t.spatialReference) return t.spatialReference; var u; A.some(t.features, function (z) { if (z.geometry && z.geometry.spatialReference) return u = z.geometry.spatialReference, !0 }); return u }, _getAttrsWithXY: function (t) { var u = t.geometry; return u && "point" === u.type ? (t = q.clone(t.attributes), "x" in t ? t._x = u.x : t.x = u.x, "y" in t ? t._y = u.y : t.y = u.y, t) : t.attributes },
                                                _addXYAttribute: function (t, u) { var z = A.some(t, function (x) { return x.name === u }) ? "_" + u : u; t.push({ name: z, alias: z, format: { digitSeparator: !1, places: 6 }, show: !0, type: "esriFieldTypeDouble" }); return t }
                                        }); return p
                                })
                }, "jimu/CSVUtils": function () {
                        define("exports dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/kernel dojo/has dojo/number dojo/Deferred jimu/utils esri/lang esri/tasks/QueryTask esri/tasks/query esri/graphic jimu/ArcadeUtils".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                function e(a) {
                                        var f =
                                                q.clone(a.attributes); (a = a.geometry) && "point" === a.type && ("x" in f ? f._x = a.x : f.x = a.x, "y" in f ? f._y = a.y : f.y = a.y); return f
                                } E.exportCSV = function (a, f, h) { return E._createCSVStr(f, h).then(function (p) { return E._download(a + ".csv", p) }) }; E.exportCSVFromFeatureLayer = function (a, f, h) {
                                        h = h || {}; return E._getExportData(f, {
                                                datas: h.datas, objectIds: h.objectIds, fromClient: h.fromClient, withGeometry: h.withGeometry, outFields: h.outFields, filterExpression: h.filterExpression, outSpatialReference: h.outSpatialReference, arcadeExpressions: h.arcadeExpressions,
                                                geometry: h.geometry, orderByFields: h.orderByFields, start: h.start, num: h.num
                                        }).then(function (p) { return E._formattedData(f, p, { formatNumber: h.formatNumber, formatDate: h.formatDate, formatCodedValue: h.formatCodedValue, richText: { clearFormat: h.richTextFieldsToClear && !!h.richTextFieldsToClear.length, fieldsToClear: h.richTextFieldsToClear || [] }, popupInfo: h.popupInfo }).then(function (B) { return E.exportCSV(a, B.datas, B.columns) }) })
                                }; E.exportCSVByAttributes = function (a, f, h, p) {
                                        p = q.mixin({}, p); p.datas = h; return E.exportCSVFromFeatureLayer(a,
                                                f, p)
                                }; E.exportCSVByGraphics = function (a, f, h, p) { h = A.map(h, function (B) { return B.attributes }); return E.exportCSVByAttributes(a, f, h, p) }; E._createCSVStr = function (a, f) {
                                        var h = new l, p = "", B = 0, t = 0, u = "", z = "", x = "," === r.format(1.1, { locale: m.locale }).substring(1, 2) ? ";" : ",", y = ";" === x; try {
                                                f = A.map(f, function (N) { return "string" === typeof N ? { name: N } : N }); A.forEach(f, function (N) { N = N.alias || N.name; -1 < N.toString().indexOf(x) && (N = '"' + N + '"'); p = p + u + N; u = x }); p += "\r\n"; B = a.length; t = f.length; for (var D = 0; D < B; D++) {
                                                        u = ""; for (var H = 0; H <
                                                                t; H++) { (z = a[D][f[H].name]) || "number" === typeof z || (z = ""); if ("string" === typeof z) { var I = !1; (I = ";" === x ? /[";\r\n]/g.test(z) : /[",\r\n]/g.test(z)) && (z = '"' + z.replace(/(")/g, '""') + '"') } else y && "number" === typeof z && (z = '"' + z.toLocaleString(m.locale) + '"'); p = p + u + z; u = x } p += "\r\n"
                                                } h.resolve(p)
                                        } catch (N) { console.error(N), h.resolve("") } return h
                                }; E._isIE11 = function () { return 11 === k.has("ie") }; E._isEdge = function () { return k.has("edge") }; E._getDownloadUrl = function (a) {
                                        return window.Blob && window.URL && window.URL.createObjectURL ?
                                                (a = new Blob(["\ufeff" + a], { type: "text/csv" }), URL.createObjectURL(a)) : "data:attachment/csv;charset\x3dutf-8,\ufeff" + encodeURIComponent(a)
                                }; E._download = function (a, f) {
                                        var h = new l; try {
                                                if (v("ie") && 10 > v("ie")) { var p = window.top.open("about:blank", "_blank"); p.document.write("sep\x3d,\r\n" + f); p.document.close(); p.document.execCommand("SaveAs", !0, a); p.close() } else if (10 === v("ie") || E._isIE11() || E._isEdge()) { var B = new Blob(["\ufeff" + f], { type: "text/csv" }); navigator.msSaveBlob(B, a) } else {
                                                        var t = w.create("a", {
                                                                href: E._getDownloadUrl(f),
                                                                target: "_blank", download: a
                                                        }, document.body); if (v("safari")) { var u = document.createEvent("MouseEvents"); u.initEvent("click", !0, !0); t.dispatchEvent(u) } else t.click(); w.destroy(t)
                                                } h.resolve()
                                        } catch (z) { h.reject(z) } return h
                                }; E._getExportData = function (a, f) {
                                        var h = new l, p = null, B = [], t = f.datas, u = f.withGeometry, z = !!f.arcadeExpressions; p = f.outFields; p && p.length || (p = a.fields); p = q.clone(p); if (u && !(t && 0 < t.length)) {
                                                z ? (B = A.filter(a.fields, function (y) { return -1 === y.name.indexOf("expression/") }), B = q.clone(B)) : B = q.clone(p);
                                                var x = ""; x = -1 !== p.indexOf("x") ? "_x" : "x"; p.push({ name: x, alias: x, format: { digitSeparator: !1, places: 6 }, show: !0, type: "esriFieldTypeDouble" }); x = -1 !== p.indexOf("y") ? "_y" : "y"; p.push({ name: x, alias: x, format: { digitSeparator: !1, places: 6 }, show: !0, type: "esriFieldTypeDouble" })
                                        } t && 0 < t.length ? (z && (t = E._getAttrsWithExpressionsBatch(t, f.arcadeExpressions)), h.resolve({ data: t || [], outFields: p })) : f.fromClient ? (t = A.map(a.graphics, function (y) {
                                                y = u ? e(y) : q.clone(y); return y = z ? E._getAttrsWithExpressions(y, f.arcadeExpressions) :
                                                        y
                                        }), h.resolve({ data: t || [], outFields: p })) : E._getExportDataFromServer(a, B, f).then(function (y) { z && (y = E._getAttrsWithExpressionsBatch(y, f.arcadeExpressions)); h.resolve({ data: y || [], outFields: p }) }); return h
                                }; E._getExportDataFromServer = function (a, f, h) {
                                        var p = new l; if ("esri.layers.FeatureLayer" !== a.declaredClass) return p.resolve([]), p; var B = new d(a.url), t = new c; t.where = h.filterExpression || a.getDefinitionExpression && a.getDefinitionExpression() || "1\x3d1"; 0 < f.length ? (a = A.map(f, function (u) { return u.name }), t.outFields =
                                                a) : t.outFields = ["*"]; t.objectIds = h.objectIds; t.returnGeometry = h.withGeometry; t.outSR = h.spatialReference; t.geometry = h.geometry; t.orderByFields = h.orderByFields; t.start = h.start; t.num = h.num; t.outSpatialReference = h.outSpatialReference; B.execute(t, function (u) { u = A.map(u.features, function (z) { return e(z) }); p.resolve(u) }, function (u) { console.error(u); p.resolve([]) }); return p
                                }; E._formattedData = function (a, f, h) {
                                        var p = new l, B = [], t = f.data; f = f.outFields; a = E._getDomainValuesMap(a, f, t); for (var u = 0, z = t.length; u < z; u++) {
                                                for (var x =
                                                        {}, y = 0; y < f.length; y++) { var D = f[y]; x[D.name] = a[D.name] ? a[D.name][u].displayValue : E._getExportValue(t[u], D, h) } B.push(x)
                                        } h = A.map(f, function (H) { return { alias: H.alias, name: H.name } }); p.resolve({ datas: B, columns: h }); return p
                                }; E._getDomainValuesMap = function (a, f, h) { var p = {}; A.forEach(f, function (B) { var t = k.getDisplayValueForCodedValueOrSubtype(a, B.name, h[0]); p[B.name] = t.isCodedValueOrSubtype ? k.getDisplayValueForCodedValueOrSubtypeBatch(a, B.name, h) : !1 }); return p }; E._getExportValue = function (a, f, h) {
                                        function p(y) {
                                                if (u &&
                                                        n.isDefined(u.fieldInfos)) for (var D = 0, H = u.fieldInfos.length; D < H; D++) { var I = u.fieldInfos[D]; if (I.fieldName === y) return I.format } return null
                                        } function B(y) { for (var D = 0, H = z.length; D < H; D++)if (z[D].fieldName === y) return !0; return !1 } var t = a[f.name], u = h.popupInfo, z = h.richText.fieldsToClear, x = "esriFieldTypeDate" === f.type && h.formatDate; B = "esriFieldTypeString" === f.type && h.richText.clearFormat && B(f.name); return x ? k.fieldFormatter.getFormattedDate(t, p(f.name)) : B ? t ? (a = document.createElement("span"), a.innerHTML = t,
                                                a.textContent || a.innerText || "") : t : a[f.name]
                                }; E._getAttrsWithExpressions = function (a, f) { var h = q.getObject("expressionInfos", !1, f); f = q.getObject("layerDefinition", !1, f); var p = new g(null, null, a); return b.customExpr.getAttributesFromCustomArcadeExpr(h, p, f) || a }; E._getAttrsWithExpressionsBatch = function (a, f) { var h = []; return h = A.map(a, function (p) { return E._getAttrsWithExpressions(p, f) }) }
                        })
                }, "jimu/ArcadeUtils": function () {
                        define("dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all dojo/string esri/arcade/arcade esri/arcade/Feature esri/ArcadeExpression esri/arcadeProfiles/popupProfile esri/tasks/RelationshipQuery jimu/utils jimu/LayerStructure".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                        var g = { readExprInfo: {} }; g.readExprInfo.getArcadeProfilesByType = function (b, e, a) { b = { map: b, layer: e }; return "render" === a ? g.readExprInfo._getArcadeRender(b) : "label" === a ? g.readExprInfo._getArcadeLabel(b) : "infoTemplate" === a ? g.readExprInfo._getArcadeInfoTemplate(b) : g.readExprInfo._getAllArcade(b) }; g.readExprInfo._getArcadeRender = function (b) { return g.readExprInfo._lookupArcadeRender({ layers: g.readExprInfo._checkPassInLayer(b) }) }; g.readExprInfo._getArcadeInfoTemplate = function (b) { return g.readExprInfo._lookupArcadeInfoTemplate({ layers: g.readExprInfo._checkPassInLayer(b) }) };
                                        g.readExprInfo._getArcadeLabel = function (b) { return g.readExprInfo._lookupArcadeLabel({ layers: g.readExprInfo._checkPassInLayer(b) }) }; g.readExprInfo._getAllArcade = function (b) { var e = g.readExprInfo._getArcadeRender(b), a = g.readExprInfo._getArcadeInfoTemplate(b); b = g.readExprInfo._getArcadeLabel(b); return { render: e, infoTemplate: a, label: b } }; g.readExprInfo._checkPassInLayer = function (b) {
                                                var e = []; return e = "undefined" !== typeof b ? "undefined" !== typeof b.layer ? null !== b.layer && "" !== b.layer ? g.readExprInfo._getAllMapLayers(b) :
                                                        g.readExprInfo._getAllMapLayers() : g.readExprInfo._getAllMapLayers() : g.readExprInfo._getAllMapLayers()
                                        }; g.readExprInfo._getAllMapLayers = function (b) { var e = "", a = [], f = c.getInstance(); b && b.layer && (e = b.layer.id); "" !== e ? (b = f.getNodeById(e)) && a.push(b._layerInfo.layerObject) : f.traversal(function (h) { "undefined" !== typeof h._layerInfo.layerObject.type ? -1 === h._layerInfo.layerObject.type.indexOf("tile") && a.push(h._layerInfo.layerObject) : a.push(h._layerInfo.layerObject) }); return a }; g.readExprInfo._lookupArcadeRender =
                                                function (b) {
                                                        var e = []; 0 < b.layers.length && E.forEach(b.layers, q.hitch(this, function (a) {
                                                                var f = {}; if ("undefined" !== typeof a.renderer) {
                                                                        var h = a.renderer; "undefined" !== typeof h.valueExpression && (f.layer = a.id, f.valueExpression = h.valueExpression, f.valueExpressionTitle = h.valueExpressionTitle, "undefined" !== typeof h.values && (f.values = h.values), "undefined" !== typeof h.visualVariables && (f.visualVariables = h.visualVariables)); 1 < Object.keys(f).length && f.constructor === Object ? e.push(f) : e.push({
                                                                                layer: a.id, valueExpression: null,
                                                                                valueExpressionTitle: null, values: null, visualVariables: null
                                                                        })
                                                                }
                                                        })); return e
                                                }; g.readExprInfo._lookupArcadeInfoTemplate = function (b) {
                                                        var e = []; 0 < b.layers.length && E.forEach(b.layers, q.hitch(this, function (a) {
                                                                var f = {}; if ("undefined" !== typeof a.infoTemplate) "undefined" !== typeof a.infoTemplate.info.expressionInfos && 0 < a.infoTemplate.info.expressionInfos.length && (f.layer = a.id, f.expressionInfos = a.infoTemplate.info.expressionInfos); else if ("undefined" !== typeof a.infoTemplates) for (var h in a.infoTemplates) if (a.infoTemplates.hasOwnProperty(h) &&
                                                                        "undefined" !== typeof a.infoTemplates[h].infoTemplate.info.expressionInfos) { var p = a.infoTemplates[h].infoTemplate; 0 < p.info.expressionInfos.length && (f.layer = a.id, f.expressionInfos = p.info.expressionInfos) } 1 < Object.keys(f).length && f.constructor === Object ? e.push(f) : e.push({ layer: a.id, expressionInfos: null })
                                                        })); return e
                                                }; g.readExprInfo._lookupArcadeLabel = function (b) {
                                                        var e = []; 0 < b.layers.length && E.forEach(b.layers, q.hitch(this, function (a) {
                                                                var f = {}; "undefined" !== typeof a.labelingInfo && E.forEach(a.labelingInfo,
                                                                        q.hitch(this, function (h) { "undefined" !== typeof h.name && (f.layer = a.id, f.name = h.name, f.labelingInfo = h, f.expression = h.labelExpressionInfo.expression) })); 1 < Object.keys(f).length && f.constructor === Object ? e.push(f) : e.push({ layer: a.id, name: null, labelingInfo: null, expression: null })
                                                        })); return e
                                                }; g.compileExpressions = function (b) { var e = {}; E.forEach(b, function (a) { a.returnType && a.returnType.toLowerCase(); e[a.name] = new l({ expression: a.expression, returnType: "number" === a.returnType ? "number" : "string", profile: k }) }); return e };
                                        g.isAsync = function (b, e, a) { var f = "", h; for (h in e) if (0 <= b.indexOf("expression/") && h === b.split("expression/")[1]) { f = h; break } return (b = (e ? e : g.compileExpressions(a))[f]) && k.isAsync(b) }; g.customExpr = {}; g.customExpr.getAttributesFromCustomArcadeExpr = function (b, e, a) { b = g.InfoTemplate._parseArcadeExpressions(b); return g.InfoTemplate._combineFeatureAttributesAndExpressionResolutions(e, b, a) }; g.customExpr.getAsynAttributesFromCustomArcadeExpr = function (b, e, a, f) {
                                                var h = q.mixin({}, e.attributes); if (b) for (var p in b) h["expression/" +
                                                        p] = e.evaluateExpression(b[p], k.getEvalOptions({ expression: b[p], feature: e, layer: a, map: f, spatialReference: f && f.spatialReference })); return h
                                        }; g.customExpr.getAttributesValueFromCustomArcadeExprBatch = function (b, e, a) { var f = [], h; for (h in e) f.push(e[h]); e = g.InfoTemplate._parseArcadeExpressions(b); b = g.InfoTemplate._getExprNamesArrayFromPopupExprInfos(b); b.relationships = null; b.parsedExpressions = e; var p = new A; g.InfoTemplate._getPopupFieldsValueFromArcadeFeatures(f, b, a).then(function (B) { p.resolve(B) }); return p };
                                        g.InfoTemplate = {}; g.InfoTemplate.getAttributesFromInfoTemplate = function (b, e, a) { var f = { fields: [] }; e.layerObject && e.layerObject.fields && (f.fields = e.layerObject.fields); b = g.readExprInfo.getArcadeProfilesByType(b, e, "infoTemplate")[0].expressionInfos; if (!b) return a.attributes; b = g.InfoTemplate._parseArcadeExpressions(b); return g.InfoTemplate._combineFeatureAttributesAndExpressionResolutions(a, b, f) }; g.InfoTemplate.getAttributesValueFromInfoTemplateBatch = function (b, e, a) {
                                                var f = { fields: [] }; e.layerObject && e.layerObject.fields &&
                                                        (f.fields = e.layerObject.fields); var h = []; for (B in a) h.push(a[B]); b = g.readExprInfo.getArcadeProfilesByType(b, e, "infoTemplate")[0].expressionInfos; var p = new A; if (!b) return p.resolve([]), p; a = g.InfoTemplate._parseArcadeExpressions(b); var B = null; B = e.getPopupInfo().description; null !== B ? (B = g.InfoTemplate._convertPopupDescToFieldNamesArray(B), B.relationships = g.InfoTemplate._getRelationshipQueries(e)) : (B = g.InfoTemplate._getExprNamesArrayFromPopupExprInfos(b), B.relationships = null); B.parsedExpressions = a; g.InfoTemplate._getPopupFieldsValueFromArcadeFeatures(h,
                                                                B, f).then(function (t) { p.resolve(t) }); return p
                                        }; g.InfoTemplate._getRelationshipQueries = function (b) { var e = !1, a = {}, f = /\d+/, h; if (h = b.getPopupInfo().description.match(/\{relationships\/\d+\//gm)) e = !0, E.forEach(h, function (p) { var B = p.match(f)[0]; a.hasOwnProperty(B) || (p = new n, p.outFields = ["*"], p.relationshipId = B, p.returnGeometry = !1, a[B] = { operLayer: b, relatedQuery: p }) }); return e ? a : null }; g.InfoTemplate._getExprNamesArrayFromPopupExprInfos = function (b) {
                                                var e = [], a; for (a in b) e.push("${expression/" + b[a].name + "}");
                                                return e
                                        }; g.InfoTemplate._convertPopupDescToFieldNamesArray = function (b) { b = g.InfoTemplate._convertEndParasToEOLs(b); b = g.InfoTemplate._convertBreaksToEOLs(b); b = g.InfoTemplate._sanitizeNoTags(b).trim(); b = b.replace(/\{/gi, "${"); b = b.replace(/\u00a0/gi, " "); b = b.split("\n"); return b = E.map(b, function (e) { return e.trim() }) }; g.InfoTemplate._sanitizeNoTags = function (b) {
                                                var e = d.sanitizeHTML(b); b = /<(?:!--(?:(?:-*[^->])*--+|-?)|script\b(?:[^"'>]|"[^"]*"|'[^']*')*>[\s\S]*?<\/script\s*|style\b(?:[^"'>]|"[^"]*"|'[^']*')*>[\s\S]*?<\/style\s*|\/?[a-z](?:[^"'>]|"[^"]*"|'[^']*')*)>/gi;
                                                do { var a = e; e = e.replace(b, "") } while (e !== a); return e = e.replace(/</g, "\x26lt;")
                                        }; g.InfoTemplate._getPopupFieldsValueFromArcadeFeatures = function (b, e, a) {
                                                var f = new A, h = [], p = [], B = 0; e.relationships ? (E.forEach(b, function (t) {
                                                        g.InfoTemplate._objEach(e.relationships, function (u, z) {
                                                                var x = new A, y = u.relatedQuery; p.push(x); var D = t.attributes[u.operLayer.layerObject.objectIdField]; y.objectIds = [D]; u.operLayer.layerObject.queryRelatedFeatures(y, function (H) {
                                                                        var I = []; H[D] && H[D].features && (H = H[D].features, E.forEach(H, function (N) {
                                                                                var T =
                                                                                        [], M; var R = t.attributes; var ca = "relationships/" + z + "/"; g.InfoTemplate._objEach(N.attributes, function (K, Q) { M = ca + Q; R[M] = K }); E.forEach(e, function (K) { T.push(m.substitute(K, g.InfoTemplate._combineFeatureAttributesAndExpressionResolutions(t, e.parsedExpressions, a), g.InfoTemplate._useEmptyStringForNull)) }); I.push(T)
                                                                        })); x.resolve(I)
                                                                })
                                                        })
                                                }), w(p).then(function (t) { E.forEach(t, function (u) { E.forEach(u, function (z) { ++B; h.push(z) }) }); console.log(B + " related address features found"); f.resolve(h) })) : (E.forEach(b, function (t) {
                                                        var u =
                                                                []; E.forEach(e, function (z) { u.push(m.substitute(z, g.InfoTemplate._combineFeatureAttributesAndExpressionResolutions(t, e.parsedExpressions, a), g.InfoTemplate._useEmptyStringForNull)) }); h.push(u)
                                                }), f.resolve(h)); return f
                                        }; g.InfoTemplate._parseArcadeExpressions = function (b) { if (Array.isArray(b) && 0 < b.length) { var e = {}; E.forEach(b, function (a) { e[a.name] = v.parseScript(a.expression) }) } return e }; g.InfoTemplate._initArcadeContext = function (b, e) {
                                                var a = { vars: {} }; a.vars.$feature = r.createFromGraphicLikeObject(b.geometry,
                                                        b.attributes, e); return a
                                        }; g.InfoTemplate._combineFeatureAttributesAndExpressionResolutions = function (b, e, a) { var f; var h = q.mixin({}, b.attributes); if (e) for (f in b = g.InfoTemplate._initArcadeContext(b, a), e) a = v.executeScript(e[f], b), h["expression/" + f] = a ? a.toString() : ""; return h }; g.InfoTemplate._convertEndParasToEOLs = function (b) { var e = b; b = b.match(/<\/p>/gi); E.forEach(b, function (a) { e = e.replace(a, "\n") }); return e }; g.InfoTemplate._convertBreaksToEOLs = function (b) {
                                                var e = b; b = b.match(/<br\s*\/?>/gi); E.forEach(b,
                                                        function (a) { e = e.replace(a, "\n") }); return e
                                        }; g.InfoTemplate._useEmptyStringForNull = function (b) { return b ? b : "" }; g.InfoTemplate._objEach = function (b, e, a) { for (var f in b) b.hasOwnProperty(f) && e.call(a, b[f], f) }; return g
                                })
                }, "jimu/LayerStructure": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on dojo/Evented ./LayerInfos/LayerInfos".split(" "), function (E, q, A, w, m, v) {
                                var r = E([m], {
                                        declaredClass: "jimu.LayerStructure", map: null, _layerInfos: null, _eventHandles: null, constructor: function (k) {
                                                this._layerInfos =
                                                k; this.map = this._layerInfos.map; this._eventHandles = []; this._bindEvents()
                                        }, getLayerNodes: function () { return this._getNodesArrayFromInfosArray(this._layerInfos.getLayerInfoArray()) }, getTableNodes: function () { return this._getNodesArrayFromInfosArray(this._layerInfos.getTableInfoArray()) }, getBasemapLayerNodes: function () { return this._getNodesArrayFromInfosArray(this._layerInfos.getBasemapLayerInfoArray()) }, getWebmapLayerNodes: function () { return this._getNodesArrayFromInfosArray(this._layerInfos.getLayerInfoArrayOfWebmap()) },
                                        getWebmapTableNodes: function () { return this._getNodesArrayFromInfosArray(this._layerInfos.getTableInfoArrayOfWebmap()) }, addTable: function (k) { var n = null; if (k = this._layerInfos.addTable(k)) n = k._adaptor; return n }, removeTable: function (k) { (k = this.getNodeById(k)) && this._layerInfos.removeTable(k._layerInfo) }, _traversal: function (k, n) { for (var d = 0; d < n.length; d++)if (n[d].traversal(k)) return !0; return !1 }, traversal: function (k) { return this._traversal(k, this.getLayerNodes().concat(this.getBasemapLayerNodes().concat(this.getTableNodes()))) },
                                        traversalWithNodes: function (k, n) { return this._traversal(k, n) }, getNodeById: function (k) { var n = null; this.traversal(function (d) { if (d.id === k) return n = d, !0 }); return n }, getBasemapLayerObjects: function () { return this._layerInfos.getBasemapLayers() }, restoreState: function (k) { this._layerInfos.restoreState(k) }, destroy: function () { q.forEach(this._eventHandles, function (k) { k.remove() }); this.inherited(arguments) }, _getNodesArrayFromInfosArray: function (k) { var n = []; q.forEach(k, function (d) { n.push(d._adaptor) }, this); return n },
                                        _emitEvent: function () { try { this.emit.apply(this, arguments) } catch (k) { console.warn(k) } }, _bindEvents: function () {
                                                var k = w(this._layerInfos, "layerInfosChanged", A.hitch(this, this._onLayerNodesStructureChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "basemapLayerInfosChanged", A.hitch(this, this._onLayerNodesStructureChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "tableInfosChanged", A.hitch(this, this._onTableNdoesStructureChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "layerInfosReorder",
                                                        A.hitch(this, this._onLayerReordered)); this._eventHandles.push(k); k = w(this._layerInfos, "layerInfosIsShowInMapChanged", A.hitch(this, this._onVisibilityChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "layerInfosIsVisibleChanged", A.hitch(this, this._onToggleChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "layerInfosFilterChanged", A.hitch(this, this._onFilterChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "layerInfosRendererChanged", A.hitch(this, this._onRendererChanged)); this._eventHandles.push(k);
                                                k = w(this._layerInfos, "layerInfosOpacityChanged", A.hitch(this, this._onOpacityChanged)); this._eventHandles.push(k); k = w(this._layerInfos, "layerInfosTimeExtentChanged", A.hitch(this, this._onTimeExtentChanged)); this._eventHandles.push(k)
                                        }, _onLayerNodesStructureChanged: function (k, n, d) { this._emitEvent(r.EVENT_STRUCTURE_CHANGE, { type: n, layerNodes: [d._adaptor], rootLayerNodes: [k._adaptor] }) }, _onTableNdoesStructureChanged: function (k, n) {
                                                k = this._getNodesArrayFromInfosArray(k); this._emitEvent(r.EVENT_STRUCTURE_CHANGE,
                                                        { type: n, layerNodes: k, rootLayerNodes: k })
                                        }, _onLayerReordered: function (k, n) { k = k ? [k._adaptor] : []; this._emitEvent(r.EVENT_STRUCTURE_CHANGE, { type: n, layerNodes: k, rootLayerNodes: k }) }, _onVisibilityChanged: function (k) { k = { layerNodes: this._getNodesArrayFromInfosArray(k) }; this._emitEvent(r.EVENT_VISIBILITY_CHANGE, k) }, _onToggleChanged: function (k) { k = { layerNodes: this._getNodesArrayFromInfosArray(k) }; this._emitEvent(r.EVENT_TOOGLE_CHANGE, k) }, _onFilterChanged: function (k) {
                                                k = { layerNodes: this._getNodesArrayFromInfosArray(k) };
                                                this._emitEvent(r.EVENT_FILTER_CHANGE, k)
                                        }, _onRendererChanged: function (k) { k = { layerNodes: this._getNodesArrayFromInfosArray(k) }; this._emitEvent(r.EVENT_RENDERER_CHANGE, k) }, _onOpacityChanged: function (k) { k = { layerNodes: this._getNodesArrayFromInfosArray(k) }; this._emitEvent(r.EVENT_OPACITY_CHANGE, k) }, _onTimeExtentChanged: function (k) { k = { layerNodes: this._getNodesArrayFromInfosArray(k) }; this._emitEvent(r.EVENT_TIME_EXTENT_CHANGE, k) }
                                }), l = null; r.getInstance = function () {
                                        l && l._layerInfos._objectId === v.getInstanceSync()._objectId ||
                                        (l && l.destroy(), l = new r(v.getInstanceSync())); return l
                                }; r.createInstance = function (k) { return new r(v.createInstance(k)) }; A.mixin(r, {
                                        STRUCTURE_CHANGE_ADD: v.ADDED, STRUCTURE_CHANGE_REMOVE: v.REMOVED, STRUCTURE_CHANGE_SUBNODE_ADD: v.SUBLAYER_ADDED, STRUCTURE_CHANGE_SUBNODE_REMOVE: v.SUBLAYER_REMOVED, STRUCTURE_CHANGE_NODE_UPDATE: v.UPDATED, STRUCTURE_CHANGE_REORDER: v.REORDERED, EVENT_STRUCTURE_CHANGE: "structure-change", EVENT_TOOGLE_CHANGE: "toggle-change", EVENT_VISIBILITY_CHANGE: "visibility-change", EVENT_FILTER_CHANGE: "filter-change",
                                        EVENT_RENDERER_CHANGE: "renderer-change", EVENT_OPACITY_CHANGE: "opacity-change", EVENT_TIME_EXTENT_CHANGE: "time-extent-change"
                                }); return r
                        })
                }, "jimu/GeojsonConverters": function () {
                        define([], function () {
                                function E(r) { a: { var l = r[0]; for (var k = 0; k < l.length; k++)if (l[k] !== r[r.length - 1][k]) { l = !1; break a } l = !0 } l || r.push(r[0]); return r } function q(r) { var l = 0, k = 0, n = r.length, d = r[k]; for (k; k < n - 1; k++) { var c = r[k + 1]; l += (c[0] - d[0]) * (c[1] + d[1]); d = c } return 0 <= l } function A(r, l) {
                                        for (var k = 0; k < r.length - 1; k++)for (var n = 0; n < l.length -
                                                1; n++) { a: { var d = r[k], c = r[k + 1], g = l[n], b = l[n + 1], e = (b[0] - g[0]) * (d[1] - g[1]) - (b[1] - g[1]) * (d[0] - g[0]); var a = (c[0] - d[0]) * (d[1] - g[1]) - (c[1] - d[1]) * (d[0] - g[0]); d = (b[1] - g[1]) * (c[0] - d[0]) - (b[0] - g[0]) * (c[1] - d[1]); if (0 !== d && (e /= d, a /= d, 0 <= e && 1 >= e && 0 <= a && 1 >= a)) { a = !0; break a } a = !1 } if (a) return !0 } return !1
                                } function w(r) { var l = []; r = r.slice(0); var k = E(r.shift().slice(0)); if (4 <= k.length) for (q(k) || k.reverse(), l.push(k), k = 0; k < r.length; k++) { var n = E(r[k].slice(0)); 4 <= n.length && (q(n) && n.reverse(), l.push(n)) } return l } function m(r) {
                                        var l =
                                                {}, k; for (k in r) r.hasOwnProperty(k) && (l[k] = r[k]); return l
                                } var v = {
                                        arcgisToGeoJSON: function (r, l) {
                                                var k = {}; "number" === typeof r.x && "number" === typeof r.y && (k.type = "Point", k.coordinates = [r.x, r.y]); r.points && (k.type = "MultiPoint", k.coordinates = r.points.slice(0)); r.paths && (1 === r.paths.length ? (k.type = "LineString", k.coordinates = r.paths[0].slice(0)) : (k.type = "MultiLineString", k.coordinates = r.paths.slice(0))); if (r.rings) {
                                                        var n = r.rings.slice(0); k = []; var d = [], c, g; for (g = 0; g < n.length; g++) {
                                                                var b = E(n[g].slice(0)); 4 >
                                                                        b.length || (q(b) ? k.push([b]) : d.push(b))
                                                        } for (b = []; d.length;) { g = d.pop(); var e = !1; for (n = k.length - 1; 0 <= n; n--) { var a = c = k[n][0], f = g; c = A(a, f); f = f[0]; for (var h = !1, p = -1, B = a.length, t = B - 1; ++p < B; t = p)(a[p][1] <= f[1] && f[1] < a[t][1] || a[t][1] <= f[1] && f[1] < a[p][1]) && f[0] < (a[t][0] - a[p][0]) * (f[1] - a[p][1]) / (a[t][1] - a[p][1]) + a[p][0] && (h = !h); a = h; if (!c && a) { k[n].push(g); e = !0; break } } e || b.push(g) } for (; b.length;) { g = b.pop(); d = !1; for (n = k.length - 1; 0 <= n; n--)if (c = k[n][0], A(c, g)) { k[n].push(g); d = !0; break } d || k.push([g.reverse()]) } k = 1 ===
                                                                k.length ? { type: "Polygon", coordinates: k[0] } : { type: "MultiPolygon", coordinates: k }
                                                } if (r.geometry || r.attributes) k.type = "Feature", k.geometry = r.geometry ? v.arcgisToGeoJSON(r.geometry) : null, k.properties = r.attributes ? m(r.attributes) : null, r.attributes && (k.id = r.attributes[l] || r.attributes.OBJECTID || r.attributes.FID); return k
                                        }, geojsonToArcGIS: function (r, l) {
                                                l = l || "OBJECTID"; var k = { wkid: 4326 }, n = {}; switch (r.type) {
                                                        case "Point": n.x = r.coordinates[0]; n.y = r.coordinates[1]; n.spatialReference = k; break; case "MultiPoint": n.points =
                                                                r.coordinates.slice(0); n.spatialReference = k; break; case "LineString": n.paths = [r.coordinates.slice(0)]; n.spatialReference = k; break; case "MultiLineString": n.paths = r.coordinates.slice(0); n.spatialReference = k; break; case "Polygon": n.rings = w(r.coordinates.slice(0)); n.spatialReference = k; break; case "MultiPolygon": l = n; r = r.coordinates.slice(0); for (var d = [], c = 0; c < r.length; c++)for (var g = w(r[c]), b = g.length - 1; 0 <= b; b--) { var e = g[b].slice(0); d.push(e) } l.rings = d; n.spatialReference = k; break; case "Feature": r.geometry &&
                                                                        (n.geometry = v.geojsonToArcGIS(r.geometry, l)); n.attributes = r.properties ? m(r.properties) : {}; r.id && (n.attributes[l] = r.id); break; case "FeatureCollection": n = []; for (k = 0; k < r.features.length; k++)n.push(v.geojsonToArcGIS(r.features[k], l)); break; case "GeometryCollection": for (n = [], k = 0; k < r.geometries.length; k++)n.push(v.geojsonToArcGIS(r.geometries[k], l))
                                                }return n
                                        }
                                }; return v
                        })
                }, "libs/polyfills/FileSaver": function () {
                        (function (E, q) {
                                "function" == typeof define && define.amd ? define([], q) : "undefined" != typeof exports ?
                                        q() : (q(), E.FileSaver = {})
                        })(this, function () {
                                function E(r, l) { return "undefined" == typeof l ? l = { autoBom: !1 } : "object" != typeof l && (console.warn("Depricated: Expected third argument to be a object"), l = { autoBom: !l }), l.autoBom && /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type) ? new Blob(["\ufeff", r], { type: r.type }) : r } function q(r, l, k) {
                                        var n = new XMLHttpRequest; n.open("GET", r); n.responseType = "blob"; n.onload = function () { v(n.response, l, k) }; n.onerror = function () { console.error("could not download file") };
                                        n.send()
                                } function A(r) { var l = new XMLHttpRequest; return l.open("HEAD", r, !1), l.send(), 200 <= l.status && 299 >= l.status } function w(r) { try { r.dispatchEvent(new MouseEvent("click")) } catch (k) { var l = document.createEvent("MouseEvents"); l.initMouseEvent("click", !0, !0, window, 0, 0, 0, 80, 20, !1, !1, !1, !1, 0, null); r.dispatchEvent(l) } } var m = "object" == typeof window && window.window === window ? window : "object" == typeof self && self.self === self ? self : "object" == typeof global && global.global === global ? global : void 0, v = m.saveAs || ("object" !=
                                        typeof window || window !== m ? function () { } : "download" in HTMLAnchorElement.prototype ? function (r, l, k) { var n = m.URL || m.webkitURL, d = document.createElement("a"); l = l || r.name || "download"; d.download = l; d.rel = "noopener"; "string" == typeof r ? (d.href = r, d.origin === location.origin ? w(d) : A(d.href) ? q(r, l, k) : w(d, d.target = "_blank")) : (d.href = n.createObjectURL(r), setTimeout(function () { n.revokeObjectURL(d.href) }, 4E4), setTimeout(function () { w(d) }, 0)) } : "msSaveOrOpenBlob" in navigator ? function (r, l, k) {
                                                if (l = l || r.name || "download", "string" !=
                                                        typeof r) navigator.msSaveOrOpenBlob(E(r, k), l); else if (A(r)) q(r, l, k); else { var n = document.createElement("a"); n.href = r; n.target = "_blank"; setTimeout(function () { w(n) }) }
                                        } : function (r, l, k, n) {
                                                if (n = n || open("", "_blank"), n && (n.document.title = n.document.body.innerText = "downloading..."), "string" == typeof r) return q(r, l, k); l = "application/octet-stream" === r.type; k = /constructor/i.test(m.HTMLElement) || m.safari; var d = /CriOS\/[\d]+/.test(navigator.userAgent); if ((d || l && k) && "object" == typeof FileReader) {
                                                        var c = new FileReader;
                                                        c.onloadend = function () { var e = c.result; e = d ? e : e.replace(/^data:[^;]*;/, "data:attachment/file;"); n ? n.location.href = e : location = e; n = null }; c.readAsDataURL(r)
                                                } else { var g = m.URL || m.webkitURL, b = g.createObjectURL(r); n ? n.location = b : location.href = b; n = null; setTimeout(function () { g.revokeObjectURL(b) }, 4E4) }
                                        }); m.saveAs = v.saveAs = v; "undefined" != typeof module && (module.exports = v)
                        })
                }, "jimu/featureActions/ExportToFeatureCollection": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "../exportUtils"], function (E,
                                q, A) { return E(q, { name: "ExportToFeatureCollection", iconClass: "icon-export", isFeatureSupported: function (w) { return 0 < w.features.length && w.features[0].geometry }, onExecute: function (w) { w = A.createDataSource({ type: A.TYPE_FEATURESET, filename: "features", data: w }); w.setFormat(A.FORMAT_FEATURESET); w.download() } }) })
                }, "jimu/featureActions/ExportToGeoJSON": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "../exportUtils"], function (E, q, A) {
                                return E(q, {
                                        name: "ExportToGeoJSON", iconClass: "icon-export", isFeatureSupported: function (w) {
                                                return 0 <
                                                        w.features.length && w.features[0].geometry
                                        }, onExecute: function (w) { w = A.createDataSource({ type: A.TYPE_FEATURESET, filename: "features", data: w }); w.setFormat(A.FORMAT_GEOJSON); w.download() }
                                })
                        })
                }, "jimu/featureActions/ShowStatistics": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "jimu/dijit/FieldStatistics"], function (E, q, A) {
                                return E(q, {
                                        iconClass: "icon-statistics", isFeatureSupported: function (w, m) { return 1 < w.features.length && m && "esri.layers.GraphicsLayer" !== m.declaredClass && 0 < this.getNumbericFields(m).length },
                                        onExecute: function (w, m) { var v = new A; w = { featureSet: w, layer: m, fieldNames: this.getNumbericFields(m).map(function (r) { return r.name }) }; v.showContentAsPopup(w) }, getNumbericFields: function (w) { return w.fields.filter(function (m) { return -1 < ["esriFieldTypeSmallInteger", "esriFieldTypeInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"].indexOf(m.type) }) }
                                })
                        })
                }, "jimu/dijit/FieldStatistics": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/NodeList-manipulate dojo/when jimu/dijit/formSelect esri/lang jimu/dijit/Popup jimu/dijit/LoadingIndicator jimu/utils jimu/statisticsUtils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                        return E([q], {
                                                statInfo: null, postMixInProperties: function () { this.nls = window.jimuNls.fieldStatistics; A.mixin(this.nls, window.jimuNls.common) }, showContent: function (a) { this.statInfo = a; 0 !== this.statInfo.fieldNames.length && (a = w.create("div", { className: "stat-container" }, this.domNode), this._createFieldDom(a), 1 === this.statInfo.fieldNames.length && (this.statInfo.fieldName = this.statInfo.fieldNames[0], this._showOneFieldStatContent(this.statInfo, a))) }, showContentAsPopup: function (a) {
                                                        this.statInfo =
                                                        a; this._statisticsPopup && this._statisticsPopup.domNode && this._statisticsPopup.close(); this._statisticsPopup = null; this._statisticsPopup = new c({ titleLabel: this.nls.statistics, content: this.domNode, width: 270, height: 265, buttons: [{ label: this.nls.ok }] }); this.showContent(a)
                                                }, _showOneFieldStatContent: function (a, f) {
                                                        if (e.isStatFromServer(this.statInfo)) { var h = new g; h.placeAt(f); h.show() } e.getStatisticsResult(this.statInfo).then(A.hitch(this, function (p) {
                                                                h && h.destroy(); r(".esriAGOTableStatistics", f).remove();
                                                                p = this._createStatContent(p); w.place(p, f)
                                                        }))
                                                }, _getFieldAliaseFromStatInfo: function (a) { var f = this.statInfo.featureSet; (f = f && f.fieldAliases) && "undefined" !== typeof f[a] ? f = f[a] : this.statInfo.layer ? (f = m.filter(this.statInfo.layer.fields, function (h) { return h.name === a }), f = f[0] ? f[0].alias : "") : f = a; return f }, _createFieldDom: function (a) {
                                                        if (1 < this.statInfo.fieldNames.length) {
                                                                var f = w.create("div", { className: "header" }, a); w.create("span", { innerHTML: this.nls.field + ": " }, f); var h = new n({
                                                                        options: this.statInfo.fieldNames.map(A.hitch(this,
                                                                                function (p) { return { value: p, label: this._getFieldAliaseFromStatInfo(p) } })), style: { width: "150px" }, "aria-label": this.nls.field
                                                                }); this.own(v(h, "change", A.hitch(this, function (p) { this.statInfo.fieldName = p; this._showOneFieldStatContent(this.statInfo, a) }))); h.placeAt(f); this.statInfo.fieldName = this.statInfo.fieldNames[0]; this._showOneFieldStatContent(this.statInfo, a)
                                                        } else f = w.create("div", { className: "header", innerHTML: "\x3cspan\x3e" + this.nls.field + "\x3c/span\x3e: " + this._getFieldAliaseFromStatInfo(this.statInfo.fieldNames[0]) },
                                                                a); return f
                                                }, _createStatContent: function (a) {
                                                        var f = {}, h = "count sum min max ave stddev".split(" "), p; var B = w.create("div", { className: "esriAGOTableStatistics", innerHTML: "" }); w.create("div", { className: "hzLine", innerHTML: "" }, B); var t = w.create("table", { className: "attrTable", tabindex: "0", innerHTML: "", style: { cellpadding: 0, cellspacing: 0 } }, B); for (u in a) a.hasOwnProperty(u) && (f[u.toLowerCase()] = a[u]); var u = f.countfield; var z = f.sumfield || ""; var x = f.minfield || ""; var y = f.maxfield || ""; a = f.avgfield || ""; f = f.stddevfield ||
                                                                ""; var D = w.create("tbody", {}, t); var H = this; m.forEach([u, z, x, y, a, f], function (I, N) { "" !== I && (p = w.create("tr", { valign: "top" }, D), w.create("td", { "class": "attrName", innerHTML: H.nls[h[N]] }, p), w.create("td", { "class": "attrValue", innerHTML: I }, p)) }); w.create("div", { className: "break", innerHTML: "" }, B); return B
                                                }
                                        })
                                })
                }, "jimu/dijit/formSelect": function () {
                        define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/query dojo/_base/array dojo/dom-construct dijit/form/Select".split(" "), function (E, q, A, w, m,
                                v, r, l) {
                                        return E([l], {
                                                postCreate: function () {
                                                        this.inherited(arguments); var k = this["aria-label"], n = this["aria-labelledby"]; if (k && "focusNode" !== k) { var d = '\x3ccaption class\x3d"screen-readers-only-no-position"\x3e' + k + "\x3c/caption\x3e"; k = q.toDom(d); r.place(k, this.domNode, "first") } else n ? setTimeout(A.hitch(this, function () {
                                                                var c = n.split(" "), g = []; v.forEach(c, function (b) { (b = m("#" + b)[0]) && "" !== b && b.innerHTML && g.push(b.innerHTML) }); 0 < g.length && (d = '\x3ccaption class\x3d"screen-readers-only-no-position"\x3e' +
                                                                        g.join(" ") + "\x3c/caption\x3e", c = q.toDom(d), r.place(c, this.domNode, "first"))
                                                        }), 1E3) : (this.setAttrs = function () { this.domNode.title = ""; var c = this.get("value"); c && (c = this.getOptions(c), this.domNode.title = c.label, q.setAttr(this.domNode, "aria-label", c.label)) }, this.setAttrs(), w(this, "change", A.hitch(this, this.setAttrs)))
                                                }
                                        })
                        })
                }, "dijit/form/Select": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p) {
                                        function B(u) { return function (z) { this._isLoaded ? this.inherited(u, arguments) : this.loadDropDown(l.hitch(this, u, z)) } } var t = q("dijit.form._SelectMenu", g, {
                                                autoFocus: !0, buildRendering: function () { this.inherited(arguments); this.domNode.setAttribute("role", "listbox") }, postCreate: function () { this.inherited(arguments); this.own(k(this.domNode, "selectstart", function (u) { u.preventDefault(); u.stopPropagation() })) }, focus: function () {
                                                        var u = !1, z = this.parentWidget.value;
                                                        l.isArray(z) && (z = z[z.length - 1]); z && E.forEach(this.parentWidget._getChildren(), function (x) { x.option && z === x.option.value && (u = !0, this.focusChild(x, !1)) }, this); u || this.inherited(arguments)
                                                }
                                        }); m = q("dijit.form.Select" + (n("dojo-bidi") ? "_NoBidi" : ""), [d, c, f], {
                                                baseClass: "dijitSelect dijitValidationTextBox", templateString: p, _buttonInputDisabled: n("ie") ? "disabled" : "", required: !1, state: "", message: "", tooltipPosition: [], emptyLabel: "\x26#160;", _isLoaded: !1, _childrenLoaded: !1, labelType: "html", _fillContent: function () {
                                                        this.inherited(arguments);
                                                        if (this.options.length && !this.value && this.srcNodeRef) { var u = this.srcNodeRef.selectedIndex || 0; this._set("value", this.options[0 <= u ? u : 0].value) } this.dropDown = new t({ id: this.id + "_menu", parentWidget: this }); w.add(this.dropDown.domNode, this.baseClass.replace(/\s+|$/g, "Menu "))
                                                }, _getMenuItemForOption: function (u) {
                                                        if (u.value || u.label) {
                                                                var z = l.hitch(this, "_setValueAttr", u); u = new b({
                                                                        option: u, label: ("text" === this.labelType ? (u.label || "").toString().replace(/&/g, "\x26amp;").replace(/</g, "\x26lt;") : u.label) || this.emptyLabel,
                                                                        onClick: z, ownerDocument: this.ownerDocument, dir: this.dir, textDir: this.textDir, disabled: u.disabled || !1
                                                                }); u.focusNode.setAttribute("role", "option"); return u
                                                        } return new e({ ownerDocument: this.ownerDocument })
                                                }, _addOptionItem: function (u) { this.dropDown && this.dropDown.addChild(this._getMenuItemForOption(u)) }, _getChildren: function () { return this.dropDown ? this.dropDown.getChildren() : [] }, focus: function () { if (!this.disabled && this.focusNode.focus) try { this.focusNode.focus() } catch (u) { } }, focusChild: function (u) {
                                                        u && this.set("value",
                                                                u.option)
                                                }, _getFirst: function () { var u = this._getChildren(); return u.length ? u[0] : null }, _getLast: function () { var u = this._getChildren(); return u.length ? u[u.length - 1] : null }, childSelector: function (u) { return (u = h.byNode(u)) && u.getParent() == this.dropDown }, onKeyboardSearch: function (u, z, x, y) { u && this.focusChild(u) }, _loadChildren: function (u) {
                                                        if (!0 === u) if (this.dropDown && (delete this.dropDown.focusedChild, this.focusedChild = null), this.options.length) this.inherited(arguments); else {
                                                                E.forEach(this._getChildren(), function (x) { x.destroyRecursive() });
                                                                var z = new b({ ownerDocument: this.ownerDocument, label: this.emptyLabel }); this.dropDown.addChild(z)
                                                        } else this._updateSelection(); this._isLoaded = !1; this._childrenLoaded = !0; this._loadingStore || this._setValueAttr(this.value, !1)
                                                }, _refreshState: function () { this._started && this.validate(this.focused) }, startup: function () { this.inherited(arguments); this._refreshState() }, _setValueAttr: function (u) { this.inherited(arguments); A.set(this.valueNode, "value", this.get("value")); this._refreshState() }, _setNameAttr: "valueNode",
                                                _setDisabledAttr: function (u) { this.inherited(arguments); this._refreshState() }, _setRequiredAttr: function (u) { this._set("required", u); this.focusNode.setAttribute("aria-required", u); this._refreshState() }, _setOptionsAttr: function (u) { this._isLoaded = !1; this._set("options", u) }, _setDisplay: function (u) {
                                                        u = ("text" === this.labelType ? (u || "").replace(/&/g, "\x26amp;").replace(/</g, "\x26lt;") : u) || this.emptyLabel; this.containerNode.innerHTML = '\x3cspan role\x3d"option" aria-selected\x3d"true" class\x3d"dijitReset dijitInline ' +
                                                                this.baseClass.replace(/\s+|$/g, "Label ") + '"\x3e' + u + "\x3c/span\x3e"
                                                }, validate: function (u) { u = this.disabled || this.isValid(u); this._set("state", u ? "" : this._hasBeenBlurred ? "Error" : "Incomplete"); this.focusNode.setAttribute("aria-invalid", u ? "false" : "true"); var z = u ? "" : this._missingMsg; z && this.focused && this._hasBeenBlurred ? a.show(z, this.domNode, this.tooltipPosition, !this.isLeftToRight()) : a.hide(this.domNode); this._set("message", z); return u }, isValid: function () {
                                                        return !this.required || 0 === this.value || !/^\s*$/.test(this.value ||
                                                                "")
                                                }, reset: function () { this.inherited(arguments); a.hide(this.domNode); this._refreshState() }, postMixInProperties: function () { this.inherited(arguments); this._missingMsg = v.getLocalization("dijit.form", "validate", this.lang).missingMessage }, postCreate: function () { this.inherited(arguments); this.own(k(this.domNode, "selectstart", function (z) { z.preventDefault(); z.stopPropagation() })); this.domNode.setAttribute("aria-expanded", "false"); var u = this._keyNavCodes; delete u[r.LEFT_ARROW]; delete u[r.RIGHT_ARROW] }, _setStyleAttr: function (u) {
                                                        this.inherited(arguments);
                                                        w.toggle(this.domNode, this.baseClass.replace(/\s+|$/g, "FixedWidth "), !!this.domNode.style.width)
                                                }, isLoaded: function () { return this._isLoaded }, loadDropDown: function (u) { this._loadChildren(!0); this._isLoaded = !0; u() }, destroy: function (u) { this.dropDown && !this.dropDown._destroyed && (this.dropDown.destroyRecursive(u), delete this.dropDown); a.hide(this.domNode); this.inherited(arguments) }, _onFocus: function () { this.validate(!0) }, _onBlur: function () { a.hide(this.domNode); this.inherited(arguments); this.validate(!1) }
                                        });
                                        n("dojo-bidi") && (m = q("dijit.form.Select", m, { _setDisplay: function (u) { this.inherited(arguments); this.applyTextDir(this.containerNode) } })); m._Menu = t; m.prototype._onContainerKeydown = B("_onContainerKeydown"); m.prototype._onContainerKeypress = B("_onContainerKeypress"); return m
                                })
                }, "dijit/form/_FormSelectWidget": function () {
                        define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                        return m("dijit.form._FormSelectWidget", g, {
                                                multiple: !1, options: null, store: null, _setStoreAttr: function (b) { this._created && this._deprecatedSetStore(b) }, query: null, _setQueryAttr: function (b) { this._created && this._deprecatedSetStore(this.store, this.selectedValue, { query: b }) }, queryOptions: null, _setQueryOptionsAttr: function (b) { this._created && this._deprecatedSetStore(this.store, this.selectedValue, { queryOptions: b }) }, labelAttr: "", onFetch: null, sortByLabel: !0, loadChildrenOnOpen: !1,
                                                onLoadDeferred: null, getOptions: function (b) { var e = this.options || []; if (null == b) return e; if (k.isArrayLike(b)) return E.map(b, "return this.getOptions(item);", this); k.isString(b) && (b = { value: b }); k.isObject(b) && (E.some(e, function (a, f) { for (var h in b) if (!(h in a) || a[h] != b[h]) return !1; b = f; return !0 }) || (b = -1)); return 0 <= b && b < e.length ? e[b] : null }, addOption: function (b) { E.forEach(k.isArrayLike(b) ? b : [b], function (e) { e && k.isObject(e) && this.options.push(e) }, this); this._loadChildren() }, removeOption: function (b) {
                                                        b = this.getOptions(k.isArrayLike(b) ?
                                                                b : [b]); E.forEach(b, function (e) { e && (this.options = E.filter(this.options, function (a) { return a.value !== e.value || a.label !== e.label }), this._removeOptionItem(e)) }, this); this._loadChildren()
                                                }, updateOption: function (b) { E.forEach(k.isArrayLike(b) ? b : [b], function (e) { var a = this.getOptions({ value: e.value }), f; if (a) for (f in e) a[f] = e[f] }, this); this._loadChildren() }, setStore: function (b, e, a) {
                                                        l.deprecated(this.declaredClass + "::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
                                                                "", "2.0"); this._deprecatedSetStore(b, e, a)
                                                }, _deprecatedSetStore: function (b, e, a) {
                                                        var f = this.store; a = a || {}; if (f !== b) {
                                                                for (var h; h = this._notifyConnections.pop();)h.remove(); b.get || (k.mixin(b, {
                                                                        _oldAPI: !0, get: function (p) { var B = new q; this.fetchItemByIdentity({ identity: p, onItem: function (t) { B.resolve(t) }, onError: function (t) { B.reject(t) } }); return B.promise }, query: function (p, B) {
                                                                                var t = new q(function () { u.abort && u.abort() }); t.total = new q; var u = this.fetch(k.mixin({
                                                                                        query: p, onBegin: function (z) { t.total.resolve(z) },
                                                                                        onComplete: function (z) { t.resolve(z) }, onError: function (z) { t.reject(z) }
                                                                                }, B)); return new c(t)
                                                                        }
                                                                }), b.getFeatures()["dojo.data.api.Notification"] && (this._notifyConnections = [A.after(b, "onNew", k.hitch(this, "_onNewItem"), !0), A.after(b, "onDelete", k.hitch(this, "_onDeleteItem"), !0), A.after(b, "onSet", k.hitch(this, "_onSetItem"), !0)])); this._set("store", b)
                                                        } this.options && this.options.length && this.removeOption(this.options); this._queryRes && this._queryRes.close && this._queryRes.close(); this._observeHandle && this._observeHandle.remove &&
                                                                (this._observeHandle.remove(), this._observeHandle = null); a.query && this._set("query", a.query); a.queryOptions && this._set("queryOptions", a.queryOptions); b && b.query && (this._loadingStore = !0, this.onLoadDeferred = new q, this._queryRes = b.query(this.query, this.queryOptions), d(this._queryRes, k.hitch(this, function (p) {
                                                                        if (this.sortByLabel && !a.sort && p.length) if (b.getValue) p.sort(w.createSortFunction([{ attribute: b.getLabelAttributes(p[0])[0] }], b)); else {
                                                                                var B = this.labelAttr; p.sort(function (t, u) {
                                                                                        return t[B] > u[B] ? 1 : u[B] >
                                                                                                t[B] ? -1 : 0
                                                                                })
                                                                        } a.onFetch && (p = a.onFetch.call(this, p, a)); E.forEach(p, function (t) { this._addOptionForItem(t) }, this); this._queryRes.observe && (this._observeHandle = this._queryRes.observe(k.hitch(this, function (t, u, z) { u == z ? this._onSetItem(t) : (-1 != u && this._onDeleteItem(t), -1 != z && this._onNewItem(t)) }), !0)); this._loadingStore = !1; this.set("value", "_pendingValue" in this ? this._pendingValue : e); delete this._pendingValue; this.loadChildrenOnOpen ? this._pseudoLoadChildren(p) : this._loadChildren(); this.onLoadDeferred.resolve(!0);
                                                                        this.onSetStore()
                                                                }), k.hitch(this, function (p) { console.error("dijit.form.Select: " + p.toString()); this.onLoadDeferred.reject(p) }))); return f
                                                }, _setValueAttr: function (b, e) {
                                                        this._onChangeActive || (e = null); if (this._loadingStore) this._pendingValue = b; else if (null != b) {
                                                                b = k.isArrayLike(b) ? E.map(b, function (h) { return k.isObject(h) ? h : { value: h } }) : k.isObject(b) ? [b] : [{ value: b }]; b = E.filter(this.getOptions(b), function (h) { return h && h.value }); var a = this.getOptions() || []; this.multiple || b[0] && b[0].value || !a.length || (b[0] =
                                                                        a[0]); E.forEach(a, function (h) { h.selected = E.some(b, function (p) { return p.value === h.value }) }); a = E.map(b, function (h) { return h.value }); if ("undefined" != typeof a && "undefined" != typeof a[0]) { var f = E.map(b, function (h) { return h.label }); this._setDisplay(this.multiple ? f : f[0]); this.inherited(arguments, [this.multiple ? a : a[0], e]); this._updateSelection() }
                                                        }
                                                }, _getDisplayedValueAttr: function () {
                                                        var b = E.map([].concat(this.get("selectedOptions")), function (e) { return e && "label" in e ? e.label : e ? e.value : null }, this); return this.multiple ?
                                                                b : b[0]
                                                }, _setDisplayedValueAttr: function (b) { this.set("value", this.getOptions("string" == typeof b ? { label: b } : b)) }, _loadChildren: function () { this._loadingStore || (E.forEach(this._getChildren(), function (b) { b.destroyRecursive() }), E.forEach(this.options, this._addOptionItem, this), this._updateSelection()) }, _updateSelection: function () {
                                                        this.focusedChild = null; this._set("value", this._getValueFromOpts()); var b = [].concat(this.value); if (b && b[0]) {
                                                                var e = this; E.forEach(this._getChildren(), function (a) {
                                                                        var f = E.some(b, function (h) {
                                                                                return a.option &&
                                                                                        h === a.option.value
                                                                        }); f && !e.multiple && (e.focusedChild = a); r.toggle(a.domNode, this.baseClass.replace(/\s+|$/g, "SelectedOption "), f); a.domNode.setAttribute("aria-selected", f ? "true" : "false")
                                                                }, this)
                                                        }
                                                }, _getValueFromOpts: function () { var b = this.getOptions() || []; if (!this.multiple && b.length) { var e = E.filter(b, function (a) { return a.selected })[0]; if (e && e.value) return e.value; b[0].selected = !0; return b[0].value } return this.multiple ? E.map(E.filter(b, function (a) { return a.selected }), function (a) { return a.value }) || [] : "" },
                                                _onNewItem: function (b, e) { e && e.parent || this._addOptionForItem(b) }, _onDeleteItem: function (b) { this.removeOption({ value: this.store.getIdentity(b) }) }, _onSetItem: function (b) { this.updateOption(this._getOptionObjForItem(b)) }, _getOptionObjForItem: function (b) { var e = this.store, a = this.labelAttr && this.labelAttr in b ? b[this.labelAttr] : e.getLabel(b); return { value: a ? e.getIdentity(b) : null, label: a, item: b } }, _addOptionForItem: function (b) {
                                                        var e = this.store; e.isItemLoaded && !e.isItemLoaded(b) ? e.loadItem({
                                                                item: b, onItem: function (a) { this._addOptionForItem(a) },
                                                                scope: this
                                                        }) : (b = this._getOptionObjForItem(b), this.addOption(b))
                                                }, constructor: function (b) { this._oValue = (b || {}).value || null; this._notifyConnections = [] }, buildRendering: function () { this.inherited(arguments); v.setSelectable(this.focusNode, !1) }, _fillContent: function () {
                                                        this.options || (this.options = this.srcNodeRef ? n("\x3e *", this.srcNodeRef).map(function (b) {
                                                                return "separator" === b.getAttribute("type") ? { value: "", label: "", selected: !1, disabled: !1 } : {
                                                                        value: b.getAttribute("data-" + l._scopeName + "-value") || b.getAttribute("value"),
                                                                        label: String(b.innerHTML), selected: b.getAttribute("selected") || !1, disabled: b.getAttribute("disabled") || !1
                                                                }
                                                        }, this) : []); this.value ? this.multiple && "string" == typeof this.value && this._set("value", this.value.split(",")) : this._set("value", this._getValueFromOpts())
                                                }, postCreate: function () {
                                                        this.inherited(arguments); A.after(this, "onChange", k.hitch(this, "_updateSelection")); var b = this.store; b && (b.getIdentity || b.getFeatures()["dojo.data.api.Identity"]) && (this.store = null, this._deprecatedSetStore(b, this._oValue,
                                                                { query: this.query, queryOptions: this.queryOptions })); this._storeInitialized = !0
                                                }, startup: function () { this._loadChildren(); this.inherited(arguments) }, destroy: function () { for (var b; b = this._notifyConnections.pop();)b.remove(); this._queryRes && this._queryRes.close && this._queryRes.close(); this._observeHandle && this._observeHandle.remove && (this._observeHandle.remove(), this._observeHandle = null); this.inherited(arguments) }, _addOptionItem: function () { }, _removeOptionItem: function () { }, _setDisplay: function () { }, _getChildren: function () { return [] },
                                                _getSelectedOptionsAttr: function () { return this.getOptions({ selected: !0 }) }, _pseudoLoadChildren: function () { }, onSetStore: function () { }
                                        })
                                })
                }, "dijit/DropDownMenu": function () {
                        define(["dojo/_base/declare", "dojo/keys", "dojo/text!./templates/Menu.html", "./_MenuBase"], function (E, q, A, w) {
                                return E("dijit.DropDownMenu", w, {
                                        templateString: A, baseClass: "dijitMenu", _onUpArrow: function () { this.focusPrev() }, _onDownArrow: function () { this.focusNext() }, _onRightArrow: function (m) { this._moveToPopup(m); m.stopPropagation(); m.preventDefault() },
                                        _onLeftArrow: function (m) { if (this.parentMenu) if (this.parentMenu._isMenuBar) this.parentMenu.focusPrev(); else this.onCancel(!1); else m.stopPropagation(), m.preventDefault() }
                                })
                        })
                }, "dijit/_MenuBase": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                return q("dijit._MenuBase", [c,
                                        e, b, g], {
                                                selected: null, _setSelectedAttr: function (a) { this.selected != a && (this.selected && (this.selected._setSelected(!1), this._onChildDeselect(this.selected)), a && a._setSelected(!0), this._set("selected", a)) }, activated: !1, _setActivatedAttr: function (a) { m.toggle(this.domNode, "dijitMenuActive", a); m.toggle(this.domNode, "dijitMenuPassive", !a); this._set("activated", a) }, parentMenu: null, popupDelay: 500, passivePopupDelay: Infinity, autoFocus: !1, childSelector: function (a) {
                                                        var f = d.byNode(a); return a.parentNode == this.containerNode &&
                                                                f && f.focus
                                                }, postCreate: function () {
                                                        var a = this, f = "string" == typeof this.childSelector ? this.childSelector : v.hitch(this, "childSelector"); this.own(l(this.containerNode, l.selector(f, r.enter), function () { a.onItemHover(d.byNode(this)) }), l(this.containerNode, l.selector(f, r.leave), function () { a.onItemUnhover(d.byNode(this)) }), l(this.containerNode, l.selector(f, n), function (h) { a.onItemClick(d.byNode(this), h); h.stopPropagation() }), l(this.containerNode, l.selector(f, "focusin"), function () { a._onItemFocus(d.byNode(this)) }));
                                                        this.inherited(arguments)
                                                }, onKeyboardSearch: function (a, f, h, p) { this.inherited(arguments); if (a && (-1 == p || a.popup && 1 == p)) this.onItemClick(a, f) }, _keyboardSearchCompare: function (a, f) { return a.shortcutKey ? f == a.shortcutKey.toLowerCase() ? -1 : 0 : this.inherited(arguments) ? 1 : 0 }, onExecute: function () { }, onCancel: function () { }, _moveToPopup: function (a) { if (this.focusedChild && this.focusedChild.popup && !this.focusedChild.disabled) this.onItemClick(this.focusedChild, a); else (a = this._getTopMenu()) && a._isMenuBar && a.focusNext() },
                                        _onPopupHover: function () { this.set("selected", this.currentPopupItem); this._stopPendingCloseTimer() }, onItemHover: function (a) {
                                                this.activated ? (this.set("selected", a), !a.popup || a.disabled || this.hover_timer || (this.hover_timer = this.defer(function () { this._openItemPopup(a) }, this.popupDelay))) : Infinity > this.passivePopupDelay && (this.passive_hover_timer && this.passive_hover_timer.remove(), this.passive_hover_timer = this.defer(function () { this.onItemClick(a, { type: "click" }) }, this.passivePopupDelay)); this._hoveredChild =
                                                        a; a._set("hovering", !0)
                                        }, _onChildDeselect: function (a) { this._stopPopupTimer(); this.currentPopupItem == a && (this._stopPendingCloseTimer(), this._pendingClose_timer = this.defer(function () { this.currentPopupItem = this._pendingClose_timer = null; a._closePopup() }, this.popupDelay)) }, onItemUnhover: function (a) { this._hoveredChild == a && (this._hoveredChild = null); this.passive_hover_timer && (this.passive_hover_timer.remove(), this.passive_hover_timer = null); a._set("hovering", !1) }, _stopPopupTimer: function () {
                                                this.hover_timer &&
                                                (this.hover_timer = this.hover_timer.remove())
                                        }, _stopPendingCloseTimer: function () { this._pendingClose_timer && (this._pendingClose_timer = this._pendingClose_timer.remove()) }, _getTopMenu: function () { for (var a = this; a.parentMenu; a = a.parentMenu); return a }, onItemClick: function (a, f) {
                                                this.passive_hover_timer && this.passive_hover_timer.remove(); this.focusChild(a); if (a.disabled) return !1; a.popup ? (this.set("selected", a), this.set("activated", !0), f = /^key/.test(f._origType || f.type) || 0 == f.clientX && 0 == f.clientY, this._openItemPopup(a,
                                                        f)) : (this.onExecute(), a._onClick ? a._onClick(f) : a.onClick(f))
                                        }, _openItemPopup: function (a, f) {
                                                if (a != this.currentPopupItem) {
                                                        this.currentPopupItem && (this._stopPendingCloseTimer(), this.currentPopupItem._closePopup()); this._stopPopupTimer(); var h = a.popup; h.parentMenu = this; this.own(this._mouseoverHandle = l.once(h.domNode, "mouseover", v.hitch(this, "_onPopupHover"))); var p = this; a._openPopup({
                                                                parent: this, orient: this._orient || ["after", "before"], onCancel: function () { f && p.focusChild(a); p._cleanUp() }, onExecute: v.hitch(this,
                                                                        "_cleanUp", !0), onClose: function () { p._mouseoverHandle && (p._mouseoverHandle.remove(), delete p._mouseoverHandle) }
                                                        }, f); this.currentPopupItem = a
                                                }
                                        }, onOpen: function () { this.isShowingNow = !0; this.set("activated", !0) }, onClose: function () { this.set("activated", !1); this.set("selected", null); this.isShowingNow = !1; this.parentMenu = null }, _closeChild: function () {
                                                this._stopPopupTimer(); this.currentPopupItem && (this.focused && (w.set(this.selected.focusNode, "tabIndex", this.tabIndex), this.selected.focusNode.focus()), this.currentPopupItem._closePopup(),
                                                        this.currentPopupItem = null)
                                        }, _onItemFocus: function (a) { if (this._hoveredChild && this._hoveredChild != a) this.onItemUnhover(this._hoveredChild); this.set("selected", a) }, _onBlur: function () { this._cleanUp(!0); this.inherited(arguments) }, _cleanUp: function (a) { this._closeChild(); "undefined" == typeof this.isShowingNow && this.set("activated", !1); a && this.set("selected", null) }
                                })
                        })
                }, "dijit/_KeyNavContainer": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        return q("dijit._KeyNavContainer", [k, n, l], {
                                                connectKeyNavHandlers: function (d, c) { var g = this._keyNavCodes = {}, b = v.hitch(this, "focusPrev"), e = v.hitch(this, "focusNext"); E.forEach(d, function (a) { g[a] = b }); E.forEach(c, function (a) { g[a] = e }); g[m.HOME] = v.hitch(this, "focusFirstChild"); g[m.END] = v.hitch(this, "focusLastChild") }, startupKeyNavChildren: function () { w.deprecated("startupKeyNavChildren() call no longer needed", "", "2.0") }, startup: function () {
                                                        this.inherited(arguments); E.forEach(this.getChildren(),
                                                                v.hitch(this, "_startupChild"))
                                                }, addChild: function (d, c) { this.inherited(arguments); this._startupChild(d) }, _startupChild: function (d) { d.set("tabIndex", "-1") }, _getFirst: function () { var d = this.getChildren(); return d.length ? d[0] : null }, _getLast: function () { var d = this.getChildren(); return d.length ? d[d.length - 1] : null }, focusNext: function () { this.focusChild(this._getNextFocusableChild(this.focusedChild, 1)) }, focusPrev: function () { this.focusChild(this._getNextFocusableChild(this.focusedChild, -1), !0) }, childSelector: function (d) {
                                                        return (d =
                                                                r.byNode(d)) && d.getParent() == this
                                                }
                                        })
                                })
                }, "dijit/_KeyNavMixin": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "), function (E, q, A, w, m, v, r, l) {
                                return q("dijit._KeyNavMixin", l, {
                                        tabIndex: "0", childSelector: null, postCreate: function () {
                                                this.inherited(arguments); A.set(this.domNode, "tabIndex", this.tabIndex); if (!this._keyNavCodes) {
                                                        var k = this._keyNavCodes = {}; k[w.HOME] = m.hitch(this, "focusFirstChild"); k[w.END] = m.hitch(this,
                                                                "focusLastChild"); k[this.isLeftToRight() ? w.LEFT_ARROW : w.RIGHT_ARROW] = m.hitch(this, "_onLeftArrow"); k[this.isLeftToRight() ? w.RIGHT_ARROW : w.LEFT_ARROW] = m.hitch(this, "_onRightArrow"); k[w.UP_ARROW] = m.hitch(this, "_onUpArrow"); k[w.DOWN_ARROW] = m.hitch(this, "_onDownArrow")
                                                } var n = this; k = "string" == typeof this.childSelector ? this.childSelector : m.hitch(this, "childSelector"); this.own(v(this.domNode, "keypress", m.hitch(this, "_onContainerKeypress")), v(this.domNode, "keydown", m.hitch(this, "_onContainerKeydown")), v(this.domNode,
                                                        "focus", m.hitch(this, "_onContainerFocus")), v(this.containerNode, v.selector(k, "focusin"), function (d) { n._onChildFocus(r.getEnclosingWidget(this), d) }))
                                        }, _onLeftArrow: function () { }, _onRightArrow: function () { }, _onUpArrow: function () { }, _onDownArrow: function () { }, focus: function () { this.focusFirstChild() }, _getFirstFocusableChild: function () { return this._getNextFocusableChild(null, 1) }, _getLastFocusableChild: function () { return this._getNextFocusableChild(null, -1) }, focusFirstChild: function () { this.focusChild(this._getFirstFocusableChild()) },
                                        focusLastChild: function () { this.focusChild(this._getLastFocusableChild()) }, focusChild: function (k, n) { k && (this.focusedChild && k !== this.focusedChild && this._onChildBlur(this.focusedChild), k.set("tabIndex", this.tabIndex), k.focus(n ? "end" : "start")) }, _onContainerFocus: function (k) { k.target !== this.domNode || this.focusedChild || this.focus() }, _onFocus: function () { A.set(this.domNode, "tabIndex", "-1"); this.inherited(arguments) }, _onBlur: function (k) {
                                                A.set(this.domNode, "tabIndex", this.tabIndex); this.focusedChild && (this.focusedChild.set("tabIndex",
                                                        "-1"), this.lastFocusedChild = this.focusedChild, this._set("focusedChild", null)); this.inherited(arguments)
                                        }, _onChildFocus: function (k) { k && k != this.focusedChild && (this.focusedChild && !this.focusedChild._destroyed && this.focusedChild.set("tabIndex", "-1"), k.set("tabIndex", this.tabIndex), this.lastFocused = k, this._set("focusedChild", k)) }, _searchString: "", multiCharSearchDuration: 1E3, onKeyboardSearch: function (k, n, d, c) { k && this.focusChild(k) }, _keyboardSearchCompare: function (k, n) {
                                                var d = k.domNode; k = (k.label || (d.focusNode ?
                                                        d.focusNode.label : "") || d.innerText || d.textContent || "").replace(/^\s+/, "").substr(0, n.length).toLowerCase(); return n.length && k == n ? -1 : 0
                                        }, _isFormElement: function (k) { return "INPUT" === k.tagName || "TEXTAREA" === k.tagName || "SELECT" === k.tagName || "BUTTON" === k.tagName }, _onContainerKeydown: function (k) {
                                                if (!this._isFormElement(document.activeElement)) {
                                                        var n = this._keyNavCodes[k.keyCode]; n ? (n(k, this.focusedChild), k.stopPropagation(), k.preventDefault(), this._searchString = "") : k.keyCode != w.SPACE || !this._searchTimer ||
                                                                k.ctrlKey || k.altKey || k.metaKey || (k.stopImmediatePropagation(), k.preventDefault(), this._keyboardSearch(k, " "))
                                                }
                                        }, _onContainerKeypress: function (k) { this._isFormElement(document.activeElement) || k.charCode <= w.SPACE || k.ctrlKey || k.altKey || k.metaKey || (k.preventDefault(), k.stopPropagation(), this._keyboardSearch(k, String.fromCharCode(k.charCode).toLowerCase())) }, _keyboardSearch: function (k, n) {
                                                var d = null, c, g = 0; m.hitch(this, function () {
                                                        this._searchTimer && this._searchTimer.remove(); this._searchString += n; var b = /^(.)\1*$/.test(this._searchString) ?
                                                                1 : this._searchString.length; c = this._searchString.substr(0, b); this._searchTimer = this.defer(function () { this._searchTimer = null; this._searchString = "" }, this.multiCharSearchDuration); var e = this.focusedChild || null; if (1 == b || !e) if (e = this._getNextFocusableChild(e, 1), !e) return; b = e; do { var a = this._keyboardSearchCompare(e, c); a && 0 == g++ && (d = e); if (-1 == a) { g = -1; break } e = this._getNextFocusableChild(e, 1) } while (e && e != b)
                                                })(); this.onKeyboardSearch(d, k, c, g)
                                        }, _onChildBlur: function () { }, _getNextFocusableChild: function (k, n) {
                                                var d =
                                                        k; do { if (k) k = this._getNext(k, n); else if (k = this[0 < n ? "_getFirst" : "_getLast"](), !k) break; if (null != k && k != d && k.isFocusable()) return k } while (k != d); return null
                                        }, _getFirst: function () { return null }, _getLast: function () { return null }, _getNext: function (k, n) { if (k) for (k = k.domNode; k;)if ((k = k[0 > n ? "previousSibling" : "nextSibling"]) && "getAttribute" in k) { var d = r.byNode(k); if (d) return d } return null }
                                })
                        })
                }, "dijit/MenuItem": function () {
                        define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                        r = E("dijit.MenuItem" + (v("dojo-bidi") ? "_NoBidi" : ""), [l, k, n, d], {
                                                templateString: c, baseClass: "dijitMenuItem", label: "", _setLabelAttr: function (g) { this._set("label", g); var b = ""; var e = g.search(/{\S}/); if (0 <= e) { b = g.charAt(e + 1); var a = g.substr(0, e); g = g.substr(e + 3); e = a + b + g; g = a + '\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e' + b + "\x3c/span\x3e" + g } else e = g; this.domNode.setAttribute("aria-label", e + " " + this.accelKey); this.containerNode.innerHTML = g; this._set("shortcutKey", b) }, iconClass: "dijitNoIcon",
                                                _setIconClassAttr: { node: "iconNode", type: "class" }, accelKey: "", disabled: !1, _fillContent: function (g) { !g || "label" in this.params || this._set("label", g.innerHTML) }, buildRendering: function () { this.inherited(arguments); A.set(this.containerNode, "id", this.id + "_text"); this.accelKeyNode && A.set(this.accelKeyNode, "id", this.id + "_accel"); q.setSelectable(this.domNode, !1) }, onClick: function () { }, focus: function () { try { 8 == v("ie") && this.containerNode.focus(), this.focusNode.focus() } catch (g) { } }, _setSelected: function (g) {
                                                        w.toggle(this.domNode,
                                                                "dijitMenuItemSelected", g)
                                                }, setLabel: function (g) { m.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.", "", "2.0"); this.set("label", g) }, setDisabled: function (g) { m.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.", "", "2.0"); this.set("disabled", g) }, _setDisabledAttr: function (g) { this.focusNode.setAttribute("aria-disabled", g ? "true" : "false"); this._set("disabled", g) }, _setAccelKeyAttr: function (g) {
                                                        this.accelKeyNode && (this.accelKeyNode.style.display =
                                                                g ? "" : "none", this.accelKeyNode.innerHTML = g, A.set(this.containerNode, "colSpan", g ? "1" : "2")); this._set("accelKey", g)
                                                }
                                        }); v("dojo-bidi") && (r = E("dijit.MenuItem", r, { _setLabelAttr: function (g) { this.inherited(arguments); "auto" === this.textDir && this.applyTextDir(this.textDirNode) } })); return r
                                })
                }, "dijit/_Contained": function () {
                        define(["dojo/_base/declare", "./registry"], function (E, q) {
                                return E("dijit._Contained", null, {
                                        _getSibling: function (A) {
                                                var w = this.getParent(); return w && w._getSiblingOfChild && w._getSiblingOfChild(this,
                                                        "previous" == A ? -1 : 1) || null
                                        }, getPreviousSibling: function () { return this._getSibling("previous") }, getNextSibling: function () { return this._getSibling("next") }, getIndexInParent: function () { var A = this.getParent(); return A && A.getIndexOfChild ? A.getIndexOfChild(this) : -1 }
                                })
                        })
                }, "dijit/MenuSeparator": function () {
                        define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "), function (E, q, A, w, m, v) {
                                return E("dijit.MenuSeparator", [A, w, m], {
                                        templateString: v,
                                        buildRendering: function () { this.inherited(arguments); q.setSelectable(this.domNode, !1) }, isFocusable: function () { return !1 }
                                })
                        })
                }, "jimu/dijit/LoadingIndicator": function () {
                        define(["dojo/_base/declare", "dijit/_WidgetBase", "dojo/dom-style", "dojo/dom-construct"], function (E, q, A, w) {
                                return E(q, {
                                        baseClass: "jimu-loading-indicator jimu-agol-loading", declaredClass: "jimu.dijit.LoadingIndicator", hidden: !1, postCreate: function () {
                                                this.inherited(arguments); (this.hidden = !0 === this.hidden) && A.set(this.domNode, { display: "none" });
                                                A.set(this.domNode, { width: "100%", height: "100%" }); w.place(' \x3cdiv class\x3d"loading-container"\x3e\x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"img-div"\x3e\x3c/div\x3e\x3c/div\x3e', this.domNode)
                                        }, show: function () { this.domNode && this.hidden && (A.set(this.domNode, "display", "block"), this.hidden = !1) }, hide: function () { this.domNode && !this.hidden && (A.set(this.domNode, "display", "none"), this.hidden = !0) }
                                })
                        })
                }, "jimu/statisticsUtils": function () {
                        define("dojo/_base/array dojo/when esri/tasks/StatisticDefinition esri/tasks/QueryTask esri/tasks/query esri/lang jimu/utils jimu/LayerInfos/LayerInfos exports".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        function n(h) {
                                                var p = new m; p.outFields = [h.fieldName]; p.outStatistics = []; p.geometry = h.geometry; var B = c(h); E.forEach(B, function (t) { var u = new A; u.statisticType = t; u.displayFeildName = h.fieldName; u.onStatisticField = h.fieldName; u.outStatisticFieldName = f[t]; p.outStatistics.push(u) }); p.where = h.filterExpression ? h.filterExpression : h.layer.getDefinitionExpression() ? h.layer.getDefinitionExpression() : "1\x3d1"; h.geometry && (p.geometry = h.geometry); return (new w(h.layer.url)).execute(p).then(function (t) {
                                                        return t &&
                                                                t.features && 0 < t.features.length ? (t = t.features[0].attributes, e(h, t), t) : []
                                                })
                                        } function d(h) {
                                                var p = { countField: 0, sumField: 0 }, B = c(h), t = 0, u = 0; h.featureSet.features.forEach(function (x) {
                                                        var y = x.attributes[h.fieldName]; null !== y && "undefined" !== typeof y && B.forEach(function (D) {
                                                                switch (D) {
                                                                        case "count": p.countField++; break; case "sum": p.sumField += y; break; case "min": p.minField = "undefined" === typeof p.minField ? y : Math.min(p.minField, y); break; case "max": p.maxField = "undefined" === typeof p.maxField ? y : Math.max(p.maxField,
                                                                                y); break; case "avg": t++, u += y
                                                                }
                                                        })
                                                }); p.avgField = 0 === t ? 0 : 0 === t ? "" : u / t; var z = h.featureSet.features.filter(function (x) { x = x.attributes[h.fieldName]; return null === x || "undefined" === typeof x ? !1 : !0 }).map(function (x) { return x.attributes[h.fieldName] }); p.stddevField = g(z); e(h, p); return p
                                        } function c(h) { return h.statisticTypes && 0 < h.statisticTypes.length ? a.filter(function (p) { return -1 < h.statisticTypes.indexOf(p) }) : a } function g(h) {
                                                var p = h.length; if (1 >= p) return 0; var B = 0; h.forEach(function (z) { B += z }); var t = B / p, u = 0; h.forEach(function (z) {
                                                        u +=
                                                        Math.pow(z - t, 2)
                                                }); return Math.sqrt(1 / (p - 1) * u)
                                        } function b(h) { var p = l.getInstanceSync(); return h.layer ? p.getLayerOrTableInfoById(h.layer.id).loadInfoTemplate().then(function (B) { var t = {}; B.info && B.info.fieldInfos && B.info.fieldInfos.forEach(function (u) { t[u.fieldName] = u }); return t }) : q({}) } function e(h, p) { if (h.fieldInfos && h.fieldInfos[h.fieldName]) for (var B in p) "countField" !== B && v.isDefined(p[B]) && (p[B] = null === p[B] || "undefined" === typeof p[B] ? "" : r.localizeNumberByFieldInfo(p[B], h.fieldInfos[h.fieldName])) }
                                        var a = "count sum min max avg stddev".split(" "), f = { count: "countField", sum: "sumField", min: "minField", max: "maxField", avg: "avgField", stddev: "stddevField" }; k.getStatisticsResult = function (h) { return b(h).then(function (p) { h.fieldInfos = p; if (h.featureSet) return q(d(h)); if (h.layer) { if (h.layer.url) return n(h); h.featureSet = r.toFeatureSet(h.layer.graphics); return q(d(h)) } }) }; k.isStatFromServer = function (h) { return h.layer && h.layer.url }; k.getStddevVal = g; k.getStatisticsResultFromClientSync = d
                                })
                }, "jimu/featureActions/CreateLayer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/json dojo/on esri/layers/FeatureLayer esri/renderers/jsonUtils esri/symbols/jsonUtils ../BaseFeatureAction jimu/dijit/Popup jimu/dijit/Search jimu/LayerInfos/LayerInfos jimu/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                        return E(n, {
                                                name: "CreateLayer", iconClass: "icon-create-layer", isFeatureSupported: function (e, a) { return 0 < e.features.length && e.features[0].geometry && a && a.geometryType && a.fields && a.objectIdField }, onExecute: function (e, a) {
                                                        var f; e = { layerDefinition: { geometryType: a.geometryType, fields: A.map(a.fields, function (h) { return h.toJSON() }), objectIdField: a.objectIdField }, featureSet: e.toJson() }; e = new r(e); (f = a._json ? m.parse(a._json) : null) && f.drawingInfo && f.drawingInfo.renderer ? (f =
                                                                f.drawingInfo.renderer, f = l.fromJson(f)) : f = l.fromJson(a.renderer.toJson()); e.setRenderer(f); (a = a.getSelectionSymbol()) && e.setSelectionSymbol(k.fromJson(a.toJson())); this._popupAddLayer(e)
                                                }, _popupAddLayer: function (e) {
                                                        var a = w.create("div", { style: "padding: 0 10px 0 10px;" }), f = (new c({ placeholder: window.jimuNls.layerInfosMenu.labelLayer })).placeAt(a); w.setStyle(f.searchBtn, "display", "none"); var h = new d({
                                                                content: a, titleLabel: window.jimuNls.featureActions.CreateLayer, width: 525, height: 180, buttons: [{
                                                                        label: window.jimuNls.common.ok,
                                                                        onClick: q.hitch(this, function () { e.name = b.stripHTML(f.getValue()); this._addLayerToMap(e); h.close(); p && p.remove && p.remove() })
                                                                }, { label: window.jimuNls.common.cancel, classNames: ["jimu-btn-vacation"], onClick: q.hitch(this, function () { h.close(); p && p.remove && p.remove() }) }]
                                                        }); f.inputSearch.focus(); h.disableButton(0); var p = v(f.inputSearch, "keyup", function () { f.getValue() ? h.enableButton(0) : h.disableButton(0) })
                                                }, _addLayerToMap: function (e) {
                                                        var a = g.getInstanceSync(), f = v(a, "layerInfosChanged", q.hitch(this, function (h) {
                                                                e.id ===
                                                                h.id && (h.enablePopup(), f.remove())
                                                        })); this.map.addLayer(e)
                                                }
                                        })
                                })
                }, "jimu/dijit/Search": function () {
                        define("dojo/_base/declare dojo/_base/html dojo/string dojo/keys dijit/_WidgetBase dijit/_TemplatedMixin".split(" "), function (E, q, A, w, m, v) {
                                return E([m, v], {
                                        baseClass: "jimu-search", declaredClass: "jimu.dijit.Search", templateString: '\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn jimu-icon jimu-icon-search" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',
                                        placeholder: "", onSearch: null, searchWhenInput: !1, postCreate: function () { this.inherited(arguments); this.placeholder && q.setAttr(this.inputSearch, "placeholder", this.placeholder) }, getValue: function () { return A.trim(this.inputSearch.value) }, doSearch: function () { if (this.onSearch) this.onSearch(this.getValue()) }, _onKeyDown: function (r) { this.doChange(); (void 0 !== r.keyCode ? r.keyCode : r.which) === w.ENTER && this.doSearch(); r.stopPropagation() }, _onKeyUp: function () { this.searchWhenInput && this.doSearch() }, _onBtnClick: function () { this.doSearch() },
                                        doChange: function () { if (this.onChange) this.onChange(this.getValue()) }
                                })
                        })
                }, "jimu/featureActions/AddMarker": function () {
                        define("dojo/_base/declare ../BaseFeatureAction esri/graphic esri/layers/GraphicsLayer esri/symbols/PictureMarkerSymbol esri/InfoTemplate jimu/shareUtils".split(" "), function (E, q, A, w, m, v, r) {
                                return E(q, {
                                        name: "AddMarker", iconClass: "icon-add", _markerLayer: null, isFeatureSupported: function (l) {
                                                this._getMarkerLayer(); return this._isSupportType(l) && 0 < l.features.length && l.features[0] && l.features[0].geometry &&
                                                        !1 === this._isFeatureInMarkerFeatureActionLayer(l)
                                        }, onExecute: function (l, k) { this._addMarker(l, k) }, _getMarkerLayer: function () { if (this.map.getLayer("marker-feature-action-layer")) this._markerLayer = this.map.getLayer("marker-feature-action-layer"); else if (this._markerLayer = new w({ id: "marker-feature-action-layer" }), this.map.addLayer(this._markerLayer), this.map.snappingManager) { var l = this.map.snappingManager.layerInfos; l.push({ layer: this._markerLayer }); this.map.snappingManager.setLayerInfos(l) } }, _addMarker: function (l,
                                                k) {
                                                        var n = l.features[0].geometry, d = {}; k = k.displayField || l.displayFieldName || k.objectIdField; d.title = ""; l.features[0].attributes && k && (d.title = l.features[0].attributes[k], d.title || (d.title = "")); k = {}; if ("point" === n.type) k = n; else if ("polygon" === n.type || "polyline" === n.type || "multipoint" === n.type) k = this.map.infoWindow && this.map.infoWindow.isShowing ? this.map.infoWindow.location : n.getExtent().getCenter(); k.getLongitude() && k.getLatitude() ? (d.longitude = k.getLongitude(), d.latitude = k.getLatitude()) : k.x && k.y &&
                                                                (d.x = k.x, d.y = k.y); var c = ""; n && n.spatialReference && n.spatialReference.wkid && (c = n.spatialReference.wkid); d.spatialReference = { wkid: c }; n = r.getXyContent(d); d = r.getShareUrl(this.map, d, !0); d = r.getShareUrlContent(d); d = n + d; n = new m(require.toUrl("jimu") + "/images/EsriBluePinCircle26.png"); n.width = 26; n.height = 26; n.setOffset(0, n.height / 2); k = new A(k, n, null, null); k._markerFeatureactionGraphic = l.features[0]; k.infoTemplate = this._setInfoTemplate(d); this._markerLayer.add(k); this._closePopupWindow()
                                        }, _setInfoTemplate: function (l) {
                                                var k =
                                                        new v; k.setContent(l); return k
                                        }, _closePopupWindow: function () { this.map && this.map.infoWindow && this.map.infoWindow.hide() }, _isFeatureInMarkerFeatureActionLayer: function (l) { return l.features[0] && l.features[0]._graphicsLayer && l.features[0]._graphicsLayer.id && "marker-feature-action-layer" === l.features[0]._graphicsLayer.id ? !0 : !1 }, _isSupportType: function (l) {
                                                if (l && l.geometryType) {
                                                        if (l.features && l.features.length && 1 < l.features.length) return !1; l = l.geometryType; return "point" === l || "polygon" === l || "polyline" ===
                                                                l || "multipoint" === l
                                                } return !1
                                        }
                                })
                        })
                }, "jimu/featureActions/RemoveMarker": function () {
                        define(["dojo/_base/declare", "../BaseFeatureAction", "esri/layers/GraphicsLayer"], function (E, q, A) {
                                return E(q, {
                                        name: "RemoveMarker", iconClass: "icon-close", _markerLayer: null, isFeatureSupported: function (w) { this._getMarkerLayer(); return 0 < w.features.length && w.geometryType && w.features[0] && w.features[0].geometry && !0 === this._isFeatureInMarkerFeatureActionLayer(w) }, onExecute: function (w) { this._removeMarker(w) }, _getMarkerLayer: function () {
                                                if (this.map.getLayer("marker-feature-action-layer")) this._markerLayer =
                                                        this.map.getLayer("marker-feature-action-layer"); else if (this._markerLayer = new A({ id: "marker-feature-action-layer" }), this.map.addLayer(this._markerLayer), this.map.snappingManager) { var w = this.map.snappingManager.layerInfos; w.push({ layer: this._markerLayer }); this.map.snappingManager.setLayerInfos(w) }
                                        }, _removeMarker: function (w) { w = w.features[0]; w._textSymbol && this._markerLayer.remove(w._textSymbol); this._markerLayer.remove(w); this.map && this.map.infoWindow && this.map.infoWindow.hide() }, _isFeatureInMarkerFeatureActionLayer: function (w) {
                                                return w.features[0] &&
                                                        w.features[0]._graphicsLayer && w.features[0]._graphicsLayer.id ? "marker-feature-action-layer" === w.features[0]._graphicsLayer.id : !1
                                        }
                                })
                        })
                }, "jimu/featureActions/SaveToMyContent": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/json dojo/Deferred esri/graphicsUtils esri/IdentityManager jimu/portalUtils jimu/portalUrlUtils jimu/Role jimu/dijit/Message ../BaseFeatureAction jimu/dijit/Popup jimu/dijit/AddItemForm".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                return E(c, {
                                        name: "SaveToMyContent",
                                        iconClass: "icon-save", isFeatureSupported: function (e) { return 0 >= e.features.length || !e.features[0].geometry ? !1 : !0 }, onExecute: function (e, a) {
                                                this.checkPrivilege().then(q.hitch(this, function (f) {
                                                        if (f) var h = new b({ appConfig: this.appConfig }), p = new g({
                                                                content: h, titleLabel: window.jimuNls.featureActions.SaveToMyContent, width: 525, height: 220, buttons: [{
                                                                        label: window.jimuNls.common.ok, onClick: q.hitch(this, function () {
                                                                                h.showBusy(); p.disableButton(0); h.validate().then(q.hitch(this, function (B) {
                                                                                        B.valid ? this._addItem(e,
                                                                                                a, h) : (h.hideBusy(), p.enableButton(0))
                                                                                }))
                                                                        })
                                                                }, { label: window.jimuNls.common.cancel, classNames: ["jimu-btn-vacation"], onClick: q.hitch(this, function () { p.close() }) }]
                                                        }); else new d({ message: window.jimuNls.noEditPrivileges })
                                                }))
                                        }, checkPrivilege: function () {
                                                var e = k.getStandardPortalUrl(this.appConfig.portalUrl), a = l.getPortal(e); if (a) {
                                                        if (a.haveSignIn()) return this._hasPrivilege(a); r.useSignInPage = !1; return a.signIn().then(q.hitch(this, function () { r.useSignInPage = !0; return this._hasPrivilege(a) }), q.hitch(this, function () {
                                                                r.useSignInPage =
                                                                !0
                                                        }))
                                                } e = new m; e.resolve(!1); return e
                                        }, _hasPrivilege: function (e) { return e.loadSelfInfo().then(q.hitch(this, function (a) { if (a && a.user) { var f = new n({ id: a.user.roleId ? a.user.roleId : a.user.role, role: a.user.role }); a.user.privileges && f.setPrivileges(a.user.privileges); return f.canCreateItem() && f.canPublishFeatures() } return !1 }), function () { return !1 }) }, _addItem: function (e, a, f) {
                                                var h = f.getName(), p = f.getFolderId(), B = f.popup; a = a || {}; var t = {
                                                        name: a.name || a.id, type: a.type || "Feature Layer", displayField: a.displayField,
                                                        description: a.description, copyrightText: a.copyright, geometryType: a.geometryType || e.geometryType, fields: a.fields || e.fields, objectIdField: a.objectIdField
                                                }; e.features[0].geometry && (a = v.graphicsExtent(e.features), t.initialExtent = a, t.fullExtent = a, t.extent = a); !t.objectIdField && t.fields && A.some(t.fields, function (u) { if ("esriFieldTypeOID" === u.type) return t.objectIdField = u.name, !0 }); e = { layers: [{ layerDefinition: t, featureSet: e.toJson() }] }; f.addItem({
                                                        name: h, title: h, type: "Feature Collection", typeKeywords: "WAB_created",
                                                        text: w.stringify(e)
                                                }, p).then(q.hitch(this, function (u) { !0 === u.success ? B.close() : (f.hideBusy(), B.enableButton(0), new d({ message: u.error ? u.error.message : "" })) }), function (u) { f.hideBusy(); B.enableButton(0); new d({ message: u.message }) })
                                        }
                                })
                        })
                }, "jimu/dijit/AddItemForm": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddItemForm.html jimu/portalUtils jimu/portalUrlUtils dojo/data/ItemFileWriteStore dijit/form/ValidationTextBox dijit/form/FilteringSelect jimu/dijit/LoadingShelter".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d) {
                                        return E([m, v, r], {
                                                baseClass: "jimu-item-form", templateString: l, appConfig: null, folderStore: null, portalUser: null, postMixInProperties: function () { this.nls = window.jimuNls.common }, postCreate: function () {
                                                        this.inherited(arguments); var c = n.getStandardPortalUrl(this.appConfig.portalUrl); k.getPortal(c).getUser().then(q.hitch(this, function (g) { this.portalUser = g; return g.getContent() })).then(q.hitch(this, function (g) {
                                                                this.folderStore = this._createFolderStore(g.folders, this.portalUser.username);
                                                                this.itemFolder.set("store", this.folderStore); this.itemFolder.set("required", !0); this.itemFolder.set("searchAttr", "name"); this.itemFolder.set("displayedValue", this.portalUser.username)
                                                        }))
                                                }, getName: function () { return this.itemName.get("value") }, getFolderId: function () { return this.itemFolder.item ? this.folderStore.getValue(this.itemFolder.item, "id") : "" }, showBusy: function () { this.shelter.show() }, hideBusy: function () { this.shelter.hide() }, validate: function () {
                                                        var c = new w; this.itemForm.validate() ? c.resolve({ valid: !0 }) :
                                                                c.resolve({ valid: !1, message: "param requried" }); return c
                                                }, addItem: function (c, g) { if (this.portalUser) return this.portalUser.addItem(c, g); c = new w; c.resolve({ error: { message: "portalUser is null" } }); return c }, _createFolderStore: function (c, g) { var b = new d({ data: { identifier: "id", label: "name", items: [] } }); b.newItem({ name: g, id: "" }); A.forEach(c, function (e) { b.newItem({ name: e.title, id: e.id }) }); return b }
                                        })
                                })
                }, "dijit/form/FilteringSelect": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/when", "./MappedTextBox",
                                "./ComboBoxMixin"], function (E, q, A, w, m) {
                                        return E("dijit.form.FilteringSelect", [w, m], {
                                                required: !0, _lastDisplayedValue: "", _isValidSubset: function () { return this._opened }, isValid: function () { return !!this.item || !this.required && "" == this.get("displayedValue") }, _refreshState: function () { this.searchTimer || this.inherited(arguments) }, _callbackSetLabel: function (v, r, l, k) {
                                                        r && r[this.searchAttr] !== this._lastQuery || !r && v.length && this.store.getIdentity(v[0]) != this._lastQuery || (v.length ? this.set("item", v[0], k) : this.set("value",
                                                                "", k || void 0 === k && !this.focused, this.textbox.value, null))
                                                }, _openResultList: function (v, r, l) { r[this.searchAttr] === this._lastQuery && (this.inherited(arguments), void 0 === this.item && this.validate(!0)) }, _getValueAttr: function () { return this.valueNode.value }, _getValueField: function () { return "value" }, _setValueAttr: function (v, r, l, k) {
                                                        this._onChangeActive || (r = null); if (void 0 === k) {
                                                                if (null === v || "" === v) if (v = "", !q.isString(l)) { this._setDisplayedValueAttr(l || "", r); return } var n = this; this._lastQuery = v; A(this.store.get(v),
                                                                        function (d) { n._callbackSetLabel(d ? [d] : [], void 0, void 0, r) })
                                                        } else this.valueNode.value = v, this.inherited(arguments, [v, r, l, k])
                                                }, _setItemAttr: function (v, r, l) { this.inherited(arguments); this._lastDisplayedValue = this.textbox.value }, _getDisplayQueryString: function (v) { return v.replace(/([\\\*\?])/g, "\\$1") }, _setDisplayedValueAttr: function (v, r) {
                                                        null == v && (v = ""); if (!this._created) { if (!("displayedValue" in this.params)) return; r = !1 } if (this.store) {
                                                                this.closeDropDown(); var l = q.clone(this.query), k = this._getDisplayQueryString(v);
                                                                if (this.store._oldAPI) var n = k; else n = this._patternToRegExp(k), n.toString = function () { return k }; this._lastQuery = l[this.searchAttr] = n; this._lastDisplayedValue = this.textbox.value = v; this._set("displayedValue", v); var d = this, c = { queryOptions: { ignoreCase: this.ignoreCase, deep: !0 } }; q.mixin(c, this.fetchProperties); this._fetchHandle = this.store.query(l, c); A(this._fetchHandle, function (g) { d._fetchHandle = null; d._callbackSetLabel(g || [], l, c, r) }, function (g) {
                                                                        d._fetchHandle = null; d._cancelingQuery || console.error("dijit.form.FilteringSelect: " +
                                                                                g.toString())
                                                                })
                                                        }
                                                }, undo: function () { this.set("displayedValue", this._lastDisplayedValue) }
                                        })
                                })
                }, "dijit/form/MappedTextBox": function () {
                        define(["dojo/_base/declare", "dojo/sniff", "dojo/dom-construct", "./ValidationTextBox"], function (E, q, A, w) {
                                return E("dijit.form.MappedTextBox", w, {
                                        postMixInProperties: function () { this.inherited(arguments); this.nameAttrSetting = "" }, _setNameAttr: "valueNode", serialize: function (m) { return m.toString ? m.toString() : "" }, toString: function () {
                                                var m = this.filter(this.get("value")); return null !=
                                                        m ? "string" == typeof m ? m : this.serialize(m, this.constraints) : ""
                                        }, validate: function () { this.valueNode.value = this.toString(); return this.inherited(arguments) }, buildRendering: function () { this.inherited(arguments); this.valueNode = A.place("\x3cinput type\x3d'hidden'" + (this.name && !q("msapp") ? ' name\x3d"' + this.name.replace(/"/g, "\x26quot;") + '"' : "") + "/\x3e", this.textbox, "after") }, reset: function () { this.valueNode.value = ""; this.inherited(arguments) }
                                })
                        })
                }, "dijit/form/ComboBoxMixin": function () {
                        define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        return E("dijit.form.ComboBoxMixin", [l, v], {
                                                dropDownClass: r, hasDownArrow: !0, templateString: k, baseClass: "dijitTextBox dijitComboBox", cssStateNodes: { _buttonNode: "dijitDownArrowButton" }, _setHasDownArrowAttr: function (n) { this._set("hasDownArrow", n); this._buttonNode.style.display = n ? "" : "none" }, _showResultList: function () { this.displayMessage(""); this.inherited(arguments) }, _setStoreAttr: function (n) {
                                                        n.get || w.mixin(n, {
                                                                _oldAPI: !0, get: function (d) {
                                                                        var c = new q; this.fetchItemByIdentity({
                                                                                identity: d,
                                                                                onItem: function (g) { c.resolve(g) }, onError: function (g) { c.reject(g) }
                                                                        }); return c.promise
                                                                }, query: function (d, c) { var g = new q(function () { b.abort && b.abort() }); g.total = new q; var b = this.fetch(w.mixin({ query: d, onBegin: function (e) { g.total.resolve(e) }, onComplete: function (e) { g.resolve(e) }, onError: function (e) { g.reject(e) } }, c)); return m(g) }
                                                        }); this._set("store", n)
                                                }, postMixInProperties: function () {
                                                        var n = this.params.store || this.store; n && this._setStoreAttr(n); this.inherited(arguments); if (!this.params.store && this.store &&
                                                                !this.store._oldAPI) {
                                                                        var d = this.declaredClass; w.mixin(this.store, {
                                                                                getValue: function (c, g) { A.deprecated(d + ".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly", "", "2.0"); return c[g] }, getLabel: function (c) { A.deprecated(d + ".store.getLabel(item) is deprecated for builtin store.  Use item.label directly", "", "2.0"); return c.name }, fetch: function (c) {
                                                                                        A.deprecated(d + ".store.fetch() is deprecated for builtin store.", "Use store.query()", "2.0"); require(["dojo/data/ObjectStore"],
                                                                                                w.hitch(this, function (g) { (new g({ objectStore: this })).fetch(c) }))
                                                                                }
                                                                        })
                                                        }
                                                }, buildRendering: function () { this.inherited(arguments); this.focusNode.setAttribute("aria-autocomplete", this.autoComplete ? "both" : "list") }
                                        })
                                })
                }, "dijit/form/_AutoCompleterMixin": function () {
                        define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                q = q("dijit.form._AutoCompleterMixin", d, {
                                        item: null,
                                        autoComplete: !0, highlightMatch: "first", labelAttr: "", labelType: "text", maxHeight: -1, _stopClickEvents: !1, _getCaretPos: function (c) { var g = 0; if ("number" == typeof c.selectionStart) g = c.selectionStart; else if (l("ie")) { var b = c.ownerDocument.selection.createRange().duplicate(); c = c.createTextRange(); b.move("character", 0); c.move("character", 0); try { c.setEndPoint("EndToEnd", b), g = String(c.text).replace(/\r/g, "").length } catch (e) { } } return g }, _setCaretPos: function (c, g) { g = parseInt(g); n.selectInputText(c, g, g) }, _setDisabledAttr: function (c) {
                                                this.inherited(arguments);
                                                this.domNode.setAttribute("aria-disabled", c ? "true" : "false")
                                        }, _onKey: function (c) {
                                                if (!(32 <= c.charCode)) {
                                                        var g = c.charCode || c.keyCode; if (g != w.ALT && g != w.CTRL && g != w.META && g != w.SHIFT) {
                                                                var b = this.dropDown, e = null; this._abortQuery(); this.inherited(arguments); if (!(c.altKey || c.ctrlKey || c.metaKey)) switch (this._opened && (e = b.getHighlightedOption()), g) {
                                                                        case w.PAGE_DOWN: case w.DOWN_ARROW: case w.PAGE_UP: case w.UP_ARROW: this._opened && this._announceOption(e); c.stopPropagation(); c.preventDefault(); break; case w.ENTER: if (e) {
                                                                                if (e ==
                                                                                        b.nextButton) { this._nextSearch(1); c.stopPropagation(); c.preventDefault(); break } else if (e == b.previousButton) { this._nextSearch(-1); c.stopPropagation(); c.preventDefault(); break } c.stopPropagation(); c.preventDefault()
                                                                        } else this._setBlurValue(), this._setCaretPos(this.focusNode, this.focusNode.value.length); case w.TAB: g = this.get("displayedValue"); if (b && (g == b._messages.previousMessage || g == b._messages.nextMessage)) break; e && this._selectOption(e); case w.ESCAPE: this._opened && (this._lastQuery = null, this.closeDropDown())
                                                                }
                                                        }
                                                }
                                        },
                                        _autoCompleteText: function (c) { var g = this.focusNode; n.selectInputText(g, g.value.length); var b = this.ignoreCase ? "toLowerCase" : "substr"; 0 == c[b](0).indexOf(this.focusNode.value[b](0)) ? (b = this.autoComplete ? this._getCaretPos(g) : g.value.length, b + 1 > g.value.length && (g.value = c, n.selectInputText(g, b))) : (g.value = c, n.selectInputText(g)) }, _openResultList: function (c, g, b) {
                                                var e = this.dropDown.getHighlightedOption(); this.dropDown.clearResultList(); c.length || 0 != b.start ? (this._nextSearch = this.dropDown.onPage = m.hitch(this,
                                                        function (a) { c.nextPage(-1 !== a); this.focus() }), this.dropDown.createOptions(c, b, m.hitch(this, "_getMenuLabelFromItem")), this._showResultList(), "direction" in b ? (b.direction ? this.dropDown.highlightFirstOption() : b.direction || this.dropDown.highlightLastOption(), e && this._announceOption(this.dropDown.getHighlightedOption())) : !this.autoComplete || this._prev_key_backspace || /^[*]+$/.test(g[this.searchAttr].toString()) || this._announceOption(this.dropDown.containerNode.firstChild.nextSibling)) : this.closeDropDown()
                                        },
                                        _showResultList: function () { this.closeDropDown(!0); this.openDropDown(); this.domNode.setAttribute("aria-expanded", "true") }, loadDropDown: function () { this._startSearchAll() }, isLoaded: function () { return !1 }, closeDropDown: function () { this._abortQuery(); this._opened && (this.inherited(arguments), this.domNode.setAttribute("aria-expanded", "false")) }, _setBlurValue: function () {
                                                var c = this.get("displayedValue"), g = this.dropDown; !g || c != g._messages.previousMessage && c != g._messages.nextMessage ? "undefined" == typeof this.item ?
                                                        (this.item = null, this.set("displayedValue", c)) : (this.value != this._lastValueReported && this._handleOnChange(this.value, !0), this._refreshState()) : this._setValueAttr(this._lastValueReported, !0); this.focusNode.removeAttribute("aria-activedescendant")
                                        }, _setItemAttr: function (c, g, b) { var e = ""; c && (b || (b = this.store._oldAPI ? this.store.getValue(c, this.searchAttr) : c[this.searchAttr]), e = this._getValueField() != this.searchAttr ? this.store.getIdentity(c) : b); this.set("value", e, g, b, c) }, _announceOption: function (c) {
                                                if (c) {
                                                        if (c ==
                                                                this.dropDown.nextButton || c == this.dropDown.previousButton) { var g = c.innerHTML; this.item = void 0; this.value = "" } else { var b = this.dropDown.items[c.getAttribute("item")]; g = (this.store._oldAPI ? this.store.getValue(b, this.searchAttr) : b[this.searchAttr]).toString(); this.set("item", b, !1, g) } this.focusNode.value = this.focusNode.value.substring(0, this._lastInput.length); this.focusNode.setAttribute("aria-activedescendant", A.get(c, "id")); this._autoCompleteText(g)
                                                }
                                        }, _selectOption: function (c) {
                                                this.closeDropDown(); c &&
                                                        this._announceOption(c); this._setCaretPos(this.focusNode, this.focusNode.value.length); this._handleOnChange(this.value, !0); this.focusNode.removeAttribute("aria-activedescendant")
                                        }, _startSearchAll: function () { this._startSearch("") }, _startSearchFromInput: function () { this.item = void 0; this.inherited(arguments) }, _startSearch: function (c) {
                                                if (!this.dropDown) {
                                                        var g = this.id + "_popup"; this.dropDown = new (m.isString(this.dropDownClass) ? m.getObject(this.dropDownClass, !1) : this.dropDownClass)({
                                                                onChange: m.hitch(this,
                                                                        this._selectOption), id: g, dir: this.dir, textDir: this.textDir
                                                        })
                                                } this._lastInput = c; this.inherited(arguments)
                                        }, _getValueField: function () { return this.searchAttr }, postMixInProperties: function () { this.inherited(arguments); if (!this.store && this.srcNodeRef && (this.store = new k({}, this.srcNodeRef), !("value" in this.params))) { var c = this.item = this.store.fetchSelectedItem(); if (c) { var g = this._getValueField(); this.value = this.store._oldAPI ? this.store.getValue(c, g) : c[g] } } }, postCreate: function () {
                                                var c = v('label[for\x3d"' +
                                                        this.id + '"]'); c.length && (c[0].id || (c[0].id = this.id + "_label"), this.domNode.setAttribute("aria-labelledby", c[0].id)); this.inherited(arguments); E.after(this, "onSearch", m.hitch(this, "_openResultList"), !0)
                                        }, _getMenuLabelFromItem: function (c) { c = this.labelFunc(c, this.store); var g = this.labelType; "none" != this.highlightMatch && "text" == this.labelType && this._lastInput && (c = this.doHighlight(c, this._lastInput), g = "html"); return { html: "html" == g, label: c } }, doHighlight: function (c, g) {
                                                var b = (this.ignoreCase ? "i" : "") + ("all" ==
                                                        this.highlightMatch ? "g" : ""), e = this.queryExpr.indexOf("${0}"); g = r.escapeString(g); return this._escapeHtml(c.replace(new RegExp((0 == e ? "^" : "") + "(" + g + ")" + (e == this.queryExpr.length - 4 ? "$" : ""), b), "\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g, '\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')
                                        }, _escapeHtml: function (c) { return c = String(c).replace(/&/gm, "\x26amp;").replace(/</gm, "\x26lt;").replace(/>/gm, "\x26gt;").replace(/"/gm, "\x26quot;") }, reset: function () { this.item = null; this.inherited(arguments) },
                                        labelFunc: function (c, g) { return (g._oldAPI ? g.getValue(c, this.labelAttr || this.searchAttr) : c[this.labelAttr || this.searchAttr]).toString() }, _setValueAttr: function (c, g, b, e) { this._set("item", e || null); null == c && (c = ""); this.inherited(arguments) }
                                }); l("dojo-bidi") && q.extend({ _setTextDirAttr: function (c) { this.inherited(arguments); this.dropDown && this.dropDown._set("textDir", c) } }); return q
                        })
                }, "dijit/form/DataList": function () {
                        define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
                                function (E, q, A, w, m, v) { function r(l) { return { id: l.value, value: l.value, name: A.trim(l.innerText || l.textContent || "") } } return E("dijit.form.DataList", m, { constructor: function (l, k) { this.domNode = q.byId(k); A.mixin(this, l); this.id && v.add(this); this.domNode.style.display = "none"; this.inherited(arguments, [{ data: w("option", this.domNode).map(r) }]) }, destroy: function () { v.remove(this.id) }, fetchSelectedItem: function () { var l = w("\x3e option[selected]", this.domNode)[0] || w("\x3e option", this.domNode)[0]; return l && r(l) } }) })
                },
                "dijit/form/_SearchMixin": function () {
                        define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "), function (E, q, A, w, m, v, r) {
                                return E("dijit.form._SearchMixin", null, {
                                        pageSize: Infinity, store: null, fetchProperties: {}, query: {}, list: "", _setListAttr: function (l) { this._set("list", l) }, searchDelay: 200, searchAttr: "name", queryExpr: "${0}*", ignoreCase: !0, _patternToRegExp: function (l) {
                                                return new RegExp("^" + l.replace(/(\\.)|(\*)|(\?)|\W/g, function (k, n, d, c) {
                                                        return d ? ".*" :
                                                                c ? "." : n ? n : "\\" + k
                                                }) + "$", this.ignoreCase ? "mi" : "m")
                                        }, _abortQuery: function () { this.searchTimer && (this.searchTimer = this.searchTimer.remove()); this._queryDeferHandle && (this._queryDeferHandle = this._queryDeferHandle.remove()); this._fetchHandle && (this._fetchHandle.abort && (this._cancelingQuery = !0, this._fetchHandle.abort(), this._cancelingQuery = !1), this._fetchHandle.cancel && (this._cancelingQuery = !0, this._fetchHandle.cancel(), this._cancelingQuery = !1), this._fetchHandle = null) }, _processInput: function (l) {
                                                if (!this.disabled &&
                                                        !this.readOnly) { l = l.charOrCode; this._prev_key_backspace = !1; if (l === q.DELETE || l === q.BACKSPACE) this._maskValidSubsetError = this._prev_key_backspace = !0; if (this.store) this.searchTimer = this.defer("_startSearchFromInput", 1); else this.onSearch() }
                                        }, onSearch: function () { }, _startSearchFromInput: function () { this._startSearch(this.focusNode.value) }, _startSearch: function (l) {
                                                this._abortQuery(); var k = this, n = A.clone(this.query), d = { start: 0, count: this.pageSize, queryOptions: { ignoreCase: this.ignoreCase, deep: !0 } }, c = m.substitute(this.queryExpr,
                                                        [l.replace(/([\\\*\?])/g, "\\$1")]), g = function () {
                                                                var e = k._fetchHandle = k.store.query(n, d); k.disabled || k.readOnly || b !== k._lastQuery || v(e, function (a) {
                                                                        k._fetchHandle = null; k.disabled || k.readOnly || b !== k._lastQuery || v(e.total, function (f) {
                                                                                a.total = f; var h = k.pageSize; if (isNaN(h) || h > a.total) h = a.total; a.nextPage = function (p) {
                                                                                        d.direction = p = !1 !== p; d.count = h; p ? (d.start += a.length, d.start >= a.total && (d.count = 0)) : (d.start -= h, 0 > d.start && (d.count = Math.max(h + d.start, 0), d.start = 0)); 0 >= d.count ? (a.length = 0, k.onSearch(a, n, d)) :
                                                                                                g()
                                                                                }; k.onSearch(a, n, d)
                                                                        })
                                                                }, function (a) { k._fetchHandle = null; k._cancelingQuery || console.error(k.declaredClass + " " + a.toString()) })
                                                        }; A.mixin(d, this.fetchProperties); if (this.store._oldAPI) var b = c; else b = this._patternToRegExp(c), b.toString = function () { return c }; this._lastQuery = n[this.searchAttr] = b; this._queryDeferHandle = this.defer(g, this.searchDelay)
                                        }, constructor: function () { this.query = {}; this.fetchProperties = {} }, postMixInProperties: function () { if (!this.store) { var l = this.list; l && (this.store = r.byId(l)) } this.inherited(arguments) }
                                })
                        })
                },
                "dijit/form/_ComboBoxMenu": function () {
                        define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "), function (E, q, A, w, m, v, r, l) {
                                return E("dijit.form._ComboBoxMenu", [m, v, l, r], {
                                        templateString: "\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
                                        baseClass: "dijitComboBoxMenu", postCreate: function () { this.inherited(arguments); this.isLeftToRight() || (q.add(this.previousButton, "dijitMenuItemRtl"), q.add(this.nextButton, "dijitMenuItemRtl")); this.containerNode.setAttribute("role", "listbox") }, _createMenuItem: function () { var k = this.ownerDocument.createElement("div"); k.className = "dijitReset dijitMenuItem" + (this.isLeftToRight() ? "" : " dijitMenuItemRtl"); k.setAttribute("role", "option"); return k }, onHover: function (k) { q.add(k, "dijitMenuItemHover") }, onUnhover: function (k) {
                                                q.remove(k,
                                                        "dijitMenuItemHover")
                                        }, onSelect: function (k) { q.add(k, "dijitMenuItemSelected") }, onDeselect: function (k) { q.remove(k, "dijitMenuItemSelected") }, _page: function (k) {
                                                var n = 0, d = this.domNode.scrollTop, c = A.get(this.domNode, "height"); for (this.getHighlightedOption() || this.selectNextNode(); n < c;) {
                                                        var g = this.getHighlightedOption(); if (k) { if (!g.previousSibling || "none" == g.previousSibling.style.display) break; this.selectPreviousNode() } else { if (!g.nextSibling || "none" == g.nextSibling.style.display) break; this.selectNextNode() } g =
                                                                this.domNode.scrollTop; n += (g - d) * (k ? -1 : 1); d = g
                                                }
                                        }, handleKey: function (k) { switch (k.keyCode) { case w.DOWN_ARROW: return this.selectNextNode(), !1; case w.PAGE_DOWN: return this._page(!1), !1; case w.UP_ARROW: return this.selectPreviousNode(), !1; case w.PAGE_UP: return this._page(!0), !1; default: return !0 } }
                                })
                        })
                }, "dijit/form/_ComboBoxMenuMixin": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "), function (E, q, A, w, m) {
                                var v = q("dijit.form._ComboBoxMenuMixin" +
                                        (w("dojo-bidi") ? "_NoBidi" : ""), null, {
                                                _messages: null, postMixInProperties: function () { this.inherited(arguments); this._messages = m.getLocalization("dijit.form", "ComboBox", this.lang) }, buildRendering: function () { this.inherited(arguments); this.previousButton.innerHTML = this._messages.previousMessage; this.nextButton.innerHTML = this._messages.nextMessage }, _setValueAttr: function (r) { this._set("value", r); this.onChange(r) }, onClick: function (r) {
                                                        if (r == this.previousButton) this._setSelectedAttr(null), this.onPage(-1); else if (r ==
                                                                this.nextButton) this._setSelectedAttr(null), this.onPage(1); else this.onChange(r)
                                                }, onChange: function () { }, onPage: function () { }, onClose: function () { this._setSelectedAttr(null) }, _createOption: function (r, l) { var k = this._createMenuItem(); r = l(r); r.html ? k.innerHTML = r.label : k.appendChild(k.ownerDocument.createTextNode(r.label)); "" == k.innerHTML && (k.innerHTML = "\x26#160;"); return k }, createOptions: function (r, l, k) {
                                                        this.items = r; this.previousButton.style.display = 0 == l.start ? "none" : ""; A.set(this.previousButton, "id", this.id +
                                                                "_prev"); E.forEach(r, function (d, c) { d = this._createOption(d, k); d.setAttribute("item", c); A.set(d, "id", this.id + c); this.nextButton.parentNode.insertBefore(d, this.nextButton) }, this); var n = !1; r.total && !r.total.then && -1 != r.total ? l.start + l.count < r.total ? n = !0 : l.start + l.count > r.total && l.count == r.length && (n = !0) : l.count == r.length && (n = !0); this.nextButton.style.display = n ? "" : "none"; A.set(this.nextButton, "id", this.id + "_next")
                                                }, clearResultList: function () {
                                                        for (var r = this.containerNode; 2 < r.childNodes.length;)r.removeChild(r.childNodes[r.childNodes.length -
                                                                2]); this._setSelectedAttr(null)
                                                }, highlightFirstOption: function () { this.selectFirstNode() }, highlightLastOption: function () { this.selectLastNode() }, selectFirstNode: function () { this.inherited(arguments); this.getHighlightedOption() == this.previousButton && this.selectNextNode() }, selectLastNode: function () { this.inherited(arguments); this.getHighlightedOption() == this.nextButton && this.selectPreviousNode() }, getHighlightedOption: function () { return this.selected }
                                }); w("dojo-bidi") && (v = q("dijit.form._ComboBoxMenuMixin",
                                        v, { _createOption: function () { var r = this.inherited(arguments); this.applyTextDir(r); return r } })); return v
                        })
                }, "dijit/form/_ListMouseMixin": function () {
                        define(["dojo/_base/declare", "dojo/on", "dojo/touch", "./_ListBase"], function (E, q, A, w) {
                                return E("dijit.form._ListMouseMixin", w, {
                                        postCreate: function () {
                                                this.inherited(arguments); this.domNode.dojoClick = !0; this._listConnect("click", "_onClick"); this._listConnect("mousedown", "_onMouseDown"); this._listConnect("mouseup", "_onMouseUp"); this._listConnect("mouseover",
                                                        "_onMouseOver"); this._listConnect("mouseout", "_onMouseOut")
                                        }, _onClick: function (m, v) { this._setSelectedAttr(v, !1); this._deferredClick && this._deferredClick.remove(); this._deferredClick = this.defer(function () { this._deferredClick = null; this.onClick(v) }) }, _onMouseDown: function (m, v) { this._hoveredNode && (this.onUnhover(this._hoveredNode), this._hoveredNode = null); this._isDragging = !0; this._setSelectedAttr(v, !1) }, _onMouseUp: function (m, v) {
                                                this._isDragging = !1; var r = this.selected, l = this._hoveredNode; r && v == r ? this.defer(function () {
                                                        this._onClick(m,
                                                                r)
                                                }) : l && this.defer(function () { this._onClick(m, l) })
                                        }, _onMouseOut: function (m, v) { this._hoveredNode && (this.onUnhover(this._hoveredNode), this._hoveredNode = null); this._isDragging && (this._cancelDrag = (new Date).getTime() + 1E3) }, _onMouseOver: function (m, v) { this._cancelDrag && ((new Date).getTime() > this._cancelDrag && (this._isDragging = !1), this._cancelDrag = null); this._hoveredNode = v; this.onHover(v); this._isDragging && this._setSelectedAttr(v, !1) }
                                })
                        })
                }, "dijit/form/_ListBase": function () {
                        define(["dojo/_base/declare", "dojo/on",
                                "dojo/window"], function (E, q, A) {
                                        return E("dijit.form._ListBase", null, {
                                                selected: null, _listConnect: function (w, m) { var v = this; return v.own(q(v.containerNode, q.selector(function (r, l, k) { return r.parentNode == k }, w), function (r) { v[m](r, this) })) }, selectFirstNode: function () { for (var w = this.containerNode.firstChild; w && "none" == w.style.display;)w = w.nextSibling; this._setSelectedAttr(w, !0) }, selectLastNode: function () {
                                                        for (var w = this.containerNode.lastChild; w && "none" == w.style.display;)w = w.previousSibling; this._setSelectedAttr(w,
                                                                !0)
                                                }, selectNextNode: function () { var w = this.selected; if (w) { for (w = w.nextSibling; w && "none" == w.style.display;)w = w.nextSibling; w ? this._setSelectedAttr(w, !0) : this.selectFirstNode() } else this.selectFirstNode() }, selectPreviousNode: function () { var w = this.selected; if (w) { for (w = w.previousSibling; w && "none" == w.style.display;)w = w.previousSibling; w ? this._setSelectedAttr(w, !0) : this.selectLastNode() } else this.selectLastNode() }, _setSelectedAttr: function (w, m) {
                                                        if (this.selected != w) {
                                                                var v = this.selected; if (v) this.onDeselect(v);
                                                                w && (m && A.scrollIntoView(w), this.onSelect(w)); this._set("selected", w)
                                                        } else if (w) this.onSelect(w)
                                                }
                                        })
                                })
                }, "jimu/dijit/LoadingShelter": function () {
                        define(["dojo/_base/declare", "dijit/_WidgetBase", "dijit/_TemplatedMixin", "dojo/text!./templates/LoadingShelter.html", "dojo/_base/html"], function (E, q, A, w, m) {
                                return E([q, A], {
                                        baseClass: "jimu-loading-shelter jimu-agol-loading", declaredClass: "jimu.dijit.LoadingShelter", templateString: w, loadingText: null, hidden: !1, showLoading: !0, postMixInProperties: function () {
                                                this.nls =
                                                window.jimuNls.loadingShelter
                                        }, postCreate: function () { this.inherited(arguments); this.hidden && m.setStyle(this.domNode, "display", "none"); m.setStyle(this.domNode, { width: "100%", height: "100%" }); this.showLoading || m.setStyle(this.loadingNode, "display", "none"); "string" === typeof this.loadingText && (this.textNode.innerHTML = this.loadingText) }, show: function (v) { this.domNode && this.hidden && ("string" === typeof v && (this.textNode.innerHTML = v), m.setStyle(this.domNode, "display", "block"), this.hidden = !1) }, hide: function () {
                                                this.domNode &&
                                                !this.hidden && (m.setStyle(this.domNode, "display", "none"), this.hidden = !0)
                                        }
                                })
                        })
                }, "jimu/dijit/FeatureActionPopupMenu": function () {
                        define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/array jimu/accessibleUtils dojo/on dojo/keys dijit/a11yclick dojo/dom-geometry dijit/_WidgetBase dijit/_TemplatedMixin jimu/FeatureActionManager ./FeatureActionPopupMenuItem".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                var b = null, e = E([n, d], {
                                        baseClass: "popup-menu", templateString: '\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d"menuNode" class\x3d"menu-content"\x3e\x3cdiv class\x3d"menu-title" data-dojo-attach-point\x3d"titleNode"\x3e\x3cdiv role\x3d"title" class\x3d"label jimu-float-leading" data-dojo-attach-point\x3d"labelNode" tabindex\x3d"0"\x3e\x3c/div\x3e\x3cdiv class\x3d"feature-action icon-close close-btn jimu-float-trailing" data-dojo-attach-point\x3d"closeBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"menu-items" data-dojo-attach-point\x3d"menuContent" tabindex\x3d"0"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
                                        postCreate: function () { this._setFocusedNodeBeforeOpen(); this.inherited(arguments); this.hide(); this.menuItems = []; this.own(v(this.domNode, "click", A.hitch(this, function (a) { a = a.target || a.srcElement; a === this.menuNode || q.isDescendant(a, this.menuNode) || this.hide() }))); this._a11y_addEvents() }, _setFocusedNodeBeforeOpen: function () { this.focusedNodeBeforeOpen = document.activeElement }, _a11y_addEvents: function () {
                                                this.own(v(this.labelNode, "keydown", A.hitch(this, function (a) {
                                                        a.shiftKey && a.keyCode === r.TAB && (a.preventDefault(),
                                                                this.hide())
                                                }))); this.own(v(this.closeBtn, l, A.hitch(this, this.hide))); this.own(v(this.menuContent, "focus", A.hitch(this, function () { this.currentMenuItem = this.menuItems[0].domNode; w.forEach(this.menuItems, function (a) { q.hasClass(a.domNode, "selected") && (this.currentMenuItem = a.domNode) }); this.currentMenuItem.focus() }))); this.own(v(this.menuContent, "keydown", A.hitch(this, function (a) {
                                                        a.keyCode === r.ESCAPE && (a.stopPropagation(), this.hide()); if (q.hasClass(a.target, "popup-menu-item")) if (a.keyCode !== r.TAB || (!a.shiftKey ||
                                                                this.hasTitle) && a.shiftKey) { if (a.keyCode === r.DOWN_ARROW) var f = this.currentMenuItem.nextSibling ? this.currentMenuItem.nextSibling : this.currentMenuItem; else a.keyCode === r.UP_ARROW ? f = this.currentMenuItem.previousSibling ? this.currentMenuItem.previousSibling : this.currentMenuItem : a.keyCode === r.HOME ? f = this.menuItems[0].domNode : a.keyCode === r.END && (f = this.menuItems[this.menuItems.length - 1].domNode); f && (this.currentMenuItem = f, f.focus()) } else a.preventDefault(), this.hide()
                                                })))
                                        }, setActions: function (a) {
                                                this.clearActions();
                                                w.forEach(a, A.hitch(this, this._addMenuItem))
                                        }, appendAction: function (a) { this._addMenuItem(a) }, clearActions: function () { this.menuItems = []; q.empty(this.menuContent) }, _addMenuItem: function (a) { var f = new g({ action: a }); q.place(f.domNode, this.menuContent); f.startup(); this.menuItems.push(f); this.own(v(f, "click", A.hitch(this, function (h) { h ? (h = 0 <= ["ShowStatistics", "SaveToMyContent", "ChangeSymbol"].indexOf(f.action.name), m.isInNavMode() && h || this.hide()) : this.hide() }))) }, markAsSelected: function (a) {
                                                w.forEach(this.menuItems,
                                                        function (f) { f.action.label === a.label ? f.setSelected(!0) : f.setSelected(!1) })
                                        }, prepareActions: function (a, f) { return c.getInstance().getSupportedActions(a).then(A.hitch(this, function (h) { !1 === f && (h = w.filter(h, function (p) { return 0 !== p.name.indexOf("Export") && "SaveToMyContent" !== p.name })); w.forEach(h, function (p) { p.data = a }, this); this.setActions(h) })) }, hide: function () { q.setStyle(this.domNode, "display", "none"); this.focusedNodeBeforeOpen && this.focusedNodeBeforeOpen.focus() }, show: function (a, f) {
                                                if (0 === this.menuItems.length) q.setStyle(this.domNode,
                                                        "display", "none"); else {
                                                                "string" === typeof f && "" !== f ? (this.labelNode.innerHTML = f, q.setStyle(this.titleNode, "display", "")) : (this.labelNode.innerHTML = "", q.setStyle(this.titleNode, "display", "none")); var h = a.y + a.h; a = window.isRTL ? a.x : a.x + a.w; q.setStyle(this.domNode, "display", ""); q.setStyle(this.menuNode, { left: "-1000px", top: "0px", display: "block" }); var p = k.getMarginSize(this.menuNode); q.setStyle(this.menuNode, {
                                                                        left: (window.isRTL ? a + p.w > window.innerWidth ? window.innerWidth - p.w : 0 > a ? 0 : a : 0 > a - p.w ? 0 : a > window.innerWidth ?
                                                                                window.innerWidth - p.w : a - p.w) + "px", top: (p.h > window.innerHeight ? 0 : h + p.h > window.innerHeight ? window.innerHeight - p.h : h + p.h + 5 < window.innerHeight ? h + 5 : h) + "px"
                                                                }); "string" === typeof f && "" !== f ? (this.labelNode.focus(), this.hasTitle = !0) : (this.menuContent.focus(), this.hasTitle = !1)
                                                }
                                        }
                                }); e.getInstance = function () { null === b && (b = new e, q.place(b.domNode, document.body), b.startup()); b.setActions([]); return b }; return e
                        })
                }, "jimu/dijit/FeatureActionPopupMenuItem": function () {
                        define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/_base/event dojo/on dojo/keys dojo/mouse dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        return E([k, n, l], {
                                                baseClass: "popup-menu-item", templateString: '\x3cdiv role\x3d"option" tabindex\x3d"-1"\x3e\x3cdiv class\x3d"icon jimu-float-leading" data-dojo-attach-point\x3d"iconContainer"\x3e\x3cdiv class\x3d"feature-action" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"label" data-dojo-attach-point\x3d"labelNode"\x3e\x3c/div\x3e\x3c/div\x3e', action: null, postCreate: function () {
                                                        this.inherited(arguments); this.action && (this.labelNode.innerHTML =
                                                                this.action.label, this.labelNode.title = this.action.label, this.action.iconClass ? ("no-icon" === this.action.iconClass && q.addClass(this.iconContainer, "no-icon"), q.addClass(this.iconNode, this.action.iconClass)) : q.setStyle(this.iconNode, "background-image", "url(" + this.action.getIcon("default") + ")"), this.own(m(this.domNode, r.enter, A.hitch(this, this._useHoverIcon))), this.own(m(this.domNode, r.leave, A.hitch(this, this._useNormalIcon)))); this.own(m(this.domNode, "click", A.hitch(this, this._clickHandler))); this.own(m(this.domNode,
                                                                        "keydown", A.hitch(this, function (d) { d.keyCode === v.ENTER && this._clickHandler(d, !0) })))
                                                }, setSelected: function (d) { d ? q.addClass(this.domNode, "selected") : q.removeClass(this.domNode, "selected") }, _useNormalIcon: function () { this.action.iconClass ? q.removeClass(this.iconNode, "highlight") : q.setStyle(this.iconNode, "background-image", "url(" + this.action.getIcon("default") + ")") }, _useHoverIcon: function () {
                                                        this.action.iconClass ? q.addClass(this.iconNode, "highlight") : q.setStyle(this.iconNode, "background-image", "url(" +
                                                                this.action.getIcon("hover") + ")")
                                                }, _clickHandler: function (d, c) { w.stop(d); if (this.action) { var g; this.action.data.features && 0 < this.action.data.features.length && (g = this.action.data.features[0].getLayer()); this.action.onExecute(this.action.data, g) } this.emit("click", { isEnter: c }) }
                                        })
                                })
                }, "jimu/RelatedRecordsPopupProjector": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/has dojo/query dojo/Deferred dojo/promise/all dijit/_WidgetBase dijit/_TemplatedMixin esri/undoManager esri/OperationBase esri/tasks/RelationshipQuery esri/dijit/Popup esri/dijit/PopupMobile esri/graphicsUtils esri/dijit/PopupTemplate jimu/utils jimu/ConfigManager jimu/dijit/DropdownMenu jimu/LayerInfos/LayerInfos".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u) {
                                        var z = E([n, d], {
                                                baseClass: "related-records-popup-projector", templateString: "\x3cdiv\x3e\x3cdiv class\x3d'operation-box' data-dojo-attach-point\x3d'operationBox' style\x3d'display: none'\x3e\x3cdiv class\x3d'previos-btn feature-action' data-dojo-attach-point\x3d'previouBtn'data-dojo-attach-event\x3d'click:_onPreviouBtnClick'\x3e\x3c/div\x3e\x3cdiv class\x3d'operation-title' data-dojo-attach-point\x3d'operationTitle'\x3eabc\x3c/div\x3e\x3cdiv class\x3d'add-new-btn' data-dojo-attach-point\x3d'addNewBtn'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'content-box' data-dojo-attach-point\x3d'contentBox'\x3e\x3c/div\x3e\x3c/div\x3e",
                                                popup: null, popupManager: null, undoManager: null, originalFeature: null, originalJimuLayerInfo: null, _temporaryData: null, postCreate: function () {
                                                        this.undoManager = new c; this.layerInfosObj = u.getInstanceSync(); var x = q.getObject("_wabProperties.referToFeatureLayerId", !1, this.originalFeature) || this.originalFeature.getLayer().id; this.originalJimuLayerInfo = this.layerInfosObj.getLayerInfoById(x); this._temporaryData = { eventHandles: [], dijits: [] }; window.isRTL ? w.addClass(this.previouBtn, "icon-arrow-forward") : w.addClass(this.previouBtn,
                                                                "icon-arrow-back"); x = this._createOperation({ feature: this.originalFeature, oriJimuLayerInfo: this.originalJimuLayerInfo }); this.showRelatedTables(x); this.popupUIController = "esri.dijit.Popup" === this.popup.declaredClass ? new z.PopupUIController(this) : new z.PopupMobileUIController(this); this.popupUIController.addDomNode(this.domNode)
                                                }, destroy: function () { this._clearPage(); this.undoManager.destroy(); this.popupUIController.destroy(); this.inherited(arguments) }, _getRelatedTableInfoArray: function (x) {
                                                        x = x.data.oriJimuLayerInfo;
                                                        var y = new l; x.getRelatedTableInfoArray().then(q.hitch(this, function (D) { y.resolve(D) })); return y
                                                }, _getRelatedRecordsByRelatedQuery: function (x) { return x.oriJimuLayerInfo.getRelatedRecords(x.feature, x.destJimuLayerInfo, x.relationshipIndex) }, _ignoreCaseToGetFieldObject: function (x, y) { var D = null; y && x && x.fields && A.some(x.fields, function (H) { if (H.name.toLowerCase() === y.toLowerCase()) return D = H, !0 }); return D }, getLocaleDateTime: function (x) { return p.localizeDate(new Date(x), { fullYear: !0, formatLength: "medium" }) },
                                                _getDisplayTitleOfRelatedRecord: function (x, y, D) { var H = x.getInfoTemplate(); return (x = "popupTitle" === D && H ? "function" === typeof H.title ? H.title(y) : H.title : this._getDisplayTitleFromPopup(x, y, D)) ? x : " " }, _getDisplayTitleFromPopup: function (x, y, D) { (x = this._getPopupTemplateWithOnlyDisplayField(x, D)) ? (y.setInfoTemplate(x), D = this.popupUIController.getDisplayTitle(y), y.setInfoTemplate(null)) : D = y.attributes[D]; return D }, _getPopupTemplateWithOnlyDisplayField: function (x, y) {
                                                        x = x.getPopupInfo() || x._getDefaultPopupInfo(x.layerObject);
                                                        var D = { title: "", fieldInfos: [], description: "", showAttachments: !1, mediaInfos: [] }; try { x && x.fieldInfos && y && A.some(x.fieldInfos, function (H) { return H.fieldName.toLowerCase() === y.toLowerCase() ? (H = q.clone(H), H.visible = !0, D.fieldInfos.push(H), !0) : !1 }, this) } catch (H) { console.error(H) } return new h(D)
                                                }, _canShowRelatedData: function (x) { var y = !0; (x = x.getPopupInfo()) && x.relatedRecordsInfo && (y = !1 !== x.relatedRecordsInfo.showRelatedRecords); return y }, setPopupContent: function (x) {
                                                        this._clearPage(); x.data.destJimuLayerInfo ?
                                                                x.data.relatedFeature || this.showRelatedRecords(x) : this.showFeature(x); this.undoManager.peekUndo() ? this.popupUIController.changeRefDomNode() : this.popupUIController.revertRefDomNode()
                                                }, showFeature: function (x) {
                                                        var y = x.data, D = y.oriJimuLayerInfo.layerObject, H = q.getObject("_wabProperties.originalLayerName", !1, D) || y.oriJimuLayerInfo.title; D = q.getObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList", !1, D); var I = this._getDisplayTitleOfRelatedRecord(y.oriJimuLayerInfo, y.feature, D); "popupTitle" !==
                                                                D && (I = H + ": " + I); this._setOperationTitle(I); q.setObject("_wabProperties.popupInfo.operationDataForListRelatedRecords", null, y.oriJimuLayerInfo.layerObject); y.oriJimuLayerInfo.loadInfoTemplate().then(q.hitch(this, function (N) { y.oriJimuLayerInfo.layerObject.infoTemplate || x.data.feature.setInfoTemplate(N); this.popupUIController.setFeature(x.data.feature); y.oriJimuLayerInfo.layerObject.infoTemplate || x.data.feature.setInfoTemplate(null) })); this.showRelatedTables(x); this.popupManager.initPopupMenu([x.data.feature]);
                                                        this.popupUIController.updateZoomToBtn([x.data.feature])
                                                }, showRelatedRecords: function (x) {
                                                        var y = x.data, D = q.getObject("_wabProperties.originalLayerName", !1, y.destJimuLayerInfo.layerObject) || y.destJimuLayerInfo.title; this._setOperationTitle(D); this._clearPage(); q.setObject("_wabProperties.popupInfo.operationDataForListRelatedRecords", y, y.destJimuLayerInfo.layerObject); q.setObject("_wabProperties.popupInfo.originalFeature", this.originalFeature, y.destJimuLayerInfo.layerObject); q.setObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",
                                                                y.destJimuLayerInfo.layerObject, this.popup); this._getRelatedRecordsByRelatedQuery(y).then(q.hitch(this, function (H) {
                                                                        0 < H.length ? this._setTitle(window.jimuNls.popup.relatedRecords) : this._setTitle(window.jimuNls.popup.noRelatedRecotds, "font-normal"); var I = this._showFieldSelector(y.destJimuLayerInfo); A.forEach(H, function (N, T) {
                                                                                N._layer = y.destJimuLayerInfo.layerObject; var M = this._getDisplayTitleOfRelatedRecord(y.destJimuLayerInfo, N, I); T = w.create("div", {
                                                                                        "class": "item record-item " + (0 === T % 2 ? "oddLine" : "evenLine"),
                                                                                        innerHTML: M
                                                                                }, this.contentBox); T.relatedRecord = N; T = m(T, "click", q.hitch(this, function () { this._addOperation(x); var R = this._createOperation({ feature: N, oriJimuLayerInfo: y.destJimuLayerInfo, relationshipIndex: y.relationshipIndex }); this.setPopupContent(R) })); this._temporaryData.eventHandles.push(T)
                                                                        }, this); this.popupManager.initPopupMenu(H); this.popupUIController.updateZoomToBtn(H)
                                                                })); this.popupUIController.setContent(this.domNode)
                                                }, showRelatedTables: function (x) {
                                                        this._canShowRelatedData(x.data.oriJimuLayerInfo) &&
                                                        this._getRelatedTableInfoArray(x).then(q.hitch(this, function (y) {
                                                                0 < y.length && this._setTitle(window.jimuNls.popup.relatedTables); var D = {}; A.forEach(y, function (I) { void 0 === D[I.id] ? D[I.id] = 0 : D[I.id]++ }, this); var H = {}; A.forEach(y, function (I, N) {
                                                                        void 0 === H[I.id] ? H[I.id] = 0 : H[I.id]++; var T = '\x3cdiv title\x3d"' + I.title + '"\x3e' + I.title + "\x3c/div\x3e", M = w.create("div", { "class": "item table-item " + (0 === N % 2 ? "oddLine" : "evenLine"), innerHTML: T }, this.contentBox), R = H[I.id]; if (0 < D[I.id]) {
                                                                                N = x.data.oriJimuLayerInfo.getLayerObject();
                                                                                var ca = I.getLayerObject(); k({ oriLayerObject: N, relatedLayerObject: ca }).then(q.hitch(this, function (K) { K = x.data.oriJimuLayerInfo.getOriRelationshipByDestLayer(K.oriLayerObject, K.relatedLayerObject, R); K = K.name || K.id; M.innerHTML = T + ('\x3cdiv class\x3d"relationshipName" title\x3d"' + K + '"\x3e(' + K + ")\x3c/div\x3e") }))
                                                                        } N = m(M, "click", q.hitch(this, function () {
                                                                                I.getLayerObject().then(q.hitch(this, function () {
                                                                                        this._addOperation(x); var K = this._createOperation({
                                                                                                feature: x.data.feature, oriJimuLayerInfo: x.data.oriJimuLayerInfo,
                                                                                                destJimuLayerInfo: I, relationshipIndex: R
                                                                                        }); this.setPopupContent(K)
                                                                                }))
                                                                        })); this._temporaryData.eventHandles.push(N)
                                                                }, this)
                                                        }))
                                                }, _createOperation: function (x) { return new z.Operation({ feature: x.feature || null, oriJimuLayerInfo: x.oriJimuLayerInfo || null, destJimuLayerInfo: x.destJimuLayerInfo || null, relatedFeature: x.relatedFeature || null, relationshipIndex: x.relationshipIndex || 0 }, this) }, _addOperation: function (x) { this.undoManager.add(x) }, _onPreviouBtnClick: function () { this.undoManager.undo() }, _clearPage: function () {
                                                        w.empty(this.contentBox);
                                                        A.forEach(this._temporaryData.eventHandles, function (x) { x && x.remove && x.remove() }, this); this._temporaryData.eventHandles = []; A.forEach(this._temporaryData.dijits, function (x) { x && x.destroy && x.destroy() }, this); this._temporaryData.dijits = []
                                                }, _setTitle: function (x, y) { x && w.create("div", { "class": "title-box " + (y ? y : ""), innerHTML: x }, this.contentBox) }, _setOperationTitle: function (x) { w.setAttr(this.operationTitle, "innerHTML", x); w.setAttr(this.operationTitle, "title", x) }, _showFieldSelector: function (x) {
                                                        var y = "objecid",
                                                        D = r(".title-box", this.contentBox)[0], H = x.layerObject, I = []; if (!D || !x) return y; var N = x.getPopupInfo(); N && N.title && I.push({ label: window.jimuNls.popup.saveAsPopupTitle, value: "popupTitle" }); var T = []; N && N.fieldInfos ? A.forEach(N.fieldInfos, function (K) { var Q = {}; K.visible && (Q.name = K.fieldName, Q.alias = K.label, T.push(Q)) }) : T = H.fields; A.forEach(T, function (K) { "globalid" !== K.name.toLowerCase() && "shape" !== K.name.toLowerCase() && I.push({ label: K.alias || K.name, value: K.name }) }); D = (new t({ items: I })).placeAt(D); D.domNode.title =
                                                                window.jimuNls.popup.chooseFieldTip; var M = q.getObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList", !1, H), R = this._ignoreCaseToGetFieldObject(x.layerObject, x.layerObject.displayField || x.layerObject.objectIdField), ca = B.getInstance().getAppConfig(); M ? y = M : "2.3" === ca.configWabVersion && R && R.name ? y = R.name : N && N.title ? y = "popupTitle" : R && R.name ? y = R.name : 0 < I.length && (y = I[0].value); y && (D.setHighlightValue(y), q.setObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList", y, H)); this._temporaryData.dijits.push(D);
                                                        x = m(D, "click-item", q.hitch(this, function (K, Q) { r(".item.record-item", this.contentBox).forEach(q.hitch(this, function (X) { q.setObject("_wabProperties.popupInfo.displayFieldOfRelatedRecordList", Q, H); var W = this._getDisplayTitleOfRelatedRecord(K, X.relatedRecord, Q); X.innerHTML = W })) }, x)); this._temporaryData.eventHandles.push(x); return y
                                                }
                                        }); z.Operation = E([g], { constructor: function (x, y) { this.data = x; this.relatedRecordsPopupProjector = y }, performUndo: function () { this.relatedRecordsPopupProjector.setPopupContent(this) } });
                                        z.PopupUIController = E([], {
                                                constructor: function (x) { this.rrPopupProjector = x; this.popup = x.popup; this.initTempPopup(); this._initTempPopupForDisplayTitle(); this._initZoomToBtn(); this._setScrollable() }, initTempPopup: function () { this._tempPopup = new e({}, w.create("div")) }, _initTempPopupForDisplayTitle: function () { this._tempPopupForDisplayTitle = new e({}, w.create("div")); this._tempPopupForDisplayTitle.show() }, destroy: function () {
                                                        this._tempPopup.destroy(); this._tempPopupForDisplayTitle.destroy(); this._zoomToBtnClickHandle &&
                                                                this._zoomToBtnClickHandle.remove && this._zoomToBtnClickHandle.remove(); this._zoomToBtnANode && w.destroy(this._zoomToBtnANode); this.toucemoveScrollHandle && this.toucemoveScrollHandle.remove && this.toucemoveScrollHandle.remove()
                                                }, addDomNode: function (x) { setTimeout(q.hitch(this, function () { var y = this._getRefDomNode(); y && w.place(x, y, "after") }), 1) }, setFeature: function (x) {
                                                        this._tempPopup.setFeatures([x]); if (x = r(".esriViewPopup", this._tempPopup.domNode)[0]) this.setContent(x), w.place(this.rrPopupProjector.domNode,
                                                                x, "after"), this._unsetScrollable()
                                                }, setContent: function (x) { var y = r(".related-records-popup-projector").parent()[0]; y && y.removeChild(this.rrPopupProjector.domNode); this.popup.setContent(x); this._unsetScrollable() }, _setScrollable: function () {
                                                        var x = r(".contentPane", this.popup.domNode)[0]; v("esri-touch") && x && (this.toucemoveScrollHandle = m(x, "touchmove", q.hitch(this, function (y) {
                                                                y.preventDefault(); r(".esriViewPopup", this.popup.domNode)[0] && (y = x.firstChild, y instanceof Text && (y = x.childNodes[1]), this.rrPopupProjector.domNode &&
                                                                        w.setStyle(this.rrPopupProjector.contentBox, { "-webkit-transition-property": "-webkit-transform", "-webkit-transform": "translate(" + y._currentX + "px, " + y._currentY + "px)" }))
                                                        })))
                                                }, _unsetScrollable: function () { w.setStyle(this.rrPopupProjector.contentBox, { "-webkit-transition-property": "none", "-webkit-transform": "none" }); w.setStyle(this.rrPopupProjector.domNode, { "-webkit-transition-property": "none", "-webkit-transform": "none" }) }, getDisplayTitle: function (x) {
                                                        this._tempPopupForDisplayTitle.setFeatures([x]); return (x =
                                                                r("td.attrValue", this._tempPopupForDisplayTitle.domNode)[0]) && x.innerHTML
                                                }, _getRefDomNode: function () { return this._getViewPopupDomNode() }, _getViewPopupDomNode: function () { return r(".esriViewPopup", this.popup.domNode)[0] }, _setPopupTitleInBody: function () { this.rrPopupProjector.undoManager.peekUndo() ? this._tempPopup.set("titleInBody", !1) : this._tempPopup.set("titleInBody", !0) }, _initZoomToBtn: function () {
                                                        var x = r(".actionList", this.popup.domNode)[0]; this._oldZoomToBtnANdoe = r(".action", x)[0]; this._zoomToBtnANode =
                                                                w.create("a", { "class": "action", style: "display: none", href: "javascript:void(0)" }, x); this._zoomToBtn = w.create("span", { innerHTML: window.jimuNls.common.zoomTo }, this._zoomToBtnANode); this._showOldZoomToBtn()
                                                }, _hideZoomToBtn: function () { this._zoomToBtnANode && w.setStyle(this._zoomToBtnANode, "display", "none") }, _showZoomToBtn: function () { this._zoomToBtnANode && w.setStyle(this._zoomToBtnANode, "display", "inline-block") }, _hideOldZoomToBtn: function () {
                                                        this._oldZoomToBtnANdoe && w.setStyle(this._oldZoomToBtnANdoe, "display",
                                                                "none")
                                                }, _showOldZoomToBtn: function () { this._oldZoomToBtnANdoe && w.setStyle(this._oldZoomToBtnANdoe, "display", "inline-block") }, updateZoomToBtn: function (x) {
                                                        this._hideOldZoomToBtn(); !x || 1 > x.length || !x[0].geometry ? this._hideZoomToBtn() : (this._showZoomToBtn(), this._zoomToBtnClickHandle && this._zoomToBtnClickHandle.remove && this._zoomToBtnClickHandle.remove(), this._zoomToBtnClickHandle = m(this._zoomToBtn, "click", q.hitch(this, function () {
                                                                var y = null; try { y = f.graphicsExtent(x) } catch (D) { console.error(D) } y && (this.rrPopupProjector.popupManager.mapManager.map.setExtent(y),
                                                                        this.popup.hide())
                                                        })))
                                                }, changeRefDomNode: function () { w.setStyle(this.rrPopupProjector.operationBox, "display", "block"); w.addClass(this.rrPopupProjector.domNode, "second-page-mode"); var x = this._getViewPopupDomNode(); x && w.addClass(x, "second-page-mode") }, revertRefDomNode: function () { w.setStyle(this.rrPopupProjector.operationBox, "display", "none"); w.removeClass(this.rrPopupProjector.domNode, "second-page-mode"); this._hideZoomToBtn(); this._showOldZoomToBtn() }
                                        }); z.PopupMobileUIController = E([z.PopupUIController],
                                                {
                                                        initTempPopup: function () { this._tempPopup = new a({}, w.create("div")) }, setFeature: function (x) { this._tempPopup.setFeatures([x]); x = r(".esriMobileInfoView.esriMobilePopupInfoView", this._tempPopup.domNode)[0]; if (x = r(".esriViewPopup", x)[0]) this.setContent(x), w.place(this.rrPopupProjector.domNode, x, "after") }, updateZoomToBtn: function () { }, _initZoomToBtn: function () { }, _getRefDomNode: function () { return r(".esriMobilePopupInfoView .esriMobileInfoViewItem")[1] }, _getViewPopupDomNode: function () {
                                                                var x = r(".esriMobileInfoView.esriMobilePopupInfoView")[0];
                                                                return r(".esriViewPopup", x)[0]
                                                        }
                                                }); return z
                                })
                }, "esri/undoManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/has dojo/when ./kernel ./Evented dojo/has!extend-esri?./OperationBase".split(" "), function (E, q, A, w, m, v) {
                                E = E([v], {
                                        declaredClass: "esri.UndoManager", maxOperations: 10, canUndo: !1, canRedo: !1, position: 0, length: 0, onUndo: function () { }, onRedo: function () { }, onUndoComplete: function () { }, onRedoComplete: function () { }, onAdd: function () { }, onChange: function () { }, constructor: function (r) {
                                                r = r || {}; r.maxOperations &&
                                                        (this.maxOperations = r.maxOperations); this._historyStack = []
                                        }, add: function (r) { if (0 < this.maxOperations) for (; this._historyStack.length >= this.maxOperations;)this._historyStack.shift(); this._historyStack.splice(this.position, 0, r); this.position++; this.clearRedo(); this.onAdd(); this._checkAvailability() }, undo: function () {
                                                if (0 === this.position) return null; var r = this.peekUndo(); this.position--; r ? (r = r.performUndo(), this.onUndo(), this._checkAvailability(), w(r).then(q.hitch(this, this.onUndoComplete))) : (this.onUndo(),
                                                        this._checkAvailability())
                                        }, redo: function () { if (this.position === this._historyStack.length) return null; var r = this.peekRedo(); this.position++; r ? (r = r.performRedo(), this.onRedo(), this._checkAvailability(), w(r).then(q.hitch(this, this.onRedoComplete))) : (this.onRedo(), this._checkAvailability()) }, _checkAvailability: function () {
                                                this.length = this._historyStack.length; 0 === this.length ? this.canUndo = this.canRedo = !1 : 0 === this.position ? (this.canRedo = !0, this.canUndo = !1) : this.position === this.length ? (this.canUndo = !0, this.canRedo =
                                                        !1) : this.canRedo = this.canUndo = !0; this.onChange()
                                        }, clearUndo: function () { this._historyStack.splice(0, this.position); this.position = 0; this._checkAvailability() }, clearRedo: function () { this._historyStack.splice(this.position, this._historyStack.length - this.position); this.position = this._historyStack.length; this._checkAvailability() }, peekUndo: function () { if (0 < this._historyStack.length && 0 < this.position) return this.get(this.position - 1) }, peekRedo: function () { if (0 < this._historyStack.length && this.position < this._historyStack.length) return this.get(this.position) },
                                        get: function (r) { return this._historyStack[r] }, remove: function (r) { 0 < this._historyStack.length && (this._historyStack.splice(r, 1), 0 < this.position && r < this.position && this.position--, this._checkAvailability()) }, destroy: function () { this._historyStack = null }
                                }); A("extend-esri") && (m.UndoManager = E); return E
                        })
                }, "esri/OperationBase": function () {
                        define(["dojo/_base/declare", "dojo/has", "./kernel"], function (E, q, A) {
                                E = E(null, {
                                        declaredClass: "esri.OperationBase", type: "not implemented", label: "not implemented", constructor: function (w) {
                                                w =
                                                w || {}; w.label && (this.label = w.label)
                                        }, performUndo: function () { console.log("performUndo has not been implemented") }, performRedo: function () { console.log("performRedo has not been implemented") }
                                }); q("extend-esri") && (A.OperationBase = E); return E
                        })
                }, "jimu/dijit/DropdownMenu": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/query dojo/Evented".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                return E([q, A, k], {
                                        baseClass: "jimu-dijit-dropdownmenu",
                                        declaredClass: "jimu.dijit.DropdownMenu", templateString: "\x3cdiv\x3e\x3c/div\x3e", itemHeight: 24, iconSize: 16, offsetY: 5, shelter: null, paddingOffsetY: 8, dropdownMenuClass: "", dropdownMenuItemClass: "dropdown-menu-item", items: null, highlightValue: "", highlightSelectedItemAfterClick: !0, menuLeadingIcon: !0, maxDisplayItems: 10, postCreate: function () {
                                                this.inherited(arguments); this.items || (this.items = []); this.shelter = v.toDom('\x3cdiv class\x3d"jimu-dijit-dropdownmenu-shelter"\x3e\x3c/div\x3e'); this.itemsContainer = v.toDom('\x3cdiv class\x3d"jimu-dijit-dropdownmenu-items-container ' +
                                                        this.dropdownMenuClass + '"\x3e\x3c/div\x3e'); 0 >= this.maxDisplayItems && (this.maxDisplayItems = 20); this.itemsContainer.style.maxHeight = this.itemHeight * this.maxDisplayItems + 2 * this.paddingOffsetY + "px"; m.forEach(this.items, w.hitch(this, function (n) { var d = v.toDom('\x3cdiv class\x3d"' + this.dropdownMenuItemClass + ' jimu-ellipsis"\x3e' + n.label + "\x3c/div\x3e"); d.itemInfo = n; d.title = n.label; v.place(d, this.itemsContainer) })); this.own(r(this.domNode, "click", w.hitch(this, this._onIconClick))); this.own(r(this.shelter,
                                                                "click", w.hitch(this, this._onShelterClick))); this.own(r(this.itemsContainer, "click", w.hitch(this, this._onItemsContainerClick))); this.highlightValue && this.setHighlightValue(this.highlightValue)
                                        }, _onIconClick: function (n, d) { n.stopPropagation(); this.isShowing() ? this.hideMenu() : (n = v.position(d || n.target || n.srcElement), this.showMenu(n)) }, _onShelterClick: function () { this.hideMenu() }, _onItemsContainerClick: function (n) {
                                                n.stopPropagation(); n = n.target || n.srcElement; v.hasClass(n, this.dropdownMenuItemClass) && (n =
                                                        n.itemInfo.value, this.highlightSelectedItemAfterClick && this.setHighlightValue(n), this.emit("click-item", n)); this.hideMenu()
                                        }, clearHighlightValue: function () { l("." + this.dropdownMenuItemClass, this.itemsContainer).removeClass("selected") }, setHighlightValue: function (n) { this.clearHighlightValue(); l("." + this.dropdownMenuItemClass, this.itemsContainer).some(w.hitch(this, function (d) { return d.itemInfo.value === n ? (v.addClass(d, "selected"), !0) : !1 })) }, getHighlightValue: function () {
                                                var n = l("." + this.dropdownMenuItemClass +
                                                        ".selected", this.itemsContainer)[0]; return n ? n.itemInfo.value : null
                                        }, getHighlightLabel: function () { var n = this.getHighlightValue(), d = ""; m.some(this.items, function (c) { return c.value === n ? (d = c.label, !0) : !1 }, this); return d }, isShowing: function () { return v.hasClass(this.domNode, "showing") }, showMenu: function (n) {
                                                this.itemsContainer.style.top = n.y + this.iconSize + this.offsetY + "px"; this.menuLeadingIcon === window.isRTL ? (this.itemsContainer.style.left = n.x + "px", this.itemsContainer.style.right = "auto") : (this.itemsContainer.style.right =
                                                        window.innerWidth - (n.x + this.iconSize) + "px", this.itemsContainer.style.left = "auto"); v.place(this.shelter, document.body); v.place(this.itemsContainer, document.body); v.addClass(this.domNode, "showing")
                                        }, hideMenu: function () { this.itemsContainer.parentNode && this.itemsContainer.parentNode.removeChild(this.itemsContainer); this.shelter.parentNode && this.shelter.parentNode.removeChild(this.shelter); v.removeClass(this.domNode, "showing") }, destroy: function () {
                                                this.hideMenu(); v.destroy(this.itemsContainer); v.destroy(this.shelter);
                                                this.inherited(arguments)
                                        }
                                })
                        })
                }, "jimu/FilterManager": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/topic", "esri/lang", "./LayerInfos/LayerInfos"], function (E, q, A, w, m) {
                                var v = null, r = E(null, {
                                        _filters: null, layerInfos: null, constructor: function () {
                                                this._filters = {}; window.isBuilder ? (A.subscribe("app/mapLoaded", q.hitch(this, this._onMapLoaded)), A.subscribe("app/mapChanged", q.hitch(this, this._onMapChanged))) : (A.subscribe("mapLoaded", q.hitch(this, this._onMapLoaded)), A.subscribe("mapChanged", q.hitch(this,
                                                        this._onMapChanged))); A.subscribe("widgetDestroyed", q.hitch(this, this._onWidgetDestroyed))
                                        }, getWidgetFilter: function (l, k) { return q.getObject(l + ".filterExprs." + k, !1, this._filters) }, applyWidgetFilter: function (l, k, n, d, c, g) {
                                                var b = "object" === typeof l ? l : null; b && (l = b.layerId, k = b.widgetId, n = b.expression, d = b.enableMapFilter, c = b.useAND, g = b.zoomAfterFilter); this._setFilterExp(l, k, n, d, c); k = this.layerInfos.getLayerInfoById(l) || this.layerInfos.getTableInfoById(l); l = this.getFilterExp(l); null !== l && k && k.setFilter(l,
                                                        { zoomAfterFilter: g })
                                        }, _onMapLoaded: function () { this.layerInfos = m.getInstanceSync(); this._traversalFilter() }, _onMapChanged: function () { this.layerInfos = m.getInstanceSync(); this._traversalFilter() }, _onWidgetDestroyed: function (l) { for (var k in this._filters) if (this._filters[k]) { var n = this._filters[k]; if (n) { var d = n.filterExprs; n = n.mapFilterControls; d && delete d[l]; n && delete n[l] } } }, _traversalFilter: function () {
                                                this.layerInfos.traversalAll(q.hitch(this, function (l) {
                                                        this._filters[l.id] || (this._filters[l.id] = {
                                                                definitionExpression: l.getFilter(),
                                                                filterExprs: {}, mapFilterControls: {}
                                                        })
                                                }))
                                        }, _getPriorityOfMapFilter: function (l) { l = q.getObject(l + ".mapFilterControls", !1, this._filters); var k = 0, n; for (n in l) { var d = l[n]; d.priority > k && (k = d.priority) } return k }, _getMapFilterControl: function (l) { l = q.getObject(l + ".mapFilterControls", !1, this._filters); var k = 0, n = null, d; for (d in l) { var c = l[d]; c.priority > k && (k = c.priority, n = c) } return n }, _setFilterExp: function (l, k, n, d, c) {
                                                var g = l + ".filterExprs." + k, b = l + ".mapFilterControls." + k; n ? (q.setObject(g, n, this._filters), w.isDefined(d) &&
                                                        (l = this._getPriorityOfMapFilter(l), q.setObject(b, { enable: d, useAND: c, priority: l + 1 }, this._filters))) : (q.getObject(g, !1, this._filters) && delete this._filters[l].filterExprs[k], q.getObject(b, !1, this._filters) && delete this._filters[l].mapFilterControls[k])
                                        }, getFilterExp: function (l, k) {
                                                if (!this._filters[l]) return null; var n = [], d = this._filters[l].definitionExpression, c = this._filters[l].filterExprs; l = this._getMapFilterControl(l); for (var g in c) { var b = c[g]; k && 0 <= g.indexOf(k) || b && n.push("(" + b + ")") } k = n.join(" AND ");
                                                return d && l && l.enable || d && null === l ? k ? l && !1 === l.useAND ? "(" + d + ") OR " + k : "(" + d + ") AND " + k : d : k
                                        }
                                }); r.getInstance = function () { if (null === v) v = new r, window._filterManager = v; else return v }; return r
                        })
                }, "jimu/DataManager": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/topic"], function (E, q, A) {
                                var w = null; var m = E(null, {
                                        constructor: function (v) {
                                                A.subscribe("publishData", q.hitch(this, this.onDataPublished)); A.subscribe("fetchData", q.hitch(this, this.onFetchData)); A.subscribe("clearAllData", q.hitch(this,
                                                        this.onClearAllData)); A.subscribe("removeData", q.hitch(this, this.onRemoveData)); A.subscribe("clearDataHistory", q.hitch(this, this.onClearDataHistory)); this.widgetManager = v
                                        }, _dataStore: {}, onDataPublished: function (v, r, l, k) { "undefined" === typeof k && (k = !1); this._dataStore[r] ? (this._dataStore[r].current = l, k && (this._dataStore[r].history ? this._dataStore[r].history.push(l) : this._dataStore[r].history = [l])) : (this._dataStore[r] = { current: l }, k && (this._dataStore[r].history = [l])) }, onFetchData: function (v) {
                                                var r; if (v) "framework" ===
                                                        v ? this._dataStore[v] ? A.publish("dataFetched", "framework", "framework", this._dataStore[v].current, this._dataStore[v].history) : A.publish("noData", "framework", "framework") : (r = this.widgetManager.getWidgetById(v)) ? this._dataStore[v] ? A.publish("dataFetched", r.name, v, this._dataStore[v].current, this._dataStore[v].history) : A.publish("noData", r.name, v) : A.publish("noData", void 0, v); else {
                                                                for (var l in this._dataStore) (r = this.widgetManager.getWidgetById(l)) && A.publish("dataFetched", r.name, l, this._dataStore[l].current,
                                                                        this._dataStore[l].history); r || A.publish("noData", void 0, void 0)
                                                }
                                        }, onClearAllData: function () { this._dataStore = {}; A.publish("allDataCleared") }, onRemoveData: function (v) { delete this._dataStore[v]; A.publish("dataRemoved", v) }, onClearDataHistory: function (v) { this._dataStore[v] && (this._dataStore[v].history = []); A.publish("dataHistoryCleared", v) }
                                }); m.getInstance = function (v) { null === w && (w = new m(v)); return w }; return m
                        })
                }, "jimu/SelectionManager": function () {
                        define("dojo/_base/declare dojo/_base/Deferred dojo/_base/lang dojo/_base/array dojo/topic dojo/on esri/layers/FeatureLayer esri/layers/GraphicsLayer esri/geometry/geometryEngine esri/graphic esri/Color esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                        var e = null, a = E(null, {
                                                constructor: function () { window.isBuilder ? (m.subscribe("app/mapLoaded", A.hitch(this, this._onMapLoaded)), m.subscribe("app/mapChanged", A.hitch(this, this._onMapChanged))) : (m.subscribe("mapLoaded", A.hitch(this, this._onMapLoaded)), m.subscribe("mapChanged", A.hitch(this, this._onMapChanged))) }, _displayLayers: {}, previousMapScale: null, setSelectionSymbol: function (f) {
                                                        var h = f.geometryType, p = new c(c.STYLE_CIRCLE, 16, null, d.fromArray([0, 255, 255])), B = new g(g.STYLE_SOLID,
                                                                d.fromArray([0, 255, 255]), 2), t = new b(b.STYLE_SOLID, B, d.fromArray([0, 255, 255, .3])); "esriGeometryPoint" === h ? f.setSelectionSymbol(p) : "esriGeometryPolyline" === h ? f.setSelectionSymbol(B) : "esriGeometryPolygon" === h && f.setSelectionSymbol(t)
                                                }, updateSelectionByFeatures: function (f, h, p) {
                                                        0 < h.length && (h = w.map(h, A.hitch(this, function (t) { var u = null; u = 0 <= f.graphics.indexOf(t) ? new n(t.toJson()) : t; u.wabIsTemp = !0; return u }))); f.getSelectionSymbol() || this.setSelectionSymbol(f); var B = new q; f._selectHandler({ features: h },
                                                                p, null, null, B); this._isLayerNeedDisplayLayer(f) && (this._displayLayers[f.id] || (this._displayLayers[f.id] = this._createDisplayLayer(f)), this._updateDisplayLayer(f, h, p)); return B
                                                }, getDisplayLayer: function (f) { return this._displayLayers[f] }, setSelection: function (f, h) { return this.updateSelectionByFeatures(f, h, r.SELECTION_NEW) }, addFeaturesToSelection: function (f, h) { return this.updateSelectionByFeatures(f, h, r.SELECTION_ADD) }, removeFeaturesFromSelection: function (f, h) {
                                                        return this.updateSelectionByFeatures(f,
                                                                h, r.SELECTION_SUBTRACT)
                                                }, clearSelection: function (f) { var h = new q; this.clearDisplayLayer(f); f.clearSelection(); h.resolve(); return h }, clearDisplayLayer: function (f) { (f = this._displayLayers[f.id]) && f.clear() }, getClientFeaturesByGeometry: function (f, h, p) { return w.filter(f.graphics, A.hitch(this, function (B) { return B.geometry ? p ? k.contains(h, B.geometry) : k.intersects(h, B.geometry) : !1 })) }, getUnionGeometryBySelectedFeatures: function (f) {
                                                        var h = null; f = f.getSelectedFeatures(); 0 < f.length && (h = w.map(f, A.hitch(this, function (p) { return p.geometry })),
                                                                h = k.union(h)); return h
                                                }, _createDisplayLayer: function (f) {
                                                        var h = new l, p = f.objectIdField; h.fields = f.fields; h.id = "displayLayer_of_" + f.id; this.map.addLayer(h); if (!this.map.spatialReference.equals(f.spatialReference) || f.hasWebGLSurface()) {
                                                                var B = f.getSelectionSymbol(); v(f, "update-end", A.hitch(this, function () {
                                                                        var t = Math.round(this.map.getScale()); if (this.previousMapScale !== t && h.graphics && 0 < h.graphics.length) {
                                                                                this.previousMapScale = t; var u = w.map(h.graphics, function (z) { return z.attributes[p] }); t = w.filter(f.graphics,
                                                                                        function (z) { return 0 <= u.indexOf(z.attributes[p]) }); h.clear(); w.forEach(t, A.hitch(this, function (z) { z = new n(z.toJson()); z.setSymbol(B); h.add(z) }))
                                                                        }
                                                                }))
                                                        } return h
                                                }, _updateDisplayLayer: function (f, h, p) { var B = this._displayLayers[f.id], t = f.getSelectionSymbol(); f.hasWebGLSurface() ? this._updateDisplayLayerWebGL(f, B, t, h, p) : (h = f.getSelectedFeatures(), this.clearDisplayLayer(f), w.forEach(h, A.hitch(this, function (u) { u.visible && (u.setSymbol(null), u = new n(u.toJson()), u.setSymbol(t), B.add(u)) }))) }, _updateDisplayLayerWebGL: function (f,
                                                        h, p, B, t) {
                                                                t === r.SELECTION_NEW && (f._selectedFeaturesWebGL = {}); t === r.SELECTION_NEW || t === r.SELECTION_ADD ? w.forEach(B, A.hitch(this, function (z) { z.visible && (f._selectedFeaturesWebGL[z.attributes[f.objectIdField]] = z) })) : t === r.SELECTION_SUBTRACT && w.forEach(B, A.hitch(this, function (z) { z = z.attributes[f.objectIdField]; z in f._selectedFeaturesWebGL && delete f._selectedFeaturesWebGL[z] })); this.clearDisplayLayer(f); for (var u in f._selectedFeaturesWebGL) B = new n(f._selectedFeaturesWebGL[u].toJson()), B.setSymbol(p),
                                                                        h.add(B)
                                                }, _isLayerNeedDisplayLayer: function (f) { return f.hasWebGLSurface() || !f.getMap() }, _onMapLoaded: function (f) { this.map = f }, _onMapChanged: function (f) { this.map = f }
                                        }); a.getInstance = function () { e || (e = new a, window._selectionManager = e); return e }; return a
                                })
                }, "jimu/BaseWidget": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dijit/_WidgetBase jimu/dijit/BindLabelPropsMixin dijit/_TemplatedMixin jimu/utils ./PanelManager".split(" "), function (E, q, A, w, m, v, r, l,
                                k, n) {
                                        return E([v, r, l], {
                                                type: "widget", id: void 0, label: void 0, icon: void 0, uri: void 0, position: {}, config: void 0, openAtStart: !1, map: null, appConfig: null, folderUrl: null, state: "closed", windowState: "normal", started: !1, name: "", baseClass: null, templateString: "\x3cdiv\x3e\x3c/div\x3e", moveTopOnActive: !0, constructor: function () {
                                                        this.listenWidgetNames = []; this.listenWidgetIds = []; this.own(m.subscribe("publishData", q.hitch(this, this._onReceiveData))); this.own(m.subscribe("dataFetched", q.hitch(this, this._onReceiveData)));
                                                        this.own(m.subscribe("noData", q.hitch(this, this._onNoData))); this.own(m.subscribe("dataSourceDataUpdated", q.hitch(this, this.onDataSourceDataUpdate)))
                                                }, startup: function () { this.inherited(arguments); this.started = !0 }, onOpen: function () { }, onClose: function () { }, onNormalize: function () { }, onMinimize: function () { }, onMaximize: function () { }, onActive: function () { }, onDeActive: function () { }, onSignIn: function (d) { }, onSignOut: function () { }, onPositionChange: function (d) { this.setPosition(d) }, setPosition: function (d, c) {
                                                        this.position =
                                                        d; var g = k.getPositionStyle(this.position); g.position = "absolute"; c || (c = "map" === d.relativeTo ? this.map.id : window.jimuConfig.layoutId); w.place(this.domNode, c); w.setStyle(this.domNode, g); this.started && this.resize()
                                                }, getPosition: function () { return this.position }, getMarginBox: function () { return w.getMarginBox(this.domNode) }, setMap: function (d) { this.map = d }, setState: function (d) { this.state = d }, setWindowState: function (d) { this.windowState = d }, resize: function () { }, onConfigChanged: function (d) { }, onAppConfigChanged: function (d,
                                                        c, g) { }, onAction: function (d, c) { }, getPanel: function () { if (!1 === this.inPanel) return null; if ("widgetOnScreen" === this.gid || "widgetPool" === this.gid) return n.getInstance().getPanelById(this.id + "_panel"); var d = n.getInstance().getPanelById(this.gid + "_panel"); return d ? d : n.getInstance().getPanelById(this.id + "_panel") }, publishData: function (d, c) { "undefined" === typeof c && (c = !1); m.publish("publishData", this.name, this.id, d, c) }, fetchData: function (d) {
                                                                d ? m.publish("fetchData", d) : 0 !== this.listenWidgetIds.length ? A.forEach(this.listenWidgetIds,
                                                                        function (c) { m.publish("fetchData", c) }, this) : m.publish("fetchData")
                                                        }, fetchDataByName: function (d) { d = this.widgetManager.getWidgetsByName(d); A.forEach(d, function (c) { this.fetchData(c.id) }, this) }, openWidgetById: function (d) { return this.widgetManager.triggerWidgetOpen(d) }, _onReceiveData: function (d, c, g, b) { if (c !== this.id && !(0 !== this.listenWidgetIds.length && 0 > this.listenWidgetIds.indexOf(c))) this.onReceiveData(d, c, g, b) }, onReceiveData: function (d, c, g, b) { }, updateDataSourceData: function (d, c) {
                                                                m.publish("updateDataSourceData",
                                                                        "widget~" + this.id + "~" + d, c)
                                                        }, onDataSourceDataUpdate: function (d, c) { }, _onNoData: function (d, c) { if (!(0 !== this.listenWidgetIds.length && 0 > this.listenWidgetIds.indexOf(c))) this.onNoData(d, c) }, onNoData: function (d, c) { }
                                        })
                        })
                }, "jimu/dijit/BindLabelPropsMixin": function () {
                        define(["dojo/_base/declare", "dojo/_base/html", "dojo/query", "dojo/_base/array", "jimu/utils"], function (E, q, A, w, m) {
                                return E("jimu-bind-label-props-mixin", null, {
                                        isRenderIdForAttrs: !1, buildRendering: function () {
                                                this.inherited(arguments); if (this.isRenderIdForAttrs) {
                                                        var v =
                                                                A("[data-a11y-label-id],[data-a11y-label-by], [data-label-for], [data-label-id]", this.domNode); (q.getAttr(this.domNode, "data-a11y-label-id") || q.getAttr(this.domNode, "data-a11y-label-by") || q.getAttr(this.domNode, "data-label-for") || q.getAttr(this.domNode, "data-label-id")) && v.unshift(this.domNode); var r = {}, l = [], k = {}, n = 0, d = "jimuUniqName_" + m.getUUID(); w.forEach(v, function (f) {
                                                                        var h = q.getAttr(f, "data-a11y-label-id"), p = q.getAttr(f, "data-a11y-label-by"), B = q.getAttr(f, "data-label-for"), t = q.getAttr(f, "data-label-id");
                                                                        h ? (q.removeAttr(f, "data-a11y-label-id"), a = d + "_" + n, q.setAttr(f, "id", a), r[h] = a, n++) : p ? l.push(f) : B ? (k.hasOwnProperty(B) || (k[B] = {}), k[B].forDom = f) : (k.hasOwnProperty(t) || (k[t] = {}), k[t].idDom = f)
                                                                }); for (var c in l) { v = l[c]; var g = q.getAttr(v, "data-a11y-label-by").split(" "), b = []; w.forEach(g, function (f) { b.push(r[f]) }); q.removeAttr(v, "data-a11y-label-by"); q.setAttr(v, "aria-labelledby", b.join(" ")) } for (var e in k) {
                                                                        var a = d + "_" + n; c = k[e].forDom; v = k[e].idDom; c && (q.removeAttr(c, "data-label-for"), q.setAttr(c, "for",
                                                                                a)); v && (q.removeAttr(v, "data-label-id"), q.setAttr(v, "id", a)); n++
                                                                }
                                                }
                                        }
                                })
                        })
                }, "jimu/PanelManager": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/promise/all dojo/on dojo/topic dojo/when require ./utils ./WidgetManager".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                var b = null; var e = E(null, {
                                        constructor: function () {
                                                this.panels = []; this.widgetManager = g.getInstance(); l(window, "resize", q.hitch(this, this.onWindowResize)); this.activePanel =
                                                        null; k.subscribe("/dnd/move/start", q.hitch(this, this._onMoveStart)); k.subscribe("widgetActived", q.hitch(this, this._onWidgetActived))
                                        }, showPanel: function (a) {
                                                var f = new v, h = this.getPanelById(a.id + "_panel"); h ? ("closed" === h.state && this.openPanel(h), f.resolve(h)) : r({ Panel: this._loadPanelClass(a.panel.uri), nls: this._loadThemeI18N(a.panel.uri) }).then(q.hitch(this, function (p) {
                                                        var B = a.id + "_panel", t = this.getPanelById(B), u = {
                                                                label: a.label, config: a, uri: a.panel.uri, position: a.panel.position, map: this.map, widgetManager: this.widgetManager,
                                                                panelManager: this, id: B, gid: a.gid, nls: p.nls
                                                        }; q.mixin(u, a.panel.options); try { t = new p.Panel(u), console.log("panel [" + B + "] created.") } catch (z) { console.log("create panel error: " + z + ", panelId: " + B); f.reject(z); return } t.setPosition(a.panel.position); c.setVerticalCenter(t.domNode); this.openPanel(t); t.domNode.addEventListener("click", q.hitch(this, this._onPanelClick, t), { capture: !0 }); f.resolve(t)
                                                })); return f
                                        }, setMap: function (a) { this.map = a; l(this.map, "resize", q.hitch(this, this.onMapResize)) }, closeOtherPanelsInTheSameGroup: function (a) {
                                                if ("string" ===
                                                        typeof a && (a = this.getPanelById(a), !a)) return; for (var f = 0; f < this.panels.length; f++)this.panels[f].gid === a.gid && this.panels[f].id !== a.id && this.closePanel(this.panels[f])
                                        }, closeAllPanelsInGroup: function (a) { for (var f = 0; f < this.panels.length; f++)this.panels[f].gid === a && this.closePanel(this.panels[f]) }, openPanel: function (a) {
                                                var f = new v; if ("string" === typeof a) { if (a = this.getPanelById(a), !a) return f.reject(), f } else this.panels.some(function (h) { return h.id === a.id }) || this.panels.push(a); if (!a.started) try {
                                                        a.started =
                                                        !0, a.startup()
                                                } catch (h) { console.error("fail to startup panel " + a.id + ". " + h.stack) } if ("opened" === a.state) return this._activePanel(a), f.resolve(a), f; a.setState("opened"); return this.playOpenPanelAnimation(a).then(q.hitch(this, function () { w.setStyle(a.domNode, "display", ""); a.onOpen(); this._activePanel(a); return a }))
                                        }, closePanel: function (a) {
                                                var f = new v; return "string" === typeof a && (a = this.getPanelById(a), !a) || "closed" === a.state ? (f.resolve(), f) : this.playClosePanelAnimation(a).then(q.hitch(this, function () {
                                                        this.activePanel &&
                                                        this.activePanel.id === a.id && (this.activePanel.onDeActive(), this.activePanel = null); a.setState("closed"); a.onClose(); a.domNode && w.setStyle(a.domNode, "display", "none")
                                                }))
                                        }, minimizePanel: function (a) { if ("string" === typeof a && (a = this.getPanelById(a), !a)) return; "closed" === a.state && this.openPanel(a); a.setWindowState("minimized"); try { a.onMinimize() } catch (f) { console.log(console.error("fail to minimize panel " + a.id + ". " + f.stack)) } }, maximizePanel: function (a) {
                                                if ("string" === typeof a && (a = this.getPanelById(a), !a)) return;
                                                "closed" === a.state && this.openPanel(a); a.setWindowState("maximized"); try { a.onMaximize() } catch (f) { console.log(console.error("fail to maximize panel " + a.id + ". " + f.stack)) }
                                        }, normalizePanel: function (a) { if ("string" === typeof a && (a = this.getPanelById(a), !a)) return; "closed" === a.state && this.openPanel(a); a.setWindowState("normal"); try { a.onNormalize() } catch (f) { console.log(console.error("fail to noralize panel " + a.id + ". " + f.stack)) } }, changeWindowStateTo: function (a, f) {
                                                if ("string" === typeof a && (a = this.getPanelById(a),
                                                        !a)) return; "normal" === f ? this.normalizePanel(a) : "minimized" === f ? this.minimizePanel(a) : "maximized" === f ? this.maximizePanel(a) : console.log("error state: " + f)
                                        }, getPanelById: function (a) { for (var f = 0; f < this.panels.length; f++)if (this.panels[f].id === a) return this.panels[f] }, onWindowResize: function () { for (var a = 0; a < this.panels.length; a++)"closed" !== this.panels[a].state && "map" !== this.panels[a].position.relativeTo && this.panels[a].resize() }, onMapResize: function () {
                                                for (var a = 0; a < this.panels.length; a++)"closed" !==
                                                        this.panels[a].state && "map" === this.panels[a].position.relativeTo && this.panels[a].resize()
                                        }, destroyPanel: function (a) { if ("string" === typeof a && (a = this.getPanelById(a), !a)) return; if (a.domNode) { "closed" !== a.state && this.closePanel(a); this._removePanel(a); try { a.destroy() } catch (f) { console.log(console.error("fail to destroy panel " + a.id + ". " + f.stack)) } } }, destroyAllPanels: function () { var a = A.map(this.panels, function (f) { return f.id }); A.forEach(a, function (f) { this.destroyPanel(f) }, this); this.panels = [] }, playOpenPanelAnimation: function (a) {
                                                if ("string" ===
                                                        typeof a && (a = this.getPanelById(a), !a) || !a.openAnimation || 0 === a.animationDuration) return n(); var f = new v; "string" === typeof a.openAnimation ? "fadeIn" === a.openAnimation ? (w.setStyle(a.domNode, { opacity: 0, display: "" }), m.fadeIn({ node: a.domNode, duration: a.animationDuration, onEnd: function () { f.resolve() } }).play()) : f.resolve() : f.resolve(); return f
                                        }, playClosePanelAnimation: function (a) {
                                                if ("string" === typeof a && (a = this.getPanelById(a), !a) || !a.closeAnimation || 0 === a.animationDuration) return n(); var f = new v; "string" ===
                                                        typeof a.closeAnimation && ("fadeOut" === a.closeAnimation ? m.fadeOut({ node: a.domNode, duration: a.animationDuration, onEnd: function () { f.resolve() } }).play() : f.resolve()); return f
                                        }, getPositionOnMobile: function (a) {
                                                if ("string" === typeof a && (a = this.getPanelById(a), !a)) return {}; var f = w.getMarginBox(window.jimuConfig.layoutId), h = f.h / 2; a.titleHeight || (a.titleHeight = 35); return "maximized" === a.windowState ? {
                                                        left: 0, right: 0, top: 0, bottom: 0, width: "auto", height: "auto", contentHeight: f.h - a.titleHeight, borderRadiusStyle: {
                                                                borderTopLeftRadius: 0,
                                                                borderTopRightRadius: 0, borderBottomLeftRadius: 0, borderBottomRightRadius: 0
                                                        }
                                                } : "minimized" === a.windowState ? (h = 0, this.panels.filter(function (p) { return "minimized" === p.windowState && "closed" !== p.state && p.id !== a.id }).some(function (p) { return 0 === p._mobileBottom }) && (h = a.titleHeight), a._mobileBottom = h, f.h > f.w ? { left: 0, right: 0, top: "auto", bottom: h, width: "auto", height: a.titleHeight, contentHeight: 0, borderRadiusStyle: { borderTopLeftRadius: "4px", borderTopRightRadius: "4px", borderBottomLeftRadius: 0, borderBottomRightRadius: 0 } } :
                                                        { left: f.w - f.w / 2, right: 0, top: "auto", bottom: h, width: f.w / 2, height: a.titleHeight, contentHeight: f.h, borderRadiusStyle: window.isRTL ? { borderTopLeftRadius: 0, borderTopRightRadius: "4px", borderBottomLeftRadius: 0, borderBottomRightRadius: "4px" } : { borderTopLeftRadius: "4px", borderTopRightRadius: 0, borderBottomLeftRadius: "4px", borderBottomRightRadius: 0 } }) : f.h > f.w ? {
                                                                left: 0, right: 0, top: h, bottom: 0, width: "auto", height: "auto", contentHeight: f.h - h - a.titleHeight, borderRadiusStyle: {
                                                                        borderTopLeftRadius: "4px", borderTopRightRadius: "4px",
                                                                        borderBottomLeftRadius: 0, borderBottomRightRadius: 0
                                                                }
                                                        } : { left: f.w - f.w / 2, right: 0, top: 0, bottom: 0, width: f.w / 2, height: "auto", contentHeight: f.h - h - a.titleHeight, borderRadiusStyle: window.isRTL ? { borderTopLeftRadius: 0, borderTopRightRadius: "4px", borderBottomLeftRadius: 0, borderBottomRightRadius: "4px" } : { borderTopLeftRadius: "4px", borderTopRightRadius: 0, borderBottomLeftRadius: "4px", borderBottomRightRadius: 0 } }
                                        }, _onPanelClick: function (a) { this._activePanel(a) }, activatePanel: function (a) { "closed" !== a.state && this._activePanel(a) },
                                        _activePanel: function (a) {
                                                if (this.activePanel) { if (this.activePanel.id === a.id) { this.activePanel.moveTopOnActive && w.setStyle(this.activePanel.domNode, "zIndex", 101); return } "active" === this.activePanel.state && (this.activePanel.setState("opened"), w.setStyle(this.activePanel.domNode, "zIndex", "undefined" !== typeof this.activePanel.position.zIndex ? this.activePanel.position.zIndex : "auto"), this.activePanel.onDeActive()) } var f = this.widgetManager.activeWidget; f && "active" === f.state && f.getPanel() !== a && (f.setState("opened"),
                                                        !1 === f.inPanel && w.setStyle(f.domNode, "zIndex", "undefined" !== typeof f.position.zIndex ? f.position.zIndex : "auto"), f.onDeActive(), this.widgetManager.activeWidget = null); this.activePanel = a; "active" !== this.activePanel.state && (this.activePanel.setState("active"), this.activePanel.moveTopOnActive && w.setStyle(this.activePanel.domNode, "zIndex", 101), this.activePanel.onActive())
                                        }, _removePanel: function (a) {
                                                var f = this.panels.indexOf(a); -1 < f && this.panels.splice(f, 1); this.activePanel && this.activePanel.id === a.id && (this.activePanel =
                                                        null)
                                        }, _onMoveStart: function (a) { A.forEach(this.panels, function (f) { f.domNode === a.node && this._activePanel(f) }, this) }, _onWidgetActived: function (a) { this.activePanel && "active" === this.activePanel.state && a.getPanel() !== this.activePanel && (this.activePanel.setState("opened"), w.setStyle(this.activePanel.domNode, "zIndex", "undefined" !== typeof this.activePanel.position.zIndex ? this.activePanel.position.zIndex : "auto"), this.activePanel.onDeActive(), this.activePanel = null) }, _loadPanelClass: function (a) {
                                                var f = new v;
                                                d([a], function (h) { f.resolve(h) }); return f
                                        }, _loadThemeI18N: function (a) { var f = new v; a.startWith("themes") ? (a = a.split("/"), d(["dojo/i18n!" + (a[0] + "/" + a[1] + "/nls/strings")], function (h) { f.resolve(h) })) : f.resolve({}); return f }
                                }); e.getInstance = function () { null === b && (b = new e, window._panelManager = b); return b }; return e
                        })
                }, "jimu/BaseWidgetFrame": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/_base/html", "dijit/_WidgetBase"], function (E, q, A, w) {
                                return E([w], {
                                        widget: null, baseClass: "jimu-widget-frame jimu-container",
                                        postCreate: function () { this.inherited(arguments); this.containerNode || (this.containerNode = this.domNode); this.widget && this.setWidget(this.widget) }, startup: function () { this.inherited(arguments); this.widget && this.widget.startup() }, resize: function () { this.widget && "closed" !== this.widget.state && q.isFunction(this.widget.resize) && this.widget.resize() }, setLoading: function (m) { this.loading = m; this.loading.placeAt(this.containerNode) }, getWidget: function () { return this.widget }, setWidget: function (m) {
                                                this.widget = m; this.loading &&
                                                        this.loading.destroy(); A.place(m.domNode, this.containerNode); this.resize()
                                        }, destroy: function () { if (this.widget && this.widget.domNode) try { this.widget.destroy() } catch (m) { console.error("destroy widget error. widget: [" + this.widget.uri + "], " + m.stack) } this.loading && this.loading.domNode && this.loading.destroy() }
                                })
                        })
                }, "jimu/BaseWidgetPanel": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_Container ./a11y/BaseWidgetPanel ./dijit/LoadingIndicator ./BaseWidgetFrame ./utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        E = E([m, v], {
                                                baseClass: "jimu-panel jimu-container", started: !1, state: "closed", windowState: "normal", moveTopOnActive: !0, openAnimation: null, closeAnimation: null, animationDuration: 0, startup: function () { this.inherited(arguments); this.loadAllWidgetsInOrder(); this.started = !0 }, loadAllWidgetsInOrder: function () {
                                                        var d = this.getAllWidgetConfigs(); Array.isArray(this.config.widgets) ? (d = this.config.widgets, 1 < d.length && this._addTagToGroupPanel()) : d = [this.config]; A.forEach(d, function (c, g) {
                                                                if (!1 !==
                                                                        c.visible) { var b = new l; var e = this.createFrame(c); this._initFrameEvents(e, c, g); this.addChild(e); e.setLoading(b); this.widgetManager.loadWidget(c).then(q.hitch(this, function (a) { e.setWidget(a); a.startup() })) }
                                                        }, this)
                                                }, getAllWidgetConfigs: function () { var d = []; return d = Array.isArray(this.config.widgets) ? this.config.widgets : [this.config] }, getWidgetById: function (d) { for (var c = this.getChildren(), g = 0; g < c.length; g++)if (c[g].getWidget() && c[g].getWidget().id === d) return c[g].getWidget() }, getWidgets: function () { return this.getChildren().map(function (d) { return d.getWidget() }) },
                                                createFrame: function (d) { return new k }, setPosition: function (d, c) { this.position = d; var g = n.getPositionStyle(this.position); g.position = "absolute"; c || (c = "map" === d.relativeTo ? this.map.id : window.jimuConfig.layoutId); this.started ? this.resize() : this.openAnimation && (g.display = "none"); w.place(this.domNode, c); w.setStyle(this.domNode, g) }, getPosition: function () { return this.position }, setState: function (d) { this.state = d }, setWindowState: function (d) { this.windowState = d }, resize: function () { this.getChildren().forEach(function (d) { d.resize() }) },
                                                onPositionChange: function (d) { this.setPosition(d) }, onOpen: function () { A.forEach(this.getChildren(), function (d) { d.getWidget() && this.widgetManager.openWidget(d.getWidget()) }, this); this._onOpenAndFocus() }, onClose: function () { A.forEach(this.getChildren(), function (d) { d.getWidget() && this.widgetManager.closeWidget(d.getWidget()) }, this) }, onMaximize: function () { A.forEach(this.getChildren(), function (d) { d.getWidget() && this.widgetManager.maximizeWidget(d.getWidget()) }, this) }, onMinimize: function () {
                                                        A.forEach(this.getChildren(),
                                                                function (d) { d.getWidget() && this.widgetManager.minimizeWidget(d.getWidget()) }, this)
                                                }, onNormalize: function () { A.forEach(this.getChildren(), function (d) { d.getWidget() && this.widgetManager.normalizeWidget(d.getWidget()) }, this) }, onActive: function () { }, onDeActive: function () { }, updateConfig: function (d) { this._updateConfig(d) }, reloadWidget: function (d) {
                                                        this.isWidgetInPanel(d) && (this._updateConfig(d), this.getChildren().forEach(function (c) {
                                                                c.getWidget() && c.getWidget().id === d.id && (c.getWidget().destroy(), c.setLoading(new l),
                                                                        this.widgetManager.loadWidget(d).then(q.hitch(this, function (g) { c.setWidget(g); g.startup(); "closed" === this.state && this.widgetManager.closeWidget(g) })))
                                                        }, this))
                                                }, isWidgetInPanel: function (d) { return A.some(this.getAllWidgetConfigs(), function (c) { if (d.id === c.id) return !0 }) ? !0 : !1 }, _updateConfig: function (d) { if (Array.isArray(this.config.widgets)) { for (var c = -1, g = 0; g < this.config.widgets.length; g++)this.config.widgets[g].id === d.id && (c = g); 0 < c && (this.config.widgets[c] = d) } else this.config = d }, destroy: function () {
                                                        this.getChildren().forEach(function (d) {
                                                                try {
                                                                        d.domNode &&
                                                                        d.destroy()
                                                                } catch (c) { console.error("destroy widget frame error." + c.stack) }
                                                        }); this.inherited(arguments)
                                                }
                                        }); E.extend(r); return E
                                })
                }, "jimu/a11y/BaseWidgetPanel": function () {
                        define("dojo/_base/lang dojo/_base/html dojo/query dojo/on dojo/keys ./../utils".split(" "), function (E, q, A, w, m, v) {
                                var r = { frameSectionIndex: "91" }; r.panelNls = window.jimuNls.panelHeader; r._addTagToGroupPanel = function () { var l = this.config.widgets; this.isGroupPanel = !0; l.forEach(function (k) { k.inGroupPanel = !0 }) }; r._setAriaLabel = function (l,
                                        k) { if (l.folded) { var n = r.panelNls.expanded; q.setStyle(l.containerNode, "display", "inherit") } else n = r.panelNls.collapsed, q.setStyle(l.containerNode, "display", "none"); k = v.getSubstituteString(k, n); q.setAttr(l.titleNode, "aria-label", k) }; r._initFrameEvents = function (l, k, n) {
                                                if (this.isGroupPanel) {
                                                        var d = v.getSubstituteString(k.label, r.panelNls.expanded); k = v.getSubstituteString(k.label, r.panelNls.pressToFocus); q.setAttr(l.titleNode, "aria-label", d); q.setAttr(l.titleNode, "tabindex", r.frameSectionIndex); q.setAttr(l.containerNode,
                                                                "aria-label", k); q.setAttr(l.containerNode, "tabindex", r.frameSectionIndex); 0 === n ? this.firstTitleNode = l.titleNode : n === this.config.widgets.length - 1 && (this.lastTitleNode = l.titleNode, this.lastContent = l.containerNode); this.own(w(l.titleNode, "click", E.hitch(this, function () { l.foldEnable && this._setAriaLabel(l, l.label) }))); this.own(w(l.titleNode, "keydown", E.hitch(this, function (c) {
                                                                        q.hasClass(c.target, "title") && (c.keyCode === m.TAB ? c.target === this.firstTitleNode && c.shiftKey ? (c.preventDefault(), this.lastContent.focus()) :
                                                                                c.target !== this.lastTitleNode || c.shiftKey || "none" !== q.getStyle(this.lastContent, "display") || (c.preventDefault(), this.firstTitleNode.focus()) : !l.foldEnable || c.keyCode !== m.ENTER && c.keyCode !== m.SPACE || (c.stopPropagation(), this._setAriaLabel(l, l.label), l.onFoldableNodeClick()))
                                                                }))); this.own(w(l.containerNode, "keydown", E.hitch(this, function (c) {
                                                                        var g = c.target; q.hasClass(g, "jimu-panel-content") ? c.keyCode === m.ENTER ? (c = A(".jimu-widget", g)[0]) && v.focusFirstFocusNode(c) : c.target !== this.lastContent || c.shiftKey ||
                                                                                c.keyCode !== m.TAB || (c.preventDefault(), this.firstTitleNode.focus()) : c.keyCode === m.ESCAPE && (c.stopPropagation(), l.containerNode.focus())
                                                                })))
                                                }
                                        }; r._onOpenAndFocus = function () { this.config.openAtStart && !this._isFirstOpenAtStart ? this._isFirstOpenAtStart = !0 : this.isGroupPanel && this.firstTitleNode && this.firstTitleNode.focus() }; return r
                        })
                }, "jimu/BaseWidgetSetting": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/on", "dijit/_WidgetBase", "dijit/_TemplatedMixin"], function (E, q, A, w, m) {
                                return E([w,
                                        m], { templateString: "\x3cdiv\x3e\x3c/div\x3e", postCreate: function () { this.own(A(window, "resize", q.hitch(this, this._onWindowResize))) }, getConfig: function () { }, getDataSources: function () { }, resize: function () { }, _onWindowResize: function () { this.resize() } })
                        })
                }, "jimu/symbolUtils": function () {
                        define("require dojo/_base/lang dojo/_base/html dojox/gfx esri/symbols/jsonUtils esri/symbols/PictureMarkerSymbol".split(" "), function (E, q, A, w, m, v) {
                                return {
                                        cloneSymbol: function (r) {
                                                if (!r) return null; var l = null; try {
                                                        var k = r.toJson();
                                                        l = m.fromJson(k)
                                                } catch (n) { console.error(n) } return l
                                        }, getDefaultMarkerSymbol: function () { return m.fromJson({ style: "esriSMSCircle", color: [0, 0, 128, 128], name: "Circle", outline: { color: [0, 0, 128, 255], width: 1 }, type: "esriSMS", size: 18 }) }, getDefaultLineSymbol: function () { return m.fromJson({ tags: ["solid"], title: "Blue Thin", style: "esriSLSSolid", color: [79, 129, 189, 255], width: 3, name: "Blue 1", type: "esriSLS" }) }, getDefaultFillSymbol: function () {
                                                return m.fromJson({
                                                        tags: ["opaque"], title: "Blue", style: "esriSFSSolid", color: [79,
                                                                129, 189, 255], name: "Blue 6", type: "esriSFS", outline: { style: "esriSLSSolid", color: [54, 93, 141, 255], width: 1.5, type: "esriSLS" }
                                                })
                                        }, getHightlightMarkerSymbol: function () { return m.fromJson({ color: [255, 255, 255, 128], size: 18, angle: 0, xoffset: 0, yoffset: 0, type: "esriSMS", style: "esriSMSCircle", outline: { color: [0, 255, 255, 255], width: 1.5, type: "esriSLS", style: "esriSLSSolid" } }) }, getHightlightLineSymbol: function () { return m.fromJson({ color: [0, 255, 255, 255], width: 1.5, type: "esriSLS", style: "esriSLSSolid" }) }, getHightlightFillSymbol: function () {
                                                return m.fromJson({
                                                        color: [255,
                                                                255, 255, 128], outline: { color: [0, 255, 255, 255], width: 1.5, type: "esriSLS", style: "esriSLSSolid" }, type: "esriSFS", style: "esriSFSSolid"
                                                })
                                        }, getGreyPinMarkerSymbol: function () { var r = E.toUrl("jimu/css/images/grey_pin.png"); r = new v(r, 16, 16); r.setOffset(0, 8); return r }, createSymbolNode: function (r, l) {
                                                var k = 32, n = 32, d = A.create("div", {}, document.body); A.setStyle(d, "display", "inline-block"); if (l) k = l.width, n = l.height; else if (k = 80, n = 30, this.isSimpleMarkerSymbol(r)) n = k = Math.min(r.size + 12, 125); else if (this.isPictureMarkerSymbol(r)) {
                                                        if (!r.url ||
                                                                "http://" === r.url || -1 === r.url.indexOf("http://") && -1 === r.url.indexOf("https://") && -1 === r.url.indexOf("data:")) return; n = k = Math.min(Math.max(r.width, r.height), 125)
                                                } else if (this.isSimpleLineSymbol(r) || this.isCartographicLineSymbol(r)) k = 190, n = 20; var c = w.createSurface(d, k, n); if ("vml" === w.renderer) { var g = c.getEventSource(); A.setStyle(g, "position", "relative"); A.setStyle(g.parentNode, "position", "relative") } g = null; g = l ? m.getShapeDescriptors(r) : this.isSimpleLineSymbol(r) || this.isCartographicLineSymbol(r) ? this._getLineShapeDesc(r) :
                                                        m.getShapeDescriptors(r); try { var b = c.createShape(g.defaultShape); g.fill && b.setFill(g.fill); g.stroke && b.setStroke(g.stroke) } catch (e) { c.clear(); c.destroy(); return } r = c.getDimensions(); r = { dx: r.width / 2, dy: r.height / 2 }; c = b.getBoundingBox(); l = c.width; c = c.height; if (l > k || c > n) k = ((k < n ? k : n) - 5) / (l > c ? l : c), q.mixin(r, { xx: k, yy: k }); b.applyTransform(r); d && A.addClass(d, "symbol"); return d
                                        }, _getLineShapeDesc: function (r) {
                                                var l = null; if (this.isSimpleLineSymbol(r) || this.isCartographicLineSymbol(r)) l = {
                                                        defaultShape: {
                                                                type: "path",
                                                                path: "M -90,0 L 90,0 E"
                                                        }, fill: null, stroke: r.getStroke()
                                                }; return l
                                        }, isSimpleMarkerSymbol: function (r) { return r && "esri.symbol.SimpleMarkerSymbol" === r.declaredClass }, isPictureMarkerSymbol: function (r) { return r && "esri.symbol.PictureMarkerSymbol" === r.declaredClass }, isSimpleLineSymbol: function (r) { return r && "esri.symbol.SimpleLineSymbol" === r.declaredClass }, isCartographicLineSymbol: function (r) { return r && "esri.symbol.CartographicLineSymbol" === r.declaredClass }, isSimpleFillSymbol: function (r) {
                                                return r && "esri.symbol.SimpleFillSymbol" ===
                                                        r.declaredClass
                                        }, isPictureFillSymbol: function (r) { return r && "esri.symbol.PictureFillSymbol" === r.declaredClass }, isTextSymbol: function (r) { return r && "esri.symbol.TextSymbol" === r.declaredClass }
                                }
                        })
                }, "jimu/PoolControllerMixin": function () {
                        define(["dojo/_base/declare", "dojo/_base/array", "jimu/PanelManager"], function (E, q, A) {
                                return E(null, {
                                        constructor: function () { this.panelManager = A.getInstance() }, postCreate: function () {
                                                this.controlledWidgets || (this.controlledWidgets = "all"); this.controlledGroups || (this.controlledGroups =
                                                        "all")
                                        }, getOpenedIds: function () { }, setOpenedIds: function (w) { }, getConfigById: function (w) { for (var m = this.getAllConfigs(), v = 0; v < m.length; v++)if (m[v].id === w) return m[v] }, getAllConfigs: function () { var w = []; w = w.concat(this.getWidgetConfigs(), this.getGroupConfigs()); w = q.filter(w, function (m) { return m.visible }); return w.sort(function (m, v) { return m.index - v.index }) }, getAllConfigsIncludeInvisible: function () {
                                                var w = []; w = w.concat(this.getWidgetConfigs(), this.getGroupConfigs()); return w.sort(function (m, v) {
                                                        return m.index -
                                                                v.index
                                                })
                                        }, isControlled: function (w) { return q.some(this.getAllConfigsIncludeInvisible(), function (m) { return m.id === w }) }, widgetIsControlled: function (w) { return q.some(this.getAllConfigsIncludeInvisible(), function (m) { return m.id === w ? !0 : q.some(m.widgets, function (v) { return v.id === w }) }) }, getGroupConfigs: function () {
                                                var w = []; if (!this.appConfig.widgetPool) return w; this.appConfig.widgetPool.groups && q.forEach(this.appConfig.widgetPool.groups, function (m) {
                                                        this.controlledGroups && (Array.isArray(this.controlledGroups) ?
                                                                -1 < this.controlledGroups.indexOf(m.id) && w.push(m) : "all" === this.controlledGroups && w.push(m))
                                                }, this); return w
                                        }, getWidgetConfigs: function () { var w = []; if (!this.appConfig.widgetPool) return w; this.appConfig.widgetPool.widgets && q.forEach(this.appConfig.widgetPool.widgets, function (m) { this.controlledWidgets && (Array.isArray(this.controlledWidgets) ? -1 < this.controlledWidgets.indexOf(m.id) && w.push(m) : "all" === this.controlledWidgets && w.push(m)) }, this); return w }
                                })
                        })
                }, "jimu/SpatialReference/utils": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request esri/SpatialReference ./unitUtils".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        var k = null, n = null, d = !1; E = E(null, function () { }); var c = require.toUrl("jimu"), g = v(c + "/SpatialReference/wkidDetails.json", { handleAs: "json" }), b = v(c + "/SpatialReference/transform.json", { handleAs: "json" }); E.loadResource = function () { var e = new w; if (k && n) return e.resolve(), e; m([g, b]).then(function (a) { k = a[0]; n = a[1]; d = !0; e.resolve() }, function (a) { console.error(a); d = !1; e.reject(a) }); return e }; E.getAllCSUnits = function () {
                                                if (d) {
                                                        var e = []; A.forEach(k.wkids, q.hitch(this, function (a) {
                                                                a = this.getCSUnit(a);
                                                                -1 === A.indexOf(e, a) && e.push(a)
                                                        })); return e
                                                }
                                        }; E.convertUnit = function (e, a, f) { if (d) return l.convertUnit(e, a, f) }; E.getUnitRate = function (e, a) { if (d) return l.getUnitRate(e, a) }; E.isProjectUnit = function (e) { if (d) return l.isProjectUnit(e) }; E.isGeographicUnit = function (e) { if (d) return l.isGeographicUnit(e) }; E.getGeographicUnits = function () { if (d) return l.getGeographicUnits() }; E.getProjectUnits = function () { if (d) return l.getProjectUnits() }; E.getCSUnit = function (e) {
                                                if (d) {
                                                        e = this.getCSStr(e); var a = 0, f = 0; a = e.lastIndexOf("UNIT");
                                                        f = e.indexOf(",", a); return e.slice(a + 6, f - 1)
                                                }
                                        }; E.isSameSR = function (e, a) { if (d) return e = this.indexOfWkid(e), a = this.indexOfWkid(a), k.labels[e] === k.labels[a] }; E.isValidWkid = function (e) { if (d) return -1 < this.indexOfWkid(e) }; E.getSRLabel = function (e) { if (d && this.isValidWkid(e)) return e = this.indexOfWkid(e), k.labels[e] }; E.indexOfWkid = function (e) { if (d) return A.indexOf(k.wkids, e) }; E.isWebMercator = function (e) {
                                                return r.prototype._isWebMercator ? r.prototype._isWebMercator.apply({ wkid: parseInt(e, 10) }, []) : (new r(parseInt(e,
                                                        10))).isWebMercator()
                                        }; E.standardizeWkid = function (e) { return this.isWebMercator(e) ? 3857 : parseInt(e, 10) }; E.isValidTfWkid = function (e) { if (d) return -1 < this.indexOfTfWkid(e) }; E.getTransformationLabel = function (e) { if (d) return this.isValidTfWkid(e) ? (e = this.indexOfTfWkid(e), n.labels[e]) : "" }; E.indexOfTfWkid = function (e) { if (d) return A.indexOf(n.tfWkids, e) }; E.isGeographicCS = function (e) { if (d) return this.isValidWkid(e) ? k.details[this.indexOfWkid(e)].startWith("GEOGCS") : !1 }; E.isProjectedCS = function (e) {
                                                if (d) return this.isValidWkid(e) ?
                                                        k.details[this.indexOfWkid(e)].startWith("PROJCS") : !1
                                        }; E.getGeoCSByProj = function (e) { if (d && this.isProjectedCS(e)) return e = this.getSpheroidStr(e), e = A.indexOf(k.details, e), k.wkids[e] }; E.getSpheroidStr = function (e) { if (d) { if (this.isGeographicCS(e)) return k.details[this.indexOfWkid(e)]; if (this.isProjectedCS(e)) { e = k.details[this.indexOfWkid(e)]; var a = e.indexOf("GEOGCS"), f = e.indexOf("PROJECTION") - 1; return e.slice(a, f) } return null } }; E.getCSStr = function (e) { if (d) return k.details[this.indexOfWkid(e)] }; E.isSameSpheroid =
                                                function (e, a) { if (d) return e = this.getSpheroidStr(e), a = this.getSpheroidStr(a), e && a && e === a ? !0 : !1 }; return E
                                })
                }, "jimu/SpatialReference/unitUtils": function () {
                        define(["dojo/_base/declare", "dojo/_base/array"], function (E, q) {
                                var A = "INCHES FOOT FOOT_US YARDS MILES NAUTICAL_MILES MILLIMETERS CENTIMETERS METER KILOMETERS DECIMETERS LINK_CLARKE FOOT_GOLD_COAST FOOT_CLARKE CHAIN_SEARS_1992_TRUNCATED YARD_INDIAN CHAIN_BENOIT_1895_B YARD_SEARS CHAIN_SEARS FOOT_SEARS YARD_INDIAN_1937 50_KILOMETERS 150_KILOMETERS".split(" "),
                                w = "DECIMAL_DEGREES DEGREE_MINUTE_SECONDS DEGREE GRAD MGRS USNG".split(" "), m = {
                                        INCHES: .0254, FOOT: .3048, FOOT_US: .3048006096012192, YARDS: .9144, MILES: 1609.344, NAUTICAL_MILES: 1852, MILLIMETERS: .001, CENTIMETERS: .01, METER: 1, KILOMETERS: 1E3, DECIMETERS: .1, LINK_CLARKE: .2011661949, FOOT_GOLD_COAST: .3047997101815088, FOOT_CLARKE: .304797265, CHAIN_SEARS_1922_TRUNCATED: 20.116756, YARD_INDIAN: .9143985307444408, CHAIN_BENOIT_1895_B: 20.11678249437587, YARD_SEARS: .9143984146160287, CHAIN_SEARS: 20.11676512155263, FOOT_SEARS: .3047994715386762,
                                        YARD_INDIAN_1937: .91439523, "50_KILOMETERS": 5E4, "150_KILOMETERS": 15E4, DEGREE: .0174532925199433, DECIMAL_DEGREES: .0174532925199433, MGRS: .0174532925199433, USNG: .0174532925199433, DEGREE_MINUTE_SECONDS: .0174532925199433, GRAD: .01570796326794897
                                }; E = E(null, function () { }); E.convertUnit = function (v, r, l) { return m[v.toUpperCase()] / m[r.toUpperCase()] * l }; E.getUnitRate = function (v, r) { return m[v.toUpperCase()] / m[r.toUpperCase()] }; E.isProjectUnit = function (v) { return -1 < q.indexOf(A, v.toUpperCase()) }; E.isGeographicUnit = function (v) {
                                        return -1 <
                                                q.indexOf(w, v.toUpperCase())
                                }; E.getGeographicUnits = function () { return w }; E.getProjectUnits = function () { return A }; return E
                        })
                }, "jimu/dijit-all": function () { define([], 1) }, "jimu/dijit/RadioBtn": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/registry".split(" "), function (E, q, A, w, m, v, r, l) {
                                return E(q, {
                                        baseClass: "jimu-radio", declaredClass: "jimu.dijit.RadioBtn", checked: !1, group: null, constructor: function () { }, postCreate: function () {
                                                r.create("div",
                                                        { "class": "jimu-radio-inner" }, this.domNode); this.checked && v.add(this.domNode, "jimu-radio-checked"); this.own(m(this.domNode, "click", A.hitch(this, function () { this.checked || this.check() })))
                                        }, check: function (k) { void 0 === k && (k = !0); this.checked = !0; v.add(this.domNode, "jimu-radio-checked"); k && this._changeOthersState(!1); this.onStateChange() }, uncheck: function (k) { void 0 === k && (k = !0); this.checked = !1; v.remove(this.domNode, "jimu-radio-checked"); k && this._changeOthersState(!1); this.onStateChange() }, _changeOthersState: function (k) {
                                                null !==
                                                this.group && w.forEach(l.toArray(), function (n) { n.id !== this.id && n["class"] === this["class"] && n.group === this.group && (k ? n.check(!1) : n.uncheck(!1)) }, this)
                                        }, onStateChange: function () { }
                                })
                        })
                }, "jimu/dijit/CheckBox": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/html dojo/dom-class dojo/Evented ./a11y/CheckBox".split(" "), function (E, q, A, w, m, v, r) {
                                E = E([q, v], {
                                        baseClass: "jimu-checkbox", declaredClass: "jimu.dijit.CheckBox", checked: !1, disabled: !1, status: !0, label: "", title: "", postCreate: function () {
                                                this.checkNode =
                                                w.create("div", { "class": "checkbox jimu-float-leading jimu-icon jimu-icon-checkbox" }, this.domNode); this.labelNode = w.create("div", { "class": "label jimu-float-leading", innerHTML: this.label || "" }, this.domNode); this.checked && (w.addClass(this.checkNode, "checked"), w.addClass(this.checkNode, "jimu-icon-checked")); this.status = this._getStatusByDisabled(this.disabled); this.status || (w.addClass(this.domNode, "jimu-state-disabled"), w.addClass(this.checkNode, "jimu-state-disabled")); this.a11y_setDisabled(!this.status);
                                                this.own(this.watch("disabled", A.hitch(this, function () { this.setStatus(this._getStatusByDisabled(this.disabled)) }))); this._udpateLabelClass(); this.a11y_init()
                                        }, setLabel: function (l) { this.label = l; this.labelNode.innerHTML = this.label; this.labelNode.title = this.label; this.a11y_updateAriaLabel(l); this._udpateLabelClass() }, _udpateLabelClass: function () { this.labelNode && (this.labelNode.innerHTML ? w.removeClass(this.labelNode, "not-visible") : w.addClass(this.labelNode, "not-visible")) }, setValue: function (l) {
                                                this.status &&
                                                (!0 === l ? this.check() : this.uncheck())
                                        }, getValue: function () { return this.checked }, setStatus: function (l) { l = !!l; var k = this.status !== l; (this.status = l) ? (m.remove(this.domNode, "jimu-state-disabled"), w.removeClass(this.checkNode, "jimu-state-disabled")) : (m.add(this.domNode, "jimu-state-disabled"), w.addClass(this.checkNode, "jimu-state-disabled")); this.a11y_setDisabled(!this.status); k && this.emit("status-change", l) }, getStatus: function () { return this.status }, check: function (l) {
                                                if (this.status && (this.checked = !0, this.a11y_changeAriaCheckedAttr(),
                                                        w.addClass(this.checkNode, "checked jimu-icon-checked"), w.removeClass(this.checkNode, "checked jimu-icon-checkbox"), !l)) this.onStateChange()
                                        }, uncheck: function (l) { if (this.status && (this.checked = !1, this.a11y_changeAriaCheckedAttr(), w.removeClass(this.checkNode, "checked"), w.removeClass(this.checkNode, "jimu-icon-checked"), w.addClass(this.checkNode, "jimu-icon-checkbox"), !l)) this.onStateChange() }, onStateChange: function () {
                                                if (this.onChange && A.isFunction(this.onChange)) this.onChange(this.checked); this.emit("change",
                                                        this.checked)
                                        }, focus: function () { this.checkNode && this.checkNode.focus && this.checkNode.focus() }, _getStatusByDisabled: function (l) { return !0 === l || "true" === l || "disabled" === l ? !1 : !0 }
                                }); E.extend(r); return E
                        })
                }, "jimu/dijit/a11y/CheckBox": function () {
                        define(["dojo/_base/lang", "dojo/on", "dojo/_base/html", "dijit/a11yclick"], function (E, q, A, w) {
                                return {
                                        a11y_init: function () {
                                                A.setAttr(this.domNode, "tabindex", "0"); A.setAttr(this.domNode, "role", "checkbox"); this.setLabel(this.label); this.a11y_changeAriaCheckedAttr(); this.own(q(this.domNode,
                                                        "focus", E.hitch(this, function () { A.addClass(this.checkNode, "dijitCheckBoxFocused") }))); this.own(q(this.domNode, "blur", E.hitch(this, function () { A.removeClass(this.checkNode, "dijitCheckBoxFocused") }))); this.own(q(this.domNode, w, E.hitch(this, function () { this.status && (this.checked ? this.uncheck() : this.check()) })))
                                        }, a11y_changeAriaCheckedAttr: function () { A.setAttr(this.domNode, "aria-checked", this.checked ? "true" : "false") }, a11y_setDisabled: function (m) {
                                                m = m.toString(); "false" === m ? A.removeAttr(this.domNode, "disabled") :
                                                        A.setAttr(this.domNode, "disabled", m); A.setAttr(this.domNode, "aria-disabled", m)
                                        }, a11y_updateAriaLabel: function (m) { "" === this.label ? (A.setAttr(this.domNode, "title", this.title), A.setAttr(this.domNode, "aria-label", this.title)) : A.setAttr(this.domNode, "aria-label", this.title ? this.title : m) }
                                }
                        })
                }, "jimu/dijit/SymbolChooser": function () {
                        define("dojo/_base/declare dijit/_WidgetBase jimu/dijit/BindLabelPropsMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SymbolChooser.html dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/sniff dojo/query dojo/request/xhr dojo/Deferred dojox/gfx dojo/promise/all jimu/utils jimu/symbolUtils jimu/portalUrlUtils esri/symbols/jsonUtils esri/symbols/SimpleMarkerSymbol esri/symbols/PictureMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/symbols/Font esri/arcgis/Portal esri/request jimu/dijit/ImageChooser jimu/dijit/ColorPicker jimu/dijit/_Transparency jimu/dijit/LoadingIndicator jimu/dijit/formSelect dijit/form/NumberSpinner".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y, D, H, I, N, T) {
                                        return E([q, A, w, m, r], {
                                                templateString: v, baseClass: "jimu-symbol-chooser", declaredClass: "jimu.dijit.SymbolChooser", nls: null, _pointEventsBinded: !1, _lineEventBinded: !1, _fillEventBinded: !1, _textEventBinded: !1, _invokeSymbolChangeEvent: !0, _customPictureMarkerSymbol: null, isArrow: !1, symbol: null, type: null, DEFAULT_PORTAL_URL: "//arcgis.com/", _portalLoadTimeoutInMs: 3E3, _isOnline: !0, _localTypes: "basic A-Z arrows business cartographic nationalParkService outdoorRecreation peoplePlaces safetyHealth shapes transportation damage disasters emergencyManagement generalInfrastructure localGovernment numbers pointsOfInterest stateGovernment FireFly".split(" "),
                                                cropImage: !1, postMixInProperties: function () { this.nls = window.jimuNls.symbolChooser; this._setTemplateNls() }, postCreate: function () { this.inherited(arguments); this._initImageChooser(); this.own(d(document.body, "click", l.hitch(this, this._onBodyClicked))); (this._isIE8 = 8 === c("ie")) && k.addClass(this.domNode, "ie8"); this.symbol ? this.showBySymbol(this.symbol) : this.type && this.showByType(this.type) }, reset: function () { this.symbol = this.type = null; this._hideAllSections() }, showBySymbol: function (M) {
                                                        this.reset(); var R =
                                                                M && M.declaredClass; R && "string" === typeof R && 0 <= R.indexOf("esri.symbol") && (this.symbol = this._cloneSymbol(M), this.isSimpleMarkerSymbol(this.symbol) || this.isPictureMarkerSymbol(this.symbol) ? (this.type = "marker", this._initPointSection()) : this.isSimpleLineSymbol(this.symbol) ? (this.type = "line", this._initLineSection()) : this._isSimpleFillSymbol(this.symbol) ? (this.type = "fill", this._initFillSection()) : this._isTextSymbol(this.symbol) && (this.type = "text", this._initTextSection()))
                                                }, showByType: function (M) {
                                                        this.reset();
                                                        if ("marker" === M || "line" === M || "fill" === M || "text" === M) this.type = M, "marker" === this.type ? this._initPointSection() : "line" === this.type ? this._initLineSection() : "fill" === this.type ? this._initFillSection() : "text" === this.type && this._initTextSection()
                                                }, getSymbol: function () { return this._getSymbol(!1) }, getValidSymbol: function () { return this._getSymbol(!0) }, _getSymbol: function (M) {
                                                        var R = null; "marker" === this.type ? R = this._getPointSymbolBySetting(M) : "line" === this.type ? R = this._getLineSymbolBySetting(M) : "fill" === this.type ?
                                                                R = this._getFillSymbolBySetting(M) : "text" === this.type && (R = this._getTextSymbolBySetting(M)); M = null; R && (M = this._cloneSymbol(R)); return M
                                                }, hideColorPicker: function () { for (var M = "pointColor pointOutlineColor lineColor fillColor fillOutlineColor textColor".split(" "), R = 0, ca = M.length; R < ca; R++) { var K = M[R]; this[K] && this[K].hideTooltipDialog() } }, _onBodyClicked: function (M) { M = M.target || M.srcElement; this._tryHideDropDownOfSelectDijit(M, this.pointSymClassSelect); this._tryHideDropDownOfSelectDijit(M, this.lineStylesSelect) },
                                                _tryHideDropDownOfSelectDijit: function (M, R) { var ca = R.domNode, K = R.dropDown.domNode; ca = M === ca || k.isDescendant(M, ca); M = M === K || k.isDescendant(M, K); if (!ca && !M) R.dropDown.onCancel() }, _onChange: function (M) { M = this._cloneSymbol(M); this.emit("change", M) }, _hideAllSections: function () { g(".symbol-section", this.domNode).style("display", "none") }, _showSection: function (M) { this._hideAllSections(); g("." + M + "-symbol-section", this.domNode).style("display", "block") }, _getAncestor: function (M, R, ca) {
                                                        return h.getAncestorDom(M,
                                                                R, ca)
                                                }, _getAbsoluteUrl: function (M) { return window.location.protocol + "//" + window.location.host + require.toUrl(M) }, _cloneSymbol: function (M) { if (!M) return null; var R = M; try { var ca = M.toJson(); R = t.fromJson(ca); "fill" === this.type && (R.arrowWidth = M.arrowWidth) } catch (K) { console.error(K) } return R }, _createSymbolIconTable: function (M, R, ca) {
                                                        var K = this.type + "-icon-table"; M = k.toDom('\x3ctable class\x3d"icon-table ' + (K + " " + (K + "-" + M)) + '"\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e'); K = g("tbody", M)[0]; for (var Q = Math.ceil(R.length /
                                                                8), X = 0; X < Q; X++)k.create("tr", {}, K); var W = g("tr", M); n.forEach(R, l.hitch(this, function (fa, ma) {
                                                                        var ia = l.clone(fa), va = t.fromJson(fa); ma = k.create("td", {}, W[Math.floor(ma / 8)]); k.addClass(ma, "symbol-td-item"); va = this._createSymbolNode(va); k.addClass(va, "symbol-div-item"); var xa = va.firstChild; k.addClass(xa, "svg-node"); if (this._isIE8 && "point" === ca) if (window.isRTL) { if ("Cross" === fa.name || "X" === fa.name) k.setStyle(xa, "right", "-20px"), k.setStyle(va, "marginTop", "20px") } else "Cross" !== fa.name && "X" !== fa.name || k.setStyle(va,
                                                                                "marginTop", "20px"); va.symbol = ia; k.place(va, ma)
                                                                })); return M
                                                }, _updatePreview: function (M) { var R = this._cloneSymbol(this.symbol); k.empty(M); (R = p.createSymbolNode(R)) || (R = k.create("div")); k.place(R, M) }, _createSymbolNode: function (M) { (M = p.createSymbolNode(M, { width: 36, height: 36 })) || (M = k.create("div")); k.setStyle(M, { width: "36px", height: "36px" }); return M }, _getLineShapeDesc: function (M) {
                                                        var R = null; if (this.isSimpleLineSymbol(M) || this.isCartographicLineSymbol(M)) R = {
                                                                defaultShape: { type: "path", path: "M -90,0 L 90,0 E" },
                                                                fill: null, stroke: M.getStroke()
                                                        }; return R
                                                }, _initPointSection: function () {
                                                        this._showSection("point"); this._pointEventsBinded || (this._pointEventsBinded = !0, this._bindPointEvents(), this._onPointSymClassSelectChange()); this.isPictureMarkerSymbol(this.symbol) ? this._showBuildInPictureMarkerSymSettings() : (this.isSimpleMarkerSymbol(this.symbol) || (this.symbol = new u({ style: "esriSMSCircle", color: [0, 0, 128, 128], name: "Circle", outline: { color: [0, 0, 128, 255], width: 1 }, type: "esriSMS", size: 18 })), this._showSimpleMarkerSymSettings());
                                                        this._initPointSettings(this.symbol); this._getPointSymbolBySetting()
                                                }, _bindPointEvents: function () {
                                                        this.own(d(this.pointIconTables, ".symbol-div-item:click", l.hitch(this, this._onPointSymIconItemClick))); this.own(d(this.pointSymClassSelect, "change", l.hitch(this, this._onPointSymClassSelectChange))); this.own(d(this.pointSize, "change", l.hitch(this, this._onPointSymbolChange, !1))); this.own(d(this.pointColor, "change", l.hitch(this, this._onPointSymbolChange, !1))); this.own(d(this.pointAlpha, "change", l.hitch(this,
                                                                this._onPointSymbolChange, !1))); this.own(d(this.pointOutlineColor, "change", l.hitch(this, this._onPointSymbolChange, !1))); this.own(d(this.pointOutlineWidth, "change", l.hitch(this, this._onPointSymbolChange, !1)))
                                                }, _onPointSymbolChange: function (M) { this._invokeSymbolChangeEvent && (this._getPointSymbolBySetting(M), this._onChange(this.symbol)) }, _initPointSettings: function (M) {
                                                        if (M) {
                                                                this._invokeSymbolChangeEvent = !1; if (this.isSimpleMarkerSymbol(M)) {
                                                                        if (this.pointSize.set("value", M.size), this.pointColor.setColor(M.color),
                                                                                this.pointAlpha.setAlpha(parseFloat(M.color.a.toFixed(2))), M = M.outline) this.pointOutlineColor.setColor(M.color), this.pointOutlineWidth.set("value", parseFloat(M.width.toFixed(0)))
                                                                } else this.isPictureMarkerSymbol(M) && this.pointSize.set("value", M.width); this._invokeSymbolChangeEvent = !0
                                                        }
                                                }, isSimpleMarkerSymbol: function (M) { return M && "esri.symbol.SimpleMarkerSymbol" === M.declaredClass }, isPictureMarkerSymbol: function (M) { return M && "esri.symbol.PictureMarkerSymbol" === M.declaredClass }, _isCustomImageOptionSelected: function () {
                                                        return "custom" ===
                                                                this.pointSymClassSelect.get("value")
                                                }, _onPointSymClassSelectChange: function () {
                                                        if (this._isCustomImageOptionSelected()) this._showCustomPictureMarkerSymSettings(), this._customPictureMarkerSymbol && (this.symbol = this._customPictureMarkerSymbol, this._onPointSymbolChange()); else {
                                                                this._showSimpleMarkerSymSettings(); this._showSelectedPointSymIconTable(); var M = this.pointSymClassSelect.get("value"); this.pointSymClassSelect["def" + M] ? (M = this.pointSymClassSelect.getOptions(M), this.pointSymClassSelect.domNode.title =
                                                                        M ? M.label : "") : this._requestPointSymJson(M)
                                                        }
                                                }, _hideAllPointSymIconTable: function () { g(".marker-icon-table", this.pointIconTables).style("display", "none") }, _showSelectedPointSymIconTable: function () { this._hideAllPointSymIconTable(); var M = this.pointSymClassSelect.get("value"); M = g(".marker-icon-table-" + M, this.pointIconTables); 0 < M.length && M.style("display", "table") }, _getLocalSymbols: function (M) {
                                                        M = M || this.pointSymClassSelect.get("value"); M = this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/" + M + ".json"); return b(M,
                                                                { handleAs: "json" })
                                                }, _getPortalSymbolsByType: function (M) { var R = new e; M ? this._fetchSymbols(M).then(l.hitch(this, function (ca) { R.resolve(ca) }), l.hitch(this, function (ca) { R.reject(ca) })) : R.reject(null); return R }, _requestPointSymJson: function (M) {
                                                        this.pointSymClassSelect["def" + M] || (this.loadingShelter.show(), !this._isOnline && window.isXT ? this._offLineGetSymbols(M) : this._symbolTypes ? this._handleGetPointSymbols(l.hitch(this, this._getPortalSymbolsByType), M) : this._initPortal().then(l.hitch(this, this._fetchSymbolTypes)).then(l.hitch(this,
                                                                function (R) { this.domNode && (this._clearOptions(), this._createOptions(R), this._handleGetPointSymbols(l.hitch(this, this._getPortalSymbolsByType), M)) }), l.hitch(this, function (R) { this.domNode && (window.isXT ? this._offLineGetSymbols(M) : (this.loadingShelter.hide(), console.error("Fetching symbols failed", R))) })))
                                                }, _offLineGetSymbols: function (M) {
                                                        this._isOnline = !1; if (0 === this.pointSymClassSelect.options.length) {
                                                                var R = []; n.forEach(this._localTypes, l.hitch(this, function (ca, K) { R.push({ id: K, title: this.nls[ca] || ca }) }));
                                                                this._clearOptions(); this._createOptions(R)
                                                        } this._handleGetPointSymbols(l.hitch(this, this._getLocalSymbols), M)
                                                }, _clearOptions: function () { this.pointSymClassSelect && this.pointSymClassSelect.removeOption(this.pointSymClassSelect.options) }, _createOptions: function (M) {
                                                        if (this.pointSymClassSelect) {
                                                                var R = [], ca = "", K = !1; "[object Array]" === Object.prototype.toString.call(M) && 0 < M.length && n.forEach(M, l.hitch(this, function (Q) {
                                                                        ca = Q.title || Q.name; K = Q.defaultType ? !0 : !1; ca && (Q.id || 0 === Q.id) && R.push({
                                                                                label: ca, value: Q.id,
                                                                                selected: K
                                                                        })
                                                                })); R.push({ label: this.nls.customImage, value: "custom" }); this.pointSymClassSelect.addOption(R)
                                                        }
                                                }, _initPortal: function () { var M = new e; if (this._portal) M.resolve(); else { var R = B.getStandardPortalUrl(window.portalUrl), ca = new I.Portal(R ? R : this.DEFAULT_PORTAL_URL); if (ca.loaded) return this._portal = ca, M.resolve(), M.promise; this.own(ca.on("load", l.hitch(this, function () { this._portal = ca; M.resolve() }))); setTimeout(function () { M.reject() }, this._portalLoadTimeoutInMs) } return M }, _handleGetPointSymbols: function (M,
                                                        R) { if (this.pointSymClassSelect) { var ca = R || this.pointSymClassSelect.get("value"); R = "def" + ca; M = M(ca); this.pointSymClassSelect[R] = M; M.then(l.hitch(this, function (K) { this.domNode && (this.loadingShelter.hide(), this._getPointSymbolsSucess(ca, K)) }), l.hitch(this, function (K) { this.domNode && (this.loadingShelter.hide(), console.error("Fetching symbols failed", K)) })) } }, _getPointSymbolsSucess: function (M, R) {
                                                                if (this.domNode) {
                                                                        var ca = this.pointSymClassSelect.getOptions(M); this.pointSymClassSelect.domNode.title = ca ? ca.label :
                                                                                ""; M = this._createSymbolIconTable(M, R, "point"); k.place(M, this.pointIconTables); this._showSelectedPointSymIconTable()
                                                                }
                                                        }, _fetchSymbols: function (M) { var R = [], ca = new e; R = this._symbolTypes.filter(function (K) { return K.id === M }); this._getSymbolListData(R).then(l.hitch(this, function (K) { ca.resolve(K) }), l.hitch(this, function (K) { console.warn("fetch symbols failed", K); ca.reject(K) })); return ca }, _getSymbolListData: function (M) {
                                                                M = n.filter(M, function (R) { return R.dataUrl }); M = n.map(M, function (R) { return N({ url: R.dataUrl }).promise });
                                                                return f(M).then(function (R) { return R[0] })
                                                        }, _fetchSymbolTypes: function () { var M = new e; this._symbolTypes ? M.resolve(this._symbolTypes) : this._getSymbolListGroupId().then(l.hitch(this, this._getSymbolListItems)).then(l.hitch(this, function (R) { this._symbolTypes = R; M.resolve(R) }), l.hitch(this, function (R) { console.warn("fetch symbol types failed", R); M.reject(R) })); return M }, _getSymbolListGroupId: function () {
                                                                var M = new e; this._portal || M.reject("no portal"); this._portal.queryGroups({ q: this._portal.symbolSetsGroupQuery }).then(function (R) { M.resolve(R.results[0].id) },
                                                                        l.hitch(this, function (R) { console.warn("get symbol list group id failed", R); M.reject(R) })); return M
                                                        }, _getSymbolListItems: function (M) {
                                                                var R = new e, ca = this._portal; M = "group:" + M + ' AND type:"Symbol Set"'; var K = []; this._portal || R.reject("no portal"); M = "vml" === a.renderer ? M + ' AND -typekeywords:"by value"' : M + ' AND (typekeywords:"by value" AND typekeywords:"marker")'; ca.queryItems({ q: M, num: 50, sortField: "title" }).then(l.hitch(this, function (Q) {
                                                                        var X, W, fa, ma; n.forEach(Q.results, function (ia) {
                                                                                X = ia.typeKeywords.join(" ");
                                                                                -1 < X.indexOf("marker") && (W = ia.title, fa = { name: W, id: ia.id, title: ia.title, keywords: X, dataUrl: ia.itemDataUrl }, (ma = "Basic" === ia.name) ? (fa.defaultType = !0, K.unshift(fa)) : K.push(fa))
                                                                        }, this); 0 < K.length ? R.resolve(K) : R.reject()
                                                                }), function () { R.reject() }); return R
                                                        }, _onPointSymIconItemClick: function (M) {
                                                                if (M = this._getAncestor(M.target || M.srcElement, function (ca) { return k.hasClass(ca, "symbol-div-item") }, 5)) if (g(".selected-symbol-div-item", M.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),
                                                                        k.addClass(M, "selected-symbol-div-item"), M = M.symbol) { this.symbol = t.fromJson(M); M = k.getStyle(this.pointColorTr, "display"); this.isSimpleMarkerSymbol(this.symbol) ? this._showSimpleMarkerSymSettings() : this._showBuildInPictureMarkerSymSettings(); this._onPointSymbolChange(!0); var R = k.getStyle(this.pointColorTr, "display"); M !== R && this.emit("resize") }
                                                        }, _showSimpleMarkerSymSettings: function () {
                                                                k.addClass(this.pointCustomImageTr, "hidden"); k.removeClass(this.pointIconTablesTr, "hidden"); k.removeClass(this.pointColorTr,
                                                                        "hidden"); k.removeClass(this.pointOpacityTr, "hidden"); k.removeClass(this.pointOutlineColorTr, "hidden"); k.removeClass(this.pointOulineWidthTr, "hidden")
                                                        }, _showBuildInPictureMarkerSymSettings: function () { k.addClass(this.pointCustomImageTr, "hidden"); k.removeClass(this.pointIconTablesTr, "hidden"); k.addClass(this.pointColorTr, "hidden"); k.addClass(this.pointOpacityTr, "hidden"); k.addClass(this.pointOutlineColorTr, "hidden"); k.addClass(this.pointOulineWidthTr, "hidden") }, _showCustomPictureMarkerSymSettings: function () {
                                                                k.removeClass(this.pointCustomImageTr,
                                                                        "hidden"); k.addClass(this.pointIconTablesTr, "hidden"); k.addClass(this.pointColorTr, "hidden"); k.addClass(this.pointOpacityTr, "hidden"); k.addClass(this.pointOutlineColorTr, "hidden"); k.addClass(this.pointOulineWidthTr, "hidden")
                                                        }, _getPointSymbolBySetting: function (M) {
                                                                if (!this.symbol || M && !this.pointSize.validate()) return null; var R = parseFloat(this.pointSize.get("value")); if (this.isSimpleMarkerSymbol(this.symbol)) {
                                                                        if (M && !this.pointOutlineWidth.validate()) return null; this.symbol.setSize(R); M = this.pointColor.getColor();
                                                                        R = this.pointAlpha.getAlpha(); M.a = R; this.symbol.setColor(M); M = this.pointOutlineColor.getColor(); R = (R = parseFloat(this.pointOutlineWidth.get("value"))) ? R : 0; var ca = new x; ca.setStyle(x.STYLE_SOLID); ca.setColor(M); ca.setWidth(R); this.symbol.setOutline(ca)
                                                                } else this.isPictureMarkerSymbol(this.symbol) && (this.symbol.setWidth(R), this.symbol.setHeight(R)); this._updatePreview(this.pointSymPreview); return this.symbol
                                                        }, _initImageChooser: function () {
                                                                this.imageChooser = new T({
                                                                        cropImage: this.cropImage, customZIndex: this.customZIndex,
                                                                        showSelfImg: !1, goldenWidth: 16, goldenHeight: 16, format: ["image/gif", "image/png", "image/jpeg"], label: this.nls.chooseFile
                                                                }); k.addClass(this.imageChooser.domNode, "custom-image-chooser"); this.own(d(this.imageChooser, "change", l.hitch(this, this._onImageChange))); this.imageChooser.placeAt(this.customImageTd, "first")
                                                        }, _onImageChange: function (M, R) {
                                                                this.imageNameNode.innerHTML = R.fileName; M = M.replace(/^data:image\/.*;base64,/, ""); R = parseFloat(this.pointSize.get("value")); this._customPictureMarkerSymbol = this.symbol =
                                                                        new z({ type: "esriPMS", url: null, imageData: M, contentType: "image/png", color: null, width: R, height: R, angle: 0, xoffset: 0, yoffset: 0 }); this._onPointSymbolChange()
                                                        }, _initLineSection: function () { this._showSection("line"); this._lineEventBinded || (this._lineEventBinded = !0, this._bindLineEvents(), this._requestLineSymJson("line")); this._initLineSettings(this.symbol); this._getLineSymbolBySetting() }, _bindLineEvents: function () {
                                                                this.own(d(this.lineIconTables, ".symbol-div-item:click", l.hitch(this, this._onLineSymIconItemClick)));
                                                                this.own(d(this.lineColor, "change", l.hitch(this, this._onLineSymbolChange))); this.own(d(this.lineStylesSelect, "change", l.hitch(this, this._onLineSymbolChange))); this.own(d(this.lineAlpha, "change", l.hitch(this, this._onLineSymbolChange))); this.own(d(this.lineWidth, "change", l.hitch(this, this._onLineSymbolChange)))
                                                        }, _onLineSymbolChange: function () { this._invokeSymbolChangeEvent && (this._getLineSymbolBySetting(), this._onChange(this.symbol)) }, _initLineSettings: function (M) {
                                                                M && (this._invokeSymbolChangeEvent = !1,
                                                                        this.lineColor.setColor(M.color), this.lineAlpha.setAlpha(parseFloat(M.color.a.toFixed(2))), this.lineWidth.set("value", parseFloat(M.width.toFixed(0))), this.lineStylesSelect.set("value", M.style), this._invokeSymbolChangeEvent = !0)
                                                        }, isSimpleLineSymbol: function (M) { return M && "esri.symbol.SimpleLineSymbol" === M.declaredClass }, isCartographicLineSymbol: function (M) { return M && "esri.symbol.CartographicLineSymbol" === M.declaredClass }, _requestLineSymJson: function (M) {
                                                                var R = this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/" +
                                                                        M + ".json"); b(R, { handleAs: "json" }).then(l.hitch(this, function (ca) { this.domNode && (ca = this._createSymbolIconTable(M, ca, "line"), k.place(ca, this.lineIconTables)) }), l.hitch(this, function (ca) { console.error("get line symbol failed", ca) }))
                                                        }, _onLineSymIconItemClick: function (M) {
                                                                if (M = this._getAncestor(M.target || M.srcElement, function (R) { return k.hasClass(R, "symbol-div-item") }, 5)) if (g(".selected-symbol-div-item", M.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"), k.addClass(M, "selected-symbol-div-item"),
                                                                        M = M.symbol) M = t.fromJson(M), this._initLineSettings(M), this._onLineSymbolChange()
                                                        }, _getLineSymbolBySetting: function (M) { if (M && !this.lineWidth.validate()) return null; this.symbol = new x; M = this.lineColor.getColor(); var R = this.lineStylesSelect.get("value"); M.a = this.lineAlpha.getAlpha(); var ca = parseFloat(this.lineWidth.get("value")); this.symbol.setStyle(R); this.symbol.setColor(M); this.symbol.setWidth(ca); this._updatePreview(this.lineSymPreview); return this.symbol }, setFillSectionType: function (M) {
                                                                M ? k.addClass(this.fillSection,
                                                                        "arrow-symbol-section") : (k.removeClass(this.fillSection, "arrow-symbol-section"), this.isArrow && !this.arrowWidth.validate() && this.arrowWidth.set("value", 12)); this.isArrow = M
                                                        }, _initFillSection: function () { this.setFillSectionType(this.isArrow); this._showSection("fill"); this._fillEventBinded || (this._fillEventBinded = !0, this._bindFillEvents(), this._requestFillSymJson("fill")); this._initFillSettings(this.symbol); this._getFillSymbolBySetting() }, _bindFillEvents: function () {
                                                                this.own(d(this.fillIconTables, ".symbol-div-item:click",
                                                                        l.hitch(this, this._onFillSymIconItemClick))); this.own(d(this.fillColor, "change", l.hitch(this, this._onFillSymbolChange, !1))); this.own(d(this.fillAlpha, "change", l.hitch(this, this._onFillSymbolChange, !1))); this.own(d(this.fillOutlineColor, "change", l.hitch(this, this._onFillSymbolChange, !1))); this.own(d(this.fillOutlineWidth, "change", l.hitch(this, this._onFillSymbolChange, !1))); this.own(d(this.arrowWidth, "change", l.hitch(this, this._onFillSymbolChange, !1)))
                                                        }, _onFillSymbolChange: function (M) {
                                                                this._invokeSymbolChangeEvent &&
                                                                (this._getFillSymbolBySetting(M), this._onChange(this.symbol))
                                                        }, _initFillSettings: function (M) { M && (this._invokeSymbolChangeEvent = !1, this.fillColor.setColor(M.color), this.fillAlpha.setAlpha(parseFloat(M.color.a.toFixed(2))), M.outline && (this.fillOutlineColor.setColor(M.outline.color), this.fillOutlineWidth.set("value", parseInt(M.outline.width, 10))), this._invokeSymbolChangeEvent = !0, this.arrowWidth.set("value", parseInt(M.arrowWidth, 10))) }, _isSimpleFillSymbol: function (M) {
                                                                return M && "esri.symbol.SimpleFillSymbol" ===
                                                                        M.declaredClass
                                                        }, _requestFillSymJson: function (M) { var R = this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/" + M + ".json"); b(R, { handleAs: "json" }).then(l.hitch(this, function (ca) { this.domNode && (ca = this._createSymbolIconTable(M, ca, "fill"), k.place(ca, this.fillIconTables)) }), l.hitch(this, function (ca) { console.error("get fill symbol failed", ca) })) }, _onFillSymIconItemClick: function (M) {
                                                                if (M = this._getAncestor(M.target || M.srcElement, function (R) { return k.hasClass(R, "symbol-div-item") }, 5)) if (g(".selected-symbol-div-item",
                                                                        M.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"), k.addClass(M, "selected-symbol-div-item"), M = M.symbol) M = t.fromJson(M), M.arrowWidth = this.symbol.arrowWidth, this._initFillSettings(M), this._onFillSymbolChange()
                                                        }, _getFillSymbolBySetting: function (M) {
                                                                if (M && (!this.fillOutlineWidth.validate() || this.isArrow && !this.arrowWidth.validate())) return null; this.symbol = new y; var R = this.fillColor.getColor(); R.a = this.fillAlpha.getAlpha(); M = this.fillOutlineColor.getColor(); var ca = parseInt(this.fillOutlineWidth.get("value"),
                                                                        10); ca = ca ? ca : 0; this.symbol.setColor(R); this.symbol.setStyle(y.STYLE_SOLID); R = new x; R.setStyle(x.STYLE_SOLID); R.setColor(M); R.setWidth(ca); this.symbol.setOutline(R); M = parseInt(this.arrowWidth.get("value"), 10); this.symbol.arrowWidth = M; this._updatePreview(this.fillSymPreview); return this.symbol
                                                        }, _initTextSection: function () { this._showSection("text"); this._textEventBinded || (this._textEventBinded = !0, this._bindTextEvents()); this._initTextSettings(); this._getTextSymbolBySetting() }, _bindTextEvents: function () {
                                                                this.own(d(this.inputText,
                                                                        "change", l.hitch(this, this._onTextSymbolChange))); this.own(d(this.textColor, "change", l.hitch(this, this._onTextSymbolChange))); this.own(d(this.textFontSize, "change", l.hitch(this, this._onTextSymbolChange)))
                                                        }, _onTextSymbolChange: function () { this._invokeSymbolChangeEvent && (this._getTextSymbolBySetting(), this._onChange(this.symbol)) }, _initTextSettings: function (M) {
                                                                M && (this._invokeSymbolChangeEvent = !1, this.inputText.value = M.text, this.textColor.setColor(M.color), M = parseInt(M.font.size, 10), this.textFontSize.set("value",
                                                                        M), this._invokeSymbolChangeEvent = !0)
                                                        }, _isTextSymbol: function (M) { return M && "esri.symbol.TextSymbol" === M.declaredClass }, _updateTextPreview: function (M, R) { var ca = this.textColor.getColor().toHex(), K = parseInt(this.textFontSize.get("value"), 10) + "px"; k.setStyle(this.textPreview, { color: ca, fontSize: K, fontFamily: R }); this.textPreview.innerHTML = M }, _getTextSymbolBySetting: function (M) {
                                                                var R = h.sanitizeHTML(this.inputText.value); if (M && ("" === R.replace(/^\s+|\s+$/g, "") || !this.textFontSize.validate())) return null; this.symbol =
                                                                        new D; M = this.textColor.getColor(); var ca = parseInt(this.textFontSize.get("value"), 10), K = new H; K.setSize(ca); this.symbol.setText(R); this.symbol.setColor(M); this.symbol.setFont(K); this._updateTextPreview(R, K.family); return this.symbol
                                                        }, _setTemplateNls: function () {
                                                                "undefined" === typeof this.nls.damage && (this.nls.damage = "Damage"); "undefined" === typeof this.nls.disasters && (this.nls.disasters = "Disasters"); "undefined" === typeof this.nls.emergencyManagement && (this.nls.emergencyManagement = "Emergency Management");
                                                                "undefined" === typeof this.nls.generalInfrastructure && (this.nls.generalInfrastructure = "General Infrastructure"); "undefined" === typeof this.nls.localGovernment && (this.nls.localGovernment = "Local Government"); "undefined" === typeof this.nls.numbers && (this.nls.numbers = "Numbers"); "undefined" === typeof this.nls.pointsOfInterest && (this.nls.pointsOfInterest = "Points of Interest"); "undefined" === typeof this.nls.stateGovernment && (this.nls.stateGovernment = "State Government")
                                                        }
                                        })
                                })
                }, "esri/arcgis/Portal": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/_base/array dojo/_base/sniff require ../config ../kernel ../lang ../request ../urlUtils ../Evented ../IdentityManager".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                        var b = { options: { disableIdentityLookup: !0 }, requestParams: { f: "json" } }, e = function (y) { function D(H) { y[H] || (y[H] = function () { var I = arguments; return w.when(y, function (N) { Array.prototype.unshift.call(I, N.results || N); return e(m[H].apply(m, I)) }) }) } if (!y) return y; y.then && (y = q.delegate(y)); y.total || (y.total = w.when(y, function (H) { return n.isDefined(H.total) ? H.total : H.length || 0 })); D("forEach"); D("filter"); D("map"); D("some"); D("every"); return y }, a = {
                                                useSSL: function (y, D) {
                                                        var H = b &&
                                                                b.self || {}; if (H && !H.isPortal) return -1 !== y.indexOf("https:") || H.allSSL ? D.replace("http:", "https:") : D; var I = a.getLocation(D); return -1 < H.portalHostname.toLowerCase().indexOf(I.hostname.toLowerCase()) && I.port && "80" !== I.port && "443" !== I.port ? (D = I.pathname, D = 0 === D.indexOf("/") ? D : "/" + D, H.allSSL || -1 < y.indexOf("https:") ? "https://" + I.hostname + (H.httpsPort && "443" !== H.httpsPort ? ":" + H.httpsPort : "") + D + I.search : "http://" + I.hostname + (H.httpPort && "80" !== H.httpPort ? ":" + H.httpPort : "") + D + I.search) : -1 !== y.indexOf("https:") ||
                                                                        H.allSSL ? D.replace("http:", "https:") : D
                                                }, formatUrl: function (y) { var D = b.currentToken; return -1 !== y.indexOf("null") ? null : a.useSSL(window.location.protocol, D ? y + (-1 !== y.indexOf("?") ? "\x26" : "?") + ("token\x3d" + D) : y) }, getLocation: function (y) { var D = document.createElement("a"); D.href = y; return { protocol: D.protocol, hostname: D.hostname, port: D.port, pathname: D.pathname, search: D.search, hash: D.hash, host: D.host } }, resultsToTypedArray: function (y, D, H) {
                                                        H = H ? H.listings || H.notifications || H.userInvitations || H.tags || H.items ||
                                                                H.groups || H.comments || H.provisions || H.results || H : []; return m.map(H, function (I) { I = q.mixin(I, D || {}); return y ? new y(I) : I })
                                                }, clearFieldsFromObject: function (y, D) { var H, I = y.length; if (q.isArray(y)) for (H = 0; H < I; H++)delete D[y[H]]; else for (H in y) delete D[H]; return D }, requestToTypedArray: function (y, D, H, I, N) { return e(a.request(y, D, H).then(q.partial(a.resultsToTypedArray, I, N))) }, request: function (y, D, H) {
                                                        if (D) {
                                                                D.portal && delete D.portal; if (D.form) { var I = D.form; delete D.form } if (D.hasOwnProperty("withCredentials")) {
                                                                        var N =
                                                                                D.withCredentials; delete D.withCredentials
                                                                }
                                                        } D = q.mixin(q.mixin({}, D || {}), b.requestParams); y = { url: a.useSSL(window.location.protocol, y.url || y), content: D, callbackParamName: "callback", timeout: T && T.timeout || 0, form: I }; null != N && (y.withCredentials = N); var T = q.mixin(H || {}, b.options); return d(y, T)
                                                }, formatQueryParams: function (y, D, H) { y = q.mixin(q.mixin({}, y), q.isString(D) ? { q: D } : D || {}); y.q = !H && b.extraQuery ? "(" + y.q + ")" + b.extraQuery : y.q; return y }
                                        }, f = E([], {
                                                declaredClass: "esri.arcgis.PortalComment", constructor: function (y) {
                                                        q.mixin(this,
                                                                y); this.url = this.item.itemUrl + "/comments/" + this.id; this.created = this.created ? new Date(this.created) : null
                                                }
                                        }), h = E([], { declaredClass: "esri.arcgis.PortalRating", constructor: function (y) { q.mixin(this, y); this.url = this.item.itemUrl + "/rating"; this.created = this.created ? new Date(this.created) : null } }), p = E([], {
                                                declaredClass: "esri.arcgis.PortalItem", constructor: function (y) {
                                                        q.mixin(this, y); this.folderId = this.ownerFolder || this.folderId; this.itemUrl = (this.portal && this.portal.portalUrl) + "content/items/" + this.id; this.userItemUrl =
                                                                this.hasOwnProperty("ownerFolder") ? this.itemUrl.replace("/content/", "/content/users/" + this.owner + (this.folderId ? "/" + this.folderId : "") + "/") : null; this.itemDataUrl = a.formatUrl(this.itemUrl + "/data"); this.thumbnailUrl = a.formatUrl(this.itemUrl + "/info/" + this.thumbnail); this.displayName = this._getDisplayName(); this.iconUrl = this._getIconUrl(); this.isPremiumContent = this._getIsPremiumContent(); this.created = this.created ? new Date(this.created) : null; this.uploaded = this.uploaded ? new Date(this.uploaded) : null; this.modified =
                                                                        this.modified ? new Date(this.modified) : null
                                                }, getTypeInfo: function () { var y = this.type; return { source: -1 < m.indexOf(this.typeKeywords || [], "ArcGIS Server") || "Feature Collection" === y ? y : null, displayName: this.displayName, iconUrl: this.iconUrl, isPremiumContent: this.isPremiumContent, premiumIconUrl: this._getPremiumIconUrl() } }, addComment: function (y) { var D = q.isString(y) ? { comment: y } : y; return a.request(this.itemUrl + "/addComment", D, { usePost: !0 }).then(q.hitch(this, function (H) { return new f(q.mixin(D, { id: H.commentId, item: this })) })) },
                                                updateComment: function (y) { if (y && y.url && y.comment) return a.request(y.url + "/update", { comment: y.comment }, { usePost: !0 }).then(function (D) { y.id = D.commentId; return y }); throw Error(); }, getComments: function () { return a.requestToTypedArray(this.itemUrl + "/comments", null, null, f, { item: this }) }, deleteComment: function (y) { if (y && y.url) return a.request(y.url + "/delete", null, { usePost: !0 }); throw Error(); }, addRating: function (y) {
                                                        var D = q.isObject(y) ? y : { rating: parseFloat(y) }; return a.request(this.itemUrl + "/addRating", D, { usePost: !0 }).then(q.hitch(this,
                                                                function (H) { return new h(q.mixin(D, { id: H.ratingId, item: this })) }))
                                                }, getRating: function () { return a.request(this.itemUrl + "/rating").then(q.hitch(this, function (y) { return new h(q.mixin(y, { item: this })) })) }, deleteRating: function () { return a.request(this.itemUrl + "/deleteRating", null, { usePost: !0 }) }, _getDisplayName: function () {
                                                        var y = this.type, D = this.typeKeywords || [], H = y; "Feature Service" === y || "Feature Collection" === y ? H = -1 < m.indexOf(D, "Table") ? "Table" : -1 < m.indexOf(D, "Route Layer") ? "Route Layer" : -1 < m.indexOf(D,
                                                                "Markup") ? "Markup" : "Feature Layer" : "Image Service" === y ? H = -1 < m.indexOf(D, "Elevation 3D Layer") ? "Elevation Layer" : -1 < m.indexOf(D, "Tiled Imagery") ? "Tiled Imagery Layer" : "Imagery Layer" : "Scene Service" === y ? H = "Scene Layer" : "Video Service" === y ? H = "Video Layer" : "Scene Package" === y ? H = "Scene Layer Package" : "Stream Service" === y ? H = "Feature Layer" : "Geoprocessing Service" === y && this.portal && this.portal.isPortal ? H = -1 < m.indexOf(D, "Web Tool") ? "Tool" : "Geoprocessing Service" : "Geoenrichment Service" === y ? H = "GeoEnrichment Service" :
                                                                        "Geocoding Service" === y ? H = "Locator" : "Microsoft Powerpoint" === y ? H = "Microsoft PowerPoint" : "GeoJson" === y ? this.type = H = "GeoJSON" : "Globe Service" === y ? H = "Globe Layer" : "Vector Tile Service" === y ? H = "Tile Layer" : "netCDF" === y ? H = "NetCDF" : "Map Service" === y ? H = -1 === m.indexOf(D, "Spatiotemporal") && (-1 < m.indexOf(D, "Hosted Service") || -1 < m.indexOf(D, "Tiled")) && -1 === m.indexOf(D, "Relational") ? "Tile Layer" : "Map Image Layer" : y && -1 < y.toLowerCase().indexOf("add in") ? H = y.replace(/(add in)/ig, "Add-In") : "datastore catalog service" ===
                                                                                y ? H = "Big Data File Share" : "Compact Tile Package" === y ? H = "Tile Package (tpkx)" : "Raster function template" === y ? H = "Raster Function Template" : "OGCFeatureServer" === y ? H = "OGC Feature Layer" : "web mapping application" === y && -1 < m.indexOf(D, "configurableApp") && (H = "Instant App"); return H
                                                }, _getIconUrl: function () {
                                                        var y = this.type && this.type.toLowerCase() || "", D = this.typeKeywords || [], H = !1, I = !1, N = !1, T = !1, M = !1, R = !1; I = !1; 0 < y.indexOf("service") || "feature collection" === y || "kml" === y || "wms" === y || "wmts" === y || "wfs" === y ? (H = -1 <
                                                                m.indexOf(D, "Hosted Service"), "feature service" === y || "feature collection" === y || "kml" === y || "wfs" === y ? (T = -1 < m.indexOf(D, "Table"), I = -1 < m.indexOf(D, "Route Layer"), N = -1 < m.indexOf(D, "Markup"), M = -1 !== m.indexOf(D, "Spatiotemporal"), R = -1 !== m.indexOf(D, "UtilityNetwork"), y = M && T ? "spatiotemporaltable" : T ? "table" : I ? "routelayer" : N ? "markup" : M ? "spatiotemporal" : R ? "utilitynetwork" : H ? "featureshosted" : "features") : "map service" === y || "wms" === y || "wmts" === y ? (M = -1 !== m.indexOf(D, "Spatiotemporal"), I = -1 !== m.indexOf(D, "Relational"),
                                                                        y = M || I ? "mapimages" : H || -1 < m.indexOf(D, "Tiled") || "wmts" === y ? "maptiles" : "mapimages") : y = "scene service" === y ? -1 < m.indexOf(D, "Line") ? "sceneweblayerline" : -1 < m.indexOf(D, "3DObject") ? "sceneweblayermultipatch" : -1 < m.indexOf(D, "Point") ? "sceneweblayerpoint" : -1 < m.indexOf(D, "IntegratedMesh") ? "sceneweblayermesh" : -1 < m.indexOf(D, "PointCloud") ? "sceneweblayerpointcloud" : -1 < m.indexOf(D, "Polygon") ? "sceneweblayerpolygon" : -1 < m.indexOf(D, "Building") ? "sceneweblayerbuilding" : -1 < m.indexOf(D, "Voxel") ? "sceneweblayervoxel" : "sceneweblayer" :
                                                                                "image service" === y ? -1 < m.indexOf(D, "Elevation 3D Layer") ? "elevationlayer" : -1 < m.indexOf(D, "Tiled Imagery") ? "tiledimagerylayer" : "imagery" : "stream service" === y ? "streamlayer" : "vector tile service" === y ? "vectortile" : "datastore catalog service" === y ? "datastorecollection" : "geocoding service" === y ? "geocodeservice" : "video service" === y ? "mediaservice" : "geoprocessing service" === y ? -1 < m.indexOf(D, "Web Tool") && this.portal && this.portal.isPortal ? "tool" : "layers" : "geodata service" === y ? "geodataservice" : "layers") : y = "web map" ===
                                                                                        y || "cityengine web scene" === y ? "maps" : "web scene" === y ? -1 < m.indexOf(D, "ViewingMode-Local") ? "webscenelocal" : "websceneglobal" : "web mapping application" === y && -1 < m.indexOf(D, "configurableApp") ? "instantapps" : "web mapping application" === y || "mobile application" === y || "application" === y || "operation view" === y || "desktop application" === y ? "apps" : "map document" === y || "map package" === y || "published map" === y || "scene document" === y || "globe document" === y || "basemap package" === y || "mobile basemap package" === y || "mobile map package" ===
                                                                                                y || "project package" === y || "project template" === y || "pro map" === y || "layout" === y || "layer" === y && -1 < m.indexOf(D, "ArcGIS Pro") || "explorer map" === y && m.indexOf(D, "Explorer Document") ? "mapsgray" : "service definition" === y || "csv" === y || "shapefile" === y || "cad drawing" === y || "geojson" === y || "360 vr experience" === y || "netcdf" === y || "administrative report" === y ? "datafiles" : "explorer add in" === y || "desktop add in" === y || "windows viewer add in" === y || "windows viewer configuration" === y ? "appsgray" : "arcgis pro add in" === y || "arcgis pro configuration" ===
                                                                                                        y ? "addindesktop" : "rule package" === y || "file geodatabase" === y || "sqlite geodatabase" === y || "csv collection" === y || "kml collection" === y || "windows mobile package" === y || "map template" === y || "desktop application template" === y || "gml" === y || "arcpad package" === y || "code sample" === y || "form" === y || "document link" === y || "earth configuration" === y || "operations dashboard add in" === y || "rules package" === y || "image" === y || "workflow manager package" === y || "explorer map" === y && -1 < m.indexOf(D, "Explorer Mapping Application") || -1 <
                                                                                                                m.indexOf(D, "Document") ? "datafilesgray" : "network analysis service" === y || "geoprocessing service" === y || "geodata service" === y || "geometry service" === y || "geoprocessing package" === y || "locator package" === y || "geoprocessing sample" === y || "workflow manager service" === y ? "toolsgray" : "layer" === y || "layer package" === y || "explorer layer" === y ? "layersgray" : "scene package" === y ? "scenepackage" : "mobile scene package" === y ? "mobilescenepackage" : "tile package" === y || "compact tile package" === y ? "tilepackage" : "task file" === y ? "taskfile" :
                                                                                                                        "report template" === y ? "report-template" : "statistical data collection" === y ? "statisticaldatacollection" : "insights workbook" === y ? "workbook" : "insights model" === y ? "insightsmodel" : "insights page" === y ? "insightspage" : "insights theme" === y ? "insightstheme" : "hub initiative" === y ? "hubinitiative" : "hub page" === y ? "hubpage" : "hub site application" === y ? "hubsite" : "hub event" === y ? "hubevent" : "hub project" === y ? "hubproject" : "relational database connection" === y ? "relationaldatabaseconnection" : "big data file share" === y ? "datastorecollection" :
                                                                                                                                "image collection" === y ? "imagecollection" : "desktop style" === y ? "desktopstyle" : "style" === y ? "style" : "dashboard" === y ? "dashboard" : "raster function template" === y ? "rasterprocessingtemplate" : "vector tile package" === y ? "vectortilepackage" : "ortho mapping project" === y ? "orthomappingproject" : "ortho mapping template" === y ? "orthomappingtemplate" : "solution" === y ? "solutions" : "geopackage" === y ? "geopackage" : "deep learning package" === y ? "deeplearningpackage" : "real time analytic" === y ? "realtimeanalytics" : "big data analytic" ===
                                                                                                                                        y ? "bigdataanalytics" : "feed" === y ? "feed" : "excalibur imagery project" === y ? "excaliburimageryproject" : "notebook" === y ? "notebook" : "storymap" === y ? "storymap" : "survey123 add in" === y ? "survey123addin" : "mission" === y ? "mission" : "mission report" === y ? "missionreport" : "quickcapture project" === y ? "quickcaptureproject" : "pro report" === y ? "proreport" : "urban model" === y ? "urbanmodel" : "web experience" === y ? "experiencebuilder" : "web experience template" === y ? "webexperiencetemplate" : "experience builder widget" === y ? "experiencebuilderwidget" :
                                                                                                                                                "experience builder widget package" === y ? "experiencebuilderwidgetpackage" : "workflow" === y ? "workflow" : "kernel gateway connection" === y ? "kernelgatewayconnection" : "insights script" === y ? "insightsscript" : "hub initiative template" === y ? "hubinitiativetemplate" : "storymap theme" === y ? "storymaptheme" : "knowledge graph" === y ? "knowledgegraph" : "native application" === y ? "nativeapp" : "native application installer" === y ? "nativeappinstaller" : "link chart" === y ? "linkchart" : "investigation" === y ? "investigation" : "ogcfeatureserver" ===
                                                                                                                                                        y ? "features" : "pro project" === y ? "proproject" : "insights workbook package" === y ? "insightsworkbookpackage" : "apache parquet" === y ? "apacheparquet" : "notebook code snippets" === y ? "notebookcodesnippets" : "suitability model" === y ? "suitabilitymodel" : "esri classifier definition" === y ? "classifierdefinition" : "esri classification schema" === y ? "classificationschema" : "insights data engineering workbook" === y ? "dataengineeringworkbook" : "insights data engineering model" === y ? "dataengineeringmodel" : "deep learning studio project" ===
                                                                                                                                                                y ? "deeplearningproject" : "maps"; return y ? r.toUrl("../css/images/item_type_icons/" + y + "16.png") : null
                                                }, _getIsPremiumContent: function () { var y = this.typeKeywords, D = !1; if (-1 < m.indexOf(y, "Requires Subscription") || -1 < m.indexOf(y, "Requires Credits")) D = !0; return D }, _getPremiumIconUrl: function () { var y = this.typeKeywords, D; this.isPremiumContent && (D = -1 < m.indexOf(y, "Requires Credits") ? "premiumcredits" : "premiumitem"); return D ? r.toUrl("../css/images/item_type_icons/" + D + "16.png") : null }, getThumbnailUrl: function (y) {
                                                        var D =
                                                                this.thumbnailUrl; D && y && (D += (-1 === D.indexOf("?") ? "?" : "\x26") + "w\x3d" + y); return D
                                                }
                                        }), B = E([], {
                                                declaredClass: "esri.arcgis.PortalListing", constructor: function (y) {
                                                        q.mixin(this, y); this.id = this.itemId; this.url = (this.portal && this.portal.portalUrl) + "content/" + (this.userItemUrl ? "items/" : "listings/") + this.itemId; this.commentsUrl = this.url + "/comments"; this.created = this.created ? new Date(this.created) : null; this.banner = this.banner ? a.formatUrl(this.url + "/info/" + this.banner) : ""; this.thumbnail = this.thumbnail ? a.formatUrl(this.url +
                                                                "/info/" + this.thumbnail) : ""; this.largeThumbnail = this.largeThumbnail ? a.formatUrl(this.url + "/info/" + this.largeThumbnail) : ""; this.avgRating = this.avgRating || 0; this.numRatings = this.numRatings || 0; this.numComments = this.numComments || 0; this.listingProperties = this.listingProperties || { priceDesc: "", creditsPerTransaction: 0, licenseType: "free", trialSupported: !1, trialDuration: 0, listingAccess: "private" }; for (var D in this.listingProperties) this[D] && (this.listingProperties[D] = this[D]); this.properties = this.properties ||
                                                                        { systemRequirements: "", termsAndConditions: "", version: "1.0" }; this.screenshots = m.map(this.screenshots, q.hitch(this, function (H) { return a.formatUrl(this.url + "/info/" + H) })); this.vendorName = this.vendor.name; this.vendor.thumbnail = this.vendor.thumbnail ? this.userItemUrl ? a.formatUrl(this.portal.portalUrl + "/portals/self/resources/" + this.vendor.thumbnail) : a.formatUrl(this.url + "/vendorinfo/" + this.vendor.thumbnail) : ""
                                                }, getComments: function () { return a.requestToTypedArray(this.commentsUrl, null, null, f, { item: this }) },
                                                getVendor: function () { return this.vendor }
                                        }), t = E([], { declaredClass: "esri.arcgis.PortalProvision", constructor: function (y) { q.mixin(this, y); this.created = this.created ? new Date(this.created) : null; this.startDate = this.startDate ? new Date(this.startDate) : null; this.endDate = this.endDate && -1 !== this.endDate ? new Date(this.endDate) : null; this.listing = y.listing ? new B(q.mixin(y.listing, { portal: this.portal })) : null } }), u = E([], {
                                                declaredClass: "esri.arcgis.PortalGroup", constructor: function (y) {
                                                        q.mixin(this, y); this.url = (this.portal &&
                                                                this.portal.portalUrl) + "community/groups/" + this.id; this.thumbnailUrl = a.formatUrl(this.url + "/info/" + this.thumbnail); this.modified = this.modified ? new Date(this.modified) : null; this.created = this.created ? new Date(this.created) : null
                                                }, getMembers: function () { return a.request(this.url + "/users") }, queryItems: function (y, D) { y = a.formatQueryParams({}, y, D); y.q = "group:" + this.id + (y.q ? " " + y.q : ""); return this.portal.queryItems(y) }, getThumbnailUrl: function (y) {
                                                        var D = this.thumbnailUrl; D && y && (D += (-1 === D.indexOf("?") ? "?" : "\x26") +
                                                                "w\x3d" + y); return D
                                                }
                                        }), z = E([], { declaredClass: "esri.arcgis.PortalFolder", constructor: function (y) { q.mixin(this, y); this.url = (this.portal && this.portal.portalUrl) + "content/users/" + this.username + "/" + this.id; this.created = this.created ? new Date(this.created) : null }, getItems: function () { return a.requestToTypedArray(this.url, null, null, p, { portal: this.portal, folderId: this.id }) } }), x = E([], {
                                                declaredClass: "esri.arcgis.PortalUser", constructor: function (y) {
                                                        q.mixin(this, y); this.url = (this.portal && this.portal.portalUrl) +
                                                                "community/users/" + this.username; this.userContentUrl = (this.portal && this.portal.portalUrl) + "content/users/" + this.username; this.thumbnailUrl = this.thumbnail ? a.formatUrl(this.url + "/info/" + this.thumbnail) : null; this.modified = this.modified ? new Date(this.modified) : null; this.created = this.created ? new Date(this.created) : null
                                                }, getGroups: function () { return e(a.request(this.url).then(q.hitch(this, function (y) { return a.resultsToTypedArray(u, { portal: this.portal }, y.groups) }))) }, getNotifications: function () {
                                                        return a.requestToTypedArray(this.url +
                                                                "/notifications", null, null, null, { portal: this.portal })
                                                }, getGroupInvitations: function () { return a.requestToTypedArray(this.url + "/invitations", null, null, null, { portal: this.portal }) }, getTags: function () { return a.requestToTypedArray(this.url + "/tags", null, null, null, { portal: this.portal }) }, getFolders: function () { return e(this.getContent(null, { num: 1 }).then(function (y) { return y.folders })) }, getItems: function (y) { return e(this.getContent(y).then(function (D) { return D.items })) }, getItem: function (y) {
                                                        return a.request(this.portal.portalUrl +
                                                                "content/items/" + y).then(q.hitch(this, function (D) { return new p(q.mixin(D, { portal: this.portal })) }))
                                                }, getContent: function (y, D) { var H = this.url.replace("/community/", "/content/") + (y ? "/" + y : ""); return a.request(H, D).then(q.hitch(this, function (I) { I.folders = a.resultsToTypedArray(z, { portal: this.portal }, I.folders); I.items = a.resultsToTypedArray(p, { portal: this.portal, folderId: y }, I.items); return I })) }, getThumbnailUrl: function (y) { var D = this.thumbnailUrl; D && y && (D += (-1 === D.indexOf("?") ? "?" : "\x26") + "w\x3d" + y); return D }
                                        });
                                        E = {
                                                Portal: E([g], {
                                                        declaredClass: "esri.arcgis.Portal", onLoad: function () { }, onError: function () { }, constructor: function (y) {
                                                                y = q.isObject(y) ? y : { url: y }; this.registerConnectEvents(); b = { options: { disableIdentityLookup: !0 }, requestParams: { f: "json" } }; y.self ? (b.self = y.self, q.mixin(this, { url: y.url || c.getProtocolForWebResource() + "//" + (y.self.urlKey ? y.self.urlKey + "." + y.self.customBaseUrl : y.self.portalHostname) }), this.portalUrl = -1 !== this.url.indexOf("/sharing") ? this.url + "/" : this.url + "/sharing/rest/", y = y.self.user ? this.signIn() :
                                                                        this.init(this.url)) : (y.url && q.mixin(this, { url: y.url }), y = this.init(this.url)); y.then(q.hitch(this, function () { this.emit("ready", this); this.onLoad(this) }))
                                                        }, init: function (y, D) {
                                                                y = (y || this.portalUrl).replace(/\/+$/, ""); this.portalUrl = -1 !== y.indexOf("/sharing") ? y + "/" : y + "/sharing/rest/"; c.canUseXhr(this.portalUrl) || l.defaults.io.corsEnabledServers.push(this.portalUrl.replace(/^https?:\/\//i, "")); return this._getSelf(this.portalUrl).then(q.hitch(this, function (H) {
                                                                        b.self = q.mixin({}, H); (H = H.user) && D && (b.currentToken =
                                                                                D && D.token, b.loggedInUser = new x(q.mixin(H, { portal: this, credential: D }))); b.self.id && !1 === b.self.canSearchPublic && (b.extraQuery = " AND orgid:" + b.self.id); q.mixin(this, b.self); this.thumbnailUrl = a.formatUrl(this.portalUrl + "portals/self/resources/" + this.thumbnail); this.isOrganization = this.access && this.access.length ? !0 : !1; this.created = this.created ? new Date(this.created) : null; this.modified = this.modified ? new Date(this.modified) : null; return this
                                                                }), q.hitch(this, function (H) { this.onError(H); throw H; }))
                                                        }, signIn: function () {
                                                                var y =
                                                                        new w, D = q.hitch(this, function () { this._onSignIn().then(q.hitch(this, function () { y.resolve(b.loggedInUser) }), q.hitch(this, function (H) { y.reject(H) })) }); if (b && b.self) b && b.loggedInUser ? setTimeout(function () { y.resolve(b.loggedInUser) }, 0) : D(); else this.on("load", q.hitch(this, function () { D() })); return y
                                                        }, signOut: function () { b.loggedInUser.credential && b.loggedInUser.credential.destroy(); b.loggedInUser = null; b.options.disableIdentityLookup = !0; a.clearFieldsFromObject(b.self, this); b.self = null; return this.init(this.url) },
                                                        getPortalUser: function () { return b.loggedInUser }, addResource: function (y, D) { return a.request(this.portalUrl + "portals/self/addResource", { key: y, text: D }, { usePost: !0 }) }, update: function (y) { return a.request(this.portalUrl + "portals/self/update", y, { usePost: !0 }) }, queryGroups: function (y, D) { return this._queryPortal(this.portalUrl + "community/groups", a.formatQueryParams({}, y, D), u) }, queryItems: function (y, D) { return this._queryPortal(this.portalUrl + "search", a.formatQueryParams({}, y, D), p) }, queryListings: function (y) {
                                                                y =
                                                                a.formatQueryParams({}, y, !0); var D = ""; y.q && -1 < y.q.toLowerCase().indexOf("mylistings:true") ? (y.q = y.q.toLowerCase().replace("mylistings:true", ""), D = "?mylistings\x3dtrue") : y.q || (y.q = '""'); return this._queryPortal(this.portalUrl + "content/listings" + D, y, B)
                                                        }, queryCustomerList: function (y, D) { y = a.formatQueryParams({}, y, !0); return this._queryPortal(this.portalUrl + "portals/self/customersList", y) }, getProvisions: function () { return this.getCustomers().then(q.hitch(this, function (y) { return y.purchases })) }, getInterests: function () {
                                                                return this.getCustomers().then(q.hitch(this,
                                                                        function (y) { return y.interests }))
                                                        }, getTrials: function () { return this.getCustomers().then(q.hitch(this, function (y) { return y.trials })) }, getCustomers: function (y) { return a.request(this.portalUrl + "portals/self/customers", { status: y || "all" }) }, getMyPurchases: function () { return this.getPurchases().then(function (y) { return y.purchases }) }, getMyInterests: function () { return this.getPurchases().then(function (y) { return y.interests }) }, getPurchases: function () {
                                                                return a.request(this.portalUrl + "portals/self/purchases").then(q.hitch(this,
                                                                        function (y) { y.interests = m.map(y.interests, function (D) { return q.mixin(D.provision, { listing: D.listing }) }); y.purchases = m.map(y.purchases, function (D) { return q.mixin(D.provision, { listing: D.listing }) }); y.trials = m.map(y.trials, function (D) { return q.mixin(D.provision, { listing: D.listing }) }); y.interests = a.resultsToTypedArray(t, { portal: this }, y.interests); y.trials = a.resultsToTypedArray(t, { portal: this }, y.trials); y.purchases = a.resultsToTypedArray(t, { portal: this }, y.purchases); return y }))
                                                        }, queryUsers: function (y, D) {
                                                                return this._queryPortal(this.portalUrl +
                                                                        "community/users", a.formatQueryParams({ sortField: "username" }, y, D), x)
                                                        }, _onSignIn: function () { b.options.disableIdentityLookup = !1; b.self = null; return k.id.getCredential(this.portalUrl).then(q.hitch(this, "init", this.url)).then(function () { return b.loggedInUser }, q.hitch(this, function (y) { b.options.disableIdentityLookup = !0; this.onError(y); throw y; })) }, _getSelf: function (y) {
                                                                y += "portals/self"; if (b.self) { var D = new w; setTimeout(function () { D.resolve(b.self) }, 0) } else D = a.request(y, { culture: A.locale, withCredentials: !0 });
                                                                return D
                                                        }, _queryPortal: function (y, D, H) { var I = q.mixin({ num: 10, start: 0, sortField: "title", sortOrder: "asc" }, D), N = ["start", "query", "num", "nextStart"]; y = a.request(y, I).then(q.hitch(this, function (T) { T.results = a.resultsToTypedArray(H, { portal: this }, T); T.queryParams = q.mixin({}, I); T.nextQueryParams = q.mixin(I, { start: T.nextStart }); return a.clearFieldsFromObject(N, T) })); y = q.delegate(y); y.queryParams = q.mixin({}, I); y.nextQueryParams = w.when(y, function (T) { return T.nextQueryParams }); return e(y) }
                                                }), PortalFolder: z, PortalGroup: u,
                                                PortalItem: p, PortalUser: x, PortalComment: f, PortalRating: h, PortalUtil: a, PortalResult: e, PortalListing: B
                                        }; v("extend-esri") && q.mixin(q.getObject("arcgis", !0, k), E); return E
                                })
                }, "jimu/dijit/ImageChooser": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff esri/lang ../utils ./_CropImage jimu/dijit/Popup jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "), function (E, q, A, w,
                                m, v, r, l, k, n, d, c, g, b, e) {
                                        var a = 0; E = q([A, w, E], {
                                                templateString: l, declaredClass: "jimu.dijit.ImageChooser", cropImage: !0, displayImg: null, stretchImg: !0, defaultSelfSrc: null, showSelfImg: !1, label: null, showTip: !0, goldenWidth: 400, goldenHeight: 400, maxSize: 1024, format: null, customZIndex: null, imageData: null, postMixInProperties: function () { this.inherited(arguments); this.nls = window.jimuNls.imageChooser; this.nls.common = window.jimuNls.common; this.nls.readError = this.nls.readError || "Failed to read the file." }, postCreate: function () {
                                                        this._initial();
                                                        d.file.supportHTML5() || k("safari") || !d.file.isEnabledFlash() || d.file.loadFileAPI().then(m.hitch(this, function () { v.setStyle(this.mask, "zIndex", 1) }))
                                                }, setImageSize: function (f) { this.goldenWidth = f.width; this.goldenHeight = f.height }, disableChooseImage: function () { v.setStyle(this.fileForm, "display", "none"); this.label && "string" === typeof this.label && v.addClass(this.displayText, "disable-label"); v.removeAttr(this.domNode, "title") }, enableChooseImage: function () {
                                                        v.setStyle(this.fileForm, "display", "block"); this.label &&
                                                                "string" === typeof this.label && v.removeClass(this.displayText, "disable-label"); this._addTip()
                                                }, setDefaultSelfSrc: function (f) { this.defaultSelfSrc = f; this.imageData = this.selfImg.src = f }, getImageData: function () { return this.imageData }, _initial: function () { this._initFileForm(); this._processProperties(); this._addTip() }, _processProperties: function () {
                                                        this.fileProperty = {}; this.label && "string" === typeof this.label && (this.displayText.innerHTML = d.sanitizeHTML(this.label), v.setStyle(this.hintText, "display", "block"));
                                                        this.showSelfImg && v.setStyle(this.hintImage, "display", "block"); !1 === this.stretchImg ? v.addClass(this.selfImg, "no-stretch-img") : v.removeClass(this.selfImg, "no-stretch-img"); this.defaultSelfSrc && (this.imageData = this.selfImg.src = this.defaultSelfSrc); if (this.format) { var f = "image/*"; "string" === typeof this.format && /^image\/./.test(this.format) ? f = this.format : "[object Array]" === Object.prototype.toString.call(this.format) && 0 < this.format.length && (f = this.format.join(",")); v.setAttr(this.fileInput, "accept", f) } d.file.supportHTML5() ||
                                                                k("safari") || !d.file.isEnabledFlash() || v.setStyle(this.fileInput, { width: "100%", height: "100%", position: "absolute", left: 0, top: 0, opacity: 0, zIndex: 9 })
                                                }, _newMessage: function (f) { this.msgPopupOpen = !0; this.msgPopup = new b({ customZIndex: this.customZIndex, message: f }) }, _porcessMaskClick: function () {
                                                        v.setAttr(this.fileInput, "id", "imageChooser_" + a); v.setAttr(this.mask, "for", "imageChooser_" + a); a++; r.once(this.mask, "click", m.hitch(this, function (f) {
                                                                f.stopPropagation(); if (k("safari") && 7 > k("safari")) this._newMessage(this.nls.unsupportReaderAPI),
                                                                        f.preventDefault(); else { if (!d.file.supportHTML5()) { if (!d.file.isEnabledFlash()) { var h = v.create("a", { href: "http://helpx.adobe.com/flash-player.html", innerHTML: this.nls.enableFlash, target: "_blank" }); this._newMessage(h); f.preventDefault(); return } if (!d.file.supportFileAPI()) { this._newMessage(this.nls.unsupportReaderAPI); f.preventDefault(); return } } v.setStyle(this.fileInput, "display", "none"); setTimeout(m.hitch(this, function () { v.setStyle(this.fileInput, "display", "block") }), 200) }
                                                        }))
                                                }, triggerImgUpload: function () {
                                                        var f =
                                                                document.createEvent("MouseEvents"); f.initEvent("click", !0, !1); this.mask.dispatchEvent(f)
                                                }, _addTip: function () { if (this.showTip) { var f = n.substitute({ width: this.goldenWidth || 40, height: this.goldenHeight || 40 }, this.nls.toolTip); v.setAttr(this.domNode, "title", f) } else v.setAttr(this.domNode, "title", "") }, _onFileInputChange: function (f) {
                                                        var h = f.target.files && f.target.files[0] || f.files && f.files[0]; if (this.format && -1 === this.format.indexOf(h.type)) this._newMessage(this.nls.invalidType), this._initFileForm(); else {
                                                                var p =
                                                                        1024 * this.maxSize; d.file.readFile(f, "image/*", p, m.hitch(this, function (B, t, u) { B ? (t = this.nls[B.errCode], "exceed" === B.errCode && (t = t.replace("1024", p / 1024)), this._newMessage(t)) : (this.fileProperty.fileName = t, this.cropImage && "image/gif" !== h.type ? this._cropImageByUser(u, h.type) : this._readFileData(u)); this._initFileForm() }))
                                                        }
                                                }, _initFileForm: function () {
                                                        this.mask && v.destroy(this.mask); this.fileInput && v.destroy(this.fileInput); this.fileForm && v.destroy(this.fileForm); this.fileForm = v.create("form", { "data-dojo-attach-point": "fileForm" },
                                                                this.domNode); this.mask = v.create("label", { "data-dojo-attach-point": "mask" }, this.fileForm); this.fileInput = v.create("input", { type: "file", "data-dojo-attach-point": "fileInput" }, this.fileForm); this._porcessMaskClick(); r.once(this.fileInput, "change", m.hitch(this, this._onFileInputChange))
                                                }, _readFileData: function (f) {
                                                        this.onImageChange(f, this.fileProperty); this.displayImg && v.setAttr(this.displayImg, "src", f); this.showSelfImg && (this.selfImg ? v.setAttr(this.selfImg, "src", f) : this.selfImg.src = f, (f = v.getMarginBox(this.hintImage)) &&
                                                                f.w && f.h && (v.style(this.selfImg, "maxWidth", f.w + "px"), v.style(this.selfImg, "maxHeight", f.h + "px")))
                                                }, _cropImageByUser: function (f, h) {
                                                        var p = new c({ imageSrc: f, type: h, nls: m.clone(this.nls), goldenWidth: this.goldenWidth, goldenHeight: this.goldenHeight }), B = new e({ hidden: !0 }); this.cropPopupOpen = !0; this.cropPopup = new g({
                                                                titleLabel: this.nls.cropImage, content: p, customZIndex: this.customZIndex, width: 500, height: 480, buttons: [{
                                                                        label: this.nls.common.ok, onClick: m.hitch(this, function () {
                                                                                B.show(); var t = p.getData(); t && this._readFileData(t);
                                                                                this.cropPopup.close(); p.destroy(); B.hide()
                                                                        })
                                                                }]
                                                        }); B.placeAt(this.cropPopup.domNode); p.startup(); v.addClass(this.cropPopup.domNode, "image-chooser-crop-popup")
                                                }, onImageChange: function (f) { this.imageData = f; this.emit("imageChange", this.imageData, this.fileProperty); this.emit("change", this.imageData, this.fileProperty) }
                                        }); E.GIF = "image/gif"; E.JPEG = "image/jpeg"; E.PNG = "image/png"; return E
                        })
                }, "jimu/dijit/_CropImage": function () {
                        define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_CropImage.html jimu/dijit/Message libs/cropperjs/cropperjs xstyle/css!libs/cropperjs/cropper.css dojo/NodeList-dom".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        return E([m, v], {
                                                templateString: r, imageSrc: null, type: null, goldenWidth: 4, goldenHeight: 3, _haveShowReadErrMsg: !1, postCreate: function () { this.type || (this.type = "image/jpeg"); this.setImageSrc(this.imageSrc); this.loadingImg.src = require.toUrl("jimu") + "/images/loading.gif"; this._checkImgError(); this.own(w(this.baseImage, "load", A.hitch(this, function () { q.setStyle(this.loadingImg, "display", "none"); this._initCropper() }))) }, _initCropper: function () {
                                                        this.cropper && this.cropper.destroy && this.cropper.destroy();
                                                        this.cropper = new k(this.baseImage, { aspectRatio: this.goldenWidth / this.goldenHeight, preview: ".img-preview" })
                                                }, setImageSrc: function (n) { q.setAttr(this.baseImage, "src", n) }, getData: function () { try { var n = this.cropper.getCroppedCanvas(); this.cropper.getCroppedCanvas(); return n.toDataURL(this.type || "image/jpeg") } catch (d) { return this._readError(), null } }, destroy: function () { this.cropper && this.cropper.destroy && this.cropper.destroy(); this.inherited(arguments) }, _checkImgError: function () {
                                                        setTimeout(A.hitch(this, function () {
                                                                "none" !==
                                                                q.getStyle(this.loadingImg, "display") && this._readError()
                                                        }), 5E3)
                                                }, _readError: function () { this._haveShowReadErrMsg || (new l({ message: this.nls.readError }), this._haveShowReadErrMsg = !0) }
                                        })
                                })
                }, "libs/cropperjs/cropperjs": function () {
                        !function (E, q) { "object" == typeof exports && "undefined" != typeof module ? module.exports = q() : "function" == typeof define && define.amd ? define(q) : (E = E || self).Cropper = q() }(this, function () {
                                function E(V) {
                                        return (E = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (da) { return typeof da } :
                                                function (da) { return da && "function" == typeof Symbol && da.constructor === Symbol && da !== Symbol.prototype ? "symbol" : typeof da })(V)
                                } function q(V, da) { for (var Z = 0; Z < da.length; Z++) { var ea = da[Z]; ea.enumerable = ea.enumerable || !1; ea.configurable = !0; "value" in ea && (ea.writable = !0); Object.defineProperty(V, ea.key, ea) } } function A(V) {
                                        if (!(V = function (da) { if (Array.isArray(da)) { for (var Z = 0, ea = Array(da.length); Z < da.length; Z++)ea[Z] = da[Z]; return ea } }(V) || function (da) {
                                                if (Symbol.iterator in Object(da) || "[object Arguments]" ===
                                                        Object.prototype.toString.call(da)) return Array.from(da)
                                        }(V))) throw new TypeError("Invalid attempt to spread non-iterable instance"); return V
                                } function w(V) { return "number" == typeof V && !Da(V) } function m(V) { return "object" === E(V) && null !== V } function v(V) { if (!m(V)) return !1; try { var da = V.constructor, Z = da.prototype; return da && Z && Ca.call(Z, "isPrototypeOf") } catch (ea) { return !1 } } function r(V) { return "function" == typeof V } function l(V) { return Array.from ? Array.from(V) : O.call(V) } function k(V, da) {
                                        return V && r(da) && (Array.isArray(V) ||
                                                w(V.length) ? l(V).forEach(function (Z, ea) { da.call(V, Z, ea, V) }) : m(V) && Object.keys(V).forEach(function (Z) { da.call(V, V[Z], Z, V) })), V
                                } function n(V) { var da = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : 1E11; return G.test(V) ? Math.round(V * da) / da : V } function d(V, da) { var Z = V.style; k(da, function (ea, la) { L.test(la) && w(ea) && (ea = "".concat(ea, "px")); Z[la] = ea }) } function c(V, da) {
                                        if (da) if (w(V.length)) k(V, function (ea) { c(ea, da) }); else if (V.classList) V.classList.add(da); else {
                                                var Z = V.className.trim(); Z ? 0 > Z.indexOf(da) &&
                                                        (V.className = "".concat(Z, " ").concat(da)) : V.className = da
                                        }
                                } function g(V, da) { da && (w(V.length) ? k(V, function (Z) { g(Z, da) }) : V.classList ? V.classList.remove(da) : 0 <= V.className.indexOf(da) && (V.className = V.className.replace(da, ""))) } function b(V, da, Z) { da && (w(V.length) ? k(V, function (ea) { b(ea, da, Z) }) : Z ? c(V, da) : g(V, da)) } function e(V) { return V.replace(P, "$1-$2").toLowerCase() } function a(V, da) { return m(V[da]) ? V[da] : V.dataset ? V.dataset[da] : V.getAttribute("data-".concat(e(da))) } function f(V, da, Z) {
                                        m(Z) ? V[da] = Z : V.dataset ?
                                                V.dataset[da] = Z : V.setAttribute("data-".concat(e(da)), Z)
                                } function h(V, da, Z) { var ea = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {}, la = Z; da.trim().split(S).forEach(function (oa) { if (!Y) { var ya = V.listeners; ya && ya[oa] && ya[oa][Z] && (la = ya[oa][Z], delete ya[oa][Z], 0 === Object.keys(ya[oa]).length && delete ya[oa], 0 === Object.keys(ya).length && delete V.listeners) } V.removeEventListener(oa, la, ea) }) } function p(V, da, Z) {
                                        var ea = 3 < arguments.length && void 0 !== arguments[3] ? arguments[3] : {}, la = Z; da.trim().split(S).forEach(function (oa) {
                                                if (ea.once &&
                                                        !Y) { var ya = V.listeners, ta = void 0 === ya ? {} : ya; la = function () { delete ta[oa][Z]; V.removeEventListener(oa, la, ea); for (var Ea = arguments.length, Aa = Array(Ea), za = 0; za < Ea; za++)Aa[za] = arguments[za]; Z.apply(V, Aa) }; ta[oa] || (ta[oa] = {}); ta[oa][Z] && V.removeEventListener(oa, ta[oa][Z], ea); ta[oa][Z] = la; V.listeners = ta } V.addEventListener(oa, la, ea)
                                        })
                                } function B(V, da, Z) {
                                        var ea; return r(Event) && r(CustomEvent) ? ea = new CustomEvent(da, { detail: Z, bubbles: !0, cancelable: !0 }) : (ea = document.createEvent("CustomEvent")).initCustomEvent(da,
                                                !0, !0, Z), V.dispatchEvent(ea)
                                } function t(V) { V = V.getBoundingClientRect(); return { left: V.left + (window.pageXOffset - document.documentElement.clientLeft), top: V.top + (window.pageYOffset - document.documentElement.clientTop) } } function u(V) { V = V.match(ja); return null !== V && (V[1] !== ha.protocol || V[2] !== ha.hostname || V[3] !== ha.port) } function z(V) { var da = "timestamp\x3d".concat((new Date).getTime()); return V + (-1 === V.indexOf("?") ? "?" : "\x26") + da } function x(V) {
                                        var da = V.rotate, Z = V.scaleX, ea = V.scaleY, la = V.translateX; V = V.translateY;
                                        var oa = []; w(la) && 0 !== la && oa.push("translateX(".concat(la, "px)")); w(V) && 0 !== V && oa.push("translateY(".concat(V, "px)")); w(da) && 0 !== da && oa.push("rotate(".concat(da, "deg)")); w(Z) && 1 !== Z && oa.push("scaleX(".concat(Z, ")")); w(ea) && 1 !== ea && oa.push("scaleY(".concat(ea, ")")); da = oa.length ? oa.join(" ") : "none"; return { WebkitTransform: da, msTransform: da, transform: da }
                                } function y(V, da) { var Z = V.pageX; V = V.pageY; var ea = { endX: Z, endY: V }; return da ? ea : C({ startX: Z, startY: V }, ea) } function D(V) {
                                        var da = V.aspectRatio, Z = V.height,
                                        ea = V.width, la = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : "contain", oa = 0 < ea && ea < 1 / 0, ya = 0 < Z && Z < 1 / 0; oa && ya ? (oa = Z * da, "contain" === la && ea < oa || "cover" === la && oa < ea ? Z = ea / da : ea = Z * da) : oa ? Z = ea / da : ya && (ea = Z * da); return { width: ea, height: Z }
                                } function H(V) {
                                        V = new DataView(V); try {
                                                var da, Z; if (255 === V.getUint8(0) && 216 === V.getUint8(1)) for (var ea = V.byteLength, la = 2; la + 1 < ea;) { if (255 === V.getUint8(la) && 225 === V.getUint8(la + 1)) { var oa = la; break } la += 1 } if (oa) {
                                                        ea = oa + 10; var ya = oa + 4; oa = 4; la = ""; for (oa += ya; ya < oa; ya += 1)la +=
                                                                ka(V.getUint8(ya)); if ("Exif" === la) { var ta = V.getUint16(ea); if (((da = 18761 === ta) || 19789 === ta) && 42 === V.getUint16(ea + 2, da)) { var Ea = V.getUint32(ea + 4, da); 8 <= Ea && (Z = ea + Ea) } }
                                                } if (Z) { var Aa, za, Ha = V.getUint16(Z, da); for (za = 0; za < Ha; za += 1)if (Aa = Z + 12 * za + 2, 274 === V.getUint16(Aa, da)) { Aa += 8; var Na = V.getUint16(Aa, da); V.setUint16(Aa, 1, da); break } }
                                        } catch (Pa) { Na = 1 } return Na
                                } var I = "undefined" != typeof window, N = I ? window : {}, T = !!I && "ontouchstart" in N.document.documentElement, M = !!I && "PointerEvent" in N, R = "".concat("cropper", "-crop"),
                                        ca = "".concat("cropper", "-disabled"), K = "".concat("cropper", "-hidden"), Q = "".concat("cropper", "-hide"), X = "".concat("cropper", "-invisible"), W = "".concat("cropper", "-modal"), fa = "".concat("cropper", "-move"), ma = "".concat("cropper", "Action"), ia = "".concat("cropper", "Preview"), va = M ? "pointerdown" : T ? "touchstart" : "mousedown", xa = M ? "pointermove" : T ? "touchmove" : "mousemove", na = M ? "pointerup pointercancel" : T ? "touchend touchcancel" : "mouseup", ra = /^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/, sa = /^data:image\/jpeg;base64,/,
                                        wa = /^img|canvas$/i, aa = {
                                                viewMode: 0, dragMode: "crop", initialAspectRatio: NaN, aspectRatio: NaN, data: null, preview: "", responsive: !0, restore: !0, checkCrossOrigin: !0, checkOrientation: !0, modal: !0, guides: !0, center: !0, highlight: !0, background: !0, autoCrop: !0, autoCropArea: .8, movable: !0, rotatable: !0, scalable: !0, zoomable: !0, zoomOnTouch: !0, zoomOnWheel: !0, wheelZoomRatio: .1, cropBoxMovable: !0, cropBoxResizable: !0, toggleDragModeOnDblclick: !0, minCanvasWidth: 0, minCanvasHeight: 0, minCropBoxWidth: 0, minCropBoxHeight: 0, minContainerWidth: 200,
                                                minContainerHeight: 100, ready: null, cropstart: null, cropmove: null, cropend: null, crop: null, zoom: null
                                        }, Da = Number.isNaN || N.isNaN, Ca = Object.prototype.hasOwnProperty, O = Array.prototype.slice, C = Object.assign || function (V) { for (var da = arguments.length, Z = Array(1 < da ? da - 1 : 0), ea = 1; ea < da; ea++)Z[ea - 1] = arguments[ea]; return m(V) && 0 < Z.length && Z.forEach(function (la) { m(la) && Object.keys(la).forEach(function (oa) { V[oa] = la[oa] }) }), V }, G = /\.\d*(?:0|9){12}\d*$/, L = /^width|height|left|top|marginLeft|marginTop$/, P = /([a-z\d])([A-Z])/g,
                                        S = /\s\s*/, Y = function () { var V = !1; if (I) { var da = !1, Z = function () { }, ea = Object.defineProperty({}, "once", { get: function () { return V = !0, da }, set: function (la) { da = la } }); N.addEventListener("test", Z, ea); N.removeEventListener("test", Z, ea) } return V }(), ha = N.location, ja = /^(\w+:)\/\/([^:/?#]*):?(\d*)/i, ka = String.fromCharCode, ua = /^data:.*,/, qa = N.Cropper; T = function () {
                                                function V(ea) {
                                                        var la = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : {}; if (!(this instanceof V)) throw new TypeError("Cannot call a class as a function");
                                                        if (!ea || !wa.test(ea.tagName)) throw Error("The first argument is required and must be an \x3cimg\x3e or \x3ccanvas\x3e element."); this.element = ea; this.options = C({}, aa, v(la) && la); this.disabled = this.cropped = !1; this.pointers = {}; this.sizing = this.sized = this.replaced = this.reloading = this.ready = !1; this.init()
                                                } var da, Z; return Z = [{ key: "noConflict", value: function () { return window.Cropper = qa, V } }, { key: "setDefaults", value: function (ea) { C(aa, v(ea) && ea) } }], da = [{
                                                        key: "init", value: function () {
                                                                var ea, la = this.element, oa =
                                                                        la.tagName.toLowerCase(); if (!la.cropper) { if (la.cropper = this, "img" === oa) { if (this.isImg = !0, ea = la.getAttribute("src") || "", !(this.originalUrl = ea)) return; ea = la.src } else "canvas" === oa && window.HTMLCanvasElement && (ea = la.toDataURL()); this.load(ea) }
                                                        }
                                                }, {
                                                        key: "load", value: function (ea) {
                                                                var la = this; if (ea) {
                                                                        this.url = ea; this.imageData = {}; var oa = this.element, ya = this.options; if (ya.rotatable || ya.scalable || (ya.checkOrientation = !1), ya.checkOrientation && window.ArrayBuffer) if (sa.test(ea)) this.read((ta = ea.replace(ua, ""), Ea =
                                                                                atob(ta), Aa = new ArrayBuffer(Ea.length), k(za = new Uint8Array(Aa), function (Na, Pa) { za[Pa] = Ea.charCodeAt(Pa) }), Aa)); else {
                                                                                        var ta, Ea, Aa, za, Ha = new XMLHttpRequest; ta = this.clone.bind(this); this.reloading = !0; (this.xhr = Ha).onabort = ta; Ha.onerror = ta; Ha.ontimeout = ta; Ha.onprogress = function () { "image/jpeg" !== Ha.getResponseHeader("content-type") && Ha.abort() }; Ha.onload = function () { la.read(Ha.response) }; Ha.onloadend = function () { la.reloading = !1; la.xhr = null }; ya.checkCrossOrigin && u(ea) && oa.crossOrigin && (ea = z(ea)); Ha.open("GET",
                                                                                                ea); Ha.responseType = "arraybuffer"; Ha.withCredentials = "use-credentials" === oa.crossOrigin; Ha.send()
                                                                        } else this.clone()
                                                                }
                                                        }
                                                }, {
                                                        key: "read", value: function (ea) {
                                                                var la = this.options, oa = this.imageData, ya = H(ea), ta = 0, Ea = 1, Aa = 1; 1 < ya && (this.url = function (za, Ha) { var Na = []; for (za = new Uint8Array(za); 0 < za.length;)Na.push(ka.apply(null, l(za.subarray(0, 8192)))), za = za.subarray(8192); return "data:".concat(Ha, ";base64,").concat(btoa(Na.join(""))) }(ea, "image/jpeg"), ea = function (za) {
                                                                        var Ha = 0, Na = 1, Pa = 1; switch (za) {
                                                                                case 2: Na = -1; break;
                                                                                case 3: Ha = -180; break; case 4: Pa = -1; break; case 5: Ha = 90; Pa = -1; break; case 6: Ha = 90; break; case 7: Ha = 90; Na = -1; break; case 8: Ha = -90
                                                                        }return { rotate: Ha, scaleX: Na, scaleY: Pa }
                                                                }(ya), ta = ea.rotate, Ea = ea.scaleX, Aa = ea.scaleY); la.rotatable && (oa.rotate = ta); la.scalable && (oa.scaleX = Ea, oa.scaleY = Aa); this.clone()
                                                        }
                                                }, {
                                                        key: "clone", value: function () {
                                                                var ea, la, oa = this.element, ya = this.url; this.options.checkCrossOrigin && u(ya) && (la = (ea = oa.crossOrigin) ? ya : (ea = "anonymous", z(ya))); this.crossOrigin = ea; this.crossOriginUrl = la; var ta = document.createElement("img");
                                                                ea && (ta.crossOrigin = ea); ta.src = la || ya; (this.image = ta).onload = this.start.bind(this); ta.onerror = this.stop.bind(this); c(ta, Q); oa.parentNode.insertBefore(ta, oa.nextSibling)
                                                        }
                                                }, {
                                                        key: "start", value: function () {
                                                                var ea = this, la = this.isImg ? this.element : this.image; la.onload = null; la.onerror = null; this.sizing = !0; var oa = N.navigator && /^(?:.(?!chrome|android))*safari/i.test(N.navigator.userAgent), ya = function (Aa, za) { C(ea.imageData, { naturalWidth: Aa, naturalHeight: za, aspectRatio: Aa / za }); ea.sizing = !1; ea.sized = !0; ea.build() };
                                                                if (!la.naturalWidth || oa) { var ta = document.createElement("img"), Ea = document.body || document.documentElement; (this.sizingImage = ta).onload = function () { ya(ta.width, ta.height); oa || Ea.removeChild(ta) }; ta.src = la.src; oa || (ta.style.cssText = "left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;", Ea.appendChild(ta)) } else ya(la.naturalWidth, la.naturalHeight)
                                                        }
                                                }, {
                                                        key: "stop", value: function () {
                                                                var ea = this.image; ea.onload = null;
                                                                ea.onerror = null; ea.parentNode.removeChild(ea); this.image = null
                                                        }
                                                }, {
                                                        key: "build", value: function () {
                                                                if (this.sized && !this.ready) {
                                                                        var ea = this.element, la = this.options, oa = this.image, ya = ea.parentNode, ta = document.createElement("div"); ta.innerHTML = '\x3cdiv class\x3d"cropper-container" touch-action\x3d"none"\x3e\x3cdiv class\x3d"cropper-wrap-box"\x3e\x3cdiv class\x3d"cropper-canvas"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"cropper-drag-box"\x3e\x3c/div\x3e\x3cdiv class\x3d"cropper-crop-box"\x3e\x3cspan class\x3d"cropper-view-box"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-dashed dashed-h"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-dashed dashed-v"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-center"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-face"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-e" data-cropper-action\x3d"e"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-n" data-cropper-action\x3d"n"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-w" data-cropper-action\x3d"w"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-line line-s" data-cropper-action\x3d"s"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-e" data-cropper-action\x3d"e"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-n" data-cropper-action\x3d"n"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-w" data-cropper-action\x3d"w"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-s" data-cropper-action\x3d"s"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-ne" data-cropper-action\x3d"ne"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-nw" data-cropper-action\x3d"nw"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-sw" data-cropper-action\x3d"sw"\x3e\x3c/span\x3e\x3cspan class\x3d"cropper-point point-se" data-cropper-action\x3d"se"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e';
                                                                        ta = ta.querySelector(".".concat("cropper", "-container")); var Ea = ta.querySelector(".".concat("cropper", "-canvas")), Aa = ta.querySelector(".".concat("cropper", "-drag-box")), za = ta.querySelector(".".concat("cropper", "-crop-box")), Ha = za.querySelector(".".concat("cropper", "-face")); this.container = ya; this.cropper = ta; this.canvas = Ea; this.dragBox = Aa; this.cropBox = za; this.viewBox = ta.querySelector(".".concat("cropper", "-view-box")); this.face = Ha; Ea.appendChild(oa); c(ea, K); ya.insertBefore(ta, ea.nextSibling); this.isImg ||
                                                                                g(oa, Q); this.initPreview(); this.bind(); la.initialAspectRatio = Math.max(0, la.initialAspectRatio) || NaN; la.aspectRatio = Math.max(0, la.aspectRatio) || NaN; la.viewMode = Math.max(0, Math.min(3, Math.round(la.viewMode))) || 0; c(za, K); la.guides || c(za.getElementsByClassName("".concat("cropper", "-dashed")), K); la.center || c(za.getElementsByClassName("".concat("cropper", "-center")), K); la.background && c(ta, "".concat("cropper", "-bg")); la.highlight || c(Ha, X); la.cropBoxMovable && (c(Ha, fa), f(Ha, ma, "all")); la.cropBoxResizable ||
                                                                                        (c(za.getElementsByClassName("".concat("cropper", "-line")), K), c(za.getElementsByClassName("".concat("cropper", "-point")), K)); this.render(); this.ready = !0; this.setDragMode(la.dragMode); la.autoCrop && this.crop(); this.setData(la.data); r(la.ready) && p(ea, "ready", la.ready, { once: !0 }); B(ea, "ready")
                                                                }
                                                        }
                                                }, { key: "unbuild", value: function () { this.ready && (this.ready = !1, this.unbind(), this.resetPreview(), this.cropper.parentNode.removeChild(this.cropper), g(this.element, K)) } }, {
                                                        key: "uncreate", value: function () {
                                                                this.ready ?
                                                                (this.unbuild(), this.ready = !1, this.cropped = !1) : this.sizing ? (this.sizingImage.onload = null, this.sizing = !1, this.sized = !1) : this.reloading ? (this.xhr.onabort = null, this.xhr.abort()) : this.image && this.stop()
                                                        }
                                                }], q(V.prototype, da), Z && q(V, Z), V
                                        }(); return C(T.prototype, {
                                                render: function () { this.initContainer(); this.initCanvas(); this.initCropBox(); this.renderCanvas(); this.cropped && this.renderCropBox() }, initContainer: function () {
                                                        var V = this.element, da = this.options, Z = this.container, ea = this.cropper; c(ea, K); g(V, K); da = {
                                                                width: Math.max(Z.offsetWidth,
                                                                        Number(da.minContainerWidth) || 200), height: Math.max(Z.offsetHeight, Number(da.minContainerHeight) || 100)
                                                        }; d(ea, { width: (this.containerData = da).width, height: da.height }); c(V, K); g(ea, K)
                                                }, initCanvas: function () {
                                                        var V = this.containerData, da = this.imageData, Z = this.options.viewMode, ea = 90 == Math.abs(da.rotate) % 180, la = ea ? da.naturalHeight : da.naturalWidth, oa = ea ? da.naturalWidth : da.naturalHeight, ya = la / oa; ea = V.width; var ta = V.height; V.height * ya > V.width ? 3 === Z ? ea = V.height * ya : ta = V.width / ya : 3 === Z ? ta = V.width / ya : ea = V.height *
                                                                ya; la = { aspectRatio: ya, naturalWidth: la, naturalHeight: oa, width: ea, height: ta }; la.left = (V.width - ea) / 2; la.top = (V.height - ta) / 2; la.oldLeft = la.left; la.oldTop = la.top; this.canvasData = la; this.limited = 1 === Z || 2 === Z; this.limitCanvas(!0, !0); this.initialImageData = C({}, da); this.initialCanvasData = C({}, la)
                                                }, limitCanvas: function (V, da) {
                                                        var Z = this.options, ea = this.containerData, la = this.canvasData, oa = this.cropBoxData, ya = Z.viewMode, ta = la.aspectRatio, Ea = this.cropped && oa; V && (V = Number(Z.minCanvasWidth) || 0, Z = Number(Z.minCanvasHeight) ||
                                                                0, 1 < ya ? (V = Math.max(V, ea.width), Z = Math.max(Z, ea.height), 3 === ya && (V < Z * ta ? V = Z * ta : Z = V / ta)) : 0 < ya && (V ? V = Math.max(V, Ea ? oa.width : 0) : Z ? Z = Math.max(Z, Ea ? oa.height : 0) : Ea && ((V = oa.width) < (Z = oa.height) * ta ? V = Z * ta : Z = V / ta)), ta = D({ aspectRatio: ta, width: V, height: Z }), V = ta.width, Z = ta.height, la.minWidth = V, la.minHeight = Z, la.maxWidth = 1 / 0, la.maxHeight = 1 / 0); da && ((Ea ? 0 : 1) < ya ? (da = ea.width - la.width, ta = ea.height - la.height, la.minLeft = Math.min(0, da), la.minTop = Math.min(0, ta), la.maxLeft = Math.max(0, da), la.maxTop = Math.max(0, ta), Ea && this.limited &&
                                                                        (la.minLeft = Math.min(oa.left, oa.left + (oa.width - la.width)), la.minTop = Math.min(oa.top, oa.top + (oa.height - la.height)), la.maxLeft = oa.left, la.maxTop = oa.top, 2 === ya && (la.width >= ea.width && (la.minLeft = Math.min(0, da), la.maxLeft = Math.max(0, da)), la.height >= ea.height && (la.minTop = Math.min(0, ta), la.maxTop = Math.max(0, ta))))) : (la.minLeft = -la.width, la.minTop = -la.height, la.maxLeft = ea.width, la.maxTop = ea.height))
                                                }, renderCanvas: function (V, da) {
                                                        var Z = this.canvasData, ea = this.imageData; if (da) {
                                                                da = ea.naturalWidth * Math.abs(ea.scaleX ||
                                                                        1); var la = ea.naturalHeight * Math.abs(ea.scaleY || 1); ea = ea.rotate || 0; if (90 == (ea = Math.abs(ea) % 180)) la = { width: la, height: da }; else { var oa = ea % 90 * Math.PI / 180, ya = Math.sin(oa), ta = Math.cos(oa); oa = da * ta + la * ya; da = da * ya + la * ta; la = 90 < ea ? { width: da, height: oa } : { width: oa, height: da } } da = la.width; la = la.height; ea = da / Z.naturalWidth * Z.width; ya = la / Z.naturalHeight * Z.height; Z.left -= (ea - Z.width) / 2; Z.top -= (ya - Z.height) / 2; Z.width = ea; Z.height = ya; Z.aspectRatio = da / la; Z.naturalWidth = da; Z.naturalHeight = la; this.limitCanvas(!0, !1)
                                                        } (Z.width >
                                                                Z.maxWidth || Z.width < Z.minWidth) && (Z.left = Z.oldLeft); (Z.height > Z.maxHeight || Z.height < Z.minHeight) && (Z.top = Z.oldTop); Z.width = Math.min(Math.max(Z.width, Z.minWidth), Z.maxWidth); Z.height = Math.min(Math.max(Z.height, Z.minHeight), Z.maxHeight); this.limitCanvas(!1, !0); Z.left = Math.min(Math.max(Z.left, Z.minLeft), Z.maxLeft); Z.top = Math.min(Math.max(Z.top, Z.minTop), Z.maxTop); Z.oldLeft = Z.left; Z.oldTop = Z.top; d(this.canvas, C({ width: Z.width, height: Z.height }, x({ translateX: Z.left, translateY: Z.top }))); this.renderImage(V);
                                                        this.cropped && this.limited && this.limitCropBox(!0, !0)
                                                }, renderImage: function (V) { var da = this.canvasData, Z = this.imageData, ea = da.width / da.naturalWidth * Z.naturalWidth, la = da.height / da.naturalHeight * Z.naturalHeight; C(Z, { width: ea, height: la, left: (da.width - ea) / 2, top: (da.height - la) / 2 }); d(this.image, C({ width: Z.width, height: Z.height }, x(C({ translateX: Z.left, translateY: Z.top }, Z)))); V && this.output() }, initCropBox: function () {
                                                        var V = this.options, da = this.canvasData, Z = V.aspectRatio || V.initialAspectRatio; V = Number(V.autoCropArea) ||
                                                                .8; var ea = { width: da.width, height: da.height }; Z && (da.height * Z > da.width ? ea.height = ea.width / Z : ea.width = ea.height * Z); this.cropBoxData = ea; this.limitCropBox(!0, !0); ea.width = Math.min(Math.max(ea.width, ea.minWidth), ea.maxWidth); ea.height = Math.min(Math.max(ea.height, ea.minHeight), ea.maxHeight); ea.width = Math.max(ea.minWidth, ea.width * V); ea.height = Math.max(ea.minHeight, ea.height * V); ea.left = da.left + (da.width - ea.width) / 2; ea.top = da.top + (da.height - ea.height) / 2; ea.oldLeft = ea.left; ea.oldTop = ea.top; this.initialCropBoxData =
                                                                        C({}, ea)
                                                }, limitCropBox: function (V, da) {
                                                        var Z = this.options, ea = this.containerData, la = this.canvasData, oa = this.cropBoxData, ya = this.limited, ta = Z.aspectRatio; if (V) {
                                                                V = Number(Z.minCropBoxWidth) || 0; Z = Number(Z.minCropBoxHeight) || 0; var Ea = ya ? Math.min(ea.width, la.width, la.width + la.left, ea.width - la.left) : ea.width, Aa = ya ? Math.min(ea.height, la.height, la.height + la.top, ea.height - la.top) : ea.height; V = Math.min(V, ea.width); Z = Math.min(Z, ea.height); ta && (V && Z ? V < Z * ta ? Z = V / ta : V = Z * ta : V ? Z = V / ta : Z && (V = Z * ta), Ea < Aa * ta ? Aa = Ea / ta : Ea =
                                                                        Aa * ta); oa.minWidth = Math.min(V, Ea); oa.minHeight = Math.min(Z, Aa); oa.maxWidth = Ea; oa.maxHeight = Aa
                                                        } da && (oa.maxTop = ya ? (oa.minLeft = Math.max(0, la.left), oa.minTop = Math.max(0, la.top), oa.maxLeft = Math.min(ea.width, la.left + la.width) - oa.width, Math.min(ea.height, la.top + la.height) - oa.height) : (oa.minLeft = 0, oa.minTop = 0, oa.maxLeft = ea.width - oa.width, ea.height - oa.height))
                                                }, renderCropBox: function () {
                                                        var V = this.options, da = this.containerData, Z = this.cropBoxData; (Z.width > Z.maxWidth || Z.width < Z.minWidth) && (Z.left = Z.oldLeft); (Z.height >
                                                                Z.maxHeight || Z.height < Z.minHeight) && (Z.top = Z.oldTop); Z.width = Math.min(Math.max(Z.width, Z.minWidth), Z.maxWidth); Z.height = Math.min(Math.max(Z.height, Z.minHeight), Z.maxHeight); this.limitCropBox(!1, !0); Z.left = Math.min(Math.max(Z.left, Z.minLeft), Z.maxLeft); Z.top = Math.min(Math.max(Z.top, Z.minTop), Z.maxTop); Z.oldLeft = Z.left; Z.oldTop = Z.top; V.movable && V.cropBoxMovable && f(this.face, ma, Z.width >= da.width && Z.height >= da.height ? "move" : "all"); d(this.cropBox, C({ width: Z.width, height: Z.height }, x({
                                                                        translateX: Z.left,
                                                                        translateY: Z.top
                                                                }))); this.cropped && this.limited && this.limitCanvas(!0, !0); this.disabled || this.output()
                                                }, output: function () { this.preview(); B(this.element, "crop", this.getData()) }
                                        }, {
                                                initPreview: function () {
                                                        var V = this.crossOrigin, da = this.options.preview, Z = V ? this.crossOriginUrl : this.url, ea = document.createElement("img"); if (V && (ea.crossOrigin = V), ea.src = Z, this.viewBox.appendChild(ea), this.viewBoxImage = ea, da) ea = da, "string" == typeof da ? ea = this.element.ownerDocument.querySelectorAll(da) : da.querySelector && (ea = [da]),
                                                                k(this.previews = ea, function (la) { var oa = document.createElement("img"); f(la, ia, { width: la.offsetWidth, height: la.offsetHeight, html: la.innerHTML }); V && (oa.crossOrigin = V); oa.src = Z; oa.style.cssText = 'display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"'; la.innerHTML = ""; la.appendChild(oa) })
                                                }, resetPreview: function () {
                                                        k(this.previews, function (V) {
                                                                var da = a(V, ia); d(V, { width: da.width, height: da.height });
                                                                V.innerHTML = da.html; if (m(V[ia])) try { delete V[ia] } catch (Z) { V[ia] = void 0 } else if (V.dataset) try { delete V.dataset[ia] } catch (Z) { V.dataset[ia] = void 0 } else V.removeAttribute("data-".concat(e(ia)))
                                                        })
                                                }, preview: function () {
                                                        var V = this.imageData, da = this.canvasData, Z = this.cropBoxData, ea = Z.width, la = Z.height, oa = V.width, ya = V.height, ta = Z.left - da.left - V.left, Ea = Z.top - da.top - V.top; this.cropped && !this.disabled && (d(this.viewBoxImage, C({ width: oa, height: ya }, x(C({ translateX: -ta, translateY: -Ea }, V)))), k(this.previews, function (Aa) {
                                                                var za =
                                                                        a(Aa, ia), Ha = za.width; za = za.height; var Na = Ha, Pa = za, Sa = 1; ea && (Pa = la * (Sa = Ha / ea)); la && za < Pa && (Na = ea * (Sa = za / la), Pa = za); d(Aa, { width: Na, height: Pa }); d(Aa.getElementsByTagName("img")[0], C({ width: oa * Sa, height: ya * Sa }, x(C({ translateX: -ta * Sa, translateY: -Ea * Sa }, V))))
                                                        }))
                                                }
                                        }, {
                                                bind: function () {
                                                        var V = this.element, da = this.options, Z = this.cropper; r(da.cropstart) && p(V, "cropstart", da.cropstart); r(da.cropmove) && p(V, "cropmove", da.cropmove); r(da.cropend) && p(V, "cropend", da.cropend); r(da.crop) && p(V, "crop", da.crop); r(da.zoom) &&
                                                                p(V, "zoom", da.zoom); p(Z, va, this.onCropStart = this.cropStart.bind(this)); da.zoomable && da.zoomOnWheel && p(Z, "wheel", this.onWheel = this.wheel.bind(this), { passive: !1, capture: !0 }); da.toggleDragModeOnDblclick && p(Z, "dblclick", this.onDblclick = this.dblclick.bind(this)); p(V.ownerDocument, xa, this.onCropMove = this.cropMove.bind(this)); p(V.ownerDocument, na, this.onCropEnd = this.cropEnd.bind(this)); da.responsive && p(window, "resize", this.onResize = this.resize.bind(this))
                                                }, unbind: function () {
                                                        var V = this.element, da = this.options,
                                                        Z = this.cropper; r(da.cropstart) && h(V, "cropstart", da.cropstart); r(da.cropmove) && h(V, "cropmove", da.cropmove); r(da.cropend) && h(V, "cropend", da.cropend); r(da.crop) && h(V, "crop", da.crop); r(da.zoom) && h(V, "zoom", da.zoom); h(Z, va, this.onCropStart); da.zoomable && da.zoomOnWheel && h(Z, "wheel", this.onWheel, { passive: !1, capture: !0 }); da.toggleDragModeOnDblclick && h(Z, "dblclick", this.onDblclick); h(V.ownerDocument, xa, this.onCropMove); h(V.ownerDocument, na, this.onCropEnd); da.responsive && h(window, "resize", this.onResize)
                                                }
                                        },
                                                {
                                                        resize: function () { var V = this.options, da = this.container, Z = this.containerData, ea = Number(V.minContainerWidth) || 200, la = Number(V.minContainerHeight) || 100; if (!(this.disabled || Z.width <= ea || Z.height <= la)) { var oa, ya, ta = da.offsetWidth / Z.width; if (1 !== ta || da.offsetHeight !== Z.height) V.restore && (oa = this.getCanvasData(), ya = this.getCropBoxData()), this.render(), V.restore && (this.setCanvasData(k(oa, function (Ea, Aa) { oa[Aa] = Ea * ta })), this.setCropBoxData(k(ya, function (Ea, Aa) { ya[Aa] = Ea * ta }))) } }, dblclick: function () {
                                                                var V;
                                                                this.disabled || "none" === this.options.dragMode || this.setDragMode((V = this.dragBox, (V.classList ? V.classList.contains(R) : -1 < V.className.indexOf(R)) ? "move" : "crop"))
                                                        }, wheel: function (V) { var da = this, Z = Number(this.options.wheelZoomRatio) || .1, ea = 1; this.disabled || (V.preventDefault(), this.wheeling || (this.wheeling = !0, setTimeout(function () { da.wheeling = !1 }, 50), V.deltaY ? ea = 0 < V.deltaY ? 1 : -1 : V.wheelDelta ? ea = -V.wheelDelta / 120 : V.detail && (ea = 0 < V.detail ? 1 : -1), this.zoom(-ea * Z, V))) }, cropStart: function (V) {
                                                                var da = V.buttons,
                                                                Z = V.button; if (!(this.disabled || w(da) && 1 !== da || w(Z) && 0 !== Z || V.ctrlKey)) { da = this.options; var ea = this.pointers; V.changedTouches ? k(V.changedTouches, function (la) { ea[la.identifier] = y(la) }) : ea[V.pointerId || 0] = y(V); da = 1 < Object.keys(ea).length && da.zoomable && da.zoomOnTouch ? "zoom" : a(V.target, ma); ra.test(da) && !1 !== B(this.element, "cropstart", { originalEvent: V, action: da }) && (V.preventDefault(), this.action = da, this.cropping = !1, "crop" === da && (this.cropping = !0, c(this.dragBox, W))) }
                                                        }, cropMove: function (V) {
                                                                var da = this.action;
                                                                if (!this.disabled && da) { var Z = this.pointers; V.preventDefault(); !1 !== B(this.element, "cropmove", { originalEvent: V, action: da }) && (V.changedTouches ? k(V.changedTouches, function (ea) { C(Z[ea.identifier] || {}, y(ea, !0)) }) : C(Z[V.pointerId || 0] || {}, y(V, !0)), this.change(V)) }
                                                        }, cropEnd: function (V) {
                                                                if (!this.disabled) {
                                                                        var da = this.action, Z = this.pointers; V.changedTouches ? k(V.changedTouches, function (ea) { delete Z[ea.identifier] }) : delete Z[V.pointerId || 0]; da && (V.preventDefault(), Object.keys(Z).length || (this.action = ""), this.cropping &&
                                                                                (this.cropping = !1, b(this.dragBox, W, this.cropped && this.options.modal)), B(this.element, "cropend", { originalEvent: V, action: da }))
                                                                }
                                                        }
                                                }, {
                                                        change: function (V) {
                                                                var da = this.canvasData, Z = this.containerData, ea = this.cropBoxData, la = this.pointers, oa = this.action, ya = this.options.aspectRatio, ta = ea.left, Ea = ea.top, Aa = ea.width, za = ea.height, Ha = ta + Aa, Na = Ea + za, Pa = 0, Sa = 0, Ra = Z.width, La = Z.height, Wa = !0; !ya && V.shiftKey && (ya = Aa && za ? Aa / za : 1); this.limited && (Pa = ea.minLeft, Sa = ea.minTop, Ra = Pa + Math.min(Z.width, da.width, da.left + da.width),
                                                                        La = Sa + Math.min(Z.height, da.height, da.top + da.height)); var gb, $a; da = la[Object.keys(la)[0]]; var Ma = da.endX - da.startX, Ja = da.endY - da.startY; Z = function (Va) { switch (Va) { case "e": Ha + Ma > Ra && (Ma = Ra - Ha); break; case "w": ta + Ma < Pa && (Ma = Pa - ta); break; case "n": Ea + Ja < Sa && (Ja = Sa - Ea); break; case "s": Na + Ja > La && (Ja = La - Na) } }; switch (oa) {
                                                                                case "all": ta += Ma; Ea += Ja; break; case "e": if (0 <= Ma && (Ra <= Ha || ya && (Ea <= Sa || La <= Na))) { Wa = !1; break } Z("e"); 0 > (Aa += Ma) && (oa = "w", ta -= Aa = -Aa); ya && (za = Aa / ya, Ea += (ea.height - za) / 2); break; case "n": if (0 >=
                                                                                        Ja && (Ea <= Sa || ya && (ta <= Pa || Ra <= Ha))) { Wa = !1; break } Z("n"); za -= Ja; Ea += Ja; 0 > za && (oa = "s", Ea -= za = -za); ya && (Aa = za * ya, ta += (ea.width - Aa) / 2); break; case "w": if (0 >= Ma && (ta <= Pa || ya && (Ea <= Sa || La <= Na))) { Wa = !1; break } Z("w"); Aa -= Ma; ta += Ma; 0 > Aa && (oa = "e", ta -= Aa = -Aa); ya && (za = Aa / ya, Ea += (ea.height - za) / 2); break; case "s": if (0 <= Ja && (La <= Na || ya && (ta <= Pa || Ra <= Ha))) { Wa = !1; break } Z("s"); 0 > (za += Ja) && (oa = "n", Ea -= za = -za); ya && (Aa = za * ya, ta += (ea.width - Aa) / 2); break; case "ne": if (ya) {
                                                                                                if (0 >= Ja && (Ea <= Sa || Ra <= Ha)) { Wa = !1; break } Z("n"); za -= Ja;
                                                                                                Ea += Ja; Aa = za * ya
                                                                                        } else Z("n"), Z("e"), 0 <= Ma ? Ha < Ra ? Aa += Ma : 0 >= Ja && Ea <= Sa && (Wa = !1) : Aa += Ma, 0 >= Ja ? Sa < Ea && (za -= Ja, Ea += Ja) : (za -= Ja, Ea += Ja); 0 > Aa && 0 > za ? (oa = "sw", Ea -= za = -za, ta -= Aa = -Aa) : 0 > Aa ? (oa = "nw", ta -= Aa = -Aa) : 0 > za && (oa = "se", Ea -= za = -za); break; case "nw": if (ya) { if (0 >= Ja && (Ea <= Sa || ta <= Pa)) { Wa = !1; break } Z("n"); za -= Ja; Ea += Ja; Aa = za * ya; ta += ea.width - Aa } else Z("n"), Z("w"), 0 >= Ma ? Pa < ta ? (Aa -= Ma, ta += Ma) : 0 >= Ja && Ea <= Sa && (Wa = !1) : (Aa -= Ma, ta += Ma), 0 >= Ja ? Sa < Ea && (za -= Ja, Ea += Ja) : (za -= Ja, Ea += Ja); 0 > Aa && 0 > za ? (oa = "se", Ea -= za = -za, ta -= Aa =
                                                                                                -Aa) : 0 > Aa ? (oa = "ne", ta -= Aa = -Aa) : 0 > za && (oa = "sw", Ea -= za = -za); break; case "sw": if (ya) { if (0 >= Ma && (ta <= Pa || La <= Na)) { Wa = !1; break } Z("w"); Aa -= Ma; ta += Ma; za = Aa / ya } else Z("s"), Z("w"), 0 >= Ma ? Pa < ta ? (Aa -= Ma, ta += Ma) : 0 <= Ja && La <= Na && (Wa = !1) : (Aa -= Ma, ta += Ma), 0 <= Ja ? Na < La && (za += Ja) : za += Ja; 0 > Aa && 0 > za ? (oa = "ne", Ea -= za = -za, ta -= Aa = -Aa) : 0 > Aa ? (oa = "se", ta -= Aa = -Aa) : 0 > za && (oa = "nw", Ea -= za = -za); break; case "se": if (ya) { if (0 <= Ma && (Ra <= Ha || La <= Na)) { Wa = !1; break } Z("e"); za = (Aa += Ma) / ya } else Z("s"), Z("e"), 0 <= Ma ? Ha < Ra ? Aa += Ma : 0 <= Ja && La <= Na && (Wa =
                                                                                                        !1) : Aa += Ma, 0 <= Ja ? Na < La && (za += Ja) : za += Ja; 0 > Aa && 0 > za ? (oa = "nw", Ea -= za = -za, ta -= Aa = -Aa) : 0 > Aa ? (oa = "sw", ta -= Aa = -Aa) : 0 > za && (oa = "ne", Ea -= za = -za); break; case "move": this.move(Ma, Ja); Wa = !1; break; case "zoom": this.zoom((gb = C({}, la), $a = [], k(la, function (Va, kb) { delete gb[kb]; k(gb, function (bb) { var Ia = Math.abs(Va.startX - bb.startX), Xa = Math.abs(Va.startY - bb.startY), hb = Math.abs(Va.endX - bb.endX); bb = Math.abs(Va.endY - bb.endY); Ia = Math.sqrt(Ia * Ia + Xa * Xa); $a.push((Math.sqrt(hb * hb + bb * bb) - Ia) / Ia) }) }), $a.sort(function (Va, kb) {
                                                                                                                return Math.abs(Va) <
                                                                                                                        Math.abs(kb)
                                                                                                        }), $a[0]), V); Wa = !1; break; case "crop": Ma && Ja ? (V = t(this.cropper), ta = da.startX - V.left, Ea = da.startY - V.top, Aa = ea.minWidth, za = ea.minHeight, 0 < Ma ? oa = 0 < Ja ? "se" : "ne" : 0 > Ma && (ta -= Aa, oa = 0 < Ja ? "sw" : "nw"), 0 > Ja && (Ea -= za), this.cropped || (g(this.cropBox, K), this.cropped = !0, this.limited && this.limitCropBox(!0, !0))) : Wa = !1
                                                                        }Wa && (ea.width = Aa, ea.height = za, ea.left = ta, ea.top = Ea, this.action = oa, this.renderCropBox()); k(la, function (Va) { Va.startX = Va.endX; Va.startY = Va.endY })
                                                        }
                                        }, {
                                                crop: function () {
                                                        return !this.ready || this.cropped ||
                                                                this.disabled || (this.cropped = !0, this.limitCropBox(!0, !0), this.options.modal && c(this.dragBox, W), g(this.cropBox, K), this.setCropBoxData(this.initialCropBoxData)), this
                                                }, reset: function () { return this.ready && !this.disabled && (this.imageData = C({}, this.initialImageData), this.canvasData = C({}, this.initialCanvasData), this.cropBoxData = C({}, this.initialCropBoxData), this.renderCanvas(), this.cropped && this.renderCropBox()), this }, clear: function () {
                                                        return this.cropped && !this.disabled && (C(this.cropBoxData, {
                                                                left: 0, top: 0,
                                                                width: 0, height: 0
                                                        }), this.cropped = !1, this.renderCropBox(), this.limitCanvas(!0, !0), this.renderCanvas(), g(this.dragBox, W), c(this.cropBox, K)), this
                                                }, replace: function (V) {
                                                        var da = 1 < arguments.length && void 0 !== arguments[1] && arguments[1]; return !this.disabled && V && (this.isImg && (this.element.src = V), da ? (this.url = V, this.image.src = V, this.ready && (this.viewBoxImage.src = V, k(this.previews, function (Z) { Z.getElementsByTagName("img")[0].src = V }))) : (this.isImg && (this.replaced = !0), this.options.data = null, this.uncreate(), this.load(V))),
                                                                this
                                                }, enable: function () { return this.ready && this.disabled && (this.disabled = !1, g(this.cropper, ca)), this }, disable: function () { return this.ready && !this.disabled && (this.disabled = !0, c(this.cropper, ca)), this }, destroy: function () { var V = this.element; return V.cropper && (V.cropper = void 0, this.isImg && this.replaced && (V.src = this.originalUrl), this.uncreate()), this }, move: function (V) {
                                                        var da = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : V, Z = this.canvasData, ea = Z.left; Z = Z.top; return this.moveTo(void 0 === V ? V : ea +
                                                                Number(V), void 0 === da ? da : Z + Number(da))
                                                }, moveTo: function (V) { var da = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : V, Z = this.canvasData, ea = !1; return V = Number(V), da = Number(da), this.ready && !this.disabled && this.options.movable && (w(V) && (Z.left = V, ea = !0), w(da) && (Z.top = da, ea = !0), ea && this.renderCanvas(!0)), this }, zoom: function (V, da) { var Z = this.canvasData; return V = 0 > (V = Number(V)) ? 1 / (1 - V) : 1 + V, this.zoomTo(Z.width * V / Z.naturalWidth, null, da) }, zoomTo: function (V, da, Z) {
                                                        var ea, la, oa, ya = this.options, ta = this.canvasData,
                                                        Ea = ta.width, Aa = ta.height, za = ta.naturalWidth, Ha = ta.naturalHeight; if (0 <= (V = Number(V)) && this.ready && !this.disabled && ya.zoomable) {
                                                                ya = za * V; Ha *= V; if (!1 === B(this.element, "zoom", { ratio: V, oldRatio: Ea / za, originalEvent: Z })) return this; Z ? (da = this.pointers, V = t(this.cropper), Z = da && Object.keys(da).length ? (oa = la = ea = 0, k(da, function (Na) { var Pa = Na.startY; ea += Na.startX; la += Pa; oa += 1 }), { pageX: ea /= oa, pageY: la /= oa }) : { pageX: Z.pageX, pageY: Z.pageY }, ta.left -= (Z.pageX - V.left - ta.left) / Ea * (ya - Ea), ta.top -= (Z.pageY - V.top - ta.top) /
                                                                        Aa * (Ha - Aa)) : v(da) && w(da.x) && w(da.y) ? (ta.left -= (da.x - ta.left) / Ea * (ya - Ea), ta.top -= (da.y - ta.top) / Aa * (Ha - Aa)) : (ta.left -= (ya - Ea) / 2, ta.top -= (Ha - Aa) / 2); ta.width = ya; ta.height = Ha; this.renderCanvas(!0)
                                                        } return this
                                                }, rotate: function (V) { return this.rotateTo((this.imageData.rotate || 0) + Number(V)) }, rotateTo: function (V) { return w(V = Number(V)) && this.ready && !this.disabled && this.options.rotatable && (this.imageData.rotate = V % 360, this.renderCanvas(!0, !0)), this }, scaleX: function (V) {
                                                        var da = this.imageData.scaleY; return this.scale(V,
                                                                w(da) ? da : 1)
                                                }, scaleY: function (V) { var da = this.imageData.scaleX; return this.scale(w(da) ? da : 1, V) }, scale: function (V) { var da = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : V, Z = this.imageData, ea = !1; return V = Number(V), da = Number(da), this.ready && !this.disabled && this.options.scalable && (w(V) && (Z.scaleX = V, ea = !0), w(da) && (Z.scaleY = da, ea = !0), ea && this.renderCanvas(!0, !0)), this }, getData: function () {
                                                        var V = 0 < arguments.length && void 0 !== arguments[0] && arguments[0], da = this.options, Z = this.imageData, ea = this.canvasData,
                                                        la = this.cropBoxData; if (this.ready && this.cropped) { var oa = { x: la.left - ea.left, y: la.top - ea.top, width: la.width, height: la.height }; var ya = Z.width / Z.naturalWidth; if (k(oa, function (ta, Ea) { oa[Ea] = ta / ya }), V) V = Math.round(oa.y + oa.height), ea = Math.round(oa.x + oa.width), oa.x = Math.round(oa.x), oa.y = Math.round(oa.y), oa.width = ea - oa.x, oa.height = V - oa.y } else oa = { x: 0, y: 0, width: 0, height: 0 }; return da.rotatable && (oa.rotate = Z.rotate || 0), da.scalable && (oa.scaleX = Z.scaleX || 1, oa.scaleY = Z.scaleY || 1), oa
                                                }, setData: function (V) {
                                                        var da =
                                                                this.options, Z = this.imageData, ea = this.canvasData, la = {}; if (this.ready && !this.disabled && v(V)) {
                                                                        var oa = !1; da.rotatable && w(V.rotate) && V.rotate !== Z.rotate && (Z.rotate = V.rotate, oa = !0); da.scalable && (w(V.scaleX) && V.scaleX !== Z.scaleX && (Z.scaleX = V.scaleX, oa = !0), w(V.scaleY) && V.scaleY !== Z.scaleY && (Z.scaleY = V.scaleY, oa = !0)); oa && this.renderCanvas(!0, !0); da = Z.width / Z.naturalWidth; w(V.x) && (la.left = V.x * da + ea.left); w(V.y) && (la.top = V.y * da + ea.top); w(V.width) && (la.width = V.width * da); w(V.height) && (la.height = V.height * da);
                                                                        this.setCropBoxData(la)
                                                                } return this
                                                }, getContainerData: function () { return this.ready ? C({}, this.containerData) : {} }, getImageData: function () { return this.sized ? C({}, this.imageData) : {} }, getCanvasData: function () { var V = this.canvasData, da = {}; return this.ready && k("left top width height naturalWidth naturalHeight".split(" "), function (Z) { da[Z] = V[Z] }), da }, setCanvasData: function (V) {
                                                        var da = this.canvasData, Z = da.aspectRatio; return this.ready && !this.disabled && v(V) && (w(V.left) && (da.left = V.left), w(V.top) && (da.top = V.top),
                                                                w(V.width) ? (da.width = V.width, da.height = V.width / Z) : w(V.height) && (da.height = V.height, da.width = V.height * Z), this.renderCanvas(!0)), this
                                                }, getCropBoxData: function () { var V, da = this.cropBoxData; return this.ready && this.cropped && (V = { left: da.left, top: da.top, width: da.width, height: da.height }), V || {} }, setCropBoxData: function (V) {
                                                        var da, Z, ea = this.cropBoxData, la = this.options.aspectRatio; return this.ready && this.cropped && !this.disabled && v(V) && (w(V.left) && (ea.left = V.left), w(V.top) && (ea.top = V.top), w(V.width) && V.width !==
                                                                ea.width && (da = !0, ea.width = V.width), w(V.height) && V.height !== ea.height && (Z = !0, ea.height = V.height), la && (da ? ea.height = ea.width / la : Z && (ea.width = ea.height * la)), this.renderCropBox()), this
                                                }, getCroppedCanvas: function () {
                                                        var V = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {}; if (!this.ready || !window.HTMLCanvasElement) return null; var da, Z, ea, la, oa, ya, ta, Ea, Aa, za, Ha, Na, Pa, Sa, Ra, La, Wa, gb, $a, Ma, Ja, Va, kb, bb, Ia, Xa, hb, Kb, zb, jb, Wb, Ab, Eb, Fb, pb, Lb, Mb, Gb, Nb, ab = this.canvasData, qb = (da = this.image, Z = this.imageData,
                                                                ea = Z.aspectRatio, la = Z.naturalWidth, oa = Z.naturalHeight, ya = Z.rotate, ta = void 0 === ya ? 0 : ya, Ea = Z.scaleX, Aa = void 0 === Ea ? 1 : Ea, za = Z.scaleY, Ha = void 0 === za ? 1 : za, Na = ab.aspectRatio, Pa = ab.naturalWidth, Sa = ab.naturalHeight, Ra = V.fillColor, La = void 0 === Ra ? "transparent" : Ra, Wa = V.imageSmoothingEnabled, gb = void 0 === Wa || Wa, $a = V.imageSmoothingQuality, Ma = void 0 === $a ? "low" : $a, Ja = V.maxWidth, Va = void 0 === Ja ? 1 / 0 : Ja, kb = V.maxHeight, bb = void 0 === kb ? 1 / 0 : kb, Ia = V.minWidth, Xa = void 0 === Ia ? 0 : Ia, hb = V.minHeight, Kb = void 0 === hb ? 0 : hb, zb = document.createElement("canvas"),
                                                                jb = zb.getContext("2d"), Wb = D({ aspectRatio: Na, width: Va, height: bb }), Ab = D({ aspectRatio: Na, width: Xa, height: Kb }, "cover"), Eb = Math.min(Wb.width, Math.max(Ab.width, Pa)), Fb = Math.min(Wb.height, Math.max(Ab.height, Sa)), pb = D({ aspectRatio: ea, width: Va, height: bb }), Lb = D({ aspectRatio: ea, width: Xa, height: Kb }, "cover"), Mb = Math.min(pb.width, Math.max(Lb.width, la)), Gb = Math.min(pb.height, Math.max(Lb.height, oa)), Nb = [-Mb / 2, -Gb / 2, Mb, Gb], zb.width = n(Eb), zb.height = n(Fb), jb.fillStyle = La, jb.fillRect(0, 0, Eb, Fb), jb.save(), jb.translate(Eb /
                                                                        2, Fb / 2), jb.rotate(ta * Math.PI / 180), jb.scale(Aa, Ha), jb.imageSmoothingEnabled = gb, jb.imageSmoothingQuality = Ma, jb.drawImage.apply(jb, [da].concat(A(Nb.map(function (Ob) { return Math.floor(n(Ob)) })))), jb.restore(), zb); if (!this.cropped) return qb; ea = this.getData(); la = ea.x; Z = ea.y; da = ea.width; ea = ea.height; ab = qb.width / Math.floor(ab.naturalWidth); 1 !== ab && (la *= ab, Z *= ab, da *= ab, ea *= ab); ta = da / ea; oa = D({ aspectRatio: ta, width: V.maxWidth || 1 / 0, height: V.maxHeight || 1 / 0 }); ya = D({
                                                                                aspectRatio: ta, width: V.minWidth || 0, height: V.minHeight ||
                                                                                        0
                                                                        }, "cover"); ta = D({ aspectRatio: ta, width: V.width || (1 !== ab ? qb.width : da), height: V.height || (1 !== ab ? qb.height : ea) }); ab = ta.width; ta = ta.height; ab = Math.min(oa.width, Math.max(ya.width, ab)); ta = Math.min(oa.height, Math.max(ya.height, ta)); oa = document.createElement("canvas"); ya = oa.getContext("2d"); oa.width = n(ab); oa.height = n(ta); ya.fillStyle = V.fillColor || "transparent"; ya.fillRect(0, 0, ab, ta); ta = V.imageSmoothingEnabled; V = V.imageSmoothingQuality; ya.imageSmoothingEnabled = void 0 === ta || ta; V && (ya.imageSmoothingQuality =
                                                                                V); var rb, mb, ub, Hb, vb, Bb; V = qb.width; ta = qb.height; la <= -da || V < la ? vb = ub = rb = la = 0 : 0 >= la ? (ub = -la, la = 0, vb = rb = Math.min(V, da + la)) : la <= V && (ub = 0, vb = rb = Math.min(da, V - la)); 0 >= rb || Z <= -ea || ta < Z ? Bb = Hb = mb = Z = 0 : 0 >= Z ? (Hb = -Z, Z = 0, Bb = mb = Math.min(ta, ea + Z)) : Z <= ta && (Hb = 0, Bb = mb = Math.min(ea, ta - Z)); rb = [la, Z, rb, mb]; 0 < vb && 0 < Bb && (mb = ab / da, rb.push(ub * mb, Hb * mb, vb * mb, Bb * mb)); return ya.drawImage.apply(ya, [qb].concat(A(rb.map(function (Ob) { return Math.floor(n(Ob)) })))), oa
                                                }, setAspectRatio: function (V) {
                                                        var da = this.options; return this.disabled ||
                                                                void 0 === V || (da.aspectRatio = Math.max(0, V) || NaN, this.ready && (this.initCropBox(), this.cropped && this.renderCropBox())), this
                                                }, setDragMode: function (V) { var da = this.options, Z = this.dragBox, ea = this.face; if (this.ready && !this.disabled) { var la = "crop" === V, oa = da.movable && "move" === V; V = la || oa ? V : "none"; da.dragMode = V; f(Z, ma, V); b(Z, R, la); b(Z, fa, oa); da.cropBoxMovable || (f(ea, ma, V), b(ea, R, la), b(ea, fa, oa)) } return this }
                                        }), T
                        })
                }, "xstyle/css": function () {
                        define(["require"], function (E) {
                                function q(A, w, m) {
                                        var v = document.documentElement;
                                        A = v.insertBefore(document.createElement(A), v.firstChild); A.id = w; w = (A.currentStyle || getComputedStyle(A, null) || {})[m]; v.removeChild(A); return w
                                } return {
                                        load: function (A, w, m, v) {
                                                function r(d) { var c = q("x-parse", null, "content"), g = d && (d.sheet || d.styleSheet); c && "none" != c && "normal" != c ? w([eval(c)], function (b) { d ? b.process(d, m) : (b.processAll(), m(g)) }) : m(g) } var l = w.toUrl(A); if (l.match(/!$/)) { var k = { wait: !1 }; l = l.slice(0, -1) } var n = w.cache && w.cache["url:" + l]; if (null != n) n.xCss && (n = n.cssText), "string" == typeof n ? E(["./core/load-css"],
                                                        function (d) { r(d.insertCss(n)) }) : r(); else { if ("none" == q("div", A.replace(/\//g, "-").replace(/\..*/, "") + "-loaded", "display")) return r(); E(["./core/load-css"], function (d) { d(l, r, k) }) }
                                        }
                                }
                        })
                }, "jimu/dijit/ColorPicker": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorSelector jimu/utils".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                return E([q, A], {
                                        baseClass: "jimu-color-picker",
                                        declaredClass: "jimu.dijit.ColorPicker", templateString: '\x3cdiv role\x3d"button" tabindex\x3d"0"data-dojo-attach-event\x3d"onclick:_domNodeClick,onkeydown:_domNodeKeydown" aria-pressed\x3d"false"\x3e\x3c/div\x3e', _isTooltipDialogOpened: !1, color: null, showHex: !0, showHsv: !0, showRgb: !0, ensureMode: !1, showLabel: !1, postMixInProperties: function () { this.nls = window.jimuNls.common }, postCreate: function () {
                                                this.inherited(arguments); this.color ? this.color instanceof l || (this.color = new l(this.color)) : this.color = new l("#ccc");
                                                m.setStyle(this.domNode, "backgroundColor", this.color.toHex()); this.showLabel && this._changeLabel(this.color); this._createTooltipDialog(this.domNode); this._hideTooltipDialog()
                                        }, destroy: function () { n.close(this.tooltipDialog); this.picker.destroy(); this.tooltipDialog.destroy(); this.inherited(arguments) }, isPartOfPopup: function (g) { var b = this.tooltipDialog.domNode; return g === b || m.isDescendant(g, b) }, hideTooltipDialog: function () { this._hideTooltipDialog() }, _showTooltipDialog: function () {
                                                n.open({
                                                        parent: this.getParent(),
                                                        popup: this.tooltipDialog, around: this.domNode
                                                }); this._isTooltipDialogOpened = !0; this.picker.cursorNode.focus()
                                        }, _hideTooltipDialog: function () { this._isTooltipDialogOpened = !1; this.onClose(); n.close(this.tooltipDialog) }, _createTooltipDialog: function () {
                                                var g = m.create("div"); this.tooltipDialog = new k({ content: g }); m.addClass(this.tooltipDialog.domNode, "jimu-color-picker-dialog"); this.own(v(this.tooltipDialog.domNode, "keydown", w.hitch(this, function (a) {
                                                        a.keyCode === r.ESCAPE && (this._hideTooltipDialog(), this.domNode.focus(),
                                                                m.setAttr(this.domNode, "aria-pressed", "false"))
                                                }))); var b = new d({ showHex: this.showHex, showRgb: this.showRgb, showHsv: this.showHsv, value: this.color.toHex(), onChange: w.hitch(this, function (a) { this.ensureMode || (a = new l(a), this.setColor(a)) }) }); b.placeAt(g); b.startup(); if (this.ensureMode) {
                                                        var e = m.create("div", { "class": "jimu-btn jimu-btn-vacation jimu-float-trailing", title: this.nls.cancel, innerHTML: this.nls.cancel }, g); this.own(v(e, "click", w.hitch(this, function () { this._hideTooltipDialog() }))); "undefined" ===
                                                                typeof this.showOk && (e = m.create("div", { "class": "jimu-btn jimu-float-trailing ok", title: this.nls.ok, innerHTML: this.nls.ok }, g), this.own(v(e, "click", w.hitch(this, function () { var a = this.picker.get("value"); this.setColor(new l(a)); this._hideTooltipDialog() })))); g = m.create("div", { "class": "jimu-btn jimu-float-trailing", title: this.nls.apply, innerHTML: this.nls.apply }, g); this.own(v(g, "click", w.hitch(this, function () { var a = this.picker.get("value"); this.setColor(new l(a)) })))
                                                } this.own(v(document.body, "click", w.hitch(this,
                                                        function (a) { this.isPartOfPopup(a.target || a.srcElement) || this._hideTooltipDialog() }))); this.picker = b
                                        }, _domNodeClick: function (g) { g.stopPropagation(); g.preventDefault(); this._isTooltipDialogOpened ? (this._hideTooltipDialog(), m.setAttr(this.domNode, "aria-pressed", "false")) : (this._showTooltipDialog(), m.setAttr(this.domNode, "aria-pressed", "true")) }, _domNodeKeydown: function (g) { g.keyCode !== r.ENTER && g.keyCode !== r.SPACE || this._domNodeClick(g) }, setColor: function (g, b) {
                                                if (g instanceof l) {
                                                        var e = this.color, a = "";
                                                        e && (a = e.toHex()); e = g.toHex(); this.color = g; m.setStyle(this.domNode, "backgroundColor", e); if (a !== e && (this.picker.set("value", e), !1 !== b)) this.onChange(new l(e))
                                                }
                                        }, getColor: function () { return this.color }, _changeLabel: function (g) { m.empty(this.domNode); m.create("span", { innerHTML: g.toHex(), className: "color-label", style: { color: c.invertColor(g.toHex()) } }, this.domNode) }, onChange: function (g) { this.showLabel && this._changeLabel(g) }, onClose: function () { }, getPopup: function () { return this.tooltipDialog || null }, setLabel: function (g) {
                                                m.empty(this.domNode);
                                                m.create("span", { innerHTML: g || "", className: "text-label" }, this.domNode)
                                        }, isTooltipDialogOpened: function () { return this._isTooltipDialogOpened }
                                })
                        })
                }, "jimu/dijit/ColorSelector": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dojox/widget/ColorPicker dijit/_base/focus dojo/fx dojo/_base/lang dojo/_base/html dojo/sniff".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                return q([A, w, E], {
                                        baseClass: "jimu-color-selector", declaredClass: "jimu.dijit.ColorSelector", _setPoint: function (n) {
                                                n && m.focus(n.target);
                                                if (!this._CURSOR_WIDTH || !this._CURSOR_HEIGHT) { var d = l.getMarginBox(this.cursorNode); d.w && d.h && (this._CURSOR_WIDTH = d.w / 2, this._CURSOR_HEIGHT = d.h / 2) } this._BORDER_WIDTH && this._BORDER_HEIGHT || (d = l.getBorderExtents(n.target || n.srcElement), d.w && d.h && (this._BORDER_WIDTH = d.w, this._BORDER_HEIGHT = d.h)); var c = d = 0; k("ff") || k("ie") || k("MSIE") ? (d = n.offsetX, c = n.offsetY) : n.offsetX && n.offsetY && (d = n.offsetX + this._BORDER_WIDTH, c = n.offsetY + this._BORDER_HEIGHT); n = c - this._CURSOR_HEIGHT; d -= this._CURSOR_WIDTH; this.animatePoint ?
                                                        v.slideTo({ node: this.cursorNode, duration: this.slideDuration, top: n, left: d, onEnd: r.hitch(this, function () { this._updateColor(!0); m.focus(this.cursorNode) }) }).play() : (l.style(this.cursorNode, { left: d + "px", top: n + "px" }), this._updateColor(!0))
                                        }, _setHuePoint: function (n) {
                                                n = n.offsetY - this.PICKER_HUE_SELECTOR_H / 2; this.animatePoint ? v.slideTo({ node: this.hueCursorNode, duration: this.slideDuration, top: n, left: 0, onEnd: r.hitch(this, function () { this._updateColor(!0); m.focus(this.hueCursorNode) }) }).play() : (l.style(this.hueCursorNode,
                                                        "top", n + "px"), this._updateColor(!0))
                                        }
                                })
                        })
                }, "dojox/widget/ColorPicker": function () {
                        define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/connect dojo/_base/sniff dojo/_base/window dojo/_base/event dojo/dom dojo/dom-class dojo/keys dojo/fx dojo/dnd/move dijit/registry dijit/_base/focus dijit/form/_FormWidget dijit/typematic dojox/color dojo/i18n dojo/i18n!./nls/ColorPicker dojo/i18n!dojo/cldr/nls/number dojo/text!./ColorPicker/ColorPicker.html".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z) {
                                        E.experimental("dojox.widget.ColorPicker"); return q("dojox.widget.ColorPicker", f, {
                                                showRgb: !0, showHsv: !0, showHex: !0, webSafe: !0, animatePoint: !0, slideDuration: 250, liveUpdate: !1, PICKER_HUE_H: 150, PICKER_SAT_VAL_H: 150, PICKER_SAT_VAL_W: 150, PICKER_HUE_SELECTOR_H: 8, PICKER_SAT_SELECTOR_H: 10, PICKER_SAT_SELECTOR_W: 10, value: "#ffffff", _underlay: require.toUrl("dojox/widget/ColorPicker/images/underlay.png"), _hueUnderlay: require.toUrl("dojox/widget/ColorPicker/images/hue.png"),
                                                _pickerPointer: require.toUrl("dojox/widget/ColorPicker/images/pickerPointer.png"), _huePickerPointer: require.toUrl("dojox/widget/ColorPicker/images/hueHandle.png"), _huePickerPointerAlly: require.toUrl("dojox/widget/ColorPicker/images/hueHandleA11y.png"), templateString: z, postMixInProperties: function () {
                                                        d.contains(l.body(), "dijit_a11y") && (this._huePickerPointer = this._huePickerPointerAlly); this._uId = e.getUniqueId(this.id); A.mixin(this, B.getLocalization("dojox.widget", "ColorPicker")); A.mixin(this, B.getLocalization("dojo.cldr",
                                                                "number")); this.inherited(arguments)
                                                }, postCreate: function () {
                                                        this.inherited(arguments); 7 > r("ie") && (this.colorUnderlay.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d'" + this._underlay + "', sizingMethod\x3d'scale')", this.colorUnderlay.src = this._blankGif.toString()); this.showRgb || (this.rgbNode.style.visibility = "hidden"); this.showHsv || (this.hsvNode.style.visibility = "hidden"); this.showHex || (this.hexNode.style.visibility = "hidden"); this.webSafe || (this.safePreviewNode.style.visibility =
                                                                "hidden")
                                                }, startup: function () {
                                                        this._started || (this._started = !0, this.set("value", this.value), this._mover = new b.boxConstrainedMoveable(this.cursorNode, { box: { t: -(this.PICKER_SAT_SELECTOR_H / 2), l: -(this.PICKER_SAT_SELECTOR_W / 2), w: this.PICKER_SAT_VAL_W, h: this.PICKER_SAT_VAL_H } }), this._hueMover = new b.boxConstrainedMoveable(this.hueCursorNode, { box: { t: -(this.PICKER_HUE_SELECTOR_H / 2), l: 0, w: 0, h: this.PICKER_HUE_H } }), this._subs = [], this._subs.push(v.subscribe("/dnd/move/stop", A.hitch(this, "_clearTimer"))), this._subs.push(v.subscribe("/dnd/move/start",
                                                                A.hitch(this, "_setTimer"))), this._keyListeners = [], this._connects.push(h.addKeyListener(this.hueCursorNode, { charOrCode: c.UP_ARROW, shiftKey: !1, metaKey: !1, ctrlKey: !1, altKey: !1 }, this, A.hitch(this, this._updateHueCursorNode), 25, 25)), this._connects.push(h.addKeyListener(this.hueCursorNode, { charOrCode: c.DOWN_ARROW, shiftKey: !1, metaKey: !1, ctrlKey: !1, altKey: !1 }, this, A.hitch(this, this._updateHueCursorNode), 25, 25)), this._connects.push(h.addKeyListener(this.cursorNode, {
                                                                        charOrCode: c.UP_ARROW, shiftKey: !1, metaKey: !1,
                                                                        ctrlKey: !1, altKey: !1
                                                                }, this, A.hitch(this, this._updateCursorNode), 25, 25)), this._connects.push(h.addKeyListener(this.cursorNode, { charOrCode: c.DOWN_ARROW, shiftKey: !1, metaKey: !1, ctrlKey: !1, altKey: !1 }, this, A.hitch(this, this._updateCursorNode), 25, 25)), this._connects.push(h.addKeyListener(this.cursorNode, { charOrCode: c.LEFT_ARROW, shiftKey: !1, metaKey: !1, ctrlKey: !1, altKey: !1 }, this, A.hitch(this, this._updateCursorNode), 25, 25)), this._connects.push(h.addKeyListener(this.cursorNode, {
                                                                        charOrCode: c.RIGHT_ARROW, shiftKey: !1,
                                                                        metaKey: !1, ctrlKey: !1, altKey: !1
                                                                }, this, A.hitch(this, this._updateCursorNode), 25, 25)))
                                                }, _setValueAttr: function (x, y) { this._started && this.setColor(x, y) }, setColor: function (x, y) { x = p.fromString(x); this._updatePickerLocations(x); this._updateColorInputs(x); this._updateValue(x, y) }, _setTimer: function (x) { if (x.node == this.cursorNode || x.node == this.hueCursorNode) a.focus(x.node), n.setSelectable(this.domNode, !1), this._timer = setInterval(A.hitch(this, "_updateColor"), 45) }, _clearTimer: function (x) {
                                                        this._timer && (clearInterval(this._timer),
                                                                this._timer = null, this.onChange(this.value), n.setSelectable(this.domNode, !0))
                                                }, _setHue: function (x) { m.style(this.colorUnderlay, "backgroundColor", p.fromHsv(x, 100, 100).toHex()) }, _updateHueCursorNode: function (x, y, D) { if (-1 !== x) { x = m.style(this.hueCursorNode, "top"); y = this.PICKER_HUE_SELECTOR_H / 2; x += y; var H = !1; D.charOrCode == c.UP_ARROW ? 0 < x && (--x, H = !0) : D.charOrCode == c.DOWN_ARROW && x < this.PICKER_HUE_H && (x += 1, H = !0); H && m.style(this.hueCursorNode, "top", x - y + "px") } else this._updateColor(!0) }, _updateCursorNode: function (x,
                                                        y, D) { y = this.PICKER_SAT_SELECTOR_H / 2; var H = this.PICKER_SAT_SELECTOR_W / 2; if (-1 !== x) { x = m.style(this.cursorNode, "top"); var I = m.style(this.cursorNode, "left"); x += y; I += H; var N = !1; D.charOrCode == c.UP_ARROW ? 0 < x && (--x, N = !0) : D.charOrCode == c.DOWN_ARROW ? x < this.PICKER_SAT_VAL_H && (x += 1, N = !0) : D.charOrCode == c.LEFT_ARROW ? 0 < I && (--I, N = !0) : D.charOrCode == c.RIGHT_ARROW && I < this.PICKER_SAT_VAL_W && (I += 1, N = !0); N && (I -= H, m.style(this.cursorNode, "top", x - y + "px"), m.style(this.cursorNode, "left", I + "px")) } else this._updateColor(!0) },
                                                _updateColor: function (x) { var y = this.PICKER_HUE_SELECTOR_H / 2, D = this.PICKER_SAT_SELECTOR_H / 2, H = this.PICKER_SAT_SELECTOR_W / 2; y = m.style(this.hueCursorNode, "top") + y; D = m.style(this.cursorNode, "top") + D; H = m.style(this.cursorNode, "left") + H; y = Math.round(360 - y / this.PICKER_HUE_H * 360); H = p.fromHsv(y, H / this.PICKER_SAT_VAL_W * 100, 100 - D / this.PICKER_SAT_VAL_H * 100); this._updateColorInputs(H); this._updateValue(H, x); y != this._hue && this._setHue(y) }, _colorInputChange: function (x) {
                                                        var y = !1; switch (x.target) {
                                                                case this.hexCode: var D =
                                                                        p.fromString(x.target.value); y = !0; break; case this.Rval: case this.Gval: case this.Bval: D = p.fromArray([this.Rval.value, this.Gval.value, this.Bval.value]); y = !0; break; case this.Hval: case this.Sval: case this.Vval: D = p.fromHsv(this.Hval.value, this.Sval.value, this.Vval.value), y = !0
                                                        }y && (this._updatePickerLocations(D), this._updateColorInputs(D), this._updateValue(D, !0))
                                                }, _updateValue: function (x, y) { x = x.toHex(); this.value = this.valueNode.value = x; if (y && (!this._timer || this.liveUpdate)) this.onChange(x) }, _updatePickerLocations: function (x) {
                                                        var y =
                                                                this.PICKER_HUE_SELECTOR_H / 2, D = this.PICKER_SAT_SELECTOR_H / 2, H = this.PICKER_SAT_SELECTOR_W / 2; x = x.toHsv(); y = Math.round(this.PICKER_HUE_H - x.h / 360 * this.PICKER_HUE_H) - y; H = Math.round(x.s / 100 * this.PICKER_SAT_VAL_W) - H; D = Math.round(this.PICKER_SAT_VAL_H - x.v / 100 * this.PICKER_SAT_VAL_H) - D; this.animatePoint ? (g.slideTo({ node: this.hueCursorNode, duration: this.slideDuration, top: y, left: 0 }).play(), g.slideTo({ node: this.cursorNode, duration: this.slideDuration, top: D, left: H }).play()) : (m.style(this.hueCursorNode, "top", y + "px"),
                                                                        m.style(this.cursorNode, { left: H + "px", top: D + "px" })); x.h != this._hue && this._setHue(x.h)
                                                }, _updateColorInputs: function (x) { var y = x.toHex(); this.showRgb && (this.Rval.value = x.r, this.Gval.value = x.g, this.Bval.value = x.b); this.showHsv && (x = x.toHsv(), this.Hval.value = Math.round(x.h), this.Sval.value = Math.round(x.s), this.Vval.value = Math.round(x.v)); this.showHex && (this.hexCode.value = y); this.previewNode.style.backgroundColor = y; this.webSafe && (this.safePreviewNode.style.backgroundColor = y) }, _setHuePoint: function (x) {
                                                        var y =
                                                                this.PICKER_HUE_SELECTOR_H / 2; x = x.layerY || x.y - x.target.getBoundingClientRect().top; x -= y; this.animatePoint ? g.slideTo({ node: this.hueCursorNode, duration: this.slideDuration, top: x, left: 0, onEnd: A.hitch(this, function () { this._updateColor(!0); a.focus(this.hueCursorNode) }) }).play() : (m.style(this.hueCursorNode, "top", x + "px"), this._updateColor(!0))
                                                }, _setPoint: function (x) {
                                                        var y = this.PICKER_SAT_SELECTOR_H / 2, D = this.PICKER_SAT_SELECTOR_W / 2, H = x.layerY || x.y - x.target.getBoundingClientRect().top; H -= y; y = x.layerX || x.x - x.target.getBoundingClientRect().left;
                                                        y -= D; x && a.focus(x.target); this.animatePoint ? g.slideTo({ node: this.cursorNode, duration: this.slideDuration, top: H, left: y, onEnd: A.hitch(this, function () { this._updateColor(!0); a.focus(this.cursorNode) }) }).play() : (m.style(this.cursorNode, { left: y + "px", top: H + "px" }), this._updateColor(!0))
                                                }, _handleKey: function (x) { }, focus: function () { this.focused || a.focus(this.focusNode) }, _stopDrag: function (x) { k.stop(x) }, destroy: function () { this.inherited(arguments); w.forEach(this._subs, function (x) { v.unsubscribe(x) }); delete this._subs }
                                        })
                                })
                },
                "dojox/color": function () { define(["./color/_base"], function (E) { return E }) }, "dojox/color/_base": function () {
                        define(["../main", "dojo/_base/lang", "dojo/_base/Color", "dojo/colors"], function (E, q, A, w) {
                                E = q.getObject("color", !0, E); E.Color = A; E.blend = A.blendColors; E.fromRgb = A.fromRgb; E.fromHex = A.fromHex; E.fromArray = A.fromArray; E.fromString = A.fromString; E.greyscale = w.makeGrey; q.mixin(E, {
                                        fromCmy: function (m, v, r) {
                                                q.isArray(m) ? (v = m[1], r = m[2], m = m[0]) : q.isObject(m) && (v = m.m, r = m.y, m = m.c); return new A({
                                                        r: Math.round(255 *
                                                                (1 - m / 100)), g: Math.round(255 * (1 - v / 100)), b: Math.round(255 * (1 - r / 100))
                                                })
                                        }, fromCmyk: function (m, v, r, l) { q.isArray(m) ? (v = m[1], r = m[2], l = m[3], m = m[0]) : q.isObject(m) && (v = m.m, r = m.y, l = m.b, m = m.c); l /= 100; return new A({ r: Math.round(255 * (1 - Math.min(1, m / 100 * (1 - l) + l))), g: Math.round(255 * (1 - Math.min(1, v / 100 * (1 - l) + l))), b: Math.round(255 * (1 - Math.min(1, r / 100 * (1 - l) + l))) }) }, fromHsl: function (m, v, r) {
                                                q.isArray(m) ? (v = m[1], r = m[2], m = m[0]) : q.isObject(m) && (v = m.s, r = m.l, m = m.h); v /= 100; for (r /= 100; 0 > m;)m += 360; for (; 360 <= m;)m -= 360; if (120 >
                                                        m) { var l = (120 - m) / 60; var k = m / 60; m = 0 } else 240 > m ? (l = 0, k = (240 - m) / 60, m = (m - 120) / 60) : (l = (m - 240) / 60, k = 0, m = (360 - m) / 60); l = 2 * v * Math.min(l, 1) + (1 - v); k = 2 * v * Math.min(k, 1) + (1 - v); m = 2 * v * Math.min(m, 1) + (1 - v); .5 > r ? (l *= r, k *= r, m *= r) : (l = (1 - r) * l + 2 * r - 1, k = (1 - r) * k + 2 * r - 1, m = (1 - r) * m + 2 * r - 1); return new A({ r: Math.round(255 * l), g: Math.round(255 * k), b: Math.round(255 * m) })
                                        }
                                }); E.fromHsv = function (m, v, r) {
                                        q.isArray(m) ? (v = m[1], r = m[2], m = m[0]) : q.isObject(m) && (v = m.s, r = m.v, m = m.h); 360 == m && (m = 0); v /= 100; r /= 100; var l, k; if (0 == v) var n = k = l = r; else {
                                                var d =
                                                        m / 60; m = Math.floor(d); var c = d - m; d = r * (1 - v); var g = r * (1 - v * c); v = r * (1 - v * (1 - c)); switch (m) { case 0: l = r; n = v; k = d; break; case 1: l = g; n = r; k = d; break; case 2: l = d; n = r; k = v; break; case 3: l = d; n = g; k = r; break; case 4: l = v; n = d; k = r; break; case 5: l = r, n = d, k = g }
                                        } return new A({ r: Math.round(255 * l), g: Math.round(255 * n), b: Math.round(255 * k) })
                                }; q.extend(A, {
                                        toCmy: function () { return { c: Math.round(100 * (1 - this.r / 255)), m: Math.round(100 * (1 - this.g / 255)), y: Math.round(100 * (1 - this.b / 255)) } }, toCmyk: function () {
                                                var m = this.r / 255, v = this.g / 255, r = this.b / 255;
                                                var l = Math.min(1 - m, 1 - v, 1 - r); return { c: Math.round((1 - m - l) / (1 - l) * 100), m: Math.round((1 - v - l) / (1 - l) * 100), y: Math.round((1 - r - l) / (1 - l) * 100), b: Math.round(100 * l) }
                                        }, toHsl: function () { var m = this.r / 255, v = this.g / 255, r = this.b / 255, l = Math.min(m, r, v), k = Math.max(m, v, r), n = k - l, d = 0, c = 0; l = (l + k) / 2; 0 < l && 1 > l && (c = n / (.5 > l ? 2 * l : 2 - 2 * l)); 0 < n && (k == m && k != v && (d += (v - r) / n), k == v && k != r && (d += 2 + (r - m) / n), k == r && k != m && (d += 4 + (m - v) / n), d *= 60); return { h: d, s: Math.round(100 * c), l: Math.round(100 * l) } }, toHsv: function () {
                                                var m = this.r / 255, v = this.g / 255, r = this.b /
                                                        255, l = Math.max(m, v, r), k = l - Math.min(m, r, v), n = null, d = 0 == l ? 0 : k / l; 0 == d ? n = 0 : (n = m == l ? 60 * (v - r) / k : v == l ? 120 + 60 * (r - m) / k : 240 + 60 * (m - v) / k, 0 > n && (n += 360)); return { h: n, s: Math.round(100 * d), v: Math.round(100 * l) }
                                        }
                                }); return E
                        })
                }, "dojo/colors": function () {
                        define(["./_base/kernel", "./_base/lang", "./_base/Color", "./_base/array"], function (E, q, A, w) {
                                var m = {}; q.setObject("dojo.colors", m); var v = function (l, k, n) { 0 > n && ++n; 1 < n && --n; var d = 6 * n; return 1 > d ? l + (k - l) * d : 1 > 2 * n ? k : 2 > 3 * n ? l + (k - l) * (2 / 3 - n) * 6 : l }; E.colorFromRgb = A.fromRgb = function (l,
                                        k) {
                                                var n = l.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/); if (n) {
                                                        l = n[2].split(/\s*,\s*/); var d = l.length; n = n[1]; if ("rgb" == n && 3 == d || "rgba" == n && 4 == d) return n = l[0], "%" == n.charAt(n.length - 1) ? (n = w.map(l, function (b) { return 2.56 * parseFloat(b) }), 4 == d && (n[3] = l[3]), A.fromArray(n, k)) : A.fromArray(l, k); if ("hsl" == n && 3 == d || "hsla" == n && 4 == d) {
                                                                n = (parseFloat(l[0]) % 360 + 360) % 360 / 360; var c = parseFloat(l[1]) / 100, g = parseFloat(l[2]) / 100; c = .5 >= g ? g * (c + 1) : g + c - g * c; g = 2 * g - c; n = [256 * v(g, c, n + 1 / 3), 256 * v(g, c, n), 256 * v(g, c, n - 1 /
                                                                        3), 1]; 4 == d && (n[3] = l[3]); return A.fromArray(n, k)
                                                        }
                                                } return null
                                }; var r = function (l, k, n) { l = Number(l); return isNaN(l) ? n : l < k ? k : l > n ? n : l }; A.prototype.sanitize = function () { this.r = Math.round(r(this.r, 0, 255)); this.g = Math.round(r(this.g, 0, 255)); this.b = Math.round(r(this.b, 0, 255)); this.a = r(this.a, 0, 1); return this }; m.makeGrey = A.makeGrey = function (l, k) { return A.fromArray([l, l, l, k]) }; q.mixin(A.named, {
                                        aliceblue: [240, 248, 255], antiquewhite: [250, 235, 215], aquamarine: [127, 255, 212], azure: [240, 255, 255], beige: [245, 245, 220], bisque: [255,
                                                228, 196], blanchedalmond: [255, 235, 205], blueviolet: [138, 43, 226], brown: [165, 42, 42], burlywood: [222, 184, 135], cadetblue: [95, 158, 160], chartreuse: [127, 255, 0], chocolate: [210, 105, 30], coral: [255, 127, 80], cornflowerblue: [100, 149, 237], cornsilk: [255, 248, 220], crimson: [220, 20, 60], cyan: [0, 255, 255], darkblue: [0, 0, 139], darkcyan: [0, 139, 139], darkgoldenrod: [184, 134, 11], darkgray: [169, 169, 169], darkgreen: [0, 100, 0], darkgrey: [169, 169, 169], darkkhaki: [189, 183, 107], darkmagenta: [139, 0, 139], darkolivegreen: [85, 107, 47], darkorange: [255,
                                                        140, 0], darkorchid: [153, 50, 204], darkred: [139, 0, 0], darksalmon: [233, 150, 122], darkseagreen: [143, 188, 143], darkslateblue: [72, 61, 139], darkslategray: [47, 79, 79], darkslategrey: [47, 79, 79], darkturquoise: [0, 206, 209], darkviolet: [148, 0, 211], deeppink: [255, 20, 147], deepskyblue: [0, 191, 255], dimgray: [105, 105, 105], dimgrey: [105, 105, 105], dodgerblue: [30, 144, 255], firebrick: [178, 34, 34], floralwhite: [255, 250, 240], forestgreen: [34, 139, 34], gainsboro: [220, 220, 220], ghostwhite: [248, 248, 255], gold: [255, 215, 0], goldenrod: [218, 165, 32],
                                        greenyellow: [173, 255, 47], grey: [128, 128, 128], honeydew: [240, 255, 240], hotpink: [255, 105, 180], indianred: [205, 92, 92], indigo: [75, 0, 130], ivory: [255, 255, 240], khaki: [240, 230, 140], lavender: [230, 230, 250], lavenderblush: [255, 240, 245], lawngreen: [124, 252, 0], lemonchiffon: [255, 250, 205], lightblue: [173, 216, 230], lightcoral: [240, 128, 128], lightcyan: [224, 255, 255], lightgoldenrodyellow: [250, 250, 210], lightgray: [211, 211, 211], lightgreen: [144, 238, 144], lightgrey: [211, 211, 211], lightpink: [255, 182, 193], lightsalmon: [255, 160, 122], lightseagreen: [32,
                                                178, 170], lightskyblue: [135, 206, 250], lightslategray: [119, 136, 153], lightslategrey: [119, 136, 153], lightsteelblue: [176, 196, 222], lightyellow: [255, 255, 224], limegreen: [50, 205, 50], linen: [250, 240, 230], magenta: [255, 0, 255], mediumaquamarine: [102, 205, 170], mediumblue: [0, 0, 205], mediumorchid: [186, 85, 211], mediumpurple: [147, 112, 219], mediumseagreen: [60, 179, 113], mediumslateblue: [123, 104, 238], mediumspringgreen: [0, 250, 154], mediumturquoise: [72, 209, 204], mediumvioletred: [199, 21, 133], midnightblue: [25, 25, 112], mintcream: [245,
                                                        255, 250], mistyrose: [255, 228, 225], moccasin: [255, 228, 181], navajowhite: [255, 222, 173], oldlace: [253, 245, 230], olivedrab: [107, 142, 35], orange: [255, 165, 0], orangered: [255, 69, 0], orchid: [218, 112, 214], palegoldenrod: [238, 232, 170], palegreen: [152, 251, 152], paleturquoise: [175, 238, 238], palevioletred: [219, 112, 147], papayawhip: [255, 239, 213], peachpuff: [255, 218, 185], peru: [205, 133, 63], pink: [255, 192, 203], plum: [221, 160, 221], powderblue: [176, 224, 230], rosybrown: [188, 143, 143], royalblue: [65, 105, 225], saddlebrown: [139, 69, 19], salmon: [250,
                                                                128, 114], sandybrown: [244, 164, 96], seagreen: [46, 139, 87], seashell: [255, 245, 238], sienna: [160, 82, 45], skyblue: [135, 206, 235], slateblue: [106, 90, 205], slategray: [112, 128, 144], slategrey: [112, 128, 144], snow: [255, 250, 250], springgreen: [0, 255, 127], steelblue: [70, 130, 180], tan: [210, 180, 140], thistle: [216, 191, 216], tomato: [255, 99, 71], turquoise: [64, 224, 208], violet: [238, 130, 238], wheat: [245, 222, 179], whitesmoke: [245, 245, 245], yellowgreen: [154, 205, 50]
                                }); return A
                        })
                }, "jimu/dijit/_Transparency": function () {
                        define("dojo/_base/declare dojo/_base/config dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/_Transparency.html dojo/_base/lang dojo/_base/html dojo/on dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dijit/form/HorizontalRule ./a11y/_Transparency".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                        E = E([A, w, m, v], {
                                                baseClass: "jimu-transparency", declaredClass: "jimu.dijit.Transparency", templateString: r, nls: null, _nls0: "0%", _nls50: "50%", _nls100: "100%", alpha: 1, postMixInProperties: function () { this.nls = window.jimuNls.transparency; var e = q.locale || ""; e = e.toLowerCase(); "ar" === e ? (this._nls0 = "\u066a0", this._nls50 = "\u066a50", this._nls100 = "\u066a100") : "tr" === e && (this._nls0 = "%0", this._nls50 = "%50", this._nls100 = "%100") }, postCreate: function () {
                                                        this.inherited(arguments); "number" ===
                                                                typeof this.alpha && this.setAlpha(this.alpha); this.a11y_initAriaAttrs()
                                                }, setAlpha: function (e) { this.opacitySlider.set("value", Math.round(100 - 100 * e)) }, getAlpha: function () { return Math.round(100 - this.opacitySlider.get("value")) / 100 }, _onAlphaChanged: function () { var e = this.getAlpha(); this.emit("change", e) }
                                        }); E.extend(b); return E
                                })
                }, "dijit/form/HorizontalSlider": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t) {
                                        var u = q("dijit.form._SliderMover", d, {
                                                onMouseMove: function (z) { var x = this.widget, y = x._abspos; y || (y = x._abspos = m.position(x.sliderBarContainer, !0), x._setPixelValue_ = l.hitch(x, "_setPixelValue"), x._isReversed_ = x._isReversed()); z = z[x._mousePixelCoord] - y[x._startingPixelCoord]; x._setPixelValue_(x._isReversed_ ? y[x._pixelCount] - z : z, y[x._pixelCount], !1) }, destroy: function (z) {
                                                        d.prototype.destroy.apply(this, arguments); var x = this.widget; x._abspos = null; x._setValueAttr(x.value,
                                                                !0)
                                                }
                                        }); A = q("dijit.form.HorizontalSlider", [p, B], {
                                                templateString: t, value: 0, showButtons: !0, minimum: 0, maximum: 100, discreteValues: Infinity, pageIncrement: 2, clickSelect: !0, slideDuration: e.defaultDuration, _setIdAttr: "", _setNameAttr: "valueNode", baseClass: "dijitSlider", cssStateNodes: { incrementButton: "dijitSliderIncrementButton", decrementButton: "dijitSliderDecrementButton", focusNode: "dijitSliderThumb" }, _mousePixelCoord: "pageX", _pixelCount: "w", _startingPixelCoord: "x", _handleOffsetCoord: "left", _progressPixelSize: "width",
                                                _onKeyUp: function (z) { this.disabled || this.readOnly || z.altKey || z.ctrlKey || z.metaKey || this._setValueAttr(this.value, !0) }, _onKeyDown: function (z) {
                                                        if (!(this.disabled || this.readOnly || z.altKey || z.ctrlKey || z.metaKey)) {
                                                                switch (z.keyCode) {
                                                                        case r.HOME: this._setValueAttr(this.minimum, !1); break; case r.END: this._setValueAttr(this.maximum, !1); break; case this._descending || this.isLeftToRight() ? r.RIGHT_ARROW : r.LEFT_ARROW: case !1 === this._descending ? r.DOWN_ARROW : r.UP_ARROW: case !1 === this._descending ? r.PAGE_DOWN : r.PAGE_UP: this.increment(z);
                                                                                break; case this._descending || this.isLeftToRight() ? r.LEFT_ARROW : r.RIGHT_ARROW: case !1 === this._descending ? r.UP_ARROW : r.DOWN_ARROW: case !1 === this._descending ? r.PAGE_UP : r.PAGE_DOWN: this.decrement(z); break; default: return
                                                                }z.stopPropagation(); z.preventDefault()
                                                        }
                                                }, _onHandleClick: function (z) { this.disabled || this.readOnly || (k("ie") || a.focus(this.sliderHandle), z.stopPropagation(), z.preventDefault()) }, _isReversed: function () { return !this.isLeftToRight() }, _onBarClick: function (z) {
                                                        if (!this.disabled && !this.readOnly &&
                                                                this.clickSelect) { a.focus(this.sliderHandle); z.stopPropagation(); z.preventDefault(); var x = m.position(this.sliderBarContainer, !0), y = z[this._mousePixelCoord] - x[this._startingPixelCoord]; this._setPixelValue(this._isReversed() ? x[this._pixelCount] - y : y, x[this._pixelCount], !0); this._movable.onMouseDown(z) }
                                                }, _setPixelValue: function (z, x, y) {
                                                        if (!this.disabled && !this.readOnly) {
                                                                var D = this.discreteValues; if (1 >= D || Infinity == D) D = x; D--; this._setValueAttr(Math.max(Math.min((this.maximum - this.minimum) * Math.round(z /
                                                                        (x / D)) / D + this.minimum, this.maximum), this.minimum), y)
                                                        }
                                                }, _setValueAttr: function (z, x) {
                                                        this._set("value", z); this.valueNode.value = z; this.focusNode.setAttribute("aria-valuenow", z); this.inherited(arguments); var y = this.maximum > this.minimum ? (z - this.minimum) / (this.maximum - this.minimum) : 0, D = !1 === this._descending ? this.remainingBar : this.progressBar, H = !1 === this._descending ? this.progressBar : this.remainingBar; this._inProgressAnim && "stopped" != this._inProgressAnim.status && this._inProgressAnim.stop(!0); if (x && 0 < this.slideDuration &&
                                                                D.style[this._progressPixelSize]) { var I = this, N = {}, T = parseFloat(D.style[this._progressPixelSize]), M = this.slideDuration * (y - T / 100); 0 != M && (0 > M && (M = 0 - M), N[this._progressPixelSize] = { start: T, end: 100 * y, units: "%" }, this._inProgressAnim = w.animateProperty({ node: D, duration: M, onAnimate: function (R) { H.style[I._progressPixelSize] = 100 - parseFloat(R[I._progressPixelSize]) + "%" }, onEnd: function () { delete I._inProgressAnim }, properties: N }), this._inProgressAnim.play()) } else D.style[this._progressPixelSize] = 100 * y + "%", H.style[this._progressPixelSize] =
                                                                        100 * (1 - y) + "%"
                                                }, _bumpValue: function (z, x) { if (!(this.disabled || this.readOnly || this.maximum <= this.minimum)) { var y = v.getComputedStyle(this.sliderBarContainer), D = m.getContentBox(this.sliderBarContainer, y); y = this.discreteValues; if (1 >= y || Infinity == y) y = D[this._pixelCount]; y--; z = Math.round((this.value - this.minimum) * y / (this.maximum - this.minimum)) + z; 0 > z && (z = 0); z > y && (z = y); z = z * (this.maximum - this.minimum) / y + this.minimum; this._setValueAttr(z, x) } }, _onClkBumper: function (z) {
                                                        this.disabled || this.readOnly || !this.clickSelect ||
                                                        this._setValueAttr(z, !0)
                                                }, _onClkIncBumper: function () { this._onClkBumper(!1 === this._descending ? this.minimum : this.maximum) }, _onClkDecBumper: function () { this._onClkBumper(!1 === this._descending ? this.maximum : this.minimum) }, decrement: function (z) { this._bumpValue(z.keyCode == r.PAGE_DOWN ? -this.pageIncrement : -1) }, increment: function (z) { this._bumpValue(z.keyCode == r.PAGE_UP ? this.pageIncrement : 1) }, _mouseWheeled: function (z) { this.focused && (z.stopPropagation(), z.preventDefault(), this._bumpValue(0 > z.wheelDelta ? -1 : 1, !0)) },
                                                startup: function () { this._started || (E.forEach(this.getChildren(), function (z) { this[z.container] != this.containerNode && this[z.container].appendChild(z.domNode) }, this), this.inherited(arguments)) }, _typematicCallback: function (z, x, y) { if (-1 == z) this._setValueAttr(this.value, !0); else this[x == (this._descending ? this.incrementButton : this.decrementButton) ? "decrement" : "increment"](y) }, buildRendering: function () {
                                                        this.inherited(arguments); this.showButtons && (this.incrementButton.style.display = "", this.decrementButton.style.display =
                                                                ""); var z = c('label[for\x3d"' + this.id + '"]'); z.length && (z[0].id || (z[0].id = this.id + "_label"), this.focusNode.setAttribute("aria-labelledby", z[0].id)); this.focusNode.setAttribute("aria-valuemin", this.minimum); this.focusNode.setAttribute("aria-valuemax", this.maximum)
                                                }, postCreate: function () {
                                                        this.inherited(arguments); this.showButtons && this.own(f.addMouseListener(this.decrementButton, this, "_typematicCallback", 25, 500), f.addMouseListener(this.incrementButton, this, "_typematicCallback", 25, 500)); this.own(b(this.domNode,
                                                                g.wheel, l.hitch(this, "_mouseWheeled"))); var z = q(u, { widget: this }); this._movable = new n(this.sliderHandle, { mover: z }); this._layoutHackIE7()
                                                }, destroy: function () { this._movable.destroy(); this._inProgressAnim && "stopped" != this._inProgressAnim.status && this._inProgressAnim.stop(!0); this.inherited(arguments) }
                                        }); A._Mover = u; return A
                                })
                }, "dijit/form/HorizontalRuleLabels": function () {
                        define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "), function (E, q, A, w, m, v) {
                                E = E("dijit.form.HorizontalRuleLabels",
                                        v, {
                                                templateString: '\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e', labelStyle: "", labels: [], numericMargin: 0, minimum: 0, maximum: 1, constraints: { pattern: "#%" }, _positionPrefix: '\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:', _labelPrefix: '"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e', _suffix: "\x3c/div\x3e\x3c/div\x3e", _calcPosition: function (r) { return r }, _genHTML: function (r, l) {
                                                        l =
                                                        this.labels[l]; return this._positionPrefix + this._calcPosition(r) + this._positionSuffix + this.labelStyle + this._genDirectionHTML(l) + this._labelPrefix + l + this._suffix
                                                }, _genDirectionHTML: function (r) { return "" }, getLabels: function () {
                                                        var r = this.labels; !r.length && this.srcNodeRef && (r = w("\x3e li", this.srcNodeRef).map(function (d) { return String(d.innerHTML) })); if (!r.length && 1 < this.count) {
                                                                r = []; for (var l = this.minimum, k = (this.maximum - l) / (this.count - 1), n = 0; n < this.count; n++)r.push(n < this.numericMargin || n >= this.count -
                                                                        this.numericMargin ? "" : A.format(l, this.constraints)), l += k
                                                        } return r
                                                }, postMixInProperties: function () { this.inherited(arguments); this.labels = this.getLabels(); this.count = this.labels.length }
                                }); q("dojo-bidi") && E.extend({
                                        _setTextDirAttr: function (r) { this.textDir != r && (this._set("textDir", r), w(".dijitRuleLabelContainer", this.domNode).forEach(m.hitch(this, function (l) { l.style.direction = this.getTextDir(l.innerText || l.textContent || "") }))) }, _genDirectionHTML: function (r) {
                                                return this.textDir ? "direction:" + this.getTextDir(r) +
                                                        ";" : ""
                                        }
                                }); return E
                        })
                }, "dijit/form/HorizontalRule": function () {
                        define(["dojo/_base/declare", "../_Widget", "../_TemplatedMixin"], function (E, q, A) {
                                return E("dijit.form.HorizontalRule", [q, A], {
                                        templateString: '\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e', count: 3, container: "containerNode", ruleStyle: "", _positionPrefix: '\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:', _positionSuffix: "%;", _suffix: '"\x3e\x3c/div\x3e', _genHTML: function (w) {
                                                return this._positionPrefix +
                                                        w + this._positionSuffix + this.ruleStyle + this._suffix
                                        }, _isHorizontal: !0, buildRendering: function () { this.inherited(arguments); if (1 == this.count) var w = this._genHTML(50, 0); else { var m, v = 100 / (this.count - 1); if (!this._isHorizontal || this.isLeftToRight()) { w = this._genHTML(0, 0); for (m = 1; m < this.count - 1; m++)w += this._genHTML(v * m, m); w += this._genHTML(100, this.count - 1) } else { w = this._genHTML(100, 0); for (m = 1; m < this.count - 1; m++)w += this._genHTML(100 - v * m, m); w += this._genHTML(0, this.count - 1) } } this.domNode.innerHTML = w }
                                })
                        })
                }, "jimu/dijit/a11y/_Transparency": function () {
                        define(["dojo/_base/html"],
                                function (E) { return { a11y_initAriaAttrs: function () { var q = this["aria-labelledby"]; q && (E.removeAttr(this.domNode, "aria-labelledby"), E.setAttr(this.opacitySlider.focusNode, "aria-labelledby", q)) } } })
                }, "dijit/form/NumberSpinner": function () {
                        define(["dojo/_base/declare", "dojo/keys", "./_Spinner", "./NumberTextBox"], function (E, q, A, w) {
                                return E("dijit.form.NumberSpinner", [A, w.Mixin], {
                                        baseClass: "dijitTextBox dijitSpinner dijitNumberTextBox", adjust: function (m, v) {
                                                var r = this.constraints, l = isNaN(m), k = !isNaN(r.max), n =
                                                        !isNaN(r.min); l && 0 != v && (m = 0 < v ? n ? r.min : k ? r.max : 0 : k ? this.constraints.max : n ? r.min : 0); v = m + v; if (l || isNaN(v)) return m; k && v > r.max && (v = r.max); n && v < r.min && (v = r.min); return v
                                        }, _onKeyDown: function (m) { if (!(this.disabled || this.readOnly || m.keyCode != q.HOME && m.keyCode != q.END || m.ctrlKey || m.altKey || m.metaKey || "undefined" == typeof this.get("value"))) { var v = this.constraints[m.keyCode == q.HOME ? "min" : "max"]; "number" == typeof v && this._setValueAttr(v, !1); m.stopPropagation(); m.preventDefault() } }
                                })
                        })
                }, "dijit/form/_Spinner": function () {
                        define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        return E("dijit.form._Spinner", l, {
                                                defaultTimeout: 500, minimumTimeout: 10, timeoutChangeRate: .9, smallDelta: 1, largeDelta: 10, templateString: k, baseClass: "dijitTextBox dijitSpinner", cssStateNodes: { upArrowNode: "dijitUpArrowButton", downArrowNode: "dijitDownArrowButton" }, adjust: function (d) { return d }, _arrowPressed: function (d, c, g) { this.disabled || this.readOnly || (this._setValueAttr(this.adjust(this.get("value"), c * g), !1), n.selectInputText(this.textbox, this.textbox.value.length)) }, _arrowReleased: function () {
                                                        this._wheelTimer =
                                                        null
                                                }, _typematicCallback: function (d, c, g) { var b = this.smallDelta; c == this.textbox && (c = g.keyCode, b = c == q.PAGE_UP || c == q.PAGE_DOWN ? this.largeDelta : this.smallDelta, c = c == q.UP_ARROW || c == q.PAGE_UP ? this.upArrowNode : this.downArrowNode); -1 == d ? this._arrowReleased(c) : this._arrowPressed(c, c == this.upArrowNode ? 1 : -1, b) }, _wheelTimer: null, _mouseWheeled: function (d) {
                                                        if (this.focused) {
                                                                d.stopPropagation(); d.preventDefault(); var c = d.wheelDelta / 120; Math.floor(c) != c && (c = 0 < d.wheelDelta ? 1 : -1); d = d.detail ? -1 * d.detail : c; if (0 !== d) {
                                                                        var g =
                                                                                this[0 < d ? "upArrowNode" : "downArrowNode"]; this._arrowPressed(g, d, this.smallDelta); this._wheelTimer && this._wheelTimer.remove(); this._wheelTimer = this.defer(function () { this._arrowReleased(g) }, 50)
                                                                }
                                                        }
                                                }, _setConstraintsAttr: function (d) {
                                                        this.inherited(arguments); this.focusNode && (void 0 !== this.constraints.min ? this.focusNode.setAttribute("aria-valuemin", this.constraints.min) : this.focusNode.removeAttribute("aria-valuemin"), void 0 !== this.constraints.max ? this.focusNode.setAttribute("aria-valuemax", this.constraints.max) :
                                                                this.focusNode.removeAttribute("aria-valuemax"))
                                                }, _setValueAttr: function (d, c) { this.focusNode.setAttribute("aria-valuenow", d); this.inherited(arguments) }, postCreate: function () {
                                                        this.inherited(arguments); this.own(v(this.domNode, m.wheel, A.hitch(this, "_mouseWheeled")), r.addListener(this.upArrowNode, this.textbox, { keyCode: q.UP_ARROW, ctrlKey: !1, altKey: !1, shiftKey: !1, metaKey: !1 }, this, "_typematicCallback", this.timeoutChangeRate, this.defaultTimeout, this.minimumTimeout), r.addListener(this.downArrowNode, this.textbox,
                                                                { keyCode: q.DOWN_ARROW, ctrlKey: !1, altKey: !1, shiftKey: !1, metaKey: !1 }, this, "_typematicCallback", this.timeoutChangeRate, this.defaultTimeout, this.minimumTimeout), r.addListener(this.upArrowNode, this.textbox, { keyCode: q.PAGE_UP, ctrlKey: !1, altKey: !1, shiftKey: !1, metaKey: !1 }, this, "_typematicCallback", this.timeoutChangeRate, this.defaultTimeout, this.minimumTimeout), r.addListener(this.downArrowNode, this.textbox, { keyCode: q.PAGE_DOWN, ctrlKey: !1, altKey: !1, shiftKey: !1, metaKey: !1 }, this, "_typematicCallback", this.timeoutChangeRate,
                                                                        this.defaultTimeout, this.minimumTimeout))
                                                }
                                        })
                                })
                }, "dijit/form/RangeBoundTextBox": function () {
                        define(["dojo/_base/declare", "dojo/i18n", "./MappedTextBox", "dojo/i18n!./nls/validate"], function (E, q, A) {
                                return E("dijit.form.RangeBoundTextBox", A, {
                                        rangeMessage: "", rangeCheck: function (w, m) { return ("min" in m ? 0 <= this.compare(w, m.min) : !0) && ("max" in m ? 0 >= this.compare(w, m.max) : !0) }, isInRange: function () { return this.rangeCheck(this.get("value"), this.constraints) }, _isDefinitelyOutOfRange: function () {
                                                var w = this.get("value");
                                                if (null == w) return !1; var m = !1; "min" in this.constraints && (m = this.constraints.min, m = 0 > this.compare(w, "number" == typeof m && 0 <= m && 0 != w ? 0 : m)); !m && "max" in this.constraints && (m = this.constraints.max, m = 0 < this.compare(w, "number" != typeof m || 0 < m ? m : 0)); return m
                                        }, _isValidSubset: function () { return this.inherited(arguments) && !this._isDefinitelyOutOfRange() }, isValid: function (w) { return this.inherited(arguments) && (this._isEmpty(this.textbox.value) && !this.required || this.isInRange(w)) }, getErrorMessage: function (w) {
                                                var m =
                                                        this.get("value"); return null == m || "" === m || "number" == typeof m && isNaN(m) || this.isInRange(w) ? this.inherited(arguments) : this.rangeMessage
                                        }, postMixInProperties: function () { this.inherited(arguments); this.rangeMessage || (this.messages = q.getLocalization("dijit.form", "validate", this.lang), this.rangeMessage = this.messages.rangeMessage) }
                                })
                        })
                }, "dijit/form/NumberTextBox": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "), function (E, q, A, w, m, v) {
                                var r =
                                        function (k) { k = k || {}; var n = A.getLocalization("dojo.cldr", "number", A.normalizeLocale(k.locale)), d = k.pattern ? k.pattern : n[(k.type || "decimal") + "Format"]; k = "number" == typeof k.places ? k.places : "string" === typeof k.places && 0 < k.places.length ? k.places.replace(/.*,/, "") : -1 != d.indexOf(".") ? d.split(".")[1].replace(/[^#0]/g, "").length : 0; return { sep: n.decimal, places: k } }, l = E("dijit.form.NumberTextBoxMixin", null, {
                                                pattern: function (k) {
                                                        return "(" + (this.focused && this.editOptions ? this._regExpGenerator(q.delegate(k, this.editOptions)) +
                                                                "|" : "") + this._regExpGenerator(k) + ")"
                                                }, value: NaN, editOptions: { pattern: "#.######" }, _formatter: m.format, _regExpGenerator: m.regexp, _decimalInfo: r(), postMixInProperties: function () { this.inherited(arguments); this._set("type", "text") }, _setConstraintsAttr: function (k) {
                                                        var n = "number" == typeof k.places ? k.places : 0; n && n++; "number" != typeof k.max && (k.max = 9 * Math.pow(10, 15 - n)); "number" != typeof k.min && (k.min = -9 * Math.pow(10, 15 - n)); this.inherited(arguments, [k]); this.focusNode && this.focusNode.value && !isNaN(this.value) &&
                                                                this.set("value", this.value); this._decimalInfo = r(k)
                                                }, _onFocus: function (k) { if (!this.disabled && !this.readOnly) { var n = this.get("value"); "number" != typeof n || isNaN(n) || (n = this.format(n, this.constraints), void 0 !== n && (this.textbox.value = n, "mouse" !== k && this.textbox.select())); this.inherited(arguments) } }, format: function (k, n) {
                                                        var d = String(k); if ("number" != typeof k) return d; if (isNaN(k)) return ""; if (!("rangeCheck" in this && this.rangeCheck(k, n)) && !1 !== n.exponent && /\de[-+]?\d/i.test(d)) return d; this.editOptions &&
                                                                this.focused && (n = q.mixin({}, n, this.editOptions)); return this._formatter(k, n)
                                                }, _parser: m.parse, parse: function (k, n) { var d = q.mixin({}, n, this.editOptions && this.focused ? this.editOptions : {}); if (this.focused && null != d.places) { var c = d.places; c = "number" === typeof c ? c : Number(c.split(",").pop()); d.places = "0," + c } d = this._parser(k, d); this.editOptions && this.focused && isNaN(d) && (d = this._parser(k, n)); return d }, _getDisplayedValueAttr: function () { var k = this.inherited(arguments); return isNaN(k) ? this.textbox.value : k }, filter: function (k) {
                                                        if (null ==
                                                                k || "string" == typeof k && "" == k) return NaN; "number" != typeof k || isNaN(k) || 0 == k || (k = m.round(k, this._decimalInfo.places)); return this.inherited(arguments, [k])
                                                }, serialize: function (k, n) { return "number" != typeof k || isNaN(k) ? "" : this.inherited(arguments) }, _setBlurValue: function () { var k = q.hitch(q.delegate(this, { focused: !0 }), "get")("value"); this._setValueAttr(k, !0) }, _setValueAttr: function (k, n, d) {
                                                        if (void 0 !== k && void 0 === d) if (d = String(k), "number" == typeof k) if (isNaN(k)) d = ""; else {
                                                                if ("rangeCheck" in this && this.rangeCheck(k,
                                                                        this.constraints) || !1 === this.constraints.exponent || !/\de[-+]?\d/i.test(d)) d = void 0
                                                        } else k ? k = void 0 : (d = "", k = NaN); this.inherited(arguments, [k, n, d])
                                                }, _getValueAttr: function () { var k = this.inherited(arguments); if (isNaN(k) && "" !== this.textbox.value) { if (!1 !== this.constraints.exponent && /\de[-+]?\d/i.test(this.textbox.value) && (new RegExp("^" + m._realNumberRegexp(q.delegate(this.constraints)) + "$")).test(this.textbox.value)) return k = Number(this.textbox.value), isNaN(k) ? void 0 : k } else return k }, isValid: function (k) {
                                                        if (!this.focused ||
                                                                this._isEmpty(this.textbox.value)) return this.inherited(arguments); var n = this.get("value"); return !isNaN(n) && this.rangeCheck(n, this.constraints) ? !1 !== this.constraints.exponent && /\de[-+]?\d/i.test(this.textbox.value) ? !0 : this.inherited(arguments) : !1
                                                }, _isValidSubset: function () {
                                                        var k = "number" == typeof this.constraints.min, n = "number" == typeof this.constraints.max, d = this.get("value"); if (isNaN(d) || !k && !n) return this.inherited(arguments); var c = d | 0, g = 0 > d, b = -1 != this.textbox.value.indexOf(this._decimalInfo.sep),
                                                                e = (this.maxLength || 20) - this.textbox.value.length, a = b ? this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g, "") : ""; c = b ? c + "." + a : c + ""; e = w.rep("9", e); b = d; g ? b = Number(c + e) : d = Number(c + e); return !(k && d < this.constraints.min || n && b > this.constraints.max)
                                                }
                                        }); E = E("dijit.form.NumberTextBox", [v, l], { baseClass: "dijitTextBox dijitNumberTextBox" }); E.Mixin = l; return E
                        })
                }, "jimu/dijit/ServiceURLInput": function () {
                        define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Deferred dojo/aspect esri/request dijit/form/ValidationTextBox".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        return E([l], {
                                                _validatingNode: null, _validNode: null, _inValidNode: null, _fetchHandle: null, _fetchErrHandle: null, declaredClass: "jimu.dijit.ServiceURLInput", verify: !0, _status: null, postCreate: function () {
                                                        this.inherited(arguments); this._validatingNode = q.create("div", { "class": "jimu-service-validating" }, this.domNode); this._validNode = q.create("div", { "class": "jimu-service-valid" }, this.domNode); this._inValidNode = q.create("div", { "class": "jimu-service-invalid jimu-icon jimu-icon-error" },
                                                                this.domNode); q.addClass(this.domNode, "jimu-serviceurl-input"); this.verify && this.own(w(this, "Change", A.hitch(this, "_onServiceUrlChange")))
                                                }, setProcessFunction: function (k, n) { this._fetchHandle && this._fetchErrHandle && this._removeProcessFunction(); "function" === typeof k && (this._fetchHandle = v.after(this, "onFetch", k), this.own(this._fetchHandle)); "function" === typeof n && (this._fetchErrHandle = v.after(this, "onFetchError", n), this.own(this._fetchErrHandle)) }, _removeProcessFunction: function () {
                                                        this._fetchHandle &&
                                                        this._fetchHandle.remove && (this._fetchHandle.remove(), this._fetchHandle = null); this._fetchErrHandle && this._fetchErrHandle.remove && (this._fetchErrHandle.remove(), this._fetchErrHandle = null)
                                                }, onFetch: function (k) { return k }, onFetchError: function (k) { }, getStatus: function () { return this._status }, _onServiceUrlChange: function (k) {
                                                        var n = new m; n.then(A.hitch(this, function () { this._valid() }), A.hitch(this, function () { this._inValid(); this.onFetchError() })); this._validating(); k ? r({
                                                                url: A.trim(k || ""), handleAs: "json", content: { f: "json" },
                                                                callbackParamName: "callback"
                                                        }).then(A.hitch(this, function (d) { this.onFetch({ url: this.getValue(), data: d }) ? n.resolve("success") : n.reject("error") }), A.hitch(this, function (d) { n.reject(d) })) : n.reject("error")
                                                }, _validating: function () { this._status = "validating"; q.removeClass(this.domNode, "jimu-serviceurl-input-invalid"); q.removeClass(this.domNode, "jimu-serviceurl-input-valid"); q.addClass(this.domNode, "jimu-serviceurl-input-validating") }, _valid: function () {
                                                        this._status = "valid"; q.removeClass(this.domNode, "jimu-serviceurl-input-invalid");
                                                        q.removeClass(this.domNode, "jimu-serviceurl-input-validating"); q.addClass(this.domNode, "jimu-serviceurl-input-valid")
                                                }, _inValid: function () { this._status = "invalid"; q.removeClass(this.domNode, "jimu-serviceurl-input-validating"); q.removeClass(this.domNode, "jimu-serviceurl-input-valid"); q.addClass(this.domNode, "jimu-serviceurl-input-invalid") }
                                        })
                                })
                }, "jimu/dijit/SimpleTable": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/registry jimu/utils jimu/dijit/CheckBox dijit/form/Select".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                        return E([q, A, w], {
                                                baseClass: "jimu-simple-table", declaredClass: "jimu.dijit.SimpleTable", templateString: '\x3cdiv\x3e\x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"headDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"headTableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0" data-dojo-attach-point\x3d"tableInHeadSection"\x3e\x3ccolgroup data-dojo-attach-point\x3d"headColgroup"\x3e\x3c/colgroup\x3e\x3cthead class\x3d"simple-table-thead simple-table-title"  data-dojo-attach-point\x3d"thead"\x3e\x3c/thead\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"body-section" data-dojo-attach-point\x3d"bodyDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"bodyTableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0"data-dojo-attach-point\x3d"tableInBodySection"\x3e\x3ccolgroup data-dojo-attach-point\x3d"bodyColgroup"\x3e\x3c/colgroup\x3e\x3ctbody class\x3d"simple-table-tbody" data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
                                                _name: null, _rowIndex: 0, _rowHeight: 30, _headHeight: 36, REPEATING_ERROR: "REPEATING_ERROR", _classSimpleTableRow: "simple-table-row", _classFirstSimpleTableRow: "first-simple-table-row", _classLastSimpleTableRow: "last-simple-table-row", _classJimuStateDisabled: "jimu-state-disabled", _classRowUpDiv: "row-up-div", _classRowDownDiv: "row-down-div", _classVerticalScroll: "vertical-scroll", autoHeight: !0, selectable: !1, fields: null, singleClickEdit: !1, postMixInProperties: function () { this.nls = window.jimuNls.simpleTable }, postCreate: function () {
                                                        this.inherited(arguments);
                                                        this._initSelf()
                                                }, startup: function () { this.inherited(arguments); this.updateUI() }, _initSelf: function () {
                                                        this.own(d.bindClickAndDblclickEvents(this.tableInBodySection, m.hitch(this, function (a) { if (a = d.getAncestorDom(a.target || a.srcElement, function (f) { return v.hasClass(f, "simple-table-row") && v.hasClass(f, "not-empty") }, this.tbody)) this.selectRow(a), this._onClickRow(a) }), m.hitch(this, function (a) {
                                                                if (a = d.getAncestorDom(a.target || a.srcElement, function (f) {
                                                                        return v.hasClass(f, "simple-table-row") && v.hasClass(f,
                                                                                "not-empty")
                                                                }, this.tbody)) this.selectRow(a), this._onDblClickRow(a)
                                                        }))); var b = Math.random().toString(); this._name = "jimu_table_" + b.slice(2, b.length); if (this.fields && 0 < this.fields.length) {
                                                                var e = v.create("tr", {}, this.thead); r.forEach(this.fields, m.hitch(this, function (a) {
                                                                        var f = "auto"; "actions" === a.type && (a.name = "actions"); a.hidden ? f = 1 : void 0 !== a.width && null !== a.width ? f = a.width : "actions" !== a.type || a.name || (a.width = this._calculateActionsWidth(a) + 20, f = a.width); v.create("col", { width: f }, this.headColgroup);
                                                                        v.create("col", { width: f }, this.bodyColgroup); f = v.create("th", { innerHTML: d.sanitizeHTML(a.title), title: a.title }, e); if ("checkbox" === a.type) { f.innerHTML = ""; var h = new c({ label: a.title }); this.own(l(h.domNode, "click", m.hitch(this, function () { h.getValue() ? this._checkAllTdCheckBoxes(a.name) : this._uncheckAllTdCheckBoxes(a.name) }))); h.placeAt(f) } v.addClass(f, "simple-table-field"); a.hidden && v.addClass(f, "hidden-column"); a["class"] && v.addClass(f, a["class"]); v.addClass(f, a.name)
                                                                }))
                                                        } else this.fields = null
                                                }, _getThCheckBox: function (b) {
                                                        var e =
                                                                null; b = k(".simple-table-field." + b + " .jimu-checkbox", this.thead)[0]; return e = n.byNode(b)
                                                }, _getAllEnabledTdCheckBoxes: function (b) { b = k(".simple-table-cell." + b + " .jimu-checkbox", this.tbody); b = r.map(b, function (e) { return n.byNode(e) }); return b = r.filter(b, function (e) { return e.getStatus() }) }, _checkAllTdCheckBoxes: function (b) { b = this._getAllEnabledTdCheckBoxes(b); r.forEach(b, function (e) { e.getValue() || e.setValue(!0) }) }, _uncheckAllTdCheckBoxes: function (b) {
                                                        b = this._getAllEnabledTdCheckBoxes(b); r.forEach(b, function (e) {
                                                                e.getValue() &&
                                                                e.setValue(!1)
                                                        })
                                                }, _delaySyncThCheckBoxStatusWithAllTdCheckBoxes: function (b) { setTimeout(m.hitch(this, function () { this._syncThCheckBoxStatusWithAllTdCheckBoxes(b) }), 100) }, _syncThCheckBoxStatusWithAllTdCheckBoxes: function (b) { var e = this._getAllEnabledTdCheckBoxes(b); e = r.filter(e, m.hitch(this, function (a) { return a.getStatus() })); 0 !== e.length && (b = this._getThCheckBox(b), r.every(e, function (a) { return a.getValue() }) ? b.getValue() || b.setValue(!0) : b.getValue() && b.setValue(!1)) }, clear: function () {
                                                        var b = this._getNotEmptyRows(),
                                                        e = r.map(b, m.hitch(this, function (a) { return this.getRowData(a) })); v.empty(this.tbody); r.forEach(b, m.hitch(this, function (a, f) { this._onDeleteRow(a, e[f]) })); this.updateUI(); this._rowIndex = 0; this._onClearRows(b)
                                                }, addRows: function (b) { var e = []; this.fields && b && 0 < b.length && r.forEach(b, m.hitch(this, function (a) { e.push(this.addRow(a, -1, !0)) })); this.updateUI(); return e }, addRow: function (b, e, a) {
                                                        this._rowIndex++; var f = { success: !1, tr: null, errorCode: null, errorMessage: null, repeatFields: null }; if (!this.fields || "object" !==
                                                                typeof b) return f; var h = r.filter(this.fields, m.hitch(this, function (B) { return "text" === B.type && !0 === B.unique })); h = r.filter(h, m.hitch(this, function (B) { return 0 < this.getRowDataArrayByFieldValue(B.name, b[B.name]).length })); if (0 < h.length) return f.errorCode = this.REPEATING_ERROR, f.errorMessage = "repeating data", f.repeatFields = h, f; var p = v.create("tr", { "class": "simple-table-row not-empty" }, this.tbody); v.setAttr(p, "rowId", "row" + this._rowIndex); r.forEach(this.fields, m.hitch(this, function (B) {
                                                                        var t = b[B.name], u =
                                                                                B.type, z = null; "actions" === u ? z = this._createActionsTd(p, B) : ("text" === u ? z = this._createTextTd(p, B, t) : "radio" === u ? z = this._createRadioTd(p, B, t) : "checkbox" === u ? z = this._createCheckboxTd(p, B, t) : "empty" === u ? z = this._createEmptyTd(p, B) : "extension" === u ? z = this._createExtensionTd(p, B, t) : "dropdown" === u && (z = this._createDropdownTd(p, B, t)), B.hidden && v.addClass(z, "hidden-column"))
                                                                })); a || (this.updateUI(), a = this.getRows(), "number" === typeof e && 0 <= e && e < a.length && v.place(p, a[e], "before")); f.success = !0; f.tr = p; f.errorMessage =
                                                                        null; this._onAddRow(p); return f
                                                }, deleteRow: function (b) { if (b) { var e = this.getRowData(b); v.destroy(b); this.updateUI(); this._onDeleteRow(b, e) } }, selectRow: function (b) { this.selectable && (k(".simple-table-row", this.tbody).removeClass("jimu-state-active"), v.addClass(b, "jimu-state-active"), this._onSelectRow(b)) }, updateUI: function () {
                                                        this._updateRowClassName(); this._updateHeight(); v.removeClass(this.domNode, this._classVerticalScroll); 0 < this.bodyDiv.clientHeight && this.bodyDiv.clientHeight < this.bodyDiv.scrollHeight &&
                                                                v.addClass(this.domNode, this._classVerticalScroll); r.forEach(this.fields, m.hitch(this, function (b) { "checkbox" === b.type && this._delaySyncThCheckBoxStatusWithAllTdCheckBoxes(b.name) }))
                                                }, _updateHeadTableWidth: function () { if (this.domNode) { var b = v.getContentBox(this.tableInBodySection).w, e = "100%"; "number" === typeof b && 0 < b && (e = b + "px"); v.setStyle(this.tableInHeadSection, "width", e) } }, _updateHeight: function () {
                                                        var b = this.getRows(); this.autoHeight && v.setStyle(this.domNode, "height", this._headHeight + this._rowHeight *
                                                                (0 < b.length ? b.length : 1) + 1 + "px"); b && 0 < b.length && this.bodyTableDiv && (b = v.getMarginSize(b[0])) && b.h && v.setStyle(this.bodyTableDiv, "backgroundSize", "1px " + b.h + "px")
                                                }, _updateRowClassName: function () {
                                                        var b = k("." + this._classFirstSimpleTableRow, this.tbody)[0]; b && (b = k("." + this._classRowUpDiv, b)[0]) && v.removeClass(b, this._classJimuStateDisabled); (b = k("." + this._classLastSimpleTableRow, this.tbody)[0]) && (b = k("." + this._classRowDownDiv, b)[0]) && v.removeClass(b, this._classJimuStateDisabled); b = k("." + this._classSimpleTableRow,
                                                                this.tbody); b.removeClass("odd"); b.removeClass("even"); b.removeClass(this._classFirstSimpleTableRow); b.removeClass(this._classLastSimpleTableRow); r.forEach(b, m.hitch(this, function (a, f) { 0 === f % 2 ? v.addClass(a, "odd") : v.addClass(a, "even") })); if (0 < b.length) { var e = b[0]; v.addClass(e, this._classFirstSimpleTableRow); (e = k("." + this._classRowUpDiv, e)[0]) && v.addClass(e, this._classJimuStateDisabled); b = b[b.length - 1]; v.addClass(b, this._classLastSimpleTableRow); (b = k("." + this._classRowDownDiv, b)[0]) && v.addClass(b, this._classJimuStateDisabled) }
                                                },
                                                _createTextTd: function (b, e, a) { var f = null; return f = e.editable ? this._createEditableTextTd(b, e, a) : this._createNormalTextTd(b, e, a) }, _createNormalTextTd: function (b, e, a) { var f = v.toDom('\x3ctd class\x3d"simple-table-cell normal-text-td"\x3e\x3cdiv class\x3d"normal-text-div"\x3e\x3c/div\x3e\x3c/td\x3e'); v.addClass(f, e.name); var h = k("div", f)[0]; h.innerHTML = d.sanitizeHTML(a) || ""; h.title = a || ""; e["class"] && v.addClass(f, e["class"]); v.place(f, b); return f }, _createEditableTextTd: function (b, e, a) {
                                                        var f = v.toDom('\x3ctd class\x3d"editable-text-td ' +
                                                                e.name + '"\x3e\x3cdiv class\x3d"editable-div"\x3e\x3c/div\x3e\x3cinput class\x3d"editable-input" type\x3d"text" style\x3d"display:none;" /\x3e\x3c/td\x3e'); v.addClass(f, "simple-table-cell"); v.place(f, b); e["class"] && v.addClass(f, e["class"]); var h = k("div", f)[0], p = k("input", f)[0]; h.innerHTML = d.sanitizeHTML(a) || ""; "" !== h.innerHTML && (h.title = h.innerText || h.innerHTML); p.value = h.innerHTML; this.own(l(h, this.singleClickEdit ? "click" : "dblclick", m.hitch(this, function (B) {
                                                                        this.singleClickEdit || B.stopPropagation();
                                                                        p.value = h.innerText || h.innerHTML; v.setStyle(h, "display", "none"); v.setStyle(p, "display", "inline"); p.focus(); p.select && p.select()
                                                                }))); this.own(l(p, "blur", m.hitch(this, function () { p.value = m.trim(d.sanitizeHTML(p.value)); var B = h.innerText || h.innerHTML, t = p.value; "" !== t ? e.unique ? 0 < this.getRowDataArrayByFieldValue(e.name, t, b).length ? p.value = B : h.innerHTML = d.sanitizeHTML(t) : h.innerHTML = d.sanitizeHTML(t) : p.value = B; v.setStyle(p, "display", "none"); v.setStyle(h, "display", "block") }))); return f
                                                }, _createRadioTd: function (b,
                                                        e, a) { var f = v.toDom('\x3ctd class\x3d"radio-td ' + e.name + '"\x3e\x3cinput class\x3d"jimu-radio-btn" type\x3d"radio" /\x3e\x3c/td\x3e'); v.addClass(f, "simple-table-cell"); v.place(f, b); e["class"] && v.addClass(f, e["class"]); b = k("input", f)[0]; b.name = e.radio && "row" === e.radio ? this._name + this._rowIndex : this._name + e.name; b.checked = !0 === a; return f }, _createCheckboxTd: function (b, e, a) {
                                                                var f = v.toDom('\x3ctd class\x3d"checkbox-td ' + e.name + '"\x3e\x3c/td\x3e'); v.addClass(f, "simple-table-cell"); v.place(f, b); e["class"] &&
                                                                        v.addClass(f, e["class"]); var h = new c({ onChange: m.hitch(this, function () { this._delaySyncThCheckBoxStatusWithAllTdCheckBoxes(e.name); "function" === typeof e.onChange && setTimeout(m.hitch(this, function () { e.onChange(b, h) }), 200) }) }); this.own(l(h, "status-change", m.hitch(this, function () { this._delaySyncThCheckBoxStatusWithAllTdCheckBoxes(e.name) }))); this._setValueForCheckBox(h, a); h.placeAt(f); return f
                                                        }, _createActionsTd: function (b, e) {
                                                                var a = v.toDom('\x3ctd class\x3d"actions-td"\x3e\x3cdiv class\x3d"action-item-parent jimu-float-leading"\x3e\x3c/div\x3e\x3c/td\x3e');
                                                                v.addClass(a, "simple-table-cell"); var f = k(".action-item-parent", a)[0]; v.place(a, b); e["class"] && v.addClass(a, e["class"]); r.forEach(e.actions, m.hitch(this, function (h) {
                                                                        "up" === h ? (h = v.create("div", { "class": "action-item jimu-float-leading row-up-div jimu-icon jimu-icon-up" }, f), h.title = this.nls.moveUp, this.own(l(h, "click", m.hitch(this, function (p) {
                                                                                p.stopPropagation(); if (this.onBeforeRowUp(b)) {
                                                                                        p = k(".simple-table-row", this.tbody); var B = r.indexOf(p, b); 0 < B && (p = p[B - 1]) && (v.place(b, p, "before"), this.updateUI(),
                                                                                                this.emit("row-up", b))
                                                                                }
                                                                        })))) : "down" === h ? (h = v.create("div", { "class": "action-item jimu-float-leading row-down-div jimu-icon jimu-icon-down" }, f), h.title = this.nls.moveDown, this.own(l(h, "click", m.hitch(this, function (p) { p.stopPropagation(); if (this.onBeforeRowDown(b)) { p = k(".simple-table-row", this.tbody); var B = r.indexOf(p, b); B < p.length - 1 && (p = p[B + 1]) && (v.place(b, p, "after"), this.updateUI(), this.emit("row-down", b)) } })))) : "edit" === h ? (h = v.create("div", { "class": "action-item jimu-float-leading row-edit-div jimu-icon jimu-icon-edit" },
                                                                                f), h.title = this.nls.edit, this.own(l(h, "click", m.hitch(this, function (p) { p.stopPropagation(); this.onBeforeRowEdit(b) && this._onActionsEdit(b) })))) : "delete" === h && (h = v.create("div", { "class": "action-item jimu-float-leading row-delete-div jimu-icon jimu-icon-delete" }, f), h.title = this.nls.deleteRow, this.own(l(h, "click", m.hitch(this, function (p) { p.stopPropagation(); this.onBeforeRowDelete(b) && this.deleteRow(b) }))))
                                                                })); e = this._calculateActionsWidth(e) + "px"; v.setStyle(f, "width", e); return a
                                                        }, _calculateActionsWidth: function (b) {
                                                                return 20 *
                                                                        r.map(b.actions, function (e) { return "up" === e || "down" === e || "edit" === e || "delete" === e }).length
                                                        }, _createEmptyTd: function (b, e) { b = v.create("td", { "class": e.name }, b); v.addClass(b, "simple-table-cell"); v.addClass(b, "empty-text-td"); e["class"] && v.addClass(b, e["class"]); return b }, _createExtensionTd: function (b, e, a) {
                                                                b = v.create("td", { "class": e.name }, b); v.addClass(b, "simple-table-cell"); v.addClass(b, "extension-td"); e["class"] && v.addClass(b, e["class"]); e.create && "function" === typeof e.create && e.create(b); e.setValue &&
                                                                        "function" === typeof e.setValue && e.setValue(b, a); return b
                                                        }, _createDropdownTd: function (b, e, a) { b = v.create("td", { "class": e.name }, b); v.addClass(b, "simple-table-cell"); v.addClass(b, "dropdown-td"); e["class"] && v.addClass(b, e["class"]); (new g({ options: a })).placeAt(b); return b }, editRow: function (b, e) {
                                                                var a = { success: !1, tr: null, errorCode: null, errorMessage: null, repeatFields: null }; if (!this.fields || "object" !== typeof e || !v.isDescendant(b, this.tbody)) return a; var f = m.mixin([], this.fields); f = r.filter(f, m.hitch(this,
                                                                        function (p) { return "text" === p.type && !0 === p.unique })); f = r.filter(f, m.hitch(this, function (p) { return 0 < this.getRowDataArrayByFieldValue(p.name, e[p.name], b).length })); if (0 < f.length) return a.errorCode = this.REPEATING_ERROR, a.errorMessage = "repeating data", a.repeatFields = f, a; var h = k(".simple-table-cell", b); r.forEach(this.fields, m.hitch(this, function (p, B) {
                                                                                if (e.hasOwnProperty(p.name)) {
                                                                                        B = h[B]; var t = e[p.name], u = p.type; "text" === u ? p.editable ? this._editEditableText(B, p, t) : this._editNormalText(B, p, t) : "radio" === u ?
                                                                                                this._editRadio(B, p, t) : "checkbox" === u ? this._editCheckbox(B, p, t) : "extension" === u ? this._editExtension(B, p, t) : "dropdown" === u && this._editDropdown(B, p, t)
                                                                                }
                                                                        })); a.success = !0; a.tr = b; a.errorMessage = null; this._onEditRow(b); return a
                                                        }, _editNormalText: function (b, e, a) { b = k("div", b)[0]; b.innerHTML = d.sanitizeHTML(a) || ""; b.title = b.innerHTML }, _editEditableText: function (b, e, a) { e = k("div", b)[0]; e.innerHTML = d.sanitizeHTML(a) || ""; k("input", b)[0].value = e.innerHTML }, _editRadio: function (b, e, a) { k("input", b)[0].checked = !0 === a },
                                                _editCheckbox: function (b, e, a) { b = k(".jimu-checkbox", b)[0]; b = n.byNode(b); this._setValueForCheckBox(b, a) }, _setValueForCheckBox: function (b, e) { null === e ? b.setStatus(!1) : (b.setStatus(!0), e !== b.getValue() && b.setValue(e)) }, _editExtension: function (b, e, a) { e.setValue && "function" === typeof e.setValue && e.setValue(b, a) }, _editDropdown: function (b, e, a) { b = k(".dijitSelect", b)[0]; n.byNode(b).set("value", a) }, _getAllRows: function () { return k(".simple-table-row", this.tbody) }, _getNotEmptyRows: function () {
                                                        var b = this._getAllRows();
                                                        return r.filter(b, m.hitch(this, function (e) { return !v.hasClass(e, "empty") }))
                                                }, _getEmptyRows: function () { var b = this._getAllRows(); return r.filter(b, m.hitch(this, function (e) { return v.hasClass(e, "empty") })) }, getRows: function () { return this._getNotEmptyRows() }, getSelectedRow: function () { var b = null, e = k(".simple-table-row", this.tbody); e = r.filter(e, m.hitch(this, function (a) { return !v.hasClass(a, "empty") && v.hasClass(a, "jimu-state-active") })); 0 < e.length && (b = e[0]); return b }, getSelectedRowData: function () {
                                                        var b = null,
                                                        e = this.getSelectedRow(); e && (b = this._getRowDataByTr(e)); return b
                                                }, getData: function (b) { var e = this._getNotEmptyRows(); b && (e = r.filter(e, m.hitch(this, function (a) { return a !== b }))); return r.map(e, m.hitch(this, function (a) { return this._getRowDataByTr(a) })) }, getRowData: function (b) { return this._getRowDataByTr(b) }, _getRowDataByTr: function (b) {
                                                        var e = null; if (b) e = {}; else return null; r.forEach(this.fields, m.hitch(this, function (a) {
                                                                var f = a.type; if ("actions" !== f) {
                                                                        var h = a.name; e[h] = null; var p = k(".simple-table-cell." +
                                                                                h, b)[0]; p && ("text" === f ? (a = k("div", p)[0], e[h] = a.innerText || a.innerHTML) : "radio" === f ? (a = k("input", p)[0], e[h] = a.checked) : "checkbox" === f ? (a = k(".jimu-checkbox", p)[0], a = n.byNode(a), a.getStatus() ? e[h] = a.getValue() : e[h] = null) : "extension" === f ? a.getValue && "function" === typeof a.getValue && (e[h] = a.getValue(p, a)) : "dropdown" === f && (a = k(".dijitSelect", p)[0], a = n.byNode(a), e[h] = a.get("value")))
                                                                }
                                                        })); return e
                                                }, getRowDataArrayByFieldValue: function (b, e, a) {
                                                        var f = []; if (!this.fields || !r.some(this.fields, m.hitch(this, function (h) {
                                                                return h.name ===
                                                                        b
                                                        }))) return []; a = this.getData(a); return f = r.filter(a, m.hitch(this, function (h) { return h[b] == e }))
                                                }, moveToTop: function (b) { b && b.parentNode === this.tbody && v.place(b, this.tbody, "first") }, _onClickRow: function (b) { this.emit("row-click", b) }, _onDblClickRow: function (b) { this.emit("row-dblclick", b) }, _onSelectRow: function (b) { this.emit("row-select", b) }, _onAddRow: function (b) { this.emit("row-add", b) }, _onEditRow: function (b) { this.emit("row-edit", b) }, _onDeleteRow: function (b, e) { this.emit("row-delete", b, e) }, _onEnterRow: function (b) {
                                                        this.emit("row-enter",
                                                                b)
                                                }, _onClearRows: function (b) { this.emit("rows-clear", b) }, _onActionsEdit: function (b) { this.emit("actions-edit", b) }, onBeforeRowUp: function (b) { return !0 }, onBeforeRowDown: function (b) { return !0 }, onBeforeRowEdit: function (b) { return !0 }, onBeforeRowDelete: function (b) { return !0 }
                                        })
                                })
                }, "jimu/dijit/TabContainer": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin ./ViewStack ../utils".split(" "), function (E, q, A,
                                w, m, v, r, l, k, n, d) {
                                        return E([l, k, r], {
                                                baseClass: "jimu-tab", declaredClass: "jimu.dijit.TabContainer", templateString: '\x3cdiv\x3e\x3cdiv class\x3d"control" data-dojo-attach-point\x3d"controlNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e', postCreate: function () {
                                                        this.inherited(arguments); if (0 !== this.tabs.length) {
                                                                this.controlNodes = []; this.viewStack = new n(null, this.containerNode); this.own(m(this.containerNode, "keydown", q.hitch(this,
                                                                        function (g) { g.keyCode === v.ESCAPE && (g.stopPropagation(), this._currentCtrlNode.focus()) }))); var c = 1 / this.tabs.length * 100; this.isNested && w.addClass(this.domNode, "nested"); A.forEach(this.tabs, function (g) { this._createTab(g, c) }, this); this.own(m(this.controlNode, "keydown", q.hitch(this, function (g) {
                                                                                var b = g.target, e; g.keyCode === v.RIGHT_ARROW ? e = b.nextElementSibling ? b.nextElementSibling : this.controlNodes[0] : g.keyCode === v.LEFT_ARROW ? e = b.previousElementSibling ? b.previousElementSibling : this.controlNodes[this.controlNodes.length -
                                                                                        1] : g.keyCode === v.HOME ? e = this.controlNodes[0] : g.keyCode === v.END && (e = this.controlNodes[this.controlNodes.length - 1]); e && (b = e, e.focus())
                                                                        })))
                                                        }
                                                }, startup: function () { this.selected ? this.selectTab(this.selected) : 0 < this.tabs.length && this.selectTab(this.tabs[0].title); d.setVerticalCenter(this.domNode) }, _createTab: function (c, g) {
                                                        g = w.create("div", { innerHTML: d.sanitizeHTML(c.title), "class": "tab jimu-vcenter-text", style: { width: this.isNested ? "auto" : g + "%" }, label: c.title }, this.controlNode); this.viewStack.viewType = c.content.domNode ?
                                                                "dijit" : "dom"; c.content.label = c.title; this.viewStack.addView(c.content); this.own(m(g, "click", q.hitch(this, function (b) { this.onSelect(c.title, b) }))); this.own(m(g, "keydown", q.hitch(this, function (b) { if (b.keyCode === v.ENTER || b.keyCode === v.SPACE) this.onSelect(c.title, b) }))); g.label = c.title; this.controlNodes.push(g)
                                                }, onSelect: function (c, g) { w.hasClass(g.target, "jimu-state-selected") || this.selectTab(c, g) }, selectTab: function (c) { this._selectControl(c); this.viewStack.switchView(c); this.emit("tabChanged", c) }, _selectControl: function (c) {
                                                        A.forEach(this.controlNodes,
                                                                function (g) { w.removeClass(g, "jimu-state-selected"); w.setAttr(g, "tabindex", "-1"); g.label === c && (this._currentCtrlNode = g, w.addClass(g, "jimu-state-selected"), w.setAttr(g, "tabindex", "0")) }, this)
                                                }
                                        })
                        })
                }, "jimu/dijit/ViewStack": function () {
                        define("dojo/_base/declare dojo/_base/fx dojo/_base/lang dojo/_base/html dojo/_base/array dijit/_WidgetBase".split(" "), function (E, q, A, w, m, v) {
                                return E(v, {
                                        baseClass: "jimu-viewstack", declaredClass: "jimu.dijit.ViewStack", _currentView: null, postCreate: function () {
                                                this.inherited(arguments);
                                                this.views || (this.views = []); m.forEach(this.views, A.hitch(this, function (r) { 1 === r.nodeType ? (w.place(r, this.domNode), w.addClass(r, "view"), w.setStyle(r, "display", "none")) : r.domNode && (w.place(r.domNode, this.domNode), w.addClass(r.domNode, "view"), w.setStyle(r.domNode, "display", "none")) }))
                                        }, startup: function () { this.inherited(arguments); 0 < this.views.length && this.switchView(0) }, getSelectedView: function () { return this._currentView }, getSelectedLabel: function () { var r = "", l = this.getSelectedView(); l && (r = l.label); return r },
                                        getViewByLabel: function (r) { for (var l = 0; l < this.views.length; l++)if (r === this.views[l].label) return this.views[l]; return null }, addView: function (r) { this.views.push(r); 1 === r.nodeType ? (w.place(r, this.domNode), w.addClass(r, "view")) : r.domNode && (w.place(r.domNode, this.domNode), w.addClass(r.domNode, "view")) }, removeView: function (r) { var l = this.views.length; this.views = m.filter(this.views, function (k) { return r !== k }); l !== this.views.length && (1 === r.nodeType ? w.destroy(r) : r.domNode && r.destroyRecursive()) }, switchView: function (r) {
                                                var l;
                                                var k = "number" === typeof r ? this.views[r] : "string" === typeof r ? this.getViewByLabel(r) : r; this.views.forEach(A.hitch(this, function (n) { if (n) if (1 === n.nodeType ? l = n : n.domNode && (l = n.domNode), n === k) { if (w.setStyle(l, "display", "block"), q.fadeIn({ node: l }).play(), n.domNode) if (!n._started) n.startup(), n._started = !0; else if ("function" === typeof n.onShown) n.onShown() } else if (w.setStyle(l, "display", "none"), q.fadeOut({ node: l }).play(), n.domNode && "function" === typeof n.onHidden) n.onHidden() })); this._currentView = k; this.onViewSwitch(k)
                                        },
                                        onViewSwitch: function () { }
                                })
                        })
                }, "jimu/dijit/TabContainer3": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack jimu/utils".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                return E([k, n, r], {
                                        templateString: d, baseClass: "jimu-tab3", declaredClass: "jimu.dijit.TabContainer3", _currentIndex: -1, selected: "", tabs: null, average: !0, postCreate: function () {
                                                this.inherited(arguments);
                                                this._initSelf(); this.selected ? this.selectTab(this.selected) : 0 < this.tabs.length && this.selectTab(this.tabs[0].title)
                                        }, selectTab: function (b) { A.forEach(this.tabItems, q.hitch(this, function (e, a) { w.removeClass(e, "jimu-state-active"); w.setAttr(e, "tabindex", "-1"); e.label === b && (w.addClass(e, "jimu-state-active"), w.setAttr(e, "tabindex", "0"), this._currentIndex = a) })); this.viewStack.switchView(b); this.emit("tabChanged", b) }, addTab: function (b) {
                                                if (!this.average) { var e = l("td:last-child", this.tabTr); 0 < e.length && w.destroy(e[0]) } 0 <
                                                        A.filter(this.tabs, function (a) { return a.title === b.title }).length ? console.error("tab title conflict: " + b.title) : (this.tabs.push(b), this._createTab(b), this.average || this._addEmptyTab())
                                        }, _addEmptyTab: function () { var b = w.toDom('\x3ctd nowrap class\x3d"tab-item-td tab-item-td-empty" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'); w.place(b, this.tabTr) }, removeTab: function (b) {
                                                var e = -1; if (A.some(this.tabs, function (f, h) { if (f.title === b) return e = h, !0 })) {
                                                        var a =
                                                                this.tabs.splice(e, 1)[0]; A.some(this.tabItems, function (f, h) { if (f.label === b) return this.tabItems.splice(h, 1), w.destroy(f), !0 }, this); this.viewStack.removeView(a.content)
                                                }
                                        }, showShelter: function () { w.setStyle(this.shelter, "display", "block") }, hideShelter: function () { w.setStyle(this.shelter, "display", "none") }, getSelectedIndex: function () { return this._currentIndex }, getSelectedTitle: function () { return this.viewStack.getSelectedLabel() }, _initSelf: function () {
                                                this.viewStack = new c(null, this.containerNode); this.own(m(this.containerNode,
                                                        "keydown", q.hitch(this, function (b) { b.keyCode === v.ESCAPE && (b.stopPropagation(), this.tabItems[this._currentIndex].focus()) }))); this.tabItems = []; A.forEach(this.tabs, function (b) { this._createTab(b) }, this); this.own(m(this.tabTr, "keydown", q.hitch(this, function (b) {
                                                                var e = b.target, a; b.keyCode === v.RIGHT_ARROW ? a = e.nextElementSibling ? !this.average && w.hasClass(e.nextElementSibling, "tab-item-td-empty") ? this.tabItems[0] : e.nextElementSibling : this.tabItems[0] : b.keyCode === v.LEFT_ARROW ? a = e.previousElementSibling ? e.previousElementSibling :
                                                                        this.tabItems[this.tabItems.length - 1] : b.keyCode === v.HOME ? a = this.tabItems[0] : b.keyCode === v.END && (a = this.tabItems[this.tabItems.length - 1]); a && (e = a, a.focus())
                                                        }))); this.average ? (this.controlTable.style.tableLayout = "fixed", w.addClass(this.domNode, "average")) : this._addEmptyTab()
                                        }, startup: function () { this.inherited(arguments); this._started = !0 }, _createTab: function (b) {
                                                var e = w.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e'); e.label = b.title || ""; e.title =
                                                        b.title; w.place(e, this.tabTr); var a = l(".tab-item-div", e)[0]; a.innerHTML = g.sanitizeHTML(e.label); a.label = e.label; b.content.label = e.label; this.viewStack.addView(b.content); this.own(m(e, "click", q.hitch(this, function (f) { this._onSelect(b.title, f) }))); this.own(m(e, "keydown", q.hitch(this, function (f) { f.keyCode !== v.ENTER && f.keyCode !== v.SPACE || this._onSelect(b.title, f) }))); this.tabItems.push(e)
                                        }, _onSelect: function (b, e) { w.hasClass(e.target, "jimu-state-active") || this.selectTab(b) }
                                })
                        })
                }, "jimu/dijit/TileLayoutContainer": function () {
                        define(["dojo/_base/declare",
                                "dojo/_base/lang", "dojo/_base/html", "dijit/_WidgetBase"], function (E, q, A, w) {
                                        return E([w], {
                                                baseClass: "jimu-tile-container", declaredClass: "jimu.dijit.TileLayoutContainer", constructor: function () { this.items = []; this.vmargin = this.hmargin = 15 }, startup: function () { this.inherited(arguments); this.items.forEach(q.hitch(this, function (m) { this._placeItem(m) })); this.resize() }, _placeItem: function (m) { m.domNode ? A.place(m.domNode, this.domNode) : A.place(m, this.domNode) }, addItem: function (m) {
                                                        this.items.push(m); this._placeItem(m);
                                                        this.resize()
                                                }, addItems: function (m) { this.items = this.items.concat(m); this.items.forEach(q.hitch(this, function (v) { this._placeItem(v) })); this.resize() }, removeItem: function (m) { var v; for (v = 0; v < this.items.length; v++)if (this.items[v].label === m) { this.items[v].domNode ? this.items[v].destroy() : A.destroy(this.items[v]); this.items.splice(v, 1); this.resize(); break } }, empty: function () { var m; for (m = 0; m < this.items.length; m++)this.items[m].domNode ? this.items[m].destroy() : A.destroy(this.items[m]); this.items = [] }, resize: function () {
                                                        var m =
                                                                A.getMarginBox(this.domNode); var v = this.getItemSize(m); var r = Math.floor((m.w + this.hmargin) / (v.width + this.hmargin)); this.items.forEach(q.hitch(this, function (l, k) { this.setItemPosition(l, k, v, r) }))
                                                }, getItemSize: function (m) {
                                                        var v = {}, r; if ("fixWidth" === this.strategy) v.width = this.itemSize.width, v.height = this.itemSize.height; else if ("breakWidth" === this.strategy) for (r = 0; r < this.itemSize.length; r++) { if (m.w <= this.itemSize[r].screenWidth) { v.width = this.itemSize[r].width; v.height = this.itemSize[r].height; break } } else "fixCols" ===
                                                                this.strategy && (v.width = (m.w - this.hmargin * (this.maxCols - 1)) / this.maxCols, v.height = "number" === typeof this.itemSize.height ? this.itemSize.height : v.width * parseFloat(this.itemSize.height.substring(0, this.itemSize.height.length - 1)) / 100); return v
                                                }, setItemPosition: function (m, v, r, l) {
                                                        v++; var k = v % l; v = Math.ceil(v / l); 0 === k && (k = l); l = { position: "absolute", top: (this.vmargin + r.height) * (v - 1) + "px" }; l[window.isRTL ? "right" : "left"] = (this.hmargin + r.width) * (k - 1) + "px"; 0 <= r.width && (l.width = r.width + "px"); 0 <= r.height && (l.height =
                                                                r.height + "px"); A.setStyle(m.domNode ? m.domNode : m, l)
                                                }
                                        })
                                })
                }, "jimu/dijit/DrawBox": function () {
                        define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DrawBox.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dijit/a11yclick dojo/query dojo/Evented esri/graphic esri/layers/GraphicsLayer jimu/dijit/Draw esri/symbols/jsonUtils esri/geometry/Polygon".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                var h = {}; return E([q, A, w, c],
                                        {
                                                templateString: m, baseClass: "jimu-draw-box", declaredClass: "jimu.dijit.DrawBox", nls: null, drawLayer: null, drawLayerId: null, drawToolBar: null, _isDisabled: !1, _shiftKey: !1, _ctrlKey: !1, _metaKey: !1, types: null, geoTypes: null, map: null, pointSymbol: null, polylineSymbol: null, polygonSymbol: null, textSymbol: null, showClear: !1, keepOneGraphic: !1, deactivateAfterDrawing: !0, postMixInProperties: function () { this.nls = window.jimuNls.drawBox }, postCreate: function () {
                                                        this.inherited(arguments); var p = {}; this.drawLayerId && (p.id = this.drawLayerId);
                                                        this.drawLayer = new b(p); this._initDefaultSymbols(); this._initTypes(); p = d(".draw-item", this.domNode); p.forEach(function (B) { r.setAttr(B, "role", "button"); r.setAttr(B, "tabindex", "0") }); this.own(p.on(n, v.hitch(this, this._onItemClick))); r.setAttr(this.btnClear, "role", "button"); r.setAttr(this.btnClear, "tabindex", "0"); this.own(k(this.btnClear, n, v.hitch(this, this._onClickClear))); this.own(k(document.body, "keydown", v.hitch(this, function (B) {
                                                                this._shiftKey = !!B.shiftKey; this._ctrlKey = !!B.ctrlKey; this._metaKey =
                                                                        !!B.metaKey
                                                        }))); this.own(k(document.body, "keyup", v.hitch(this, function (B) { this._shiftKey = !!B.shiftKey; this._ctrlKey = !!B.ctrlKey; this._metaKey = !!B.metaKey }))); this.map && this.setMap(this.map); r.setStyle(this.btnClear, "display", !0 === this.showClear ? "block" : "none"); this.enable(); h[this.id] = this
                                                }, enable: function () { this._isDisabled = !1; r.addClass(this.domNode, "enabled"); r.removeClass(this.domNode, "disabled") }, disable: function () {
                                                        this._isDisabled = !0; r.addClass(this.domNode, "disabled"); r.removeClass(this.domNode,
                                                                "enabled"); this.deactivate()
                                                }, hideLayer: function () { this.drawLayer && this.drawLayer.hide() }, showLayer: function () { this.drawLayer && this.drawLayer.show() }, isEnabled: function () { return !this._isDisabled }, isActive: function () { var p = d(".draw-item.jimu-state-active", this.domNode); return p && 0 < p.length }, disableWebMapPopup: function () { this.map && this.map.setInfoWindowOnClick(!1) }, enableWebMapPopup: function () { this.map && this.map.setInfoWindowOnClick(!0) }, destroy: function () {
                                                        this.deactivate(); this.drawLayer && this.map &&
                                                                this.map.removeLayer(this.drawLayer); this.drawLayer = this.map = this.drawToolBar = null; delete h[this.id]; this.inherited(arguments)
                                                }, setMap: function (p) { p && (this.map = p, this.map.addLayer(this.drawLayer), this.drawToolBar = new e(this.map), this.drawToolBar.setMarkerSymbol(this.pointSymbol), this.drawToolBar.setLineSymbol(this.polylineSymbol), this.drawToolBar.setFillSymbol(this.polygonSymbol), this.own(k(this.drawToolBar, "draw-end", v.hitch(this, this._onDrawEnd)))) }, setPointSymbol: function (p) {
                                                        this.pointSymbol = p;
                                                        this.drawToolBar.setMarkerSymbol(this.pointSymbol)
                                                }, setLineSymbol: function (p) { this.polylineSymbol = p; this.drawToolBar.setLineSymbol(p) }, setPolygonSymbol: function (p) { this.polygonSymbol = p; this.drawToolBar.setFillSymbol(p) }, setTextSymbol: function (p) { this.textSymbol = p }, reset: function () { this.deactivate(); this.clear() }, clear: function () { this.drawLayer.clear(); this.onClear() }, deactivate: function () {
                                                        this.enableWebMapPopup(); d(".draw-item", this.domNode).removeClass("jimu-state-active"); this.drawToolBar && (this.drawToolBar.deactivate(),
                                                                this.emit("draw-deactivate"))
                                                }, activate: function (p) { var B = null, t = d(".draw-item", this.domNode); "TEXT" === p ? (p = "POINT", B = this.textIcon) : (t = t.filter(function (u) { return u.getAttribute("data-geotype") === p }), 0 < t.length && (B = t[0])); B && this._activate(B) }, onIconSelected: function (p, B, t) { this.emit("icon-selected", p, B, t) }, onDrawEnd: function (p, B, t, u, z, x) { this.emit("draw-end", p, B, t, u, z, x) }, onClear: function () { this.emit("clear") }, addGraphic: function (p) { this.keepOneGraphic && this.drawLayer.clear(); this.drawLayer.add(p) },
                                                removeGraphic: function (p) { this.drawLayer.remove(p) }, getFirstGraphic: function () { var p = null; this.drawLayer && 0 < this.drawLayer.graphics.length && (p = this.drawLayer.graphics[0]); return p }, show: function () { r.removeClass(this.domNode, "hidden") }, hide: function () { r.addClass(this.domNode, "hidden") }, getDrawItemIcons: function () { return d(".draw-item", this.domNode) }, _onClickClear: function () { this._isDisabled || (this.clear(), this.emit("user-clear")) }, _initDefaultSymbols: function () {
                                                        var p = {
                                                                style: "esriSMSCircle", color: [0,
                                                                        0, 128, 128], name: "Circle", outline: { color: [0, 0, 128, 255], width: 1 }, type: "esriSMS", size: 18
                                                        }, B = { style: "esriSLSSolid", color: [79, 129, 189, 255], width: 3, name: "Blue 1", type: "esriSLS" }, t = { style: "esriSFSSolid", color: [79, 129, 189, 128], type: "esriSFS", outline: { style: "esriSLSSolid", color: [54, 93, 141, 255], width: 1.5, type: "esriSLS" } }; this.pointSymbol || (this.pointSymbol = a.fromJson(p)); this.polylineSymbol || (this.polylineSymbol = a.fromJson(B)); this.polygonSymbol || (this.polygonSymbol = a.fromJson(t))
                                                }, _initTypes: function () {
                                                        this.geoTypes &&
                                                        0 < this.geoTypes.length ? this.types = null : (this.geoTypes = [], this.types && 0 < this.types.length || (this.types = ["point", "arrow", "polyline", "polygon"]), 0 <= this.types.indexOf("point") && (this.geoTypes = this.geoTypes.concat(["POINT"])), 0 <= this.types.indexOf("arrow") && (this.geoTypes = this.geoTypes.concat(["ARROW"])), 0 <= this.types.indexOf("polyline") && (this.geoTypes = this.geoTypes.concat(["LINE", "POLYLINE", "FREEHAND_POLYLINE"])), 0 <= this.types.indexOf("polygon") && (this.geoTypes = this.geoTypes.concat("TRIANGLE EXTENT CIRCLE ELLIPSE POLYGON FREEHAND_POLYGON".split(" "))),
                                                                0 <= this.types.indexOf("text") && (this.geoTypes = this.geoTypes.concat(["TEXT"]))); var p = d(".draw-item", this.domNode); p.style("display", "none"); l.forEach(p, v.hitch(this, function (B) { var t = B.getAttribute("data-geotype"); t = 0 <= l.indexOf(this.geoTypes, t); r.setStyle(B, "display", t ? "block" : "none") }))
                                                }, _onItemClick: function (p) { this._isDisabled || (p = p.target || p.srcElement, r.hasClass(p, "draw-item") && (r.hasClass(p, "jimu-state-active") ? this.deactivate() : this._activate(p))) }, _activate: function (p) {
                                                        this._deactiveAllDrawBoxes();
                                                        d(".draw-item", this.domNode).removeClass("jimu-state-active"); r.addClass(p, "jimu-state-active"); var B = p.getAttribute("data-geotype"), t = p.getAttribute("data-commontype"), u = e[B]; "TEXT" === B && (u = e.POINT); this.disableWebMapPopup(); this.drawToolBar.activate(u); this.emit("draw-activate", u); this.onIconSelected(p, B, t)
                                                }, _onDrawEnd: function (p) {
                                                        var B = d(".draw-item.jimu-state-active", this.domNode)[0], t = B.getAttribute("data-geotype"); B = B.getAttribute("data-commontype"); var u = null; u = "extent" === p.geometry.type ? f.fromExtent(p.geometry) :
                                                                p.geometry; u.geoType = t; u.commonType = B; p = u.type; var z = null; z = "point" === p || "multipoint" === p ? r.hasClass(this.textIcon, "jimu-state-active") ? this.textSymbol : this.pointSymbol : "line" === p || "polyline" === p ? this.polylineSymbol : this.polygonSymbol; u = new g(u, z, null, null); this.keepOneGraphic && this.drawLayer.clear(); this.drawLayer.add(u); this.deactivateAfterDrawing && this.deactivate(); this.onDrawEnd(u, t, B, this._shiftKey, this._ctrlKey, this._metaKey)
                                                }, _deactiveAllDrawBoxes: function () {
                                                        var p; l.forEach(Object.keys(h),
                                                                v.hitch(this, function (B) { (p = h[B]) && p.drawToolBar && B !== this.id && p.deactivate() }))
                                                }
                                        })
                        })
                }, "jimu/dijit/Draw": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/has esri/kernel esri/toolbars/draw esri/graphic esri/geometry/Polyline esri/geometry/Polygon esri/geometry/Multipoint esri/geometry/Rect".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                var c = E([v], {
                                        baseClass: "jimu-draw", declaredClass: "jimu.dijit.Draw", _onMouseDragHandler: function (g) {
                                                if (this._graphic || this._points.length) if (w("esri-touch") &&
                                                        !this._points.length) g.preventDefault(); else {
                                                                this._dragged = !0; if (this.map.snappingManager) var b = this.map.snappingManager._snappingPoint; var e = this._points[0], a = b || g.mapPoint, f = this.map, h = f.spatialReference; b = this._graphic; var p = c, B = f.toScreen(e), t = f.toScreen(a), u = []; u = t.x - B.x; t = t.y - B.y; var z = Math.sqrt(u * u + t * t); switch (this._geometryType) {
                                                                        case p.CIRCLE: this._hideTooltip(); b.geometry = k.createCircle({ center: B, r: z, numberOfPoints: 60, map: f }); b.setGeometry(b.geometry); break; case p.ELLIPSE: this._hideTooltip();
                                                                                b.geometry = k.createEllipse({ center: B, longAxis: u, shortAxis: t, numberOfPoints: 60, map: f }); b.setGeometry(b.geometry); break; case p.TRIANGLE: this._hideTooltip(); u = [[0, -z], [.8660254037844386 * z, .5 * z], [-.8660254037844386 * z, .5 * z], [0, -z]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.ARROW: this._hideTooltip(); e = t / z; f = u / z; a = .25 * f * z; h = .25 * z / (t / u); z *= .25 * e; p = this.fillSymbol ? this.fillSymbol.arrowWidth : 12; u = [[u, t], [u - a * (1 + p / h), t + p * f - z], [u - a * (1 + p / 2 / h), t + p / 2 * f - z], [-p / 2 * e, p / 2 * f], [p / 2 * e,
                                                                                -p / 2 * f], [u - a * (1 - p / 2 / h), t - p / 2 * f - z], [u - a * (1 - p / h), t - p * f - z], [u, t]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.LEFT_ARROW: this._hideTooltip(); u = 0 >= u ? [[u, 0], [.75 * u, t], [.75 * u, .5 * t], [0, .5 * t], [0, -.5 * t], [.75 * u, -.5 * t], [.75 * u, -t], [u, 0]] : [[0, 0], [.25 * u, t], [.25 * u, .5 * t], [u, .5 * t], [u, -.5 * t], [.25 * u, -.5 * t], [.25 * u, -t], [0, 0]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.RIGHT_ARROW: this._hideTooltip(); u = 0 <= u ? [[u, 0], [.75 * u, t], [.75 * u, .5 * t], [0, .5 * t], [0, -.5 *
                                                                                        t], [.75 * u, -.5 * t], [.75 * u, -t], [u, 0]] : [[0, 0], [.25 * u, t], [.25 * u, .5 * t], [u, .5 * t], [u, -.5 * t], [.25 * u, -.5 * t], [.25 * u, -t], [0, 0]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.UP_ARROW: this._hideTooltip(); u = 0 >= t ? [[0, t], [-u, .75 * t], [-.5 * u, .75 * t], [-.5 * u, 0], [.5 * u, 0], [.5 * u, .75 * t], [u, .75 * t], [0, t]] : [[0, 0], [-u, .25 * t], [-.5 * u, .25 * t], [-.5 * u, t], [.5 * u, t], [.5 * u, .25 * t], [u, .25 * t], [0, 0]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.DOWN_ARROW: this._hideTooltip(); u =
                                                                                                0 <= t ? [[0, t], [-u, .75 * t], [-.5 * u, .75 * t], [-.5 * u, 0], [.5 * u, 0], [.5 * u, .75 * t], [u, .75 * t], [0, t]] : [[0, 0], [-u, .25 * t], [-.5 * u, .25 * t], [-.5 * u, t], [.5 * u, t], [.5 * u, .25 * t], [u, .25 * t], [0, 0]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.RECTANGLE: this._hideTooltip(); u = [[0, 0], [u, 0], [u, t], [0, t], [0, 0]]; b.geometry = this._toPolygon(u, B.x, B.y); b.setGeometry(b.geometry); break; case p.LINE: b.setGeometry(q.mixin(b.geometry, { paths: [[[e.x, e.y], [a.x, a.y]]] })); break; case p.EXTENT: b && f.graphics.remove(b, !0);
                                                                                b = new d(this._normalizeRect(e, a, h)); b._originOnly = !0; this._graphic = f.graphics.add(new r(b, this.fillSymbol), !0); f.snappingManager && f.snappingManager._setGraphic(this._graphic); break; case p.FREEHAND_POLYLINE: this._hideTooltip(); if (!1 === this._canDrawFreehandPoint(g)) { w("esri-touch") && g.preventDefault(); return } this._points.push(g.mapPoint.offset(0, 0)); b.geometry._insertPoints([a.offset(0, 0)], 0); b.setGeometry(b.geometry); break; case p.FREEHAND_POLYGON: this._hideTooltip(); if (!1 === this._canDrawFreehandPoint(g)) {
                                                                                        w("esri-touch") &&
                                                                                        g.preventDefault(); return
                                                                                } this._points.push(g.mapPoint.offset(0, 0)); b.geometry._insertPoints([a.offset(0, 0)], 0); b.setGeometry(b.geometry)
                                                                }w("esri-touch") && g.preventDefault()
                                                }
                                        }, _onClickHandler: function (g) {
                                                if (this.map.snappingManager) var b = this.map.snappingManager._snappingPoint; var e = b || g.mapPoint; g = this.map; b = g.toScreen(e); var a = c; this._points.push(e.offset(0, 0)); switch (this._geometryType) {
                                                        case a.POINT: this.onDrawStart(); this._drawEnd(e.offset(0, 0)); this._setTooltipMessage(0); break; case a.POLYLINE: 1 ===
                                                                this._points.length ? (b = new l(g.spatialReference), b.addPath(this._points), this._graphic = g.graphics.add(new r(b, this.lineSymbol), !0), g.snappingManager && g.snappingManager._setGraphic(this._graphic), this._onMouseMoveHandler_connect = A.connect(g, "onMouseMove", this._onMouseMoveHandler), this.onDrawStart()) : (this._graphic.geometry._insertPoints([e.offset(0, 0)], 0), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol)); break; case a.POLYGON: 1 === this._points.length ? (b = new k(g.spatialReference),
                                                                        b.addRing(this._points), this._graphic = g.graphics.add(new r(b, this.fillSymbol), !0), g.snappingManager && g.snappingManager._setGraphic(this._graphic), this._onMouseMoveHandler_connect = A.connect(g, "onMouseMove", this._onMouseMoveHandler), this.onDrawStart()) : (this._graphic.geometry._insertPoints([e.offset(0, 0)], 0), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol)); break; case a.MULTI_POINT: b = this._points; 1 === b.length ? (e = new n(g.spatialReference), e.addPoint(b[b.length - 1]), this._graphic =
                                                                                g.graphics.add(new r(e, this.markerSymbol), !0), g.snappingManager && g.snappingManager._setGraphic(this._graphic), this.onDrawStart()) : (this._graphic.geometry.addPoint(b[b.length - 1]), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol)); break; case a.ARROW: g = this.fillSymbol ? this.fillSymbol.arrowWidth : 12; this._addShape([[0, 0], [-g, g], [-g, g / 2], [-96, g / 2], [-96, -g / 2], [-g, -g / 2], [-g, -g], [0, 0]], b.x, b.y); break; case a.LEFT_ARROW: this._addShape([[0, 0], [24, 24], [24, 12], [96, 12], [96, -12], [24,
                                                                                        -12], [24, -24], [0, 0]], b.x, b.y); break; case a.RIGHT_ARROW: this._addShape([[0, 0], [-24, 24], [-24, 12], [-96, 12], [-96, -12], [-24, -12], [-24, -24], [0, 0]], b.x, b.y); break; case a.UP_ARROW: this._addShape([[0, 0], [-24, 24], [-12, 24], [-12, 96], [12, 96], [12, 24], [24, 24], [0, 0]], b.x, b.y); break; case a.DOWN_ARROW: this._addShape([[0, 0], [-24, -24], [-12, -24], [-12, -96], [12, -96], [12, -24], [24, -24], [0, 0]], b.x, b.y); break; case a.TRIANGLE: this._addShape([[0, -48], [41.56921938165306, 24], [-41.56921938165306, 24], [0, -48]], b.x, b.y); break; case a.RECTANGLE: this._addShape([[0,
                                                                                                -96], [96, -96], [96, 0], [0, 0], [0, -96]], b.x - 48, b.y + 48); break; case a.CIRCLE: this._clear(); this.onDrawStart(); this._drawEnd(k.createCircle({ center: b, r: 48, numberOfPoints: 60, map: g })); break; case a.ELLIPSE: this._clear(), this.onDrawStart(), this._drawEnd(k.createEllipse({ center: b, longAxis: 48, shortAxis: 24, numberOfPoints: 60, map: g }))
                                                }this._setTooltipMessage(this._points.length)
                                        }
                                }); q.mixin(c, {
                                        POINT: "point", MULTI_POINT: "multipoint", LINE: "line", EXTENT: "extent", POLYLINE: "polyline", POLYGON: "polygon", FREEHAND_POLYLINE: "freehandpolyline",
                                        FREEHAND_POLYGON: "freehandpolygon", ARROW: "arrow", LEFT_ARROW: "leftarrow", RIGHT_ARROW: "rightarrow", UP_ARROW: "uparrow", DOWN_ARROW: "downarrow", TRIANGLE: "triangle", CIRCLE: "circle", ELLIPSE: "ellipse", RECTANGLE: "rectangle"
                                }); w("extend-esri") && q.setObject("toolbars.Draw", c, m); return c
                        })
                }, "esri/toolbars/draw": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t, u, z, x, y, D) {
                                        var H = E(e, {
                                                declaredClass: "esri.toolbars.Draw", _eventMap: { "draw-complete": !0, "draw-end": ["geometry"] }, constructor: function (I, N) {
                                                        this.markerSymbol = new a(a.STYLE_SOLID, 10, new f(f.STYLE_SOLID, new m([255, 0, 0]), 2), new m([0, 0, 0, .25])); this.lineSymbol = new f(f.STYLE_SOLID, new m([255, 0, 0]), 2); this.fillSymbol = new h(h.STYLE_SOLID, new f(f.STYLE_SOLID, new m([255, 0, 0]), 2), new m([0, 0, 0, .25])); this._points = []; this._mouse = !r("esri-touch") && !r("esri-pointer");
                                                        this._defaultOptions = { showTooltips: !0, drawTime: 75, tolerance: 8, tooltipOffset: 15 }; this._options = q.mixin(q.mixin({}, this._defaultOptions), N || {}); if (l("ios") || l("android")) this._options.showTooltips = !1; this._onKeyDownHandler = q.hitch(this, this._onKeyDownHandler); this._onMouseDownHandler = q.hitch(this, this._onMouseDownHandler); this._onMouseUpHandler = q.hitch(this, this._onMouseUpHandler); this._onClickHandler = q.hitch(this, this._onClickHandler); this._onMouseMoveHandler = q.hitch(this, this._onMouseMoveHandler);
                                                        this._onMouseDragHandler = q.hitch(this, this._onMouseDragHandler); this._onDblClickHandler = q.hitch(this, this._onDblClickHandler); this._updateTooltip = q.hitch(this, this._updateTooltip); this._hideTooltip = q.hitch(this, this._hideTooltip); this._redrawGraphic = q.hitch(this, this._redrawGraphic)
                                                }, _geometryType: null, respectDrawingVertexOrder: !1, setRespectDrawingVertexOrder: function (I) { this.respectDrawingVertexOrder = I }, setMarkerSymbol: function (I) { this.markerSymbol = I }, setLineSymbol: function (I) { this.lineSymbol = I },
                                                setFillSymbol: function (I) { this.fillSymbol = I }, activate: function (I, N) {
                                                        this._geometryType && this.deactivate(); var T = this.map, M = w.connect, R = H; this._options = q.mixin(q.mixin({}, this._options), N || {}); T.navigationManager.setImmediateClick(!1); switch (I) {
                                                                case R.ARROW: case R.LEFT_ARROW: case R.RIGHT_ARROW: case R.UP_ARROW: case R.DOWN_ARROW: case R.TRIANGLE: case R.CIRCLE: case R.ELLIPSE: case R.RECTANGLE: this._deactivateMapTools(!0, !1, !1, !0); this._onClickHandler_connect = M(T, "onClick", this._onClickHandler); this._mouse ?
                                                                        (this._onMouseDownHandler_connect = M(T, "onMouseDown", this._onMouseDownHandler), this._onMouseDragHandler_connect = M(T, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = M(T, "onMouseUp", this._onMouseUpHandler)) : (this._onMouseDownHandler_connect = M(T, "onMouseDragStart", this._onMouseDownHandler), this._onMouseDragHandler_connect = M(T, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = M(T, "onMouseDragEnd", this._onMouseUpHandler)); r("esri-touch") && (this._onMouseDownHandler2_connect =
                                                                                M(T, "onSwipeStart", this._onMouseDownHandler), this._onMouseDragHandler2_connect = M(T, "onSwipeMove", this._onMouseDragHandler), this._onMouseUpHandler2_connect = M(T, "onSwipeEnd", this._onMouseUpHandler)); break; case R.POINT: this._onClickHandler_connect = M(T, "onClick", this._onClickHandler); break; case R.LINE: case R.EXTENT: case R.FREEHAND_POLYLINE: case R.FREEHAND_POLYGON: this._deactivateMapTools(!0, !1, !1, !0); this._mouse ? (this._onMouseDownHandler_connect = M(T, "onMouseDown", this._onMouseDownHandler), this._onMouseDragHandler_connect =
                                                                                        M(T, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = M(T, "onMouseUp", this._onMouseUpHandler)) : (this._onMouseDownHandler_connect = M(T, "onMouseDragStart", this._onMouseDownHandler), this._onMouseDragHandler_connect = M(T, "onMouseDrag", this._onMouseDragHandler), this._onMouseUpHandler_connect = M(T, "onMouseDragEnd", this._onMouseUpHandler)); r("esri-touch") && (this._onMouseDownHandler2_connect = M(T, "onSwipeStart", this._onMouseDownHandler), this._onMouseDragHandler2_connect = M(T, "onSwipeMove",
                                                                                                this._onMouseDragHandler), this._onMouseUpHandler2_connect = M(T, "onSwipeEnd", this._onMouseUpHandler)); break; case R.POLYLINE: case R.POLYGON: case R.MULTI_POINT: T.navigationManager.setImmediateClick(!0); this._onClickHandler_connect = M(T, "onClick", this._onClickHandler); this._onDblClickHandler_connect = M(T, "onDblClick", this._onDblClickHandler); this._dblClickZoom = T.isDoubleClickZoom; T.disableDoubleClickZoom(); break; default: console.error("Unsupported geometry type: " + I); return
                                                        }this._onKeyDown_connect = M(T, "onKeyDown",
                                                                this._onKeyDownHandler); this._redrawConnect = M(T, "onExtentChange", this._redrawGraphic); this._geometryType = I; this._toggleTooltip(!0); T.snappingManager && "freehandpolyline" !== this._geometryType && "freehandpolygon" !== this._geometryType && (T.snappingManager._startSelectionLayerQuery(), T.snappingManager._setUpSnapping()); this.onActivate(this._geometryType)
                                                }, deactivate: function () {
                                                        var I = this.map; this._clear(); var N = w.disconnect; N(this._onMouseMoveHandler_connect); N(this._onMouseDownHandler_connect); N(this._onMouseDragHandler_connect);
                                                        N(this._onMouseUpHandler_connect); N(this._onMouseDownHandler2_connect); N(this._onMouseDragHandler2_connect); N(this._onMouseUpHandler2_connect); N(this._onClickHandler_connect); N(this._onDblClickHandler_connect); N(this._onKeyDown_connect); N(this._redrawConnect); this._onMouseDownHandler_connect = this._onMouseMoveHandler_connect = this._onMouseDragHandler_connect = this._onMouseUpHandler_connect = this._onMouseDownHandler2_connect = this._onMouseDragHandler2_connect = this._onMouseUpHandler2_connect = this._onClickHandler_connect =
                                                                this._onDblClickHandler_connect = this._onKeyDown_connect = this._redrawConnect = null; I.snappingManager && (I.snappingManager._stopSelectionLayerQuery(), I.snappingManager._killOffSnapping()); switch (this._geometryType) {
                                                                        case H.CIRCLE: case H.ELLIPSE: case H.TRIANGLE: case H.ARROW: case H.LEFT_ARROW: case H.RIGHT_ARROW: case H.UP_ARROW: case H.DOWN_ARROW: case H.RECTANGLE: case H.LINE: case H.EXTENT: case H.FREEHAND_POLYLINE: case H.FREEHAND_POLYGON: this._activateMapTools(!0, !1, !1, !0); break; case H.POLYLINE: case H.POLYGON: case H.MULTI_POINT: this._dblClickZoom &&
                                                                                I.enableDoubleClickZoom()
                                                                }N = this._geometryType; this._geometryType = null; I.navigationManager.setImmediateClick(!1); this._toggleTooltip(!1); this.onDeactivate(N)
                                                }, _clear: function () { this._graphic && this.map.graphics.remove(this._graphic, !0); this._graphic = null; this.map.snappingManager && this.map.snappingManager._setGraphic(null); this._points = [] }, finishDrawing: function () {
                                                        var I = this._points, N = this.map.spatialReference, T = H; I = I.slice(0, I.length); switch (this._geometryType) {
                                                                case T.POLYLINE: if (!this._graphic || 2 >
                                                                        I.length) return; var M = new u(N); M.addPath([].concat(I)); break; case T.POLYGON: if (!this._graphic || 3 > I.length) return; M = new z(N); I = [].concat(I, [I[0].offset(0, 0)]); z.prototype.isClockwise(I) || this.respectDrawingVertexOrder || (console.debug(this.declaredClass + " :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."), I.reverse()); M.addRing(I); break; case T.MULTI_POINT: M = new x(N), A.forEach(I, function (R) { M.addPoint(R) })
                                                        }w.disconnect(this._onMouseMoveHandler_connect); this._clear(); this._setTooltipMessage(0);
                                                        this._drawEnd(M)
                                                }, _drawEnd: function (I) { if (I) { var N = this.map.spatialReference, T; this.onDrawEnd(I); N && (N.isWebMercator() ? T = t.webMercatorToGeographic(I, !0) : 4326 === N.wkid && (T = B.fromJson(I.toJson()))); this.onDrawComplete({ geometry: I, geographicGeometry: T }) } }, _normalizeRect: function (I, N, T) { var M = I.x; I = I.y; var R = N.x; N = N.y; return { x: Math.min(M, R), y: Math.max(I, N), width: Math.abs(M - R), height: Math.abs(I - N), spatialReference: T } }, _onMouseDownHandler: function (I) {
                                                        this._dragged = !1; if (this.map.snappingManager) var N = this.map.snappingManager._snappingPoint;
                                                        var T = N || I.mapPoint, M = H; N = this.map; var R = N.spatialReference; this._points.push(T.offset(0, 0)); switch (this._geometryType) {
                                                                case M.LINE: this._graphic = N.graphics.add(new p(new u({ paths: [[[T.x, T.y], [T.x, T.y]]], spatialReference: R }), this.lineSymbol), !0); N.snappingManager && N.snappingManager._setGraphic(this._graphic); break; case M.FREEHAND_POLYLINE: this._oldPoint = I.screenPoint; T = new u(R); T.addPath(this._points); this._graphic = N.graphics.add(new p(T, this.lineSymbol), !0); N.snappingManager && N.snappingManager._setGraphic(this._graphic);
                                                                        break; case M.CIRCLE: case M.ELLIPSE: case M.TRIANGLE: case M.ARROW: case M.LEFT_ARROW: case M.RIGHT_ARROW: case M.UP_ARROW: case M.DOWN_ARROW: case M.RECTANGLE: case M.FREEHAND_POLYGON: this._oldPoint = I.screenPoint, T = new z(R), T.addRing(this._points), this._graphic = N.graphics.add(new p(T, this.fillSymbol), !0), N.snappingManager && N.snappingManager._setGraphic(this._graphic)
                                                        }r("esri-touch") && I.preventDefault(); if (1 === this._points.length) this.onDrawStart()
                                                }, _onMouseMoveHandler: function (I) {
                                                        if (this.map.snappingManager) var N =
                                                                this.map.snappingManager._snappingPoint; I = N || I.mapPoint; N = this._graphic.geometry; switch (this._geometryType) { case H.POLYLINE: case H.POLYGON: var T = this._points.length, M = !!N.getPoint(0, T); I = I.offset(0, 0); M ? N.setPoint(0, T, I) : N.insertPoint(0, T, I); this._graphic.setGeometry(N) }
                                                }, _onMouseDragHandler: function (I) {
                                                        if (this._graphic || this._points.length) if (r("esri-touch") && !this._points.length) I.preventDefault(); else {
                                                                this._dragged = !0; if (this.map.snappingManager) var N = this.map.snappingManager._snappingPoint; var T =
                                                                        this._points[0], M = N || I.mapPoint, R = this.map, ca = R.spatialReference; N = this._graphic; var K = H, Q = R.toScreen(T), X = R.toScreen(M), W = []; W = X.x - Q.x; X = X.y - Q.y; var fa = Math.sqrt(W * W + X * X); switch (this._geometryType) {
                                                                                case K.CIRCLE: this._hideTooltip(); N.geometry = z.createCircle({ center: Q, r: fa, numberOfPoints: 60, map: R }); N.setGeometry(N.geometry); break; case K.ELLIPSE: this._hideTooltip(); N.geometry = z.createEllipse({ center: Q, longAxis: W, shortAxis: X, numberOfPoints: 60, map: R }); N.setGeometry(N.geometry); break; case K.TRIANGLE: this._hideTooltip();
                                                                                        W = [[0, -fa], [.8660254037844386 * fa, .5 * fa], [-.8660254037844386 * fa, .5 * fa], [0, -fa]]; N.geometry = this._toPolygon(W, Q.x, Q.y); N.setGeometry(N.geometry); break; case K.ARROW: this._hideTooltip(); T = X / fa; R = W / fa; M = .25 * R * fa; ca = .25 * fa / (X / W); fa *= .25 * T; W = [[W, X], [W - M * (1 + 24 / ca), X + 24 * R - fa], [W - M * (1 + 12 / ca), X + 12 * R - fa], [-12 * T, 12 * R], [12 * T, -12 * R], [W - M * (1 - 12 / ca), X - 12 * R - fa], [W - M * (1 - 24 / ca), X - 24 * R - fa], [W, X]]; N.geometry = this._toPolygon(W, Q.x, Q.y); N.setGeometry(N.geometry); break; case K.LEFT_ARROW: this._hideTooltip(); W = 0 >= W ? [[W, 0],
                                                                                        [.75 * W, X], [.75 * W, .5 * X], [0, .5 * X], [0, -.5 * X], [.75 * W, -.5 * X], [.75 * W, -X], [W, 0]] : [[0, 0], [.25 * W, X], [.25 * W, .5 * X], [W, .5 * X], [W, -.5 * X], [.25 * W, -.5 * X], [.25 * W, -X], [0, 0]]; N.geometry = this._toPolygon(W, Q.x, Q.y); N.setGeometry(N.geometry); break; case K.RIGHT_ARROW: this._hideTooltip(); W = 0 <= W ? [[W, 0], [.75 * W, X], [.75 * W, .5 * X], [0, .5 * X], [0, -.5 * X], [.75 * W, -.5 * X], [.75 * W, -X], [W, 0]] : [[0, 0], [.25 * W, X], [.25 * W, .5 * X], [W, .5 * X], [W, -.5 * X], [.25 * W, -.5 * X], [.25 * W, -X], [0, 0]]; N.geometry = this._toPolygon(W, Q.x, Q.y); N.setGeometry(N.geometry); break;
                                                                                case K.UP_ARROW: this._hideTooltip(); W = 0 >= X ? [[0, X], [-W, .75 * X], [-.5 * W, .75 * X], [-.5 * W, 0], [.5 * W, 0], [.5 * W, .75 * X], [W, .75 * X], [0, X]] : [[0, 0], [-W, .25 * X], [-.5 * W, .25 * X], [-.5 * W, X], [.5 * W, X], [.5 * W, .25 * X], [W, .25 * X], [0, 0]]; N.geometry = this._toPolygon(W, Q.x, Q.y); N.setGeometry(N.geometry); break; case K.DOWN_ARROW: this._hideTooltip(); W = 0 <= X ? [[0, X], [-W, .75 * X], [-.5 * W, .75 * X], [-.5 * W, 0], [.5 * W, 0], [.5 * W, .75 * X], [W, .75 * X], [0, X]] : [[0, 0], [-W, .25 * X], [-.5 * W, .25 * X], [-.5 * W, X], [.5 * W, X], [.5 * W, .25 * X], [W, .25 * X], [0, 0]]; N.geometry = this._toPolygon(W,
                                                                                        Q.x, Q.y); N.setGeometry(N.geometry); break; case K.RECTANGLE: this._hideTooltip(); W = [[0, 0], [W, 0], [W, X], [0, X], [0, 0]]; N.geometry = this._toPolygon(W, Q.x, Q.y); N.setGeometry(N.geometry); break; case K.LINE: N.setGeometry(q.mixin(N.geometry, { paths: [[[T.x, T.y], [M.x, M.y]]] })); break; case K.EXTENT: N && R.graphics.remove(N, !0); N = new y(this._normalizeRect(T, M, ca)); N._originOnly = !0; this._graphic = R.graphics.add(new p(N, this.fillSymbol), !0); R.snappingManager && R.snappingManager._setGraphic(this._graphic); break; case K.FREEHAND_POLYLINE: this._hideTooltip();
                                                                                        if (!1 === this._canDrawFreehandPoint(I)) { r("esri-touch") && I.preventDefault(); return } this._points.push(I.mapPoint.offset(0, 0)); N.geometry._insertPoints([M.offset(0, 0)], 0); N.setGeometry(N.geometry); break; case K.FREEHAND_POLYGON: this._hideTooltip(); if (!1 === this._canDrawFreehandPoint(I)) { r("esri-touch") && I.preventDefault(); return } this._points.push(I.mapPoint.offset(0, 0)); N.geometry._insertPoints([M.offset(0, 0)], 0); N.setGeometry(N.geometry)
                                                                        }r("esri-touch") && I.preventDefault()
                                                        }
                                                }, _canDrawFreehandPoint: function (I) {
                                                        if (!this._oldPoint) return !1;
                                                        var N = this._oldPoint.x - I.screenPoint.x, T = this._oldPoint.y - I.screenPoint.y, M = this._options.tolerance; if ((0 > N ? -1 * N : N) < M && (0 > T ? -1 * T : T) < M) return !1; N = new Date; if (N - this._startTime < this._options.drawTime) return !1; this._startTime = N; this._oldPoint = I.screenPoint; return !0
                                                }, _onMouseUpHandler: function (I) {
                                                        if (this._dragged && this._graphic) {
                                                                0 === this._points.length && this._points.push(I.mapPoint.offset(0, 0)); if (this.map.snappingManager) var N = this.map.snappingManager._snappingPoint; var T = this._points[0]; N = N || I.mapPoint;
                                                                var M = this.map.spatialReference, R = H; switch (this._geometryType) {
                                                                        case R.CIRCLE: case R.ELLIPSE: case R.TRIANGLE: case R.ARROW: case R.LEFT_ARROW: case R.RIGHT_ARROW: case R.UP_ARROW: case R.DOWN_ARROW: case R.RECTANGLE: var ca = this._graphic.geometry; break; case R.LINE: ca = new u({ paths: [[[T.x, T.y], [N.x, N.y]]], spatialReference: M }); break; case R.EXTENT: ca = (new y(this._normalizeRect(T, N, M))).getExtent(); break; case R.FREEHAND_POLYLINE: ca = new u(M); ca.addPath([].concat(this._points, [N.offset(0, 0)])); break; case R.FREEHAND_POLYGON: ca =
                                                                                new z(M), T = [].concat(this._points, [N.offset(0, 0), this._points[0].offset(0, 0)]), z.prototype.isClockwise(T) || this.respectDrawingVertexOrder || (console.debug(this.declaredClass + " :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."), T.reverse()), ca.addRing(T)
                                                                }r("esri-touch") && I.preventDefault(); this._clear(); this._drawEnd(ca)
                                                        } else this._clear()
                                                }, _isPointToPointTool: function (I) { switch (I) { case H.POLYLINE: case H.POLYGON: case H.MULTI_POINT: return !0; default: return !1 } }, _onClickHandler: function (I) {
                                                        if (this.map.snappingManager) var N =
                                                                this.map.snappingManager._snappingPoint; N = N || I.mapPoint; I = this.map; var T = I.toScreen(N), M = H; if (this._isPointToPointTool(this._geometryType)) { var R = this._points[this._points.length - 1]; if (N && R && N.x === R.x && N.y === R.y) return; this._points.push(N.offset(0, 0)) } switch (this._geometryType) {
                                                                        case M.POINT: this.onDrawStart(); this._drawEnd(N.offset(0, 0)); this._setTooltipMessage(0); break; case M.POLYLINE: 1 === this._points.length ? (N = new u(I.spatialReference), N.addPath(this._points), this._graphic = I.graphics.add(new p(N,
                                                                                this.lineSymbol), !0), I.snappingManager && I.snappingManager._setGraphic(this._graphic, { snapToLastVertex: !1 }), this._onMouseMoveHandler_connect = w.connect(I, "onMouseMove", this._onMouseMoveHandler), this.onDrawStart()) : (this._graphic.geometry.setPoint(0, this._points.length - 1, N.offset(0, 0)), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol)); break; case M.POLYGON: 1 === this._points.length ? (N = new z(I.spatialReference), N.addRing(this._points), this._graphic = I.graphics.add(new p(N, this.fillSymbol),
                                                                                        !0), I.snappingManager && I.snappingManager._setGraphic(this._graphic, { snapToLastVertex: !1 }), this._onMouseMoveHandler_connect = w.connect(I, "onMouseMove", this._onMouseMoveHandler), this.onDrawStart()) : (this._graphic.geometry.setPoint(0, this._points.length - 1, N.offset(0, 0)), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol)); break; case M.MULTI_POINT: N = this._points; 1 === N.length ? (T = new x(I.spatialReference), T.addPoint(N[N.length - 1]), this._graphic = I.graphics.add(new p(T, this.markerSymbol),
                                                                                                !0), I.snappingManager && I.snappingManager._setGraphic(this._graphic), this.onDrawStart()) : (this._graphic.geometry.addPoint(N[N.length - 1]), this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol)); break; case M.ARROW: this._addShape([[0, 0], [-24, 24], [-24, 12], [-96, 12], [-96, -12], [-24, -12], [-24, -24], [0, 0]], T.x, T.y); break; case M.LEFT_ARROW: this._addShape([[0, 0], [24, 24], [24, 12], [96, 12], [96, -12], [24, -12], [24, -24], [0, 0]], T.x, T.y); break; case M.RIGHT_ARROW: this._addShape([[0, 0], [-24, 24], [-24,
                                                                                                        12], [-96, 12], [-96, -12], [-24, -12], [-24, -24], [0, 0]], T.x, T.y); break; case M.UP_ARROW: this._addShape([[0, 0], [-24, 24], [-12, 24], [-12, 96], [12, 96], [12, 24], [24, 24], [0, 0]], T.x, T.y); break; case M.DOWN_ARROW: this._addShape([[0, 0], [-24, -24], [-12, -24], [-12, -96], [12, -96], [12, -24], [24, -24], [0, 0]], T.x, T.y); break; case M.TRIANGLE: this._addShape([[0, -48], [41.56921938165306, 24], [-41.56921938165306, 24], [0, -48]], T.x, T.y); break; case M.RECTANGLE: this._addShape([[0, -96], [96, -96], [96, 0], [0, 0], [0, -96]], T.x - 48, T.y + 48); break; case M.CIRCLE: this._clear();
                                                                                this.onDrawStart(); this._drawEnd(z.createCircle({ center: T, r: 48, numberOfPoints: 60, map: I })); break; case M.ELLIPSE: this._clear(), this.onDrawStart(), this._drawEnd(z.createEllipse({ center: T, longAxis: 48, shortAxis: 24, numberOfPoints: 60, map: I }))
                                                                }this._setTooltipMessage(this._points.length)
                                                }, _addShape: function (I, N, T) { this._setTooltipMessage(0); this._clear(); this.onDrawStart(); this._drawEnd(this._toPolygon(I, N, T)) }, _toPolygon: function (I, N, T) {
                                                        var M = this.map, R = new z(M.spatialReference); R.addRing(A.map(I, function (ca) {
                                                                return M.toMap({
                                                                        x: ca[0] +
                                                                                N, y: ca[1] + T
                                                                })
                                                        })); return R
                                                }, _onDblClickHandler: function (I) {
                                                        var N = this._points, T = this.map.spatialReference, M = H; r("esri-touch") && N.push(I.mapPoint); var R = N[N.length - 1], ca = N[N.length - 2]; N = R && ca && R.x === ca.x && R.y === ca.y ? N.slice(0, N.length - 1) : N.slice(0, N.length); switch (this._geometryType) {
                                                                case M.POLYLINE: if (!this._graphic || 2 > N.length) { w.disconnect(this._onMouseMoveHandler_connect); this._clear(); this._onClickHandler(I); return } var K = new u(T); K.addPath([].concat(N)); break; case M.POLYGON: if (!this._graphic ||
                                                                        3 > N.length) return; K = new z(T); I = [].concat(N, [N[0].offset(0, 0)]); z.prototype.isClockwise(I) || this.respectDrawingVertexOrder || (console.debug(this.declaredClass + " :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."), I.reverse()); K.addRing(I); break; case M.MULTI_POINT: K = new x(T), A.forEach(N, function (Q) { K.addPoint(Q) })
                                                        }w.disconnect(this._onMouseMoveHandler_connect); this._clear(); this._setTooltipMessage(0); this._drawEnd(K)
                                                }, _onKeyDownHandler: function (I) {
                                                        I.keyCode === k.ESCAPE &&
                                                        (w.disconnect(this._onMouseMoveHandler_connect), this._clear(), this._setTooltipMessage(0))
                                                }, _toggleTooltip: function (I) {
                                                        this._options.showTooltips && (I ? this._tooltip || (this._tooltip = n.create("div", { "class": "esriMapTooltip" }, this.map.container), c.isBodyLtr() || d.set(this._tooltip, "direction", "rtl"), this._tooltip.style.display = "none", this._tooltip.style.position = "fixed", this._setTooltipMessage(0), this._onTooltipMouseEnterHandler_connect = w.connect(this.map, "onMouseOver", this._updateTooltip), this._onTooltipMouseLeaveHandler_connect =
                                                                w.connect(this.map, "onMouseOut", this._hideTooltip), this._onTooltipMouseMoveHandler_connect = w.connect(this.map, "onMouseMove", this._updateTooltip)) : this._tooltip && (w.disconnect(this._onTooltipMouseEnterHandler_connect), w.disconnect(this._onTooltipMouseLeaveHandler_connect), w.disconnect(this._onTooltipMouseMoveHandler_connect), n.destroy(this._tooltip), this._tooltip = null))
                                                }, _hideTooltip: function () { var I = this._tooltip; I && (I.style.display = "none") }, _setTooltipMessage: function (I) {
                                                        var N = this._tooltip; if (N) {
                                                                var T =
                                                                        ""; switch (this._geometryType) {
                                                                                case H.POINT: T = D.toolbars.draw.addPoint; break; case H.ARROW: case H.LEFT_ARROW: case H.RIGHT_ARROW: case H.UP_ARROW: case H.DOWN_ARROW: case H.TRIANGLE: case H.RECTANGLE: case H.CIRCLE: case H.ELLIPSE: T = D.toolbars.draw.addShape; break; case H.LINE: case H.EXTENT: case H.FREEHAND_POLYLINE: case H.FREEHAND_POLYGON: T = D.toolbars.draw.freehand; break; case H.POLYLINE: case H.POLYGON: T = D.toolbars.draw.start; 1 === I ? T = D.toolbars.draw.resume : 2 <= I && (T = D.toolbars.draw.complete); break; case H.MULTI_POINT: T =
                                                                                        D.toolbars.draw.addMultipoint, 1 <= I && (T = D.toolbars.draw.finish)
                                                                        }N.innerHTML = T
                                                        }
                                                }, _updateTooltip: function (I) { var N = this._tooltip; if (N) { if (I.clientX || I.pageY) { var T = I.clientX; I = I.clientY } else T = I.clientX + v.body().scrollLeft - v.body().clientLeft, I = I.clientY + v.body().scrollTop - v.body().clientTop; N.style.display = "none"; d.set(N, { left: T + this._options.tooltipOffset + "px", top: I + "px" }); N.style.display = "" } }, _redrawGraphic: function (I, N, T, M) { (T || this.map.wrapAround180) && (I = this._graphic) && I.setGeometry(I.geometry) },
                                                onActivate: function () { }, onDeactivate: function () { }, onDrawComplete: function () { }, onDrawStart: function () { }, onDrawEnd: function () { }
                                        }); q.mixin(H, { POINT: "point", MULTI_POINT: "multipoint", LINE: "line", EXTENT: "extent", POLYLINE: "polyline", POLYGON: "polygon", FREEHAND_POLYLINE: "freehandpolyline", FREEHAND_POLYGON: "freehandpolygon", ARROW: "arrow", LEFT_ARROW: "leftarrow", RIGHT_ARROW: "rightarrow", UP_ARROW: "uparrow", DOWN_ARROW: "downarrow", TRIANGLE: "triangle", CIRCLE: "circle", ELLIPSE: "ellipse", RECTANGLE: "rectangle" }); r("extend-esri") &&
                                                q.setObject("toolbars.Draw", H, g); return H
                                })
                }, "esri/toolbars/_toolbar": function () {
                        define(["dojo/_base/declare", "dojo/_base/lang", "dojo/has", "../kernel", "../Evented"], function (E, q, A, w, m) {
                                E = E([m], {
                                        declaredClass: "esri.toolbars._Toolbar", constructor: function (v) { this.map = v }, _cursors: { move: "pointer", "move-v": "pointer", "move-gv": "pointer", box0: "nw-resize", box1: "n-resize", box2: "ne-resize", box3: "e-resize", box4: "se-resize", box5: "s-resize", box6: "sw-resize", box7: "w-resize", box8: "pointer" }, _deactivateMapTools: function (v,
                                                r, l, k) { var n = this.map; v && (this._mapNavState = { isDoubleClickZoom: n.isDoubleClickZoom, isClickRecenter: n.isClickRecenter, isPan: n.isPan, isRubberBandZoom: n.isRubberBandZoom, isKeyboardNavigation: n.isKeyboardNavigation, isScrollWheelZoom: n.isScrollWheelZoom }, n.disableDoubleClickZoom(), n.disableClickRecenter(), n.disablePan(), n.disableRubberBandZoom(), n.disableKeyboardNavigation()); r && n.hideZoomSlider(); l && n.hidePanArrows(); k && n.graphics.disableMouseEvents() }, _activateMapTools: function (v, r, l, k) {
                                                        var n = this.map,
                                                        d = this._mapNavState; v && d && (d.isDoubleClickZoom && n.enableDoubleClickZoom(), d.isClickRecenter && n.enableClickRecenter(), d.isPan && n.enablePan(), d.isRubberBandZoom && n.enableRubberBandZoom(), d.isKeyboardNavigation && n.enableKeyboardNavigation(), d.isScrollWheelZoom && n.enableScrollWheelZoom()); r && n.showZoomSlider(); l && n.showPanArrows(); k && n.graphics.enableMouseEvents()
                                                }, _deactivateScrollWheel: function () {
                                                        var v = this.map; this._scrollWheelState = { isScrollWheelZoom: v.isScrollWheelZoom, isScrollWheelPan: v.isScrollWheelPan };
                                                        v.disableScrollWheelZoom(); v.disableScrollWheelPan()
                                                }, _activateScrollWheel: function () { var v = this.map, r = this._scrollWheelState; r && (r.isScrollWheelZoom && v.enableScrollWheelZoom(), r.isScrollWheelPan && v.enableScrollWheelPan()) }
                                }); A("extend-esri") && q.setObject("toolbars._Toolbar", E, w); return E
                        })
                }, "jimu/dijit/URLInput": function () {
                        define(["dojo/_base/declare", "dojo/_base/html", "dijit/form/ValidationTextBox", "dojox/validate/regexp"], function (E, q, A, w) {
                                return E([A], {
                                        declaredClass: "jimu.dijit.URLInput", required: !0,
                                        invalidMessage: "Invalid url.", trim: !0, rest: !0, allowNamed: !0, allowLocal: !0, postMixInProperties: function () { this.inherited(arguments); this.invalidMessage = (this.nls = window.jimuNls.urlInput) ? this.nls.invalidUrl : "Invalid Url" }, postCreate: function () { this.inherited(arguments); q.addClass(this.domNode, "jimu-url-input") }, validator: function (m) {
                                                if (!1 === this.required && "" === m) return !0; if (isFinite(m)) return !1; var v = "^" + w.url({ allowNamed: this.allowNamed, allowLocal: this.allowLocal }); v = new RegExp(v, "g"); v.lastIndex =
                                                        0; v = v.test(m); return this.rest ? (m = /\/rest\/services/gi.test(m), v && m) : v
                                        }
                                })
                        })
                }, "dojox/validate/regexp": function () {
                        define(["dojo/_base/lang", "dojo/regexp", "dojox/main"], function (E, q, A) {
                                var w = E.getObject("validate.regexp", !0, A); return w = A.validate.regexp = {
                                        ipAddress: function (m) {
                                                m = "object" == typeof m ? m : {}; "boolean" != typeof m.allowDottedDecimal && (m.allowDottedDecimal = !0); "boolean" != typeof m.allowDottedHex && (m.allowDottedHex = !0); "boolean" != typeof m.allowDottedOctal && (m.allowDottedOctal = !0); "boolean" != typeof m.allowDecimal &&
                                                        (m.allowDecimal = !0); "boolean" != typeof m.allowHex && (m.allowHex = !0); "boolean" != typeof m.allowIPv6 && (m.allowIPv6 = !0); "boolean" != typeof m.allowHybrid && (m.allowHybrid = !0); var v = []; m.allowDottedDecimal && v.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])"); m.allowDottedHex && v.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]"); m.allowDottedOctal && v.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]"); m.allowDecimal && v.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
                                                m.allowHex && v.push("0[xX]0*[\\da-fA-F]{1,8}"); m.allowIPv6 && v.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}"); m.allowHybrid && v.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])"); m = ""; 0 < v.length && (m = "(" + v.join("|") + ")"); return m
                                        }, host: function (m) {
                                                m = "object" == typeof m ? m : {}; "boolean" != typeof m.allowIP && (m.allowIP = !0); "boolean" != typeof m.allowLocal && (m.allowLocal = !1); "boolean" != typeof m.allowPort && (m.allowPort = !0); "boolean" != typeof m.allowNamed &&
                                                        (m.allowNamed = !1); var v = m.allowPort ? "(\\:\\d+)?" : "", r = "((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.?)"; m.allowIP && (r += "|" + w.ipAddress(m)); m.allowLocal && (r += "|localhost"); m.allowNamed && (r += "|^[^-][a-zA-Z0-9_-]*"); return "(" + r + ")" + v
                                        }, url: function (m) { m = "object" == typeof m ? m : {}; "scheme" in m || (m.scheme = [!0, !1]); return q.buildGroupRE(m.scheme, function (v) { return v ? "(https?|ftps?)\\://" : "" }) + w.host(m) + "(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?" },
                                        emailAddress: function (m) { m = "object" == typeof m ? m : {}; "boolean" != typeof m.allowCruft && (m.allowCruft = !1); m.allowPort = !1; var v = "([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@" + w.host(m); m.allowCruft && (v = "\x3c?(mailto\\:)?" + v + "\x3e?"); return v }, emailAddressList: function (m) { m = "object" == typeof m ? m : {}; "string" != typeof m.listSeparator && (m.listSeparator = "\\s;,"); var v = w.emailAddress(m); return "(" + v + "\\s*[" + m.listSeparator + "]\\s*)*" + v + "\\s*[" + m.listSeparator + "]?\\s*" }, numberFormat: function (m) {
                                                m =
                                                "object" == typeof m ? m : {}; "undefined" == typeof m.format && (m.format = "###-###-####"); return q.buildGroupRE(m.format, function (v) { return q.escapeString(v, "?").replace(/\?/g, "\\d?").replace(/#/g, "\\d") })
                                        }, ca: { postalCode: function () { return "([A-Z][0-9][A-Z] [0-9][A-Z][0-9])" }, province: function () { return "(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)" } }, us: {
                                                state: function (m) {
                                                        m = "object" == typeof m ? m : {}; "boolean" != typeof m.allowTerritories && (m.allowTerritories = !0); "boolean" != typeof m.allowMilitary && (m.allowMilitary = !0);
                                                        var v = "AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY"; m.allowTerritories && (v += "|AS|FM|GU|MH|MP|PW|PR|VI"); m.allowMilitary && (v += "|AA|AE|AP"); return "(" + v + ")"
                                                }
                                        }
                                }
                        })
                }, "jimu/dijit/ColorPalette": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dojo/query jimu/dijit/ColorChooser jimu/dijit/CustomColorPicker jimu/dijit/ColorRecords dijit/popup jimu/utils dijit/a11yclick".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a) {
                                        return q([A, m, w, E], {
                                                templateString: "\x3cdiv\x3e\x3c/div\x3e", baseClass: "jimu-color-palette", declaredClass: "jimu.dijit.ColorPalette", _TRANSPARENT_STR: "rgba(0, 0, 0, 0)", value: "", _defaultAppearance: { showTransparent: !0, showColorPalette: !0, showCoustom: !0, showColorPickerOK: !1, showColorPickerApply: !0, showCoustomRecord: !0, closeDialogWhenChange: !1 }, recordUID: "", postMixInProperties: function () { this.nls = window.jimuNls.colorPalette }, postCreate: function () {
                                                        this.inherited(arguments);
                                                        this.value = this.value ? new k(this.value) : new k("#fff"); this._createContent()
                                                }, initUI: function () { this._toggleCustomColorPicker("init", !1) }, _createContent: function () {
                                                        this.appearance = v.mixin(this._defaultAppearance, this.appearance); var f = r.create("div", { "class": "jimu-colorpalette" }, this.domNode); this.initPanel = r.create("div", { "class": "init-panel" }, f); this.customPanel = r.create("div", { "class": "custom-panel hide" }, f); this.appearance.showTransparent && this._createSpecialColors(this.initPanel); this.appearance.showColorPalette &&
                                                                this._createColorChooser(this.initPanel); this.appearance.showCoustom && this._createCustomColorPicker(this.initPanel); this.appearance.showCoustom && this.appearance.showCoustomRecord && this._createCoustomRecord(this.initPanel)
                                                }, setColor: function (f) {
                                                        this._isColorEqual(f) || (this.value = new k(f), this._setSpatialColor(this.value), "undefined" !== typeof this.value.a && 0 === this.value.a ? (this.colorChooser.setColor(new k("transparent"), !1), this.picker.setColor(new k("#fff"), !1)) : (this.colorChooser.setColor(this.value.toHex(),
                                                                !1), this.picker.setColor(this.value, !1)), this.colorRecords && this.colorRecords.selecteColor(this.value))
                                                }, getColor: function () { return this.value }, changeColor: function (f) { if ("undefined" !== typeof this.value.a && 0 === this.value.a) this.onChange(this.value); else this.onChange(this.value.toHex()); this.emit("change", this.value); !0 === this.appearance.closeDialogWhenChange && !1 !== f && this._closeDialog() }, refreshRecords: function () { this.colorRecords && this.colorRecords.refresh() }, destroy: function () {
                                                        b.close(this.tooltipDialog);
                                                        this.picker.destroy(); this.inherited(arguments)
                                                }, _createSpecialColors: function (f) { f = r.create("div", { "class": "special-color" }, f); this.transparentBtn = r.create("div", { "class": "transparent btn", innerHTML: '\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"transparent icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"transparent text jimu-float-leading"\x3e' + this.nls.transparent + "\x3c/div\x3e\x3c/div\x3e" }, f); this.own(l(this.transparentBtn, a, v.hitch(this, this._onTransparentClick))) }, _onTransparentClick: function () {
                                                        this.setColor(new k("transparent"));
                                                        this.changeColor()
                                                }, _setSpatialColor: function (f) { if (this.transparentBtn) { var h = n(".btn-wapper", this.transparentBtn)[0]; r.removeClass(h, "selected"); f && f.toString && f.toString() === this._TRANSPARENT_STR && r.addClass(h, "selected") } }, _createColorChooser: function (f) { this.colorChooser = new d({}); this.colorChooser.placeAt(f); this.own(l(this.colorChooser, "change", v.hitch(this, function (h) { h = new k(h); this.setColor(h); this.changeColor() }))) }, _createCustomColorPicker: function () {
                                                        this.coustomtBtn = r.create("div", {
                                                                "class": "coustom btn",
                                                                innerHTML: '\x3cdiv class\x3d"btn-wapper"\x3e\x3cdiv class\x3d"custom icon jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"custom text jimu-float-leading"\x3e' + this.nls.custom + "\x3c/div\x3e\x3c/div\x3e"
                                                        }, this.initPanel); this.own(l(this.coustomtBtn, "click", v.hitch(this, function () { this._toggleCustomColorPicker("custom") }))); this.picker = new c({ showOk: this.appearance.showColorPickerOK, showApply: this.appearance.showColorPickerApply, value: this.value.toHex() }); this.picker.placeAt(this.customPanel); this.picker.setColor(this.value);
                                                        this.own(l(this.picker, "ok", v.hitch(this, function (f) { this.setColor(new k(f)); this.changeColor(); this._addAColorRecord(f); this._toggleCustomColorPicker("init"); this._closeDialog() }))); this.own(l(this.picker, "apply", v.hitch(this, function (f) { this.setColor(new k(f)); this.changeColor(!1); this._addAColorRecord(f) }))); this.own(l(this.picker, "cancel", v.hitch(this, function () { this._toggleCustomColorPicker("init"); this._closeDialog() })))
                                                }, _toggleCustomColorPicker: function (f, h) {
                                                        "custom" === f ? (r.removeClass(this.customPanel,
                                                                "hide"), r.addClass(this.initPanel, "hide")) : (r.addClass(this.customPanel, "hide"), r.removeClass(this.initPanel, "hide")); "undefined" !== typeof h && !1 === h || this.emit("change-style")
                                                }, _createCoustomRecord: function (f) { this.colorRecords = new g({ recordsLength: 10, uid: this.recordUID || "" }); this.colorRecords.placeAt(f); this.own(l(this.colorRecords, "choose", v.hitch(this, function (h) { this.setColor(new k(h)); this.changeColor() }))) }, _addAColorRecord: function (f) { this.colorRecords && this.colorRecords.push && this.colorRecords.push(f) },
                                                _isColorEqual: function (f) { return this.value.toString() === (new k(f)).toString() ? !0 : !1 }, _changeLabel: function (f) { r.empty(this.domNode); r.create("span", { innerHTML: f.toHex(), className: "color-label", style: { color: e.invertColor(f.toHex()) } }, this.domNode) }, onOpen: function () { this.openDialog() }, openDialog: function () { this.initUI() }, _closeDialog: function () { this.emit("close") }, onClose: function () { this._closeDialog() }
                                        })
                                })
                }, "jimu/dijit/ColorChooser": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/i18n dojo/_base/Color dijit/a11yclick dojo/i18n!dojo/nls/colors".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                        return q([A, w, m, E], {
                                                templateString: '\x3cdiv\x3e\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\x3ctable class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e', baseClass: "jimu-color-chooser", declaredClass: "jimu.dijit.ColorChooser", uid: "", colorsArray: ["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),
                                                "lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "), "silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "), "gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "), "dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "), "darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),
                                                "rgb(0,0,1) darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")], postCreate: function () { this.inherited(arguments); this.colorTitleNls = n.getLocalization("dojo", "colors"); this._createColorsBlocks() }, _createColorsBlocks: function () {
                                                        this._row = this.colorsArray.length; this._col = this.colorsArray[0].length; for (var g = 0; g < this._row; g++)for (var b = r.create("tr", { role: "row" }, this.gridNode), e = 0; e < this._col; e++) {
                                                                var a = this.colorsArray[g][e], f = d.named[a], h = ""; f ? h = a : "rgb(0,0,1)" ===
                                                                        a && (h = "black", f = "rgb(0,0,1)"); a = this.colorTitleNls[h]; f = (new d(f)).toString(); this["record" + e] = r.create("td", { "class": "dijitPaletteCell", "data-title": f, role: "gridcell" }, b); var p = r.create("span", { "class": "dijitInline dijitPaletteImg" }, this["record" + e]); r.create("img", { "class": "dijitColorPaletteSwatch", src: require.toUrl("dojo/resources/blank.gif"), alt: a, title: a, "data-title": h, width: "16px", height: "16px", style: "background-color: " + f }, p)
                                                        } this.own(l(this.gridNode, c, v.hitch(this, this.onColorClick)))
                                                }, onColorClick: function (g) {
                                                        for (var b =
                                                                g.target; "TD" !== b.tagName;) { if (!b.parentNode || b === this.gridNode) return; b = b.parentNode } b = r.getAttr(b, "data-title"); b = (new d(b)).toString(); this.setColor(b); g.stopPropagation(); g.preventDefault()
                                                }, _onChange: function (g) { this.emit("change", g) }, setColor: function (g, b) {
                                                        g = new d(g); for (var e = null, a = k("td", this.domNode), f = 0, h = a.length; f < h; f++)r.removeClass(a[f], "dijitPaletteCellSelected"); f = 0; for (h = a.length; f < h; f++)if (g.toString() === r.getAttr(a[f], "data-title")) { e = a[f]; break } e && r.addClass(e, "dijitPaletteCellSelected");
                                                        (e && "undefined" === typeof b || !0 === b) && this._onChange(g)
                                                }
                                        })
                                })
                }, "jimu/dijit/CustomColorPicker": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color jimu/dijit/ColorSelector".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                return q([A, w, E], {
                                        baseClass: "jimu-color-picker", declaredClass: "jimu.dijit.ColorPicker", templateString: "\x3cdiv\x3e\x3c/div\x3e", _isTooltipDialogOpened: !1, color: null, showHex: !0, showHsv: !0, showRgb: !0,
                                        ensureMode: !1, showLabel: !1, postMixInProperties: function () { this.nls = window.jimuNls.common }, postCreate: function () { this.inherited(arguments); this.color ? this.color instanceof l || (this.color = new l(this.color)) : this.color = new l("#ccc"); v.setStyle(this.domNode, "backgroundColor", this.color.toHex()); this._createDialog(this.domNode) }, destroy: function () { this.picker.destroy(); this.inherited(arguments) }, _handlerOk: function (n) {
                                                n && n.stopPropagation && n.preventDefault && (n.stopPropagation(), n.preventDefault()); this.emit("ok",
                                                        this.color)
                                        }, _handlerApply: function (n) { n && n.stopPropagation && n.preventDefault && (n.stopPropagation(), n.preventDefault()); this.emit("apply", this.color) }, _handlerCancel: function (n) { n && n.stopPropagation && n.preventDefault && (n.stopPropagation(), n.preventDefault()); this.emit("cancel") }, _createDialog: function () {
                                                var n = v.create("div", { "class": "dojox-color-picker-container" }, this.domNode), d = new k({
                                                        showHex: this.showHex, showRgb: this.showRgb, showHsv: this.showHsv, value: this.color.toHex(), onChange: m.hitch(this, function (g) {
                                                                g =
                                                                new l(g); this.setColor(g)
                                                        })
                                                }); d.placeAt(n); d.startup(); n = v.create("div", { "class": "btns-container jimu-float-trailing" }, n); if (!0 === this.showOk) { var c = v.create("div", { "class": "jimu-btn jimu-float-leading ok", title: this.nls.ok, innerHTML: this.nls.ok }, n); this.own(r(c, "click", m.hitch(this, function (g) { var b = this.picker.get("value"); this.setColor(new l(b)); this._handlerOk(g) }))) } !0 === this.showApply && (c = v.create("div", { "class": "jimu-btn jimu-float-leading apply", title: this.nls.apply, innerHTML: this.nls.apply },
                                                        n), this.own(r(c, "click", m.hitch(this, function (g) { var b = this.picker.get("value"); this.setColor(new l(b)); this._handlerApply(g) })))); n = v.create("div", { "class": "jimu-btn jimu-btn-vacation jimu-float-leading", title: this.nls.cancel, innerHTML: this.nls.cancel }, n); this.own(r(n, "click", m.hitch(this, function (g) { this._handlerCancel(g) }))); this.picker = d
                                        }, setColor: function (n) { if (n instanceof l) { var d = this.color, c = ""; d && (c = d.toHex()); d = n.toHex(); this.color = n; c !== d && this.picker.set("value", d) } }, getColor: function () { return this.color },
                                        onClose: function () { }
                                })
                        })
                }, "jimu/dijit/ColorRecords": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/on dojo/query dojo/_base/Color dojo/cookie dojo/text!./templates/ColorRecords.html dijit/a11yclick".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                return q([A, w, m, E], {
                                        templateString: c, baseClass: "jimu-color-records", declaredClass: "jimu.dijit.ColorRecords", uid: "", recordsLength: 10, colorList: null,
                                        postCreate: function () { this.inherited(arguments); this.colorList = []; this._createCoustomRecord(); "" === this.uid && (this.uid = "wab_colorRecords"); this.refresh() }, push: function (b) { this.colorList.unshift(b); this.colorList.length > this.recordsLength && this.colorList.pop(); this._setColors() }, selecteColor: function (b) {
                                                b = new n(b); for (var e = null, a = k("td", this.domNode), f = 0, h = a.length; f < h; f++)r.removeClass(a[f], "dijitPaletteCellSelected"); f = 0; for (h = a.length; f < h; f++)if (b.toString() === r.getAttr(a[f], "title")) {
                                                        e = a[f];
                                                        break
                                                } e && (r.addClass(e, "dijitPaletteCellSelected"), this.onChoose(b))
                                        }, refresh: function () { this._getCookie(this.uid); this._setColors() }, _setColors: function () { for (var b = 0; b < this.recordsLength; b++) { var e = this["record" + b]; if (e && this.colorList[b] && this.colorList[b].toString) { var a = this.colorList[b].toString(); r.setAttr(e, "title", a); e = this._findImg(e); r.setStyle(e, "background-color", a); r.setAttr(e, "alt", a); r.setAttr(e, "title", a) } } this._setCookie(this.uid) }, _createCoustomRecord: function () {
                                                for (var b = 0; b < this.recordsLength; b++) {
                                                        this["record" +
                                                        b] = r.create("td", { "class": "dijitPaletteCell", tabindex: b, title: "", role: "gridcell" }, this.container); var e = r.create("span", { "class": "dijitInline dijitPaletteImg" }, this["record" + b]); r.create("img", { "class": "dijitColorPaletteSwatch", src: require.toUrl("dojo/resources/blank.gif"), style: "background-color: #ffffff" }, e)
                                                } this.own(l(this.gridNode, g, v.hitch(this, this.onRecordClick)))
                                        }, onRecordClick: function (b) {
                                                for (var e = b.target; "TD" !== e.tagName;) { if (!e.parentNode || e === this.gridNode) return; e = e.parentNode } e = r.getAttr(e,
                                                        "title"); e = (new n(e)).toString(); this.onChoose(e); b.stopPropagation(); b.preventDefault()
                                        }, onChoose: function (b) { this.emit("choose", b) }, _findImg: function (b) { var e = null; return b.nodeName && "IMG" === b.nodeName.toUpperCase() ? b : e = k(".dijitColorPaletteSwatch", b)[0] }, _setCookie: function (b) {
                                                for (var e = [], a = 0, f = this.recordsLength; a < f; a++) { var h = this.colorList[a]; h && h.toString && (e[a] = h.toString()) } this._cleanCookie(b); try { var p = JSON.stringify(e); d(b, p, { expires: 1E3, path: "/" }) } catch (B) {
                                                        console.error("ColorRecords: cookieList JSON.stringify error." +
                                                                B.stack)
                                                }
                                        }, _getCookie: function (b) { b = d(b); if ("undefined" !== typeof b) try { var e = JSON.parse(b); if (e && "undefined" !== typeof e.length) { b = 0; for (var a = this.recordsLength; b < a; b++) { var f = e[b]; f && f.toString && (this.colorList[b] = new n(f.toString())) } } } catch (h) { console.error("ColorRecords: cookieList JSON.parse error." + h.stack) } }, _cleanCookie: function (b) { d(b, null, { expires: -1 }) }
                                })
                        })
                }, "jimu/OnScreenWidgetPanel": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dnd/move dijit/_TemplatedMixin jimu/BaseWidgetPanel jimu/utils dojox/layout/ResizeHandle ./a11y/OnScreenWidgetPanel dojo/touch".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        E = E([r, v], {
                                                baseClass: "jimu-panel jimu-on-screen-widget-panel jimu-main-background", _positionInfoBox: null, _originalBox: null, widgetIcon: null, _resizeOnOpen: !0, templateString: '\x3cdiv data-dojo-attach-point\x3d"boxNode" role\x3d"dialog" aria-label\x3d"${label}"\x3e\x3cdiv class\x3d"jimu-panel-title jimu-main-background" data-dojo-attach-point\x3d"titleNode"\x3e\x3ch2 class\x3d"title-label jimu-vcenter-text jimu-float-leading jimu-leading-padding1"data-dojo-attach-point\x3d"titleLabelNode" tabindex\x3d"-1" data-dojo-attach-event\x3d"onkeydown:_onTitleLabelKeyDown"\x3e${label}\x3c/h2\x3e\x3cdiv class\x3d"btns-container"\x3e\x3cdiv tabindex\x3d"0" class\x3d"foldable-btn jimu-vcenter" aria-label\x3d"${headerNls.foldWindow}" role\x3d"button"data-dojo-attach-point\x3d"foldableNode"data-dojo-attach-event\x3d"onclick:_onFoldableBtnClicked,onkeydown:_onFoldableBtnKeyDown"\x3e\x3c/div\x3e\x3cdiv tabindex\x3d"0" class\x3d"max-btn jimu-vcenter" aria-label\x3d"${headerNls.maxWindow}" role\x3d"button"data-dojo-attach-point\x3d"maxNode"data-dojo-attach-event\x3d"onclick:_onMaxBtnClicked,onkeydown:_onMaxBtnKeyDown"\x3e\x3c/div\x3e\x3cdiv tabindex\x3d"0" class\x3d"close-btn jimu-vcenter" aria-label\x3d"${headerNls.closeWindow}" role\x3d"button"data-dojo-attach-point\x3d"closeNode"data-dojo-attach-event\x3d"onclick:_onCloseBtnClicked,onkeydown:_onCloseBtnKey"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-panel-content" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
                                                postMixInProperties: function () { this.headerNls = window.jimuNls.panelHeader }, postCreate: function () { this._originalBox = { w: 400, h: 410 } }, startup: function () { this.inherited(arguments); this._normalizePositionObj(this.position); this._makeOriginalBox(); this.makePositionInfoBox(); this.makeMoveable(this._positionInfoBox.w, .25 * this._positionInfoBox.w); this.a11y_init() }, _onMaxBtnClicked: function (d) {
                                                        d.stopPropagation(); this._getPositionInfo().isRunInMobile && ("maximized" === this.windowState ? (A.setAttr(this.maxNode, "aria-label",
                                                                this.headerNls.maxWindow), this.panelManager.normalizePanel(this)) : (A.setAttr(this.maxNode, "aria-label", this.headerNls.restoreWindow), this.panelManager.maximizePanel(this), A.removeClass(this.foldableNode, "fold-up"), A.addClass(this.foldableNode, "fold-down"), A.setAttr(this.foldableNode, "aria-label", this.headerNls.foldWindow)), this._setMobilePosition()); this.panelManager.activatePanel(this)
                                                }, _onFoldableBtnClicked: function (d) {
                                                        d && d.stopPropagation(); this._getPositionInfo().isRunInMobile && ("minimized" ===
                                                                this.windowState ? (A.removeClass(this.foldableNode, "fold-up"), A.addClass(this.foldableNode, "fold-down"), A.setAttr(this.foldableNode, "aria-label", this.headerNls.foldWindow), this.panelManager.normalizePanel(this)) : (A.removeClass(this.foldableNode, "fold-down"), A.addClass(this.foldableNode, "fold-up"), A.setAttr(this.foldableNode, "aria-label", this.headerNls.unfoldWindow), this.panelManager.minimizePanel(this)), A.setAttr(this.maxNode, "aria-label", this.headerNls.maxWindow), this._setMobilePosition())
                                                }, _onCloseBtnClicked: function (d) {
                                                        d.preventDefault();
                                                        d.stopPropagation(); this.panelManager.closePanel(this)
                                                }, _normalizePositionObj: function (d) { var c = this._getLayoutBox(); d.left = isFinite(d.left) ? d.left : c.w - d.right; d.top = isFinite(d.top) ? d.top : c.h - d.bottom; delete d.right; delete d.bottom; this.position = q.mixin(q.clone(this.position), d) }, makePositionInfoBox: function () { this._positionInfoBox = { w: this.position.width || 400, h: this.position.height || 410, l: this.position.left || 0, t: this.position.top || 0 } }, _makeOriginalBox: function () {
                                                        this._originalBox = {
                                                                w: this.position.width ||
                                                                        400, h: this.position.height || 410, l: this.position.left || 0, t: this.position.top || 0
                                                        }
                                                }, makeResizable: function () { this.disableResizable(); this.resizeHandle = (new k({ targetId: this, minWidth: this._originalBox.w, minHeight: this._originalBox.h, activeResize: !1 })).placeAt(this.domNode); this.resizeHandle.startup() }, disableResizable: function () { this.resizeHandle && (this.resizeHandle.destroy(), this.resizeHandle = null) }, makeMoveable: function (d, c) {
                                                        this.disableMoveable(); var g = A.getMarginBox(jimuConfig.layoutId); g.l = g.l - d +
                                                                c; g.w += 2 * (d - c); this.moveable = new m.boxConstrainedMoveable(this.domNode, { box: g, handle: this.titleNode, within: !0 }); this.own(w(this.moveable, "Moving", q.hitch(this, this.onMoving))); this.own(w(this.moveable, "MoveStop", q.hitch(this, this.onMoveStop)))
                                                }, disableMoveable: function () { this.moveable && (this.moveable.destroy(), this.moveable = null) }, createHandleNode: function () { return this.titleNode }, onOpen: function () {
                                                        this._resizeOnOpen && (this.resize(), this._resizeOnOpen = !1); window.appInfo.isRunInMobile && (this._setMobilePosition(),
                                                                l.isInNavMode() && "minimized" === this.windowState && this._onFoldableBtnClicked()); this.inherited(arguments)
                                                }, _switchToMobileUI: function () {
                                                        A.removeClass(this.titleNode, "title-normal"); A.addClass(this.titleNode, "title-full"); A.setStyle(this.foldableNode, "display", "block"); A.setStyle(this.maxNode, "display", "block"); "normal" === this.windowState ? (A.removeClass(this.foldableNode, "fold-up"), A.addClass(this.foldableNode, "fold-down"), A.setAttr(this.foldableNode, "aria-label", this.headerNls.foldWindow)) : (A.removeClass(this.foldableNode,
                                                                "fold-down"), A.addClass(this.foldableNode, "fold-up"), A.setAttr(this.foldableNode, "aria-label", this.headerNls.unfoldWindow))
                                                }, _switchToDesktopUI: function () { A.removeClass(this.titleNode, "title-full"); A.addClass(this.titleNode, "title-normal"); A.setStyle(this.foldableNode, "display", "none"); A.setStyle(this.maxNode, "display", "none") }, resize: function (d) {
                                                        var c = this._getPositionInfo(), g = { left: c.position.left, top: c.position.top, width: this._positionInfoBox.w, height: this._positionInfoBox.h }; d && (d.t = this.domNode.offsetTop,
                                                                g.left = isFinite(d.l) ? d.l : g.left, g.top = isFinite(d.t) ? d.t : g.top, g.width = isFinite(d.w) ? d.w : g.width, g.height = isFinite(d.h) ? d.h : g.height, this._normalizePositionObj(q.clone(g)), this.makePositionInfoBox(), g.width = this._positionInfoBox.w, g.height = this._positionInfoBox.h); c.position = g; this._onResponsible(c); this.inherited(arguments)
                                                }, _onResponsible: function (d) {
                                                        d.isRunInMobile ? (this._setMobilePosition(), this.disableMoveable(), this.disableResizable(), this._switchToMobileUI()) : (this._setDesktopPosition(d.position),
                                                                this.makeResizable(), this.makeMoveable(this._positionInfoBox.w, .25 * this._positionInfoBox.w), this._switchToDesktopUI())
                                                }, setPosition: function (d) { this._normalizePositionObj(d); this.makePositionInfoBox(); d = this._getPositionInfo(); this._onResponsible(d) }, destroy: function () { this.widgetIcon = null; this.inherited(arguments) }, _getLayoutBox: function () { var d = jimuConfig.layoutId; d = "map" === this.position.relativeTo ? jimuConfig.mapId : jimuConfig.layoutId; return A.getMarginBox(d) }, _getPositionInfo: function () {
                                                        var d =
                                                                { isRunInMobile: !1, position: { left: 0, top: 5 } }, c = this._getLayoutBox(), g = this._positionInfoBox.l; if (window.appInfo.isRunInMobile) return d.isRunInMobile = !0, d; window.isRTL ? (d.position.left = c.w - g, d.position.left + this._positionInfoBox.w > c.w && (d.position.left -= this._positionInfoBox.w, 0 > d.position.left && (d.position.left = c.w - this._positionInfoBox.w))) : (d.position.left = g, d.position.left + this._positionInfoBox.w > c.w && (d.position.left = c.w > this._positionInfoBox.w ? c.w - this._positionInfoBox.w : 0)); g = this._positionInfoBox.t;
                                                        c = c.h - g; g >= c ? g >= this._positionInfoBox.h && (d.position.top = this._positionInfoBox.t - this._positionInfoBox.h - 40 - 3) : c >= this._positionInfoBox.h && (d.position.top = this._positionInfoBox.t + 40 + 3); return d
                                                }, _setMobilePosition: function () {
                                                        window.appInfo.isRunInMobile && this.domNode && this.domNode.parentNode !== A.byId(jimuConfig.layoutId) && A.place(this.domNode, jimuConfig.layoutId); var d = this.panelManager.getPositionOnMobile(this); this.position.zIndex && (d.zIndex = this.position.zIndex); var c = l.getPositionStyle(d); q.mixin(c,
                                                                d.borderRadiusStyle); A.setStyle(this.domNode, c)
                                                }, _setDesktopPosition: function (d) { !window.appInfo.isRunInMobile && this.domNode && this.domNode.parentNode !== A.byId(jimuConfig.mapId) && A.place(this.domNode, jimuConfig.mapId); A.setStyle(this.domNode, { left: d.left + "px", right: "auto", top: d.top + "px", width: (d.width || this.position.width || this._originalBox.w) + "px", height: (d.height || this.position.height || this._originalBox.h) + "px" }) }, onMoving: function (d) { A.setStyle(d.node, "opacity", .9) }, onMoveStop: function (d) {
                                                        A.setStyle(d.node,
                                                                "opacity", 1); d = A.getMarginBox(d.node); this._normalizePositionObj(q.clone({ left: d.l, top: d.t, width: d.w, height: d.h })); this.makePositionInfoBox()
                                                }
                                        }); E.extend(n); return E
                                })
                }, "dojox/layout/ResizeHandle": function () {
                        define("dojo/_base/kernel dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/event dojo/_base/fx dojo/_base/window dojo/fx dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/declare dojo/touch dijit/_base/manager dijit/_Widget dijit/_TemplatedMixin".split(" "), function (E,
                                q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                        E.experimental("dojox.layout.ResizeHandle"); var h = g("dojox.layout._ResizeHelper", a, { show: function () { c.set(this.domNode, "display", "") }, hide: function () { c.set(this.domNode, "display", "none") }, resize: function (p) { d.setMarginBox(this.domNode, p) } }); return g("dojox.layout.ResizeHandle", [a, f], {
                                                targetId: "", targetContainer: null, resizeAxis: "xy", activeResize: !1, activeResizeClass: "dojoxResizeHandleClone", animateSizing: !0, animateMethod: "chain", animateDuration: 225, minHeight: 100, minWidth: 100,
                                                constrainMax: !1, maxHeight: 0, maxWidth: 0, fixedAspect: !1, intermediateChanges: !1, startTopic: "/dojo/resize/start", endTopic: "/dojo/resize/stop", templateString: '\x3cdiv dojoAttachPoint\x3d"resizeHandle" class\x3d"dojoxResizeHandle"\x3e\x3cdiv\x3e\x3c/div\x3e\x3c/div\x3e', postCreate: function () {
                                                        this.connect(this.resizeHandle, b.press, "_beginSizing"); this.activeResize ? this.animateSizing = !1 : (this._resizeHelper = e.byId("dojoxGlobalResizeHelper"), this._resizeHelper || (this._resizeHelper = (new h({ id: "dojoxGlobalResizeHelper" })).placeAt(r.body()),
                                                                n.add(this._resizeHelper.domNode, this.activeResizeClass))); this.minSize || (this.minSize = { w: this.minWidth, h: this.minHeight }); this.constrainMax && (this.maxSize = { w: this.maxWidth, h: this.maxHeight }); this._resizeX = this._resizeY = !1; var p = q.partial(n.add, this.resizeHandle); switch (this.resizeAxis.toLowerCase()) { case "xy": this._resizeX = this._resizeY = !0; p("dojoxResizeNW"); break; case "x": this._resizeX = !0; p("dojoxResizeW"); break; case "y": this._resizeY = !0, p("dojoxResizeN") }
                                                }, _beginSizing: function (p) {
                                                        if (!this._isSizing &&
                                                                (A.publish(this.startTopic, [this]), this.targetDomNode = (this.targetWidget = e.byId(this.targetId)) ? this.targetWidget.domNode : k.byId(this.targetId), this.targetContainer && (this.targetDomNode = this.targetContainer), this.targetDomNode)) {
                                                                        if (!this.activeResize) { var B = d.position(this.targetDomNode, !0); this._resizeHelper.resize({ l: B.x, t: B.y, w: B.w, h: B.h }); this._resizeHelper.show(); this.isLeftToRight() || (this._resizeHelper.startPosition = { l: B.x, t: B.y }) } this._isSizing = !0; this.startPoint = { x: p.clientX, y: p.clientY };
                                                                B = c.getComputedStyle(this.targetDomNode); var t = "border-model" === d.boxModel ? { w: 0, h: 0 } : d.getPadBorderExtents(this.targetDomNode, B), u = d.getMarginExtents(this.targetDomNode, B); this.startSize = { w: c.get(this.targetDomNode, "width", B), h: c.get(this.targetDomNode, "height", B), pbw: t.w, pbh: t.h, mw: u.w, mh: u.h }; this.isLeftToRight() || "absolute" != c.get(this.targetDomNode, "position") || (B = d.position(this.targetDomNode, !0), this.startPosition = { l: B.x, t: B.y }); this._pconnects = [A.connect(r.doc, b.move, this, "_updateSizing"),
                                                                A.connect(r.doc, b.release, this, "_endSizing")]; m.stop(p)
                                                        }
                                                }, _updateSizing: function (p) { if (this.activeResize) this._changeSizing(p); else { var B = this._getNewCoords(p, "border", this._resizeHelper.startPosition); if (!1 === B) return; this._resizeHelper.resize(B) } p.preventDefault() }, _getNewCoords: function (p, B, t) {
                                                        try { if (!p.clientX || !p.clientY) return !1 } catch (x) { return !1 } this._activeResizeLastEvent = p; var u = (this.isLeftToRight() ? 1 : -1) * (this.startPoint.x - p.clientX), z = this.startPoint.y - p.clientY; p = this.startSize.w - (this._resizeX ?
                                                                u : 0); z = this._checkConstraints(p, this.startSize.h - (this._resizeY ? z : 0)); (t = t || this.startPosition) && this._resizeX && (z.l = t.l + u, z.w != p && (z.l += p - z.w), z.t = t.t); switch (B) { case "margin": z.w += this.startSize.mw, z.h += this.startSize.mh; case "border": z.w += this.startSize.pbw, z.h += this.startSize.pbh }return z
                                                }, _checkConstraints: function (p, B) {
                                                        if (this.minSize) { var t = this.minSize; p < t.w && (p = t.w); B < t.h && (B = t.h) } this.constrainMax && this.maxSize && (t = this.maxSize, p > t.w && (p = t.w), B > t.h && (B = t.h)); if (this.fixedAspect) {
                                                                t = this.startSize.w;
                                                                var u = this.startSize.h, z = t * B - u * p; 0 > z ? p = B * t / u : 0 < z && (B = p * u / t)
                                                        } return { w: p, h: B }
                                                }, _changeSizing: function (p) {
                                                        var B = this.targetWidget && q.isFunction(this.targetWidget.resize), t = this._getNewCoords(p, B && "margin"); if (!1 !== t && (B ? this.targetWidget.resize(t) : this.animateSizing ? l[this.animateMethod]([v.animateProperty({ node: this.targetDomNode, properties: { width: { start: this.startSize.w, end: t.w } }, duration: this.animateDuration }), v.animateProperty({
                                                                node: this.targetDomNode, properties: { height: { start: this.startSize.h, end: t.h } },
                                                                duration: this.animateDuration
                                                        })]).play() : c.set(this.targetDomNode, { width: t.w + "px", height: t.h + "px" }), this.intermediateChanges)) this.onResize(p)
                                                }, _endSizing: function (p) { w.forEach(this._pconnects, A.disconnect); var B = q.partial(A.publish, this.endTopic, [this]); this.activeResize ? B() : (this._resizeHelper.hide(), this._changeSizing(p), setTimeout(B, this.animateDuration + 15)); this._isSizing = !1; this.onResize(p) }, onResize: function (p) { }
                                        })
                        })
                }, "jimu/a11y/OnScreenWidgetPanel": function () {
                        define(["dojo/_base/lang", "dojo/on",
                                "dojo/_base/html", "dojo/keys"], function (E, q, A, w) {
                                        return {
                                                a11y_init: function () { this.own(q(this.domNode, "keydown", E.hitch(this, function (m) { A.hasClass(m.target, "close-btn") || m.keyCode !== w.ESCAPE || (m.stopPropagation(), this.closeNode.focus()) }))) }, _onTitleLabelKeyDown: function (m) { m.shiftKey && m.keyCode === w.TAB && m.preventDefault() }, _onMaxBtnKeyDown: function (m) { m.keyCode !== w.ENTER && m.keyCode !== w.SPACE || this._onMaxBtnClicked(m) }, _onFoldableBtnKeyDown: function (m) {
                                                        m.keyCode === w.ENTER || m.keyCode === w.SPACE ? this._onFoldableBtnClicked(m) :
                                                        m.keyCode === w.TAB && m.shiftKey && m.preventDefault()
                                                }, _onCloseBtnKey: function (m) { m.keyCode === w.ENTER || m.keyCode === w.SPACE ? this._onCloseBtnClicked(m) : m.keyCode === w.TAB && m.shiftKey && (window.appInfo.isRunInMobile || m.preventDefault()) }
                                        }
                                })
                }, "jimu/LayerInfos/LayerInfoForGroup": function () {
                        define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/request ./LayerInfo".split(" "), function (E, q, A, w, m, v) {
                                return E(v, {
                                        constructor: function (r, l, k, n) { this.noLegend = n }, _initVisible: function () {
                                                var r =
                                                        !1, l = this.originOperLayer.mapService; this.originOperLayer.mapService && l.layerInfo._subLayerVisible[l.subId] && (r = !0); this._visible = r
                                        }, _setTopLayerVisible: function (r) { if (this.originOperLayer.mapService) { var l = this.originOperLayer.mapService; if (0 < this.originOperLayer.subLayers.length) { l.layerInfo._subLayerVisible[l.subId] = r ? !0 : !1; this._visible = r; var k = {}; this.traversal(function (n) { 0 === n.getSubLayers().length && (k[n.originOperLayer.mapService.subId] = n.isVisbleOrInvisilbe()) }); l.layerInfo._setSubLayerVisible(k) } } },
                                        setLayerVisiblefromTopLayer: function () { }, _visibleChanged: function (r) { }, _sevVisible: function (r) { this.visible = r }, obtainNewSubLayers: function () { var r = []; q.forEach(this.originOperLayer.subLayers, function (l) { l.parentLayerInfo = this; l = this._layerInfoFactory.create(l); r.push(l); l.init() }, this); return r }, getOpacity: function () { }, setOpacity: function (r) { }, getLayerObject: function () {
                                                var r = new w; this.layerObject.empty ? m({ url: this.layerObject.url, handleAs: "json", callbackParamName: "callback", timeout: 1E5, content: { f: "json" } }).then(A.hitch(this,
                                                        function (l) { var k = this.layerObject.url; this.layerObject = l; this.layerObject.url = k; this.layerObject.id = this.id; r.resolve(this.layerObject) }), function (l) { r.reject(l) }) : r.resolve(this.layerObject); return r
                                        }, getLayerType: function () { var r = new w; r.resolve("GroupLayer"); return r }, _getShowLegendOfWebmap: function () { return this.originOperLayer.mapService.layerInfo._getSublayerShowLegendOfWebmap(this.originOperLayer.mapService.subId) }, getScaleRange: function () {
                                                var r = this.originOperLayer.mapService; return (r = r.layerInfo._getJsapiLayerInfoById(r.subId)) &&
                                                        0 <= r.minScale && 0 <= r.maxScale ? { minScale: r.minScale, maxScale: r.maxScale } : { minScale: 0, maxScale: 0 }
                                        }
                                })
                        })
                }, "jimu/dijit/Filter": function () {
                        define("dojo/on dijit/a11yclick dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils jimu/LayerInfos/LayerInfos jimu/dijit/_filter/ValueProviderFactory dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/Deferred esri/request ./_SingleFilter ./_FilterSet jimu/dijit/formSelect ./LoadingIndicator".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t) {
                                        return w([m, v, r, k, A], {
                                                templateString: l, baseClass: "jimu-filter", declaredClass: "jimu.dijit.Filter", nls: null, _filterUtils: null, autoSwitchMode: !0, _validOptions: !1, _layerDefinition: null, _popupFieldsInfo: [], _def: null, valueProviderFactory: null, featureLayerId: null, layerInfosObj: null, mode: "desktop", noFilterTip: "", enableAskForValues: !1, mobileBreakWidth: 600, runtime: !1, widgetId: "", postMixInProperties: function () {
                                                        this.nls = window.jimuNls.filterBuilder; this.nls.add =
                                                                window.jimuNls.common.add; this.nls.apply = window.jimuNls.common.apply; this.layerInfosObj = d.getInstanceSync(); this._filterUtils = new k; this.inherited(arguments)
                                                }, postCreate: function () { this.inherited(arguments); this._setDesktopMode(); this.noFilterTip && "string" === typeof this.noFilterTip && (this.noFilterTipSection.innerHTML = n.sanitizeHTML(this.noFilterTip)); this._bindBtnsEvent() }, startup: function () { this.inherited(arguments); this.autoUpdateMode() }, resize: function () { this.autoUpdateMode() }, _bindBtnsEvent: function () {
                                                        this.own(E(this.btnAddExpDesktop,
                                                                q, b.hitch(this, function () { this._onBtnAddExpClick() }))); this.own(E(this.btnAddSetDesktop, q, b.hitch(this, function () { this._onBtnAddSetClick() }))); this.own(E(this.btnAddExpMobile, q, b.hitch(this, function () { this._onBtnAddExpClick() }))); this.own(E(this.btnAddSetMobile, q, b.hitch(this, function () { this._onBtnAddSetClick() })))
                                                }, autoUpdateMode: function () { this.autoSwitchMode && (this._clearMode(), this.domNode.clientWidth >= this.mobileBreakWidth ? this._setDesktopMode() : this._setMobileMode()) }, setMode: function (u) {
                                                        "desktop" ===
                                                        u ? this._setDesktopMode() : "mobile" === u && this._setMobileMode()
                                                }, _setMode: function (u) { this.mode = u; this._setModeClass(this.mode) }, _setModeClass: function (u) { e.removeClass(this.domNode, "desktop-mode"); e.removeClass(this.domNode, "mobile-mode"); e.addClass(this.desktopAddSection, "hidden"); e.addClass(this.mobileAddSection, "hidden"); u && e.addClass(this.domNode, u + "-mode") }, _clearMode: function () { this._setModeClass("") }, _setDesktopMode: function () { this._setMode("desktop"); e.removeClass(this.desktopAddSection, "hidden") },
                                                _setMobileMode: function () { this._setMode("mobile"); e.removeClass(this.mobileAddSection, "hidden") }, reset: function () { this.isBuilding() || (this.removeAllFilters(), this.url = null, this.isHosted = !1, this._layerDefinition = null, this._popupFieldsInfo = [], this.valueProviderFactory = this.partsObj = this.expr = this.featureLayerId = null) }, isBuilding: function () { return this._def && !this._def.isFulfilled() }, build: function (u) {
                                                        var z = new h; this.isBuilding() ? z.reject("Filter is already building.") : (this._def = null, this.reset(),
                                                                this.url = u.url, this.isHosted = n.isHostedService(this.url), this._layerDefinition = u.layerDefinition, this.featureLayerId = u.featureLayerId, u.widgetId && (this.widgetId = u.widgetId), this.useStandardizedQueries = this._filterUtils.useStandardizedQueries(u.layerDefinition), u.partsObj ? (this.partsObj = this._updatePartsObj(u.partsObj), this._def = this._init("partsObj")) : (this.expr = u.expr || "1\x3d1", this._def = this._init("expr")), z = this._def); return z
                                                }, buildByExpr: function (u, z, x) {
                                                        console.warn("Filter#buildByExpr() method is deprecated, please use Filter#build() instead.");
                                                        return this.build({ url: u, expr: z, layerDefinition: x, featureLayerId: this.featureLayerId })
                                                }, buildByFilterObj: function (u, z, x) { console.warn("Filter#buildByFilterObj() method is deprecated, please use Filter#build() instead."); return this.build({ url: u, partsObj: z, layerDefinition: x, featureLayerId: this.featureLayerId }) }, _updatePartsObj: function (u) {
                                                        a.forEach(u, b.hitch(this, function (z) {
                                                                z.parts ? a.forEach(z.parts, b.hitch(this, function (x) {
                                                                        x.interactiveObj && !0 === x.interactiveObj.cascade ? x.interactiveObj.cascade =
                                                                                "previous" : !1 === x.interactiveObj.cascade && (x.interactiveObj.cascade = "none")
                                                                })) : z.interactiveObj && !0 === z.interactiveObj.cascade ? z.interactiveObj.cascade = "previous" : !1 === z.interactiveObj.cascade && (z.interactiveObj.cascade = "none")
                                                        })); return u
                                                }, removeAllFilters: function () { this._destroyAllFilters() }, _getLayerDefinitionRaw: function (u, z) {
                                                        var x = new h; z ? x.resolve(z) : (this.loading.show(), p({ url: u, content: { f: "json" }, handleAs: "json", callbackParamName: "callback" }).then(b.hitch(this, function (y) {
                                                                this.domNode ? (this.loading.hide(),
                                                                        x.resolve(y)) : x.reject()
                                                        }), b.hitch(this, function (y) { console.error(y); x.reject(); this.domNode && this.loading.hide() }))); return x
                                                }, _validateLayerDefinition: function (u) { return this._isObject(u) }, _init: function (u) {
                                                        var z = new h; if (!this._isString(this.url)) return z.reject(), z; var x = b.hitch(this, function () { setTimeout(b.hitch(this, function () { this.emit("change"); z.resolve() }), 1500) }), y = b.hitch(this, function () {
                                                                e.addClass(this.errorSection, "hidden"); this.removeAllFilters(); if (this.featureLayerId) {
                                                                        this._tryOverrideFieldAliases(this.featureLayerId,
                                                                                this._layerDefinition); var D = this.layerInfosObj.getLayerOrTableInfoById(this.featureLayerId).getPopupInfo()
                                                                } var H = this._layerDefinition.fields; H && 0 < H.length ? (this._popupFieldsInfo = D ? n.completePopupFieldFromLayerField(H, D.fieldInfos) : H, (H = a.filter(H, b.hitch(this, function (I) { return 0 <= this._supportFieldTypes.indexOf(I.type) }))) && 0 < H.length ? (this._validOptions = !0, e.removeClass(this.btnAddSetDesktop, "jimu-state-disabled"), e.removeClass(this.btnAddExpDesktop, "jimu-state-disabled"), e.removeClass(this.btnAddSetMobile,
                                                                        "jimu-state-disabled"), e.removeClass(this.btnAddExpMobile, "jimu-state-disabled"), this.createFieldsStore(), this.valueProviderFactory = new c({ url: this.url, layerDefinition: this._layerDefinition, featureLayerId: this.featureLayerId }), "expr" === u ? this._isString(this.expr) ? ("1\x3d1" === this.expr.replace(/\s/gi, "") && this.removeAllFilters(), this._parseExpr(this.expr) ? x() : z.reject()) : z.reject() : "partsObj" === u ? this._validatePartsObj(this.partsObj) ? (this._parsePartsObj(this.partsObj), x()) : z.reject() : this._validatePartsObj(this.partsObj) ?
                                                                                (this._parsePartsObj(this.partsObj), x()) : this._isString(this.expr) ? this._parseExpr(this.expr) ? x() : z.reject() : (this.removeAllFilters(), x())) : (this._showErrorOptions(this.nls.error.noFilterFields), z.reject())) : (D && (this._popupFieldsInfo = D.fieldInfos), z.reject())
                                                        }); this._validateLayerDefinition(this._layerDefinition) ? y() : (this.loading.show(), p({ url: this.url, content: { f: "json" }, handleAs: "json", callbackParamName: "callback" }).then(b.hitch(this, function (D) {
                                                                this.domNode ? (this.loading.hide(), this._layerDefinition =
                                                                        D, y()) : z.reject()
                                                        }), b.hitch(this, function (D) { console.error(D); z.reject(); this.domNode && this.loading.hide() }))); return z
                                                }, _tryOverrideFieldAliases: function (u, z) { if (u = this.layerInfosObj.getLayerOrTableInfoById(u)) if (u = u.getPopupInfo()) if (u = u.fieldInfos, z = z.fields, u && 0 < u.length && z && 0 < z.length) { var x = {}; a.forEach(u, b.hitch(this, function (y) { y.fieldName && (x[y.fieldName] = y) })); a.forEach(z, b.hitch(this, function (y) { var D = x[y.name]; D && D.label && (y.alias = D.label) })) } }, _handleUseStandardizedQueries: function (u) {
                                                        u &&
                                                        this.useStandardizedQueries && (u.parts ? a.forEach(u.parts, b.hitch(this, function (z) { "date" === z.fieldObj.shortType && (z._useStandardizedQueries = this.useStandardizedQueries) })) : "date" === u.fieldObj.shortType && (u._useStandardizedQueries = this.useStandardizedQueries)); return u
                                                }, toJson: function () {
                                                        var u = { logicalOperator: this.allAnySelect.value, parts: [] }, z = this._getAllSingleFiltersAndFilterSets(); if (0 === z.length) return u.expr = "1\x3d1", u; a.forEach(z, b.hitch(this, function (x) {
                                                                x = x.toJson(); x = this._handleUseStandardizedQueries(x);
                                                                u.parts.push(x)
                                                        })); return a.every(u.parts, b.hitch(this, function (x) { return !!x })) && 0 < u.parts.length ? (u.expr = this.getExprByFilterObj(u), u) : null
                                                }, toValidJson: function () { var u = { logicalOperator: this.allAnySelect.value, parts: [] }, z = this._getAllSingleFiltersAndFilterSets(); if (0 === z.length) return u.expr = "1\x3d1", u; a.forEach(z, b.hitch(this, function (x) { if (x = x.toJson()) x = this._handleUseStandardizedQueries(x), u.parts.push(x) })); u.expr = 0 < u.parts.length ? this.getExprByFilterObj(u) : "1\x3d1"; return u }, createFieldsStore: function () {
                                                        if (this._layerDefinition.fields &&
                                                                0 !== this._layerDefinition.fields.length) { var u = b.clone(this._layerDefinition.fields); 0 === this.setFieldsStoreByFieldInfos(u) && this._showErrorOptions(this.nls.error.noFilterFields) } else this._showErrorOptions(this.nls.error.noFilterFields)
                                                }, _parsePartsObj: function (u) { this._validatePartsObj(u) && (this.removeAllFilters(), this._buildEditUIByPartsObj(u)) }, _parseExpr: function (u) {
                                                        this._destroyAllFilters(); var z = null; if (!this._validateLayerDefinition(this._layerDefinition)) return z; if (!u || "string" !== typeof u) return this._showErrorOptions(this.nls.error.invalidSQL),
                                                                z; if ("1\x3d1" === this.expr.replace(/\s/gi, "")) return z = { expr: "1\x3d1", parts: [], logicalOperator: "AND" }; try { z = this.getFilterObjByExpr(u) } catch (x) { z = null, console.error(x) } z ? this._buildEditUIByPartsObj(z) : this._showErrorOptions(this.nls.error.cantParseSQL); return z
                                                }, _buildEditUIByPartsObj: function (u) {
                                                        u && (this._destroyAllFilters(), a.forEach(u.parts, b.hitch(this, function (z) { z.parts ? this._addFilterSet(z) : z.fieldObj && z.operator && z.valueObj && this._addSingleFilter(z) })), this._setValutForAllAnySelect(u.logicalOperator),
                                                                this._setFilterMsgUI(u.parts.length))
                                                }, _addSingleFilter: function (u) {
                                                        u = { widgetId: this.widgetId, url: this.url, layerInfo: this._layerDefinition, popupFieldsInfo: this._popupFieldsInfo, stringFieldType: this._stringFieldType, dateFieldType: this._dateFieldType, numberFieldTypes: this._numberFieldTypes, part: u, OPERATORS: b.mixin({}, this.OPERATORS), enableAskForValues: this.enableAskForValues, isHosted: this.isHosted, valueProviderFactory: this.valueProviderFactory, runtime: this.runtime }; u = new B(u); u.placeAt(this.allExpsBox);
                                                        u.startup(); this.own(f.after(u, "_destroySelf", b.hitch(this, function () { this._checkFilterNumbers(); this._focusOnMobileAdd(); this.emit("change") }))); this.own(E(u, "change", b.hitch(this, function () { this.emit("change") }))); this._checkFilterNumbers(); return u
                                                }, _focusOnMobileAdd: function () { e.hasClass(this.mobileAddSection, "hidden") || this.btnAddExpMobile.focus() }, _addFilterSet: function (u) {
                                                        u = {
                                                                widgetId: this.widgetId, url: this.url, layerInfo: this._layerDefinition, popupFieldsInfo: this._popupFieldsInfo, stringFieldType: this._stringFieldType,
                                                                dateFieldType: this._dateFieldType, numberFieldTypes: this._numberFieldTypes, partsObj: u, OPERATORS: b.mixin({}, this.OPERATORS), enableAskForValues: this.enableAskForValues, isHosted: this.isHosted, valueProviderFactory: this.valueProviderFactory, runtime: this.runtime
                                                        }; u = new t(u); u.placeAt(this.allExpsBox); u.startup(); this.own(f.after(u, "_destroySelf", b.hitch(this, function () { this._checkFilterNumbers(); this._focusOnMobileAdd(); this.emit("change") }))); this.own(E(u, "change", b.hitch(this, function () { this.emit("change") })));
                                                        this._checkFilterNumbers(); return u
                                                }, _destroyAllFilters: function () { for (var u = this._getAllSingleFiltersAndFilterSets(); 0 < u.length;)u[0].destroy(), u.splice(0, 1); this._checkFilterNumbers() }, _getAllSingleFiltersAndFilterSetsDoms: function () { var u = []; this.allExpsBox.childNodes && 0 < this.allExpsBox.childNodes.length && a.forEach(this.allExpsBox.childNodes, b.hitch(this, function (z) { (e.hasClass(z, "jimu-single-filter") || e.hasClass(z, "jimu-filter-set")) && u.push(z) })); return u }, _getAllSingleFiltersAndFilterSets: function () {
                                                        var u =
                                                                this._getAllSingleFiltersAndFilterSetsDoms(); return a.map(u, b.hitch(this, function (z) { return g.byNode(z) }))
                                                }, _setValutForAllAnySelect: function (u) { this.allAnySelect.set("value", u) }, _setFilterMsgUI: function (u) { 2 > u ? (this._setValutForAllAnySelect("AND"), e.setStyle(this.allAnySelect.domNode, "display", "none"), e.setStyle(this.oneOrZeroMsg, "display", "block")) : (e.setStyle(this.oneOrZeroMsg, "display", "none"), e.setStyle(this.allAnySelect.domNode, "display", "inline-table")) }, _checkFilterNumbers: function () {
                                                        var u =
                                                                this._getAllSingleFiltersAndFilterSetsDoms(); this._setFilterMsgUI(u.length); 0 < u.length ? e.addClass(this.noFilterTipSection, "hidden") : e.removeClass(this.noFilterTipSection, "hidden"); this.emit("filter-number-change")
                                                }, _showErrorOptions: function (u) { console.error(u); e.addClass(this.errorSection, "hidden"); this.errorTip.innerHTML = u; this.loading.hide() }, _onBtnApplyClicked: function () { this.emit("apply") }, _onBtnAddSetClick: function () { this._layerDefinition && this._validOptions && (this._addFilterSet(), this.emit("change")) },
                                                _onBtnAddExpClick: function () { this._layerDefinition && this._validOptions && (this._addSingleFilter(), this.emit("change")) }
                                        })
                                })
                }, "jimu/dijit/_filter/ValueProviderFactory": function () {
                        define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider ./AdvancedListValueProvider ./PredefinedValueProvider ./NumberListValueProvider ./DateIsInValueProvider jimu/utils jimu/LayerInfos/LayerInfos".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                        var e = {
                                                stringOperatorIs: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", codedValueProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0, supportCaseSensitive: !0 }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 } }, stringOperatorIsNot: {
                                                        value: {
                                                                normalProviderType: "SIMPLE_VALUE_PROVIDER",
                                                                codedValueProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0
                                                        }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0, supportCaseSensitive: !0 }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }
                                                }, stringOperatorStartsWith: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 },
                                                        values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, multiplePredefined: { normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }
                                                }, stringOperatorEndsWith: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" }, uniquePredefined: {
                                                                normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER",
                                                                supportAskForValue: !0, supportCaseSensitive: !0
                                                        }, multiplePredefined: { normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }
                                                }, stringOperatorContains: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, multiplePredefined: {
                                                                normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER",
                                                                supportAskForValue: !0, supportCaseSensitive: !0
                                                        }
                                                }, stringOperatorDoesNotContain: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }, multiplePredefined: { normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 } }, stringOperatorIsAnyOf: {
                                                        values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" },
                                                        multiple: { normalProviderType: "ADVANCED_LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0, supportCaseSensitive: !0 }, multiplePredefined: { normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0, supportCaseSensitive: !0 }
                                                }, stringOperatorIsNoneOf: {
                                                        values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" }, multiple: { normalProviderType: "ADVANCED_LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0, supportCaseSensitive: !0 }, multiplePredefined: {
                                                                normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER",
                                                                supportAskForValue: !0, supportCaseSensitive: !0
                                                        }
                                                }, stringOperatorIsBlank: { value: { normalProviderType: "BLANK_VALUE_PROVIDER" } }, stringOperatorIsNotBlank: { value: { normalProviderType: "BLANK_VALUE_PROVIDER" } }, numberOperatorIs: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", codedValueProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }, uniquePredefined: {
                                                                normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER",
                                                                supportAskForValue: !0
                                                        }
                                                }, numberOperatorIsNot: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", codedValueProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0 } }, numberOperatorIsAtLeast: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0 },
                                                        field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0 }
                                                }, numberOperatorIsLessThan: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }, uniquePredefined: {
                                                                normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER",
                                                                supportAskForValue: !0
                                                        }
                                                }, numberOperatorIsAtMost: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0 } }, numberOperatorIsGreaterThan: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" },
                                                        unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }, uniquePredefined: { normalProviderType: "UNIQUE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0 }
                                                }, numberOperatorIsAnyOf: { values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" }, multiple: { normalProviderType: "ADVANCED_LIST_VALUE_PROVIDER", supportAskForValue: !0 }, multiplePredefined: { normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0 } }, numberOperatorIsNoneOf: {
                                                        values: { normalProviderType: "SIMPLE_VALUE_PROVIDER" },
                                                        multiple: { normalProviderType: "ADVANCED_LIST_VALUE_PROVIDER", supportAskForValue: !0 }, multiplePredefined: { normalProviderType: "MULTIPLE_PREDEFINED_VALUE_PROVIDER", supportAskForValue: !0 }
                                                }, numberOperatorIsBetween: { value: { normalProviderType: "TWO_NUMBERS_VALUE_PROVIDER", supportAskForValue: !0 } }, numberOperatorIsNotBetween: { value: { normalProviderType: "TWO_NUMBERS_VALUE_PROVIDER", supportAskForValue: !0 } }, numberOperatorIsBlank: { value: { normalProviderType: "BLANK_VALUE_PROVIDER" } }, numberOperatorIsNotBlank: { value: { normalProviderType: "BLANK_VALUE_PROVIDER" } },
                                                dateOperatorIsOn: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, customVirtualDates: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 } }, dateOperatorIsNotOn: {
                                                        value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, customVirtualDates: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: {
                                                                normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0,
                                                                filterCodedValueIfPossible: !0
                                                        }
                                                }, dateOperatorIsIn: { value: { normalProviderType: "DATE_IS_IN_VALUE_PROVIDER", supportAskForValue: !0 } }, dateOperatorIsNotIn: { value: { normalProviderType: "DATE_IS_IN_VALUE_PROVIDER", supportAskForValue: !0 } }, dateOperatorIsBefore: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, customVirtualDates: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 } }, dateOperatorIsAfter: {
                                                        value: {
                                                                normalProviderType: "SIMPLE_VALUE_PROVIDER",
                                                                supportAskForValue: !0, customVirtualDates: !0
                                                        }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }
                                                }, dateOperatorIsOnOrBefore: { value: { normalProviderType: "SIMPLE_VALUE_PROVIDER", supportAskForValue: !0, customVirtualDates: !0 }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 } }, dateOperatorIsOnOrAfter: {
                                                        value: {
                                                                normalProviderType: "SIMPLE_VALUE_PROVIDER",
                                                                supportAskForValue: !0, customVirtualDates: !0
                                                        }, field: { normalProviderType: "LIST_VALUE_PROVIDER" }, unique: { normalProviderType: "LIST_VALUE_PROVIDER", supportAskForValue: !0, filterCodedValueIfPossible: !0 }
                                                }, dateOperatorInTheLast: { value: { normalProviderType: "NUMBER_LIST_VALUE_PROVIDER", supportAskForValue: !0 } }, dateOperatorNotInTheLast: { value: { normalProviderType: "NUMBER_LIST_VALUE_PROVIDER", supportAskForValue: !0 } }, dateOperatorIsBetween: {
                                                        value: {
                                                                normalProviderType: "TWO_DATES_VALUE_PROVIDER", supportAskForValue: !0,
                                                                customVirtualDates: !0
                                                        }
                                                }, dateOperatorIsNotBetween: { value: { normalProviderType: "TWO_DATES_VALUE_PROVIDER", supportAskForValue: !0, customVirtualDates: !0 } }, dateOperatorIsBlank: { value: { normalProviderType: "BLANK_VALUE_PROVIDER" } }, dateOperatorIsNotBlank: { value: { normalProviderType: "BLANK_VALUE_PROVIDER" } }
                                        }, a = A([], {
                                                nls: null, layerInfo: null, popupInfo: null, url: null, layerDefinition: null, featureLayerId: null, constructor: function (f) {
                                                        E.mixin(this, f); this.nls = window.jimuNls.filterBuilder; f = b.getInstanceSync(); this.featureLayerId &&
                                                                (this.layerInfo = f.getLayerOrTableInfoById(this.featureLayerId)) && (this.popupInfo = this.layerInfo.getPopupInfo())
                                                }, getSupportedValueTypes: function (f, h) {
                                                        var p = []; if (h = e[h]) h.value && p.push("value"), h.field && 0 < this._getSameShortTypeFieldNames(f).length && p.push("field"), h.unique && this.url && (this._isStreamServer(this.url) || p.push("unique")), h.multiple && this.url && (this._isStreamServer(this.url) || p.push("multiple")), h.uniquePredefined && this.url && (this._isStreamServer(this.url) || p.push("uniquePredefined")),
                                                                h.multiplePredefined && this.url && (this._isStreamServer(this.url) || p.push("multiplePredefined")); return p
                                                }, _isStreamServer: function (f) { f = (f || "").replace(/\/*$/g, ""); return /\/StreamServer$/gi.test(f) }, _getSameShortTypeFieldNames: function (f) { var h = [], p = this._getFieldInfo(this.layerDefinition, f), B = a.getShortTypeByEsriType(p.type); q.forEach(this.layerDefinition.fields, E.hitch(this, function (t) { t.name !== f && a.getShortTypeByEsriType(t.type) === B && h.push(t.name) })); return h }, _getSameShortTypeFieldNameLabels: function (f) {
                                                        var h =
                                                                [], p = this._getFieldInfo(this.layerDefinition, f), B = a.getShortTypeByEsriType(p.type); q.forEach(this.layerDefinition.fields, E.hitch(this, function (t) { t.name !== f && a.getShortTypeByEsriType(t.type) === B && h.push({ value: t.name, label: t.alias }) })); return h
                                                }, getValueProvider: function (f, h) {
                                                        var p = null, B = E.clone(e[f.operator]); if (B) {
                                                                var t = f.valueObj.type, u = f.fieldObj.name, z = this._getFieldInfo(this.layerDefinition, u), x = B[t], y = x.normalProviderType, D = null, H = g.getCodedValueListForCodedValueOrSubTypes(this.layerDefinition,
                                                                        u); "field" === t ? (u = this._getSameShortTypeFieldNameLabels(u), 0 < u.length && (D = u)) : H && 0 < H.length && x.codedValueProviderType && (y = x.codedValueProviderType); f = { nls: this.nls, url: this.url, layerDefinition: this.layerDefinition, partObj: f, fieldInfo: z, codedValues: H, staticValues: D, layerInfo: this.layerInfo, popupInfo: this.popupInfo, operatorInfo: B, filterCodedValueIfPossible: !!x.filterCodedValueIfPossible, runtime: h }; if ("BLANK_VALUE_PROVIDER" === y) p = new w(f); else if ("SIMPLE_VALUE_PROVIDER" === y) p = new m(f); else if ("TWO_NUMBERS_VALUE_PROVIDER" ===
                                                                                y) p = new v(f); else if ("TWO_DATES_VALUE_PROVIDER" === y) p = new r(f); else if ("LIST_VALUE_PROVIDER" === y) f.showNullValues = !1, "value" === t || "field" === t ? p = new l(f) : (f.providerType = y, f.selectUI = "dropdown", p = new k(f)); else if ("NUMBER_LIST_VALUE_PROVIDER" === y) p = new d(f); else if ("DATE_IS_IN_VALUE_PROVIDER" === y) p = new c(f); else if ("ADVANCED_LIST_VALUE_PROVIDER" === y) f.providerType = y, f.selectUI = "dropdown", p = new k(f); else if ("UNIQUE_PREDEFINED_VALUE_PROVIDER" === y || "MULTIPLE_PREDEFINED_VALUE_PROVIDER" === y) f.providerType =
                                                                                        y, f.selectUI = f.partObj.valueObj ? f.partObj.valueObj.selectUI : null, p = h ? new k(f) : new n(f)
                                                        } return p
                                                }, _getFieldInfo: function (f, h) { f = f.fields; for (var p = 0; p < f.length; p++) { var B = f[p]; if (h === B.name) return B } return null }
                                        }); a.getOperatorInfo = function (f) { return E.clone(e[f]) }; a.isSupportVirtualDates = function (f) { var h = e[f]; return h && h.value && h.value.customVirtualDates ? { status: !0, num: "dateOperatorIsBetween" === f || "dateOperatorIsNotBetween" === f ? 2 : 1 } : { status: !1 } }; a.getOperatorsByShortType = function (f, h) {
                                                var p = []; "string" ===
                                                        f ? p = "stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsAnyOf stringOperatorIsNoneOf stringOperatorIsBlank stringOperatorIsNotBlank".split(" ") : "number" === f ? p = "numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsAtMost numberOperatorIsLessThan numberOperatorIsGreaterThan numberOperatorIsAnyOf numberOperatorIsNoneOf numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" ") :
                                                        "date" === f && (p = "dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsIn dateOperatorIsNotIn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsOnOrBefore dateOperatorIsOnOrAfter dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "), h && p.splice(8, 0, "dateOperatorInTheLast", "dateOperatorNotInTheLast")); return p
                                        }; a.getShortTypeByEsriType = function (f) {
                                                var h = null; "esriFieldTypeString" === f ? h = "string" : "esriFieldTypeDate" === f ? h = "date" : 0 <= ["esriFieldTypeOID",
                                                        "esriFieldTypeSmallInteger", "esriFieldTypeInteger", "esriFieldTypeSingle", "esriFieldTypeDouble"].indexOf(f) && (h = "number"); return h
                                        }; return a
                                })
                }, "jimu/dijit/_filter/BlankValueProvider": function () {
                        define(["dojo/_base/html", "dojo/_base/declare", "./ValueProvider"], function (E, q, A) {
                                return q([A], {
                                        templateString: "\x3cdiv\x3e\x3c/div\x3e", postCreate: function () { this.inherited(arguments); E.addClass(this.domNode, "jimu-filter-blank-value-provider") }, getDijits: function () { return [] }, getStatus: function () { return 1 },
                                        setValueObject: function () { }, getValueObject: function () { return { isValid: !0, type: this.partObj.valueObj.type, value: null } }, isBlankValueProvider: function () { return !0 }
                                })
                        })
                }, "jimu/dijit/_filter/ValueProvider": function () {
                        define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/FilterManager jimu/utils esri/lang".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                return v([r, l, q], {
                                        baseClass: "jimu-filter-value-provider", fieldName: null,
                                        shortType: null, _enabled: !1, cascade: "none", filterCodedValue: !1, fieldPopupInfo: null, nls: null, url: null, layerDefinition: null, fieldInfo: null, partObj: null, runtime: !0, staticValues: null, codedValues: null, layerInfo: null, popupInfo: null, operatorInfo: null, filterCodedValueIfPossible: !1, postMixInProperties: function () {
                                                this.inherited(arguments); this.shortType = this.partObj.fieldObj.shortType; this.fieldName = this.partObj.fieldObj.name; this.cascade = this.partObj.interactiveObj && this.partObj.interactiveObj.cascade; this.runtime &&
                                                        this.codedValues && this.filterCodedValueIfPossible && n.isCodedValuesSupportFilter(this.layerDefinition, this.codedValues.length) ? this.filterCodedValue = !0 : this.filterCodedValue = !1; this.popupInfo && this.popupInfo.fieldInfos && 0 < this.popupInfo.fieldInfos.length && m.some(this.popupInfo.fieldInfos, A.hitch(this, function (c) { return c.fieldName === this.fieldName ? (this.fieldPopupInfo = c, !0) : !1 }))
                                        }, postCreate: function () { this.inherited(arguments); this.filterManager = k.getInstance() }, getDijits: function () { return [] }, bindChangeEvents: function () {
                                                var c =
                                                        this.getDijits(); m.forEach(c, A.hitch(this, function (g) { g.declaredClass && 0 === g.declaredClass.indexOf("dijit.") && w.addClass(g.domNode, g.declaredClass.replace(/\./g, "-")); this.own(E(g, "change", A.hitch(this, this._onChanged))); this.own(E(g, "enter", A.hitch(this, this._onEnter))) }))
                                        }, _onChanged: function () { this._onEnterTriggered || this.emit("change") }, _onEnterTriggered: !1, _onEnter: function () {
                                                this._onEnterTriggered = !0; this.emit("change"); this.emit("enter"); setTimeout(A.hitch(this, function () {
                                                        this._onEnterTriggered =
                                                        !1
                                                }), 100)
                                        }, tryLocaleNumber: function (c) { var g = n.localizeNumber(c); if (null === g || void 0 === g) g = c; return g }, getPartObject: function () { var c = this.getValueObject(); if (!c) return null; var g = A.clone(this.partObj); g.valueObj = c; return g }, setValueObject: function () { }, getValueObject: function () { }, tryGetValueObject: function () { return this.getValueObject() }, setRequired: function () { }, getStatus: function () {
                                                var c = 1, g = this.getDijits(); 0 < g.length && (c = m.map(g, A.hitch(this, function (b) {
                                                        return "function" === typeof b.getStatus ? b.getStatus() :
                                                                this.getStatusForDijit(b)
                                                })), c = Math.min.apply(c, c)); return c
                                        }, getStatusForDijit: function (c) { return c.validate() ? c.get("DisplayedValue") ? 1 : 0 : -1 }, isInvalidValue: function () { return 0 > this.getStatus() }, isEmptyValue: function () { return 0 === this.getStatus() }, isValidValue: function () { return 0 < this.getStatus() }, isBlankValueProvider: function () { return !1 }, getFilterExpr: function () {
                                                var c = "1\x3d1"; c = this.getLayerFilterExpr(); if ("all" === this.cascade || "previous" === this.cascade) {
                                                        var g = this.getCascadeFilterExpr(); c = "(" +
                                                                c + ") AND (" + g + ")"
                                                } return c
                                        }, getLayerFilterExpr: function () { var c = "1\x3d1"; this.layerInfo && (c = this.layerInfo.getFilter()); c || (c = "1\x3d1"); return c }, _getWebMapFilterExpr: function () { var c = ""; this.layerInfo && (c = this.layerInfo.getFilterOfWebmap()); c || (c = "1\x3d1"); return c }, getDropdownFilterExpr: function (c) {
                                                var g = "1\x3d1"; c = this.layerInfo && this.runtime && c ? this.filterManager.getFilterExp(this.layerInfo.id, c) : this._getWebMapFilterExpr(); "all" === this.cascade || "previous" === this.cascade ? (g = this.getCascadeFilterExpr(),
                                                        g = c ? "(" + c + ") AND (" + g + ")" : "(" + g + ")") : c && (g = c); return g
                                        }, getCascadeFilterExpr: function () { return "1\x3d1" }, getDropdownFilterPartsObj: function () { var c = { parts: [] }; if ("all" === this.cascade || "previous" === this.cascade) c = this.getCascadeFilterPartsObj(); return c }, getCascadeFilterPartsObj: function () { return {} }, getCodedValueListByPartsObj: function (c, g, b, e) {
                                                var a = n.getFieldInfoByFieldName(c.fields, g), f = c.typeIdField, h = null; b = b.parts; for (var p in b) {
                                                        var B = b[p]; if (B.fieldObj.name === f) {
                                                                f = B.valueObj.value; h = n._getCodedValueBySubTypeId(c,
                                                                        g, f, a); break
                                                        }
                                                } h || (h = e ? e : n._getAllCodedValue(c, a)); if (h && 0 < h.length) var t = h[0].value; return { selectedValue: t, valueLabels: h }
                                        }, isDefined: function (c) { return d.isDefined(c) }, disable: function () { this._enabled = !1 }, enable: function () { this._enabled = !0 }, isEnabled: function () { return this._enabled }, destroy: function () { this.inherited(arguments) }
                                })
                        })
                }, "jimu/dijit/_filter/SimpleValueProvider": function () {
                        define("dojo/_base/html dojo/_base/declare dojo/_base/lang dojo/on dojo/keys jimu/utils ./ValueProvider dijit/form/ValidationTextBox dijit/form/NumberTextBox ./DateValueSelector".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        return q([r], {
                                                templateString: "\x3cdiv\x3e\x3c/div\x3e", _dijit: null, customId: null, postCreate: function () {
                                                        this.inherited(arguments); this.customId = this.partObj.vpId; E.addClass(this.domNode, "jimu-filter-simple-value-provider"); var d = null; "string" === this.shortType ? (d = { required: !1, trim: !0, intermediateChanges: !1 }, this.customId && (d.id = this.customId), this._dijit = new l(d), this._dijit.startup(), this._dijit.on("keydown", function (c) { (c.keyCode || c.which) === m.ENTER && this._dijit.emit("enter") }.bind(this))) :
                                                                "number" === this.shortType ? (d = { required: !1, intermediateChanges: !1, constraints: { pattern: "#####0.##########" } }, this.customId && (d.id = this.customId), this._dijit = new k(d), this._dijit.startup(), this._dijit.on("keydown", function (c) { (c.keyCode || c.which) === m.ENTER && this._dijit.emit("enter") }.bind(this))) : (d = { runtime: this.runtime, popupInfo: this.popupInfo, _fieldInfo: this.fieldInfo }, this.runtime && (d.virtualDates = this.partObj.interactiveObj.virtualDates), this.customId && (d.customId = this.customId, d.prompt = this.partObj.interactiveObj.prompt +
                                                                        " " + this.partObj.interactiveObj.hint), this._dijit = new n(d), this.own(w(this._dijit, "change", A.hitch(this, function (c) { this.emit("change", c, "start") })))); !this.customId || "string" !== this.shortType && "number" !== this.shortType || (d = E.toDom('\x3clabel for\x3d"' + this.customId + '" class\x3d"screen-readers-only"\x3e' + this.partObj.interactiveObj.prompt + " " + this.partObj.interactiveObj.hint + "\x3c/label\x3e"), E.place(d, this.domNode)); E.setStyle(this._dijit.domNode, "width", "100%"); this._dijit.placeAt(this.domNode)
                                                },
                                                getDijits: function () { return [this._dijit] }, setValueObject: function (d) { this.isDefined(d.value) && ("date" === this.shortType ? this._dijit.setValueObject(d) : this._dijit.set("value", d.value)) }, getValueObject: function () {
                                                        if (this.isValidValue()) if ("date" === this.shortType) { var d = this._dijit.getValueObject(); if (d && d.value) return d.isValid = !0, d.type = this.partObj.valueObj.type, d } else return d = this._dijit.get("value"), d = "number" === this.shortType ? parseFloat(d) : v.sanitizeHTML(d), {
                                                                isValid: !0, type: this.partObj.valueObj.type,
                                                                value: d
                                                        }; return null
                                                }, tryGetValueObject: function () { return this.isValidValue() ? this.getValueObject() : this.isEmptyValue() ? { isValid: !0, type: this.partObj.valueObj.type, value: null } : null }, setRequired: function (d) { this._dijit.set("required", d) }
                                        })
                                })
                }, "jimu/dijit/_filter/DateValueSelector": function () {
                        define("dojo/aspect dojo/Evented dojo/on dojo/keys dojo/query dojo/_base/html dojo/_base/lang dojo/_base/array dojo/_base/declare dijit/_WidgetBase jimu/filterUtils jimu/utils jimu/dijit/Popup jimu/dijit/formSelect jimu/dijit/dateTimePicker".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                        return k([n, q], {
                                                virtualDates: null, customId: null, postMixInProperties: function () { this.inherited(arguments); this.nls = window.jimuNls.filterBuilder }, postCreate: function () {
                                                        this.inherited(arguments); v.addClass(this.domNode, "jimu-date-value-selector"); this.dateTypeSelect = new b({ "aria-label": this.prompt }); v.addClass(this.dateTypeSelect.domNode, "date-type-select"); v.addClass(this.dateTypeSelect.domNode, "restrict-select-width"); this.dateTypeSelect.placeAt(this.domNode);
                                                        this.own(A(this.dateTypeSelect, "change", r.hitch(this, function () { this._onDateTypeSelectChanged() }))); this.virtualDates && 0 < this.virtualDates.length || (this.virtualDates = [d.VIRTUAL_DATE_TODAY, d.VIRTUAL_DATE_YESTERDAY, d.VIRTUAL_DATE_TOMORROW], this.runtime && this.virtualDates.unshift(d.VIRTUAL_DATE_CUSTOM)); this.dateTypeSelect.addOption({ value: "", label: "\x26nbsp;" }); (!this.runtime || this.runtime && 0 <= this.virtualDates.indexOf(d.VIRTUAL_DATE_CUSTOM)) && this.dateTypeSelect.addOption({ value: "custom", label: this.nls.custom });
                                                        l.map(this.virtualDates, r.hitch(this, function (a) { if ("custom" !== a) { var f = { value: a, label: a }; switch (a) { case d.VIRTUAL_DATE_TODAY: f.label = this.nls.today; break; case d.VIRTUAL_DATE_YESTERDAY: f.label = this.nls.yesterday; break; case d.VIRTUAL_DATE_TOMORROW: f.label = this.nls.tomorrow }this.dateTypeSelect.addOption(f) } })); this.dateTypeSelect.startup(); this.own(A(v.byId("main-page"), "click", r.hitch(this, function () { this.hideDateTimePopup() }))); this.own(E.before(this.dateTypeSelect, "openDropDown", r.hitch(this, function () {
                                                                this.hideDateTimePopup();
                                                                "custom" === this.dateTypeSelect.getValue() && this.dateTimeObj && this.dateTimeObj.value && (this.dateTypeSelect.textDirNode.innerText = this.dateTimeObj.value); "custom" !== this.dateTypeSelect.getValue() && this.dateTimePopup && this.dateTimePopup.hide()
                                                        }))); this.own(E.after(this.dateTypeSelect, "closeDropDown", r.hitch(this, function () {
                                                                this.customId || v.setAttr(this.dateTypeSelect, "aria-label", this.dateTypeSelect.textDirNode.innerText); this.dateTypeSelect.textDirNode.title = ""; setTimeout(r.hitch(this, function () {
                                                                        "custom" ===
                                                                        this.dateTypeSelect.getValue() && this.dateTimeObj && this.dateTimeObj.value && this.dateTypeSelect.textDirNode && (this.dateTypeSelect.textDirNode.innerText = this.dateTimeObj.value, this.dateTypeSelect.textDirNode.title = this.dateTimeObj.value); this.dateTimePopup && this.dateTimePopup.domNode && "block" === v.getStyle(this.dateTimePopup.domNode, "display") && this.dateTimePicker && this.dateTimePicker.calendar && this.dateTimePicker.calendar.focus()
                                                                }), 200)
                                                        }))); this.own(E.after(this.dateTypeSelect.dropDown, "onItemClick",
                                                                r.hitch(this, function (a) { a && "custom" === a.option.value && this.showDateTimePopup() }), !0)); this.popupInfo && this.popupInfo.fieldInfos && (this.fieldInfo = this.popupInfo.fieldInfos.filter(r.hitch(this, function (a) { return a.fieldName === this._fieldInfo.name }))[0])
                                                }, hideDateTimePopup: function () { this.dateTimePopup && this.dateTimePopup.domNode && "block" === v.getStyle(this.dateTimePopup.domNode, "display") && (this.dateTimePicker && !0 === this.dateTimePopupClick ? this.dateTimePopupClick = !1 : this.dateTimePopup.hide()) }, getDijits: function () { return [] },
                                                setValueObject: function (a) {
                                                        if (a.virtualDate && "custom" !== a.virtualDate) this.dateTypeSelect.set("value", a.virtualDate, !1), this.customId || v.setAttr(this.dateTypeSelect, "aria-label", a.virtualDate); else if (this.dateTypeSelect.set("value", "custom", !1), a.value) {
                                                                var f = c.getDateByDateTimeStr(a.value), h = c.localizeDateTimeByFieldInfo(f, this.fieldInfo, a.enableTime, a.timeAccuracy); this.dateTimeObj = { date: f, value: h }; this.dateTypeSelect.textDirNode.innerText = h; this.dateTypeSelect.textDirNode.title = h; this.enableTime =
                                                                        a.enableTime; this.timeAccuracy = a.timeAccuracy; this.customId || v.setAttr(this.dateTypeSelect, "aria-label", this.dateTypeSelect.textDirNode.innerText)
                                                        }
                                                }, getValueObject: function () { return this.isValidValue() ? this.tryGetValueObject() : null }, tryGetValueObject: function () {
                                                        if (this.isInvalidValue()) return null; var a = { value: null, virtualDate: "" }, f = this.dateTypeSelect.get("value"), h = null; "custom" === f ? (h = this.dateTimeObj.date, a.value = h ? c.getDateTimeStr(h, !0) : null, a.virtualDate = "", a.enableTime = this.enableTime ? this.enableTime :
                                                                !1, a.timeAccuracy = this.timeAccuracy ? this.timeAccuracy : "") : (h = d.getRealDateByVirtualDate(f), a.virtualDate = f, h ? a.value = c.getDateTimeStr(h) : a = null); return a
                                                }, setRequired: function () { }, getStatus: function () { return "custom" === this.dateTypeSelect.get("value") ? this.dateTimePicker ? this._getStatusForDijit(this.dateTimePicker) : this.dateTimeObj ? 1 : 0 : "" === this.dateTypeSelect.get("value") ? 0 : 1 }, _getStatusForDijit: function (a) { return a.validate() ? a.get("DisplayedValue") ? 1 : 0 : -1 }, isInvalidValue: function () { return 0 > this.getStatus() },
                                                isEmptyValue: function () { return 0 === this.getStatus() }, isValidValue: function () { return 0 < this.getStatus() }, _onDateTypeSelectChanged: function () { "dateTime" === this.dateTypeSelect.get("value") && this.showDateTimePopup(); this.emit("change", this.dateTypeSelect.get("value")) }, showDateTimePopup: function () {
                                                        if (this.dateTimePopup) this.resize(), this.dateTimePicker.reset(), this.dateTimePopup.show(); else {
                                                                this.dateTimeObj || (this.dateTimeObj = { date: null }); this.dateTimePicker = new e({
                                                                        runtime: this.runtime, value: this.dateTimeObj.date,
                                                                        fieldInfo: this.fieldInfo, enableTime: this.enableTime, timeAccuracy: this.timeAccuracy
                                                                }); this.own(A(this.dateTimePicker, "created", r.hitch(this, function (f) { this.dateTypeSelect.textDirNode.innerText = f.value; this.dateTypeSelect.textDirNode.title = f.value; this.dateTimeObj = f }))); this.own(A(this.dateTimePicker, "timeChange", r.hitch(this, function (f) {
                                                                        f && (this.dateTypeSelect.textDirNode.innerText = f.value, this.dateTypeSelect.textDirNode.title = f.value, this.enableTime = f.enableTime, this.timeAccuracy = f.timeAccuracy,
                                                                                this.dateTimeObj = f, this.emit("change"))
                                                                }))); this.own(A(this.dateTimePicker, "timeStatusChanged", r.hitch(this, function () { this.popupH = this.enableTime ? 353 : 309 }))); this.own(A(this.dateTimePicker, "close", r.hitch(this, function () { this.dateTimePopup.hide(); this.dateTypeSelect.focus() }))); this.runtime ? this._isOnlyShowDate() ? (this.popupH = 265, this.own(A(this.dateTimePicker, "calendarChange", r.hitch(this, function (f) {
                                                                        f && this.dateTypeSelect.textDirNode.innerText !== f.value && (this.dateTypeSelect.textDirNode.innerText =
                                                                                f.value, this.dateTypeSelect.textDirNode.title = f.value, this.enableTime = f.enableTime, this.timeAccuracy = f.timeAccuracy, this.dateTimeObj = f, this.emit("change"))
                                                                })))) : this.popupH = 320 : this.popupH = this.enableTime ? 353 : 309; var a = this._calculatePopup(); this.dateTimePopup = new g({
                                                                        width: this.popupW, autoHeight: !0, classNames: ["dijitCalendarPopup", "jimu-popup-date-time-picker"], content: this.dateTimePicker.domNode, enableMoveable: !1, hasTitle: !1, hasOverlay: !1, contentHasNoMargin: !0, moveToCenter: !1, customPosition: {
                                                                                left: a.left,
                                                                                top: a.top
                                                                        }, useFocusLogic: !1, onClose: r.hitch(this, function () { this.dateTimePopup.hide(); return !1 }), buttons: []
                                                                }); this._isOnlyShowDate() && v.setStyle(this.dateTimePopup.contentContainerNode, { marginBottom: "-3px" }); this.own(A(this.dateTimePopup.domNode, "click", r.hitch(this, function () { this.dateTimePopupClick = !0 }))); this.own(A(this.dateTimePopup.domNode, "keydown", r.hitch(this, function (f) {
                                                                        f.keyCode === w.ESCAPE ? (this.dateTimePopup.hide(), this.dateTypeSelect.focus()) : this.runtime && f.keyCode === w.TAB && (f.preventDefault(),
                                                                                this._isOnlyShowDate() || (v.hasClass(f.target, "dijitCalendarSelectedDate") ? this.dateTimePicker.timeTextBox.focusNode : this.dateTimePicker.calendar).focus())
                                                                })))
                                                        }
                                                }, _getLastBtnFromDTPopup: function () { for (var a = null, f = m(".jimu-btn", this.dateTimePopup.buttonContainer), h = f.length - 1; 0 <= h; h--)if ("none" !== v.getStyle(f[h], "display")) { a = f[h]; break } return a }, _isOnlyShowDate: function () { return this.runtime && !this.enableTime ? !0 : !1 }, _calculatePopup: function () {
                                                        var a = v.getStyle(this.domNode, "width"); this.popupW = 210 <
                                                                a ? a : 210; var f = v.position(this.domNode), h = v.position(document.body).h, p = f.y + 30; h - p < this.popupH && (p = f.y - this.popupH, p = 0 < p ? p : (h - this.popupH) / 2); h = v.position(document.body).w; f.x + this.popupW > h && (f.x -= this.popupW - a); return { left: f.x, top: p - 1 }
                                                }, resize: function () { var a = this._calculatePopup(); this.dateTimePopup.setCustomPosition(a.left, a.top, this.popupW, this.popupH) }, destroy: function () { this.dateTimePopup && (this.dateTimePopup.onClose = r.hitch(this, function () { return !0 }), this.dateTimePopup.close()) }
                                        })
                                })
                }, "jimu/dijit/dateTimePicker": function () {
                        define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang jimu/utils dijit/Calendar dijit/form/TimeTextBox dojo/text!./templates/dateTimePicker.html dojo/on dojo/Evented jimu/dijit/CheckBox".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                        return E([A, w, m, c], {
                                                baseClass: "jimu-datetimepicker", declaredClass: "jimu.datetimepicker", templateString: n, value: null, fieldInfo: null, enableTime: !1, timeAccuracy: "", runtime: !1, postMixInProperties: function () { this.timeNls = window.apiNls.widgets.imageFilter.imageFilterSettings; this.timeUnit = window.jimuNls.timeUnit }, postCreate: function () { this._initSelf() }, _initSelf: function () {
                                                        this.calendar = new l({ value: this.value, "class": "jimu-calendar" }, this.calendarDiv); this.own(d(this.calendar,
                                                                "change", v.hitch(this, function () { this._valueChange(); this.runtime && !this.enableTime && this.emit("close") }))); this.calendar.startup(); if (this.runtime) if (q.setStyle(this.timeTextContainerSetting, "display", "none"), this.enableTime) {
                                                                        q.setStyle(this.timeTextContainerRuntime, "display", "block"); var g = { constraints: { timePattern: "s" === this.timeAccuracy ? "HH:mm:ss" : "m" === this.timeAccuracy ? "HH:mm" : "HH", clickableIncrement: "T00:30:00", visibleIncrement: "T01:00:00", visibleRange: "T01:00:00" } }; "h" === this.timeAccuracy &&
                                                                                (g.constraints.clickableIncrement = "T01:00:00"); this.timeTextBox = new k(g, this.timeTextBoxDiv); this.own(d(this.timeTextBox, "change", v.hitch(this, function () { this.enableTime = "" === this.timeTextBox.displayedValue ? !1 : !0; this._valueChange() }))); this.timeTextBox.startup(); this.timeTextBox.set("value", this.value)
                                                                } else q.setStyle(this.timeTextContainerRuntime, "display", "none"); else q.setStyle(this.timeTextContainerRuntime, "display", "none"), q.setStyle(this.timeTextContainerSetting, "display", "block"), this._initTimePickers();
                                                        this._enableTime = this.enableTime; this.emit("created", this.getValueObj())
                                                }, _initTimePickers: function () {
                                                        this.timeCheckbox.setValue(this.enableTime); this.enableTime && (q.setStyle(this.timeTableContainer, "display", "block"), this.value && this._setTimeBox_HMS(this.value)); this.own(d(this.timeCheckbox, "change", v.hitch(this, function () { this._changeTimeCheckStatus(); this._valueChange(); this.emit("timeStatusChanged") }))); this.own(d(this.hourSelect, "change", v.hitch(this, function () { this._valueChange() }))); this.own(d(this.minuteSelect,
                                                                "change", v.hitch(this, function () { this._valueChange() }))); this.own(d(this.secondSelect, "change", v.hitch(this, function () { this._valueChange() })))
                                                }, _changeTimeCheckStatus: function () { (this._enableTime = this.timeCheckbox.checked) ? q.setStyle(this.timeTableContainer, "display", "block") : q.setStyle(this.timeTableContainer, "display", "none") }, _valueChange: function () { this.emit("timeChange", this.getValueObj()) }, isValid: function () {
                                                        if (null === this.calendar.value) return !1; if (this.runtime) { if (this._enableTime && !this.timeTextBox.isValid()) return !1 } else if (this.timeCheckbox.checked) {
                                                                if (!this.hourSelect.isValid() ||
                                                                        !this.minuteSelect.isValid() || !this.secondSelect.isValid() || "" === this.hourSelect.displayedValue || "" !== this.hourSelect.displayedValue && "" !== this.secondSelect.displayedValue && "" === this.minuteSelect.displayedValue) return !1
                                                        } else this.hourSelect.isValid() || this.hourSelect.set("value", null), this.minuteSelect.isValid() || this.minuteSelect.set("value", null), this.secondSelect.isValid() || this.secondSelect.set("value", null); return !0
                                                }, getValueObj: function () {
                                                        if (!this.isValid()) return !1; var g = new Date(this.calendar.value.toDateString());
                                                        if (this.runtime) { if (this.enableTime) { var b = this.timeTextBox.get("value"); b && (g.setHours(b.getHours()), g.setMinutes(b.getMinutes()), g.setSeconds(b.getSeconds())) } } else if (this.enableTime = this._enableTime) { b = this.hourSelect.get("value"); var e = this.minuteSelect.get("value"), a = this.secondSelect.get("value"); this.timeAccuracy = a ? "s" : e ? "m" : "h"; g.setHours(b ? b.getHours() : null); g.setMinutes(e ? e.getMinutes() : null); g.setSeconds(a ? a.getSeconds() : null) } else this.timeAccuracy = ""; b = r.localizeDateTimeByFieldInfo(g,
                                                                this.fieldInfo, this.enableTime, this.timeAccuracy); this.value = g; return { date: g, value: b, enableTime: this.enableTime, timeAccuracy: this.timeAccuracy }
                                                }, validate: function () { this.set("DisplayedValue", this.calendar.value ? 1 : 0); return !0 }, reset: function () {
                                                        var g = this.calendar.get("value"); g && this.value && this.value.toDateString() === g.toDateString() || this.calendar.set("value", this.value); this.timeCheckbox.setValue(this.enableTime); this.runtime ? this.enableTime && this.timeTextBox.set("value", this.value) : this._setTimeBox_HMS(this.enableTime ?
                                                                this.value : null)
                                                }, _setTimeBox_HMS: function (g) { var b = null, e = null, a = null; "h" === this.timeAccuracy ? b = g : "m" === this.timeAccuracy ? b = e = g : "s" === this.timeAccuracy && (b = e = a = g); this.hourSelect.set("value", b); this.minuteSelect.set("value", e); this.secondSelect.set("value", a) }
                                        })
                                })
                }, "dijit/Calendar": function () {
                        define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                        var h = w("dijit.Calendar", [g, b, e], {
                                                baseClass: "dijitCalendar", cssStateNodes: { decrementMonth: "dijitCalendarArrow", incrementMonth: "dijitCalendarArrow", previousYearLabelNode: "dijitCalendarPreviousYear", nextYearLabelNode: "dijitCalendarNextYear" }, setValue: function (p) { l.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.", "", "2.0"); this.set("value", p) }, _createMonthWidget: function () {
                                                        return new h._MonthDropDownButton({
                                                                id: this.id + "_mddb",
                                                                tabIndex: -1, onMonthSelect: n.hitch(this, "_onMonthSelect"), lang: this.lang, dateLocaleModule: this.dateLocaleModule
                                                        }, this.monthNode)
                                                }, postCreate: function () { this.inherited(arguments); this.own(d(this.domNode, "keydown", n.hitch(this, "_onKeyDown")), d(this.dateRowsNode, "mouseover", n.hitch(this, "_onDayMouseOver")), d(this.dateRowsNode, "mouseout", n.hitch(this, "_onDayMouseOut")), d(this.dateRowsNode, "mousedown", n.hitch(this, "_onDayMouseDown")), d(this.dateRowsNode, "mouseup", n.hitch(this, "_onDayMouseUp"))) }, _onMonthSelect: function (p) {
                                                        var B =
                                                                new this.dateClassObj(this.currentFocus); B.setDate(1); B.setMonth(p); p = this.dateModule.getDaysInMonth(B); var t = this.currentFocus.getDate(); B.setDate(Math.min(t, p)); this._setCurrentFocusAttr(B)
                                                }, _onDayMouseOver: function (p) { (p = v.contains(p.target, "dijitCalendarDateLabel") ? p.target.parentNode : p.target) && (p.dijitDateValue && !v.contains(p, "dijitCalendarDisabledDate") || p == this.previousYearLabelNode || p == this.nextYearLabelNode) && (v.add(p, "dijitCalendarHoveredDate"), this._currentNode = p) }, _onDayMouseOut: function (p) {
                                                        !this._currentNode ||
                                                        p.relatedTarget && p.relatedTarget.parentNode == this._currentNode || (p = "dijitCalendarHoveredDate", v.contains(this._currentNode, "dijitCalendarActiveDate") && (p += " dijitCalendarActiveDate"), v.remove(this._currentNode, p), this._currentNode = null)
                                                }, _onDayMouseDown: function (p) { (p = p.target.parentNode) && p.dijitDateValue && !v.contains(p, "dijitCalendarDisabledDate") && (v.add(p, "dijitCalendarActiveDate"), this._currentNode = p) }, _onDayMouseUp: function (p) { (p = p.target.parentNode) && p.dijitDateValue && v.remove(p, "dijitCalendarActiveDate") },
                                                handleKey: function (p) { var B = -1, t = this.currentFocus; switch (p.keyCode) { case k.RIGHT_ARROW: B = 1; case k.LEFT_ARROW: var u = "day"; this.isLeftToRight() || (B *= -1); break; case k.DOWN_ARROW: B = 1; case k.UP_ARROW: u = "week"; break; case k.PAGE_DOWN: B = 1; case k.PAGE_UP: u = p.ctrlKey || p.altKey ? "year" : "month"; break; case k.END: t = this.dateModule.add(t, "month", 1), u = "day"; case k.HOME: t = new this.dateClassObj(t); t.setDate(1); break; default: return !0 }u && (t = this.dateModule.add(t, u, B)); this._setCurrentFocusAttr(t); return !1 }, _onKeyDown: function (p) {
                                                        this.handleKey(p) ||
                                                        (p.stopPropagation(), p.preventDefault())
                                                }, onValueSelected: function () { }, onChange: function (p) { this.onValueSelected(p) }, getClassForDate: function () { }
                                        }); h._MonthDropDownButton = w("dijit.Calendar._MonthDropDownButton", f, {
                                                onMonthSelect: function () { }, postCreate: function () { this.inherited(arguments); this.dropDown = new h._MonthDropDown({ id: this.id + "_mdd", onChange: this.onMonthSelect }) }, _setMonthAttr: function (p) {
                                                        var B = this.dateLocaleModule.getNames("months", "wide", "standAlone", this.lang, p); this.dropDown.set("months",
                                                                B); this.containerNode.innerHTML = (6 == c("ie") ? "" : "\x3cdiv class\x3d'dijitSpacer'\x3e" + this.dropDown.domNode.innerHTML + "\x3c/div\x3e") + "\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e" + B[p.getMonth()] + "\x3c/div\x3e"
                                                }
                                        }); h._MonthDropDown = w("dijit.Calendar._MonthDropDown", [b, a, e], {
                                                months: [], baseClass: "dijitCalendarMonthMenu dijitMenu", templateString: "\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e", _setMonthsAttr: function (p) {
                                                        this.domNode.innerHTML =
                                                        ""; E.forEach(p, function (B, t) { r.create("div", { className: "dijitCalendarMonthLabel", month: t, innerHTML: B }, this.domNode)._cssState = "dijitCalendarMonthLabel" }, this)
                                                }, _onClick: function (p) { this.onChange(m.get(p.target, "month")) }, onChange: function () { }
                                        }); return h
                                })
                }, "dijit/CalendarLite": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a) {
                                        var f = q("dijit.CalendarLite", [b, e], {
                                                templateString: a, dowTemplateString: '\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e', dateTemplateString: '\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
                                                weekTemplateString: '\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e', value: new Date(""), datePackage: "", dayWidth: "narrow", tabIndex: "0", dayOffset: -1, currentFocus: new Date, _setSummaryAttr: "gridNode", baseClass: "dijitCalendar dijitCalendarLite", _isValidDate: function (h) { return h && !isNaN(h) && "object" == typeof h && h.toString() != this.constructor.prototype.value.toString() }, _getValueAttr: function () {
                                                        var h = this._get("value"); if (h && !isNaN(h)) {
                                                                var p =
                                                                        new this.dateClassObj(h); p.setHours(0, 0, 0, 0); p.getDate() < h.getDate() && (p = this.dateModule.add(p, "hour", 1)); return p
                                                        } return null
                                                }, _setValueAttr: function (h, p) { "string" == typeof h && (h = v.fromISOString(h)); h = this._patchDate(h); if (this._isValidDate(h) && !this.isDisabledDate(h, this.lang)) { if (this._set("value", h), this.set("currentFocus", h), this._markSelectedDates([h]), this._created && (p || "undefined" == typeof p)) this.onChange(this.get("value")) } else this._set("value", null), this._markSelectedDates([]) }, _patchDate: function (h) {
                                                        if (h ||
                                                                0 === h) h = new this.dateClassObj(h), h.setHours(1, 0, 0, 0); return h
                                                }, _setText: function (h, p) { for (; h.firstChild;)h.removeChild(h.firstChild); h.appendChild(h.ownerDocument.createTextNode(p)) }, _populateGrid: function () {
                                                        var h = new this.dateClassObj(this.currentFocus); h.setDate(1); h = this._patchDate(h); var p = h.getDay(), B = this.dateModule.getDaysInMonth(h), t = this.dateModule.getDaysInMonth(this.dateModule.add(h, "month", -1)), u = new this.dateClassObj, z = 0 <= this.dayOffset ? this.dayOffset : A.getFirstDayOfWeek(this.lang); z >
                                                                p && (z -= 7); if (!this.summary) { var x = this.dateLocaleModule.getNames("months", "wide", "standAlone", this.lang, h); this.gridNode.setAttribute("summary", x[h.getMonth()]) } this._date2cell = {}; E.forEach(this.dateCells, function (y, D) {
                                                                        var H = D + z, I = new this.dateClassObj(h), N = "dijitCalendar", T = 0; H < p ? (H = t - p + H + 1, T = -1, N += "Previous") : H >= p + B ? (H = H - p - B + 1, T = 1, N += "Next") : (H = H - p + 1, N += "Current"); T && (I = this.dateModule.add(I, "month", T)); I.setDate(H); this.dateModule.compare(I, u, "date") || (N = "dijitCalendarCurrentDate " + N); this.isDisabledDate(I,
                                                                                this.lang) ? (N = "dijitCalendarDisabledDate " + N, y.setAttribute("aria-disabled", "true")) : (N = "dijitCalendarEnabledDate " + N, y.removeAttribute("aria-disabled"), y.setAttribute("aria-selected", "false")); (T = this.getClassForDate(I, this.lang)) && (N = T + " " + N); y.className = N + "Month dijitCalendarDateTemplate"; N = I.valueOf(); this._date2cell[N] = y; y.dijitDateValue = N; N = I.getDateLocalized ? I.getDateLocalized(this.lang) : I.getDate(); this._setText(this.dateLabels[D], N); k.set(y, "aria-label", m.format(I, { selector: "date", formatLength: "long" }))
                                                                },
                                                                        this)
                                                }, _populateControls: function () { var h = new this.dateClassObj(this.currentFocus); h.setDate(1); this.monthWidget.set("month", h); var p = h.getFullYear() - 1, B = new this.dateClassObj; E.forEach(["previous", "current", "next"], function (t) { B.setFullYear(p++); this._setText(this[t + "YearLabelNode"], this.dateLocaleModule.format(B, { selector: "year", locale: this.lang })) }, this) }, goToToday: function () { this.set("value", new this.dateClassObj) }, constructor: function (h) {
                                                        this.dateModule = h.datePackage ? n.getObject(h.datePackage,
                                                                !1) : w; this.dateClassObj = this.dateModule.Date || Date; this.dateLocaleModule = h.datePackage ? n.getObject(h.datePackage + ".locale", !1) : m
                                                }, _createMonthWidget: function () { return f._MonthWidget({ id: this.id + "_mddb", lang: this.lang, dateLocaleModule: this.dateLocaleModule }, this.monthNode) }, buildRendering: function () {
                                                        var h = this.dowTemplateString, p = this.dateLocaleModule.getNames("days", this.dayWidth, "standAlone", this.lang), B = 0 <= this.dayOffset ? this.dayOffset : A.getFirstDayOfWeek(this.lang); this.dayCellsHtml = g.substitute([h,
                                                                h, h, h, h, h, h].join(""), { d: "" }, function () { return p[B++ % 7] }); h = g.substitute(this.weekTemplateString, { d: this.dateTemplateString }); this.dateRowsHtml = [h, h, h, h, h, h].join(""); this.dateCells = []; this.dateLabels = []; this.inherited(arguments); r.setSelectable(this.domNode, !1); h = new this.dateClassObj(this.currentFocus); this.monthWidget = this._createMonthWidget(); this.set("currentFocus", h, !1)
                                                }, postCreate: function () { this.inherited(arguments); this._connectControls() }, _connectControls: function () {
                                                        var h = n.hitch(this, function (p,
                                                                B, t) { this[p].dojoClick = !0; return d(this[p], "click", n.hitch(this, function () { this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus, B, t)) })) }); this.own(h("incrementMonth", "month", 1), h("decrementMonth", "month", -1), h("nextYearLabelNode", "year", 1), h("previousYearLabelNode", "year", -1))
                                                }, _setCurrentFocusAttr: function (h, p) {
                                                        var B = this.currentFocus, t = this._getNodeByDate(B); h = this._patchDate(h); this._set("currentFocus", h); this._date2cell && 0 == this.dateModule.difference(B, h, "month") || (this._populateGrid(),
                                                                this._populateControls(), this._markSelectedDates([this.value])); h = this._getNodeByDate(h); h.setAttribute("tabIndex", this.tabIndex); (this.focused || p) && h.focus(); t && t != h && (c("webkit") ? t.setAttribute("tabIndex", "-1") : t.removeAttribute("tabIndex"))
                                                }, focus: function () { this._setCurrentFocusAttr(this.currentFocus, !0) }, _onDayClick: function (h) {
                                                        h.stopPropagation(); h.preventDefault(); for (h = h.target; h && !h.dijitDateValue && 0 !== h.dijitDateValue; h = h.parentNode); h && !l.contains(h, "dijitCalendarDisabledDate") && this.set("value",
                                                                h.dijitDateValue)
                                                }, _getNodeByDate: function (h) { return (h = this._patchDate(h)) && this._date2cell ? this._date2cell[h.valueOf()] : null }, _markSelectedDates: function (h) { function p(B, t) { l.toggle(t, "dijitCalendarSelectedDate", B); t.setAttribute("aria-selected", B ? "true" : "false") } E.forEach(this._selectedCells || [], n.partial(p, !1)); this._selectedCells = E.filter(E.map(h, this._getNodeByDate, this), function (B) { return B }); E.forEach(this._selectedCells, n.partial(p, !0)) }, onChange: function () { }, isDisabledDate: function () { }, getClassForDate: function () { }
                                        });
                                        f._MonthWidget = q("dijit.CalendarLite._MonthWidget", b, { _setMonthAttr: function (h) { var p = this.dateLocaleModule.getNames("months", "wide", "standAlone", this.lang, h), B = 6 == c("ie") ? "" : "\x3cdiv class\x3d'dijitSpacer'\x3e" + E.map(p, function (t) { return "\x3cdiv\x3e" + t + "\x3c/div\x3e" }).join("") + "\x3c/div\x3e"; this.domNode.innerHTML = B + "\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e" + p[h.getMonth()] + "\x3c/div\x3e" } }); return f
                                })
                }, "dijit/form/TimeTextBox": function () {
                        define("dojo/_base/declare dojo/keys dojo/query dojo/_base/lang ../_TimePicker ./_DateTimeTextBox".split(" "),
                                function (E, q, A, w, m, v) {
                                        return E("dijit.form.TimeTextBox", v, {
                                                baseClass: "dijitTextBox dijitComboBox dijitTimeTextBox", popupClass: m, _selector: "time", value: new Date(""), maxHeight: -1, openDropDown: function (r) {
                                                        this.inherited(arguments); var l = A(".dijitTimePickerItemSelected", this.dropDown.domNode), k = this.dropDown.domNode.parentNode; k.scrollTop = l[0] ? l[0].offsetTop - (k.clientHeight - l[0].clientHeight) / 2 : (k.scrollHeight - k.clientHeight) / 2; this.dropDown.on("input", w.hitch(this, function () {
                                                                this.set("value", this.dropDown.get("value"),
                                                                        !1)
                                                        }))
                                                }, _onInput: function () { this.inherited(arguments); var r = this.get("displayedValue"); this.filterString = r && !this.parse(r, this.constraints) ? r.toLowerCase() : ""; this._opened && this.closeDropDown(); this.openDropDown() }
                                        })
                                })
                }, "dijit/_TimePicker": function () {
                        define("dojo/_base/array dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/sniff dojo/query dojo/mouse dojo/on ./_WidgetBase ./form/_ListMouseMixin".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a) {
                                        return m("dijit._TimePicker", [e, a], {
                                                baseClass: "dijitTimePicker", pickerMin: "T00:00:00", pickerMax: "T23:59:59", clickableIncrement: "T00:15:00", visibleIncrement: "T01:00:00", value: new Date, _visibleIncrement: 2, _clickableIncrement: 1, _totalIncrements: 10, constraints: {}, serialize: w.toISOString, buildRendering: function () { this.inherited(arguments); this.timeMenu = this.containerNode = this.domNode }, setValue: function (f) {
                                                        l.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.",
                                                                "", "2.0"); this.set("value", f)
                                                }, _setValueAttr: function (f) { this._set("value", f); this._showText() }, _setFilterStringAttr: function (f) { this._set("filterString", f); this._showText() }, isDisabledDate: function () { return !1 }, _getFilteredNodes: function (f, h, p, B) { f = this.ownerDocument.createDocumentFragment(); for (h = 0; h < this._maxIncrement; h++)(p = this._createOption(h)) && f.appendChild(p); return f }, _showText: function () {
                                                        var f = w.fromISOString; this.domNode.innerHTML = ""; this._clickableIncrementDate = f(this.clickableIncrement);
                                                        this._visibleIncrementDate = f(this.visibleIncrement); var h = function (B) { return 3600 * B.getHours() + 60 * B.getMinutes() + B.getSeconds() }, p = h(this._clickableIncrementDate); h = h(this._visibleIncrementDate); (this.value || this.currentFocus).getTime(); this._refDate = f(this.pickerMin); this._refDate.setFullYear(1970, 0, 1); this._clickableIncrement = 1; this._visibleIncrement = h / p; f = f(this.pickerMax); f.setFullYear(1970, 0, 1); f = .001 * (f.getTime() - this._refDate.getTime()); this._maxIncrement = Math.ceil((f + 1) / p); p = this._getFilteredNodes();
                                                        !p.firstChild && this.filterString ? (this.filterString = "", this._showText()) : this.domNode.appendChild(p)
                                                }, constructor: function () { this.constraints = {} }, postMixInProperties: function () { this.inherited(arguments); this._setConstraintsAttr(this.constraints) }, _setConstraintsAttr: function (f) { for (var h in { clickableIncrement: 1, visibleIncrement: 1, pickerMin: 1, pickerMax: 1 }) h in f && (this[h] = f[h]); f.locale || (f.locale = this.lang) }, _createOption: function (f) {
                                                        var h = new Date(this._refDate), p = this._clickableIncrementDate; h.setHours(h.getHours() +
                                                                p.getHours() * f, h.getMinutes() + p.getMinutes() * f, h.getSeconds() + p.getSeconds() * f); "time" == this.constraints.selector && h.setFullYear(1970, 0, 1); var B = A.format(h, this.constraints); if (this.filterString && 0 !== B.toLowerCase().indexOf(this.filterString)) return null; p = this.ownerDocument.createElement("div"); p.className = this.baseClass + "Item"; p.date = h; p.idx = f; r.create("div", { "class": this.baseClass + "ItemInner", innerHTML: B }, p); B = 1 > f % this._visibleIncrement && -1 < f % this._visibleIncrement; f = !B && !(f % this._clickableIncrement);
                                                        B ? p.className += " " + this.baseClass + "Marker" : f && (p.className += " " + this.baseClass + "Tick"); this.isDisabledDate(h) && (p.className += " " + this.baseClass + "ItemDisabled"); this.value && !q.compare(this.value, h, this.constraints.selector) && (p.selected = !0, p.className += " " + this.baseClass + "ItemSelected", this._selectedDiv = p, B ? p.className += " " + this.baseClass + "MarkerSelected" : f && (p.className += " " + this.baseClass + "TickSelected"), this._highlightOption(p, !0)); return p
                                                }, onOpen: function () {
                                                        this.inherited(arguments); this.set("selected",
                                                                this._selectedDiv)
                                                }, _onOptionSelected: function (f, h) { (f = f.target.date || f.target.parentNode.date) && !this.isDisabledDate(f) && (this._set("value", f), this.emit("input"), h && (this._highlighted_option = null, this.set("value", f), this.onChange(f))) }, onChange: function () { }, _highlightOption: function (f, h) {
                                                        if (f) {
                                                                if (h) this._highlighted_option && this._highlightOption(this._highlighted_option, !1), this._highlighted_option = f; else { if (this._highlighted_option !== f) return; this._highlighted_option = null } v.toggle(f, this.baseClass +
                                                                        "ItemHover", h); v.contains(f, this.baseClass + "Marker") ? v.toggle(f, this.baseClass + "MarkerHover", h) : v.toggle(f, this.baseClass + "TickHover", h)
                                                        }
                                                }, handleKey: function (f) {
                                                        if (f.keyCode == k.DOWN_ARROW) return this.selectNextNode(), this._onOptionSelected({ target: this._highlighted_option }, !1), f.stopPropagation(), f.preventDefault(), !1; if (f.keyCode == k.UP_ARROW) return this.selectPreviousNode(), this._onOptionSelected({ target: this._highlighted_option }, !1), f.stopPropagation(), f.preventDefault(), !1; if (f.keyCode == k.ENTER ||
                                                                f.keyCode === k.TAB) { if (!this._keyboardSelected && f.keyCode === k.TAB) return !0; this._highlighted_option && this._onOptionSelected({ target: this._highlighted_option }, !0); return f.keyCode === k.TAB }
                                                }, onHover: function (f) { this._highlightOption(f, !0) }, onUnhover: function (f) { this._highlightOption(f, !1) }, onSelect: function (f) { this._highlightOption(f, !0) }, onDeselect: function (f) { this._highlightOption(f, !1) }, onClick: function (f) { this._onOptionSelected({ target: f }, !0) }
                                        })
                                })
                }, "dijit/form/_DateTimeTextBox": function () {
                        define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        new Date("X"); return w("dijit.form._DateTimeTextBox", [v, r], {
                                                templateString: l, hasDownArrow: !0, cssStateNodes: { _buttonNode: "dijitDownArrowButton" }, _unboundedConstraints: {}, pattern: q.regexp, datePackage: "", postMixInProperties: function () { this.inherited(arguments); this._set("type", "text") }, compare: function (k, n) {
                                                        var d = this._isInvalidDate(k), c = this._isInvalidDate(n); if (d || c) return d && c ? 0 : d ? -1 : 1; k = this.format(k, this._unboundedConstraints); n = this.format(n, this._unboundedConstraints);
                                                        d = this.parse(k, this._unboundedConstraints); c = this.parse(n, this._unboundedConstraints); return k == n ? 0 : E.compare(d, c, this._selector)
                                                }, autoWidth: !0, format: function (k, n) { return k ? this.dateLocaleModule.format(k, n) : "" }, parse: function (k, n) { return this.dateLocaleModule.parse(k, n) || (this._isEmpty(k) ? null : void 0) }, serialize: function (k, n) { k.toGregorian && (k = k.toGregorian()); return A.toISOString(k, n) }, dropDownDefaultValue: new Date, value: new Date(""), _blankValue: null, popupClass: "", _selector: "", constructor: function (k) {
                                                        k =
                                                        k || {}; this.dateModule = k.datePackage ? m.getObject(k.datePackage, !1) : E; this.dateClassObj = this.dateModule.Date || Date; this.dateClassObj instanceof Date || (this.value = new this.dateClassObj(this.value)); this.dateLocaleModule = k.datePackage ? m.getObject(k.datePackage + ".locale", !1) : q; this._set("pattern", this.dateLocaleModule.regexp); this._invalidDate = this.constructor.prototype.value.toString()
                                                }, buildRendering: function () {
                                                        this.inherited(arguments); this.hasDownArrow || (this._buttonNode.style.display = "none"); this.hasDownArrow ||
                                                                (this._buttonNode = this.domNode, this.baseClass += " dijitComboBoxOpenOnClick")
                                                }, _setConstraintsAttr: function (k) { k.selector = this._selector; k.fullYear = !0; var n = A.fromISOString; "string" == typeof k.min && (k.min = n(k.min), this.dateClassObj instanceof Date || (k.min = new this.dateClassObj(k.min))); "string" == typeof k.max && (k.max = n(k.max), this.dateClassObj instanceof Date || (k.max = new this.dateClassObj(k.max))); this.inherited(arguments); this._unboundedConstraints = m.mixin({}, this.constraints, { min: null, max: null }) }, _isInvalidDate: function (k) {
                                                        return !k ||
                                                                isNaN(k) || "object" != typeof k || k.toString() == this._invalidDate
                                                }, _setValueAttr: function (k, n, d) { void 0 !== k && ("string" == typeof k && (k = A.fromISOString(k)), this._isInvalidDate(k) && (k = null), k instanceof Date && !(this.dateClassObj instanceof Date) && (k = new this.dateClassObj(k))); this.inherited(arguments, [k, n, d]); this.value instanceof Date && (this.filterString = ""); !1 !== n && this.dropDown && this.dropDown.set("value", k, !1) }, _set: function (k, n) {
                                                        if ("value" == k) {
                                                                n instanceof Date && !(this.dateClassObj instanceof Date) &&
                                                                (n = new this.dateClassObj(n)); var d = this._get("value"); if (d instanceof this.dateClassObj && 0 == this.compare(n, d)) return
                                                        } this.inherited(arguments)
                                                }, _setDropDownDefaultValueAttr: function (k) { this._isInvalidDate(k) && (k = new this.dateClassObj); this._set("dropDownDefaultValue", k) }, openDropDown: function (k) {
                                                        this.dropDown && this.dropDown.destroy(); var n = m.isString(this.popupClass) ? m.getObject(this.popupClass, !1) : this.popupClass, d = this, c = this.get("value"); this.dropDown = new n({
                                                                onChange: function (g) {
                                                                        d.set("value",
                                                                                g, !0)
                                                                }, id: this.id + "_popup", dir: d.dir, lang: d.lang, value: c, textDir: d.textDir, currentFocus: this._isInvalidDate(c) ? this.dropDownDefaultValue : c, constraints: d.constraints, filterString: d.filterString, datePackage: d.datePackage, isDisabledDate: function (g) { return !d.rangeCheck(g, d.constraints) }
                                                        }); this.inherited(arguments)
                                                }, _getDisplayedValueAttr: function () { return this.textbox.value }, _setDisplayedValueAttr: function (k, n) { this._setValueAttr(this.parse(k, this.constraints), n, k) }
                                        })
                                })
                }, "jimu/dijit/_filter/TwoNumbersValueProvider": function () {
                        define("dojo/_base/html dojo/_base/lang dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox jimu/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        return A([w, m, v], {
                                                templateString: r, customId: null, postCreate: function () {
                                                        this.inherited(arguments); E.addClass(this.domNode, "jimu-two-numbers-filter-value-provider"); this.customId = this.partObj.vpId; var n = { required: !1, intermediateChanges: !0, constraints: { pattern: "#####0.##########" } }, d = q.clone(n); if (this.customId) {
                                                                n.id = this.customId + "_between"; var c = this.customId; var g = E.toDom('\x3clabel for\x3d"' + n.id + '" class\x3d"screen-readers-only"\x3e' + this.partObj.interactiveObj.prompt +
                                                                        " " + this.partObj.interactiveObj.hint + "\x3c/label\x3e"); E.place(g, this._dijit1_container)
                                                        } else c = k.getUUID(); d.id = c + "_and"; c = E.toDom('\x3clabel for\x3d"' + d.id + '" class\x3d"screen-readers-only"\x3e' + this.nls.and + "\x3c/label\x3e"); E.place(c, this._dijit2_container); this._dijit1 = new l(n); this._dijit2 = new l(d); this._dijit1.startup(); this._dijit2.startup(); this._dijit1.on("blur", function () { this._onRangeNumberBlur() }.bind(this)); this._dijit2.on("blur", function () { this._onRangeNumberBlur() }.bind(this)); E.setStyle(this._dijit1.domNode,
                                                                "width", "100%"); E.setStyle(this._dijit2.domNode, "width", "100%"); this._dijit1.placeAt(this._dijit1_container); this._dijit2.placeAt(this._dijit2_container)
                                                }, _onRangeNumberBlur: function () { if (this._dijit1.validate() && this._dijit2.validate()) { var n = parseFloat(this._dijit1.get("value")), d = parseFloat(this._dijit2.get("value")); n > d && (this._dijit1.set("value", d), this._dijit2.set("value", n)) } }, getDijits: function () { return [this._dijit1, this._dijit2] }, setValueObject: function (n) {
                                                        this.isDefined(n.value1) && this._dijit1.set("value",
                                                                n.value1); this.isDefined(n.value2) && this._dijit2.set("value", n.value2)
                                                }, getValueObject: function () { return this.isValidValue() ? { isValid: !0, type: this.partObj.valueObj.type, value1: parseFloat(this._dijit1.get("value")), value2: parseFloat(this._dijit2.get("value")) } : null }, tryGetValueObject: function () {
                                                        if (this.isValidValue()) return this.getValueObject(); if (this.isEmptyValue()) {
                                                                var n = { isValid: !0, type: this.partObj.valueObj.type, value1: parseFloat(this._dijit1.get("value")), value2: parseFloat(this._dijit2.get("value")) };
                                                                isNaN(n.value1) && (n.value1 = null); isNaN(n.value2) && (n.value2 = null); return n
                                                        } return null
                                                }, setRequired: function (n) { this._dijit1.set("required", n); this._dijit2.set("required", n) }
                                        })
                                })
                }, "jimu/dijit/_filter/TwoDatesValueProvider": function () {
                        define("dojo/Evented dojo/on dojo/_base/html dojo/_base/declare dojo/_base/lang ./ValueProvider dijit/_WidgetsInTemplateMixin ./DateValueSelector dojo/text!./TwoDatesValueProvider.html jimu/utils".split(" "), function (E, q, A, w, m, v, r, l, k, n) {
                                return w([v, r, E], {
                                        templateString: k,
                                        customId: null, postCreate: function () {
                                                this.inherited(arguments); this.customId = this.partObj.vpId; A.addClass(this.domNode, "jimu-two-dates-filter-value-provider"); var d = { runtime: this.runtime, popupInfo: this.popupInfo, _fieldInfo: this.fieldInfo, style: { width: "100%" } }, c = m.clone(d); if (this.customId) { d.customId = this.customId + "_between"; d.prompt = this.partObj.interactiveObj.prompt + " " + this.partObj.interactiveObj.hint; var g = this.customId } else g = n.getUUID(); c.customId = g + "_and"; c.prompt = this.nls.and; this.runtime &&
                                                        (d.virtualDates = this.partObj.interactiveObj.virtualDates1, c.virtualDates = this.partObj.interactiveObj.virtualDates2); this._dijit1 = new l(d, this._dijitDiv1); this._dijit2 = new l(c, this._dijitDiv2); this.own(q(this._dijit1, "change", m.hitch(this, function (b) { this.emit("change", b, "start") }))); this.own(q(this._dijit2, "change", m.hitch(this, function (b) { this.emit("change", b, "end") })))
                                        }, _initDateSelectors: function () { }, _onDateValueSelectorChanged: function () { this.emit("change") }, getDijits: function () {
                                                return [this._dijit1,
                                                this._dijit2]
                                        }, setValueObject: function (d) { this._setValueObject(this._dijit1, d, 1); this._setValueObject(this._dijit2, d, 2) }, _setValueObject: function (d, c, g) { var b = "value" + g; if (this.isDefined(c[b])) { var e = { enableTime: c["enableTime" + g], timeAccuracy: c["timeAccuracy" + g], value: null, virtualDate: "" }; e.value = c[b]; e.virtualDate = c["virtualDate" + g]; d.setValueObject(e) } }, getValueObject: function () {
                                                if (this.isValidValue()) {
                                                        var d = this._dijit1.getValueObject(), c = this._dijit2.getValueObject(); if (d.value && c.value) return {
                                                                isValid: !0,
                                                                type: this.partObj.valueObj.type, enableTime1: d.enableTime ? !0 : !1, timeAccuracy1: d.timeAccuracy ? d.timeAccuracy : "", enableTime2: c.enableTime ? !0 : !1, timeAccuracy2: c.timeAccuracy ? c.timeAccuracy : "", value1: d.value, value2: c.value, virtualDate1: d.virtualDate, virtualDate2: c.virtualDate
                                                        }
                                                } return null
                                        }, tryGetValueObject: function () { return this.isValidValue() ? this.getValueObject() : this.isEmptyValue() ? { isValid: !0, type: this.partObj.valueObj.type, value1: null, value2: null, virtualDate1: null, virtualDate2: null } : null }, getStatus: function () {
                                                return 1 ===
                                                        this._dijit1.getStatus() && 1 === this._dijit2.getStatus() ? 1 : -1 === this._dijit1.getStatus() || -1 === this._dijit2.getStatus() ? -1 : 0
                                        }, setRequired: function (d) { this._dijit1.set("required", d); this._dijit2.set("required", d) }
                                })
                        })
                }, "jimu/dijit/_filter/ListValueProvider": function () {
                        define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/_base/declare ./ValueProvider dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                return r([l],
                                        {
                                                templateString: "\x3cdiv\x3e\x3c/div\x3e", codedValues: null, staticValues: null, showNullValues: !1, layerDataChanged: !1, ifDropDown: !1, customId: null, postCreate: function () {
                                                        this.inherited(arguments); w.addClass(this.domNode, "jimu-filter-list-value-provider"); this.customId = this.partObj.vpId; this._initValueSelect(); this._uniqueValueCache = {}; this.noDataTips = '\x3cdiv class\x3d"error-tip-section" style\x3d"display: block;"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text"\x3e' +
                                                                this.nls.noFilterValueTip + "\x3c/span\x3e\x3c/div\x3e"; var c = new k({ idProperty: "id", data: [] }); this.valuesSelect.set("store", c); this.isNumberField = n.isNumberField(this.fieldInfo.type); !this.staticValues && "function" === typeof this.valuesSelect._onDropDownMouseDown && (!this.codedValues || this.codedValues && this.filterCodedValue) && (this.own(E.before(this.valuesSelect, "_onDropDownMouseDown", A.hitch(this, this._onBeforeDropDownMouseDown))), this.own(v(document.body, "click", A.hitch(this, this._onBodyClick))), this.layerInfo &&
                                                                        this.layerInfo.getLayerObject().then(A.hitch(this, function (g) { g.on("edits-complete", A.hitch(this, function () { this.layerDataChanged = !0 })) })))
                                                }, _initValueSelect: function () {
                                                        var c = { searchAttr: "label", required: !1, intermediateChanges: !0 }; this.customId && (c["aria-label"] = this.partObj.interactiveObj.prompt + " " + this.partObj.interactiveObj.hint); this.valuesSelect = new d(c); this.valuesSelect.startup(); this.valuesSelect.on("input", A.hitch(this, this._onFilteringSelectInput)); w.setStyle(this.valuesSelect.domNode,
                                                                "width", "100%"); this.valuesSelect.placeAt(this.domNode)
                                                }, _onFilteringSelectInput: function () { this.emit("change") }, _getCodedValueLabelsBySubTypeId: function () { var c = this.getDropdownFilterPartsObj(); return this.getCodedValueListByPartsObj(this.layerDefinition, this.fieldName, c, this.codedValues) }, _onBeforeDropDownMouseDown: function () { this.ifDropDown = !0; this._tryUpdatingUniqueValues(void 0, !0); return arguments }, _onBodyClick: function (c) {
                                                        c = c.target || c.srcElement; c === this.domNode || w.isDescendant(c, this.domNode) ||
                                                                this.msgDiv && w.setStyle(this.msgDiv, "display", "none")
                                                }, getDijits: function () { return [this.valuesSelect] }, isValidValue: function () { return 0 < this.getStatus() }, getStatus: function () { var c = this.valuesSelect.get("item"); if (c && void 0 !== c.value) { if (this.isNumberField && !n.isValidNumber(c.value) && "value" === this.partObj.valueObj.type) { var g = parseFloat(c.value); return n.isValidNumber(g) ? (c.value = g, this._getStatusForDijit(this.valuesSelect)) : -1 } return this._getStatusForDijit(this.valuesSelect) } return 0 }, _getStatusForDijit: function (c) {
                                                        return c.validate() ?
                                                                c.get("DisplayedValue") ? 1 : 0 : -1
                                                }, setValueObject: function (c) { return this.staticValues ? this._setValueForStaticValues(c.value, this.staticValues) : this.codedValues ? this.filterCodedValue ? this._tryUpdatingUniqueValues(c.value, !1) : this._setValueForStaticValues(c.value, this.codedValues) : this._tryUpdatingUniqueValues(c.value, !1) }, getValueObject: function () { if (this.isValidValue()) { var c = this.valuesSelect.get("item").value; return { isValid: !0, type: this.partObj.valueObj.type, value: c } } return null }, tryGetValueObject: function () {
                                                        return this.isValidValue() ?
                                                                this.getValueObject() : this.isEmptyValue() ? { isValid: !0, type: this.partObj.valueObj.type, value: "string" === this.shortType ? "" : null } : null
                                                }, setRequired: function (c) { this.valuesSelect.set("required", c) }, _setValueForStaticValues: function (c, g) { var b = null, e = -1; b = null; g && (b = m.map(g, A.hitch(this, function (a, f) { a = { id: f, value: a.value, label: a.label }; a.value + "" === c + "" && (e = f); return a })), this.valuesSelect.store.setData(b), 0 <= e && (b = this.valuesSelect.store.get(e)) && this.valuesSelect.set("item", b), this._checkIfNoData()) },
                                                _uniqueValueLoadingDef: null, _uniqueValueLoadingExpr: "", _uniqueValueCache: null, _tryUpdatingUniqueValues: function (c, g) {
                                                        var b = new q; if (this.valuesSelect._opened) this._checkIfNoData(), b.resolve(); else {
                                                                var e = this.getDropdownFilterExpr(); e !== this._uniqueValueLoadingExpr || this.layerDataChanged ? (this.valuesSelect.readOnly = !0, this._uniqueValueLoadingDef && (this._uniqueValueLoadingDef.reject(), this._uniqueValueLoadingDef = null), this._uniqueValueLoadingExpr = e, this._uniqueValueLoadingDef = this._getUniqueValues(e),
                                                                        this._uniqueValueLoadingDef.then(A.hitch(this, function (a) { this.domNode && (this._uniqueValueLoadingDef = null, this.valuesSelect.readOnly = !1, this._setValueForUniqueValues(c, a), this._hideLoadingIcon(), g && this.valuesSelect.toggleDropDown(), this._checkIfNoData(), b.resolve()) }), A.hitch(this, function (a) { console.error(a); this.domNode && (this._uniqueValueLoadingDef = null, this.valuesSelect.readOnly = !1, this._hideLoadingIcon(), this._checkIfNoData(), b.reject(a)) }))) : (this._checkIfNoData(), b.resolve())
                                                        } return b
                                                }, _setValueForUniqueValues: function (c,
                                                        g) { g.sort(function (a, f) { return a.value < f.value ? -1 : a.value === f.value ? 0 : 1 }); this.showNullValues || (g = m.filter(g, A.hitch(this, function (a) { return "\x3cNull\x3e" !== a.value && null !== a.value }))); if (void 0 === c) { var b = this.getValueObject(); b && (c = b.value) } var e = -1; b = null; g = m.map(g, A.hitch(this, function (a, f) { var h = { id: f, value: a.value, label: a.label }; a.value + "" === c + "" && (e = f); return h })); this.valuesSelect.store.setData(g); 0 <= e && (b = this.valuesSelect.store.get(e)); this.valuesSelect.set("item", b) }, _checkIfNoData: function () {
                                                                this.runtime &&
                                                                this.ifDropDown && (this.ifDropDown = !1, 0 === this.valuesSelect.store.data.length && (this.msgDiv ? w.setStyle(this.msgDiv, "display", "block") : (this.msgDiv = document.createElement("div"), w.addClass(this.msgDiv, "jimu-filter-list-value-provider-tip-container"), this.msgDiv.innerHTML = this.noDataTips, this.valuesSelect.domNode.parentNode.appendChild(this.msgDiv))))
                                                        }, _showLoadingIcon: function () { w.addClass(this.valuesSelect.domNode, "loading") }, _hideLoadingIcon: function () { w.removeClass(this.valuesSelect.domNode, "loading") },
                                                _getUniqueValues: function (c) { var g = new q; this._uniqueValueCache[c] && !this.layerDataChanged ? g.resolve(this._uniqueValueCache[c]) : (this._showLoadingIcon(), n.getUniqueValues(this.url, this.fieldName, c, this.layerDefinition, this.fieldPopupInfo).then(A.hitch(this, function (b) { this.domNode && (this._uniqueValueCache[c] = b, g.resolve(b), this._hideLoadingIcon()) }), A.hitch(this, function (b) { this.domNode && (g.reject(b), this._hideLoadingIcon()) }))); this.layerDataChanged = !1; return g }
                                        })
                        })
                }, "jimu/dijit/_filter/AdvancedListValueProvider": function () {
                        define("dojo/Deferred dojo/_base/lang dojo/on dojo/keys dojo/Evented dojo/_base/html dojo/_base/array dojo/_base/declare dojo/query ./ValueProvider ./AdvancedListValueSelect dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdvancedListValueProvider.html jimu/utils jimu/dijit/_filter/pageControlForQuery jimu/dijit/Popup".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                        return l([n, c, g, m], {
                                                templateString: b, codedValues: null, staticValues: null, showNullValues: !1, cbxPopup: null, pageSize: 1E3, pageIndex: 1, emptyStr: "", postMixInProperties: function () { this.inherited(arguments); this.CommonNls = window.jimuNls.common; this.emptyStr = window.apiNls.widgets.FeatureTable.empty }, postCreate: function () {
                                                        this.inherited(arguments); this.noDataTips = '\x3cdiv class\x3d"error-tip-section" style\x3d"display: block;"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text"\x3e' +
                                                                this.nls.noFilterValueTip + "\x3c/span\x3e\x3c/div\x3e"; v.addClass(this.domNode, "jimu-filter-mutcheck-list-value-provider"); "ADVANCED_LIST_VALUE_PROVIDER" === this.providerType ? (this.controlType = "multipleDynamic", this.checkedNumDiv.style.display = "block") : "LIST_VALUE_PROVIDER" === this.providerType ? (this.controlType = "uniqueDynamic", this.checkedNameDiv.style.display = "block") : (this.runtime && "dropdown" === this.selectUI && ("UNIQUE_PREDEFINED_VALUE_PROVIDER" === this.providerType ? this.checkedNameDiv.style.display =
                                                                        "block" : this.checkedNumDiv.style.display = "block"), this.controlType = "MULTIPLE_PREDEFINED_VALUE_PROVIDER" === this.providerType ? "multiplePredefined" : "uniquePredefined"); this.selectType = "MULTIPLE_PREDEFINED_VALUE_PROVIDER" === this.providerType ? "multiple" : "UNIQUE_PREDEFINED_VALUE_PROVIDER" === this.providerType ? "unique" : "LIST_VALUE_PROVIDER" === this.providerType ? "unique" : "multiple"; this.disPlayLabel = "value"; !this.runtime || "multiplePredefined" !== this.controlType && "uniquePredefined" !== this.controlType || (this.disPlayLabel =
                                                                                "alias"); !this.runtime || "multipleDynamic" !== this.controlType && "uniqueDynamic" !== this.controlType || (this.isLoadDataAdvanced = !0); this.runtime && "esriFieldTypeDate" === this.fieldInfo.type && this.partObj.fieldObj && (this.fieldPopupInfo = { format: { dateFormat: this.partObj.fieldObj.dateFormat } }); this.isNumberField = e.isNumberField(this.fieldInfo.type); this.pageControlForQuery || (this.pageControlForQuery = new a({
                                                                                        pageSize: this.pageSize, pageIndex: 1, layerUrl: this.url, fieldInfo: this.fieldInfo, queryWhere: "1\x3d1", layerDefinition: this.layerDefinition,
                                                                                        fieldPopupInfo: this.fieldPopupInfo, isNumberField: this.isNumberField
                                                                                }), this.pageControlForQuery.on("query_getNewExpr", q.hitch(this, this._resetPageControlNewExpr))); this.listSelect || (this._resetPromptLabel(!1), this.listSelectDataList = this.partObj && this.partObj.valueObj && this.partObj.valueObj.value ? this.partObj.valueObj.value : [], this.listSelect = new d({
                                                                                        label: this.promptLabel.innerHTML, emptyStr: this.emptyStr, runtime: this.runtime, pageSize: this.pageSize, selectUI: this.selectUI, controlType: this.controlType,
                                                                                        selectType: this.selectType, dataList: this.listSelectDataList, selectedDataList: [], isNumberField: this.isNumberField
                                                                                }), q.isArray(this.listSelectDataList) ? this.getCheckedList(this.listSelectDataList) : (this.listSelect.checkedList = [this.listSelectDataList], this.listSelect._updateCheckedLabelListFromCheckedList()), this.listSelect.on("advancedListValueSelect_itemChecked", q.hitch(this, this._createTarget)), this.listSelect.on("advancedListValueSelect_itemUnChecked", q.hitch(this, this._destoryTarget)), this.listSelect.on("advancedListValueSelect_addNextPage",
                                                                                        q.hitch(this, this._addNextPage)), this.listSelect.on("advancedListValueSelect_searchKey", q.hitch(this, this._searchKey)), this.listSelect.on("advancedListValueSelect_searchKeyLocal", q.hitch(this, this._searchKeyLocal)), this.listSelect.on("advancedListValueSelect_itemsConfirmed", q.hitch(this, function () { this.cbxPopup && this.cbxPopup.domNode && ("block" === v.getStyle(this.cbxPopup.domNode, "display") && (this._resetListSelectState(this), this.cbxPopup.hide()), this.checkedBtn.focus()) })), this.own(A(this.checkedBtn,
                                                                                                "keydown", q.hitch(this, function (h) { v.hasClass(h.target || h.srcElement, "checkBtn") && h.keyCode === w.ENTER && this._checkedBtnEvent() }))), this.staticValues || "function" !== typeof this._checkedBtnEvent || (!this.codedValues || this.codedValues && this.filterCodedValue) && this.layerInfo && this.layerInfo.getLayerObject().then(q.hitch(this, function (h) { h.on("edits-complete", q.hitch(this, function () { this.layerDataChanged = !0 })) }))); "dropdown" === this.selectUI ? (v.setStyle(this.checkedBtn, "display", "block"), this._multipleSelectProviderEventHandler =
                                                                                                        q.hitch(this, this._multipleSelectProviderEvent), document.addEventListener("click", this._multipleSelectProviderEventHandler, { capture: !0 })) : this.listSelect.placeAt(this.listContent)
                                                }, _resetPromptLabel: function (h) { h = h ? this.nls.noFilterValueTip + " " : ""; "undefined" !== typeof this.promptLabel && (this.promptLabel.innerHTML = e.sanitizeHTML(this.partObj.interactiveObj.prompt + " " + this.partObj.interactiveObj.hint + h)) }, filterExpr: null, _resetPageControlNewExpr: function () {
                                                        var h = this.getDropdownFilterExpr(this.partObj.widgetId);
                                                        return this.filterExpr !== h ? (this.pageControlForQuery.reset(), this.filterExpr = this.pageControlForQuery.cascadeFilterExprs = h, !0) : !1
                                                }, _multipleSelectProviderEvent: function (h) {
                                                        h = h.target || h.srcElement; if (this.cbxPopup && this.cbxPopup.domNode) { if (v.isDescendant(h, this.cbxPopup.domNode) || v.isDescendant(h, this.checkedBtn)) return; "block" === v.getStyle(this.cbxPopup.domNode, "display") && (this._resetListSelectState(this), this.cbxPopup.hide()) } else !v.isDescendant(h, this.checkedBtn) && this.isPopupLoading && (this.isLoadDataAdvanced =
                                                                !0); this.msgDiv && v.setStyle(this.msgDiv, "display", "none")
                                                }, _checkedBtnEvent: function () { this._showPopup() }, _onBeforeDropDownMouseDown: function () { this._tryUpdatingUniqueValues(void 0, !0); return arguments }, _isRestSelectList: !1, _resetListSelectState: function (h) {
                                                        "block" === v.getStyle(h.listSelect.searchKeyInput, "display") && ("multipleDynamic" === this.controlType && this.listSelect.showAllList(), h.listSelect.listContainer.scrollTop = 0, h.listSelect.queryState = !0, h.listSelect.valueInput.set("value", ""), this._isRestSelectList =
                                                                !0)
                                                }, _createTarget: function (h) { this._checkedChanged(1, h); this.cbxPopup && ("uniqueDynamic" === this.controlType || "uniquePredefined" === this.controlType) && this.cbxPopup.domNode && (this._resetListSelectState(this), this.cbxPopup.close()) }, _destoryTarget: function (h) { this._checkedChanged(-1, h) }, _checkedChanged: function (h, p) {
                                                        if ("multipleDynamic" === this.controlType || "multiplePredefined" === this.controlType && this.runtime && "dropdown" === this.selectUI) p && (h = parseInt(this.checkedNum.innerText, 10) + h, this.checkedNum.innerText =
                                                                0 < h ? h : 0); else if ("uniqueDynamic" === this.controlType || "uniquePredefined" === this.controlType && this.runtime && "dropdown" === this.selectUI) "uniqueDynamic" === this.controlType && (p === this.emptyStr ? v.addClass(this.checkedNameDiv, "checkedEmptyNameDiv") : v.removeClass(this.checkedNameDiv, "checkedEmptyNameDiv")), h = p ? p : this._getCheckedNameDivText(), this._setCheckedNameDivText(h); this.listSelect.set("displayedValue", "12345678"); this.emit("change")
                                                }, _clearCheckedTxt: function () {
                                                        this.runtime && "dropdown" === this.selectUI &&
                                                        ("multipleDynamic" === this.controlType || "multiplePredefined" === this.controlType ? this.checkedNum.textContent ? this.checkedNum.textContent = 0 : this.checkedNum.innerText = 0 : ("uniqueDynamic" === this.controlType || "uniquePredefined" === this.controlType) && this._setCheckedNameDivText(""), this.valueList = [], this.listSelect.checkedList = [], this.listSelect.checkedLabelList = [], this.listSelect.valueInput.set("value", ""), "multipleDynamic" === this.controlType && this.listSelect.showAllList()); this.listSelect.set("displayedValue",
                                                                "12345678"); this.emit("change")
                                                }, _layerDataChangedCallback: function () { this.layerDataChanged && (this.pageControlForQuery.reset(), this.listSelect.ifFristPage = !0, this.layerDataChanged = !1) }, _addNextPage: function () {
                                                        this.listSelect && (this._showLoadingIcon(), this._layerDataChangedCallback(), this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage).then(q.hitch(this, function (h) {
                                                                this.listSelect.isCacheFinish = this.pageControlForQuery._isUniqueValueCacheFinish; this.listSelect.ifFristPage && this._checkIfNoData(h) ||
                                                                        (this.listSelect.setCBXData(h, !0, this.listSelect.ifFristPage), this._hideLoadingIcon())
                                                        }), q.hitch(this, function (h) { console.log(h); this.listSelect.queryState = !1; this._hideLoadingIcon() })))
                                                }, _searchKey: function (h) { this.listSelect && (this._showLoadingIcon(), this._layerDataChangedCallback(), this.pageControlForQuery._searchKey(h).then(q.hitch(this, function (p) { this.listSelect.setCBXContentBySearch(p); this._resetPopupStyles(!p.length); this._hideLoadingIcon() }), q.hitch(this, function (p) { console.log(p); this._hideLoadingIcon() }))) },
                                                _searchKeyLocal: function (h, p) { if (this.listSelect) { "uniqueDynamic" === this.controlType && this._isRestSelectList && (this.listSelect.keyQueryMode = !1, this._isRestSelectList = this.listSelect.cacheQueryMode = !1); this._showLoadingIcon(); var B = this.pageControlForQuery._searchKeyLocal(h); "" === h && 0 === B.length ? (this.layerDataChanged = !0, this._layerDataChangedCallback(), this._addNextPage()) : this.listSelect.setCBXContentBySearch(B, p); this._resetPopupStyles(!0); this._hideLoadingIcon() } }, queryByPage: function () {
                                                        var h =
                                                                this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage); h.then(q.hitch(this, function (p) { h.resolve(p) }), q.hitch(this, function (p) { console.log(p); h.reject(p) }))
                                                }, getCheckedList: function (h) { this.listSelect.checkedList = []; this.listSelect.checkedLabelList = []; r.forEach(h, q.hitch(this, function (p) { if (q.isObject(p)) { if (p.isChecked) var B = p.value } else B = p; if (B || 0 === B) B = this.isNumberField ? parseFloat(B) : B, this.listSelect.checkedList.push(B) })) }, getCheckedStrsList: function (h) {
                                                        var p = []; r.forEach(h, q.hitch(this,
                                                                function (B) { var t; q.isObject(B) ? B.isChecked && (t = B[this.disPlayLabel]) : t = B; (t || 0 === t) && p.push(t) })); return p
                                                }, showContent: function (h) {
                                                        var p = new E; this.getCheckedList(this.valueList); this.listSelect.codedValues = !1; this.listSelect.disPlayLabel = "value"; if ("multiplePredefined" === this.controlType || "uniquePredefined" === this.controlType) {
                                                                this.runtime && (this.listSelect.disPlayLabel = "alias"); var B = this._checkIfNoData(this.valueList); B || (this.listSelect.setCBXData(this.valueList, !0, h), this.listSelect._updateCheckedLabelListFromCheckedList());
                                                                this._hideLoadingIcon(); p.resolve(B); return p
                                                        } if (this.staticValues) return B = this._setValueForStaticValues(this.staticValues), p.resolve(B), p; if (this.codedValues) if (this.filterCodedValue) this.listSelect.codedValues = !0; else return B = this._setValueForStaticValues(this.codedValues), p.resolve(B), p; this._showLoadingIcon(); if ("multipleDynamic" === this.controlType || "uniqueDynamic" === this.controlType) this._layerDataChangedCallback(), this.pageControlForQuery.queryByPage(h).then(q.hitch(this, function (t) {
                                                                this.listSelect.isCacheFinish =
                                                                this.pageControlForQuery._isUniqueValueCacheFinish; t = this._handleCodedValue(t); (B = this._checkIfNoData(t)) || this.listSelect.setCBXData(t, !0, h); this._hideLoadingIcon(); p.resolve(B)
                                                        }), q.hitch(this, function (t) { console.log(t); this._hideLoadingIcon(); p.reject(t) })); return p
                                                }, _handleCodedValue: function (h) {
                                                        this.listSelect.disPlayLabel = "label"; if (!this.codedValues) return this.listSelect._updateCheckedLabelListFromCheckedList(), h; this.pageControlForQuery._codedvalueCache = h; "uniqueDynamic" === this.controlType &&
                                                                this._setCheckedName(this.listSelect.checkedList ? this.listSelect.checkedList[0] : "", h); this.listSelect._updateCheckedLabelList(this.codedValues); return h
                                                }, _showDropdown: function (h) {
                                                        var p = v.position(h.target); var B = this.isInFilterSet ? this.domNode.parentNode.parentNode.parentNode : this.domNode.parentNode; var t = v.position(B); if ("none" !== v.getStyle(this.listContentPopup, "display")) v.setStyle(this.listContentPopup, "display", "none"); else {
                                                                r.forEach(k(".value-type-popup", B), function (z) {
                                                                        v.setStyle(z, "display",
                                                                                "none")
                                                                }, this); v.place(this.listContentPopup, B); var u = v.hasClass(k(".desktop-add-section", B.parentNode)[0], "hidden") ? -5 : 30; u = p.y - t.y - B.parentNode.scrollTop + u; u + 170 > B.parentNode.scrollHeight && (u = B.parentNode.scrollHeight - 170 - 40); window.isRTL ? p = p.x - t.x + 20 : (p = p.x - t.x - 100 - 90, p + 150 > B.clientWidth && (p = B.clientWidth - 150)); v.setStyle(this.listContentPopup, { display: "block", left: p + "px", top: u + "px" }); h.stopPropagation()
                                                        }
                                                }, _calculatePopup: function () {
                                                        var h = v.position(this.domNode.parentNode), p = v.position(document.body).h,
                                                        B = h.y + 30; p - B < this._cbxHeight && (B = h.y - this._cbxHeight); return { left: h.x, top: B }
                                                }, _cbxWidth: 210, _cbxHeight: 362, popupIsNoData: !1, isPopupLoading: !1, isLoadDataAdvanced: !1, _showPopup: function () {
                                                        if (!this.isPopupLoading) if (this.cbxPopup && this.cbxPopup.domNode && "block" === v.getStyle(this.cbxPopup.domNode, "display")) this._resetListSelectState(this), this.cbxPopup.hide(); else {
                                                                var h = this._resetPageControlNewExpr(); h && this.cbxPopup && (this.cbxPopup.close(), this._clearCheckedTxt()); if (h || this.cbxPopup) {
                                                                        var p = this._calculatePopup();
                                                                        this._cbxWidth = v.getStyle(this.checkedBtn, "width"); if (!h && this.cbxPopup && this.cbxPopup.domNode && !this.layerDataChanged) this.popupIsNoData ? this._checkIfNoData([]) : (this.cbxPopup.show(), this._resetPopupStyles(), this.listSelect.valueInput && "block" === v.getStyle(this.listSelect.searchKeyInput, "display") ? this.listSelect.valueInput.focus() : this.listSelect.listContent.focus(), this.listSelect.queryState = !1); else {
                                                                                this.isPopupLoading = !0; this.isLoadDataAdvanced || this._showDataQueryingIcon(); var B = this.showContent(!0);
                                                                                B.then(q.hitch(this, function (t) {
                                                                                        this.isPopupLoading = !1; this._hideDataQueryingIcon(); (this.popupIsNoData = t) ? this._clearCheckedTxt() : (this.cbxPopup = new f({ width: this._cbxWidth, height: this._cbxHeight, content: this.listSelect.domNode, enableMoveable: !1, hasTitle: !1, hasOverlay: !1, contentHasNoMargin: !0, moveToCenter: !1, customPosition: { left: p.left, top: p.top }, hiddenAfterInit: this.isLoadDataAdvanced, useFocusLogic: !1, onClose: q.hitch(this, function () { this.cbxPopup.hide(); return !1 }), buttons: [] }), this.cbxPopup.setDomNodeStyls({
                                                                                                "border-radius": 0,
                                                                                                border: "1px solid #999"
                                                                                        }), this.cbxPopup.on("popupHasInitedSuccessfully", q.hitch(this, function (u) { this._resetPopupStyles(!1, !0); u || (this.listSelect.valueInput && "block" === v.getStyle(this.listSelect.searchKeyInput, "display") ? this.listSelect.valueInput.focus() : this.listSelect.listContent.focus()) }))); this.isLoadDataAdvanced && (this.isLoadDataAdvanced = !1)
                                                                                }), q.hitch(this, function (t) { this.isPopupLoading = !1; console.log(t); B.reject(t) }))
                                                                        }
                                                                } else v.setStyle(this.msgDiv, "display", "block")
                                                        }
                                                }, _itemContainerH: 300,
                                                _resetPopupStyles: function (h, p) {
                                                        var B = this._itemContainerH, t = v.getStyle(this.listSelect.listContent, "height"); 0 === t && this.cbxPopup && this.cbxPopup.domNode && "none" === v.getStyle(this.cbxPopup.domNode, "display") && (t = this.popupInitHeight); p && (this.popupInitHeight = t); !h || this.listSelect.codedValues || this.pageControlForQuery._isUniqueValueCacheFinish || (t += 25); this.pageControlForQuery._isUniqueValueCacheFinish && "block" === v.getStyle(this.listSelect.noDataTips, "display") && (t += 30); B = t < B ? t : B; v.setStyle(this.listSelect.listContainer,
                                                                "height", B + "px"); v.setStyle(this.listSelect.selectedContainer, "height", B + 30 + "px"); "multipleDynamic" === this.controlType ? B = B + 30 + 30 : "uniqueDynamic" === this.controlType && (B += 30); this._cbxHeight = B + 10; h = this._calculatePopup(); this._cbxWidth = v.getStyle(this.checkedBtn, "width"); this.cbxPopup.setCustomPosition(h.left, h.top, this._cbxWidth, this._cbxHeight); this._resetItemWidth()
                                                }, _resetItemWidth: function () {
                                                        var h = this._cbxWidth - 20; "uniqueDynamic" === this.controlType || this.runtime && "uniquePredefined" === this.controlType &&
                                                                "dropdown" === this.selectUI || !this.runtime && ("multiplePredefined" === this.controlType || "uniquePredefined" === this.controlType) || (h = !this.runtime || "dropdown" === this.selectUI || "uniquePredefined" !== this.controlType && "multiplePredefined" !== this.controlType ? h - 30 : h - 15); window.isRTL && (h -= 3); this.listSelect._itemLabelW = h; k(".item .label", this.listSelect.listContent).style({ "max-width": h + "px" })
                                                }, _setValueForStaticValues: function (h) {
                                                        this.listSelect.codedValues = !0; this.listSelect._updateCheckedLabelList(this.codedValues);
                                                        if (h) { this.pageControlForQuery._codedvalueCache = h; var p = this._checkIfNoData(h); p || (this.listSelect.disPlayLabel = "label", this.listSelect.setCBXData(h, !0, !0)); return p } return !1
                                                }, _checkIfNoData: function (h) {
                                                        if (this.runtime && "dropdown" === this.selectUI) {
                                                                if (h && 0 < h.length) return this._resetPromptLabel(!1), !1; this.msgDiv ? v.setStyle(this.msgDiv, "display", "block") : (this.msgDiv = document.createElement("div"), v.addClass(this.msgDiv, "jimu-filter-list-value-provider-tip-container"), this.msgDiv.innerHTML = this.noDataTips,
                                                                        this.checkedBtn.parentNode.appendChild(this.msgDiv)); this._resetPromptLabel(!0); return !0
                                                        } this._resetPromptLabel(!1); return !1
                                                }, getDijits: function () { return [this.listSelect] }, _setCheckedName: function (h, p) {
                                                        var B = h; if (p = p ? p : this.codedValues) { for (var t = !1, u = 0; u < p.length; u++) { var z = p[u]; if (z.value === h) { B = z.label; t = !0; break } } t || (B = this.emptyStr, this.valueList = [], this.listSelect && (this.listSelect.checkedList = [], this.listSelect.checkedLabelList = [])) } else void 0 === h ? (B = this.emptyStr, v.addClass(this.checkedNameDiv,
                                                                "checkedEmptyNameDiv")) : v.removeClass(this.checkedNameDiv, "checkedEmptyNameDiv"); this._setCheckedNameDivText(B)
                                                }, setValueObject: function (h) {
                                                        h.value = h.value || 0 === h.value ? h.value : []; this.valueList = h.value; this.enableEmpty = h.enableEmpty; this.listSelect.enableEmpty = h.enableEmpty; if ("multipleDynamic" === this.controlType) this.checkedNum.innerText = this.valueList.length, this.isLoadDataAdvanced && this._checkedBtnEvent(); else if ("uniqueDynamic" === this.controlType) {
                                                                h = this.valueList; q.isArray(h) && 0 === h.length &&
                                                                        (h = void 0); this._setCheckedName(h); this.valueList = [this.valueList]; if (h && "esriFieldTypeDate" === this.fieldInfo.type) { var p = e.getDateByDateTimeStrAndFormat(h, this.fieldPopupInfo); h = e.getDateTimeStrByFieldInfo(p, this.fieldPopupInfo); p = e.localizeDateByFieldInfo(p, this.fieldPopupInfo); this._setCheckedName(p); this.valueList = [h] } this.isLoadDataAdvanced && this._checkedBtnEvent()
                                                        } else this.emptyStr = h.emptyLabel ? h.emptyLabel : this.emptyStr, this.listSelect.emptyStr = this.emptyStr, this.runtime && "dropdown" === this.selectUI &&
                                                                (p = [], "value" === this.disPlayLabel ? (this.getCheckedList(this.valueList), p = this.listSelect.checkedList) : p = this.getCheckedStrsList(this.valueList), "uniquePredefined" === this.controlType ? 0 < this.listSelect.checkedList.length ? this._setCheckedNameDivText(p[0]) : this._setCheckedNameDivText(h.enableEmpty ? this.emptyStr : "") : this.checkedNum.innerText = p.length), this.showContent(!0), setTimeout(q.hitch(this, function () { this._cbxWidth = v.getStyle(this.listSelect.listContent, "width"); this._resetItemWidth() }), 50)
                                                }, _getCheckedNameDivText: function () {
                                                        return this.checkedNameDiv.textContent ||
                                                                this.checkedNameDiv.innerText || ""
                                                }, _setCheckedNameDivText: function (h) { this.isNumberField && "number" === typeof h && (h = e._getValues(this.layerDefinition, this.fieldPopupInfo, this.fieldName, [h])[0].label); this.checkedNameDiv.textContent ? this.checkedNameDiv.textContent = h : this.checkedNameDiv.innerText = h }, tryGetValueObject: function () {
                                                        if (this.isValidValue()) return this.getValueObject(); if (this.isEmptyValue()) {
                                                                var h = null; h = "multipleDynamic" === this.controlType || "multiplePredefined" === this.controlType ? [] : "string" ===
                                                                        this.shortType ? "" : null; return { isValid: !0, type: this.partObj.valueObj.type, value: h }
                                                        } return null
                                                }, getValueObject: function () { if (this.isValidValue()) { var h = "multipleDynamic" === this.controlType || "uniqueDynamic" === this.controlType ? this.listSelect.getListCheckedValues() : this.listSelect.getListValues(); "uniqueDynamic" === this.controlType && (h = q.isArray(h) ? h[0] : h); return { isValid: !0, type: this.partObj.valueObj.type, value: h } } return null }, setRequired: function (h) { this.listSelect.set("required", h) }, _showDataQueryingIcon: function () {
                                                        this._validatingNode ||
                                                        (this._validatingNode = v.create("div", { "class": "jimu-circle-loading" }, this.checkedBtn)); v.setStyle(this._validatingNode, "display", "block")
                                                }, _hideDataQueryingIcon: function () { this._validatingNode && v.setStyle(this._validatingNode, "display", "none") }, _showLoadingIcon: function () { this.listSelect && this.listSelect.listContainer && v.addClass(this.listSelect.listContainer, "jimu-circle-loading") }, _hideLoadingIcon: function () {
                                                        this.listSelect && this.listSelect.listContainer && v.removeClass(this.listSelect.listContainer,
                                                                "jimu-circle-loading")
                                                }, destroy: function () { this._multipleSelectProviderEventHandler && document.removeEventListener("click", this._multipleSelectProviderEventHandler, { capture: !0 }); this.cbxPopup && this.cbxPopup.domNode && (this.cbxPopup.onClose = q.hitch(this, function () { return !0 }), this.cbxPopup.close()); this.inherited(arguments) }, destroyProvider: function () { this.listSelect && this.listSelect.destroy(); this.listSelect = null }
                                        })
                                })
                }, "jimu/dijit/_filter/AdvancedListValueSelect": function () {
                        define("dojo/_base/lang dojo/Evented dojo/_base/html dojo/_base/declare dijit/_WidgetBase dojo/on dojo/keys dojo/query dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AdvancedListValueSelect.html jimu/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                        return w([m, k, n, q], {
                                                templateString: d, selectType: null, dataList: [], checkedList: [], checkedLabelList: [], _itemLabelW: 215, ifFristPage: !0, queryState: !0, isCacheFinish: !1, keyQueryMode: !1, cacheQueryMode: !1, emptyStr: "", postMixInProperties: function () { this.inherited(arguments); this.jimuCommonNls = window.jimuNls.common; this.Nls = window.jimuNls.filterBuilder; this.noDataNls = window.apiNls.widgets.FeatureTable.noData }, postCreate: function () {
                                                        this.inherited(arguments); this.inputType = "unique" ===
                                                                this.selectType ? "radio" : "checkbox"; if ("multipleDynamic" === this.controlType || "uniqueDynamic" === this.controlType) A.addClass(this.listContainer, "items-setting-dropdown-content"), this.searchKeyInput.style.display = "block"; "uniqueDynamic" === this.controlType && A.addClass(this.listContainer, "items_content_no_selected_toggle"); this.runtime ? (A.addClass(this.listContainer, "items-widget-content"), "dropdown" !== this.selectUI && (A.addClass(this.listContainer, "items-widget-expaned-content"), A.addClass(this.listContent,
                                                                        "jimu-multiple-items-expanded-list"), A.setAttr(this.listContent, "aria-label", this.label), A.addClass(this.listContent, c.lastFocusNodeClassInDOM), A.removeAttr(this.multipleSelect, "tabindex"))) : (A.addClass(this.listContainer, "items-setting-popup-content"), this.searchKeyInput.style.display = "block"); this.runtime || "predefined" !== this.controlType || (A.addClass(this.listContainer, "items-setting-dropdown-content"), A.addClass(this.listContainer, "items_content_no_selected_toggle"), this.searchKeyInput.style.display =
                                                                                "block"); this._addCBXClickEvent(); this._addCBXHoverEvent(); this.disPlayLabel = "value"; !this.runtime || "multiplePredefined" !== this.controlType && "uniquePredefined" !== this.controlType || (this.disPlayLabel = "alias"); "multipleDynamic" === this.controlType && (this.selectedToggleDiv.style.display = "block", this.selectedToggle = l(".showAllIcon", this.selectedToggleDiv)[0], this.own(v(this.selectedToggleDiv, "click", E.hitch(this, "_toggleFilter"))), this.own(v(this.selectedToggleDiv, "keydown", E.hitch(this, function (g) {
                                                                                        g.keyCode ===
                                                                                        r.ENTER && this._toggleFilter(g)
                                                                                }))), this._addSelectedContainerEvent()); this._addKeyDownEvent()
                                                }, _addKeyDownEvent: function () {
                                                        this.own(v(this.multipleSelect, "keydown", E.hitch(this, function (g) {
                                                                var b = g.which || g.keyCode, e = g.target; if (b === r.ESCAPE || "dropdown" === this.selectUI && ("INPUT" === e.tagName && g.shiftKey && b === r.TAB || ("multipleDynamic" === this.controlType && A.hasClass(e, "clearAllSelectedIcon") || "multipleDynamic" !== this.controlType && A.hasClass(e, "item")) && !g.shiftKey && b === r.TAB)) g.preventDefault(), this.currentHoverItem &&
                                                                        (A.removeClass(this.currentHoverItem, "active"), this.currentHoverItem = null), this.emit("advancedListValueSelect_itemsConfirmed")
                                                        }))); this.own(v(this.listContent, "focus", E.hitch(this, function () {
                                                                c.isInNavMode() && (this.currentItem = (this.currentItem = this.getCurrentItem()) ? this.currentItem : this._getCheckInputItems()[0], this.currentHoverItem = this.currentItem.parentNode, "dropdown" === this.selectUI ? this.currentHoverItem.focus() : this._isFocusFirstItem = !0, A.addClass(this.currentHoverItem, "active"), setTimeout(E.hitch(this,
                                                                        function () { A.addClass(this.currentHoverItem, "active") }), 10))
                                                        }))); this.own(v(this.listContent, "blur", E.hitch(this, function () { this.currentHoverItem && A.removeClass(this.currentHoverItem, "active") }))); this.own(v(this.showAllIconBtn, "keydown", E.hitch(this, function (g) { g.shiftKey && g.keyCode === r.TAB && (g.preventDefault(), "block" === A.getStyle(this.selectedContainer, "display") ? this.selectedListContent.focus() : this.listContent.focus()) }))); this.own(v(this.listContent, "keydown", E.hitch(this, function (g) {
                                                                if (c.isInNavMode()) {
                                                                        var b =
                                                                                g.which || g.keyCode; -1 < [r.SPACE, r.UP_ARROW, r.DOWN_ARROW].indexOf(b) && g.preventDefault(); if (b === r.TAB && A.hasClass(g.target, "item")) g.preventDefault(), this.currentHoverItem && A.removeClass(this.currentHoverItem, "active"), "dropdown" === this.selectUI ? (this.currentHoverItem = null, g.shiftKey ? "block" === this.searchKeyInput.style.display ? this.valueInput.focus() : this.emit("advancedListValueSelect_itemsConfirmed") : "multipleDynamic" === this.controlType && this.showAllIconBtn.focus()) : this.listContent.focus(); else if (b ===
                                                                                        r.SPACE || b === r.ENTER) g = l(".checkInput", this.currentHoverItem)[0], b = l(".label", this.currentHoverItem)[0], this._setCBXChecked(g, this._getNodeText(b)), "radio" === this.inputType && ("dropdown" === this.selectUI && (A.removeClass(this.currentHoverItem, "active"), this.currentHoverItem = null), this.emit("advancedListValueSelect_itemsConfirmed")); else if (b === r.UP_ARROW || b === r.DOWN_ARROW) if ("dropdown" !== this.selectUI && this._isFocusFirstItem) this._isFocusFirstItem = !1, this.currentHoverItem.focus(), setTimeout(E.hitch(this,
                                                                                                function () { A.addClass(this.currentHoverItem, "active") }), 5); else {
                                                                                                        g = (g = b === r.UP_ARROW ? this.currentHoverItem.previousSibling : this.currentHoverItem.nextSibling) ? g : this.currentHoverItem; if (this.listContainer.scrollHeight > this.listContainer.clientHeight) {
                                                                                                                b = this.listContainer.clientHeight + this.listContainer.scrollTop; var e = g.offsetTop + g.offsetHeight; e -= 30; e > b ? this.listContainer.scrollTop = e - this.listContainer.clientHeight : g.offsetTop < this.listContainer.scrollTop + 30 && (this.listContainer.scrollTop = g.offsetTop -
                                                                                                                        30)
                                                                                                        } A.removeClass(this.currentHoverItem, "active"); this.currentHoverItem = g; A.addClass(this.currentHoverItem, "active"); this.currentHoverItem.focus()
                                                                                        }
                                                                }
                                                        }))); this.own(v(this.selectedListContent, "focus", E.hitch(this, function () { if (c.isInNavMode()) { var g = l(".item", this.selectedListContent); g.length && (this.currentHoverItem = g[0], this.currentHoverItem.focus(), A.addClass(this.currentHoverItem, "active"), setTimeout(E.hitch(this, function () { A.addClass(this.currentHoverItem, "active") }), 50)) } }))); this.own(v(this.selectedListContent,
                                                                "blur", E.hitch(this, function () { c.isInNavMode() && this.currentHoverItem && A.removeClass(this.currentHoverItem, "active") }))); this.own(v(this.selectedContainer, "keydown", E.hitch(this, function (g) {
                                                                        if (c.isInNavMode()) {
                                                                                var b = g.which || g.keyCode; if (b === r.TAB) g.preventDefault(), this.currentHoverItem && A.removeClass(this.currentHoverItem, "active"), this.showAllIconBtn.focus(); else if (0 !== l(".item", this.selectedListContent).length) if (-1 < [r.SPACE, r.UP_ARROW, r.DOWN_ARROW].indexOf(b) && g.preventDefault(), b === r.SPACE ||
                                                                                        b === r.ENTER) g = l(".checkInput", this.currentHoverItem)[0], b = l(".label", this.currentHoverItem)[0], this._setCBXSelectedChecked(g, this._getNodeText(b)); else if (b === r.UP_ARROW || b === r.DOWN_ARROW) g = (g = b === r.UP_ARROW ? this.currentHoverItem.previousSibling : this.currentHoverItem.nextSibling) ? g : this.currentHoverItem, this.selectedContainer.scrollHeight > this.selectedContainer.clientHeight && (b = g.offsetTop + g.offsetHeight, b > this.selectedContainer.clientHeight + this.selectedContainer.scrollTop ? this.selectedContainer.scrollTop =
                                                                                                b - this.selectedContainer.clientHeight : g.offsetTop < this.selectedContainer.scrollTop && (this.selectedContainer.scrollTop = g.offsetTop)), A.removeClass(this.currentHoverItem, "active"), this.currentHoverItem = g, A.addClass(this.currentHoverItem, "active"), this.currentHoverItem.focus()
                                                                        }
                                                                })))
                                                }, _toggleFilter: function (g) {
                                                        var b = g.target; A.hasClass(b, "clearAllSelectedIcon") ? (this._clearAllSelected(), this.currentHoverItem = this.currentItem = null) : A.hasClass(b, "iconHover") || A.hasClass(b, "selectedToggleDiv") || (A.hasClass(b,
                                                                "showAllIcon") ? (this.selectedContainer.style.display = "none", this.listContent.focus()) : (this._initSelectedContainerItems(), this.selectedContainer.style.display = "block", this.selectedListContent.focus()), A.removeClass(this.selectedToggle, "iconHover"), this.selectedToggle = b, A.addClass(this.selectedToggle, "iconHover"), g.stopPropagation())
                                                }, showAllList: function () {
                                                        A.hasClass(this.selectedToggle, "showSelectedIcon") && A.hasClass(this.selectedToggle, "iconHover") && (A.removeClass(this.selectedToggle, "iconHover"),
                                                                this.selectedToggle = l(".showAllIcon", this.selectedToggleDiv)[0], A.addClass(this.selectedToggle, "iconHover"), A.setStyle(this.selectedContainer, "display", "none"))
                                                }, _clearAllSelected: function () { var g = A.hasClass(this.selectedToggle, "showAllIcon") ? this.listContainer : this.selectedListContent; g = l(".item .checkInput.checked", g); for (var b = 0; b < g.length; b++)g[b].click() }, _initSelectedContainerItems: function () {
                                                        for (var g = this.selectedListContent.innerHTML = "", b = this.runtime ? " labelRuntime" : "", e = 0; e < this.checkedList.length; e++) {
                                                                var a =
                                                                        this.checkedList[e], f = "value" === this.disPlayLabel ? a : this.checkedLabelList[e]; a = 'data\x3d"' + (this.isNumberField ? a : encodeURIComponent(a)) + '"'; g += '\x3cdiv role\x3d"option" class\x3d"item" tabindex\x3d"-1" aria-selected\x3d"true" aria-checked\x3d"true"\x3e\x3cdiv class\x3d"checkInput ' + this.inputType + ' checked" ' + a + '\x3e\x3c/div\x3e\x3cdiv class\x3d"label jimu-ellipsis-Blanks' + b + '" style\x3d"max-width:' + this._itemLabelW + 'px"\x3e' + f + "\x3c/div\x3e\x3c/div\x3e"
                                                        } this.selectedListContent.innerHTML = g
                                                }, _addSelectedContainerEvent: function () {
                                                        this.own(v(this.selectedListContent,
                                                                "click", E.hitch(this, function (g) { var b = g.target; if (A.hasClass(b, "item")) { var e = b.firstElementChild; b = b.firstElementChild.nextSibling } else if (A.hasClass(b, "checkInput")) e = b, b = b.nextSibling; else if (A.hasClass(b, "label")) e = b.previousSibling; else { g.stopPropagation(); return } this._setCBXSelectedChecked(e, this._getNodeText(b)); g.stopPropagation() })))
                                                }, _setCBXSelectedChecked: function (g, b) {
                                                        var e = b; if ("alias" === this.disPlayLabel || "label" === this.disPlayLabel) e = decodeURIComponent(A.getAttr(g, "data")); A.hasClass(g,
                                                                "checked") ? (A.setAttr(g.parentNode, "aria-checked", "false"), "radio" !== this.inputType && (A.removeClass(g, "checked"), this._updateCheckedList("remove", e, b), this.checkCBXItems(), this.emit("advancedListValueSelect_itemUnChecked", b))) : (A.setAttr(g.parentNode, "aria-checked", "true"), "radio" === this.inputType && this.currentItem && (!0 === this.currentItem && (this.currentItem = this.getCurrentItem()), A.removeClass(this.currentItem, "checked")), A.addClass(g, "checked"), this._updateCheckedList("add", e, b), this.checkCBXItems(),
                                                                        this.emit("advancedListValueSelect_itemChecked", b))
                                                }, _getNodeText: function (g) { return g.textContent || g.innerText || "" }, _updateCheckedList: function (g, b, e) {
                                                        b !== this.emptyStr && (b = this.isNumberField ? parseFloat(b) : b); if ("remove" === g) for (var a in this.checkedList) { if (this.checkedList[a] === b || this.isNumberField && isNaN(this.checkedList[a]) && isNaN(b)) { this.checkedList.splice(a, 1); this.checkedLabelList.splice(a, 1); break } } else "radio" === this.inputType ? (this.checkedList = [b], this.checkedLabelList = [e]) : (this.checkedList.push(b),
                                                                this.checkedLabelList.push(e)); this._updateListContentLabel()
                                                }, _updateListContentLabel: function () { if ("dropdown" !== this.selectUI && this.runtime) { var g = this.checkedLabelList.join(" "); g = g ? g : this.emptyStr; A.setAttr(this.listContent, "aria-label", this.label + g) } }, _updateCheckedLabelList: function (g) { this.checkedLabelList = []; for (var b = 0; b < this.checkedList.length; b++)for (var e = 0; e < g.length; e++)this.checkedList[b] === g[e].value && this.checkedLabelList.push(g[e].label) }, _updateCheckedLabelListFromCheckedList: function () {
                                                        for (var g =
                                                                0; g < this.checkedList.length; g++)this.checkedLabelList.push(this.checkedList[g] + ""); this._updateListContentLabel()
                                                }, _createTarget: function (g) { g = this._getNodeText(g.target).split(": ")[1]; this.emit("advancedListValueSelect_itemChecked", g) }, _deleteCBXItem: function () { }, _getCheckInputItems: function () { return l(".item .checkInput", this.listContent) }, getListCheckedValuesOrigin: function () {
                                                        for (var g = [], b = this._getCheckInputItems(), e = 0; e < b.length; e++) {
                                                                var a = b[e], f = this._getNodeText(a.nextSibling); A.hasClass(a,
                                                                        "checked") && g.push(f)
                                                        } return g
                                                }, getListCheckedValues: function () { for (var g = [], b = E.clone(this.checkedList), e = 0; e < b.length; e++) { var a = b[e]; a = this.isNumberField ? parseFloat(a) : a; g.push(a) } return g }, getListValues: function () {
                                                        var g = [], b = this._getCheckInputItems(); if (0 === b.length) return this.dataList; for (var e = 0; e < b.length; e++) {
                                                                var a = b[e], f = this._getNodeText(a.nextSibling); if ("alias" === this.disPlayLabel || "label" === this.disPlayLabel) f = decodeURIComponent(A.getAttr(a, "data")); f = this.isNumberField ? parseFloat(f) :
                                                                        f; f = { value: f, isChecked: !1 }; A.hasClass(a, "checked") && (f.isChecked = !0); g.push(f)
                                                        } return g
                                                }, getIfValueExist: function (g) { for (var b = this._getCheckInputItems(), e = 0; e < b.length; e++) { var a = this._getNodeText(b[e].nextSibling); if (g === a) return !0 } return !1 }, getCurrentItem: function () { for (var g = this._getCheckInputItems(), b = 0; b < g.length; b++) { var e = g[b]; if (A.hasClass(e, "checked")) return e } return null }, checkCBXItems: function (g) {
                                                        g = g ? "" : this.valueInput.get("value"); this.valueInput.set("value", g); g = l(".item .label", this.listContent);
                                                        for (var b = 0; b < g.length; b++) { var e = g[b], a = "value" === this.disPlayLabel ? this._getNodeText(e) : decodeURIComponent(A.getAttr(e.previousSibling, "data")); a = this.isNumberField ? parseFloat(a) : a; 0 <= this.checkedList.indexOf(a) || this.isNumberField && 0 <= this.checkedList.indexOf(parseFloat(a)) ? A.addClass(e.previousSibling, "checked") : A.removeClass(e.previousSibling, "checked") }
                                                }, reset: function () { this.listContent.innerHTML = "" }, setCBXData: function (g, b, e, a) {
                                                        a || (this.queryState = !1); g = g ? g : []; if (this.listContent) {
                                                                A.setStyle(this.noDataTips,
                                                                        "display", "none"); var f = 0, h = "radio" === this.inputType ? " labelBig" : "", p = this.runtime ? " labelRuntime" : ""; a = this.listContent.innerHTML; if (e) {
                                                                                a = this.listContent.innerHTML = ""; if ("uniquePredefined" === this.controlType && this.enableEmpty || "uniqueDynamic" === this.controlType && !this.keyQueryMode) e = a = "", this.checkedList[0] === this.emptyStr && (a = " checked", e = " active", f = 1), 0 === this.checkedList.length && (a = " checked", this.currentItem = !0, f = 1), a = '\x3cdiv role\x3d"option" class\x3d"item emptyItem' + e + '" aria-selected\x3d"true" tabindex\x3d"-1" ' +
                                                                                        (a ? 'aria-checked\x3d"true"' : 'aria-checked\x3d"false"') + '\x3e\x3cdiv class\x3d"checkInput ' + this.inputType + a + "\" data\x3d'" + (this.emptyStr + "'\x3e\x3c/div\x3e\x3cdiv class\x3d\"label") + h + " jimu-ellipsis-Blanks" + p + '" style\x3d"max-width:' + this._itemLabelW + 'px"\x3e' + this.emptyStr + "\x3c/div\x3e\x3c/div\x3e"; this.listContainer.scrollTop = 0
                                                                        } if (0 === g.length) return g = this.listContent.innerHTML.replace(/(^\s*)|(\s*$)/g, ""), "" !== g || this.cacheQueryMode && !this.isCacheFinish || A.setStyle(this.noDataTips, "display",
                                                                                "block"), "" === g && (this.listContent.innerHTML = a), this.listContent; e = ""; for (var B = 0; B < g.length; B++) {
                                                                                        var t = g[B], u = ""; if (b) if (this.runtime && ("multiplePredefined" === this.controlType || "uniquePredefined" === this.controlType)) t.isChecked && (u = " checked", this.currentItem = !0, f++); else if (0 <= this.checkedList.indexOf(t.value) || this.isNumberField && 0 <= this.checkedList.indexOf(parseFloat(t.value))) u = " checked", this.currentItem = !0, f++; var z = ""; z = u ? 'aria-checked\x3d"true"' : 'aria-checked\x3d"false"'; var x = 'data\x3d"' +
                                                                                                (this.isNumberField ? t.value : encodeURIComponent(t.value)) + '"'; e += '\x3cdiv class\x3d"item" role\x3d"option" tabindex\x3d"-1" aria-selected\x3d"true" ' + z + '\x3e\x3cdiv class\x3d"checkInput ' + this.inputType + u + '" ' + x + '\x3e\x3c/div\x3e\x3cdiv class\x3d"label' + h + " jimu-ellipsis-Blanks" + p + '" style\x3d"max-width:' + this._itemLabelW + 'px"\x3e' + t[this.disPlayLabel] + "\x3c/div\x3e\x3c/div\x3e"
                                                                                } g = this.checkedList.length - f; if (this.runtime && 0 < g) for (b = 0; b < g; b++)this.emit("advancedListValueSelect_itemUnChecked", ""); this.listContent.innerHTML =
                                                                                        a + e; return this.listContent
                                                        }
                                                }, setCBXContentBySearch: function (g, b) { 0 === g.length ? this.setCBXData([], !1, !0, b) : this.setCBXData(g, !0, !0, b) }, _onSearchKeyChange: function () {
                                                        var g = this.valueInput.get("value"); this.searchName = g; this.listContainer.scrollTop = 0; this.reset(); this.cacheQueryMode = this.keyQueryMode = this.ifFristPage = !0; this.emit("advancedListValueSelect_searchKeyLocal", g); this.codedValues || (this.isCacheFinish || A.setStyle(this.loadMoreDataBtn, "display", "block"), 0 === g.length && (this.queryState = this.cacheQueryMode =
                                                                this.keyQueryMode = !1, A.setStyle(this.loadMoreDataBtn, "display", "none")))
                                                }, _loadMoreDataFromServer: function () {
                                                        this.keyQueryMode = this.ifFristPage = !0; this.cacheQueryMode = !1; this.queryState = !0; A.setStyle(this.loadMoreDataBtn, "display", "none"); var g = this.valueInput.get("value"); this.searchName = g; this.listContainer.scrollTop = 0; "multipleDynamic" === this.controlType || "uniqueDynamic" === this.controlType ? this.emit("advancedListValueSelect_searchKey", g) : this.runtime || this.emit("advancedListValueSelect_searchKey",
                                                                g)
                                                }, currentHoverItem: null, _addCBXHoverEvent: function () {
                                                        this.own(v(this.listContent, "mouseover", E.hitch(this, function (g) { g = g.target || g.srcElement; if (g = A.hasClass(g, "item") ? g : c.getAncestorDom(g, function (b) { return A.hasClass(b, "item") }, 3)) this.currentHoverItem && A.removeClass(this.currentHoverItem, "active"), A.addClass(g, "active"), this.currentHoverItem = g }))); this.own(v(this.listContent, "mouseout", E.hitch(this, function () {
                                                                this.currentHoverItem && A.removeClass(this.currentHoverItem, "active"); this.currentHoverItem =
                                                                        null
                                                        })))
                                                }, _addCBXClickEvent: function () {
                                                        this.own(v(this.valueInput, "change", E.hitch(this, function () { this._onSearchKeyChange() }))); this.own(v(this.loadMoreDataBtn, "click", E.hitch(this, function () { this._loadMoreDataFromServer() }))); this.own(v(this.listContainer, "scroll", E.hitch(this, this.dropDownScroll))); this.own(v(this.searchKeyInput, "click", E.hitch(this, function (g) { g.stopPropagation() }))); this.own(v(this.listContainer, "click", E.hitch(this, function (g) {
                                                                var b = g.target; if (A.hasClass(b, "item")) {
                                                                        var e = b.firstElementChild;
                                                                        b = b.firstElementChild.nextSibling
                                                                } else if (A.hasClass(b, "checkInput")) e = b, b = b.nextSibling; else if (A.hasClass(b, "label")) e = b.previousSibling; else { g.stopPropagation(); return } this._setCBXChecked(e, this._getNodeText(b)); g.stopPropagation()
                                                        })))
                                                }, scrollDiff: 100, dropDownScroll: function (g) {
                                                        this.runtime && ("uniquePredefined" === this.controlType || "multiplePredefined" === this.controlType) || this.cacheQueryMode || this.codedValues || (this.queryState ? this.listContainer.scrollTop = this.containerScrollTop : (g = g.target, g.scrollHeight -
                                                                g.clientHeight - g.scrollTop <= this.scrollDiff && !this.queryState && (this.containerScrollTop = this.listContainer.scrollTop, this.queryState = !0, this.ifFristPage = !1, this.emit("advancedListValueSelect_addNextPage"))))
                                                }, _setCBXChecked: function (g, b) {
                                                        var e = b; if ("alias" === this.disPlayLabel || "label" === this.disPlayLabel) e = decodeURIComponent(A.getAttr(g, "data")); A.hasClass(g, "checked") ? (A.setAttr(g.parentNode, "aria-checked", "false"), "radio" === this.inputType ? this.runtime || "predefined" !== this.controlType ? this.emit("advancedListValueSelect_itemChecked",
                                                                b) : this.emit("advancedListValueSelect_itemCheckedForPredefined", e, b) : (A.removeClass(g, "checked"), this._updateCheckedList("remove", e, b), this.emit("advancedListValueSelect_itemUnChecked", b))) : (A.setAttr(g.parentNode, "aria-checked", "true"), "radio" === this.inputType && this.currentItem && (!0 === this.currentItem && (this.currentItem = this.getCurrentItem()), this.currentItem && (A.removeClass(this.currentItem, "checked"), A.setAttr(this.currentItem.parentNode, "aria-checked", "false"))), A.addClass(g, "checked"), this.currentItem =
                                                                        g, this._updateCheckedList("add", e, b), this.runtime || "predefined" !== this.controlType ? this.emit("advancedListValueSelect_itemChecked", b) : this.emit("advancedListValueSelect_itemCheckedForPredefined", e, b))
                                                }, initDoms: function (g, b) { this.setCBXData(g, b) }, getData: function () { }, refreshData: function () { this.checkCBXItems() }, validate: function () {
                                                        var g = this.checkedList.length ? "12345678" : null; 1 === this.checkedList.length && this.checkedList[0] === this.emptyStr && (g = null); if (this.isNumberField) for (var b = 0; b < this.checkedList.length; b++) {
                                                                var e =
                                                                        this.checkedList[b]; if (e !== this.emptyStr && isNaN(e)) { g = null; break }
                                                        } this.set("DisplayedValue", g); return !0
                                                }, setRequired: function (g) { this.mutiValuesSelect.set("required", g) }, destroy: function () { A.destroy(this.domNode); this.inherited(arguments) }
                                        })
                                })
                }, "jimu/dijit/_filter/pageControlForQuery": function () {
                        define("dojo/Deferred esri/tasks/query dojo/_base/array dojo/_base/lang dojo/_base/declare jimu/Query jimu/LayerStructure dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./pageControlForQuery.html jimu/filterUtils jimu/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g) {
                                        return m([l, k, n], {
                                                templateString: d, layerUrl: null, fieldInfo: null, fieldPopupInfo: null, spatialReference: null, layerDefinition: null, isNumberField: !1, showNullValues: !1, _isUniqueValueCacheFinish: !1, _uniqueValueCache: {}, _uniqueValueCacheForOtherTypes: {}, _codedvalueCache: [], cascadeFilterExprs: "1\x3d1", numbericFieldLength: { esriFieldTypeOID: 32, esriFieldTypeSmallInteger: 16, esriFieldTypeInteger: 32, esriFieldTypeSingle: 128, esriFieldTypeDouble: 1024 }, pageIndex: 1, pageSize: 1E3, postCreate: function () {
                                                        this.inherited(arguments);
                                                        this.spatialReference = r.getInstance().map.spatialReference; this.reset(); this.queryType = v.getQueryType(this.layerDefinition); this.isNumberField ? this.fieldLength = this.numbericFieldLength[this.fieldInfo.type] : (this.filterUtils = new c, this.isLayerHosted = g.isHostedService(this.layerUrl))
                                                }, reset: function () { this.pageIndex = 1; this._isUniqueValueCacheFinish = !1; this._uniqueValueCache = {}; this._uniqueValueCacheForOtherTypes = {}; this._codedvalueCache = [] }, isKeyQueryLoader: !1, _searchKey: function (b) {
                                                        var e = new E, a = new q,
                                                        f = ""; this.isNumberField ? f = "CAST(" + this.fieldInfo.name + " AS CHAR(" + this.fieldLength + ")) LIKE '%" + b + "%'" : (f = this.isLayerHosted && this.filterUtils.containsNonLatinCharacter(b) ? "N" : "", f = this.isLayerHosted ? this.fieldInfo.name + " LIKE " + f + "'%" + b.replace(/'/g, "''") + "%'" : "LOWER(" + this.fieldInfo.name + ") LIKE " + f + "'%" + b.replace(/'/g, "''").toLowerCase() + "%'"); a.where = "((" + this.cascadeFilterExprs + ") AND (" + f + "))"; a.geometry = null; a.outSpatialReference = this.spatialReference; a.outFields = [this.fieldInfo.name]; a.returnDistinctValues =
                                                                !0; a.returnGeometry = !1; a.orderByFields = a.outFields; this.layerLoaderForKey = new v({ url: this.layerUrl, query: a, pageSize: this.pageSize }); this.isKeyQueryLoader = !0; this._uniqueValueCacheForOtherTypes = {}; this.queryByPage(!0).then(w.hitch(this, function (h) { e.resolve(h) }), w.hitch(this, function (h) { e.reject("reject:" + h) })); return e
                                                }, _searchKeyLocal: function (b) {
                                                        b = b.toLowerCase(); this.isKeyQueryLoader = !1; var e = [], a = this._codedvalueCache; if (0 < a.length) for (var f = 0; f < a.length; f++) {
                                                                var h = a[f]; h.label && 0 <= h.label.toString().toLowerCase().indexOf(b) &&
                                                                        e.push(h)
                                                        } else for (f in a = this._uniqueValueCache, a) for (var p = a[f], B = 0; B < p.length; B++) { h = p[B]; var t = h.label; t && 0 <= t.toString().toLowerCase().indexOf(b) && e.push(h) } return e
                                                }, queryByPage: function (b) {
                                                        var e = new E; this.layerLoader && this.layerLoader.query.where !== this.cascadeFilterExprs && (this.layerLoader = null, this.isKeyQueryLoader = !1, this.reset()); if (!this.layerLoader) {
                                                                var a = new q; a.where = this.cascadeFilterExprs; a.geometry = null; a.outSpatialReference = this.spatialReference; a.outFields = [this.fieldInfo.name];
                                                                a.returnDistinctValues = !0; a.returnGeometry = !1; a.orderByFields = a.outFields; this.layerLoader = new v({ url: this.layerUrl, query: a, pageSize: this.pageSize })
                                                        } b && (this.pageIndex = 1); b = []; if (this.isKeyQueryLoader) { if (this._uniqueValueCacheForOtherTypes[this.pageIndex]) return b = this._resolveValueLabelsFromCache(this._uniqueValueCacheForOtherTypes), e.resolve(b), e; b = this.layerLoaderForKey } else {
                                                                if (this._uniqueValueCache[this.pageIndex]) return b = this._resolveValueLabelsFromCache(this._uniqueValueCache), e.resolve(b),
                                                                        e; b = this.layerLoader
                                                        } 1 === this.queryType ? b.queryByPage(this.pageIndex).then(w.hitch(this, function (f) {
                                                                if (f) {
                                                                        var h = f.features || []; f = h.length; this.showNullValues || (h = this._getNotNullValues(h)); h = this._getValueLabelsFromFeatures(h); this.isKeyQueryLoader ? (this._uniqueValueCacheForOtherTypes[this.pageIndex - 1] = h, f < this.pageSize && (this._uniqueValueCacheForOtherTypes[this.pageIndex] = [])) : (this._uniqueValueCache[this.pageIndex - 1] = h, f < this.pageSize && (this._uniqueValueCache[this.pageIndex] = [], this._isUniqueValueCacheFinish =
                                                                                !0)); 0 === h.length && this.pageIndex--; e.resolve(h)
                                                                } else e.reject("Can't get features from current layer")
                                                        }), w.hitch(this, function (f) { e.reject(f) })) : b.getAllFeatures().then(w.hitch(this, function (f) {
                                                                if (f) {
                                                                        var h = f.features || []; this.showNullValues || (h = this._getNotNullValues(h)); f = 0 < h.length ? !0 : !1; h = this._getDistinctValues(h); h = this._getValueLabelsFromFeatures(h); h = this.isKeyQueryLoader ? this._getAndStoreValueLabelsForOtherTypes(h, this._uniqueValueCacheForOtherTypes) : this._getAndStoreValueLabelsForOtherTypes(h,
                                                                                this._uniqueValueCache); this._isUniqueValueCacheFinish = !0; e.resolve(f ? h : [])
                                                                } else e.reject("Can't get features from current layer")
                                                        }), w.hitch(this, function (f) { e.reject(f) })); this.pageIndex++; return e
                                                }, _resolveValueLabelsFromCache: function (b) { b = b[this.pageIndex]; 0 !== b.length && this.pageIndex++; return b }, _getAndStoreValueLabelsForOtherTypes: function (b, e) {
                                                        for (var a = 0; a < b.length; a += this.pageSize)e[parseInt(a / this.pageSize, 10) + 1] = b.slice(a, a + this.pageSize); for (var f in e) b = parseInt(f, 10) + 1, e[b] || (e[b] = []);
                                                        return e[1]
                                                }, _getDistinctValues: function (b) { var e = {}, a = [], f; for (f in b) { var h = b[f], p = h.attributes[this.fieldInfo.name]; e[p] || (e[p] = !0, a.push(h)) } return a }, _getNotNullValues: function (b) { return b = A.filter(b, w.hitch(this, function (e) { e = e.attributes[this.fieldInfo.name]; return "\x3cNull\x3e" !== e && null !== e })) }, _getValueLabelsFromFeatures: function (b) {
                                                        var e = this.fieldInfo.name; b = A.map(b, function (a) { return a.attributes[e] }); b = g._getValues(this.layerDefinition, this.fieldPopupInfo, e, b); "esriFieldTypeDate" ===
                                                                this.fieldInfo.type && (b = this._getDistinctValueLabelsByFormat(b)); return b
                                                }, _getDistinctValueLabelsByFormat: function (b) { var e = {}, a = [], f; for (f in b) { var h = b[f].value; e[h] || (e[h] = !0, a.push(b[f])) } return a }
                                        })
                                })
                }, "jimu/dijit/_filter/PredefinedValueProvider": function () {
                        define("dojo/_base/html dojo/_base/declare dojo/text!./PredefinedValueProvider.html dojo/_base/lang dojo/on jimu/dijit/Popup ./PredefinedValuePopup ./ValueProvider".split(" "), function (E, q, A, w, m, v, r, l) {
                                return q([l], {
                                        templateString: A, nls: null,
                                        url: "", layerDefinition: null, partObj: null, fieldInfo: null, codedValues: null, staticValues: null, layerInfo: null, popupInfo: null, operatorInfo: null, filterCodedValueIfPossible: !1, runtime: !1, providerType: null, valueProvider: null, postCreate: function () {
                                                this.inherited(arguments); this.jimuNls = window.jimuNls; E.addClass(this.domNode, "jimu-filter-indexBtn-value-provider"); E.addClass(this.valueProviderPopupNode, "value-type-popup"); E.setStyle(this.valueProviderPopupNode, "display", "none"); var k = ""; "UNIQUE_PREDEFINED_VALUE_PROVIDER" ===
                                                        this.providerType ? k = this.nls.predefinedUniqueTips : "MULTIPLE_PREDEFINED_VALUE_PROVIDER" === this.providerType && (k = this.nls.predefinedMultipleTips); this.indexBtnTips.title = k; this.indexBtnTips.innerText = k + " ..."; this._initProvider(); this._bindEvent()
                                        }, _initProvider: function () {
                                                var k = {
                                                        preDefinedTips: this.indexBtnTips, nls: this.nls, url: this.url, layerDefinition: this.layerDefinition, partObj: this.partObj, fieldInfo: this.fieldInfo, codedValues: this.codedValues, staticValues: this.staticValues, layerInfo: this.layerInfo,
                                                        popupInfo: this.popupInfo, operatorInfo: this.operatorInfo, filterCodedValueIfPossible: this.filterCodedValueIfPossible, runtime: this.runtime, selectUI: this.selectUI, providerType: this.providerType
                                                }; if ("UNIQUE_PREDEFINED_VALUE_PROVIDER" === this.providerType || "MULTIPLE_PREDEFINED_VALUE_PROVIDER" === this.providerType) this.valueProvider = new r(k); this.valueProvider.on("predefinedValuePopup_setApplyBtnState", w.hitch(this, function (n) { this.popup && (n ? this.popup.enableButton(0) : this.popup.disableButton(0)) }))
                                        }, _bindEvent: function () {
                                                this.own(m(this.indexBtn,
                                                        "click", w.hitch(this, function () {
                                                                this.valueProvider && this.destroyProvider(); this._initProvider(); this.setValueObject(this.valueObjEnd, this.valueObjEnd.type); this.popup = new v({
                                                                        width: 800, height: 600, content: this.valueProvider, titleLabel: this.indexBtnTips.title, useFocusLogic: !1, onClose: w.hitch(this, function () { this.getValueObject(!1); this._closeCBXPopup(); this.destroyProvider() }), buttons: [{ label: this.nls.apply, disable: !0, onClick: w.hitch(this, function () { this.getValueObject(!0) ? this.popup.close() : alert("please configurate some items") }) },
                                                                        { label: this.jimuNls.common.cancel, classNames: ["jimu-btn-vacation"], onClick: w.hitch(this, function () { this.popup.close() }) }]
                                                                }); E.addClass(this.popup.domNode, "widget-at-filter-popup"); setTimeout(w.hitch(this, function () { this.valueProvider._setApplyState(this.getValueObject(!0)); this.valueProvider._setDisplayTypeStyle() }), 100)
                                                        })))
                                        }, _closeCBXPopup: function () { this.valueProvider.cbxPopup && this.valueProvider.cbxPopup.domNode && (this.valueProvider.cbxPopup.onClose = w.hitch(this, function () { return !0 }), this.valueProvider.cbxPopup.close()) },
                                        _saveData: function () { this.valueProvider.saveData() }, reset: function () { }, getDijits: function () { return [] }, getStatus: function () { return 1 }, setValueObject: function (k) { k && (this.valueObjEnd = k); this.valueProvider.setValueObject(k, !0) }, valueObj: null, getValueObject: function (k) { if (k) return this.valueObjEnd = k = this.valueProvider.getValueObject(), k.value.length; delete this.valueObjEnd.valueList; return 0 === this.valueObjEnd.value.length ? 0 : this.valueObjEnd }, destroyProvider: function () {
                                                this.valueProvider && this.valueProvider.destroyProvider();
                                                this.valueProvider = null
                                        }
                                })
                        })
                }, "jimu/dijit/_filter/PredefinedValuePopup": function () {
                        define("dojo/_base/lang dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/declare dojo/Evented dojo/query ./ValueProvider ./EditTable ./AdvancedListValueSelect dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PredefinedValuePopup.html dojo/store/Memory jimu/utils jimu/dijit/Popup jimu/dijit/_filter/pageControlForQuery dojox/form/CheckedMultiSelect".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c,
                                g, b, e, a, f, h) {
                                        return m([l, d, c, v], {
                                                templateString: g, codedValues: null, staticValues: null, showNullValues: !1, cbxPopup: null, pageSize: 1E3, pageIndex: 1, selectUI: null, postMixInProperties: function () { this.inherited(arguments); this.CommonNls = window.jimuNls.common; this.Nls = window.jimuNls.filterBuilder; this.emptyStr = window.apiNls.widgets.FeatureTable.empty }, postCreate: function () {
                                                        this.inherited(arguments); this.selectUI = this.selectUI ? this.selectUI : "dropdown"; A.addClass(this.domNode, "jimu-filter-mutcheck-list-value-provider");
                                                        this.controlType = "unique"; "MULTIPLE_PREDEFINED_VALUE_PROVIDER" === this.providerType && (this.controlType = "multiple"); this.isNumberField = e.isNumberField(this.fieldInfo.type); this.editTable || (this.editTable = new k({ tableType: this.controlType, dataList: [], codedValues: this.codedValues, emptyStr: this.emptyStr, customValue: this.Nls.addValuePlaceHolder, customLabel: this.Nls.addLabelPlaceHolder, isNumberField: this.isNumberField }), this.editTable.placeAt(this.tableContent), this.editTable.on("editTable_openListSelectByName",
                                                                E.hitch(this, this._showListSelectByTable)), this.editTable.on("editTable_itemChanged", E.hitch(this, this._editTableItemChanged)), this.editTable.on("editTable_getValLabelsArrayForNumber", E.hitch(this, this._getValLabelsArrayForNumber))); this.supportPaing = !0; this.pageControlForQuery || (this.pageControlForQuery = new f({ pageSize: this.pageSize, pageIndex: 1, layerUrl: this.url, fieldInfo: this.fieldInfo, queryWhere: "1\x3d1", layerDefinition: this.layerDefinition, fieldPopupInfo: this.fieldPopupInfo, isNumberField: this.isNumberField }));
                                                        this.listSelect || (this.listSelect = new n({ emptyStr: this.emptyStr, runtime: this.runtime, pageSize: this.pageSize, selectType: "unique", controlType: "predefined", dataList: [], selectedDataList: [], isNumberField: this.isNumberField }), this.listSelect.on("advancedListValueSelect_itemChecked", E.hitch(this, this._createTarget)), this.listSelect.on("advancedListValueSelect_itemUnChecked", E.hitch(this, this._destoryTarget)), this.listSelect.on("advancedListValueSelect_addNextPage", E.hitch(this, this._addNextPage)), this.listSelect.on("advancedListValueSelect_searchKey",
                                                                E.hitch(this, this._searchKey)), this.listSelect.on("advancedListValueSelect_searchKeyLocal", E.hitch(this, this._searchKeyLocal)), this.listSelect.on("advancedListValueSelect_itemCheckedForPredefined", E.hitch(this, this._createTargetForPredefined))); this.mutiValuesSelect || (this.mutiValuesSelect = new h({ multiple: !0, required: !1, intermediateChanges: !0, style: { width: "100%" } })); this._multipleSelectProviderEventHandler = E.hitch(this, this._multipleSelectProviderEvent); document.addEventListener("click", this._multipleSelectProviderEventHandler);
                                                        var p = new b({ idProperty: "id", data: [] }); this.listSelect.set("store", p)
                                                }, _multipleSelectProviderEvent: function (p) {
                                                        var B = p.target || p.srcElement, t = A.isDescendant(B, this.editTable.searchBtn); this.editTable && this.cbxPopup && this.cbxPopup.domNode ? (t ? "block" === A.getStyle(this.cbxPopup.domNode, "display") ? A.setStyle(this.cbxPopup.domNode, "display", "none") : A.setStyle(this.cbxPopup.domNode, "display", "block") : A.isDescendant(B, this.cbxPopup.domNode) || this._createTargetForPredefined(), p.stopPropagation()) : this._isInSelectPopup(B) ||
                                                                this.runtime ? p.stopPropagation() : A.setStyle(this.valuesPopupNode, "display", "none")
                                                }, _initAdvancedListValueSelect: function () {
                                                        this.pageControlForQuery.pageIndex = 1; this.pageControlForQuery.isKeyQueryLoader = !1; this.listSelect = new n({ emptyStr: this.emptyStr, runtime: this.runtime, pageSize: this.pageSize, isCacheFinish: this.pageControlForQuery._isUniqueValueCacheFinish, selectType: "unique", controlType: "predefined", dataList: [], selectedDataList: [], isNumberField: this.isNumberField }); this.listSelect.on("advancedListValueSelect_itemChecked",
                                                                E.hitch(this, this._createTarget)); this.listSelect.on("advancedListValueSelect_itemUnChecked", E.hitch(this, this._destoryTarget)); this.listSelect.on("advancedListValueSelect_addNextPage", E.hitch(this, this._addNextPage)); this.listSelect.on("advancedListValueSelect_searchKey", E.hitch(this, this._searchKey)); this.listSelect.on("advancedListValueSelect_searchKeyLocal", E.hitch(this, this._searchKeyLocal)); this.listSelect.on("advancedListValueSelect_itemCheckedForPredefined", E.hitch(this, this._createTargetForPredefined))
                                                },
                                                _isInSelectPopup: function (p) { for (var B = "dijitCheckBoxInput dojoxMultiSelectItemLabel dojoxMultiSelectItemBox dojoxMultiSelectItem dojoxCheckedMultiSelectWrapper dojoxCheckedMultiSelect value-type-popup popupOper pageItem".split(" "), t = !1, u = 0; u <= B.length; u++)if (A.hasClass(p, B[u])) { t = !0; break } return t }, _createTarget: function () { this.editTable._createTarget("", "", "", "", !0); this._editTableItemChanged() }, _createTargetForPredefined: function (p, B) { this.editTable._setNewLabel(p, B); this.cbxPopup.close(); this._editTableItemChanged() },
                                                _destoryTarget: function (p) { this.editTable._destroyTarget(p); this._editTableItemChanged() }, _editTableItemChanged: function () { if (!this.runtime) { var p = this.getValueObject(); this._setApplyState(p.value.length) } }, _setApplyState: function (p) { this.emit("predefinedValuePopup_setApplyBtnState", p) }, _cbxWidth: 245, _cbxHeight: 340, isPopupLoading: !1, _showListSelectByTable: function (p) {
                                                        if (!this.isPopupLoading) {
                                                                this._initAdvancedListValueSelect(); this.valueList = [p]; this.getCheckedList(this.valueList); p = A.position(this.editTable.searchBtn);
                                                                var B = p.x - 226, t = p.y + 30; window.isRTL && (B = p.x); this.cbxPopup = new a({ width: this._cbxWidth, height: this._cbxHeight, content: this.listSelect.domNode, enableMoveable: !1, hasTitle: !1, hasOverlay: !1, contentHasNoMargin: !0, moveToCenter: !1, customPosition: { left: B, top: t }, useFocusLogic: !1, buttons: [] }); this.cbxPopup.setDomNodeStyls({ "border-radius": 0, border: "1px solid #999" }); this.cbxPopup.on("popupHasInitedSuccessfully", E.hitch(this, function () {
                                                                        var u = A.position(this.editTable.searchBtn), z = u.x - 226, x = u.y + 30; window.isRTL &&
                                                                                (z = u.x); this.cbxPopup.setCustomPosition(z, x)
                                                                })); this.listSelect.valueInput && this.listSelect.valueInput.focus(); this._showLoadingIcon(); this.isPopupLoading = !0; this._valueLabels().then(E.hitch(this, function (u) { this.isPopupLoading = !1; this._hideLoadingIcon(); if (!0 !== u) { var z = !1; this.valueList && 0 !== this.valueList.length && (z = !0); this.listSelect.setCBXData(u, z) } }))
                                                        }
                                                }, _valueLabels: function () {
                                                        var p = new q; this.listSelect.codedValues = !1; this.listSelect.disPlayLabel = "label"; if (this.staticValues) return this._setValueForStaticValues(this.staticValues),
                                                                p.resolve(!0), p; if (this.codedValues) if (this.filterCodedValue) this.listSelect.codedValues = !0; else return this._setValueForStaticValues(this.codedValues), p.resolve(!0), p; this.pageControlForQuery.queryByPage(!0).then(E.hitch(this, function (B) { p.resolve(B) }), E.hitch(this, function (B) { console.log(B); this._hideLoadingIcon(); p.reject(B) })); return p
                                                }, _setValueForStaticValues: function (p) {
                                                        this.listSelect.codedValues = !0; p && (this.pageControlForQuery._codedvalueCache = p, p = 0 < p.length ? p : [], this.listSelect.setCBXData(p,
                                                                !0, !0))
                                                }, _changeDisplayType: function (p) { p = p.target || p.srcElement; p = A.hasClass(p, "option") ? p : e.getAncestorDom(p, function (B) { return A.hasClass(B, "option") }, 2); A.hasClass(p, "checked") || (A.addClass(p, "checked"), p = r("." + this.selectUI + "Option ", this.displayTypes)[0], A.removeClass(p, "checked"), this.selectUI = "expanded" === this.selectUI ? "dropdown" : "expanded") }, _setDisplayTypeStyle: function () {
                                                        var p = r(".title", this.displayTypes)[0], B = r(".label", this.displayTypes); p = (A.getStyle(this.displayTypes, "width") - A.getStyle(p,
                                                                "width") - 80) / 2; var t = A.getStyle(B[0], "width"); t = t < p ? t : p; var u = A.getStyle(B[1], "width"); u = u < p ? u : p; A.setStyle(B[0], "width", t + "px"); A.setStyle(B[1], "width", u + "px")
                                                }, _addNextPage: function () {
                                                        this.listSelect && (this._showLoadingIcon(), this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage).then(E.hitch(this, function (p) { this.listSelect.isCacheFinish = this.pageControlForQuery._isUniqueValueCacheFinish; this.listSelect.setCBXData(p, !0); this._hideLoadingIcon() }), E.hitch(this, function (p) {
                                                                console.log(p);
                                                                this._hideLoadingIcon()
                                                        })))
                                                }, _searchKey: function (p) { this.listSelect && (this._showLoadingIcon(), this.pageControlForQuery._searchKey(p).then(E.hitch(this, function (B) { this.listSelect.setCBXContentBySearch(B); this._hideLoadingIcon() }), E.hitch(this, function (B) { console.log(B); this._hideLoadingIcon() }))) }, _searchKeyLocal: function (p) { this.listSelect && (this._showLoadingIcon(), p = this.pageControlForQuery._searchKeyLocal(p), this.listSelect.setCBXContentBySearch(p), this._hideLoadingIcon()) }, _handlerPageValues: function () { },
                                                getCheckedList: function (p) { this.listSelect.checkedList = []; this.isNumberField ? w.forEach(p, E.hitch(this, function (B) { this.listSelect.checkedList.push(parseFloat(B)) })) : this.listSelect.checkedList = p }, _showPopup: function () {
                                                        var p = this.getValueObject().valueList; this.valueList = null === p ? void 0 : p; this.getCheckedList(this.valueList); this.cbxPopup ? (this.listSelect.checkCBXItems(!1), this.cbxPopup.show()) : (this.cbxPopup = new a({
                                                                width: 355, height: 596, content: this.listSelect.domNode, titleLabel: this.layerDefinition.name +
                                                                        "(" + this.fieldName + ")", isResize: !1, useFocusLogic: !1, onClose: E.hitch(this, function () { this.cbxPopup.hide(); return !1 }), buttons: []
                                                        }), this._showLoadingIcon(), this.pageControlForQuery.queryByPage().then(E.hitch(this, function (B) { this._hideLoadingIcon(); var t = !1; this.valueList && 0 !== this.valueList.length && (t = !0); this.listSelect.setCBXData(B, t) })))
                                                }, getDijits: function () { return [this.mutiValuesSelect] }, setValueObject: function (p) {
                                                        p.value = p.value ? p.value : []; var B = r("." + (p.selectUI ? p.selectUI : this.selectUI) + "Option ",
                                                                this.displayTypes)[0]; A.addClass(B, "checked"); B = null; if (this.isNumberField) { B = []; for (var t = 0; t < p.value.length; t++)B.push(p.value[t].value); B = this._getValLabelsArrayForNumber(!1, B) } this.editTable.emptyLabel = p.emptyLabel; this.editTable.enableEmpty = p.enableEmpty; this.editTable.setListValues(p.value, B)
                                                }, _getValLabelsArrayForNumber: function (p, B) { B = e._getValues(this.layerDefinition, this.fieldPopupInfo, this.fieldName, B); p && (this.editTable.currentValLabel = B[0].label); return B }, tryGetValueObject: function () {
                                                        return this.isValidValue() ?
                                                                this.getValueObject() : this.isEmptyValue() ? { isValid: !0, selectUI: this.selectUI, type: this.partObj.valueObj.type, value: [], valueList: [] } : null
                                                }, getValueObject: function () { if (this.isValidValue()) { var p = this.editTable.getListValues(), B = { isValid: !0, selectUI: this.selectUI, type: this.partObj.valueObj.type, value: p.list, valueList: p.valueList }; "unique" === this.controlType && (B.emptyLabel = p.emptyLabel, B.enableEmpty = p.enableEmpty); return B } return null }, setRequired: function (p) { this.mutiValuesSelect.set("required", p) },
                                                queryByPage: function () { var p = this.pageControlForQuery.queryByPage(this.listSelect.ifFristPage); p.then(E.hitch(this, function (B) { p.resolve(B) }), E.hitch(this, function (B) { console.log(B); p.reject(B) })) }, _showLoadingIcon: function () { this.listSelect && this.listSelect.listContainer && A.addClass(this.listSelect.listContainer, "jimu-circle-loading") }, _hideLoadingIcon: function () { this.listSelect && this.listSelect.listContainer && A.removeClass(this.listSelect.listContainer, "jimu-circle-loading") }, destroy: function () {
                                                        this._multipleSelectProviderEventHandler &&
                                                        document.removeEventListener("click", this._multipleSelectProviderEventHandler); this.inherited(arguments)
                                                }, destroyProvider: function () { this.editTable && this.editTable.destroy(); this.listSelect && this.listSelect.destroy(); this.listSelect = null; this.destroy(); A.destroy(this.domNode) }
                                        })
                        })
                }, "jimu/dijit/_filter/EditTable": function () {
                        define("dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dojo/keys dojo/dom-attr dojo/_base/declare dijit/_WidgetBase dojo/query dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./EditTable.html jimu/utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                        return r([l, c, g, A], {
                                                templateString: b, currentItem: null, dataList: [], codedValues: null, isNumberField: !0, tableType: "unique", postMixInProperties: function () { this.inherited(arguments); this.CommonNls = window.jimuNls.common; this.Nls = window.jimuNls.filterBuilder }, postCreate: function () {
                                                        this.inherited(arguments); q.addClass(this.domNode, "jimu-filter-mutcheck-list-value-provider"); "unique" === this.tableType ? (this.inputType = "radio", q.addClass(this.listContent, "radio-items-list-content")) :
                                                                this.inputType = "checkbox"
                                                }, _onListContentDblClicked: function (a) {
                                                        this.isSearch = !1; var f = a.target || a.srcElement, h = e.getAncestorDom(f, function (B) { return q.hasClass(B, "item") }, 3); if (h && (q.hasClass(f, "name") || q.hasClass(f, "alias")) && (!q.hasClass(h, "empty") || !q.hasClass(f, "name"))) {
                                                                this._dijit ? (this.editState = "active", this.updateInputDivPre = this.updateInputDiv, this._dijitPre = this._dijit) : this.editState = "negative"; a = this._getNodeText(f); var p = decodeURIComponent(q.getAttr(f, "data")); h = q.hasClass(h, "custom");
                                                                this.placeHolder = q.hasClass(f, "name") && !this.codedValues ? p : a; h ? q.hasClass(f, "alias") && this.placeHolder !== this.customLabel ? this.currentLabel = a : this.currentLabel = NaN : this.currentLabel = this.isNumberField && q.hasClass(f, "name") && !this.codedValues ? parseFloat(this.placeHolder) : this.placeHolder; v.set(f, "innerHTML", ""); a = ""; q.hasClass(f, "name") && (a = '\x3cdiv class\x3d"searchBtn"\x3e\x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\x3c/div\x3e'); this.updateInputDiv = q.create("div", {
                                                                        "class": "updateInputDiv",
                                                                        innerHTML: '\x3cdiv class\x3d"inputDiv"\x3e\x3c/div\x3e' + a
                                                                }, f); a = k(".inputDiv", this.updateInputDiv)[0]; this.searchBtn = k(".searchBtn", this.updateInputDiv)[0]; this.own(w(this.updateInputDiv, "dblclick", E.hitch(this, function (B) { B.stopPropagation(); B.preventDefault() }))); p = { required: !1, intermediateChanges: !1, value: this.currentLabel }; this.codedValues && q.hasClass(f, "name") && (p.disabled = !0); this.isNumberField && q.hasClass(f, "name") ? (p.constraints = { pattern: "#####0.##########" }, this._dijit = new d(p)) : (p.trim =
                                                                        !0, this._dijit = new n(p)); this._dijit.startup(); this._dijit.on("keydown", function (B) { (B.keyCode || B.which) === m.ENTER && this._dijit.emit("blur") }.bind(this)); this._dijit.on("blur", E.hitch(this, function () {
                                                                                if (this._dijit) {
                                                                                        var B = "Error" !== this._dijit.state ? this._dijit.displayedValue : this.currentLabel; this.isNumberField && q.hasClass(f, "name") && "Error" === this._dijit.state && this._dijit.setValue(parseFloat(B)); B = e.sanitizeHTML(B); var t = this._dijit.get("value"); "" !== t && t ? q.hasClass(f, "name") && (this.placeHolder ===
                                                                                                this.customValue || "NaN" === this.placeHolder && "" !== this._dijit.displayedValue) && (t = e.getAncestorDom(this._dijit.domNode, function (u) { return q.hasClass(u, "item") }, 4), q.removeClass(t, "custom"), this.emit("editTable_itemChanged")) : B = this.placeHolder; this.newLabel = B; setTimeout(E.hitch(this, function () {
                                                                                                        if (this.isSearch || "active" === this.editState) "active" === this.editState && (u = this.updateInputDivPre.parentNode, z = decodeURIComponent(q.getAttr(u, "data")), q.hasClass(u, "name") ? this.currentValLabel = "" === this._dijitPre.displayedValue ?
                                                                                                                z === this.customValue ? this.customValue : this.isNumberField ? this._getLocalNumber(z) : z : this.isNumberField ? this._getLocalNumber(this._dijitPre.value) : this._dijitPre.value : this.currentValLabel = "" === this._dijitPre.displayedValue ? z === this.customLabel ? this.customLabel : z : this._dijitPre.displayedValue, !q.hasClass(u, "name") || "NaN" === this.newLabel || this.newLabel === this.customValue || this._getNodeText(u.nextSibling) !== this.customLabel && this._dijit.value !== this.customLabel || (q.isDescendant(this.updateInputDiv, u.nextSibling) ?
                                                                                                                        this._dijit.set("value", this.currentValLabel) : (x = this.isNumberField ? this.currentValLabel : this.newLabel, q.setAttr(u.nextSibling, "data", encodeURIComponent(x)), this._setNodeText(u.nextSibling, x), q.setAttr(u.nextSibling, "title", x))), x = q.hasClass(u, "name") ? "" === this._dijitPre.displayedValue ? z === this.customValue ? this.customValue : z : this._dijitPre.value : this.newLabel, q.setAttr(u, "data", encodeURIComponent(x)), x = q.hasClass(u, "name") ? this.currentValLabel : this.newLabel, this._setNodeText(u, x), q.setAttr(u, "title",
                                                                                                                                x), this._dijitPre = this.updateInputDivPre = null, this.editState = "negative"); else {
                                                                                                                                        var u = this.updateInputDiv.parentNode; var z = decodeURIComponent(q.getAttr(u, "data")); q.hasClass(u, "name") ? this.currentValLabel = "" === this._dijit.displayedValue ? z === this.customValue ? this.customValue : this.isNumberField ? this._getLocalNumber(z) : z : this.isNumberField ? this._getLocalNumber(this._dijit.value) : this._dijit.value : this.currentValLabel = "" === this._dijit.displayedValue ? z === this.customLabel ? this.customLabel : z : this._dijit.displayedValue;
                                                                                                                if (q.hasClass(u, "name") && "NaN" !== this.newLabel && this.newLabel !== this.customValue && this._getNodeText(u.nextSibling) === this.customLabel) { var x = this.isNumberField ? this.currentValLabel : this.newLabel; q.setAttr(u.nextSibling, "data", encodeURIComponent(x)); this._setNodeText(u.nextSibling, x); q.setAttr(u.nextSibling, "title", x) } x = q.hasClass(u, "name") ? "" === this._dijit.displayedValue ? z === this.customValue ? this.customValue : z : this._dijit.value : this.newLabel; q.setAttr(u, "data", encodeURIComponent(x)); x = q.hasClass(u,
                                                                                                                        "name") ? this.currentValLabel : this.newLabel; this._setNodeText(u, x); q.setAttr(u, "title", x); this._dijit = null; this.isSearch = !1
                                                                                                        }
                                                                                                }), 300); this.placeHolder = ""
                                                                                }
                                                                        })); q.setStyle(this._dijit.domNode, "width", "100%"); this._dijit.placeAt(a); k("input", this._dijit.domNode)[1].focus(); this.searchBtn && (this.own(w(this.searchBtn, "click", E.hitch(this, function (B) { this.isSearch || (this.isSearch = !0, this.searchTarget = B.target || B.srcElement, this.emit("editTable_openListSelectByName", this.newLabel), B.stopPropagation(), B.preventDefault()) }))),
                                                                                this.codedValues && this.searchBtn.click())
                                                        }
                                                }, _getLocalNumber: function (a) { "string" === typeof a && (a = parseFloat(a)); this.emit("editTable_getValLabelsArrayForNumber", !0, [a]); return this.currentValLabel }, _setNewLabel: function (a, f) {
                                                        if (void 0 === a && void 0 === f) if ("" !== this._dijit.displayedValue) this.codedValues ? (f = this._dijit.displayedValue, a = this._getCodeFromCodevalueLabel(f)) : (f = a = this._dijit.value, this.isNumberField && this.newLabel !== this.customValue && (f = this._getLocalNumber(a))); else if (a = f = this.customValue,
                                                                this.updateInputDiv && this.updateInputDiv.parentNode) { var h = this.updateInputDiv.parentNode; h = decodeURIComponent(q.getAttr(h, "data")); h !== this.customValue && (a = this.isNumberField ? parseFloat(h) : h, f = this.codedValues ? this._getLabelFromCodevalue(a) : this.isNumberField ? this._getLocalNumber(a) : a) } this.updateInputDiv && this.updateInputDiv.parentNode && (h = this.updateInputDiv.parentNode, f !== this.customValue && this._getNodeText(h.nextSibling) === this.customLabel && (q.setAttr(h.nextSibling, "data", encodeURIComponent(f)),
                                                                        this._setNodeText(h.nextSibling, f), q.setAttr(h.nextSibling, "title", f)), this.codedValues || (a = a ? a : decodeURIComponent(q.getAttr(h, "data"))), q.setAttr(h, "data", encodeURIComponent(a)), a = h.parentNode, f !== this.customValue && q.removeClass(a, "custom"), this._setNodeText(h, f), q.setAttr(h, "title", f)); this._dijit = this.updateInputDiv = null
                                                }, _onListContentClicked: function (a) {
                                                        a = a.target || a.srcElement; var f = e.getAncestorDom(a, function (h) { return q.hasClass(h, "item") }, 3); f && (q.hasClass(a, "checkboxEmpty") ? q.hasClass(a,
                                                                "checked") ? q.removeClass(a, "checked") : q.addClass(a, "checked") : q.hasClass(a, this.inputType) ? ("radio" === this.inputType && !0 === this.currentItem && (this.currentItem = this.getCurrentItem()), q.hasClass(a, "checked") ? "radio" !== this.inputType ? q.removeClass(a, "checked") : q.hasClass(this.currentItem, "checked") || q.removeClass(a, "checked") : ("radio" === this.inputType && this.currentItem && q.removeClass(this.currentItem, "checked"), q.addClass(a, "checked"), this.currentItem = a)) : q.hasClass(a, "action") && (q.hasClass(a, "up") ?
                                                                        f.previousElementSibling && q.place(f, f.previousElementSibling, "before") : q.hasClass(a, "down") ? f.nextElementSibling && q.place(f, f.nextElementSibling, "after") : q.hasClass(a, "delete") && (q.destroy(f), this.emit("editTable_itemChanged"))))
                                                }, _getLabelFromCodevalue: function (a) { for (var f = a, h = 0; h < this.codedValues.length; h++) { var p = this.codedValues[h]; if (p.value === a) { f = p.label; break } } return f }, _getCodeFromCodevalueLabel: function (a) {
                                                        for (var f = a, h = 0; h < this.codedValues.length; h++) {
                                                                var p = this.codedValues[h]; if (p.label ===
                                                                        a) { f = p.value; break }
                                                        } return f
                                                }, _createEmptyTarget: function (a) {
                                                        for (var f = this.emptyStr, h = this.emptyLabel ? this.emptyLabel : f, p = " checked", B = 0; B < a.length; B++)if (a[B].isChecked) { p = ""; break } " checked" === p && (this.currentItem = !0); B = 'data\x3d"' + encodeURIComponent(f) + '"'; var t = "", u = this.Nls.emptyValueTips; if (0 === a.length || this.enableEmpty) t = " checked"; return q.create("div", {
                                                                "class": "item empty", innerHTML: '\x3cdiv class\x3d"label name jimu-ellipsis" style\x3d"cursor: default;"' + B + "\x3e" + f + '\x3c/div\x3e\x3cdiv class\x3d"label alias jimu-ellipsis-Blanks" data\x3d"' +
                                                                        h + '"\x3e' + h + '\x3c/div\x3e\x3cdiv class\x3d"label ' + this.inputType + p + ' jimu-ellipsis"\x3e\x3c/div\x3e\x3cdiv class\x3d"label checkbox checkboxEmpty' + t + ' jimu-ellipsis jimu-flipx" title\x3d"' + u + '"\x3e\x3c/div\x3e'
                                                        }, this.listContent)
                                                }, _createTarget: function (a, f, h, p, B) {
                                                        var t = "item"; B && (a = f = this.customValue, h = this.customLabel, t = "item custom"); a = a || 0 === a ? a : ""; f = f || ""; h = h ? h : a; p = p ? p : ""; var u = a; (this.codedValues || this.isNumberField) && a !== this.Nls.addValuePlaceHolder && (u = this.codedValues ? this._getLabelFromCodevalue(a) :
                                                                f); f = this.isNumberField ? a : encodeURIComponent(a); p = q.create("div", { "class": t, innerHTML: '\x3cdiv class\x3d"label name jimu-ellipsis-Blanks" data\x3d"' + (f + '"\x3e') + u + '\x3c/div\x3e\x3cdiv class\x3d"label alias jimu-ellipsis-Blanks" data\x3d"' + h + '"\x3e' + h + '\x3c/div\x3e\x3cdiv class\x3d"label ' + this.inputType + p + ' jimu-ellipsis"\x3e\x3c/div\x3e\x3cdiv class\x3d"actions jimu-float-trailing"\x3e\x3cdiv class\x3d"delete action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"down action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"up action jimu-float-trailing"\x3e\x3c/div\x3e\x3c/div\x3e' },
                                                                        this.listContent); B && (B = k(".name", p)[0], q.setAttr(B, "title", a), q.setAttr(B.nextSibling, "title", h)); return p
                                                }, _destroyTarget: function (a) { for (var f = k(".item .name", this.listContent), h = 0; h < f.length; h++) { var p = f[h]; if (v.get(this._dijit.domNode.parentNode, "innerHTML") === a) { q.destroy(p.parentNode); break } } }, getCurrentItem: function () { for (var a = k(".item .radio", this.listContent), f = 0; f < a.length; f++) { var h = a[f]; if (q.hasClass(h, "checked")) return h } return null }, _getEmptyLabel: function () {
                                                        var a = k(".label.alias",
                                                                this.listContent.firstChild)[0], f = this._getNodeText(a); a.children.length && (f = "Error" === this._dijit.state ? decodeURIComponent(q.getAttr(a, "data")) : this._dijit.value); return f = e.sanitizeHTML(f)
                                                }, _getEmptyStatus: function () { var a = k(".checkboxEmpty", this.listContent.firstChild)[0]; return q.hasClass(a, "checked") ? !0 : !1 }, _getNodeText: function (a) { return a.textContent || a.innerText || "" }, _setNodeText: function (a, f) { a.innerHTML = "\x26nbsp;"; a.textContent ? a.textContent = f : a.innerText = f }, getListValues: function () {
                                                        this.listItemsArray =
                                                        []; this.listValuesArray = []; for (var a = k(".item .name", this.listContent), f = "radio" === this.inputType ? 1 : 0; f < a.length; f++) {
                                                                var h = a[f], p = e.getAncestorDom(h, function (t) { return q.hasClass(t, "item") }, 3); if (!q.hasClass(p, "custom")) {
                                                                        p = this._getNodeText(h); var B = decodeURIComponent(q.getAttr(h, "data")); if (this.isNumberField || this.codedValues) p = B; h.children.length && (p = "Error" === this._dijit.state ? B : this._dijit.value, this.codedValues && (p = this._getCodeFromCodevalueLabel(p), p = void 0 !== p ? p : B)); p = this.isNumberField ?
                                                                                parseFloat(p) : e.sanitizeHTML(p); B = this._getNodeText(h.nextSibling); B === this.customLabel && (B = p.toString(), this.isNumberField && (B = this._getLocalNumber(B))); h.nextSibling.children.length && (B = "Error" === this._dijit.state ? decodeURIComponent(q.getAttr(h.nextSibling, "data")) : this._dijit.value); B = e.sanitizeHTML(B); B = { value: p, alias: B, isChecked: !1 }; this.listItemsArray.push(B); this.listValuesArray.push(p); q.hasClass(h.nextSibling.nextSibling, "checked") && (B.isChecked = !0)
                                                                }
                                                        } a = { list: this.listItemsArray, valueList: this.listValuesArray };
                                                        "radio" === this.inputType && (a.emptyLabel = this._getEmptyLabel(), a.enableEmpty = this._getEmptyStatus()); return a
                                                }, setListValues: function (a, f) {
                                                        v.set(this.listContent, "innerHTML", ""); "radio" === this.inputType && this._createEmptyTarget(a); for (var h = 0; h < a.length; h++) { var p = a[h], B = ""; p.isChecked && (B = " checked", this.currentItem = !0); this._createTarget(p.value, f ? f[h].label : p.value, p.alias, B) } a = k(".name", this.listContent); for (f = 0; f < a.length; f++)h = a[f], q.setAttr(h, "title", this._getNodeText(h)), h = h.nextSibling, q.setAttr(h,
                                                                "title", this._getNodeText(h))
                                                }, _initTable: function () { }, getDijits: function () { return [this.mutiValuesSelect] }, destroy: function () { this.inherited(arguments) }
                                        })
                                })
                }, "dojox/form/CheckedMultiSelect": function () {
                        define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/event dojo/dom-geometry dojo/dom-class dojo/dom-construct dojo/i18n dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/Menu dijit/MenuItem dijit/Tooltip dijit/form/_FormSelectWidget dijit/form/ComboButton dojo/text!dojox/form/resources/_CheckedMultiSelectMenuItem.html dojo/text!dojox/form/resources/_CheckedMultiSelectItem.html dojo/text!dojox/form/resources/CheckedMultiSelect.html dojo/i18n!dojox/form/nls/CheckedMultiSelect dijit/form/CheckBox".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t) {
                                        var u = E("dojox.form._CheckedMultiSelectItem", [k, n, d], {
                                                templateString: p, baseClass: "dojoxMultiSelectItem", option: null, parent: null, disabled: !1, readOnly: !1, postMixInProperties: function () {
                                                        this._type = this.parent.multiple ? { type: "checkbox", baseClass: "dijitCheckBox" } : { type: "radio", baseClass: "dijitRadio" }; this.disabled || (this.disabled = this.option.disabled = this.option.disabled || !1); this.readOnly || (this.readOnly = this.option.readOnly = this.option.readOnly || !1);
                                                        this.inherited(arguments)
                                                }, postCreate: function () { this.inherited(arguments); this.labelNode.innerHTML = this.option.label }, _changeBox: function () { this.get("disabled") || this.get("readOnly") || (this.parent.multiple ? this.option.selected = this.checkBox.get("value") && !0 : this.parent.set("value", this.option.value), this.parent._updateSelection(), this.parent.focus()) }, _onClick: function (y) { this.get("disabled") || this.get("readOnly") ? w.stop(y) : this.checkBox._onClick(y) }, _updateBox: function () {
                                                        this.checkBox.set("value",
                                                                this.option.selected)
                                                }, _setDisabledAttr: function (y) { this.disabled = y || this.option.disabled; this.checkBox.set("disabled", this.disabled); v.toggle(this.domNode, "dojoxMultiSelectDisabled", this.disabled) }, _setReadOnlyAttr: function (y) { this.checkBox.set("readOnly", y); this.readOnly = y }
                                        }), z = E("dojox.form._CheckedMultiSelectMenu", g, {
                                                multiple: !1, buildRendering: function () {
                                                        this.inherited(arguments); var y = this.menuTableNode = this.domNode, D = this.domNode = r.create("div", { style: { overflowX: "hidden", overflowY: "scroll" } });
                                                        y.parentNode && y.parentNode.replaceChild(D, y); v.remove(y, "dijitMenuTable"); D.className = y.className + " dojoxCheckedMultiSelectMenu"; y.className = "dijitReset dijitMenuTable"; y.setAttribute("role", "listbox"); D.setAttribute("role", "presentation"); D.appendChild(y)
                                                }, resize: function (y) { y && (m.setMarginBox(this.domNode, y), "w" in y && (this.menuTableNode.style.width = "100%")) }, onClose: function () { this.inherited(arguments); this.menuTableNode && (this.menuTableNode.style.width = "") }, onItemClick: function (y, D) {
                                                        "undefined" ==
                                                        typeof this.isShowingNow && this._markActive(); this.focusChild(y); if (y.disabled || y.readOnly) return !1; if (!this.multiple) this.onExecute(); y.onClick(D)
                                                }
                                        }), x = E("dojox.form._CheckedMultiSelectMenuItem", b, {
                                                templateString: h, option: null, parent: null, iconClass: "", postMixInProperties: function () {
                                                        this.parent.multiple ? (this._iconClass = "dojoxCheckedMultiSelectMenuCheckBoxItemIcon", this._type = { type: "checkbox" }) : (this._iconClass = "", this._type = { type: "hidden" }); this.disabled = this.option.disabled; this.checked = this.option.selected;
                                                        this.label = this.option.label; this.readOnly = this.option.readOnly; this.inherited(arguments)
                                                }, onChange: function (y) { }, _updateBox: function () { v.toggle(this.domNode, "dojoxCheckedMultiSelectMenuItemChecked", !!this.option.selected); this.domNode.setAttribute("aria-checked", this.option.selected); this.inputNode.checked = this.option.selected; this.parent.multiple || v.toggle(this.domNode, "dijitSelectSelectedOption", !!this.option.selected) }, _onClick: function (y) {
                                                        this.disabled || this.readOnly || (this.parent.multiple ? (this.option.selected =
                                                                !this.option.selected, this.parent.onChange(), this.onChange(this.option.selected)) : this.option.selected || (A.forEach(this.parent.getChildren(), function (D) { D.option.selected = !1 }), this.option.selected = !0, this.parent.onChange(), this.onChange(this.option.selected))); this.inherited(arguments)
                                                }
                                        }); return E("dojox.form.CheckedMultiSelect", a, {
                                                templateString: B, baseClass: "dojoxCheckedMultiSelect", required: !1, invalidMessage: "$_unset_$", _message: "", dropDown: !1, labelText: "", tooltipPosition: [], postMixInProperties: function () {
                                                        this.inherited(arguments);
                                                        this._nlsResources = l.getLocalization("dojox.form", "CheckedMultiSelect", this.lang); "$_unset_$" == this.invalidMessage && (this.invalidMessage = this._nlsResources.invalidMessage)
                                                }, _fillContent: function () {
                                                        this.inherited(arguments); if (this.options.length && !this.value && this.srcNodeRef) { var y = this.srcNodeRef.selectedIndex || 0; this.value = this.options[0 <= y ? y : 0].value } this.dropDown && (v.toggle(this.selectNode, "dojoxCheckedMultiSelectHidden"), this.dropDownMenu = new z({
                                                                id: this.id + "_menu", style: "display: none;", multiple: this.multiple,
                                                                onChange: q.hitch(this, "_updateSelection")
                                                        }))
                                                }, startup: function () { this.dropDown && (this.dropDownButton = new f({ label: this.labelText, dropDown: this.dropDownMenu, baseClass: "dojoxCheckedMultiSelectButton", maxHeight: this.maxHeight }, this.comboButtonNode)); this.inherited(arguments) }, _onMouseDown: function (y) { y.preventDefault() }, validator: function () { return this.required ? A.some(this.getOptions(), function (y) { return y.selected && null != y.value && 0 != y.value.toString().length }) : !0 }, validate: function (y) {
                                                        e.hide(this.domNode);
                                                        (y = this.isValid(y)) || this.displayMessage(this.invalidMessage); return y
                                                }, isValid: function (y) { return this.validator() }, getErrorMessage: function (y) { return this.invalidMessage }, displayMessage: function (y) { e.hide(this.domNode); y && e.show(y, this.domNode, this.tooltipPosition) }, onAfterAddOptionItem: function (y, D) { }, _addOptionItem: function (y) {
                                                        if (this.dropDown) { var D = new x({ option: y, parent: this.dropDownMenu }); this.dropDownMenu.addChild(D) } else D = new u({ option: y, parent: this, disabled: this.disabled, readOnly: this.readOnly }),
                                                                this.wrapperDiv.appendChild(D.domNode); this.onAfterAddOptionItem(D, y)
                                                }, _refreshState: function () { this.validate(this.focused) }, onChange: function (y) { this._refreshState() }, reset: function () { this.inherited(arguments); e.hide(this.domNode) }, _updateSelection: function () {
                                                        this.inherited(arguments); this._handleOnChange(this.value); A.forEach(this._getChildren(), function (I) { I._updateBox() }); r.empty(this.containerNode); var y = this; A.forEach(this.value, function (I) {
                                                                I = r.create("option", { value: I, label: I, selected: "selected" });
                                                                r.place(I, y.containerNode)
                                                        }); if (this.dropDown && this.dropDownButton) { var D = 0, H = ""; A.forEach(this.options, function (I) { I.selected && (D++, H = I.label) }); this.dropDownButton.set("label", this.multiple ? q.replace(this._nlsResources.multiSelectLabelText, { num: D }) : H) }
                                                }, _getChildren: function () { return this.dropDown ? this.dropDownMenu.getChildren() : A.map(this.wrapperDiv.childNodes, function (y) { return c.byNode(y) }) }, invertSelection: function (y) {
                                                        this.multiple && (A.forEach(this.options, function (D) { D.selected = !D.selected }),
                                                                this._updateSelection())
                                                }, _setDisabledAttr: function (y) { this.inherited(arguments); this.dropDown && this.dropDownButton.set("disabled", y); A.forEach(this._getChildren(), function (D) { D && D.set && D.set("disabled", y) }) }, _setReadOnlyAttr: function (y) { this.inherited(arguments); "readOnly" in this.attributeMap && this[this.attributeMap.readOnly].setAttribute("readonly", y); this.readOnly = y; A.forEach(this._getChildren(), function (D) { D && D.set && D.set("readOnly", y) }) }, uninitialize: function () {
                                                        e.hide(this.domNode); A.forEach(this._getChildren(),
                                                                function (y) { y.destroyRecursive() }); this.inherited(arguments)
                                                }
                                        })
                                })
                }, "dijit/Menu": function () {
                        define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a) {
                                d("dijit-legacy-requires") && a(0, function () { E(["dijit/MenuItem", "dijit/PopupMenuItem", "dijit/CheckedMenuItem", "dijit/MenuSeparator"]) }); return A("dijit.Menu",
                                        e, {
                                                constructor: function () { this._bindings = [] }, targetNodeIds: [], selector: "", contextMenuForWindow: !1, leftClickToOpen: !1, refocus: !0, postCreate: function () { this.contextMenuForWindow ? this.bindDomNode(this.ownerDocumentBody) : q.forEach(this.targetNodeIds, this.bindDomNode, this); this.inherited(arguments) }, _iframeContentWindow: function (f) { return g.get(this._iframeContentDocument(f)) || this._iframeContentDocument(f).__parent__ || f.name && document.frames[f.name] || null }, _iframeContentDocument: function (f) {
                                                        return f.contentDocument ||
                                                                f.contentWindow && f.contentWindow.document || f.name && document.frames[f.name] && document.frames[f.name].document || null
                                                }, bindDomNode: function (f) {
                                                        f = w.byId(f, this.ownerDocument); if ("iframe" == f.tagName.toLowerCase()) { var h = f; var p = this._iframeContentWindow(h); p = c.body(p.document) } else p = f == c.body(this.ownerDocument) ? this.ownerDocument.documentElement : f; var B = { node: f, iframe: h }; m.set(f, "_dijitMenu" + this.id, this._bindings.push(B)); var t = k.hitch(this, function (u) {
                                                                var z = this.selector, x = z ? function (D) {
                                                                        return n.selector(z,
                                                                                D)
                                                                } : function (D) { return D }, y = this; return [n(u, x(this.leftClickToOpen ? "click" : "contextmenu"), function (D) { D.stopPropagation(); D.preventDefault(); (new Date).getTime() < y._lastKeyDown + 500 || y._scheduleOpen(this, h, { x: D.pageX, y: D.pageY }, D.target) }), n(u, x("keydown"), function (D) { if (93 == D.keyCode || D.shiftKey && D.keyCode == l.F10 || y.leftClickToOpen && D.keyCode == l.SPACE) D.stopPropagation(), D.preventDefault(), y._scheduleOpen(this, h, null, D.target), y._lastKeyDown = (new Date).getTime() })]
                                                        }); B.connects = p ? t(p) : []; h && (B.onloadHandler =
                                                                k.hitch(this, function () { var u = this._iframeContentWindow(h); u = c.body(u.document); B.connects = t(u) }), h.addEventListener ? h.addEventListener("load", B.onloadHandler, !1) : h.attachEvent("onload", B.onloadHandler))
                                                }, unBindDomNode: function (f) {
                                                        try { var h = w.byId(f, this.ownerDocument) } catch (u) { return } f = "_dijitMenu" + this.id; if (h && m.has(h, f)) {
                                                                for (var p = m.get(h, f) - 1, B = this._bindings[p], t; t = B.connects.pop();)t.remove(); (t = B.iframe) && (t.removeEventListener ? t.removeEventListener("load", B.onloadHandler, !1) : t.detachEvent("onload",
                                                                        B.onloadHandler)); m.remove(h, f); delete this._bindings[p]
                                                        }
                                                }, _scheduleOpen: function (f, h, p, B) { this._openTimer || (this._openTimer = this.defer(function () { delete this._openTimer; this._openMyself({ target: B, delegatedTarget: f, iframe: h, coords: p }) }, 1)) }, _openMyself: function (f) {
                                                        function h() { D.refocus && H && H.focus(); b.close(D) } var p = f.target, B = f.iframe, t = f.coords, u = !t; this.currentTarget = f.delegatedTarget; if (t) {
                                                                if (B) {
                                                                        f = v.position(B, !0); p = this._iframeContentWindow(B); p = v.docScroll(p.document); var z = r.getComputedStyle(B),
                                                                                x = r.toPixelValue, y = (d("ie") && d("quirks") ? 0 : x(B, z.paddingLeft)) + (d("ie") && d("quirks") ? x(B, z.borderLeftWidth) : 0); B = (d("ie") && d("quirks") ? 0 : x(B, z.paddingTop)) + (d("ie") && d("quirks") ? x(B, z.borderTopWidth) : 0); t.x += f.x + y - p.x; t.y += f.y + B - p.y
                                                                }
                                                        } else t = v.position(p, !0), t.x += 10, t.y += 10; var D = this; B = this._focusManager.get("prevNode"); f = this._focusManager.get("curNode"); var H = !f || w.isDescendant(f, this.domNode) ? B : f; b.open({ popup: this, x: t.x, y: t.y, onExecute: h, onCancel: h, orient: this.isLeftToRight() ? "L" : "R" }); this.focus();
                                                        u || this.defer(function () { this._cleanUp(!0) }); this._onBlur = function () { this.inherited("_onBlur", arguments); b.close(this) }
                                                }, destroy: function () { q.forEach(this._bindings, function (f) { f && this.unBindDomNode(f.node) }, this); this.inherited(arguments) }
                                })
                        })
                }, "dijit/form/CheckBox": function () {
                        define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                w("dijit-legacy-requires") &&
                                v(0, function () { E(["dijit/form/RadioButton"]) }); return q("dijit.form.CheckBox", [r, l], {
                                        templateString: k, baseClass: "dijitCheckBox", _setValueAttr: function (n, d) { "string" == typeof n && (this.inherited(arguments), n = !0); this._created && this.set("checked", n, d) }, _getValueAttr: function () { return this.checked && this._get("value") }, _setIconClassAttr: null, _setNameAttr: "focusNode", postMixInProperties: function () { this.inherited(arguments); this.checkedAttrSetting = "" }, _fillContent: function () { }, _onFocus: function () {
                                                this.id &&
                                                m("label[for\x3d'" + this.id + "']").addClass("dijitFocusedLabel"); this.inherited(arguments)
                                        }, _onBlur: function () { this.id && m("label[for\x3d'" + this.id + "']").removeClass("dijitFocusedLabel"); this.inherited(arguments) }
                                })
                        })
                }, "dijit/form/_CheckBoxMixin": function () {
                        define(["dojo/_base/declare", "dojo/dom-attr"], function (E, q) {
                                return E("dijit.form._CheckBoxMixin", null, {
                                        type: "checkbox", value: "on", readOnly: !1, _aria_attr: "aria-checked", _setReadOnlyAttr: function (A) {
                                                this._set("readOnly", A); q.set(this.focusNode, "readOnly",
                                                        A)
                                        }, _setLabelAttr: void 0, _getSubmitValue: function (A) { return null == A || "" === A ? "on" : A }, _setValueAttr: function (A) { A = this._getSubmitValue(A); this._set("value", A); q.set(this.focusNode, "value", A) }, reset: function () { this.inherited(arguments); this._set("value", this._getSubmitValue(this.params.value)); q.set(this.focusNode, "value", this.value) }, _onClick: function (A) { return this.readOnly ? (A.stopPropagation(), A.preventDefault(), !1) : this.inherited(arguments) }
                                })
                        })
                }, "jimu/dijit/_filter/NumberListValueProvider": function () {
                        define("dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./NumberListValueProvider.html dijit/form/NumberTextBox dijit/form/Select".split(" "),
                                function (E, q, A, w, m, v, r, l) {
                                        return w([m, v, r], {
                                                templateString: l, postCreate: function () { this.inherited(arguments); q.addClass(this.domNode, "jimu-number-list-filter-value-provider"); this.rangeSelect.removeOption(this.rangeSelect.getOptions()); A.forEach("dateOperatorMinutes dateOperatorHours dateOperatorDays dateOperatorWeeks dateOperatorMonths dateOperatorYears".split(" "), E.hitch(this, function (k) { this.rangeSelect.addOption({ value: k, label: this.nls[k] }) })); this.rangeSelect.set("value", "dateOperatorDays") },
                                                getDijits: function () { return [this._dijit1, this.rangeSelect] }, setValueObject: function (k) { this.isDefined(k.value) && this._dijit1.set("value", k.value); this.isDefined(k.range) && this.rangeSelect.set("value", k.range) }, getValueObject: function () { return this.isValidValue() ? { isValid: !0, type: this.partObj.valueObj.type, value: parseFloat(this._dijit1.get("value")), range: this._getRangeByUI() } : null }, _getRangeByUI: function () { var k = this.rangeSelect.get("value"); "none" === k && (k = null); return k }, tryGetValueObject: function () {
                                                        if (this.isValidValue()) return this.getValueObject();
                                                        if (this.isEmptyValue()) { var k = { isValid: !0, type: this.partObj.valueObj.type, value: parseFloat(this._dijit1.get("value")), range: this._getRangeByUI() }; isNaN(k.value) && (k.value = null); return k } return null
                                                }, setRequired: function (k) { this._dijit1.set("required", k); this.rangeSelect.set("required", k) }
                                        })
                                })
                }, "jimu/dijit/_filter/DateIsInValueProvider": function () {
                        define("dojo/Evented dojo/_base/html dojo/_base/lang dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/text!./DateIsInValueProvider.html ./ValueProvider jimu/filterUtils jimu/utils dijit/form/Select dijit/form/DateTextBox".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        return w([r, m, E], {
                                                templateString: v, postMixInProperties: function () { this.inherited(arguments); this.nls = window.jimuNls.filterBuilder }, virtualDates: null, postCreate: function () { this.inherited(arguments); q.addClass(this.domNode, "jimu-date-is-in-value-provider"); this.dateTypeSelect.addOption({ value: "", label: "\x26nbsp;" }); return ["thisWeek", "thisMonth", "thisQuarter", "thisYear"].forEach(A.hitch(this, function (n) { this.dateTypeSelect.addOption({ value: n, label: this.nls[n] }) })) }, getDijits: function () { return [this.dateTypeSelect] },
                                                _setValueObject: function (n, d, c, g) { if (this.isDefined(d[c])) { var b = { value: null, virtualDate: "" }; b.value = d[c]; b.virtualDate = d[g]; n.setValueObject(b) } }, setValueObject: function (n) { this.dateTypeSelect.set("value", n.virtualDate) }, getValueObject: function () { return this.isValidValue() ? this.tryGetValueObject() : null }, tryGetValueObject: function () {
                                                        if (this.isInvalidValue()) return null; var n = { isValid: !0, type: this.partObj.valueObj.type, value: null, virtualDate: this.dateTypeSelect.get("value") }, d = this.dateTypeSelect.get("value"),
                                                                c = l.getRealDateByVirtualDate(d); n.virtualDate = d; c && (n.value1 = k.getDateTimeStr(c[0]), n.value2 = k.getDateTimeStr(c[1])); return n
                                                }, setRequired: function (n) { this.dateTypeSelect.set("required", n) }, getStatus: function () { return this.dateTypeSelect.get("value") ? 1 : 0 }, _onDateTypeSelectChanged: function () { this.emit("change") }
                                        })
                                })
                }, "dijit/form/DateTextBox": function () {
                        define(["dojo/_base/declare", "../Calendar", "./_DateTimeTextBox"], function (E, q, A) {
                                return E("dijit.form.DateTextBox", A, {
                                        baseClass: "dijitTextBox dijitComboBox dijitDateTextBox",
                                        popupClass: q, _selector: "date", maxHeight: Infinity, value: new Date("")
                                })
                        })
                }, "jimu/dijit/_SingleFilter": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/keys dijit/a11yclick dijit/focus dojo/query dojo/store/Memory jimu/utils jimu/filterUtils dijit/Tooltip dojo/mouse jimu/dijit/_filter/ValueProviderFactory dijit/popup jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f, h, p, B, t) {
                                        return q([A, w, m, E], {
                                                templateString: v, baseClass: "jimu-single-filter", declaredClass: "jimu.dijit._SingleFilter", nls: null, url: null, layerInfo: null, popupFieldsInfo: [], stringFieldType: "", dateFieldType: "", numberFieldTypes: [], supportFieldTypes: [], part: null, OPERATORS: null, enableAskForValues: !1, isHosted: !1, valueProviderFactory: null, valueProvider: null, dateOptionsObj: { status: !1 }, allDates: [f.VIRTUAL_DATE_CUSTOM, f.VIRTUAL_DATE_TODAY, f.VIRTUAL_DATE_YESTERDAY, f.VIRTUAL_DATE_TOMORROW],
                                                runtime: !1, widgetId: "", postMixInProperties: function () { this.supportFieldTypes = []; this.supportFieldTypes.push(this.stringFieldType); this.supportFieldTypes.push(this.dateFieldType); this.supportFieldTypes = this.supportFieldTypes.concat(this.numberFieldTypes); this.nls = window.jimuNls.filterBuilder; this.nls.deleteText = window.jimuNls.common.deleteText }, postCreate: function () {
                                                        this.inherited(arguments); this._initSelf(); this.own(n(this.valueTypeSetNode, c, r.hitch(this, this._onValueTypeSetClick))); this.own(n(this.btnDelete,
                                                                c, r.hitch(this, function () { this._destroySelf() }))); this.own(n(document, "click", r.hitch(this, function (u) { u = u.target; l.isDescendant(u, this.valueTypePopupNode) && !l.hasClass(u, "value-type-popup-icon") || this._closeEsriPopup() }))); this.customDijit && this.own(n(window, "resize", r.hitch(this, function () { this._closeEsriPopup() })))
                                                }, toJson: function () {
                                                        var u = { fieldObj: "", operator: "", valueObj: "", interactiveObj: "", caseSensitive: !1 }, z = this._getFieldObjByUI(); if (!z) return null; u.fieldObj = z; z = this._getOperatorByUI();
                                                        if (!z) return null; u.operator = z; u.caseSensitive = this.cbxCaseSensitive.getStatus() && this.cbxCaseSensitive.getValue(); z = this._getValueTypeByUI(); var x = this._isUseAskForValues(); if (x) {
                                                                if (!this.promptTB.validate()) return this._showValidationErrorTip(this.promptTB), null; u.interactiveObj = { prompt: a.sanitizeHTML(this.promptTB.get("value")), hint: a.sanitizeHTML(this.hintTB.get("value")), cascade: "none" }; this.dateOptionsObj.status && (1 === this.dateOptionsObj.num ? u.interactiveObj.virtualDates = this._getRelativeDatesByUI("start") :
                                                                        (u.interactiveObj.virtualDates1 = this._getRelativeDatesByUI("start"), u.interactiveObj.virtualDates2 = this._getRelativeDatesByUI("end"))); if ("unique" === z || "multiple" === z) u.interactiveObj.cascade = this.cascadeSelect.get("value")
                                                        } u.valueObj = { isValid: !0, type: "" }; x = x ? this.valueProvider.tryGetValueObject() : this.valueProvider.getValueObject(); if (!x) return null; x.type = z; u.valueObj = x; return u
                                                }, _getRelativeDatesByUI: function (u) {
                                                        var z = []; k.forEach(this.allDates, function (x) { this[x + "_" + u + "_date"].checked && z.push(x) },
                                                                this); return z
                                                }, _removeRelativeDateChangeEvents: function () { k.forEach(this.allDates, function (u) { var z = this[u + "_start_date"]; z.changeEvent && z.changeEvent.remove(); 2 === this.dateOptionsObj.num && (u = this[u + "_end_date"], u.changeEvent && u.changeEvent.remove()) }, this) }, _getFieldObjByUI: function () {
                                                        var u = this._getSelectedFilteringItem(this.fieldsSelect); if (!u) return null; var z = ""; 0 !== this.popupFieldsInfo.length && (z = a.getDateFieldFormatByFieldName(this.popupFieldsInfo, u.name)); return {
                                                                name: u.name, label: u.name,
                                                                dateFormat: z, shortType: u.shortType, type: u.type
                                                        }
                                                }, _getOperatorByUI: function () { var u = this.operatorsSelect.get("value"); "none" === u && (u = null); return u }, showDelteIcon: function () { l.setStyle(this.btnDelete, "display", "inline-block") }, hideDeleteIcon: function () { l.setStyle(this.btnDelete, "display", "none") }, _showCaseSensitive: function () { l.setStyle(this.cbxCaseSensitive.domNode, "display", "inline-block") }, _hideCaseSensitive: function () { l.setStyle(this.cbxCaseSensitive.domNode, "display", "none") }, _showAndEnableCaseSensitive: function () {
                                                        this.cbxCaseSensitive.setStatus(!0);
                                                        this._showCaseSensitive()
                                                }, _hideAndDisableCaseSensitive: function () { this.cbxCaseSensitive.setStatus(!1); this._hideCaseSensitive() }, _initSelf: function () {
                                                        this.isHosted && (this.cbxCaseSensitive.setValue(!1), this.cbxCaseSensitive.setStatus(!1), this.cbxCaseSensitive.domNode.title = this.nls.notSupportCaseSensitiveTip); this.own(n(this.fieldsSelect, "MouseEnter", r.hitch(this, this._updateFieldsSelectTitle))); this.own(n(this.operatorsSelect, "MouseEnter", r.hitch(this, this._updateOperatorsSelectTitle))); this.enableAskForValues ?
                                                                (l.setStyle(this.cbxAskValues.domNode, "display", "inline-block"), l.setStyle(this.promptSection, "display", "block"), this.own(n(this.cbxAskValues, "status-change", r.hitch(this, this._onCbxAskValuesStatusChanged))), this.cbxAskValues.onChange = r.hitch(this, this._onCbxAskValuesClicked)) : (l.setStyle(this.cbxAskValues.domNode, "display", "none"), l.setStyle(this.promptSection, "display", "none")); var u = this.layerInfo.fields; u && 0 < u.length && (u = k.filter(u, r.hitch(this, function (z) { return 0 <= this.supportFieldTypes.indexOf(z.type) })),
                                                                        0 < u.length && (this._initValueTypeUI(), this._enableAllValueTypeOptions(), this._initFieldsSelect(u), this.part ? this._showPart(this.part) : this._resetByFieldAndOperator(), setTimeout(r.hitch(this, function () { this._bindFieldsSelectChangeAndOperatorChangeEvents() }), 0)))
                                                }, _bindFieldsSelectChangeAndOperatorChangeEvents: function () {
                                                        this._removeFieldsSelectChangeAndOperatorChangeEvents(); this.fieldsSelect && (this._handle1 = n(this.fieldsSelect, "change", r.hitch(this, this._onFieldsSelectChange))); this.operatorsSelect &&
                                                                (this._handle2 = n(this.operatorsSelect, "change", r.hitch(this, this._onOperatorsSelectChange)))
                                                }, _removeFieldsSelectChangeAndOperatorChangeEvents: function () { this._handle1 && this._handle1.remove(); this._handle2 && this._handle2.remove(); this._handle2 = this._handle1 = null }, _isServiceSupportDistinctValues: function (u, z) { if (this._isStreamServer(u)) return !1; u = z.currentVersion ? z : z.toJson().layerDefinition; return 10.1 <= parseFloat(u.currentVersion) }, _isStreamServer: function (u) { u = (u || "").replace(/\/*$/g, ""); return /\/StreamServer$/gi.test(u) },
                                                _updateFieldsSelectTitle: function () { this.fieldsSelect.domNode.title = ""; var u = this._getSelectedFilteringItem(this.fieldsSelect); u && (this.fieldsSelect.domNode.title = u.displayName || u.alias || u.name) }, _updateOperatorsSelectTitle: function () { this.operatorsSelect.domNode.title = ""; var u = this.operatorsSelect.get("value"); u && (u = this.operatorsSelect.getOptions(u), this.operatorsSelect.domNode.title = u.label, l.setAttr(this.operatorsSelect.domNode, "aria-label", u.label)) }, _showValidationErrorTip: function (u) {
                                                        try {
                                                                !u.validate() &&
                                                                u.domNode && u.focusNode && (u.focusNode.focus(), u.focusNode.blur())
                                                        } catch (z) { console.error(z) }
                                                }, _getSelectedFilteringItem: function (u) { if (u.validate()) { var z = u.get("item"); if (z) return z } this._showValidationErrorTip(u); return null }, _getShortTypeByFieldType: function (u) { return u === this.stringFieldType ? "string" : u === this.dateFieldType ? "date" : 0 <= this.numberFieldTypes.indexOf(u) ? "number" : null }, _initFieldsSelect: function (u) {
                                                        u = k.map(u, r.hitch(this, function (x, y) {
                                                                var D = r.mixin({}, x); D.id = y; D.shortType = this._getShortTypeByFieldType(x.type);
                                                                D.alias || (D.alias = D.name); x = ""; "string" === D.shortType ? x = this.nls.string : "number" === D.shortType ? x = this.nls.number : "date" === D.shortType && (x = this.nls.date); D.displayName = D.alias + " (" + x + ")"; return D
                                                        })); if (0 < u.length) { var z = new e({ data: u }); this.fieldsSelect.set("store", z); this.fieldsSelect.set("value", u[0].id) } setTimeout(r.hitch(this, function () { this.fieldsSelect && this.fieldsSelect.focusNode && this.fieldsSelect.focusNode.focus() }), 2); this._updateOperatorsByFieldsSelect()
                                                }, _showPart: function (u) {
                                                        if ((this.part =
                                                                u) && this.part.fieldObj && this.part.operator && this.part.valueObj) {
                                                                        this._removeFieldsSelectChangeAndOperatorChangeEvents(); var z = this.part.fieldObj.name; u = this.part.operator; this.part.caseSensitive = !!this.part.caseSensitive; z = this.fieldsSelect.store.query({ name: z }); 0 !== z.length && (z = z[0]) && (this.fieldsSelect.set("value", z.id), this._updateOperatorsByFieldsSelect(), this.operatorsSelect.set("value", u), this._resetByFieldAndOperator(this.part), u = this.part.interactiveObj) && (this.cbxAskValues.check(), this._updatePrompt(),
                                                                                this.promptTB.set("value", u.prompt || ""), this.hintTB.set("value", u.hint || ""), "unique" === this.part.valueObj.type || "multiple" === this.part.valueObj.type ? this.cascadeSelect.set("value", u.cascade) : this.cascadeSelect.set("value", "none"))
                                                        }
                                                }, _onFieldsSelectChange: function () { this._updateOperatorsByFieldsSelect(); this._resetByFieldAndOperator() }, _updateOperatorsByFieldsSelect: function () {
                                                        this._updateFieldsSelectTitle(); this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()); this.operatorsSelect.addOption({
                                                                value: "none",
                                                                label: this.nls.none
                                                        }); var u = this._getSelectedFilteringItem(this.fieldsSelect); u && (this.operatorsSelect.shortType = u.shortType, u = B.getOperatorsByShortType(u.shortType, this.isHosted), this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()), k.forEach(u, r.hitch(this, function (z) { this.operatorsSelect.addOption({ value: z, label: this.nls[z] }) })))
                                                }, _onOperatorsSelectChange: function () { this._resetByFieldAndOperator() }, _updateValueTypeClass: function () {
                                                        l.removeClass(this.domNode, "value-type"); l.removeClass(this.domNode,
                                                                "field-type"); l.removeClass(this.domNode, "unique-type"); l.removeClass(this.domNode, "support-cascade"); var u = this._getValueTypeByUI(); if ("value" === u) l.addClass(this.domNode, "value-type"), this.cascadeSelect.set("value", "none"); else if ("field" === u) l.addClass(this.domNode, "field-type"), this.cascadeSelect.set("value", "none"); else {
                                                                        l.addClass(this.domNode, "unique-type"); this.cascadeSelect.set("value", "previous"); var z = !0; z = this._getSelectedFilteringItem(this.fieldsSelect); z = a.getCodedValuesOrTypesCount(z,
                                                                                this.layerInfo); (z = 0 < z ? a.isCodedValuesSupportFilter(this.layerInfo, z) : !0) ? ("uniquePredefined" === u || "multiplePredefined" === u ? this.cascadeSelect.set("value", "none") : this.cascadeSelect.set("value", "previous"), l.addClass(this.domNode, "support-cascade")) : this.cascadeSelect.set("value", "none")
                                                                }
                                                }, _enableValueTypeSelectOption: function (u, z) {
                                                        u = b("li[data-type\x3d" + u + "]", this.valueTypePopupNode)[0]; z ? (l.removeClass(u, "disabled"), l.setAttr(u, "aria-disabled", "false")) : (l.addClass(u, "disabled"), l.setAttr(u, "aria-disabled",
                                                                "true"))
                                                }, _setVisibleValueTypeSelectOption: function (u, z) { u = b("li[data-type\x3d" + u + "]", this.valueTypePopupNode)[0]; z ? l.setStyle(u, "display", "block") : l.setStyle(u, "display", "none") }, _calcValueTypePosition: function (u) {
                                                        u = l.position(u.target); var z = l.position(document.body).w; var x = l.position(document.body).h; var y = l.getStyle(this.valueTypePopupNode, "width"), D = l.getStyle(this.valueTypePopupNode, "height"); x = x - u.y - 16 - 10 >= D ? u.y + 16 + 10 : u.y - D - 10; z = z - u.x >= y ? u.x : u.x + 16 - y; window.isRTL && (z = u.x + 16 >= y ? u.x + 16 - y : u.x);
                                                        return { left: z, top: x }
                                                }, _onValueTypeSetClick: function (u) { t.open({ popup: this.customDijit, around: u.target }); var z = this._calcValueTypePosition(u); t.open({ x: z.left, y: z.top, popup: this.customDijit }); u.stopPropagation(); a.isInNavMode() && g.focus(this.valueTypePopupDelBtn) }, _onValueTypeClick: function (u) {
                                                        var z = l.getAttr(u.currentTarget, "data-type"); l.hasClass(u.currentTarget, "disabled") ? u.stopPropagation() : (b("li", this.valueTypePopupNode).forEach(function (x) { l.removeClass(x, "selected") }), l.addClass(u.currentTarget,
                                                                "selected"), this._resetByFieldAndOperator(null, z), this._closeEsriPopup())
                                                }, _enableValueTypeOption: function (u) { this._enableValueTypeSelectOption("value", u) }, _enableFieldTypeOption: function (u) { this._enableValueTypeSelectOption("field", u) }, _enableUniqueTypeOption: function (u) { this._enableValueTypeSelectOption("unique", u) }, _enableUniquePredefinedTypeOption: function (u) { this.runtime ? this._setVisibleValueTypeSelectOption("uniquePredefined", !1) : this._enableValueTypeSelectOption("uniquePredefined", u) }, _enableValuesTypeOption: function (u) {
                                                        this._enableValueTypeSelectOption("values",
                                                                u)
                                                }, _enableMultipleTypeOption: function (u) { this._enableValueTypeSelectOption("multiple", u) }, _enableMultiplePredefinedTypeOption: function (u) { this.runtime ? this._setVisibleValueTypeSelectOption("multiplePredefined", !1) : this._enableValueTypeSelectOption("multiplePredefined", u) }, _enableAllValueTypeOptions: function () { this._enableValueTypeOption(!0); this._enableFieldTypeOption(!0); this._enableUniqueTypeOption(!0); this._enableUniquePredefinedTypeOption(!0); this._enableMultipleTypeOption(!0); this._enableMultiplePredefinedTypeOption(!0) },
                                                _disableAllValueTypeOptions: function () { this._enableValueTypeOption(!1); this._enableFieldTypeOption(!1); this._enableUniqueTypeOption(!1); this._enableUniquePredefinedTypeOption(!1); this._enableMultipleTypeOption(!1); this._enableMultiplePredefinedTypeOption(!1) }, _resetByFieldAndOperator: function (u, z) {
                                                        this._updateOperatorsSelectTitle(); this.valueProvider && this.valueProvider.destroy(); this._hideCaseSensitive(); this._disableAllValueTypeOptions(); u || (u = {
                                                                fieldObj: "", operator: "", valueObj: "", interactiveObj: "",
                                                                caseSensitive: !1
                                                        }, u.fieldObj = this._getFieldObjByUI(), u.operator = this._getOperatorByUI()); u.widgetId = this.widgetId; var x = [], y = null; u.fieldObj && u.operator && (x = this.valueProviderFactory.getSupportedValueTypes(u.fieldObj.name, u.operator), u.valueObj ? y = u.valueObj.type : (y = z && 0 <= x.indexOf(z) ? z : x[0], u.valueObj = { type: y }), 0 <= x.indexOf("value") && this._enableValueTypeOption(!0), 0 <= x.indexOf("field") && this._enableFieldTypeOption(!0), 0 <= x.indexOf("unique") && this._enableUniqueTypeOption(!0), 0 <= x.indexOf("values") &&
                                                                this._enableValuesTypeOption(!0), 0 <= x.indexOf("uniquePredefined") && this._enableUniquePredefinedTypeOption(!0), 0 <= x.indexOf("multiple") && this._enableMultipleTypeOption(!0), 0 <= x.indexOf("multiplePredefined") && this._enableMultiplePredefinedTypeOption(!0), "value" === y ? (this._enableValueTypeOption(!0), this.dateOptionsObj.status = !1, l.removeClass(this.domNode, "support-relative-start-date"), l.removeClass(this.domNode, "support-relative-end-date"), this._initDateOptionsUI(u)) : "field" === y ? this._enableFieldTypeOption(!0) :
                                                                        "unique" === y ? this._enableUniqueTypeOption(!0) : "values" === y ? this._enableValuesTypeOption(!0) : "uniquePredefined" === y ? this._enableUniquePredefinedTypeOption(!0) : "multiple" === y ? this._enableMultipleTypeOption(!0) : "multiplePredefined" === y && this._enableMultiplePredefinedTypeOption(!0), this._updateValueTypeUI(y)); 0 < x.length ? (this.valueProvider = this.valueProviderFactory.getValueProvider(u, this.runtime), this.valueProvider.placeAt(this.valueProviderContainer), this.valueProvider.setValueObject(u.valueObj), this.own(n(this.valueProvider,
                                                                                "change", r.hitch(this, function (D, H) { D && this.dateOptionsObj.status && this[D + "_" + H + "_date"].setValue(!0); this.emit("change") }))), this.valueProvider.bindChangeEvents(), this.valueProvider.isBlankValueProvider() ? (l.addClass(this.valueProvider.domNode, "hidden"), l.addClass(this.attributeValueContainer, "hidden")) : l.removeClass(this.attributeValueContainer, "hidden"), (z = B.getOperatorInfo(u.operator)) && y && (z[y] && z[y].supportCaseSensitive && this._showCaseSensitive(), u && this.cbxCaseSensitive.setValue(u.caseSensitive))) :
                                                                                l.addClass(this.attributeValueContainer, "hidden"); this._updateWhenValueRadioChanged(); this.emit("change")
                                                }, _initDateOptionsUI: function (u) {
                                                        u.fieldObj.type === this.dateFieldType && (this.dateOptionsObj = B.isSupportVirtualDates(u.operator), this.dateOptionsObj.status && (1 === this.dateOptionsObj.num ? (this._initDateOptions(u.interactiveObj.virtualDates, "start"), this.startDateOptions.innerHTML = this.nls.dateOptions) : (this._initDateOptions(u.interactiveObj.virtualDates1, "start"), this._initDateOptions(u.interactiveObj.virtualDates2,
                                                                "end"), l.addClass(this.domNode, "support-relative-end-date"), this.startDateOptions.innerHTML = this.nls.startDateOptions), l.addClass(this.domNode, "support-relative-start-date")))
                                                }, _initDateOptions: function (u, z) { u || (u = this.allDates); k.forEach(this.allDates, function (x) { var y = this[x + "_" + z + "_date"]; y.changeEvent && y.changeEvent.remove(); y.setValue(0 <= u.indexOf(x)); y.changeEvent = n(y, "change", r.hitch(this, this._onShowTooltipCBXsChange, y, x, z)) }, this) }, _onShowTooltipCBXsChange: function (u, z, x) {
                                                        if (u && !1 === u.checked) {
                                                                var y =
                                                                        ""; if (this._isCurrentDateOptIsSelected(z, x)) y = this.nls.notUncheckedCurrent; else if (this._isDateOptionsAllHide(x)) y = this.nls.atLeastOne; else return; u.check(); h.hide(); h.show(y, u.domNode); this.own(n.once(u.domNode, p.leave, r.hitch(this, function () { h.hide(u.domNode) })))
                                                        }
                                                }, _isDateOptionsAllHide: function (u) { var z = !0; k.some(this.allDates, function (x) { if (!0 === this[x + "_" + u + "_date"].checked) return z = !1, !0 }, this); return z }, _isCurrentDateOptIsSelected: function (u, z) {
                                                        var x = this.valueProvider.getValueObject(); if (x) if ("start" ===
                                                                z) if (1 === this.dateOptionsObj.num) { if (!x.virtualDate && u === f.VIRTUAL_DATE_CUSTOM || x.virtualDate === u) return !0 } else { if (!x.virtualDate1 && u === f.VIRTUAL_DATE_CUSTOM || x.virtualDate1 === u) return !0 } else if (!x.virtualDate2 && u === f.VIRTUAL_DATE_CUSTOM || x.virtualDate2 === u) return !0; return !1
                                                }, _updateWhenValueRadioChanged: function () { this._updatePrompt(!1, !0); this._updateValueTypeClass() }, _onCbxAskValuesClicked: function () { this._updateRequiredProperty(); this._updatePrompt(!0) }, _onCbxAskValuesStatusChanged: function () { this._updateRequiredProperty() },
                                                _isUseAskForValues: function () { var u = this._getValueTypeByUI(); return "uniquePredefined" === u || "multiplePredefined" === u ? !0 : this.cbxAskValues.status && this.cbxAskValues.checked }, _isValueRequired: function () { return !this._isUseAskForValues() }, _updateRequiredProperty: function () { var u = this._isValueRequired(); this.valueProvider.setRequired(u) }, _getValueTypeByUI: function () { var u = b("li.selected", this.valueTypePopupNode)[0]; return u ? l.getAttr(u, "data-type") : null }, _closeEsriPopup: function () { this.customDijit && t.close(this.customDijit) },
                                                _destroyEsriPopup: function () { this.customDijit && (this.customDijit.destroy(), t.close(this.customDijit)) }, _initValueTypeUI: function () {
                                                        if (!this.valueTypePopupNode) {
                                                                this.valueTypePopupNode = document.createElement("DIV"); l.addClass(this.valueTypePopupNode, "value-type-popup"); this.valueTypePopupNode.innerHTML = '\x3cdiv class\x3d"value-type-popup-header"\x3e\x3cspan class\x3d"value-type-popup-title jimu-ellipsis" title\x3d"' + this.nls.setInputType + '"\x3e' + this.nls.setInputType + '\x3c/span\x3e\x3cspan role\x3d"button" tabindex\x3d"0" aria-label\x3d"' +
                                                                        this.nls.deleteText + '" class\x3d"value-type-popup-icon jimu-icon jimu-icon-delete"\x3e\x3c/span\x3e\x3c/div\x3e\x3cul role\x3d"listbox" tabindex\x3d"0"\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"value" title\x3d"' + this.nls.value + '"\x3e\x3cspan\x3e' + this.nls.value + '\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"field" title\x3d"' + this.nls.field + '"\x3e\x3cspan\x3e' + this.nls.field + '\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"unique" title\x3d"' +
                                                                        this.nls.unique + '"\x3e\x3cspan\x3e' + this.nls.unique + '\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"uniquePredefined" title\x3d"' + this.nls.uniquePredefined + '"\x3e\x3cspan\x3e' + this.nls.uniquePredefined + '\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"multiple" title\x3d"' + this.nls.multiple + '"\x3e\x3cspan\x3e' + this.nls.multiple + '\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3cli role\x3d"option" tabindex\x3d"-1" data-type\x3d"multiplePredefined" title\x3d"' +
                                                                        this.nls.multiplePredefined + '"\x3e\x3cspan\x3e' + this.nls.multiplePredefined + "\x3c/span\x3e\x3cspan\x3e\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e"; this.customDijit = new A({ baseClass: "jimu-filter-valueType", domNode: this.valueTypePopupNode }); this.valueTypePopupDelBtn = b(".value-type-popup-icon", this.valueTypePopupNode)[0]; this.own(n(this.valueTypePopupDelBtn, "click", r.hitch(this, function (z) { this._closeEsriPopup(); z.stopPropagation() }))); this.own(n(this.valueTypePopupDelBtn, "keydown", r.hitch(this, function (z) {
                                                                                z.keyCode ===
                                                                                d.ENTER || z.keyCode === d.SPACE || z.keyCode === d.ESCAPE ? (z.stopPropagation(), this._closeEsriPopup(), a.isInNavMode() && g.focus(this.valueTypeSetNode)) : z.shiftKey || z.keyCode !== d.TAB || this.valueTypeList.focus()
                                                                        }))); this.valueTypeList = b("ul", this.valueTypePopupNode)[0]; var u = b("li", this.valueTypePopupNode); this.own(n(this.valueTypeList, "focus", r.hitch(this, function () { this.selectedValueType = b("li.selected", this.valueTypePopupNode)[0]; this.selectedValueType.focus() }))); this.own(n(this.valueTypeList, "keydown",
                                                                                r.hitch(this, function (z) {
                                                                                        if (z.keyCode === d.TAB) z.shiftKey ? (z.preventDefault(), this.valueTypePopupDelBtn.focus()) : (z.preventDefault(), this._closeEsriPopup(), a.isInNavMode() && g.focus(this.valueTypeSetNode)); else {
                                                                                                var x = !1; if (z.keyCode === d.DOWN_ARROW) { var y = this.selectedValueType; for (z = 0; z < u.length - 1; z++)if (x) { if ("none" !== l.getStyle(u[z], "display")) { y = u[z]; break } } else u[z] === this.selectedValueType && (x = !0) } else if (z.keyCode === d.UP_ARROW) for (y = this.selectedValueType, z = u.length - 1; 0 <= z; z--)if (x) {
                                                                                                        if ("none" !==
                                                                                                                l.getStyle(u[z], "display")) { y = u[z]; break }
                                                                                                } else u[z] === this.selectedValueType && (x = !0); else if (z.keyCode === d.HOME) y = u[0]; else if (z.keyCode === d.END) for (z = u.length - 1; 0 <= z; z--)if ("none" !== l.getStyle(u[z], "display")) { y = u[z]; break } y && (this.selectedValueType = y, y.focus())
                                                                                        }
                                                                                }))); this.own(n(u, "click", r.hitch(this, function (z) { this._onValueTypeClick(z) }))); this.own(n(u, "keydown", r.hitch(this, function (z) { z.keyCode === d.ENTER && (this._onValueTypeClick(z), l.hasClass(z.target, "disabled") || this.valueTypeSetNode.focus()) })));
                                                                this.own(n(this.valueTypePopupNode, "keydown", r.hitch(this, function (z) { z.keyCode === d.ESCAPE && (z.stopPropagation(), g.focus(this.valueTypePopupDelBtn)) })))
                                                        }
                                                }, _updateValueTypeUI: function (u) { b("li", this.valueTypePopupNode).forEach(function (z) { l.removeClass(z, "selected") }); if (u = b("li[data-type\x3d" + u + "]", this.valueTypePopupNode)[0]) return l.addClass(u, "selected") }, _updatePrompt: function (u, z) {
                                                        this.promptTB.set("value", ""); this.hintTB.set("value", ""); this.cbxAskValues.setStatus(!0); !u && z && this.cbxAskValues.uncheck(!0);
                                                        l.setStyle(this.promptTable, "display", "table"); z = this.operatorsSelect.get("value"); var x = this.nls[z], y = !1, D = this._getValueTypeByUI(), H = B.getOperatorInfo(z); H && D && (H = H[D]) && H.supportAskForValue && (y = !0); y || (this.cbxAskValues.uncheck(!0), this.cbxAskValues.setStatus(!1)); H = this.cbxAskValues.getValue(); (D = 0 <= ["uniquePredefined", "multiplePredefined"].indexOf(D) ? !0 : !1) ? this.cbxAskValues.check(!0) : u ? H ? this.cbxAskValues.check(!0) : this.cbxAskValues.uncheck(!0) : y ? this.cbxAskValues.status || this.cbxAskValues.check(!0) :
                                                                this.cbxAskValues.uncheck(!0); this.cbxAskValues.status && this.cbxAskValues.checked ? (l.setStyle(this.promptTable, "display", "table"), (u = this._getSelectedFilteringItem(this.fieldsSelect)) && "none" !== z && this.promptTB.set("value", (u.alias || u.name) + " " + x)) : l.setStyle(this.promptTable, "display", "none"); D ? (this.cbxAskValues.setStatus(!1), this.cascadeSelect.setDisabled(!0)) : this.cascadeSelect.setDisabled(!1)
                                                }, _destroySelf: function () { this.destroy() }, destroy: function () {
                                                        this._removeFieldsSelectChangeAndOperatorChangeEvents();
                                                        this.dateOptionsObj.status && this._removeRelativeDateChangeEvents(); this._destroyEsriPopup(); this.inherited(arguments)
                                                }
                                        })
                                })
                }, "jimu/dijit/_FilterSet": function () {
                        define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dijit/a11yclick dojo/aspect dojo/query ./_SingleFilter".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e) {
                                return q([A, w, m,
                                        E], {
                                                templateString: v, baseClass: "jimu-filter-set", nls: null, url: null, layerInfo: null, popupFieldsInfo: [], stringFieldType: "", dateFieldType: "", numberFieldTypes: [], partsObj: null, OPERATORS: null, enableAskForValues: !1, isHosted: !1, valueProviderFactory: null, runtime: !1, widgetId: "", postMixInProperties: function () { this.nls = window.jimuNls.filterBuilder; this.nls.deleteText = window.jimuNls.common.deleteText; this.nls.addText = window.jimuNls.common.add; this.inherited(arguments) }, postCreate: function () {
                                                        this.inherited(arguments);
                                                        this._initSelf()
                                                }, toJson: function () { var a = b(".jimu-single-filter", this.allExpsBox); a = n.map(a, l.hitch(this, function (f) { return r.byNode(f).toJson() })); return n.every(a, l.hitch(this, function (f) { return !!f })) && 0 < a.length ? { logicalOperator: this.allAnySelect.value, parts: a } : null }, showDelteIcon: function () { k.setStyle(this.btnDelete, "display", "block") }, hideDeleteIcon: function () { k.setStyle(this.btnDelete, "display", "none") }, _initSelf: function () {
                                                        this.own(d(this.btnDelete, c, l.hitch(this, function () { this._destroySelf() })));
                                                        this.own(d(this.btnAdd, c, l.hitch(this, function () { this._addSingleFilter(); this.emit("change") }))); if (this.partsObj) { this.allAnySelect.value = this.partsObj.logicalOperator; var a = this.partsObj.parts || []; 0 === a.length ? (this._addSingleFilter(), this._addSingleFilter()) : 1 === a.length ? (this._addSingleFilter(a[0]), this._addSingleFilter()) : n.forEach(a, l.hitch(this, function (f) { this._addSingleFilter(f) })) } else this._addSingleFilter(), this._addSingleFilter(); setTimeout(l.hitch(this, function () { this.allAnySelect.focus() }),
                                                                5)
                                                }, _addSingleFilter: function (a) {
                                                        a = new e({ widgetId: this.widgetId, url: this.url, layerInfo: this.layerInfo, popupFieldsInfo: this.popupFieldsInfo, stringFieldType: this.stringFieldType, dateFieldType: this.dateFieldType, numberFieldTypes: this.numberFieldTypes, part: a, OPERATORS: this.OPERATORS, enableAskForValues: this.enableAskForValues, isHosted: this.isHosted, valueProviderFactory: this.valueProviderFactory, isInFilterSet: !0, runtime: this.runtime }); a.placeAt(this.allExpsBox); a.startup(); this.own(g.after(a, "_destroySelf",
                                                                l.hitch(this, function () { this._checkFilterNumbers(); this.allAnySelect.focus() }))); this.own(d(a, "change", l.hitch(this, function () { this.emit("change") }))); this._checkFilterNumbers(); return a
                                                }, _checkFilterNumbers: function () { var a = b(".jimu-single-filter", this.allExpsBox), f = 2 < a.length; n.forEach(a, l.hitch(this, function (h) { h = r.byNode(h); f ? h.showDelteIcon() : h.hideDeleteIcon() })) }, _destroySelf: function () { this.destroy() }
                                })
                        })
                }, "jimu/dijit/FilterParameters": function () {
                        define("dojo/on dojo/Evented dojo/Deferred dojo/promise/all dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter ./_filter/ValueProviderFactory".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b, e, a, f) {
                                        return m([v, r, l, q], {
                                                baseClass: "jimu-filter-parameters", templateString: '\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e', _filterUtils: null, _spObj: null, nls: null, partsObj: null, layerInfo: null, OPERATORS: null, url: null, featureLayerId: null, widgetId: "", postMixInProperties: function () {
                                                        this.nls = window.jimuNls.filterBuilder; this._filterUtils = new b; this.OPERATORS =
                                                                k.clone(this._filterUtils.OPERATORS); this._spObj = {}
                                                }, destroy: function () { this.clear(); this._filterUtils = null; this.inherited(arguments) }, getFilterExpr: function (h) { var p = this._getNewValidPartsObj(this.partsObj, !0), B = p ? this._getFilterExprByPartsObj(p) : null; return h && h.ifDisplaySQL ? void 0 === p.displaySQL ? B : p.displaySQL : B }, getValueProviders: function () { for (var h = [], p = this._getAllInteractiveSinglePartArray(this.partsObj), B = 0; B < p.length; B++) { var t = p[B].spId; t && (t = this._getSingleFilterParameterBySpId(t), h.push(t)) } return h },
                                                _getNewValidPartsObj: function (h, p) {
                                                        h = k.clone(h); for (var B = { logicalOperator: h.logicalOperator, parts: [] }, t = k.hitch(this, function (D) {
                                                                if (D.spId) {
                                                                        var H = this._getSingleFilterParameterBySpId(D.spId), I = H.getValueObject(); this.useStandardizedQueries && "date" === D.fieldObj.shortType && (D._useStandardizedQueries = this.useStandardizedQueries); D.valueObj = I; if (!I || "uniquePredefined" !== I.type && "multiplePredefined" !== I.type) return I && "multipleDynamic" === I.type ? 0 < I.value.length ? 1 : -1 : I && "unique" === I.type ? null === I.value ||
                                                                                void 0 === I.value || "" === I.value ? -1 : 1 : H.getStatus(); H = []; for (var N in I.value) I.value[N].isChecked && H.push(I.value[N]); if (0 < H.length) return D.valueObj.value = H, 1; D.valueObj.value = ""; return -1
                                                                } return D.valueObj ? 1 : -1
                                                        }), u = k.hitch(this, function (D) { var H = t(D); 0 < H && B.parts.push(D); return H }), z = k.hitch(this, function (D) {
                                                                var H = []; D.parts = d.filter(D.parts, k.hitch(this, function (I) { I = t(I); H.push(I); return 0 < I })); 1 === D.parts.length ? B.parts.push(D.parts[0]) : 2 <= D.parts.length && B.parts.push(D); return Math.min.apply(H,
                                                                        H)
                                                        }), x = 0; x < h.parts.length; x++) { var y = h.parts[x]; if (y.parts) { if (0 > z(y) && p) return null } else if (0 > u(y) && p && y.valueObj && "uniquePredefined" !== y.valueObj.type && "multiplePredefined" !== y.valueObj.type && "unique" !== y.valueObj.type) return null } return B
                                                }, _getFilterExprByPartsObj: function (h) { this._filterUtils.isHosted = e.isHostedService(this.url); return this._filterUtils.getExprByFilterObj(h) }, _getSingleFilterParameterBySpId: function (h) { return this._spObj[h] }, _getCascadeFilterPartsObj: function (h) {
                                                        var p = {
                                                                logicalOperator: this.partsObj.logicalOperator,
                                                                parts: []
                                                        }, B = k.clone(this.partsObj); var t = "none"; h.interactiveObj && h.interactiveObj.cascade && (t = h.interactiveObj.cascade); if ("previous" === t) for (t = 0; t < B.parts.length; t++) { var u = B.parts[t]; if (u.majorCascadeIndex < h.majorCascadeIndex) p.parts.push(u); else if (u.parts && u.majorCascadeIndex === h.majorCascadeIndex) { var z = k.clone(u); z.parts = d.filter(z.parts, k.hitch(this, function (x) { return x.minorCascadeIndex < h.minorCascadeIndex })); p.parts.push(z) } } else if ("all" === t) for (t = 0; t < B.parts.length; t++)u = B.parts[t], u.majorCascadeIndex !==
                                                                h.majorCascadeIndex ? p.parts.push(u) : u.majorCascadeIndex === h.majorCascadeIndex && u.parts && (z = k.clone(u), d.some(u.parts, k.hitch(this, function (x) { return x.spId === h.spId })) && (z.parts = d.filter(z.parts, k.hitch(this, function (x) { return x.minorCascadeIndex !== h.minorCascadeIndex })), p.parts.push(z))); return p = this._getNewValidPartsObj(p, !1)
                                                }, _getCascadeFilterExpr: function (h) { var p = "1\x3d1"; (h = this._getCascadeFilterPartsObj(h)) && (p = this._getFilterExprByPartsObj(h)); p || (p = "1\x3d1"); return p }, clear: function () {
                                                        this.featureLayerId =
                                                        this.url = null; this.widgetId = ""; var h = c(".jimu-single-filter-parameter", this.tbody); d.forEach(h, k.hitch(this, function (p) { g.byNode(p).destroy() })); n.empty(this.tbody); this.layerInfo = this.partsObj = null
                                                }, build: function (h, p, B, t, u) {
                                                        var z = new A; this.clear(); this.url = h; this.layerInfo = p; this.partsObj = k.clone(B); this.useStandardizedQueries = this._filterUtils.useStandardizedQueries(p); this.partsObj = this._updatePartsObj(this.partsObj, p); this.featureLayerId = t; this.widgetId = u; this._setCascadeIndexForPartsObj(this.partsObj);
                                                        h = this._getAllInteractiveSinglePartArray(this.partsObj); var x = this.partsObj.wId; if (0 < h.length) {
                                                                var y = new f({ url: this.url, layerDefinition: p, featureLayerId: this.featureLayerId }); h = d.map(h, k.hitch(this, function (D, H) {
                                                                        x && (D.vpId = x + "_" + H); D.widgetId = this.widgetId; H = n.create("tr", { innerHTML: "\x3ctd\x3e\x3c/td\x3e" }, this.tbody); H = c("td", H)[0]; var I = this._getFieldInfo(D.fieldObj.name, this.layerInfo); I = new a({ nls: this.nls, url: this.url, layerDefinition: p, fieldInfo: I, part: D, valueProviderFactory: y }); this.own(E(I,
                                                                                "change", k.hitch(this, this._onSingleFilterParameterChanged))); this.own(E(I, "enter", k.hitch(this, this._catchSingleFilterParameterEnter))); I.placeAt(H); I.startup(); D.spId = I.id; return this._spObj[I.id] = I
                                                                })); d.forEach(h, k.hitch(this, function (D) { D.valueProvider.getCascadeFilterExpr = k.hitch(this, this._getCascadeFilterExpr, D.part); D.valueProvider.getCascadeFilterPartsObj = k.hitch(this, this._getCascadeFilterPartsObj, D.part) })); h = d.map(h, k.hitch(this, function (D) { return D.init() })); w(h).then(k.hitch(this, function (D) { z.resolve(D) }),
                                                                        k.hitch(this, function () { z.reject() }))
                                                        } else z.resolve(); return z
                                                }, _updatePartsObj: function (h) { d.forEach(h, k.hitch(this, function (p) { p.parts ? d.forEach(p.parts, k.hitch(this, function (B) { B.interactiveObj && !0 === B.interactiveObj.cascade ? B.interactiveObj.cascade = "previous" : !1 === B.interactiveObj.cascade && (B.interactiveObj.cascade = "none") })) : p.interactiveObj && !0 === p.interactiveObj.cascade ? p.interactiveObj.cascade = "previous" : !1 === p.interactiveObj.cascade && (p.interactiveObj.cascade = "none") })); return h }, _setCascadeIndexForPartsObj: function (h) {
                                                        for (var p =
                                                                0; p < h.parts.length; p++) { var B = h.parts[p]; B.majorCascadeIndex = "AND" === h.logicalOperator ? p : 0; B.minorCascadeIndex = 0; B.cascadeIndex = B.majorCascadeIndex; if (B.parts) for (var t = 0; t < B.parts.length; t++) { var u = B.parts[t]; u.majorCascadeIndex = B.majorCascadeIndex; u.minorCascadeIndex = "AND" === B.logicalOperator ? t : 0; u.cascadeIndex = parseFloat(u.majorCascadeIndex + "." + u.minorCascadeIndex) } }
                                                }, _getFieldInfo: function (h, p) { p = p.fields; for (var B = 0; B < p.length; B++) { var t = p[B]; if (h === t.name) return t } return null }, _getAllInteractiveSinglePartArray: function (h) {
                                                        for (var p =
                                                                [], B = 0; B < h.parts.length; B++) { var t = h.parts[B]; if (t.parts) for (var u = 0; u < t.parts.length; u++) { var z = t.parts[u]; z.interactiveObj && p.push(z) } else t.interactiveObj && p.push(t) } return p
                                                }, _catchSingleFilterParameterEnter: function () { this.emit("enter") }, _onSingleFilterParameterChanged: function () { this.emit("change", this.getFilterExpr(!1)) }
                                        })
                                })
                }, "jimu/dijit/_SingleFilterParameter": function () {
                        define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang ../utils".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        return w([m, v, r, q], {
                                                baseClass: "jimu-single-filter-parameter", templateString: l, valueProvider: null, nls: null, url: null, layerDefinition: null, fieldInfo: null, part: null, valueProviderFactory: null, postCreate: function () {
                                                        this.inherited(arguments); this.valueProvider = this.valueProviderFactory.getValueProvider(this.part, !0); this.valueProvider.placeAt(this.valueProviderTd); this.own(E(this.valueProvider, "change", k.hitch(this, this._onValueProviderChanged))); this.own(E(this.valueProvider,
                                                                "enter", k.hitch(this, this._onValueProviderEnter))); this.valueProvider.bindChangeEvents()
                                                }, getValueObject: function () { return this.valueProvider.getValueObject() }, init: function () { return this.build(this.fieldInfo, this.part) }, build: function (d, c) {
                                                        var g = null; this.fieldInfo = d; this.part = c; if (d = c.interactiveObj) this.promptNode.innerHTML = n.sanitizeHTML(d.prompt || ""), this.hintNode.innerHTML = n.sanitizeHTML(d.hint || ""); (d = this.valueProvider.setValueObject(this.part.valueObj)) && "function" === typeof d.then ? g = d : (g =
                                                                new A, g.resolve(this.valueProvider)); return g
                                                }, disable: function () { this.valueProvider.disable() }, enable: function () { this.valueProvider.enable() }, isEnabled: function () { return this.valueProvider.isEnabled() }, getStatus: function () { return this.valueProvider.getStatus() }, _showValidationErrorTip: function (d) { !d.validate() && d.domNode && d.focusNode && (d.focusNode.focus(), d.focusNode.blur()) }, _onValueProviderEnter: function () { this.emit("enter") }, _onValueProviderChanged: function () { this.emit("change") }
                                        })
                                })
                }, "dijit/layout/_LayoutWidget": function () {
                        define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),
                                function (E, q, A, w, m, v, r, l, k) {
                                        return v("dijit.layout._LayoutWidget", [q, A, w], {
                                                baseClass: "dijitLayoutContainer", isLayoutContainer: !0, _setTitleAttr: null, buildRendering: function () { this.inherited(arguments); r.add(this.domNode, "dijitContainer") }, startup: function () { if (!this._started) { this.inherited(arguments); var n = this.getParent && this.getParent(); n && n.isLayoutContainer || (this.resize(), this.own(m.on("resize", E.hitch(this, "resize")))) } }, resize: function (n, d) {
                                                        var c = this.domNode; n && l.setMarginBox(c, n); d = d || {};
                                                        E.mixin(d, n || {}); "h" in d && "w" in d || (d = E.mixin(l.getMarginBox(c), d)); n = k.getComputedStyle(c); var g = l.getMarginExtents(c, n), b = l.getBorderExtents(c, n); d = this._borderBox = { w: d.w - (g.w + b.w), h: d.h - (g.h + b.h) }; g = l.getPadExtents(c, n); this._contentBox = { l: k.toPixelValue(c, n.paddingLeft), t: k.toPixelValue(c, n.paddingTop), w: d.w - g.w, h: d.h - g.h }; this.layout()
                                                }, layout: function () { }, _setupChild: function (n) { r.add(n.domNode, this.baseClass + "-child " + (n.baseClass ? this.baseClass + "-" + n.baseClass : "")) }, addChild: function (n, d) {
                                                        this.inherited(arguments);
                                                        this._started && this._setupChild(n)
                                                }, removeChild: function (n) { r.remove(n.domNode, this.baseClass + "-child" + (n.baseClass ? " " + this.baseClass + "-" + n.baseClass : "")); this.inherited(arguments) }
                                        })
                                })
                }, "dgrid/main": function () { define([], 1) }, "dgrid/OnDemandGrid": function () { define(["dojo/_base/declare", "./Grid", "./OnDemandList"], function (E, q, A) { return E("dgrid.OnDemandGrid", [q, A], {}) }) }, "dgrid/Grid": function () {
                        define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),
                                function (E, q, A, w, m, v, r) {
                                        function l(d, c) { c && c.nodeType && d.appendChild(c) } function k(d, c, g, b) { if (this.formatter) { b = this.formatter; var e = this.grid.formatterScope; g.innerHTML = "string" === typeof b && e ? e[b](c, d) : this.formatter(c, d) } else null != c && g.appendChild(document.createTextNode(c)) } var n = 8 > w("ie") && !w("quirks"); q = q("dgrid.Grid", v, {
                                                columns: null, cellNavigation: !0, tabableHeader: !0, showHeader: !0, column: function (d) { return "object" != typeof d ? this.columns[d] : this.cell(d).column }, listType: "grid", cell: function (d,
                                                        c) { if (d.column && d.element) return d; d.target && d.target.nodeType && (d = d.target); if (d.nodeType) { do { if (this._rowIdToObject[d.id]) break; var g = d.columnId; if (g) { c = g; var b = d; break } d = d.parentNode } while (d && d != this.domNode) } if (!b && "undefined" != typeof c) { var e = this.row(d); if (g = e && e.element) { g = g.getElementsByTagName("td"); for (var a = 0; a < g.length; a++)if (g[a].columnId == c) { b = g[a]; break } } } if (null != d) return { row: e || this.row(d), column: c && this.column(c), element: b } }, createRowCells: function (d, c, g, b) {
                                                                var e = m("table.dgrid-row-table[role\x3dpresentation]"),
                                                                a = 9 > w("ie") || w("quirks") ? m(e, "tbody") : e, f, h, p; g = g || this.subRows; var B = 0; for (f = g.length; B < f; B++) {
                                                                        var t = g[B]; var u = m(a, "tr"); t.className && m(u, "." + t.className); var z = 0; for (h = t.length; z < h; z++) {
                                                                                var x = t[z]; var y = x.id; var D = x.field ? ".field-" + r.escapeCssIdentifier(x.field, "-") : ""; (p = "function" === typeof x.className ? x.className(b) : x.className) && (D += "." + p); D = m(d + (".dgrid-cell.dgrid-cell-padding" + (y ? ".dgrid-column-" + r.escapeCssIdentifier(y, "-") : "") + D.replace(/ +/g, ".")) + "[role\x3d" + ("th" === d ? "columnheader" : "gridcell") +
                                                                                        "]"); D.columnId = y; n ? (y = m(D, "!dgrid-cell-padding div.dgrid-cell-padding"), D.contents = y) : y = D; if (p = x.colSpan) D.colSpan = p; if (p = x.rowSpan) D.rowSpan = p; c(y, x); u.appendChild(D)
                                                                        }
                                                                } return e
                                                        }, left: function (d, c) { d.element || (d = this.cell(d)); return this.cell(this._move(d, -(c || 1), "dgrid-cell")) }, right: function (d, c) { d.element || (d = this.cell(d)); return this.cell(this._move(d, c || 1, "dgrid-cell")) }, renderRow: function (d, c) {
                                                                var g = this.createRowCells("td", function (b, e) {
                                                                        var a = d; e.get ? a = e.get(d) : "field" in e && "_item" != e.field &&
                                                                                (a = a[e.field]); e.renderCell ? l(b, e.renderCell(d, a, b, c)) : k.call(e, d, a, b, c)
                                                                }, c && c.subRows, d); return m("div[role\x3drow]\x3e", g)
                                                        }, renderHeader: function () {
                                                                var d = this, c = this.headerNode, g = c.childNodes.length; for (c.setAttribute("role", "row"); g--;)m(c.childNodes[g], "!"); g = this.createRowCells("th", function (b, e) {
                                                                        var a = e.headerNode = b; n && (b = b.parentNode); var f = e.field; f && (b.field = f); e.renderHeaderCell ? l(a, e.renderHeaderCell(a)) : ("label" in e || e.field) && a.appendChild(document.createTextNode("label" in e ? e.label :
                                                                                e.field)); !1 !== e.sortable && f && "_item" != f && (b.sortable = !0, b.className += " dgrid-sortable")
                                                                }, this.subRows && this.subRows.headerRows); this._rowIdToObject[g.id = this.id + "-header"] = this.columns; c.appendChild(g); this._sortListener && this._sortListener.remove(); this._sortListener = A(g, "click,keydown", function (b) {
                                                                        if ("click" == b.type || 32 == b.keyCode || !w("opera") && 13 == b.keyCode) {
                                                                                var e = b.target, a, f; do if (e.sortable) {
                                                                                        var h = [{ attribute: a = e.field || e.columnId, descending: (f = d._sort[0]) && f.attribute == a && !f.descending }];
                                                                                        a = { bubbles: !0, cancelable: !0, grid: d, parentType: b.type, sort: h }; A.emit(b.target, "dgrid-sort", a) && (d._sortNode = e, d.set("sort", h)); break
                                                                                } while ((e = e.parentNode) && e != c)
                                                                        }
                                                                })
                                                        }, resize: function () { var d = this.headerNode.firstChild, c = this.contentNode, g; this.inherited(arguments); if (!w("ie") || 7 < w("ie") && !w("quirks")) c.style.width = "", c && d && (g = d.offsetWidth) != c.offsetWidth && (c.style.width = g + "px") }, destroy: function () { this._destroyColumns(); this._sortListener && this._sortListener.remove(); this.inherited(arguments) }, _setSort: function (d,
                                                                c) { this.inherited(arguments); this.updateSortArrow(this._sort) }, _findSortArrowParent: function (d) { var c = this.columns, g; for (g in c) { var b = c[g]; if (b.field == d) return b.headerNode } }, updateSortArrow: function (d, c) {
                                                                        this._lastSortedArrow && (m(this._lastSortedArrow, "\x3c!dgrid-sort-up!dgrid-sort-down"), m(this._lastSortedArrow, "!"), delete this._lastSortedArrow); c && (this._sort = d); if (d[0] && (c = d[0].attribute, d = d[0].descending, c = this._sortNode || this._findSortArrowParent(c), delete this._sortNode, c)) {
                                                                                c = c.contents ||
                                                                                c; var g = this._lastSortedArrow = m("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"); g.innerHTML = "\x26nbsp;"; c.insertBefore(g, c.firstChild); m(c, d ? ".dgrid-sort-down" : ".dgrid-sort-up"); this.resize()
                                                                        }
                                                                }, styleColumn: function (d, c) { return this.addCssRule("#" + r.escapeCssIdentifier(this.domNode.id) + " .dgrid-column-" + r.escapeCssIdentifier(d, "-"), c) }, _configColumns: function (d, c) {
                                                                        var g = [], b = c instanceof Array; r.each(c, function (e, a) {
                                                                                "string" == typeof e && (c[a] = e = { label: e }); b || e.field || (e.field = a); a = e.id = e.id ||
                                                                                        (isNaN(a) ? a : d + a); this._configColumn && (this._configColumn(e, a, c, d), a = e.id); b && (this.columns[a] = e); e.grid = this; "function" === typeof e.init && e.init(); g.push(e)
                                                                        }, this); return b ? c : g
                                                                }, _destroyColumns: function () { var d = this.subRows, c = d && d.length, g, b; this.cleanup(); for (g = 0; g < c; g++) { var e = 0; for (b = d[g].length; e < b; e++) { var a = d[g][e]; "function" === typeof a.destroy && a.destroy() } } }, configStructure: function () {
                                                                        var d = this.subRows, c = this._columns = this.columns; this.columns = !c || c instanceof Array ? {} : c; if (d) for (c = 0; c < d.length; c++)d[c] =
                                                                                this._configColumns(c + "-", d[c]); else this.subRows = [this._configColumns("", c)]
                                                                }, _getColumns: function () { return this._columns || this.columns }, _setColumns: function (d) { this._destroyColumns(); this.subRows = null; this.columns = d; this._updateColumns() }, _setSubRows: function (d) { this._destroyColumns(); this.subRows = d; this._updateColumns() }, setColumns: function (d) { E.deprecated("setColumns(...)", 'use set("columns", ...) instead', "dgrid 0.4"); this.set("columns", d) }, setSubRows: function (d) {
                                                                        E.deprecated("setSubRows(...)",
                                                                                'use set("subRows", ...) instead', "dgrid 0.4"); this.set("subRows", d)
                                                                }, _updateColumns: function () { this.configStructure(); this.renderHeader(); this.refresh(); this._lastCollection && this.renderArray(this._lastCollection); this._started && (this._sort && this._sort.length ? this.updateSortArrow(this._sort) : this.resize()) }
                                        }); q.appendIfNode = l; q.defaultRenderCell = k; return q
                                })
                }, "put-selector/put": function () {
                        (function (E) {
                                var q, A = /[-+,> ]/; E([], q = function (w, m) {
                                        function v(d) {
                                                function c() {
                                                        f && a && f != a && (a == d && (g || (g = A.test(t) &&
                                                                w.createDocumentFragment())) ? g : a).insertBefore(f, e || null)
                                                } for (var g, b, e, a, f, h = arguments, p = h[0], B = 0; B < h.length; B++) {
                                                        var t = h[B]; if ("object" == typeof t) { b = !1; if (t instanceof Array) { f = w.createDocumentFragment(); for (var u = 0; u < t.length; u++)f.appendChild(v(t[u])); t = f } if (t.nodeType) f = t, c(), a = t, e = 0; else for (u in t) f[u] = t[u] } else if (b) b = !1, f.appendChild(w.createTextNode(t)); else {
                                                                1 > B && (d = null); b = !0; if (p = t.replace(r, function (z, x, y, D, H, I) {
                                                                        x && (c(), "-" == x || "+" == x ? (a = (e = f || a).parentNode, f = null, "+" == x && (e = e.nextSibling)) :
                                                                                ("\x3c" == x ? a = f = (f || a).parentNode : ("," == x ? a = d : f && (a = f), f = null), e = 0), f && (a = f)); if ((z = !y && D) || !f && (y || H)) "$" == z ? (z = h[++B], a.appendChild(w.createTextNode(z))) : (z = z || v.defaultTag, (x = n && h[B + 1] && h[B + 1].name) && (z = "\x3c" + z + ' name\x3d"' + x + '"\x3e'), f = k && ~(l = z.indexOf("|")) ? w.createElementNS(k[z.slice(0, l)], z.slice(l + 1)) : w.createElement(z)); if (y) if ("$" == D && (D = h[++B]), "#" == y) f.id = D; else if (x = (z = f.className) && (" " + z + " ").replace(" " + D + " ", " "), "." == y) f.className = z ? (x + D).substring(1) : D; else if ("!" == t) {
                                                                                        var N; n ? v("div",
                                                                                                f, "\x3c").innerHTML = "" : (N = f.parentNode) && N.removeChild(f)
                                                                                } else x = x.substring(1, x.length - 1), x != z && (f.className = x); H && ("$" == I && (I = h[++B]), "style" == H ? f.style.cssText = I : (y = "!" == H.charAt(0) ? (H = H.substring(1)) && "removeAttribute" : "setAttribute", I = "" === I ? H : I, k && ~(l = H.indexOf("|")) ? f[y + "NS"](k[H.slice(0, l)], H.slice(l + 1), I) : f[y](H, I))); return ""
                                                                })) throw new SyntaxError("Unexpected char " + p + " in " + t); c(); a = p = f || a
                                                        }
                                                } d && g && d.appendChild(g); return p
                                        } A = m || A; var r = /(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,
                                                l, k = !1; w = w || document; var n = "object" == typeof w.createElement; v.addNamespace = function (d, c) { w.createElementNS ? (k || (k = {}))[d] = c : w.namespaces.add(d, c) }; v.defaultTag = "div"; v.forDocument = q; return v
                                })
                        })(function (E, q, A) { A = A || q; "function" === typeof define ? define([], function () { return A() }) : "undefined" == typeof window ? require("./node-html")(module, A) : put = A() })
                }, "dgrid/List": function () {
                        define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/query dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        function d(u, z) { return m("#" + r.escapeCssIdentifier(u), z)[0] } function c(u, z) { n(document.body, u, ".dgrid-scrollbar-measure"); z = u["offset" + z] - u["client" + z]; u.className = ""; u.parentNode && document.body.removeChild(u); return z } function g(u) { var z = u ? "." + u.replace(B, ".") : ""; this._class && (z = "!" + this._class.replace(B, "!") + z); n(this.domNode, z); this._class = u } function b() { return this._class } function e() { return { x: this.bodyNode.scrollLeft, y: this.bodyNode.scrollTop } } function a(u) {
                                                "undefined" !==
                                                typeof u.x && (this.bodyNode.scrollLeft = u.x); "undefined" !== typeof u.y && (this.bodyNode.scrollTop = u.y)
                                        } k("mozilla", "opera", "webkit", "ie", "ie-6", "ie-6-7", "quirks", "no-quirks", "touch"); var f, h; v.add("dom-scrollbar-width", function (u, z, x) { return c(x, "Width") }); v.add("dom-scrollbar-height", function (u, z, x) { return c(x, "Height") }); v.add("dom-rtl-scrollbar-left", function (u, z, x) {
                                                u = n("div"); n(document.body, x, ".dgrid-scrollbar-measure[dir\x3drtl]"); n(x, u); z = !!v("ie") || !!v("trident") || u.offsetLeft >= v("dom-scrollbar-width");
                                                x.className = ""; x.parentNode && document.body.removeChild(x); n(u, "!"); x.removeAttribute("dir"); return z
                                        }); var p = 0, B = / +/g, t = 7 > v("ie") && !v("quirks") ? function () { if (this._started) { var u = document.documentElement; var z = u.clientWidth; u = u.clientHeight; var x = this._prevWinDims || []; if (x[0] !== z || x[1] !== u) this.resize(), this._prevWinDims = [z, u] } } : function () { this._started && this.resize() }; return q("dgrid.List", v("touch") ? l : null, {
                                                tabableHeader: !1, showHeader: !1, showFooter: !1, maintainOddEven: !0, cleanAddedRules: !0, useTouchScroll: null,
                                                addUiClasses: !0, shouldObserveStore: !0, cleanEmptyObservers: !0, highlightDuration: 250, postscript: function (u, z) { var x = this; (this._Row = function (y, D, H) { this.id = y; this.data = D; this.element = H }).prototype.remove = function () { x.removeRow(this.element) }; z && (this.srcNodeRef = z = z.nodeType ? z : d(z)); this.create(u, z) }, listType: "list", create: function (u, z) {
                                                        z = this.domNode = z || n("div"); if (u) { this.params = u; q.safeMixin(this, u); var x = u["class"] || u.className || z.className; this._sort = u.sort || []; delete this.sort } else this._sort =
                                                                []; this.observers = []; this._numObservers = 0; this._listeners = []; this._rowIdToObject = {}; this.postMixInProperties && this.postMixInProperties(); this.id = z.id = z.id || this.id || "dgrid_" + p++; null === this.useTouchScroll && (this.useTouchScroll = !v("dom-scrollbar-width")); this.buildRendering(); x && g.call(this, x); this.postCreate(); delete this.srcNodeRef; this.domNode.offsetHeight && this.startup()
                                                }, buildRendering: function () {
                                                        var u = this.domNode, z = this.addUiClasses, x = this; var y = this.isRTL = "rtl" == (document.body.dir || document.documentElement.dir ||
                                                                document.body.style.direction).toLowerCase(); u.className = ""; n(u, "[role\x3dgrid].dgrid.dgrid-" + this.listType + (z ? ".ui-widget" : "")); var D = this.headerNode = n(u, "div.dgrid-header.dgrid-header-row" + (z ? ".ui-widget-header" : "") + (this.showHeader ? "" : ".dgrid-header-hidden")); (v("quirks") || 8 > v("ie")) && n(u, "div.dgrid-spacer"); var H = this.bodyNode = n(u, "div.dgrid-scroller"); v("ff") && (H.tabIndex = -1); this.headerScrollNode = n(u, "div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width" + (z ? ".ui-widget-header" : "")); var I =
                                                                        this.footerNode = n("div.dgrid-footer" + (this.showFooter ? "" : ".dgrid-footer-hidden")); n(u, I); y && (u.className += " dgrid-rtl" + (v("dom-rtl-scrollbar-left") ? " dgrid-rtl-swap" : "")); w(H, "scroll", function (N) { x.showHeader && (D.scrollLeft = N.scrollLeft || H.scrollLeft); N.stopPropagation(); w.emit(u, "scroll", { scrollTarget: H }) }); this.configStructure(); this.renderHeader(); this.contentNode = this.touchNode = n(this.bodyNode, "div.dgrid-content" + (z ? ".ui-widget-content" : "")); this._listeners.push(this._resizeHandle = w(window, "resize",
                                                                                r.throttleDelayed(t, this)))
                                                }, postCreate: v("touch") ? function () { this.useTouchScroll && this.inherited(arguments) } : function () { }, startup: function () { this._started || (this.inherited(arguments), this._started = !0, this.resize(), this.set("sort", this._sort)) }, configStructure: function () { }, resize: function () {
                                                        var u = this.bodyNode, z = this.headerNode, x = this.footerNode, y = z.offsetHeight, D = this.showFooter ? x.offsetHeight : 0, H = v("quirks") || 7 > v("ie"); this.headerScrollNode.style.height = u.style.marginTop = y + "px"; u.style.marginBottom =
                                                                D + "px"; H && (u.style.height = "", u.style.height = Math.max(this.domNode.offsetHeight - y - D, 0) + "px", D && (x.style.bottom = "1px", setTimeout(function () { x.style.bottom = "" }, 0))); f || (f = v("dom-scrollbar-width"), h = v("dom-scrollbar-height"), v("ie") && (f++, h++), r.addCssRule(".dgrid-scrollbar-width", "width: " + f + "px"), r.addCssRule(".dgrid-scrollbar-height", "height: " + h + "px"), 17 == f || H || (r.addCssRule(".dgrid-header-row", "right: " + f + "px"), r.addCssRule(".dgrid-rtl-swap .dgrid-header-row", "left: " + f + "px"))); H && (z.style.width =
                                                                        u.clientWidth + "px", setTimeout(function () { z.scrollLeft = u.scrollLeft }, 0))
                                                }, addCssRule: function (u, z) { u = r.addCssRule(u, z); this.cleanAddedRules && this._listeners.push(u); return u }, on: function (u, z) { u = w(this.domNode, u, z); v("dom-addeventlistener") || this._listeners.push(u); return u }, cleanup: function () {
                                                        var u = this.observers, z; for (z in this._rowIdToObject) if (this._rowIdToObject[z] != this.columns) { var x = d(z, this.domNode); x && this.removeRow(x, !0) } for (z = 0; z < u.length; z++)(x = u[z]) && x.cancel(); this.observers = []; this._numObservers =
                                                                0; this.preload = null
                                                }, destroy: function () { if (this._listeners) { for (var u = this._listeners.length; u--;)this._listeners[u].remove(); delete this._listeners } this._started = !1; this.cleanup(); n(this.domNode, "!"); this.useTouchScroll && this.inherited(arguments) }, refresh: function () { this.cleanup(); this._rowIdToObject = {}; this._autoId = 0; this.contentNode.innerHTML = ""; this.scrollTo({ x: 0, y: 0 }) }, newRow: function (u, z, x, y, D) {
                                                        if (z) {
                                                                var H = this.insertRow(u, z, x, y, D); n(H, ".dgrid-highlight" + (this.addUiClasses ? ".ui-state-highlight" :
                                                                        "")); setTimeout(function () { n(H, "!dgrid-highlight!ui-state-highlight") }, this.highlightDuration); return H
                                                        }
                                                }, adjustRowIndices: function (u) { var z = u.rowIndex; if (-1 < z) { do -1 < u.rowIndex && (this.maintainOddEven && -1 < (u.className + " ").indexOf("dgrid-row ") && n(u, "." + (1 == z % 2 ? "dgrid-row-odd" : "dgrid-row-even") + "!" + (0 == z % 2 ? "dgrid-row-odd" : "dgrid-row-even")), u.rowIndex = z++); while ((u = u.nextSibling) && u.rowIndex != z) } }, renderArray: function (u, z, x) {
                                                        function y() {
                                                                var va = arguments; if (-1 < K) for (var xa = 0; xa < va.length; xa++) {
                                                                        var na =
                                                                                va[xa], ra = fa[na ? 0 : fa.length - 1]; if (ra = ra && D(ra)) { var sa = ra[na ? "previousSibling" : "nextSibling"]; sa && (sa = N.row(sa)); sa && sa.element != ra && (na = na ? "unshift" : "push", u[na](sa.data), fa[na](sa.element), x.count++) }
                                                                }
                                                        } function D(va) { return !A.isDescendant(va, N.domNode) && d(va.id) ? N.row(va.id.slice(N.id.length + 5)).element : va } function H(va) { X = N.insertRow(va, Q, null, T++, x); X.observerIndex = K; return X } function I(va) {
                                                                W = va.slice(0); (R = z ? z.parentNode : N.contentNode) && R.parentNode && (R !== N.contentNode || va.length) ? (R.insertBefore(Q,
                                                                        z || null), (X = va[va.length - 1]) && N.adjustRowIndices(X)) : M[K] && N.cleanEmptyObservers && N._onEmptyRender(K); fa = va; ca && (ca.rows = fa)
                                                        } x = x || {}; var N = this, T = x.start || 0, M = this.observers, R; z || (this._lastCollection = u); if (u.observe && this.shouldObserveStore) {
                                                                N._numObservers++; var ca = u.observe(function (va, xa, na) {
                                                                        var ra; if (-1 < xa && fa[xa]) { var sa = fa.splice(xa, 1)[0]; sa.parentNode == R && ((ra = sa.nextSibling) && xa != na && ra.rowIndex--, N.removeRow(sa)); x.count--; N._processScroll && N._processScroll() } if (-1 < na) {
                                                                                if (fa.length) if (0 ===
                                                                                        na) var wa = (wa = fa[na]) && D(wa); else { if (wa = fa[na - 1]) wa = D(wa), wa = (wa.connected || wa).nextSibling } else wa = N._getFirstRowSibling && N._getFirstRowSibling(R); sa && wa && sa.id === wa.id && (wa = (wa.connected || wa).nextSibling); wa && !wa.parentNode && (wa = d(wa.id)); sa = z && z.parentNode || wa && wa.parentNode || N.contentNode; if (sa = N.newRow(va, sa, wa, x.start + na, x)) if (sa.observerIndex = K, fa.splice(na, 0, sa), !ra || na < xa) ra = (ra = sa.previousSibling) && ra.rowIndex + 1 != sa.rowIndex && 0 != sa.rowIndex ? ra : sa; x.count++
                                                                        } 0 === xa ? y(1, 1) : xa === u.length - (-1 ===
                                                                                na ? 0 : 1) && y(0, 0); xa != na && ra && N.adjustRowIndices(ra); N._onNotification(fa, va, xa, na)
                                                                }, !0); var K = M.push(ca) - 1
                                                        } var Q = document.createDocumentFragment(), X, W; if (u.map) { var fa = u.map(H, console.error); if (fa.then) return u.then(function (va) { u = va; return fa.then(function (xa) { I(xa); y(1, 1, 0, 0); return W }) }) } else { fa = []; for (var ma = 0, ia = u.length; ma < ia; ma++)fa[ma] = H(u[ma]) } I(fa); y(1, 1, 0, 0); return W
                                                }, _onEmptyRender: function (u) { "undefined" !== typeof u && (this.observers[u].cancel(), this.observers[u] = 0, this._numObservers--) },
                                                _onNotification: function (u, z, x, y) { }, renderHeader: function () { }, _autoId: 0, insertRow: function (u, z, x, y, D) {
                                                        var H = D.parentId; H = this.id + "-row-" + (H ? H + "-" : "") + (this.store && this.store.getIdentity ? this.store.getIdentity(u) : this._autoId++); var I = d(H, this.domNode), N = I && I.previousSibling; I && (I === x && (x = (x.connected || x).nextSibling), this.removeRow(I)); I = this.renderRow(u, D); I.className = (I.className || "") + " dgrid-row " + (1 == y % 2 ? "dgrid-row-odd" : "dgrid-row-even") + (this.addUiClasses ? " ui-state-default" : ""); this._rowIdToObject[I.id =
                                                                H] = u; z.insertBefore(I, x || null); N && this.adjustRowIndices(N); I.rowIndex = y; return I
                                                }, renderRow: function (u, z) { return n("div", "" + u) }, removeRow: function (u, z) { u = u.element || u; delete this._rowIdToObject[u.id]; z || n(u, "!") }, row: function (u) {
                                                        var z; if (u instanceof this._Row) return u; u.target && u.target.nodeType && (u = u.target); if (u.nodeType) { do { var x = u.id; if (z = this._rowIdToObject[x]) return new this._Row(x.substring(this.id.length + 5), z, u); u = u.parentNode } while (u && u != this.domNode) } else return "object" == typeof u ? z = this.store.getIdentity(u) :
                                                                (z = u, u = this._rowIdToObject[this.id + "-row-" + z]), new this._Row(z, u, d(this.id + "-row-" + z, this.domNode))
                                                }, cell: function (u) { return { row: this.row(u) } }, _move: function (u, z, x, y) { var D; var H = D = u.element; z = z || 1; do if (u = D[0 > z ? "previousSibling" : "nextSibling"]) { do if ((D = u) && -1 < (D.className + " ").indexOf(x + " ")) { H = D; z += 0 > z ? 1 : -1; break } while (u = (!y || !D.hidden) && D[0 > z ? "lastChild" : "firstChild"]) } else if (D = D.parentNode, !D || D === this.bodyNode || D === this.headerNode) break; while (z); return H }, up: function (u, z, x) {
                                                        u.element || (u = this.row(u));
                                                        return this.row(this._move(u, -(z || 1), "dgrid-row", x))
                                                }, down: function (u, z, x) { u.element || (u = this.row(u)); return this.row(this._move(u, z || 1, "dgrid-row", x)) }, scrollTo: v("touch") ? function (u) { return this.useTouchScroll ? this.inherited(arguments) : a.call(this, u) } : a, getScrollPosition: v("touch") ? function () { return this.useTouchScroll ? this.inherited(arguments) : e.call(this) } : e, get: function (u) {
                                                        var z = "_get" + u.charAt(0).toUpperCase() + u.slice(1); return "function" === typeof this[z] ? this[z].apply(this, [].slice.call(arguments,
                                                                1)) : this[u]
                                                }, set: function (u, z) { if ("object" === typeof u) for (var x in u) this.set(x, u[x]); else x = "_set" + u.charAt(0).toUpperCase() + u.slice(1), "function" === typeof this[x] ? this[x].apply(this, [].slice.call(arguments, 1)) : this[u] = z; return this }, _getClass: b, _setClass: g, _getClassName: b, _setClassName: g, _setSort: function (u, z) {
                                                        this._sort = "string" != typeof u ? u : [{ attribute: u, descending: z }]; this.refresh(); this._lastCollection && (u.length && ("string" != typeof u && (z = u[0].descending, u = u[0].attribute), this._lastCollection.sort(function (x,
                                                                y) { x = x[u]; y = y[u]; void 0 === x && (x = ""); void 0 === y && (y = ""); return x == y ? 0 : x > y == !z ? 1 : -1 })), this.renderArray(this._lastCollection))
                                                }, sort: function (u, z) { E.deprecated("sort(...)", 'use set("sort", ...) instead', "dgrid 0.4"); this.set("sort", u, z) }, _getSort: function () { return this._sort }, _setShowHeader: function (u) { var z = this.headerNode; this.showHeader = u; n(z, (u ? "!" : ".") + "dgrid-header-hidden"); this.renderHeader(); this.resize(); u && (z.scrollLeft = this.getScrollPosition().x) }, setShowHeader: function (u) {
                                                        E.deprecated("setShowHeader(...)",
                                                                'use set("showHeader", ...) instead', "dgrid 0.4"); this.set("showHeader", u)
                                                }, _setShowFooter: function (u) { this.showFooter = u; n(this.footerNode, (u ? "!" : ".") + "dgrid-footer-hidden"); this.resize() }
                                        })
                                })
                }, "dgrid/util/misc": function () {
                        define(["dojo/has"], function (E) {
                                E.add("dom-contains", function (n, d, c) { return !!c.contains }); var q = [], A, w, m, v = /([^A-Za-z0-9_\u00A0-\uFFFF-])/g, r = setTimeout, l = clearTimeout; E.add("requestidlecallback", function (n) { return "function" === typeof n.requestIdleCallback }); var k = {
                                        defaultDelay: 15,
                                        throttle: function (n, d, c) { var g = !1; c = c || k.defaultDelay; return function () { g || (g = !0, n.apply(d, arguments), r(function () { g = !1 }, c)) } }, throttleDelayed: function (n, d, c) { var g = !1; c = c || k.defaultDelay; return function () { if (!g) { g = !0; var b = arguments; r(function () { g = !1; n.apply(d, b) }, c) } } }, debounce: function (n, d, c) { var g; c = c || k.defaultDelay; return function () { g && (l(g), g = null); var b = arguments; g = r(function () { g = null; n.apply(d, b) }, c) } }, each: function (n, d, c) {
                                                var g; if (n) if ("number" === typeof n.length) {
                                                        var b = 0; for (g = n.length; b <
                                                                g; b++)d.call(c, n[b], b, n)
                                                } else for (b in n) d.call(c, n[b], b, n)
                                        }, contains: function (n, d) { return E("dom-contains") ? n.contains(d) : n.compareDocumentPosition(d) & 8 }, addCssRule: function (n, d) {
                                                A || (A = document.createElement("style"), document.getElementsByTagName("head")[0].appendChild(A), A = A.sheet || A.styleSheet, w = A.deleteRule ? "deleteRule" : "removeRule", m = A.cssRules ? "cssRules" : "rules"); var c = q.length; q[c] = (A.cssRules || A.rules).length; A.addRule ? A.addRule(n, d) : A.insertRule(n + "{" + d + "}", q[c]); return {
                                                        get: function (g) { return A[m][q[c]].style[g] },
                                                        set: function (g, b) { "undefined" !== typeof q[c] && (A[m][q[c]].style[g] = b) }, remove: function () { var g = q[c], b; if (void 0 !== g) { A[w](g); q[c] = void 0; var e = c + 1; for (b = q.length; e < b; e++)q[e] > g && q[e]-- } }
                                                }
                                        }, escapeCssIdentifier: function (n, d) { return "string" === typeof n ? n.replace(v, d || "\\$1") : n }
                                }; return k
                        })
                }, "xstyle/has-class": function () {
                        define(["dojo/has"], function (E) {
                                var q = {}; return function () {
                                        for (var A, w = arguments, m = 0; m < w.length; m++)if (A = w[m], !q[A]) {
                                                q[A] = !0; var v = A.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/), r = E(v[2]),
                                                        l = -v[4]; (0 < l ? l <= r && (-v[5] || l) >= r : !!r) == !v[1] && (document.documentElement.className += " has-" + A)
                                        }
                                }
                        })
                }, "dgrid/OnDemandList": function () {
                        define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "), function (E, q, A, w, m, v, r, l, k) {
                                return A("dgrid.OnDemandList", [E, q], {
                                        minRowsPerPage: 25, maxRowsPerPage: 250, maxEmptySpace: Infinity, bufferRows: 10, farOffRemoval: 2E3, queryRowsOverlap: 0, pagingMethod: "debounce", pagingDelay: l.defaultDelay, keepScrollPosition: !1,
                                        rowHeight: 22, postCreate: function () { this.inherited(arguments); var n = this; r(this.bodyNode, "scroll", l[this.pagingMethod](function (d) { n._processScroll(d) }, null, this.pagingDelay)) }, destroy: function () { this.inherited(arguments); this._refreshTimeout && clearTimeout(this._refreshTimeout) }, renderQuery: function (n, d) {
                                                function c(t) { k(B, "!"); if (t) throw g._refreshDeferred && (g._refreshDeferred.reject(t), delete g._refreshDeferred), t; } var g = this, b = d && d.container || this.contentNode, e = { query: n, count: 0, options: d }, a, f = this.preload,
                                                        h, p = { node: k(b, "div.dgrid-preload", { rowIndex: 0 }), count: 0, query: n, next: e, options: d }; p.node.style.height = "0"; e.node = a = k(b, "div.dgrid-preload"); e.previous = p; a.rowIndex = this.minRowsPerPage; f ? ((e.next = f.next) && a.offsetTop >= f.node.offsetTop ? e.previous = f : (e.next = f, e.previous = f.previous), e.previous.next = e, e.next.previous = e) : this.preload = e; var B = k(a, "-div.dgrid-loading"); k(B, "div.dgrid-below").innerHTML = this.loadingMessage; d = w.mixin(this.get("queryOptions"), d, { start: 0, count: this.minRowsPerPage }, "level" in n ?
                                                                { queryLevel: n.level } : null); this._trackError(function () { return h = n(d) }); if ("undefined" === typeof h) c(); else return m.when(g.renderArray(h, a, d), function (t) {
                                                                        return m.when("undefined" === typeof h.total ? h.length : h.total, function (u) {
                                                                                var z = t.length, x = a.parentNode, y = g.noDataNode; k(B, "!"); "queryLevel" in d || (g._total = u); 0 === u && x && (y && (k(y, "!"), delete g.noDataNode), g.noDataNode = y = k("div.dgrid-no-data"), x.insertBefore(y, g._getFirstRowSibling(x)), y.innerHTML = g.noDataMessage); for (var D = y = 0; D < z; D++)y += g._calcRowHeight(t[D]);
                                                                                z && y && (g.rowHeight = y / z); y = g.rowHeight * g.bufferRows; y > g.farOffRemoval && (g.farOffRemoval = y); u -= z; e.count = u; a.rowIndex = z; u ? a.style.height = Math.min(u * g.rowHeight, g.maxEmptySpace) + "px" : (a.style.display = "none", d.count++); g._previousScrollPosition && x && x.offsetHeight && (g.scrollTo(g._previousScrollPosition), delete g._previousScrollPosition); g._processScroll(); g._refreshDeferred && (g._refreshDeferred.resolve(h), delete g._refreshDeferred); return t
                                                                        }, c)
                                                                }, c), h
                                        }, refresh: function (n) {
                                                var d = this, c = n && n.keepScrollPosition;
                                                "undefined" === typeof c && (c = this.keepScrollPosition); c && (this._previousScrollPosition = this.getScrollPosition()); this.inherited(arguments); if (this.store) {
                                                        c = this._refreshDeferred = new m; var g = d.renderQuery(function (b) { return d.store.query(d.query, b) }); "undefined" === typeof g && c.reject(); return c.then(function (b) { d._refreshTimeout = setTimeout(function () { r.emit(d.domNode, "dgrid-refresh-complete", { bubbles: !0, cancelable: !1, grid: d, results: b }); d._refreshTimeout = null }, 0); delete d._refreshDeferred; return b }, function (b) {
                                                                delete d._refreshDeferred;
                                                                throw b;
                                                        })
                                                }
                                        }, resize: function () { this.inherited(arguments); this._processScroll() }, _getFirstRowSibling: function (n) { return n.lastChild }, _calcRowHeight: function (n) { var d = n.nextSibling; return d && !/\bdgrid-preload\b/.test(d.className) ? d.offsetTop - n.offsetTop : n.offsetHeight }, lastScrollTop: 0, _processScroll: function (n) {
                                                function d(Q, X, W, fa) {
                                                        var ma = b.farOffRemoval, ia = Q.node; if (X > 2 * ma) {
                                                                for (var va, xa = ia[W], na = 0, ra = 0, sa = []; va = xa;) {
                                                                        var wa = b._calcRowHeight(va); if (na + wa + ma > X || 0 > xa.className.indexOf("dgrid-row") && 0 >
                                                                                xa.className.indexOf("dgrid-loading")) break; xa = va[W]; na += wa; ra += va.count || 1; b.removeRow(va, !0); sa.push(va)
                                                                } Q.count += ra; fa ? (ia.rowIndex -= ra, c(Q)) : ia.style.height = ia.offsetHeight + na + "px"; var aa = k("div", sa); setTimeout(function () { k(aa, "!") }, 1)
                                                        }
                                                } function c(Q, X) { Q.node.style.height = Math.min(Q.count * b.rowHeight, X ? Infinity : b.maxEmptySpace) + "px" } function g(Q, X) { do Q = X ? Q.next : Q.previous; while (Q && !Q.node.offsetWidth); return Q } var b = this, e = b.bodyNode; n = n && n.scrollTop || this.getScrollPosition().y; e = e.offsetHeight +
                                                        n; var a = b.preload, f = b.lastScrollTop, h = b.bufferRows * b.rowHeight, p = h - b.rowHeight, B, t, u, z = !0; for (b.lastScrollTop = n; a && !a.node.offsetWidth;)a = a.previous; for (; a && a != x;) {
                                                                var x = b.preload; b.preload = a; var y = a.node; var D = y.offsetTop; if (e + 1 + p < D) a = g(a, z = !1); else if (n - 1 - p > D + y.offsetHeight) a = g(a, z = !0); else {
                                                                        var H = ((y.rowIndex ? n - h : e) - D) / b.rowHeight; D = (e - n + 2 * h) / b.rowHeight; D += Math.min(Math.abs(Math.max(Math.min((n - f) * b.rowHeight, b.maxRowsPerPage / 2), b.maxRowsPerPage / -2)), 10); 0 == y.rowIndex && (H -= D); H = Math.max(H, 0); 10 >
                                                                                H && 0 < H && D + H < b.maxRowsPerPage && (D += Math.max(0, H), H = 0); D = Math.min(Math.max(D, b.minRowsPerPage), b.maxRowsPerPage, a.count); if (0 == D) a = g(a, z); else {
                                                                                        D = Math.ceil(D); H = Math.min(Math.floor(H), a.count - D); var I = w.mixin(b.get("queryOptions"), a.options); a.count -= D; var N = y, T = b.queryRowsOverlap, M = (0 < y.rowIndex || y.offsetTop > n) && a; if (M) {
                                                                                                var R = a.previous; R && (d(R, n - (R.node.offsetTop + R.node.offsetHeight), "nextSibling"), 0 < H && R.node == y.previousSibling ? (H = Math.min(a.count, H), a.previous.count += H, c(a.previous, !0), y.rowIndex +=
                                                                                                        H, T = 0) : D += H, a.count -= H); I.start = y.rowIndex - T; I.count = Math.min(D + T, b.maxRowsPerPage); y.rowIndex = I.start + I.count
                                                                                        } else { if (a.next) if (d(a.next, a.next.node.offsetTop - e, "previousSibling", !0), N = y.nextSibling, N == a.next.node) a.next.count += a.count - H, a.next.node.rowIndex = H + D, c(a.next), a.count = H, T = 0; else var ca = !0; I.start = a.count; I.count = Math.min(D + T, b.maxRowsPerPage) } ca && N && N.offsetWidth && (ca = N.offsetTop); c(a); "level" in a.query && (I.queryLevel = a.query.level); if ("queryLevel" in I || !(I.start > b._total || 0 > I.count)) {
                                                                                                y =
                                                                                                k(N, "-div.dgrid-loading[style\x3dheight:" + D * b.rowHeight + "px]"); k(y, "div.dgrid-" + (M ? "below" : "above")).innerHTML = b.loadingMessage; y.count = D; var K = a.query(I); if (void 0 === b._trackError(function () { return K })) { k(y, "!"); return } (function (Q, X, W, fa) {
                                                                                                        u = m.when(b.renderArray(fa, Q, I), function (ma) {
                                                                                                                t = fa; N = Q.nextSibling; k(Q, "!"); if (W && N && N.offsetWidth) { var ia = b.getScrollPosition(); b.scrollTo({ x: ia.x, y: ia.y + N.offsetTop - W, preserveMomentum: !0 }) } m.when(fa.total || fa.length, function (va) {
                                                                                                                        "queryLevel" in I || (b._total = va);
                                                                                                                        X && (X.count = va - X.node.rowIndex, 0 === X.count && I.count++, c(X))
                                                                                                                }); b._processScroll(); return ma
                                                                                                        }, function (ma) { k(Q, "!"); throw ma; })
                                                                                                }).call(this, y, M, ca, K); a = a.previous
                                                                                        }
                                                                                }
                                                                }
                                                        } u && (B = this._refreshDeferred) && (delete this._refreshDeferred, m.when(u, function () { B.resolve(t) }))
                                        }, removeRow: function (n, d) {
                                                if (n) {
                                                        var c = n.previousSibling, g = n.nextSibling, b; if (b = c) b = c.observerIndex, b = null != b ? b : c.previousObserverIndex; c = b; if (b = g) b = g.observerIndex, b = null != b ? b : g.nextObserverIndex; g = n.observerIndex; n.observerIndex = void 0; d && (n.nextObserverIndex =
                                                                b, n.previousObserverIndex = c); if (this.cleanEmptyObservers && -1 < g && g !== c && g !== b && (c = this.observers, b = c[g])) { if (!d) for (var e = b.rows, a = 0; a < e.length; a++)if (e[a] != n && v.isDescendant(e[a], this.domNode)) return this.inherited(arguments); b.cancel(); this._numObservers--; c[g] = 0 }
                                                } this.inherited(arguments)
                                        }
                                })
                        })
                }, "dgrid/_StoreMixin": function () {
                        define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "), function (E, q, A, w, m, v, r) {
                                function l(n) { return n }
                                function k(n) { if ("object" !== typeof n) n = Error(n); else if ("cancel" === n.dojoType) return; n.grid = this; m.emit(this.domNode, "dgrid-error", { grid: this, error: n, cancelable: !0, bubbles: !0 }) && console.error(n) } return q("dgrid._StoreMixin", null, {
                                        store: null, query: null, queryOptions: null, getBeforePut: !0, noDataMessage: "", loadingMessage: "", constructor: function () {
                                                this.query = {}; this.queryOptions = {}; this.dirty = {}; this._updating = {}; this._columnsWithSet = {}; v.before(this, "configStructure", A.hitch(this, function () {
                                                        this._columnsWithSet =
                                                        {}
                                                }))
                                        }, postCreate: function () { this.inherited(arguments); this.store && this._updateNotifyHandle(this.store) }, destroy: function () { this.inherited(arguments); this._notifyHandle && this._notifyHandle.remove() }, _configColumn: function (n) { n.set && (this._columnsWithSet[n.field] = n); this.inherited(arguments) }, _updateNotifyHandle: function (n) {
                                                this._notifyHandle && (this._notifyHandle.remove(), delete this._notifyHandle); n && "function" === typeof n.notify && this.shouldObserveStore && (this._notifyHandle = v.after(n, "notify", A.hitch(this,
                                                        "_onNotify"), !0), (n = this.get("sort")) && n.length || console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))
                                        }, _setStore: function (n, d, c) { this._updateNotifyHandle(n); this.store = n; this.dirty = {}; this.set("query", d, c) }, _setQuery: function (n, d) { var c = d && d.sort; this.query = void 0 !== n ? n : this.query; this.queryOptions = d || this.queryOptions; this._started && (c ? this.set("sort", c) : this.refresh()) },
                                        setStore: function (n, d, c) { E.deprecated("setStore(...)", 'use set("store", ...) instead', "dgrid 0.4"); this.set("store", n, d, c) }, setQuery: function (n, d) { E.deprecated("setQuery(...)", 'use set("query", ...) instead', "dgrid 0.4"); this.set("query", n, d) }, _getQueryOptions: function () { var n = A.delegate(this.queryOptions, {}); if ("function" === typeof this._sort || this._sort.length) n.sort = this._sort; return n }, _getQuery: function () { var n = this.query; return "object" == typeof n && null != n ? A.delegate(n, {}) : n }, _setSort: function (n,
                                                d) { this.store && (this._lastCollection = null); this.inherited(arguments) }, _onNotify: function (n, d) { this.inherited(arguments); n && 1 > this._numObservers && this.refresh({ keepScrollPosition: !0 }) }, refresh: function () { var n = this.inherited(arguments); this.store || (this.noDataNode = r(this.contentNode, "div.dgrid-no-data"), this.noDataNode.innerHTML = this.noDataMessage); return n }, renderArray: function () {
                                                        var n = this, d = this.inherited(arguments); this.store || w.when(d, function (c) { c.length && n.noDataNode && r(n.noDataNode, "!") });
                                                        return d
                                                }, _onEmptyRender: function () { }, insertRow: function (n, d, c, g, b) { var e = this.store, a = this.dirty; e = e && e.getIdentity(n); var f; e in a && !(e in this._updating) && (f = a[e]); f && (n = A.delegate(n, f)); return this.inherited(arguments) }, updateDirty: function (n, d, c) { var g = this.dirty, b = g[n]; b || (b = g[n] = {}); b[d] = c }, setDirty: function (n, d, c) { E.deprecated("setDirty(...)", "use updateDirty() instead", "dgrid 0.4"); this.updateDirty(n, d, c) }, save: function () {
                                                        function n(p, B) {
                                                                return function (t) {
                                                                        var u = d._columnsWithSet, z = d._updating,
                                                                        x; if ("function" === typeof t.set) t.set(B); else for (x in B) t[x] = B[x]; for (x in u) { var y = u[x].set(t); void 0 !== y && (t[x] = y) } z[p] = !0; return w.when(c.put(t), function () { delete g[p]; delete z[p] })
                                                                }
                                                        } var d = this, c = this.store, g = this.dirty, b = new w, e = b.promise, a = function (p) { var B; return d.getBeforePut || !(B = d.row(p).data) ? function () { return c.get(p) } : function () { return B } }, f; for (f in g) { var h = n(f, g[f]); e = e.then(a(f)).then(h) } b.resolve(); return e
                                                }, revert: function () { this.dirty = {}; this.refresh() }, _trackError: function (n) {
                                                        "string" ==
                                                        typeof n && (n = A.hitch(this, n)); try { var d = n() } catch (c) { k.call(this, c) } return w.when(d, l, A.hitch(this, k))
                                                }, newRow: function () { var n = this.inherited(arguments); this.noDataNode && (r(this.noDataNode, "!"), delete this.noDataNode); return n }, removeRow: function (n, d) { var c = { element: n }; !d && this.noDataMessage && this.up(c).element === n && this.down(c).element === n && (this.noDataNode = r(this.contentNode, "div.dgrid-no-data"), this.noDataNode.innerHTML = this.noDataMessage); return this.inherited(arguments) }
                                })
                        })
                }, "dgrid/Selection": function () {
                        define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/mouse dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n) {
                                        function d(h, p) { p = h.unselectable = p ? "on" : ""; h = h.getElementsByTagName("*"); for (var B = h.length; --B;)"INPUT" !== h[B].tagName && "TEXTAREA" !== h[B].tagName && (h[B].unselectable = p) } function c(h, p) {
                                                var B = h.bodyNode, t = p ? "text" : 21 > m("ff") ? "-moz-none" : "none"; b && "msUserSelect" !== b ? B.style[b] = t : m("dom-selectstart") ? p || h._selectstartHandle ? p && h._selectstartHandle && (h._selectstartHandle.remove(), delete h._selectstartHandle) : h._selectstartHandle = w(B, "selectstart", function (u) {
                                                        var z = u.target &&
                                                                u.target.tagName; "INPUT" !== z && "TEXTAREA" !== z && u.preventDefault()
                                                }) : (d(B, !p), p || h._unselectableHandle) ? p && h._unselectableHandle && (h._unselectableHandle.remove(), delete h._unselectableHandle) : h._unselectableHandle = r.after(h, "renderRow", function (u) { d(u, !0); return u })
                                        } m.add("dom-comparedocumentposition", function (h, p, B) { return !!B.compareDocumentPosition }); m.add("pointer", function (h) { return "PointerEvent" in h ? "pointer" : "MSPointerEvent" in h ? "MSPointer" : !1 }); m.add("css-user-select", function (h, p, B) {
                                                h = B.style;
                                                p = ["Khtml", "O", "ms", "Moz", "Webkit"]; B = p.length; var t = "userSelect"; do if ("undefined" !== typeof h[t]) return t; while (B-- && (t = p[B] + "UserSelect")); return !1
                                        }); m.add("dom-selectstart", "undefined" !== typeof document.onselectstart); var g = m("mac") ? "metaKey" : "ctrlKey", b = m("css-user-select"), e = (l = m("pointer")) && "MS" === l.slice(0, 2), a = l ? l + (e ? "Down" : "down") : "mousedown", f = l ? l + (e ? "Up" : "up") : "mouseup"; "WebkitUserSelect" === b && "undefined" !== typeof document.documentElement.style.msUserSelect && (b = !1); return q("dgrid.Selection",
                                                null, {
                                                        selectionDelegate: ".dgrid-row", selectionEvents: a + "," + f + ",dgrid-cellfocusin", selectionTouchEvents: m("touch") ? k.tap : null, deselectOnRefresh: !0, allowSelectAll: !1, selection: {}, selectionMode: "extended", allowTextSelection: void 0, _selectionTargetType: "rows", create: function () { this.selection = {}; return this.inherited(arguments) }, postCreate: function () { this.inherited(arguments); this._initSelectionEvents(); var h = this.selectionMode; this.selectionMode = ""; this._setSelectionMode(h) }, destroy: function () {
                                                                this.inherited(arguments);
                                                                this._selectstartHandle && this._selectstartHandle.remove(); this._unselectableHandle && this._unselectableHandle.remove(); this._removeDeselectSignals && this._removeDeselectSignals()
                                                        }, _setSelectionMode: function (h) { h != this.selectionMode && (this.clearSelection(), this.selectionMode = h, this._selectionHandlerName = "_" + h + "SelectionHandler", this._setAllowTextSelection(this.allowTextSelection)) }, setSelectionMode: function (h) {
                                                                E.deprecated("setSelectionMode(...)", 'use set("selectionMode", ...) instead', "dgrid 0.4");
                                                                this.set("selectionMode", h)
                                                        }, _setAllowTextSelection: function (h) { "undefined" !== typeof h ? c(this, h) : c(this, "none" === this.selectionMode); this.allowTextSelection = h }, _handleSelect: function (h, p) {
                                                                if (!v.isRight(h) && this[this._selectionHandlerName] && this.allowSelect(this.row(p)) && ("dgrid-cellfocusin" !== h.type || "mousedown" !== h.parentType) && (h.type !== f || p == this._waitForMouseUp)) {
                                                                        this._waitForMouseUp = null; this._selectionTriggerEvent = h; if (!h.keyCode || !h.ctrlKey || 32 == h.keyCode) if (!h.shiftKey && h.type === a && this.isSelected(p)) this._waitForMouseUp =
                                                                                p; else this[this._selectionHandlerName](h, p); this._selectionTriggerEvent = null
                                                                }
                                                        }, _singleSelectionHandler: function (h, p) { h = h.keyCode ? h.ctrlKey : h[g]; this._lastSelected === p ? this.select(p, null, !h || !this.isSelected(p)) : (this.clearSelection(), this.select(p), this._lastSelected = p) }, _multipleSelectionHandler: function (h, p) { var B = this._lastSelected, t = h.keyCode ? h.ctrlKey : h[g]; if (!h.shiftKey) { var u = t ? null : !0; B = null } this.select(p, B, u); B || (this._lastSelected = p) }, _extendedSelectionHandler: function (h, p) {
                                                                if (h[g] || !this.isSelected(p) ||
                                                                        1 !== this.getSelectedCount()) (2 === h.button ? this.isSelected(p) : h.keyCode ? h.ctrlKey : h[g]) || this.clearSelection(null, !0), this._multipleSelectionHandler(h, p)
                                                        }, _toggleSelectionHandler: function (h, p) { this.select(p, null, null) }, _initSelectionEvents: function () {
                                                                var h = this, p = this.contentNode, B = this.selectionDelegate; this._selectionEventQueues = { deselect: [], select: [] }; m("touch") && !m("pointer") && this.selectionTouchEvents ? (w(p, k.selector(B, this.selectionTouchEvents), function (t) {
                                                                        h._handleSelect(t, this); h._ignoreMouseSelect =
                                                                                this
                                                                }), w(p, w.selector(B, this.selectionEvents), function (t) { h._ignoreMouseSelect !== this ? h._handleSelect(t, this) : t.type === f && (h._ignoreMouseSelect = null) })) : w(p, w.selector(B, this.selectionEvents), function (t) { h._handleSelect(t, this) }); this.addKeyHandler && this.addKeyHandler(32, function (t) { h._handleSelect(t, t.target) }); if (this.allowSelectAll) this.on("keydown", function (t) { t[g] && 65 == t.keyCode && !/\bdgrid-input\b/.test(t.target.className) && (t.preventDefault(), h[h.allSelected ? "clearSelection" : "selectAll"]()) });
                                                                this._setStore && r.after(this, "_setStore", function () { h._updateDeselectionAspect() }); this._updateDeselectionAspect()
                                                        }, _updateDeselectionAspect: function () {
                                                                function h(z, x, y) { z = x || z && z[p.idProperty || "id"]; if (null != z && (x = (z = p.row(z)) && p.selection[z.id])) p[y](z, null, x) } var p = this, B = this.store; this._removeDeselectSignals && this._removeDeselectSignals(); if (B && B.notify) {
                                                                        var t = r.before(B, "notify", function (z, x) { z || h(z, x, "deselect") }); var u = r.after(B, "notify", function (z, x) { h(z, x, "select") }, !0); this._removeDeselectSignals =
                                                                                function () { t.remove(); u.remove() }
                                                                } else t = r.before(this, "removeRow", function (z, x) { x || (z = this.row(z)) && z.id in this.selection && this.deselect(z) }), this._removeDeselectSignals = function () { t.remove() }
                                                        }, allowSelect: function (h) { return !0 }, _fireSelectionEvent: function (h) { var p = this._selectionEventQueues[h], B = this._selectionTriggerEvent; var t = { bubbles: !0, grid: this }; B && (t.parentType = B.type); t[this._selectionTargetType] = p; this._selectionEventQueues[h] = []; w.emit(this.contentNode, "dgrid-" + h, t) }, _fireSelectionEvents: function () {
                                                                var h =
                                                                        this._selectionEventQueues, p; for (p in h) h[p].length && this._fireSelectionEvent(p)
                                                        }, _select: function (h, p, B) {
                                                                "undefined" === typeof B && (B = !0); h.element || (h = this.row(h)); if (!1 === B || this.allowSelect(h)) {
                                                                        var t = this.selection; var u = !!t[h.id]; null === B && (B = !u); var z = h.element; B || this.allSelected ? t[h.id] = B : delete this.selection[h.id]; z && (B ? n(z, ".dgrid-selected" + (this.addUiClasses ? ".ui-state-active" : "")) : n(z, "!dgrid-selected!ui-state-active")); B !== u && z && this._selectionEventQueues[(B ? "" : "de") + "select"].push(h);
                                                                        if (p) if (p.element || (p = this.row(p)), p) { if (p = p.element) for (t = this._determineSelectionDirection(z, p), t || (p = document.getElementById(p.id), t = this._determineSelectionDirection(z, p)); h.element != p && (h = this[t](h));)this._select(h, null, B) } else this._lastSelected = z, console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")
                                                                }
                                                        },
                                                _determineSelectionDirection: m("dom-comparedocumentposition") ? function (h, p) { h = p.compareDocumentPosition(h); return h & 1 ? !1 : 2 === h ? "down" : "up" } : function (h, p) { return 1 > p.sourceIndex ? !1 : p.sourceIndex > h.sourceIndex ? "down" : "up" }, select: function (h, p, B) { this._select(h, p, B); this._fireSelectionEvents() }, deselect: function (h, p) { this.select(h, p, !1) }, clearSelection: function (h, p) { this.allSelected = !1; for (var B in this.selection) h !== B && this._select(B, null, !1); p || (this._lastSelected = null); this._fireSelectionEvents() },
                                                selectAll: function () { this.allSelected = !0; this.selection = {}; for (var h in this._rowIdToObject) { var p = this.row(this._rowIdToObject[h]); this._select(p.id, null, !0) } this._fireSelectionEvents() }, getSelectedCount: function () { var h = 0, p; for (p in this.selection) p && (h += 1); return h }, isSelected: function (h) { if ("undefined" === typeof h || null === h) return !1; h.element || (h = this.row(h)); return h.id in this.selection ? !!this.selection[h.id] : this.allSelected && (!h.data || this.allowSelect(h)) }, refresh: function () {
                                                        this.deselectOnRefresh &&
                                                        this.clearSelection(); this._lastSelected = null; return this.inherited(arguments)
                                                }, renderArray: function () { var h = this, p = this.inherited(arguments); A.when(p, function (B) { var t = h.selection, u, z; for (u = 0; u < B.length; u++) { var x = h.row(B[u]); (z = x.id in t ? t[x.id] : h.allSelected) && h._select(x, null, z) } h._fireSelectionEvents() }); return p }
                                        })
                                })
                }, "xstyle/main": function () {
                        define("xstyle/main", ["require", "xstyle/core/parser", "xstyle/core/base", "xstyle/core/elemental", "xstyle/core/generate"], function (E, q, A, w, m) {
                                function v(n) {
                                        n =
                                        document.getElementsByTagName(n); for (var d = 0; d < n.length; d++)l(n[d])
                                } function r() { v("link"); v("style") } function l(n, d, c) {
                                        function g() { E(["xstyle/core/load-imports"], function (B) { B(n, function () { l(n, d, !0) }) }) } function b(B) { for (var t = B.cssRules, u = 0; u < t.length; u++) { var z = t[u]; if (z.selectorText && "x-" == z.selectorText.substring(0, 2) && (a = !0, /^'/.test(z.style.content))) return k(eval(z.style.content), B, d), !0 } } var e = n.sheet || n.styleSheet; if (e && (!e.processed || c)) {
                                                e.processed = !0; var a = e.needsParsing, f = e.rules ||
                                                        e.cssRules; if ((e.href || e.imports && e.imports.length) && !c) return g(); if (!a) for (var h = 0; h < f.length; h++) { var p = f[h]; if (p.href && !c) { if (!b(p.styleSheet)) return g(); return } } k(e.localSource || (e.ownerNode || e.owningElement).innerHTML, e, d)
                                        }
                                } function k(n, d, c) { d.addRule || (d.addRule = function (b, e, a) { return this.insertRule(b + "{" + e + "}", 0 <= a ? a : this.cssRules.length) }); d.deleteRule || (d.deleteRule = d.removeRule); var g = 1; (d.href || location.href).replace(/[^\/]+$/, ""); A.css = n; q(A, n, d); 0 == --g && c && c(d); return A } w.ready(r);
                                q.getStyleSheet = function (n, d) { return n.styleSheet || n }; return { process: l, processAll: r, parse: k, generate: m, update: w.update, load: function (n, d, c, g) { d(["xstyle/css"], function (b) { b.load(n, d, function (e) { e ? l({ sheet: e }, c) : (r(), c()) }, g) }) } }
                        })
                }, "xstyle/core/parser": function () {
                        define("xstyle/core/parser", [], function () {
                                function E() { this.push.apply(this, arguments) } function q(c) { this.value = c } function A() {
                                        var c = this.args[0]; if ("string" == typeof c) var g = c.split(/\s*,\s*/); else if (c) {
                                                g = []; for (var b = 0, e = 0; e < c.length + 1; e++) {
                                                        var a =
                                                                c[e]; if ("string" == typeof a || void 0 === a) if (a = a && a.split(/\s*,\s*/), 1 < g.length || void 0 === a) { var f = c.slice(b, e); 0 < b && f.unshift(g.pop()); b = e + 1; g.push(f); a && g.push.apply(g, a.slice(1)) }
                                                }
                                        } else return []; return g
                                } function w(c, g, b) {
                                        function e(p, B) {
                                                function t(T) { y = !1; var M = f.lastIndex; T.then(function () { y = !0; R && (f.lastIndex = M, u()) }); var R = !0 } function u() {
                                                        function T(Da) {
                                                                Da && "string" == typeof Da && ca && (Da = ca + Da); ia ? ia.push ? "string" == typeof ia[ia.length - 1] && "string" == typeof Da ? ia[ia.length - 1] += Da : Da && ia.push(Da) :
                                                                        "string" == typeof ia && "string" == typeof Da ? ia += Da : ia = new E(ia, Da) : ia = Da
                                                        } for (y = !0; y;) {
                                                                var M = f.exec(p); if (!M) break; var R = M[5], ca = M[1], K = M[2], Q = M[3], X = M[4]; X = X && n(X); K = K && n(K); if (N) { if (Q) { var W = K; var fa = Q.charAt(0); var ma = "?" == Q.charAt(1); -1 < Q.indexOf("\n") && (X = Q.slice(1)) } else X = K; var ia = X; N = !1 } else X = Q ? K + Q : K, T(X); "{" != R && (I += M[0]); switch (R) {
                                                                        case "'": case '"': var va = "'" == R ? m : v; va.lastIndex = f.lastIndex; (R = va.exec(p)) || z("unterminated string"); K = R[1].replace(/\\([a-fA-F\d]{0,5}[ a-fA-F\d]?)/g, function (Da,
                                                                                Ca) { if (Ca) return String.fromCharCode(parseInt(Ca, 16)) }); f.lastIndex = va.lastIndex; T(new q(K)); I += R[0]; continue; case "\\": R = va.lastIndex++; T(p.charAt(R)); continue; case "(": case "{": case "[": if ("{" == R) {
                                                                                        N = !0; ":" == fa && Q && (K += Q); K && ca && (K = ca + K); I = n((I + K).replace(/\s+/g, " ")); T(Q = x.newRule(I)); "\x3d" == fa && (H = !1, ia.creating = !0); var xa = null, na = D; M[6] && (X = B.cssRules || B.rules, Q.cssRule = xa = X[M[6].slice(1)]) && (I = xa.selectorText); if (x.root && H) for (X = B.cssRules || B.rules; xa = X[D++];)if (xa.selectorText == I || xa.selectorText &&
                                                                                                xa.selectorText.replace(/::/g, ":").replace(/'/g, '"') == I.replace(/::/g, ":").replace(/'/g, '"')) { Q.cssRule = xa; break } xa || (Q.ruleIndex = D = na); Q.styleSheet = B; ia.creating ? (Q.selector = "." + ("\x3d" == fa ? K.match(/[\w-]*$/g, "")[0] : "") + "-x-" + k++, Q.creating = !0) : /^@(?!font-face)(?!FONT-FACE)/.test(I) ? Q.setMediaSelector(I) : Q.selector = x.root ? I : x.selector + " " + I; I = ""
                                                                                } else K = X.match(/(.*?)([\w-]*)$/), T(Q = x.newCall(K[2], ia, x)), Q.ref = x.getDefinition(K[2]), Q.getArgs = A, (ia.calls || (ia.calls = [])).push(Q); x.currentName = W; x.currentSequence =
                                                                                        ia; x.assignmentOperator = fa; var ra; "{" == R && (ra = Q.selector.match(/[@:]\w+/)) && (ra = ra[0], (W = x.getDefinition(ra)) && W.selector && W.selector(Q)); h.push(x = Q); x.operator = R; x.start = f.lastIndex; ia = W = null; continue
                                                                }if (ia) if (K = "string" == typeof ia ? ia : ia[0], K.charAt && "@" == K.charAt(0)) if (M = K.match(/\w+/)[0], "import" == M) K = w.getStyleSheet((B.cssRules || B.imports)[D++], ia, B), M = f.lastIndex, e(K.localSource, K), f.lastIndex = M; else {
                                                                        if ("xstyle" == M) {
                                                                                if ("start" == K.slice(8, 13)) Q = x ? x.newRule("") : sa, Q.root = x.root, h.push(x = Q); else {
                                                                                        var sa =
                                                                                                x || sa; h.pop(); x = h[h.length - 1]
                                                                                } f = x ? a : /(@[\w\s])/g
                                                                        }
                                                                } else if ("\x3d" === fa) try { var wa = x.declareDefinition(W, ia, ma); wa && wa.then && t(wa) } catch (Da) { z(Da) } switch (R) {
                                                                        case ":": "\x3d" == fa ? (N = !0, fa = ":") : T(":"); break; case "}": if (W && !x.root && !x.isMediaBlock) try { x[":" == fa ? "setValue" : "declareDefinition"](W, ia, ma) } catch (Da) { z(Da) } case ")": case "]": l[x.operator] != R && z("Incorrect opening operator " + x.operator + " with closing operator " + R); W = null; W = p.slice(x.start, f.lastIndex - 1); x.cssText = x.cssText ? x.cssText + ";" + W : W; if ("}" ==
                                                                                R) { "}" == aa && (aa = x.parent.selector) && "@" == !aa.charAt(0) && z("A nested rule must end with a semicolon"); if (x.root) z("Unmatched " + R); else { try { x.onRule(x.selector, x) } catch (Da) { z(Da) } H = !0 } I = "" } if (")" == R || "]" == R) x.args = [ia]; if (")" == R && !fa) { try { wa = h[h.length - 2].onArguments && h[h.length - 2].onArguments(x) } catch (Da) { z(Da) } wa && wa.then && t(wa) } h.pop(); x = h[h.length - 1]; ia = x.currentSequence; W = x.currentName; fa = x.assignmentOperator; if (x.root && "}" == R) {
                                                                                        if (fa) try { x[":" == fa ? "setValue" : "declareDefinition"](W, ia, ma) } catch (Da) { z(Da) } N =
                                                                                                !0; fa = !1
                                                                                } break; case "": case void 0: return; case ";": if (x && W) { try { (wa = x[":" == fa ? "setValue" : "declareDefinition"](W, ia, ma)) && wa.then && t(wa) } catch (Da) { z(Da) } W } ia = null; N = !0; fa = H = !1; I = ""
                                                                }var aa = R
                                                        }
                                                } function z(T) { var M = p.slice(0, f.lastIndex).split("\n"), R = M[M.length - 1]; M = (B.href || "in-page stylesheet") + ":" + M.length + ":" + R.length + " near:\n" + R.slice(-40); if (e.onerror) e.onerror(T, M); console.error(T.message || T, M); T.stack && console.error(T.stack) } p = p.replace(r, function (T) { return T.replace(/[^\n]/g, "") }); var x = c; f.lastIndex =
                                                        0; var y, D = 0, H = !0, I = "", N = !0; u()
                                        } b = b || { addRule: function () { }, cssRules: [] }; var a, f = a = /(\s*)((?:[^{\}\[\]\(\)\\'":=;]|\[(?:[^\]'"]|'(?:\\.|[^'])*'|"(?:\\.|[^"])*")\])*)([=:]\??\s*([^{\}\[\]\(\)\\'":;]*))?(?:([{\}\[\]\(\)\\'":;])(\/\d+)?|$)/g, h = [c]; c.parse = e; e(g, b)
                                } var m = /((?:\\.|[^'])*)'/g, v = /((?:\\.|[^"])*)"/g, r = /\/\*[\w\W]*?\*\//g, l = { "{": "}", "[": "]", "(": ")" }, k = 0, n = "".trim ? function (c) { return c.trim() } : function (c) { return c.replace(/^\s+|\s+$/g, "") }, d = E.prototype = []; d.toString = function () { return this.join("") };
                                d.isSequence = !0; q.prototype.toString = function () { return '"' + this.value.replace(/["\\\n\r]/g, "\\$\x26") + '"' }; q.prototype.isLiteralString = !0; return w
                        })
                }, "xstyle/core/base": function () {
                        define("xstyle/core/base", "xstyle/core/elemental xstyle/core/expression xstyle/core/Definition xstyle/core/utils put-selector/put xstyle/core/Rule xstyle/core/es6".split(" "), function (E, q, A, w, m, v, r) {
                                function l(p, B, t) {
                                        function u(x) {
                                                return {
                                                        selectElement: function (y) {
                                                                t.newElement && (y = y.parentNode); if (x && x.selector) for (; !f(y,
                                                                        x);)if (y = y.parentNode, !y) throw Error("Rule not found"); if (t.inherit) for (; !(p in y);)if (y = y.parentNode, !y) throw Error(p ? p + " not found" : "Property was never defined"); return y
                                                        }, forElement: function (y) { var D = y; y = this.selectElement(y); t.newElement && (y["_" + p + "Node"] = D); y = t.get ? t.get(y, p) : y[p]; return void 0 === y && x ? c(p).valueOf().forRule(x) : y }, forRule: t.inherit && function (y) { return u(y) }
                                                }
                                        } var z = new A(function () { return u(B) }); z.define = function (x, y) { return l(p || y, x, t) }; z.keepCSSValue = !0; z.put = t.inherit ? function (x,
                                                y) { return c(p).put(x, y, p) } : function (x) { return { forElement: function (y) { if (B && B.selector) for (; !f(y, B);)if (y = y.parentNode, !y) throw Error("Rule not found"); t.set ? t.set(y, p, x) : y[p] = x; z.invalidate({ elements: [y] }) } } }; return z
                                } function k(p, B, t, u) { return w.when(q.evaluate(p, t), function (z) { z.forElement ? E.addRenderer(p, function (x) { u(z.forElement(x), x) }) : u(z) }) } function n(p, B) {
                                        return {
                                                apply: function (t, u, z) {
                                                        k(t, z, u[0], function (x, y) {
                                                                x.observe(function (D) {
                                                                        D = D ? p : B; value.toString().replace(new RegExp(p + "\\([^)]+\\)",
                                                                                "g"), D); y ? y.style[z] = D : t.setStyle(z, D)
                                                                })
                                                        })
                                                }
                                        }
                                } function d(p, B) { var t = p.variables; if (t && B in t) return t[B]; if (p = p.bases) for (t = 0; t < p.length; t++) { var u = d(p[t], B); if (void 0 !== u) return u } } function c(p) {
                                        var B = h[p]; B || (B = h[p] = new A(function () { return { forRule: function (t) { a: { do { var u = d(t, p); if (void 0 !== u) { t = u; break a } t = t.parent } while (t); t = void 0 } return t } } }), B.put = function (t, u, z) {
                                                return {
                                                        forRule: function (x) {
                                                                function y(H) { D.push(H); for (var I in H.rules) y(H.rules[I]) } (x.variables || (x.variables = {}))[z] = t; for (var D =
                                                                        []; x;)y(x), x = x.parent; B.invalidate({ rules: D })
                                                        }
                                                }
                                        }); return B
                                } var g = m("div"), b = navigator.userAgent, e = -1 < b.indexOf("WebKit") ? "-webkit-" : -1 < b.indexOf("Firefox") ? "-moz-" : -1 < b.indexOf("MSIE") ? "-ms-" : -1 < b.indexOf("Opera") ? "-o-" : "", a; v = new v; var f = E.matchesRule; v.root = !0; var h = {}; v.definitions = {
                                        Math: Math, window: window, global: window, module: q.selfResolving(function (p, B) { p[0].value && (p = p[0].value); B || require([p]); return { then: function (t) { return (new r.Promise(function (u) { require([p], function (z) { u(z) }) })).then(t) } } }),
                                        item: l("item", null, { inherit: !0 }), pageContent: new A, content: l("content", null, { inherit: !0, newElement: function () { return this.element } }), elementProperty: l(null, null, {}), elementClass: l(null, null, { get: function (p, B) { return -1 < (" " + p.className + " ").indexOf(" " + B + " ") }, set: function (p, B, t) { this.get(p, B) != t && (p.className = t ? p.className + (" " + B) : (" " + p.className + " ").replace(" " + B + " ", "").replace(/^ +| +$/g, "")) } }), element: {
                                                forElement: function (p) { return p }, define: function (p) {
                                                        return {
                                                                forElement: function (B) {
                                                                        for (; !f(B,
                                                                                p);)if (B = B.parentNode, !B) throw Error("Rule not found"); return B
                                                                }
                                                        }
                                                }
                                        }, event: { observe: function (p) { p(a) }, valueOf: function () { return a } }, each: { put: function (p) { return { forRule: function (B) { B.each = p } } } }, prefix: { put: function (p, B, t) { return { forRule: function (u) { if ("string" == typeof g.style[e + t]) return u._setStyleFromValue(e + t, p), !0 } } } }, "var": { define: function (p, B) { return c(B) }, selfResolving: !0, apply: function (p, B) { return c(w.convertCssNameToJs(B[0])) } }, inline: n("inline", "none"), block: n("block", "none"), visible: n("visible",
                                                "hidden"), "extends": { apply: function (p, B) { for (; 0 < B.length;)return w.extend(p, B[0], console.error) } }, set: { selfExecuting: !0, apply: function (p, B) { return B[0].put(B[1].valueOf()) } }, get: { apply: function (p, B) { return B[0] }, put: function (p, B) { q.evaluate(B, p) } }, toggle: { selfExecuting: !0, apply: function (p, B) { return B[0].put(!B[0].valueOf()) } }, on: {
                                                        put: function (p, B, t) {
                                                                return {
                                                                        forRule: function (u) {
                                                                                E.on(document, t.charAt(2).toLowerCase() + t.slice(3), u, function (z) {
                                                                                        a = z; try {
                                                                                                w.when(q.evaluate(u, p).valueOf(), function (x) {
                                                                                                        x && x.forRule &&
                                                                                                        (x = x.forRule(u)); x && x.forElement && (x = x.forElement(z.target)); a = null
                                                                                                }, function (x) { console.error("Error in " + t + " event handler, executing " + p, x) })
                                                                                        } catch (x) { console.error("Error in " + t + " event handler, executing " + p, x) }
                                                                                })
                                                                        }
                                                                }
                                                        }
                                                }, title: { put: function (p) { return { forRule: function (B) { q.observe(q.evaluate(B, p), function (t) { document.title = t }) } } } }, "@supports": {
                                                        selector: function (p) {
                                                                function B(t) {
                                                                        var u; if (u = t.match(/^\s*not(.*)/)) return !B(u[1]); if (u = t.match(/\((.*)\)/)) return B(u[1]); if (u = t.match(/([^:]*):(.*)/)) return t =
                                                                                w.convertCssNameToJs(u[1]), u = g.style[t] = u[2], g.style[t] == u; if (u = t.match(/\w+\[(.*)=(.*)\]/)) return m(u[0])[u[1]] == u[2]; if (u = t.match(/\w+/)) return w.isTagSupported(u); throw Error("can't parse @supports string");
                                                                } B(p.selector.slice(10)) ? p.selector = "" : p.disabled = !0
                                                        }
                                                }, "true": !0, "false": !1, "null": null
                                }; v.elementProperty = l; return v
                        })
                }, "xstyle/core/elemental": function () {
                        define("xstyle/core/elemental", ["put-selector/put", "xstyle/core/utils"], function (E, q) {
                                function A(z, x, y, D) {
                                        function H(I) {
                                                if (!y) return D(I);
                                                var N = I.target; do if (u(N, y)) return D(I); while ((N = N.parentNode) && 1 === N.nodeType)
                                        } c ? z.addEventListener(x, H, !!g[x]) : w(z, g[x] || x, H)
                                } function w(z, x, y) { x = "on" + x; var D = z[x]; z[x] = function (H) { H = H || window.event; H.target = H.target || H.srcElement; D && D(H); y(H) } } function m(z) { /e/.test(n.readyState || "") ? z() : n.addEventListener("DOMContentLoaded", z) } function v(z) {
                                        for (var x = n.querySelectorAll(z.selector), y = z.name, D = 0, H = x.length; D < H; D++) {
                                                var I = x[D], N = I.elementalStyle; N || (N = I.elementalStyle = {}, I.elementalSpecificities =
                                                        {}); var T = I.renderings; T || (T = I.renderings = [], p.push(I)); T.push({ name: y, rendered: N[y] == z.propertyValue, renderer: z }); N[y] = z.propertyValue
                                        }
                                } function r() { for (; p.length;) { for (var z = p.shift(), x = z.renderings, y = z.elementalStyle; x.length;) { var D = x.shift(), H = D.renderer, I = H.rendered; t = y[D.name] == H.propertyValue; if (!I && t) try { H.render(z) } catch (N) { console.error(N, N.stack), E(z, "div.error", N.toString()) } I && !t && H.unrender && H.unrender(z) } z.renderings = void 0 } } function l(z, x) {
                                        for (var y = 0, D = f.length; y < D; y++) {
                                                var H = f[y];
                                                x && x != H.selector || !u(z, H.rule) || H.render(z)
                                        }
                                } function k(z, x) { var y = { selector: z.selector, rule: z, render: x }; f.push(y); B && v(y); r(); return { remove: function () { f.splice(f.indexOf(y), 1) } } } var n = document, d = 1, c = !!n.addEventListener, g = { blur: "focusout", focus: "focusin" }; A(n, "change", null, function (z) {
                                        z = z.target; for (var x = 0, y = h.length; x < y; x++) {
                                                var D = h[x]; if (-1 < (" " + z.className + " ").indexOf(D.rule.selector.slice(1))) {
                                                        var H = D.definition.valueOf(); H && H.forRule && (H = H.forRule(D.rule)); H && H.forElement && (H = H.forElement(z));
                                                        var I = "checkbox" === z.type ? z.checked : z.value; "number" === typeof H && isFinite(I) && (I = +I); (H = D.definition.put(I)) && H.forRule && (H = H.forRule(D.rule)); H && H.forElement && H.forElement(z)
                                                }
                                        }
                                }); navigator.userAgent.match(/MSIE|Trident/) && A(n, "keydown", null, function (z) { if (13 == z.keyCode) { var x = z.target; if (document.createEvent) z = document.createEvent("Events"), z.initEvent("change", !0, !0), x.dispatchEvent(z); else document.onchange({ target: x }) } }); var b = n.createElement("div"), e = { "dom-qsa2.1": !!b.querySelectorAll }, a = b.matches ||
                                        b.matchesSelector || b.webkitMatchesSelector || b.mozMatchesSelector || b.msMatchesSelector || b.oMatchesSelector, f = [], h = [], p = [], B; m(function () { if (!B) if (B = !0, e["dom-qsa2.1"]) { for (var z = 0, x = f.length; z < x; z++)v(f[z]); r() } else { var y = n.all; z = 0; for (x = y.length; z < x; z++)l(y[z]) } }); var t, u = a ? function (z, x) { return a.call(z, x.selector) } : function (z, x) { x.ieId || x.setStyle(x.ieId = "x-ie-" + d++, "true"); return !!z.currentStyle[x.ieId] }; return {
                                                ready: m, on: A, matchesRule: u, addRenderer: k, addInputConnector: function (z, x) {
                                                        h.push({
                                                                rule: z,
                                                                definition: x
                                                        })
                                                }, update: l, clearRenderers: function () { f = [] }, observeForElement: function (z, x, y) { return q.when(z, function (D) { function H(I) { I.observe ? I.observe(y) : y(I) } D.forElement ? k(x, function (I) { H(D.forElement(I)) }) : H(D) }) }
                                        }
                        })
                }, "xstyle/core/utils": function () {
                        define("xstyle/core/utils", [], function () {
                                function E(m, v) { for (var r = 0, l = m.length; r < l; r++) { var k = m[r]; if (k && "object" == typeof k && v in k) return !0 } } function q(m, v) { return v.toUpperCase() } var A = "div" == document.createElement("div").tagName, w = {}; return {
                                        when: function (m,
                                                v, r) { return m && m.then ? m.then(v, r) || m : v(m) }, whenAll: function (m, v) { return E(m, "then") ? { then: function (r, l) { function k() { n--; n || r(v(d)) } for (var n = 1, d = [], c = 0; c < m.length; c++) { var g = m[c]; n++; g && g.then ? function (b) { g.then(function (e) { d[b] = e; k() }, l) }(c) : (d[c] = g, k()) } k() }, inputs: m } : v(m) }, convertCssNameToJs: function (m) { return m.replace(/-(\w)/g, q) }, isTagSupported: function (m) {
                                                        if (m in w) return w[m]; var v = document.createElement(m); A ? (v = v.toString(), v = !("[object HTMLUnknownElement]" == v || "[object]" == v)) : v = v.tagName ==
                                                                m.toUpperCase(); return w[m] = v
                                                }, extend: function (m, v) { var r = v.split("."); v = r[0]; var l = m.getDefinition(v, "rules"); r[0] = ""; m.selector += m.extraSelector = r.join("."); if (l) return this.when(l, function (k) { if (k.extend) k.extend(m, !0); else for (var n in k) m[n] = k[n] }); m.tagName = v; if (!this.isTagSupported(v)) throw Error("Extending undefined definition " + v); }, someHasProperty: E
                                }
                        })
                }, "xstyle/core/expression": function () {
                        define("xstyle/core/expression", ["xstyle/core/utils", "xstyle/core/Definition"], function (E, q) {
                                function A(b,
                                        e) { var a = e[0]; return a && b ? (a = k(a), A(b.property ? b.property(a) : b[a], e.slice(1))) : b } function w(b, e, a) { if (n(e, b)) { var f = {}; f[b] = function (h) { for (var p = [], B = 0, t = e.length; B < t; B++) { var u = e[B]; u && "function" == typeof u[b] && (u = u[b](h)); p[B] = u } return a(p) }; return f } return a(e) } function m(b, e) {
                                                return {
                                                        apply: function (a, f, h) {
                                                                for (var p = 0, B = f.length; p < B; p++) { var t = f[p]; t.dependencyOf && t.dependencyOf(h) } p = function () {
                                                                        var u = []; if (b.selfExecuting) return b.apply(a, f, h); for (var z = 0, x = f.length; z < x; z++)u[z] = f[z].valueOf();
                                                                        if (b.selfWaiting) return b.apply(a, u, h); u.push(a); return E.whenAll(u, function (y) { var D = y.pop(); return w("forRule", y, function (H) { return w("forElement", H, function (I) { return b.apply(D, I, h) }) }) })
                                                                }; p.reverse = function (u) { return e(u, f) }; return p
                                                        }
                                                }
                                        } function v(b) { return c[b] || (c[b] = new Function("a", "b", "return " + b)) } function r(b, e, a, f, h) {
                                                function p(u) { u.skipResolve = !0; u.precedence = e; u.infix = !1 !== h } var B = function (u, z) {
                                                        var x = z[0]; z = z[1]; if (x && x.put) u = f(u, z && z.valueOf()), u !== d && x.put(u); else if (z && z.put) z.put(h(u,
                                                                x && x.valueOf())); else throw new TypeError("Can not put");
                                                }, t = { apply: function (u, z, x) { var y; a = v(a); f = f && v(f); h = h && v(h); g[b] = y = m(a, B); p(y); return y.apply(u, z, x) } }; p(t); g[b] = t
                                        } function l(b, e) {
                                                function a(y) { for (; z <= y.precedence;) { var D = B.pop(), H = g[B.pop()], I = new q; I.setCompute(H.apply(null, H.infix ? [B.pop(), D] : [D], I)); t = B.length ? B[B.length - 1] : void 0; B.push(I); z = t && g[t] && g[t].precedence } } var f; e = e.join ? e.slice() : [e]; for (f = 0; f < e.length; f++) {
                                                        var h = e[f]; if ("string" == typeof h) {
                                                                var p = h.match(/"[^"]*"|[+\-<>\|\/\?:^*!&|]+|[\w_$\.\/-]+/g);
                                                                h = [f, 1]; p && h.push.apply(h, p); e.splice.apply(e, h); f += h.length - 3
                                                        }
                                                } var B = [], t; p = {}; for (f = 0; f < e.length; f++) {
                                                        h = e[f]; if ("(" == h.operator) {
                                                                var u = B[B.length - 1]; void 0 === u || g.hasOwnProperty(u) ? h = l(b, h.getArgs()[0]) : (B.pop(), h = function (y, D) {
                                                                        function H(M) { return E.when(y.valueOf(), function (R) { var ca = y.parent && y.parent.valueOf(); if (!R.selfResolving) { if (!I) { I = []; for (var K = 0, Q = D.length; K < Q; K++)I[K] = l(b, D[K]); N = R.selfReacting ? R.apply(ca, I, T) : m(R).apply(ca, I, T) } return N() } R = R.apply(ca, D, T); return M ? R : R.valueOf() }) }
                                                                        var I, N, T = new q(H); T.setReverseCompute(function () { var M = arguments; return E.when(H(!0), function (R) { return R.put.apply(R, M) }) }); return T
                                                                }(u, h.getArgs()))
                                                        } else if (g.hasOwnProperty(h)) { u = g[h]; a(u); var z = (t || u).precedence } else if (-1 < h) h = +h; else if (h.isLiteralString) h = h.value; else { h = h.split(/\s*\/\s*/); u = h[0]; var x = b.getDefinition(u); if ("string" == typeof x || x instanceof Array) x = l(b, x); else if (void 0 === x) throw Error('Could not find reference "' + u + '"'); p[u] = x; 1 < h.length && (x = A(x, h.slice(1))); h = x } B.push(h)
                                                } a({ precedence: 100 });
                                                if (1 < B.length) throw Error("Could not reduce expression"); h = B[0]; h.inputs = p; return h
                                        } var k = E.convertCssNameToJs, n = E.someHasProperty, d = {}, c = {}, g = {}; r("+", 6, "a+b", "a-b", "a-b"); r("-", 6, "a-b", "a+b", "b-a"); r("*", 5, "a*b", "a/b", "a/b"); r("/", 5, "a/b", "a*b", "b/a"); r("?", 16, "b[a?0:1]", "a\x3d\x3d\x3db[0]||(a\x3d\x3d\x3db[1]?false:deny)", "[a,b]"); r(":", 15, "[a,b]", "a[0]?a[1]:deny", "a[1]"); r("!", 4, "!a", "!a", !1); r("%", 5, "a%b"); r("\x3e", 8, "a\x3eb"); r("\x3e\x3d", 8, "a\x3e\x3db"); r("\x3c", 8, "a\x3cb"); r("\x3c\x3d", 8, "a\x3c\x3db");
                                r("\x3d\x3d", 9, "a\x3d\x3d\x3db"); r("\x26", 8, "a\x26\x26b"); r("|", 8, "a||b"); return { react: m, evaluate: l, selfResolving: function (b) { b.selfResolving = !0; return b } }
                        })
                }, "xstyle/core/Definition": function () {
                        define(["xstyle/core/utils", "xstyle/core/es6"], function (E, q) {
                                function A(l) { (this.computeValue = l) && l.reverse && this.setReverseCompute(l.reverse) } function w(l, k, n) {
                                        if (k && k.forElement) return {
                                                forElement: function (d) {
                                                        d = k.selectElement ? k.selectElement(d) : d; var c = ["_cache_" + l.id]; if (c in d) {
                                                                var g = d[c + "observe"]; g.addKey &&
                                                                        g.addKey(n); return d[c][n]
                                                        } var b = d[c] = k.forElement(d), e = d[c + "observe"] = m(l, b, n, { elements: [d] }); d.xcleanup = function (a) { a && q.unobserve(b, e) }; return b[n]
                                                }
                                        }
                                } function m(l, k, n, d) { var c = l._properties; if ("object" == typeof k) { var g = function (b) { for (var e = 0; e < b.length; e++) { var a = c[b[e].name]; a && a.invalidate && a.invalidate(d) } }; q.observe(k, g); g.addKey && g.addKey(n) } return g } var v = {}, r = 1; A.prototype = {
                                        id: "x-variable-" + r++, cache: v, valueOf: function () {
                                                if ((this.dependents || this._properties) && this.cache !== v) return this.cache;
                                                var l = this, k = this.computeValue; if (k.then) return this.cache = k.then(function (n) { l.computeValue = n; (n = l.cache = n()) && n.then && n.then(function (d) { l.cache = d }); return n }); (k = l.cache = k()) && k.then && k.then(function (n) { l.cache = n }); return k
                                        }, property: function (l) {
                                                var k = this._properties || (this._properties = {}), n = k[l]; if (!n) {
                                                        var d = this; n = k[l] = new A(function () {
                                                                return E.when(d.valueOf(), function (c) {
                                                                        if (c && c.forRule) return {
                                                                                forRule: function (b) {
                                                                                        b = c.selectRule ? c.selectRule(b) : b; var e = ["_cache_" + d.id], a; if ((a = e in b ? b[e] :
                                                                                                b[e] = c.forRule(b)) && a.forElement) return w(d, a, l); var f = b[e + "observe"]; f && (f.addKey ? f.addKey(l) : b[e + "observe"] = m(d, a, l, { rules: [b] })); return a[l]
                                                                                }
                                                                        }; if (c && c.forElement) return w(d, c, l); var g = d.cacheObserve; g ? g.addKey && g.addKey(l) : g = d.cacheObserve = m(d, c, l); return c[l]
                                                                })
                                                        }); n.key = l; n.parent = this; n.put = function (c) {
                                                                return E.when(d.valueOf(), function (g) {
                                                                        function b(e) { if (e.forElement) return { forElement: function (a) { e.forElement(a)[l] = c } }; e[l] = c } if (g.forRule) return { forRule: function (e) { return b(g.forRule(e)) } };
                                                                        b(g)
                                                                })
                                                        }; n.id = this.id + "-" + l
                                                } return n
                                        }, invalidate: function (l) { var k = this.cacheObserve; k && (q.unobserve(this.cache, k), this.cacheObserve = null); this.cache = v; k = this._properties; for (d in k) k[d].invalidate(l); var n = this.dependents || 0; var d = 0; for (k = n.length; d < k; d++)try { n[d].invalidate(l) } catch (c) { console.error(c, "invalidating a definition") } }, dependencyOf: function (l) { (this.dependents || (this.dependents = [])).push(l) }, notDependencyOf: function (l) {
                                                for (var k = this.dependents || 0, n = 0; n < k.length; n++)k[n] === l && k.splice(n--,
                                                        1)
                                        }, setReverseCompute: function (l) { this.put = function () { var k = l.apply(this, arguments); this.invalidate(); return k } }, setCompute: function (l) { (this.computeValue = l) && l.reverse && this.setReverseCompute(l.reverse); this.invalidate() }, setSource: function (l) { this.computeValue = function () { return l }; this.invalidate() }, observe: function (l) { this.computeValue && l(this.valueOf()); var k = this; return this.dependencyOf({ invalidate: function () { l(k.valueOf()) } }) }, newElement: function () {
                                                return E.when(this.valueOf(), function (l) {
                                                        return l &&
                                                                l.newElement && l.newElement()
                                                })
                                        }
                                }; return A
                        })
                }, "xstyle/core/es6": function () {
                        define("xstyle/core/es6", [], function () {
                                function E(g, b, e) { v ? -1 === v.indexOf(g) && v.push(g) : (v = [g], setTimeout(function () { v.forEach(function (a) { var f = []; a.properties.forEach(function (h) { f.push({ target: a.object, name: h }) }); a(f); a.object = null; a.properties = null }); v = null }, 0)); g.object = b; g = g.properties || (g.properties = []); -1 === g.indexOf(e) && g.push(e) } function q() { return q } var A = Object.observe, w; if (w = Object.defineProperty) a: {
                                        try {
                                                Object.defineProperty({},
                                                        "t", {}); w = !0; break a
                                        } catch (g) { } w = void 0
                                } var m = { observe: A, defineProperty: w, promise: "undefined" !== typeof Promise, WeakMap: "function" === typeof WeakMap }; A = m.observe ? Object.observe : m.defineProperty ? function (g, b) {
                                        b.addKey = function (e) {
                                                var a = "key" + e; if (!this[a]) {
                                                        this[a] = !0; var f = g[e]; if ((a = Object.getOwnPropertyDescriptor(g, e)) && a.set) { var h = a.set, p = a.get; Object.defineProperty(g, e, { get: function () { return f = p.call(this) }, set: function (B) { h.call(this, B); f !== B && (f = B, b && E(b, this, e)) } }) } else Object.defineProperty(g,
                                                                e, { get: function () { return f }, set: function (B) { f !== B && (f = B, b && E(b, this, e)) } })
                                                }
                                        }; b.remove = function () { b = null }
                                } : function (g, b) { n || (n = !0, setInterval(function () { for (var f = 0, h = r.length; f < h; f++) { var p = void 0, B = void 0, t = l[f], u = r[f], z = k[f]; for (p in t) t.hasOwnProperty(p) && t[p] !== u[p] && (t[p] = u[p], (B || (B = [])).push({ name: p })); for (p in u) u.hasOwnProperty(p) && !t.hasOwnProperty(p) && (t[p] = u[p], (B || (B = [])).push({ name: p })); B && z(B) } }, 20)); var e = {}, a; for (a in g) g.hasOwnProperty(a) && (e[a] = g[a]); r.push(g); l.push(e); k.push(b) };
                                var v; w = m.observe ? Object.unobserve : function (g, b) { b.remove && b.remove(); for (var e = 0, a = r.length; e < a; e++)if (r[e] === g && k[e] === b) { r.splice(e, 1); l.splice(e, 1); k.splice(e, 1); break } }; var r = [], l = [], k = [], n = !1, d = 1, c = function () { }; c.prototype.toJSON = q; return {
                                        Promise: m.promise ? Promise : function () {
                                                function g(b) {
                                                        function e(u) { u && u.then ? u.then(e, a) : (p = u, f()) } function a(u) { B = u; f() } function f() { h = !0; for (var u = 0, z = t.length; u < z; u++)t[u](); t = 0 } var h, p, B, t = 0; b(e, a); return {
                                                                then: function (u, z) {
                                                                        return new g(function (x, y) {
                                                                                function D() {
                                                                                        try {
                                                                                                B &&
                                                                                                !z ? y(B) : x(B ? z(B) : u ? u(p) : p)
                                                                                        } catch (H) { y(H) }
                                                                                } h ? D() : (t || (t = [])).push(D)
                                                                        })
                                                                }
                                                        }
                                                } return g
                                        }(), WeakMap: m.WeakMap ? WeakMap : function (g, b) { var e = "__" + (b || "") + d++; return m.defineProperty ? { get: function (a) { return a[e] }, set: function (a, f) { Object.defineProperty(a, e, { value: f, enumerable: !1 }) } } : { get: function (a) { return (a = a[e]) && a.value }, set: function (a, f) { (a[e] || (a[e] = new c)).value = f } } }, observe: A, unobserve: w, copy: function (g, b) { for (var e in b) g[e] = b[e]; return g }
                                }
                        })
                }, "xstyle/core/Rule": function () {
                        define("xstyle/core/Rule", ["xstyle/core/expression",
                                "xstyle/core/Definition", "put-selector/put", "xstyle/core/es6", "xstyle/core/utils"], function (E, q, A, w, m) {
                                        function v(f, h, p) { try { f[h] = p } catch (B) { } } function r() { } function l(f, h, p, B) {
                                                if (f.calls) { var t; for (p = 0; p < f.length; p++) { var u = f[p]; if (u instanceof k) { f.hasOwnProperty(p) || (f[p] = u = c(u)); var z = u.ref && (u.ref.selfResolving ? u.ref.apply(h, u.getArgs(), h) : E.evaluate(h, [u.caller, u])); void 0 !== z && ((t || (t = [])).push(z), u.evaluated = !0) } } } if (t) return h = E.react(function () {
                                                        for (var x = 0, y = f.slice(), D = 0; D < f.length; D++) {
                                                                var H =
                                                                        f[D]; H instanceof k && H.evaluated && (y[D - 1] = f[D - 1].slice(0, -H.caller.length), y[D] = arguments[x++])
                                                        } return y.join("")
                                                }), h.skipResolve = !0, B = new q, B.setCompute(h.apply(B, t, B)), B; if (!B) return f.toString()
                                        } function k(f) { this.caller = f; this.args = [] } function n(f, h, p, B) { return m.when(h, function (t) { var u = t; t && t.forRule && ((f._subRuleListeners || (f._subRuleListeners = [])).push(function (z) { var x = u.forRule(z, !0); x && x.forElement ? d(z, x, B) : p && p(x) }), t = t.forRule(f)); if (t && t.forElement) return d(f, t, B); p && p(t) }) } function d(f,
                                                h, p) { return require(["xstyle/core/elemental"], function (B) { B.addRenderer(f, function (t) { var u = h.forElement(t); p && p(u, t) }) }) } var c = Object.create || function (f) { function h() { } h.prototype = f; return new h }, g = m.convertCssNameToJs, b = { "{": "}", "[": "]", "(": ")" }, e = A("div").style; r.prototype = {
                                                        property: function (f) { return (this._properties || (this._properties = {}))[f] || (this._properties[f] = new Proxy(this.get(f))) }, eachProperty: function (f) {
                                                                for (var h = this.values || 0, p = 0; p < h.length; p++) {
                                                                        var B = h[p]; f.call(this, B || "unnamed",
                                                                                h[B])
                                                                }
                                                        }, fullSelector: function () { return (this.parent ? this.parent.fullSelector() : "") + (this.selector || "") + " " }, newRule: function (f) { f = (this.rules || (this.rules = {}))[f] = new r; f.disabled = this.disabled; f.parent = this; return f }, newCall: function (f) { f = new k(f); f.parent = this; return f }, addSheetRule: function (f, h) {
                                                                if ("@" != f.charAt(0)) {
                                                                        var p = this.styleSheet, B = p.cssRules || p.rules, t = -1 < this.ruleIndex ? this.ruleIndex : B.length; try { p.addRule(f, h || " ", t) } catch (u) {
                                                                                f.match(/-(moz|webkit|ie)-/) || console.warn("Unable to add rule",
                                                                                        f, h)
                                                                        } return B[t]
                                                                }
                                                        }, onRule: function () { var f = this.getCssRule(); if (this.installStyles) for (var h = 0; h < this.installStyles.length; h++) { var p = this.installStyles[h]; v(f.style, p[0], p[1]) } }, setMediaSelector: function (f) { this.isMediaBlock = !0; this.selector = f }, setStyle: function (f, h) { this.cssRule ? v(this.cssRule.style, f, h) : (this.installStyles || (this.installStyles = [])).push([f, h]) }, getCssRule: function () { this.cssRule || (this.cssRule = this.addSheetRule(this.selector, this.cssText)); return this.cssRule }, get: function (f) { return this.values[f] },
                                                        elements: function (f) { var h = this; require(["xstyle/core/elemental"], function (p) { p.addRenderer(h, function (B) { f(B) }) }) }, declareDefinition: function (f, h, p) {
                                                                f = f && g(f); if (!this.disabled) {
                                                                        var B = this; if (h.length) if ("\x3e" == h[0].toString().charAt(0)) f || (this.generator = h, require(["xstyle/core/generate", "xstyle/core/elemental"], function (H, I) { h = H.forSelector(h, B); I.addRenderer(B, h) })); else {
                                                                                var t = f in e || this.getDefinition(f); if (!p || !t) {
                                                                                        p = this.definitions || (this.definitions = {}); var u = h[0]; if (u.indexOf && -1 < u.indexOf(",")) {
                                                                                                u =
                                                                                                h.join("").split(/\s*,\s*/); for (var z = [], x = 0; x < u.length; x++)z[x] = E.evaluate(this, u[x])
                                                                                        } h[0] && "{" == h[0].operator ? z = h[0] : h[1] && "{" == h[1].operator && (z = h[1], m.extend(z, h[0])); z = z || E.evaluate(this, h); if (z.then) { var y = z; z = { then: function (H) { return y.then(function (I) { return H(D(I)) }) } } } var D = function (H) { H.define && (H = H.define(B, f)); return H }; t && console.warn('Overriding existing property "' + f + '"'); return p[f] = D(z)
                                                                                }
                                                                        } else return p = this.definitions || (this.definitions = {}), p[f] = h
                                                                }
                                                        }, onArguments: function (f) {
                                                                var h =
                                                                        f.ref; return h && h.apply(this, f.getArgs(), this)
                                                        }, setValue: function (f, h, p) { var B = g(f); if (!this.disabled) { var t = this.values || (this.values = []); t.push(f); t[f] = h; if (f) { do { t = (p || this).getDefinition(f); if (void 0 !== t) { if (this.cssRule && (!t || !t.keepCSSValue)) { var u = this.cssRule.style; B in u && v(u, B, "") } n(this, t.put(h, this, B)) } f = f.substring(0, f.lastIndexOf("-")) } while (f) } B in e && this._setStyleFromValue(B, h, !0) } }, _setStyleFromValue: function (f, h, p) {
                                                                var B = h[0]; if (B instanceof r) for (p = B.values, B = 0; B < p.length; B++) {
                                                                        var t =
                                                                                p[B]; this._setStyleFromValue(f + ("main" == t ? "" : t.charAt(0).toUpperCase() + t.slice(1)), p[t])
                                                                } else {
                                                                        if (h.calls) {
                                                                                var u = this; if (h.expression = l(h, this, f, !0)) {
                                                                                        var z = h.expression && h.expression.valueOf(), x = function (D, H) { var I = z && z.forRule ? z.forRule(D, !0) : z; if (I && I.forElement) if (H = H && H.elements) for (var N = 0; N < H.length; N++)for (var T = H[N].querySelectorAll(D.selector), M = 0; M < T.length; M++) { var R = T[M]; v(R.style, f, I.forElement(R)) } else d(D, I, function (ca, K) { v(K.style, f, ca) }); else D.setStyle(f, I) }, y = [u]; m.when(z, function (D) {
                                                                                                (z =
                                                                                                        D) && z.forRule && (u._subRuleListeners || (u._subRuleListeners = [])).push(function (H) { y.push(H); x(H) }); x(u)
                                                                                        }); h.expression.dependencyOf({ invalidate: function (D) { m.when(h.expression.valueOf(), function (H) { z = H; for (H = 0; H < y.length; H++) { var I = !0, N = y[H]; if (D && D.rules) { I = !1; for (var T = 0; T < D.rules.length; T++)if (D.rules[T] === N) { I = !0; break } } I && x(N, D) } }) } })
                                                                                }
                                                                        } p || this.setStyle(f, h)
                                                                }
                                                        }, put: function (f) {
                                                                var h = this; return {
                                                                        forRule: function (p) {
                                                                                h.extend(p); if ("defaults" != f && f && "string" == typeof f && h.values) for (var B = f.toString().split(/,\s*/),
                                                                                        t = 0; t < B.length; t++) { var u = h.values[t]; u && p.setValue(u, B[t], h) }
                                                                        }
                                                                }
                                                        }, extend: function (f, h) {
                                                                (this.derivatives || (this.derivatives = [])).push(f); var p = this.extraSelector; p && (f.selector += p); var B = this.cssRule.style, t = f.getCssRule().style, u = f.inheritedStyles || (f.inheritedStyles = {}); for (p = 0; p < B.length; p++) { var z = g(B[p]); if (!t[z] || u[z]) t[z] = B[z], u[z] = !0 } if (p = this.values) { p = c(p); var x = f.values; f.values = x ? w.copy(p, x) : p } if (h) {
                                                                        if (p = this.definitions) { p = c(p); var y = f.definitions; f.definitions = y ? w.copy(p, y) : p } f.tagName =
                                                                                this.tagName || f.tagName
                                                                } (f.bases || (f.bases = [])).push(this); h = this._subRuleListeners || 0; for (p = 0; p < h.length; p++)h[p](f); var D = f.getCssRule().style; this.eachProperty(function (H, I) { H = g(H); "object" == typeof I && (I = c(I)); H in e && !D[H] && f._setStyleFromValue(H, I) }); if (x && f.definitions) for (p = 0, h = x.length; p < h; p++)z = x[p], B = g(z), f.definitions[B] !== (y && y[B]) && f.setValue(z, x[B]); if (x = this.generator) {
                                                                        if (x instanceof Array) for (x = x.slice(0), p = 0; p < x.length; p++)y = x[p], "{" === y.operator && (h = f.newRule(), h.selector = y.selector +
                                                                                f.selector.slice(1), h.styleSheet = f.styleSheet || f.cssRule.parentStyleSheet, y.extend(h, !0), x[p] = h); f.declareDefinition(null, x)
                                                                }
                                                        }, getDefinition: function (f, h) { f = g(f); var p = this; do { var B = p.definitions && p.definitions[f]; void 0 === B && h && p[h] && (B = p[h][f]); p = p.parent } while (void 0 === B && p); return B }, newElement: function () { return A((this.tagName || "span") + (this.selector || "")) }, cssText: ""
                                                }; E.evaluateText = l; var a = k.prototype = new r; a.declareDefinition = a.setValue = function (f, h) { this.args.push(h) }; a.toString = function () {
                                                        var f =
                                                                this.operator; return f + this.args + b[f]
                                                }; r.updateStaleProperties = function () { }; return r
                                })
                }, "xstyle/core/generate": function () {
                        define("xstyle/core/generate", ["xstyle/core/elemental", "put-selector/put", "xstyle/core/utils", "xstyle/core/expression", "xstyle/core/base"], function (E, q, A, w, m) {
                                function v(f, h) {
                                        f = f.sort ? f : [f]; return function (p, B, t) {
                                                var u = p, z; "content" in p || (p.content = void 0); if (void 0 === t) {
                                                        var x = (p._contentNode || p).childNodes || 0, y = x[0]; if (y) {
                                                                var D = e.createDocumentFragment(); do D.appendChild(y); while (y =
                                                                        x[0]); p.content = D
                                                        } if (p._contentNode) { p._contentNode = void 0; try { p.innerHTML = "" } catch (ma) { } }
                                                } var H = 0, I = [p], N = []; x = 0; for (y = f.length; x < y; x++) {
                                                        var T = M, M = f[x]; try {
                                                                if (M.eachProperty) {
                                                                        if (M.args) if ("(" == M.operator) { var R = f[x + 1]; r(M, R, u, function (ma, ia, va) { n(ma, ia, va, h) }) } else {
                                                                                var ca = M.args[0]; if ("string" === typeof ca) { var K = ca.split("\x3d"); try { u.setAttribute(K[0], K[1]) } catch (ma) { console.error(ma) } } else {
                                                                                        var Q = ca[0].replace(/=$/, ""), X = ca[1]; "(" == X.operator ? r(ca[1], Q, u, function (ma, ia, va) { k(ma, ia, va, h) }) : u.setAttribute(Q,
                                                                                                X.value)
                                                                                }
                                                                        }
                                                                } else if ("string" == typeof M) {
                                                                        "\x3d" == M.charAt(0) && (M = M.slice(1)); var W = u; R = f[x + 1]; K = []; M.replace(/([,\n]+)?([\t ]*)?(\.|#)?([-\w%$|\.#]+)(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g, function () { K.push(arguments) }); for (var fa = 0; fa < K.length; fa++)(function (ma, ia, va, xa, na, ra, sa) {
                                                                                function wa() { var Ca = W._contentNode; Ca && (Ca.innerHTML = "", W = Ca) } ia ? (ma = va ? va.length : 0, ma > H ? (wa(), I[ma] = W) : W = I[ma] || W, H = ma) : wa(); if (xa) var aa = (T && T.args ? "" : "span") + xa + na; else {
                                                                                        xa = na.match(/^[-\w]+/); if (!xa) throw new SyntaxError("Unable to parse selector",
                                                                                                na); xa = xa[0]; if (fa === K.length - 1 && R && R.selector) { R.bases || A.extend(R, xa); var Da = R } else Da = h.getDefinition(xa); Da && (Da.then || Da.newElement) ? W = function (Ca, O, C, G) { var L; A.when(Da && Da.newElement && Da.newElement(), function (S) { (L = S) ? (C = C.slice(G.length)) && q(L, C) : L = q(C); if (P) { P.parentNode.replaceChild(L, P); S = P.childNodes; var Y; for (L = L._contentNode || L; Y = S[0];)L.appendChild(Y) } }); if (L) return Ca.insertBefore(L, O || null); var P = q("span"); return Ca.insertBefore(P, O || null) }(W, t, na, xa) : aa = na
                                                                                } aa && (W = q(t || W, (t ? "-" : "") +
                                                                                        aa)); t = null; ra && W.setAttribute(ra, "" === sa ? ra : sa); B && (W.item = B); z = z || W; (fa < K.length - 1 || W != u && W != p) && N.push(fa == K.length - 1 && R && R.selector, W); u = W
                                                                        }).apply(this, K[fa])
                                                                } else u.appendChild(e.createTextNode(M.value))
                                                        } catch (ma) { console.error(ma, ma.stack), u.innerHTML && (u.innerHTML = ""), u.appendChild(e.createTextNode(ma)) }
                                                } for (; M = N.pop();)E.update(M, N.pop()); return z
                                        }
                                } function r(f, h, p, B) {
                                        var t; if (h && h.eachProperty) { q(p, t = h.selector); var u = h } else q(p, t = f.selector || (f.selector = ".-xbind-" + a++)), u = f; var z = f.getArgs()[0],
                                                x = f.expressionResult, y = f.expressionDefinition; y || (y = f.expressionDefinition = w.evaluate(f.parent, z), x = y.valueOf(), E.addInputConnector(u, y), function (D, H, I) { f.expressionResult = x; I.dependencyOf && I.dependencyOf({ invalidate: function (N) { N = N ? E.matchesRule(N.elements[0], u) ? N.elements : N.elements[0].querySelectorAll(H) : document.querySelectorAll(H); for (var T = 0, M = N.length; T < M; T++)B(N[T], D, I.valueOf()) } }) }(h, t, y)); B(p, h, x)
                                } function l(f, h, p, B) {
                                        return A.when(f, function (t) {
                                                t && t.forRule && (t = t.forRule(h)); t && t.forElement &&
                                                        (t = t.forElement(p)); B(t)
                                        })
                                } function k(f, h, p, B) { l(p, B, f, function (t) { f.setAttribute(h, t) }) } function n(f, h, p, B) {
                                        f._defaultBinding = !0; if (p && p.then && "INPUT" !== f.tagName) try { f.appendChild(e.createTextNode("Loading")) } catch (t) { } l(p, B, f, function (t) {
                                                if (f._defaultBinding) if (d(f), f.childNodes.length && (f.innerHTML = ""), t && t.sort) if (t.isSequence) v(t, B)(f); else {
                                                        var u = h && h.definitions && h.definitions.each, z = B.newRule(); u = u ? v(u, z) : function (H, I, N) { return q(N || H, (N ? "-" : "") + (g[H.tagName] || "span"), "" + I) }; var x = []; if (t.track) {
                                                                t =
                                                                t.track(); var y = t.tracking
                                                        } t.forEach(function (H) { x.push(u(f, H, null)) }); if (t.on) var D = t.on("add,delete,update", function (H) { var I = H.target, N = H.previousIndex; H = H.index; if (-1 < N) { var T = x[N]; d(T, !0); T.parentNode.removeChild(T); x.splice(N, 1) } -1 < H && x.splice(H, 0, u(f, I, x[H] || null)) }); if (y = y || D) f.xcleanup = function () { y.remove() }
                                                } else t && t.nodeType ? f.appendChild(t) : (t = void 0 === t ? "" : t, f.tagName in b ? "checkbox" === f.type ? f.checked = t : f.value = t : f.appendChild(e.createTextNode(t)))
                                        })
                                } function d(f, h) {
                                        f.xcleanup && f.xcleanup(h);
                                        f = f.getElementsByTagName("*"); h = 0; for (var p = f.length; h < p; h++) { var B = f[h]; B.xcleanup && B.xcleanup(!0) }
                                } function c(f, h) { return v(h, m)(f) } var g = { TABLE: "tr", TBODY: "tr", TR: "td", UL: "li", OL: "li", SELECT: "option" }, b = { INPUT: 1, TEXTAREA: 1, SELECT: 1 }, e = document, a = 1; c.forSelector = v; return c
                        })
                }, "dojo/dnd/Source": function () {
                        define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "), function (E, q, A, w, m, v, r, l,
                                k, n, d, c) {
                                        A.isAsync || l(0, function () { require(["dojo/dnd/AutoSource", "dojo/dnd/Target"]) }); var g = q("dojo.dnd.Source", d, {
                                                isSource: !0, horizontal: !1, copyOnly: !1, selfCopy: !1, selfAccept: !0, skipForm: !1, withHandles: !1, autoSync: !1, delay: 0, accept: ["text"], generateText: !0, constructor: function (b, e) {
                                                        w.mixin(this, w.mixin({}, e)); b = this.accept; if (b.length) for (this.accept = {}, e = 0; e < b.length; ++e)this.accept[b[e]] = 1; this.mouseDown = this.isDragging = !1; this.targetBox = this.targetAnchor = null; this.before = !0; this._lastY = this._lastX =
                                                                0; this.sourceState = ""; this.isSource && m.add(this.node, "dojoDndSource"); this.targetState = ""; this.accept && m.add(this.node, "dojoDndTarget"); this.horizontal && m.add(this.node, "dojoDndHorizontal"); this.topics = [k.subscribe("/dnd/source/over", w.hitch(this, "onDndSourceOver")), k.subscribe("/dnd/start", w.hitch(this, "onDndStart")), k.subscribe("/dnd/drop", w.hitch(this, "onDndDrop")), k.subscribe("/dnd/cancel", w.hitch(this, "onDndCancel"))]
                                                }, checkAcceptance: function (b, e) {
                                                        if (this == b) return !this.copyOnly || this.selfAccept;
                                                        for (var a = 0; a < e.length; ++a) { for (var f = b.getItem(e[a].id).type, h = !1, p = 0; p < f.length; ++p)if (f[p] in this.accept) { h = !0; break } if (!h) return !1 } return !0
                                                }, copyState: function (b, e) { if (b) return !0; 2 > arguments.length && (e = this == c.manager().target); if (e) { if (this.copyOnly) return this.selfCopy } else return this.copyOnly; return !1 }, destroy: function () { g.superclass.destroy.call(this); E.forEach(this.topics, function (b) { b.remove() }); this.targetAnchor = null }, onMouseMove: function (b) {
                                                        if (!this.isDragging || "Disabled" != this.targetState) {
                                                                g.superclass.onMouseMove.call(this,
                                                                        b); var e = c.manager(); if (!this.isDragging && this.mouseDown && this.isSource && (Math.abs(b.pageX - this._lastX) > this.delay || Math.abs(b.pageY - this._lastY) > this.delay)) { var a = this.getSelectedNodes(); a.length && e.startDrag(this, a, this.copyState(n.getCopyKeyState(b), !0)) } this.isDragging && (a = !1, this.current && (this.targetBox && this.targetAnchor == this.current || (this.targetBox = v.position(this.current, !0)), a = this.horizontal ? b.pageX - this.targetBox.x < this.targetBox.w / 2 == v.isBodyLtr(this.current.ownerDocument) : b.pageY -
                                                                                this.targetBox.y < this.targetBox.h / 2), this.current != this.targetAnchor || a != this.before) && (this._markTargetAnchor(a), e.canDrop(!this.current || e.source != this || !(this.current.id in this.selection)))
                                                        }
                                                }, onMouseDown: function (b) { this.mouseDown || !this._legalMouseDown(b) || this.skipForm && n.isFormElement(b) || (this.mouseDown = !0, this._lastX = b.pageX, this._lastY = b.pageY, g.superclass.onMouseDown.call(this, b)) }, onMouseUp: function (b) { this.mouseDown && (this.mouseDown = !1, g.superclass.onMouseUp.call(this, b)) }, onDndSourceOver: function (b) {
                                                        this !==
                                                        b ? (this.mouseDown = !1, this.targetAnchor && this._unmarkTargetAnchor()) : this.isDragging && (b = c.manager(), b.canDrop("Disabled" != this.targetState && (!this.current || b.source != this || !(this.current.id in this.selection))))
                                                }, onDndStart: function (b, e, a) { this.autoSync && this.sync(); this.isSource && this._changeState("Source", this == b ? a ? "Copied" : "Moved" : ""); e = this.accept && this.checkAcceptance(b, e); this._changeState("Target", e ? "" : "Disabled"); this == b && c.manager().overSource(this); this.isDragging = !0 }, onDndDrop: function (b,
                                                        e, a, f) { if (this == f) this.onDrop(b, e, a); this.onDndCancel() }, onDndCancel: function () { this.targetAnchor && (this._unmarkTargetAnchor(), this.targetAnchor = null); this.before = !0; this.mouseDown = this.isDragging = !1; this._changeState("Source", ""); this._changeState("Target", "") }, onDrop: function (b, e, a) { if (this != b) this.onDropExternal(b, e, a); else this.onDropInternal(e, a) }, onDropExternal: function (b, e, a) {
                                                                var f = this._normalizedCreator; this._normalizedCreator = this.creator ? function (h, p) {
                                                                        return f.call(this, b.getItem(h.id).data,
                                                                                p)
                                                                } : a ? function (h) { var p = b.getItem(h.id); h = h.cloneNode(!0); h.id = n.getUniqueId(); return { node: h, data: p.data, type: p.type } } : function (h) { var p = b.getItem(h.id); b.delItem(h.id); return { node: h, data: p.data, type: p.type } }; this.selectNone(); a || this.creator || b.selectNone(); this.insertNodes(!0, e, this.before, this.current); !a && this.creator && b.deleteSelectedNodes(); this._normalizedCreator = f
                                                        }, onDropInternal: function (b, e) {
                                                                var a = this._normalizedCreator; if (!(this.current && this.current.id in this.selection)) {
                                                                        if (e) this._normalizedCreator =
                                                                                this.creator ? function (f, h) { return a.call(this, this.getItem(f.id).data, h) } : function (f) { var h = this.getItem(f.id); f = f.cloneNode(!0); f.id = n.getUniqueId(); return { node: f, data: h.data, type: h.type } }; else { if (!this.current) return; this._normalizedCreator = function (f) { var h = this.getItem(f.id); return { node: f, data: h.data, type: h.type } } } this._removeSelection(); this.insertNodes(!0, b, this.before, this.current); this._normalizedCreator = a
                                                                }
                                                        }, onDraggingOver: function () { }, onDraggingOut: function () { }, onOverEvent: function () {
                                                                g.superclass.onOverEvent.call(this);
                                                                c.manager().overSource(this); if (this.isDragging && "Disabled" != this.targetState) this.onDraggingOver()
                                                        }, onOutEvent: function () { g.superclass.onOutEvent.call(this); c.manager().outSource(this); if (this.isDragging && "Disabled" != this.targetState) this.onDraggingOut() }, _markTargetAnchor: function (b) {
                                                                if (this.current != this.targetAnchor || this.before != b) this.targetAnchor && this._removeItemClass(this.targetAnchor, this.before ? "Before" : "After"), this.targetAnchor = this.current, this.targetBox = null, this.before = b, this.targetAnchor &&
                                                                        this._addItemClass(this.targetAnchor, this.before ? "Before" : "After")
                                                        }, _unmarkTargetAnchor: function () { this.targetAnchor && (this._removeItemClass(this.targetAnchor, this.before ? "Before" : "After"), this.targetBox = this.targetAnchor = null, this.before = !0) }, _markDndStatus: function (b) { this._changeState("Source", b ? "Copied" : "Moved") }, _legalMouseDown: function (b) {
                                                                if ("touchstart" != b.type && !r.isLeft(b)) return !1; if (!this.withHandles) return !0; for (b = b.target; b && b !== this.node; b = b.parentNode) {
                                                                        if (m.contains(b, "dojoDndHandle")) return !0;
                                                                        if (m.contains(b, "dojoDndItem") || m.contains(b, "dojoDndIgnore")) break
                                                                } return !1
                                                        }
                                        }); return g
                        })
                }, "dojo/dnd/Selector": function () {
                        define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c) {
                                var g = q("dojo.dnd.Selector", c, {
                                        constructor: function (b, e) {
                                                e || (e = {}); this.singular = e.singular; this.autoSync = e.autoSync; this.selection = {}; this.anchor = null; this.simpleSelection = !1;
                                                this.events.push(k(this.node, n.press, w.hitch(this, "onMouseDown")), k(this.node, n.release, w.hitch(this, "onMouseUp")))
                                        }, singular: !1, getSelectedNodes: function () { var b = new l, e = d._empty, a; for (a in this.selection) a in e || b.push(m.byId(a)); return b }, selectNone: function () { return this._removeSelection()._removeAnchor() }, selectAll: function () { this.forInItems(function (b, e) { this._addItemClass(m.byId(e), "Selected"); this.selection[e] = 1 }, this); return this._removeAnchor() }, deleteSelectedNodes: function () {
                                                var b = d._empty,
                                                e; for (e in this.selection) if (!(e in b)) { var a = m.byId(e); this.delItem(e); v.destroy(a) } this.anchor = null; this.selection = {}; return this
                                        }, forInSelectedItems: function (b, e) { e = e || A.global; var a = this.selection, f = d._empty, h; for (h in a) h in f || b.call(e, this.getItem(h), h, this) }, sync: function () {
                                                g.superclass.sync.call(this); this.anchor && !this.getItem(this.anchor.id) && (this.anchor = null); var b = [], e = d._empty, a; for (a in this.selection) a in e || this.getItem(a) || b.push(a); E.forEach(b, function (f) { delete this.selection[f] },
                                                        this); return this
                                        }, insertNodes: function (b, e, a, f) {
                                                var h = this._normalizedCreator; this._normalizedCreator = function (p, B) { p = h.call(this, p, B); b ? (this.anchor ? this.anchor != p.node && (this._removeItemClass(p.node, "Anchor"), this._addItemClass(p.node, "Selected")) : (this.anchor = p.node, this._removeItemClass(p.node, "Selected"), this._addItemClass(this.anchor, "Anchor")), this.selection[p.node.id] = 1) : (this._removeItemClass(p.node, "Selected"), this._removeItemClass(p.node, "Anchor")); return p }; g.superclass.insertNodes.call(this,
                                                        e, a, f); this._normalizedCreator = h; return this
                                        }, destroy: function () { g.superclass.destroy.call(this); this.selection = this.anchor = null }, onMouseDown: function (b) {
                                                this.autoSync && this.sync(); if (this.current) if (!this.singular && !d.getCopyKeyState(b) && !b.shiftKey && this.current.id in this.selection) this.simpleSelection = !0, r.isLeft(b) && (b.stopPropagation(), b.preventDefault()); else {
                                                        if (!this.singular && b.shiftKey) {
                                                                d.getCopyKeyState(b) || this._removeSelection(); var e = this.getAllNodes(); if (e.length && (this.anchor || (this.anchor =
                                                                        e[0], this._addItemClass(this.anchor, "Anchor")), this.selection[this.anchor.id] = 1, this.anchor != this.current)) { for (var a = 0, f; a < e.length && (f = e[a], f != this.anchor && f != this.current); ++a); for (++a; a < e.length; ++a) { f = e[a]; if (f == this.anchor || f == this.current) break; this._addItemClass(f, "Selected"); this.selection[f.id] = 1 } this._addItemClass(this.current, "Selected"); this.selection[this.current.id] = 1 }
                                                        } else this.singular ? this.anchor == this.current ? d.getCopyKeyState(b) && this.selectNone() : (this.selectNone(), this.anchor =
                                                                this.current, this._addItemClass(this.anchor, "Anchor"), this.selection[this.current.id] = 1) : d.getCopyKeyState(b) ? this.anchor == this.current ? (delete this.selection[this.anchor.id], this._removeAnchor()) : this.current.id in this.selection ? (this._removeItemClass(this.current, "Selected"), delete this.selection[this.current.id]) : (this.anchor && (this._removeItemClass(this.anchor, "Anchor"), this._addItemClass(this.anchor, "Selected")), this.anchor = this.current, this._addItemClass(this.current, "Anchor"), this.selection[this.current.id] =
                                                                        1) : this.current.id in this.selection || (this.selectNone(), this.anchor = this.current, this._addItemClass(this.current, "Anchor"), this.selection[this.current.id] = 1); b.stopPropagation(); b.preventDefault()
                                                }
                                        }, onMouseUp: function () { this.simpleSelection && (this.simpleSelection = !1, this.selectNone(), this.current && (this.anchor = this.current, this._addItemClass(this.anchor, "Anchor"), this.selection[this.current.id] = 1)) }, onMouseMove: function () { this.simpleSelection = !1 }, onOverEvent: function () {
                                                this.onmousemoveEvent = k(this.node,
                                                        n.move, w.hitch(this, "onMouseMove"))
                                        }, onOutEvent: function () { this.onmousemoveEvent && (this.onmousemoveEvent.remove(), delete this.onmousemoveEvent) }, _removeSelection: function () { var b = d._empty, e; for (e in this.selection) if (!(e in b)) { var a = m.byId(e); a && this._removeItemClass(a, "Selected") } this.selection = {}; return this }, _removeAnchor: function () { this.anchor && (this._removeItemClass(this.anchor, "Anchor"), this.anchor = null); return this }
                                }); return g
                        })
                }, "dojo/dnd/Container": function () {
                        define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                        q = q("dojo.dnd.Container", k, {
                                                skipForm: !1, allowNested: !1, constructor: function (e, a) {
                                                        this.node = v.byId(e); a || (a = {}); this.creator = a.creator || null; this.skipForm = a.skipForm; this.parent = a.dropParent && v.byId(a.dropParent); this.map = {}; this.current = null; this.containerState = ""; r.add(this.node, "dojoDndContainer"); a && a._skipStartup || this.startup(); this.events = [d(this.node, g.over, w.hitch(this, "onMouseOver")), d(this.node, g.out, w.hitch(this, "onMouseOut")), d(this.node, "dragstart",
                                                                w.hitch(this, "onSelectStart")), d(this.node, "selectstart", w.hitch(this, "onSelectStart"))]
                                                }, creator: function () { }, getItem: function (e) { return this.map[e] }, setItem: function (e, a) { this.map[e] = a }, delItem: function (e) { delete this.map[e] }, forInItems: function (e, a) { a = a || A.global; var f = this.map, h = b._empty, p; for (p in f) p in h || e.call(a, f[p], p, this); return a }, clearItems: function () { this.map = {} }, getAllNodes: function () { return c((this.allowNested ? "" : "\x3e ") + ".dojoDndItem", this.parent) }, sync: function () {
                                                        var e = {}; this.getAllNodes().forEach(function (a) {
                                                                if (a.id) {
                                                                        var f =
                                                                                this.getItem(a.id); if (f) { e[a.id] = f; return }
                                                                } else a.id = b.getUniqueId(); f = a.getAttribute("dndType"); var h = a.getAttribute("dndData"); e[a.id] = { data: h || a.innerHTML, type: f ? f.split(/\s*,\s*/) : ["text"] }
                                                        }, this); this.map = e; return this
                                                }, insertNodes: function (e, a, f) {
                                                        this.parent.firstChild ? a ? f || (f = this.parent.firstChild) : f && (f = f.nextSibling) : f = null; if (f) for (a = 0; a < e.length; ++a) { var h = this._normalizedCreator(e[a]); this.setItem(h.node.id, { data: h.data, type: h.type }); f.parentNode.insertBefore(h.node, f) } else for (a = 0; a <
                                                                e.length; ++a)h = this._normalizedCreator(e[a]), this.setItem(h.node.id, { data: h.data, type: h.type }), this.parent.appendChild(h.node); return this
                                                }, destroy: function () { E.forEach(this.events, function (e) { e.remove() }); this.clearItems(); this.node = this.parent = this.current = null }, markupFactory: function (e, a, f) { e._skipStartup = !0; return new f(a, e) }, startup: function () {
                                                        if (!this.parent && (this.parent = this.node, "table" == this.parent.tagName.toLowerCase())) {
                                                                var e = this.parent.getElementsByTagName("tbody"); e && e.length && (this.parent =
                                                                        e[0])
                                                        } this.defaultCreator = b._defaultCreator(this.parent); this.sync()
                                                }, onMouseOver: function (e) { for (var a = e.relatedTarget; a && a != this.node;)try { a = a.parentNode } catch (f) { a = null } a || (this._changeState("Container", "Over"), this.onOverEvent()); a = this._getChildByEvent(e); this.current != a && (this.current && this._removeItemClass(this.current, "Over"), a && this._addItemClass(a, "Over"), this.current = a) }, onMouseOut: function (e) {
                                                        for (e = e.relatedTarget; e;) { if (e == this.node) return; try { e = e.parentNode } catch (a) { e = null } } this.current &&
                                                                (this._removeItemClass(this.current, "Over"), this.current = null); this._changeState("Container", ""); this.onOutEvent()
                                                }, onSelectStart: function (e) { this.withHandles || this.skipForm && b.isFormElement(e) || (e.stopPropagation(), e.preventDefault()) }, onOverEvent: function () { }, onOutEvent: function () { }, _changeState: function (e, a) { var f = "dojoDnd" + e; e = e.toLowerCase() + "State"; r.replace(this.node, f + a, f + this[e]); this[e] = a }, _addItemClass: function (e, a) { r.add(e, "dojoDndItem" + a) }, _removeItemClass: function (e, a) {
                                                        r.remove(e, "dojoDndItem" +
                                                                a)
                                                }, _getChildByEvent: function (e) { if (e = e.target) for (var a = e.parentNode; a; e = a, a = e.parentNode)if ((a == this.parent || this.allowNested) && r.contains(e, "dojoDndItem")) return e; return null }, _normalizedCreator: function (e, a) { e = (this.creator || this.defaultCreator).call(this, e, a); w.isArray(e.type) || (e.type = ["text"]); e.node.id || (e.node.id = b.getUniqueId()); r.add(e.node, "dojoDndItem"); return e }
                                        }); b._createNode = function (e) { return e ? function (a) { return l.create(e, { innerHTML: a }) } : b._createSpan }; b._createTrTd = function (e) {
                                                var a =
                                                        l.create("tr"); l.create("td", { innerHTML: e }, a); return a
                                        }; b._createSpan = function (e) { return l.create("span", { innerHTML: e }) }; b._defaultCreatorNodes = { ul: "li", ol: "li", div: "div", p: "div" }; b._defaultCreator = function (e) {
                                                e = e.tagName.toLowerCase(); var a = "tbody" == e || "thead" == e ? b._createTrTd : b._createNode(b._defaultCreatorNodes[e]); return function (f, h) {
                                                        var p = f && w.isObject(f); if (p && f.tagName && f.nodeType && f.getAttribute) {
                                                                var B = f.getAttribute("dndData") || f.innerHTML; p = (p = f.getAttribute("dndType")) ? p.split(/\s*,\s*/) :
                                                                        ["text"]
                                                        } else B = p && f.data ? f.data : f, p = p && f.type ? f.type : ["text"], f = ("avatar" == h ? b._createSpan : a)(String(B)); f.id || (f.id = b.getUniqueId()); return { node: f, data: B, type: p }
                                                }
                                        }; return q
                                })
                }, "dojo/dnd/Manager": function () {
                        define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c, g, b) {
                                var e = q("dojo.dnd.Manager", [v], {
                                        constructor: function () {
                                                this.source = this.avatar =
                                                        null; this.nodes = []; this.copy = !0; this.target = null; this.canDropFlag = !1; this.events = []
                                        }, OFFSET_X: r("touch") ? 4 : 16, OFFSET_Y: r("touch") ? 4 : 16, overSource: function (a) { this.avatar && (this.target = a && "Disabled" != a.targetState ? a : null, this.canDropFlag = !!this.target, this.avatar.update()); n.publish("/dnd/source/over", a) }, outSource: function (a) { this.avatar ? this.target == a && (this.target = null, this.canDropFlag = !1, this.avatar.update(), n.publish("/dnd/source/over", null)) : n.publish("/dnd/source/over", null) }, startDrag: function (a,
                                                f, h) {
                                                        function p(B) { B.preventDefault(); B.stopPropagation() } g.autoScrollStart(w.doc); this.source = a; this.nodes = f; this.copy = !!h; this.avatar = this.makeAvatar(); w.body().appendChild(this.avatar.node); n.publish("/dnd/start", a, f, this.copy); this.events = [k(w.doc, d.move, A.hitch(this, "onMouseMove")), k(w.doc, d.release, A.hitch(this, "onMouseUp")), k(w.doc, "keydown", A.hitch(this, "onKeyDown")), k(w.doc, "keyup", A.hitch(this, "onKeyUp")), k(w.doc, "dragstart", p), k(w.body(), "selectstart", p)]; a = "dojoDnd" + (h ? "Copy" : "Move");
                                                m.add(w.body(), a)
                                        }, canDrop: function (a) { a = !(!this.target || !a); this.canDropFlag != a && (this.canDropFlag = a, this.avatar.update()) }, stopDrag: function () { m.remove(w.body(), ["dojoDndCopy", "dojoDndMove"]); E.forEach(this.events, function (a) { a.remove() }); this.events = []; this.avatar.destroy(); this.source = this.target = this.avatar = null; this.nodes = [] }, makeAvatar: function () { return new b(this) }, updateAvatar: function () { this.avatar.update() }, onMouseMove: function (a) {
                                                var f = this.avatar; f && (g.autoScrollNodes(a), f = f.node.style,
                                                        f.left = a.pageX + this.OFFSET_X + "px", f.top = a.pageY + this.OFFSET_Y + "px", f = !!this.source.copyState(c.getCopyKeyState(a)), this.copy != f && this._setCopyStatus(f)); r("touch") && a.preventDefault()
                                        }, onMouseUp: function (a) { if (this.avatar) { if (this.target && this.canDropFlag) { var f = !!this.source.copyState(c.getCopyKeyState(a)); n.publish("/dnd/drop/before", this.source, this.nodes, f, this.target, a); n.publish("/dnd/drop", this.source, this.nodes, f, this.target, a) } else n.publish("/dnd/cancel"); this.stopDrag() } }, onKeyDown: function (a) {
                                                if (this.avatar) switch (a.keyCode) {
                                                        case l.CTRL: a =
                                                                !!this.source.copyState(!0); this.copy != a && this._setCopyStatus(a); break; case l.ESCAPE: n.publish("/dnd/cancel"), this.stopDrag()
                                                }
                                        }, onKeyUp: function (a) { this.avatar && a.keyCode == l.CTRL && (a = !!this.source.copyState(!1), this.copy != a && this._setCopyStatus(a)) }, _setCopyStatus: function (a) { this.copy = a; this.source._markDndStatus(this.copy); this.updateAvatar(); m.replace(w.body(), "dojoDnd" + (this.copy ? "Copy" : "Move"), "dojoDnd" + (this.copy ? "Move" : "Copy")) }
                                }); c._manager = null; e.manager = c.manager = function () {
                                        c._manager ||
                                        (c._manager = new e); return c._manager
                                }; return e
                        })
                }, "dojo/dnd/Avatar": function () {
                        define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "), function (E, q, A, w, m, v, r, l) {
                                return E("dojo.dnd.Avatar", null, {
                                        constructor: function (k) { this.manager = k; this.construct() }, construct: function () {
                                                var k = v.create("table", { "class": "dojoDndAvatar", style: { position: "absolute", zIndex: "1999", margin: "0px" } }), n = this.manager.source, d = v.create("tbody", null, k), c = v.create("tr",
                                                        null, d), g = v.create("td", null, c), b = Math.min(5, this.manager.nodes.length), e = 0; r("highcontrast") && v.create("span", { id: "a11yIcon", innerHTML: this.manager.copy ? "+" : "\x3c" }, g); v.create("span", { innerHTML: n.generateText ? this._generateText() : "" }, g); for (w.set(c, { "class": "dojoDndAvatarHeader", style: { opacity: .9 } }); e < b; ++e) {
                                                                if (n.creator) var a = n._normalizedCreator(n.getItem(this.manager.nodes[e].id).data, "avatar").node; else a = this.manager.nodes[e].cloneNode(!0), "tr" == a.tagName.toLowerCase() && (c = v.create("table"),
                                                                        v.create("tbody", null, c).appendChild(a), a = c); a.id = ""; c = v.create("tr", null, d); g = v.create("td", null, c); g.appendChild(a); w.set(c, { "class": "dojoDndAvatarItem", style: { opacity: (9 - e) / 10 } })
                                                        } this.node = k
                                        }, destroy: function () { v.destroy(this.node); this.node = !1 }, update: function () {
                                                m.toggle(this.node, "dojoDndAvatarCanDrop", this.manager.canDropFlag); if (r("highcontrast")) {
                                                        var k = A.byId("a11yIcon"), n = "+"; this.manager.canDropFlag && !this.manager.copy ? n = "\x3c " : this.manager.canDropFlag || this.manager.copy ? this.manager.canDropFlag ||
                                                                (n = "x") : n = "o"; k.innerHTML = n
                                                } l("tr.dojoDndAvatarHeader td span" + (r("highcontrast") ? " span" : ""), this.node).forEach(function (d) { d.innerHTML = this.manager.source.generateText ? this._generateText() : "" }, this)
                                        }, _generateText: function () { return this.manager.nodes.length.toString() }
                                })
                        })
                }, "dijit/CheckedMenuItem": function () {
                        define(["dojo/_base/declare", "dojo/dom-class", "./MenuItem", "dojo/text!./templates/CheckedMenuItem.html", "./hccss"], function (E, q, A, w) {
                                return E("dijit.CheckedMenuItem", A, {
                                        baseClass: "dijitMenuItem dijitCheckedMenuItem",
                                        templateString: w, checked: !1, _setCheckedAttr: function (m) { this.domNode.setAttribute("aria-checked", m ? "true" : "false"); this._set("checked", m) }, iconClass: "", role: "menuitemcheckbox", checkedChar: "\x26#10003;", onChange: function () { }, _onClick: function (m) { this.disabled || (this.set("checked", !this.checked), this.onChange(this.checked)); this.onClick(m) }
                                })
                        })
                }, "dijit/ColorPalette": function () {
                        define("require dojo/text!./templates/ColorPalette.html ./_Widget ./_TemplatedMixin ./_PaletteMixin ./hccss dojo/i18n dojo/_base/Color dojo/_base/declare dojo/dom-construct dojo/string dojo/i18n!dojo/nls/colors dojo/colors".split(" "),
                                function (E, q, A, w, m, v, r, l, k, n, d) {
                                        var c = k("dijit.ColorPalette", [A, w, m], {
                                                palette: "7x10", _palettes: {
                                                        "7x10": ["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "), "lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "), "silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "), "gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),
                                                        "dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "), "darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "), "black darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")], "3x4": [["white", "lime", "green", "blue"], ["silver", "yellow", "fuchsia", "navy"], ["gray", "red", "purple", "black"]]
                                                }, templateString: q, baseClass: "dijitColorPalette", _dyeFactory: function (g, b, e, a) {
                                                        return new this._dyeClass(g,
                                                                b, e, a)
                                                }, buildRendering: function () { this.inherited(arguments); this._dyeClass = k(c._Color, { palette: this.palette }); this._preparePalette(this._palettes[this.palette], r.getLocalization("dojo", "colors", this.lang)) }
                                        }); c._Color = k("dijit._Color", l, {
                                                template: "\x3cspan class\x3d'dijitInline dijitPaletteImg'\x3e\x3cimg src\x3d'${blankGif}' alt\x3d'${alt}' title\x3d'${title}' class\x3d'dijitColorPaletteSwatch' style\x3d'background-color: ${color}'/\x3e\x3c/span\x3e", hcTemplate: "\x3cspan class\x3d'dijitInline dijitPaletteImg' style\x3d'position: relative; overflow: hidden; height: 12px; width: 14px;'\x3e\x3cimg src\x3d'${image}' alt\x3d'${alt}' title\x3d'${title}' style\x3d'position: absolute; left: ${left}px; top: ${top}px; ${size}'/\x3e\x3c/span\x3e",
                                                _imagePaths: { "7x10": E.toUrl("./themes/a11y/colors7x10.png"), "3x4": E.toUrl("./themes/a11y/colors3x4.png") }, constructor: function (g, b, e, a) { this._title = a; this._row = b; this._col = e; this.setColor(l.named[g]) }, getValue: function () { return this.toHex() }, fillCell: function (g, b) {
                                                        b = d.substitute(v("highcontrast") ? this.hcTemplate : this.template, {
                                                                color: this.toHex(), blankGif: b, alt: this._title, title: this._title, image: this._imagePaths[this.palette].toString(), left: -20 * this._col - 5, top: -20 * this._row - 5, size: "7x10" == this.palette ?
                                                                        "height: 145px; width: 206px" : "height: 64px; width: 86px"
                                                        }); n.place(b, g)
                                                }
                                        }); return c
                                })
                }, "dijit/_PaletteMixin": function () {
                        define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on ./_CssStateMixin ./a11yclick ./focus ./typematic".split(" "), function (E, q, A, w, m, v, r, l, k, n, d) {
                                return E("dijit._PaletteMixin", l, {
                                        defaultTimeout: 500, timeoutChangeRate: .9, value: "", _selectedCell: -1, tabIndex: "0", cellClass: "dijitPaletteCell", dyeClass: null, _dyeFactory: function (c) {
                                                return new ("string" ==
                                                        typeof this.dyeClass ? v.getObject(this.dyeClass) : this.dyeClass)(c)
                                        }, _preparePalette: function (c, g) {
                                                this._cells = []; var b = this._blankGif; this.own(r(this.gridNode, k, v.hitch(this, "_onCellClick"))); for (var e = 0; e < c.length; e++)for (var a = w.create("tr", { tabIndex: "-1", role: "row" }, this.gridNode), f = 0; f < c[e].length; f++) {
                                                        var h = c[e][f]; if (h) {
                                                                var p = this._dyeFactory(h, e, f, g[h]); h = w.create("td", { "class": this.cellClass, tabIndex: "-1", title: g[h], role: "gridcell" }, a); p.fillCell(h, b); h.idx = this._cells.length; this._cells.push({
                                                                        node: h,
                                                                        dye: p
                                                                })
                                                        }
                                                } this._xDim = c[0].length; this._yDim = c.length; var B = { UP_ARROW: -this._xDim, DOWN_ARROW: this._xDim, RIGHT_ARROW: this.isLeftToRight() ? 1 : -1, LEFT_ARROW: this.isLeftToRight() ? -1 : 1 }, t; for (t in B) this.own(d.addKeyListener(this.domNode, { keyCode: m[t], ctrlKey: !1, altKey: !1, shiftKey: !1 }, this, function () { var u = B[t]; return function (z) { this._navigateByKey(u, z) } }(), this.timeoutChangeRate, this.defaultTimeout))
                                        }, postCreate: function () { this.inherited(arguments); this._setCurrent(this._cells[0].node) }, focus: function () { n.focus(this._currentFocus) },
                                        _onCellClick: function (c) { for (var g = c.target; "TD" != g.tagName;) { if (!g.parentNode || g == this.gridNode) return; g = g.parentNode } var b = this._getDye(g).getValue(); this._setCurrent(g); n.focus(g); this._setValueAttr(b, !0); c.stopPropagation(); c.preventDefault() }, _setCurrent: function (c) { "_currentFocus" in this && q.set(this._currentFocus, "tabIndex", "-1"); (this._currentFocus = c) && q.set(c, "tabIndex", this.tabIndex) }, _setValueAttr: function (c, g) {
                                                0 <= this._selectedCell && A.remove(this._cells[this._selectedCell].node, this.cellClass +
                                                        "Selected"); this._selectedCell = -1; if (c) for (var b = 0; b < this._cells.length; b++)if (c == this._cells[b].dye.getValue()) { this._selectedCell = b; A.add(this._cells[b].node, this.cellClass + "Selected"); break } this._set("value", 0 <= this._selectedCell ? c : null); if (g || void 0 === g) this.onChange(c)
                                        }, onChange: function () { }, _navigateByKey: function (c, g) { -1 != g && (c = this._currentFocus.idx + c, c < this._cells.length && -1 < c && (c = this._cells[c].node, this._setCurrent(c), this.defer(v.hitch(n, "focus", c)))) }, _getDye: function (c) { return this._cells[c.idx].dye }
                                })
                        })
                },
                "dojo/_base/query": function () { define(["../query", "./NodeList"], function (E) { return E }) }, "dijit/form/ComboBox": function () { define(["dojo/_base/declare", "./ValidationTextBox", "./ComboBoxMixin"], function (E, q, A) { return E("dijit.form.ComboBox", [q, A], {}) }) }, "dojo/store/Observable": function () {
                        define(["../_base/kernel", "../_base/lang", "../when", "../_base/array"], function (E, q, A, w) {
                                E = function (m) {
                                        function v(d, c) {
                                                var g = m[d]; g && (m[d] = function (b) {
                                                        var e; "put" === d && (e = m.getIdentity(b)); if (n) return g.apply(this, arguments);
                                                        n = !0; try { var a = g.apply(this, arguments); A(a, function (f) { c("object" == typeof f && f || b, e) }); return a } finally { n = !1 }
                                                })
                                        } var r = [], l = 0; m = q.delegate(m); m.notify = function (d, c) { l++; for (var g = r.slice(), b = 0, e = g.length; b < e; b++)g[b](d, c) }; var k = m.query; m.query = function (d, c) {
                                                c = c || {}; var g = k.apply(this, arguments); if (g && g.forEach) {
                                                        var b = q.mixin({}, c); delete b.start; delete b.count; var e = m.queryEngine && m.queryEngine(d, b), a = l, f = [], h; g.observe = function (p, B) {
                                                                1 == f.push(p) && r.push(h = function (u, z) {
                                                                        A(g, function (x) {
                                                                                var y = x.length !=
                                                                                        c.count, D; if (++a != l) throw Error("Query is out of date, you must observe() the query prior to any data modifications"); var H = -1, I = -1; if (void 0 !== z) { var N = [].concat(x); e && !u && (N = e(x)); var T = 0; for (D = x.length; T < D; T++) { var M = x[T]; if (m.getIdentity(M) == z && !(0 > N.indexOf(M))) { var R = M; H = T; !e && u || x.splice(T, 1); break } } } e ? u && (e.matches ? e.matches(u) : e([u]).length) && (T = -1 < H ? H : x.length, x.splice(T, 0, u), I = w.indexOf(e(x), u), x.splice(T, 1), c.start && 0 == I || !y && I == x.length ? I = -1 : x.splice(I, 0, u)) : u && (void 0 !== z ? I = H : c.start ||
                                                                                                (I = m.defaultIndex || 0, x.splice(I, 0, u))); if ((-1 < H || -1 < I) && (B || !e || H != I)) for (y = f.slice(), T = 0; x = y[T]; T++)x(u || R, H, I)
                                                                        })
                                                                }); var t = {}; t.remove = t.cancel = function () { var u = w.indexOf(f, p); -1 < u && (f.splice(u, 1), f.length || r.splice(w.indexOf(r, h), 1)) }; return t
                                                        }
                                                } return g
                                        }; var n; v("put", function (d, c) { m.notify(d, c) }); v("add", function (d) { m.notify(d) }); v("remove", function (d) { m.notify(void 0, d) }); return m
                                }; q.setObject("dojo.store.Observable", E); return E
                        })
                }, "dijit/form/SimpleTextarea": function () {
                        define(["dojo/_base/declare",
                                "dojo/dom-class", "dojo/sniff", "./TextBox"], function (E, q, A, w) {
                                        return E("dijit.form.SimpleTextarea", w, {
                                                baseClass: "dijitTextBox dijitTextArea", rows: "3", cols: "20", templateString: "\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e", postMixInProperties: function () { !this.value && this.srcNodeRef && (this.value = this.srcNodeRef.value); this.inherited(arguments) }, buildRendering: function () {
                                                        this.inherited(arguments); A("ie") && this.cols &&
                                                                q.add(this.textbox, "dijitTextAreaCols")
                                                }, filter: function (m) { m && (m = m.replace(/\r/g, "")); return this.inherited(arguments) }, _onInput: function (m) {
                                                        if (this.maxLength) {
                                                                var v = parseInt(this.maxLength), r = this.textbox.value.replace(/\r/g, ""); v = r.length - v; if (0 < v) {
                                                                        var l = this.textbox; if (l.selectionStart) { var k = l.selectionStart, n = 0; A("opera") && (n = (this.textbox.value.substring(0, k).match(/\r/g) || []).length); this.textbox.value = r.substring(0, k - v - n) + r.substring(k - n); l.setSelectionRange(k - v, k - v) } else this.ownerDocument.selection &&
                                                                                (l.focus(), r = this.ownerDocument.selection.createRange(), r.moveStart("character", -v), r.text = "", r.select())
                                                                }
                                                        } this.inherited(arguments)
                                                }
                                        })
                                })
                }, "dijit/form/RadioButton": function () { define(["dojo/_base/declare", "./CheckBox", "./_RadioButtonMixin"], function (E, q, A) { return E("dijit.form.RadioButton", [q, A], { baseClass: "dijitRadio" }) }) }, "dijit/form/_RadioButtonMixin": function () {
                        define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "), function (E, q, A, w, m, v) {
                                return q("dijit.form._RadioButtonMixin",
                                        null, {
                                                type: "radio", _getRelatedWidgets: function () { var r = []; m("input[type\x3dradio]", this.focusNode.form || this.ownerDocument).forEach(w.hitch(this, function (l) { l.name == this.name && l.form == this.focusNode.form && (l = v.getEnclosingWidget(l)) && r.push(l) })); return r }, _setCheckedAttr: function (r) { this.inherited(arguments); this._created && r && E.forEach(this._getRelatedWidgets(), w.hitch(this, function (l) { l != this && l.checked && l.set("checked", !1) })) }, _getSubmitValue: function (r) { return null == r ? "on" : r }, _onClick: function (r) {
                                                        if (this.checked ||
                                                                this.disabled) return r.stopPropagation(), r.preventDefault(), !1; if (this.readOnly) return r.stopPropagation(), r.preventDefault(), E.forEach(this._getRelatedWidgets(), w.hitch(this, function (n) { A.set(this.focusNode || this.domNode, "checked", n.checked) })), !1; var l = !1, k; E.some(this._getRelatedWidgets(), function (n) { return n.checked ? (k = n, !0) : !1 }); this.checked = !0; k && (k.checked = !1); if (!1 === this.onClick(r) || r.defaultPrevented) l = !0; this.checked = !1; k && (k.checked = !0); l ? r.preventDefault() : this.set("checked", !0); return !l
                                                }
                                })
                        })
                },
                "url:jimu/dijit/templates/AGOLLoading.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imgDiv" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:esri/dijit/templates/InfoWindow.html": '\x3cdiv id\x3d"${id}.infowindow" class\x3d"infowindow" dojoAttachPoint\x3d"_infowindow"\r\n  \x3e\x3cdiv style\x3d"position:relative;"\r\n    \x3e\x3cdiv class\x3d"window" dojoAttachPoint\x3d"_window"\r\n      \x3e\x3cdiv class\x3d"top"\r\n        \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_topleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n    \t\t\x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_topright"\r\n    \t\t\t\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\r\n    \t\t\t\x3e\x3cdiv class\x3d"user" dojoAttachPoint\x3d"_user"\r\n    \t\t\t  \x3e\x3cdiv class\x3d"titlebar" dojoAttachPoint\x3d"_titlebar"\r\n    \t\t\t    \x3e\x3ca class\x3d"hide" dojoAttachPoint\x3d"_hide" dojoAttachEvent\x3d"onclick:hide"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/a\r\n              \x3e\x3cdiv class\x3d"title" dojoAttachPoint\x3d"_title"\x3e${title}\x3c/div\r\n    \t\t\t  \x3e\x3c/div\r\n            \x3e\x3cdiv class\x3d"border" dojoAttachPoint\x3d"_border"\x3e\x3c/div\r\n    \t\t\t  \x3e\x3cdiv class\x3d"layout content" dojoAttachPoint\x3d"_content, containerNode"\r\n    \t\t\t  \x3e\x3c/div\r\n    \t\t\t\x3e\x3c/div\r\n    \t\t\x3e\x3c/div\r\n        \x3e\x3cdiv class\x3d"bottom"\r\n          \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_bottomleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n\t\t      \x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_bottomright"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n        \x3e\x3c/div\r\n      \x3e\x3c/div\r\n    \x3e\x3c/div\r\n    \x3e\x3cdiv class\x3d"pointer" dojoAttachPoint\x3d"_pointer"\x3e\x3cdiv dojoAttachPoint\x3d"_sprite" class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n  \x3e\x3c/div\r\n\x3e\x3c/div\x3e',
                "url:dijit/templates/Menu.html": '\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n', "url:dijit/templates/MenuItem.html": '\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
                "url:dijit/templates/MenuSeparator.html": '\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
                "url:dijit/form/templates/Select.html": '\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
                "url:jimu/dijit/templates/AddItemForm.html": '\x3cdiv style\x3d"width: 100%" class\x3d"jimu-item-form"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"itemForm" encType\x3d"multipart/form-data" action\x3d"" method\x3d""\x3e\r\n    \x3cdiv class\x3d"line"\x3e\r\n      \x3cdiv class\x3d"input-label"\x3e${nls.title}\x3c/div\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"itemName"\r\n      required\x3d"true" class\x3d"input-item"/\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"line line-margin"\x3e\r\n      \x3cdiv class\x3d"input-label"\x3e${nls.folder}\x3c/div\x3e\r\n      \x3cinput data-dojo-attach-point\x3d"itemFolder" data-dojo-type\x3d"dijit/form/FilteringSelect" trim\x3d"true" class\x3d"input-item"\x3e\x3c/input\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:dijit/form/templates/DropDownBox.html": '\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"${type}" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
                "url:jimu/dijit/templates/LoadingShelter.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"loading-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadingNode" class\x3d"img-div"\x3e\r\n      \x3c/div\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode"\x3e\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e', "url:jimu/dijit/templates/SymbolChooser.html": '\x3cdiv class\x3d"symbol-chooser" style\x3d"width:320px;"\x3e\r\n\t\x3cdiv class\x3d"symbol-section point-symbol-section" data-dojo-attach-point\x3d"pointSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-sym-class-select-tr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cselect class\x3d"restrict-select-width" data-dojo-attach-point\x3d"pointSymClassSelect" data-dojo-type\x3d"jimu/dijit/formSelect" aria-label\x3d"${nls.markerCategory}" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointCustomImageTr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" data-dojo-attach-point\x3d"customImageTd" class\x3d"custom-image-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"image-file-tip jimu-ellipsis jimu-leading-margin1" data-dojo-attach-point\x3d"imageNameNode"\x3e${nls.noFileChoosen}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-icon-tables-tr" data-dojo-attach-point\x3d"pointIconTablesTr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" style\x3d"position:relative"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"loadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"pointIconTables"\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"point-symbol-section-symbolSize"\x3e${nls.symbolSize}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointSize" data-dojo-type\x3d"dijit/form/NumberSpinner" data-a11y-label-by\x3d"point-symbol-section-symbolSize" style\x3d"width:100%;" data-dojo-props\x3d\'value:18,smallDelta:1,largeDelta:10,constraints:{min:1,max:50},intermediateChanges:true,required:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"point-symbol-section-color"\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-a11y-label-by\x3d"point-symbol-section-color" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,128]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOpacityTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"point-symbol-section-transparency"\x3e${nls.transparency}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-a11y-label-by\x3d"point-symbol-section-transparency" data-dojo-props\x3d\'alpha:0.5\' style\x3d"width:100%;font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOutlineColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"point-symbol-section-outlineColor"\x3e${nls.outlineColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-a11y-label-by\x3d"point-symbol-section-outlineColor" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,255]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOulineWidthTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"point-symbol-section-outlineWidth"\x3e${nls.outlineWidth}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner"  data-a11y-label-by\x3d"point-symbol-section-outlineWidth" style\x3d"width:100%;" data-dojo-props\x3d\'value:1,smallDelta:1,constraints:{min:0,max:5},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section line-symbol-section" data-dojo-attach-point\x3d"lineSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineSymPreview" style\x3d"width:100%;overflow:hidden;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"lineIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"line-symbol-section-color"\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-a11y-label-by\x3d"line-symbol-section-color" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"line-symbol-section-style"\x3e${nls.style}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cselect class\x3d"restrict-select-width" data-dojo-attach-point\x3d"lineStylesSelect" data-dojo-type\x3d"jimu/dijit/formSelect" data-a11y-label-by\x3d"line-symbol-section-style" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"solid"\x3e${nls.solid}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dash"\x3e${nls.dash}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dot"\x3e${nls.dot}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"dashdot"\x3e${nls.dashDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"longdashdotdot"\x3e${nls.dashDotDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"line-symbol-section-transparency"\x3e${nls.transparency}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-a11y-label-by\x3d"line-symbol-section-transparency" data-dojo-props\x3d\'alpha:1\' style\x3d"width:100%;font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"line-symbol-section-width"\x3e${nls.width}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"lineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n\t\t\t\t\t\tdata-a11y-label-by\x3d"line-symbol-section-width" data-dojo-props\x3d\'value:3,smallDelta:1,constraints:{min:1,max:50},intermediateChanges:true,required:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section fill-symbol-section" data-dojo-attach-point\x3d"fillSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"fillIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"fill-symbol-section-color"\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-a11y-label-by\x3d"fill-symbol-section-color" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"arrowWidthTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"arrow-symbol-section-width"\x3e${nls.width}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"arrowWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n\t\t\t\t\t\tdata-a11y-label-by\x3d"arrow-symbol-section-width" data-dojo-props\x3d\'value:12,smallDelta:1,constraints:{min:1,max:50},intermediateChanges:true,required:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"fill-symbol-section-transparency"\x3e${nls.transparency}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-a11y-label-by\x3d"fill-symbol-section-transparency" data-dojo-props\x3d\'alpha:0.5\' style\x3d"width:100%;font-size:13px;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"fill-symbol-section-outlineColor"\x3e${nls.outlineColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-a11y-label-by\x3d"fill-symbol-section-outlineColor" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#738c3d"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"fill-symbol-section-outlineWidth"\x3e${nls.outlineWidth}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"fillOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n\t\t\t\t\t\tdata-a11y-label-by\x3d"fill-symbol-section-outlineWidth" data-dojo-props\x3d\'value:2,smallDelta:1,constraints:{min:0,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section text-symbol-section" data-dojo-attach-point\x3d"textSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"130px"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word"\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"textPreview"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"text-symbol-section-text"\x3e${nls.text}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput class\x3d"text-input" data-dojo-attach-point\x3d"inputText" type\x3d"text"  data-a11y-label-by\x3d"text-symbol-section-text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"text-symbol-section-fontColor"\x3e${nls.fontColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"textColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-a11y-label-by\x3d"text-symbol-section-fontColor" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#000"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan class\x3d"jimu-break-word" data-a11y-label-id\x3d"text-symbol-section-fontSize"\x3e${nls.fontSize}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"textFontSize" data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n\t\t\t\t\t\tdata-a11y-label-by\x3d"text-symbol-section-fontSize" style\x3d"width:100%;" data-dojo-props\x3d\'value:20,smallDelta:1,constraints:{min:1,max:100},intermediateChanges:true,required:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/ImageChooser.html": '\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintText"\x3e\r\n\t\t\x3cspan class\x3d"display-text" data-dojo-attach-point\x3d"displayText"\x3e\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintImage"\x3e\r\n\t\t\x3cimg class\x3d"display-image" data-dojo-attach-point\x3d"selfImg"\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cform data-dojo-attach-point\x3d"fileForm"\x3e\r\n    \x3clabel data-dojo-attach-point\x3d"mask"\x3e\x3c/label\x3e\r\n    \x3cinput type\x3d"file" data-dojo-attach-point\x3d"fileInput"\x3e\r\n  \x3c/form\x3e\r\n  \x3cimg class\x3d"tmp-image" style\x3d"display:none" data-dojo-attach-point\x3d"tmpImg"\x3e--\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/_CropImage.html": '\x3cdiv class\x3d"jimu-crop-image"\x3e\r\n\t\x3cimg class\x3d"loading-image" data-dojo-attach-point\x3d"loadingImg" src\x3d""\x3e\r\n\r\n\t\x3cimg class\x3d"base-image hide-status" data-dojo-attach-point\x3d"baseImage" width\x3d"100%" height\x3d"100%" style\x3d"display:none;width:100%;height:100%"\x3e\r\n\x3c/div\x3e\r\n', "url:dojox/widget/ColorPicker/ColorPicker.html": '\x3ctable class\x3d"dojoxColorPicker" dojoAttachEvent\x3d"onkeypress: _handleKey" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\x3ctr\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxColorPickerBox"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg title\x3d"${saturationPickerTitle}" alt\x3d"${saturationPickerTitle}" class\x3d"dojoxColorPickerPoint" src\x3d"${_pickerPointer}" tabIndex\x3d"0" dojoAttachPoint\x3d"cursorNode" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cimg role\x3d"presentation" alt\x3d"" dojoAttachPoint\x3d"colorUnderlay" dojoAttachEvent\x3d"onclick: _setPoint, onmousedown: _stopDrag" class\x3d"dojoxColorPickerUnderlay" src\x3d"${_underlay}" ondragstart\x3d"return false"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\x3cdiv class\x3d"dojoxHuePicker"\x3e\r\n\t\t\t\t\x3c!-- Forcing ABS in style attr due to dojo DND issue with not picking it up form the class. --\x3e\r\n\t\t\t\t\x3cimg dojoAttachPoint\x3d"hueCursorNode" tabIndex\x3d"0" class\x3d"dojoxHuePickerPoint" title\x3d"${huePickerTitle}" alt\x3d"${huePickerTitle}" src\x3d"${_huePickerPointer}" style\x3d"position: absolute; top: 0px; left: 0px;"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dojoxHuePickerUnderlay" dojoAttachPoint\x3d"hueNode"\x3e\r\n\t\t\t\t    \x3cimg role\x3d"presentation" alt\x3d"" dojoAttachEvent\x3d"onclick: _setHuePoint, onmousedown: _stopDrag" src\x3d"${_hueUnderlay}"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/td\x3e\r\n\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerPreviewContainer"\x3e\r\n\t\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top" class\x3d"dojoxColorPickerRightPad"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"previewNode" class\x3d"dojoxColorPickerPreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd valign\x3d"top"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"safePreviewNode" class\x3d"dojoxColorPickerWebSafePreview"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd valign\x3d"bottom"\x3e\r\n\t\t\t\t\t\t\x3ctable class\x3d"dojoxColorPickerOptional" cellpadding\x3d"0" cellspacing\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerRgb" dojoAttachPoint\x3d"rgbNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_r"\x3e${redLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_r" dojoAttachPoint\x3d"Rval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_g"\x3e${greenLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_g" dojoAttachPoint\x3d"Gval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_b"\x3e${blueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_b" dojoAttachPoint\x3d"Bval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dijitInline dojoxColorPickerHsv" dojoAttachPoint\x3d"hsvNode"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctable cellpadding\x3d"1" cellspacing\x3d"1" role\x3d"presentation"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_h"\x3e${hueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_h" dojoAttachPoint\x3d"Hval"size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${degLabel}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_s"\x3e${saturationLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_s" dojoAttachPoint\x3d"Sval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d"${_uId}_v"\x3e${valueLabel}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput id\x3d"${_uId}_v" dojoAttachPoint\x3d"Vval" size\x3d"1" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e ${percentSign}\x3c/td\x3e\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv class\x3d"dojoxColorPickerHex" dojoAttachPoint\x3d"hexNode" aria-live\x3d"polite"\x3e\t\r\n\t\t\t\t\t\t\t\t\t\t\x3clabel for\x3d"${_uId}_hex"\x3e\x26nbsp;${hexLabel}\x26nbsp;\x3c/label\x3e\x3cinput id\x3d"${_uId}_hex" dojoAttachPoint\x3d"hexCode, focusNode, valueNode" size\x3d"6" class\x3d"dojoxColorPickerHexCode" dojoAttachEvent\x3d"onchange: _colorInputChange"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/td\x3e\r\n\t\x3c/tr\x3e\r\n\x3c/table\x3e\r\n\r\n',
                "url:jimu/dijit/templates/_Transparency.html": '\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"opacitySlider" data-dojo-type\x3d"dijit/form/HorizontalSlider" showbuttons\x3d"true" value\x3d"0" minimum\x3d"0" maximum\x3d"100" discretevalues\x3d"101" intermediatechanges\x3d"true" style\x3d"width:100%;" data-dojo-attach-event\x3d"change: _onAlphaChanged"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"topDecoration" labels\x3d"${nls.opaque},${nls.transparent}" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\r\n    \x3c/div\x3e\r\n    \x3col data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"height: 1em; font-size: 0.75em; color: darkblue;"\x3e\r\n      \x3cli\x3e${_nls0}\x3c/li\x3e\r\n      \x3cli\x3e${_nls50}\x3c/li\x3e\r\n      \x3cli\x3e${_nls100}\x3c/li\x3e\r\n    \x3c/ol\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
                "url:dijit/form/templates/HorizontalSlider.html": '\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
                "url:dijit/form/templates/Spinner.html": '\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\r\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
                "url:jimu/dijit/templates/TabContainer3.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/DrawBox.html": '\x3cdiv style\x3d"position:relative;width:100%;"\x3e\r\n\t\x3cdiv class\x3d"draw-items"\x3e\r\n\t\t\x3cdiv title\x3d"${nls.point}" data-geotype\x3d"POINT" data-commontype\x3d"point" class\x3d"draw-item point-icon" data-dojo-attach-point\x3d"pointIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.line}" data-geotype\x3d"LINE" data-commontype\x3d"polyline" class\x3d"draw-item line-icon" data-dojo-attach-point\x3d"lineIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polyline}" data-geotype\x3d"POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item polyline-icon" data-dojo-attach-point\x3d"polylineIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolyline}" data-geotype\x3d"FREEHAND_POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item freehand-polyline-icon" data-dojo-attach-point\x3d"freehandPolylineIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.arrow}" data-geotype\x3d"ARROW" data-commontype\x3d"arrow" class\x3d"draw-item arrow-icon" data-dojo-attach-point\x3d"arrowIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.triangle}" data-geotype\x3d"TRIANGLE" data-commontype\x3d"polygon" class\x3d"draw-item triangle-icon" data-dojo-attach-point\x3d"triangleIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.extent}" data-geotype\x3d"EXTENT" data-commontype\x3d"polygon" class\x3d"draw-item extent-icon" data-dojo-attach-point\x3d"extentIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.circle}" data-geotype\x3d"CIRCLE" data-commontype\x3d"polygon" class\x3d"draw-item circle-icon" data-dojo-attach-point\x3d"circleIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.ellipse}" data-geotype\x3d"ELLIPSE" data-commontype\x3d"polygon" class\x3d"draw-item ellipse-icon" data-dojo-attach-point\x3d"ellipseIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polygon}" data-geotype\x3d"POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item polygon-icon" data-dojo-attach-point\x3d"polygonIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item freehand-polygon-icon" data-dojo-attach-point\x3d"freehandPolygonIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.text}" data-geotype\x3d"TEXT" data-commontype\x3d"text" class\x3d"draw-item text-icon" data-dojo-attach-point\x3d"textIcon" data-dojo-attach-point\x3d"textIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"drawings-clear" data-dojo-attach-point\x3d"btnClear" title\x3d"${nls.clear}"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/ColorRecords.html": '\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\t\t\x3ctr tabindex\x3d"0" role\x3d"row" data-dojo-attach-point\x3d"container"\x3e\r\n\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/Filter.html": '\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"desktopAddSection" class\x3d"desktop-add-section hidden"\x3e\r\n\t\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"btnAddExpDesktop" class\x3d"add-with-icon add-expression jimu-float-leading jimu-state-disabled"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"btnAddSetDesktop" class\x3d"add-with-icon add-set jimu-float-leading jimu-state-disabled"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"matchMsg" class\x3d"match-msg"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"oneOrZeroMsg" tabindex\x3d"0" style\x3d"display:none;"\x3e${nls.oneOrZeroMsg}\x3c/div\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect" data-dojo-type\x3d"jimu/dijit/formSelect" class\x3d"dijit-form-Select restrict-select-width" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.matchMsgAll}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.matchMsgAny}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" class\x3d"hidden"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"mobileAddSection" class\x3d"mobile-add-section hidden"\x3e\r\n\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" title\x3d"${nls.addAnotherExpression}" class\x3d"jimu-btn jimu-btn-vacation jimu-float-leading jimu-state-disabled" data-dojo-attach-point\x3d"btnAddExpMobile"\x3e\r\n\t\t\t+ ${nls.addAnotherExpression}\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv role\x3d"button" tabindex\x3d"0" title\x3d"${nls.addSet}" class\x3d"jimu-btn jimu-btn-vacation jimu-float-leading jimu-state-disabled" data-dojo-attach-point\x3d"btnAddSetMobile"\x3e\r\n\t\t\t+ ${nls.addSet}\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip hidden" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:dijit/templates/Calendar.html": '\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
                "url:jimu/dijit/templates/dateTimePicker.html": '\x3cdiv data-dojo-attach-point\x3d"dateTimeBox" class\x3d"jimu-dateTimeBox"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"calendarDiv"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"timeTextContainerRuntime" class\x3d"timeTextContainer timeTextContainerRuntime"\x3e\r\n\t\t\x3cdiv class\x3d"timeTextIcon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"timeTextBoxDiv"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"timeTextContainerSetting" class\x3d"timeTextContainer" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"timeCheckbox" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"timeCheckbox" data-dojo-props\x3d"checked:true, label:\'${timeNls.showTime}\'"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"timeTableContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cdiv class\x3d"timeGroup"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"timeLabel jimu-ellipsis" title\x3d"${timeUnit.hour}"\x3e${timeUnit.hour}\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"timeLabel jimu-ellipsis" title\x3d"${timeUnit.minute}"\x3e${timeUnit.minute}\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"timeLabel jimu-ellipsis" title\x3d"${timeUnit.second}"\x3e${timeUnit.second}\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"timeGroup"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hourSelect" data-dojo-type\x3d"dijit/form/TimeTextBox"\r\n\t\t\t\t\tdata-dojo-props\x3d"constraints:{timePattern:\'HH\', clickableIncrement: \'T01:00:00\', visibleIncrement: \'T01:00:00\'}"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"minuteSelect" data-dojo-type\x3d"dijit/form/TimeTextBox"\r\n\t\t\t\t\tdata-dojo-props\x3d"constraints:{timePattern:\'mm\', clickableIncrement: \'T00:05:00\', visibleIncrement: \'T00:05:00\',pickerMin: \'T01:00:00\',pickerMax: \'T01:59:00\'}"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"secondSelect" data-dojo-type\x3d"dijit/form/TimeTextBox"\r\n\t\t\t\t\tdata-dojo-props\x3d"constraints:{timePattern:\'ss\', clickableIncrement: \'T00:00:05\', visibleIncrement: \'T00:00:05\',pickerMin: \'T01:00:00\',pickerMax: \'T01:00:59\'}"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/TwoNumbersValueProvider.html": '\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;" data-dojo-attach-point\x3d"_dijit1_container"\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;" data-dojo-attach-point\x3d"_dijit2_container"\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/TwoDatesValueProvider.html": '\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3c!-- \x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"jimu/dijit/_filter/DateValueSelector" data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged" /\x3e --\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"_dijitDiv1"  data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3c!-- \x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"jimu/dijit/_filter/DateValueSelector" data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged" /\x3e --\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"_dijitDiv2"  data-dojo-attach-event\x3d"change:_onDateValueSelectorChanged"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/AdvancedListValueSelect.html": '\x3cdiv class\x3d"jimu-list-multiple-select" data-dojo-attach-point\x3d"multipleSelect" tabindex\x3d"0"\x3e\r\n  \x3cdiv class\x3d"selectedContainer" data-dojo-attach-point\x3d"selectedContainer"\x3e\r\n    \x3cdiv class\x3d"jimu-multiple-items-list items-content" data-dojo-attach-point\x3d"selectedListContent" tabindex\x3d"0"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\x3e\r\n    \x3c!-- \x3cdiv style\x3d"position:absolute;height:345px;width:100%;z-index:1;display:none;" data-dojo-attach-point\x3d"listContainerOverlay"\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"searchKeyInput" data-dojo-attach-point\x3d"searchKeyInput" style\x3d"display:none;"\x3e\r\n      \x3cinput value\x3d"" placeholder\x3d"${jimuCommonNls.search}" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n       data-dojo-attach-point\x3d"valueInput" data-dojo-props\x3d\'"required":false,intermediateChanges:true\' style\x3d"width:100%;" tabindex\x3d"0"/\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"items-content loading-center" data-dojo-attach-point\x3d"listContainer"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"listContentStore"style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\r\n      \x3c/div\x3e --\x3e\r\n      \x3cdiv class\x3d"jimu-multiple-items-list" data-dojo-attach-point\x3d"listContent" tabindex\x3d"0"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadMoreDataBtn" class\x3d"jimu-list-multiple-select-Tips load-more-data-Tips"\x3e${jimuCommonNls.searchMore}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${Nls.noData}\x3c/div\x3e --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${noDataNls}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv class\x3d"createNewItem" data-dojo-attach-point\x3d"createNewItem" data-dojo-attach-event\x3d"click:_createTarget"\x3e\x26nbsp;\x3c/div\x3e --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n    \x3cspan class\x3d"selectedToggle" data-dojo-attach-point\x3d"selectedToggle"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"toggleTxt" title\x3d"${Nls.showSelected}"\x3e${Nls.showSelected}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n  --\x3e\r\n\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n      \x3cdiv class\x3d"showAllIcon iconHover jimu-flipx" title\x3d"${Nls.showAll}" data-dojo-attach-point\x3d"showAllIconBtn"  tabindex\x3d"0"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"showSelectedIcon jimu-flipx" title\x3d"${Nls.showSelected}" data-dojo-attach-point\x3d"showSelectedIconBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"clearAllSelectedIcon jimu-flipx" title\x3d"${Nls.unCheckAll}" data-dojo-attach-point\x3d"clearAllSelectedBtn" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/AdvancedListValueProvider.html": '\x3cdiv\x3e\r\n   \x3cdiv role\x3d"button" aria-haspopup\x3d"true" class\x3d"checkBtn" tabindex\x3d"0" data-dojo-attach-point\x3d"checkedBtn" style\x3d"display:none;" data-dojo-attach-event\x3d"click:_checkedBtnEvent"\x3e\r\n       \x3cspan class\x3d"screen-readers-only" data-dojo-attach-point\x3d"promptLabel"\x3e\x3c/span\x3e\r\n       \x3cdiv data-dojo-attach-point\x3d"checkedNumDiv" class\x3d"checkedNumDiv"\x3e\x3cspan class\x3d"checkedNum" data-dojo-attach-point\x3d"checkedNum"\x3e\x3c/span\x3e${CommonNls.selected}\x3c/div\x3e\r\n       \x3cdiv data-dojo-attach-point\x3d"checkedNameDiv" class\x3d"checkedNum checkedNameDiv jimu-ellipsis-Blanks"\x3e\x3c/div\x3e\r\n       \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8 checkBtnDownIcon"\x3e\x3c/div\x3e\r\n   \x3c/div\x3e\r\n   \x3cdiv data-dojo-attach-point\x3d"listContent"\x3e\x3c/div\x3e\r\n   \x3cdiv class\x3d"value-multiple-popup" data-dojo-attach-point\x3d"listContentPopup"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"listContent"\x3e\x3c/div\x3e\r\n   \x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/pageControlForQuery.html": '\x3cdiv class\x3d"pageControl pageItem"\x3e\r\n  \x3c!--\r\n  \x3cdiv data-dojo-attach-point\x3d"prevPage" class\x3d"pageBtn pageDisabled pageItem"\x3e\x3c-prevPage\x3c/div\x3e\r\n  \x3cdiv class\x3d"pageItem" data-dojo-attach-point\x3d"currentPage"\x3e1\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"nextPage" class\x3d"pageBtn pageItem"\x3enextPage-\x3e\x3c/div\x3e\r\n  --\x3e\r\n\r\n  \x3c!-- \x3cdiv data-dojo-attach-point\x3d"addNextPage"\x3eLoad more data(Test)\x3c/div\x3e --\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/PredefinedValueProvider.html": '\x3cdiv\x3e\r\n    \x3c!-- \x3cdiv data-dojo-attach-point\x3d"valueproviderStore" style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"jimu-filter-popup-btn jimu-not-selectable"\x3e\r\n      \x3cdiv class\x3d"predefined-btn"  data-dojo-attach-point\x3d\'indexBtn\'\x3e\r\n        \x3cdiv class\x3d"tip jimu-ellipsis" title\x3d"predefined" data-dojo-attach-point\x3d\'indexBtnTips\'\x3epredefined\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d\'valueProviderPopupNode\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/EditTable.html": '\x3cdiv\x3e\r\n    \x3cdiv class\x3d"jimu-multiple-set-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"" class\x3d"items-list-content items-list-header"  \x3e\r\n        \x3cdiv class\x3d"item"\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis" title\x3d"${Nls.value}"\x3e${Nls.value}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis" title\x3d"${CommonNls.label}"\x3e${CommonNls.label}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label checkboxHeader jimu-ellipsis" title\x3d"${CommonNls.defaults}"\x3e${CommonNls.defaults}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label lableR jimu-ellipsis" title\x3d"${CommonNls.actions}"\x3e${CommonNls.actions}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"listContent" class\x3d"items-list-content" data-dojo-attach-event\x3d"click:_onListContentClicked, dblclick:_onListContentDblClicked"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e',
                "url:jimu/dijit/_filter/PredefinedValuePopup.html": '\x3cdiv\x3e\r\n   \x3c!--\r\n    \x3cselect data-dojo-attach-point\x3d"valProviderSelect" class\x3d"dijit-form-Select multiple-Select"  data-dojo-attach-event\x3d"onclick:_showPopup"\x3e\r\n    \x3c/select\x3e\r\n    --\x3e\r\n    \x3c!-- \x3cdiv class\x3d"subTitle"\x3e${CommonNls.layer}: \x3cspan data-dojo-attach-point\x3d"layerName"\x3e\x3c/span\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"jimu-filter-popup-btn jimu-not-selectable"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"listSelectStore" style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\x3c/div\x3e --\x3e\r\n\r\n      \x3c!-- for list select popup --\x3e\r\n      \x3c!-- \x3cdiv class\x3d"add-label-btn" data-dojo-attach-event\x3d"click:_showPopup"\x3e --\x3e\r\n      \x3c!-- for eidtTable --\x3e\r\n      \x3cdiv class\x3d"add-label-btn" data-dojo-attach-event\x3d"click:_createTarget"\x3e\r\n        \x3cdiv class\x3d"icon"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"tip"\x3e${CommonNls.add}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"add-btn" data-dojo-attach-event\x3d"click:_showPopup"\x3e\r\n        \x3cdiv class\x3d"tip"\x3eopenLayer-temp\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"add-btn add-btn-right" data-dojo-attach-event\x3d"click:_createTarget"\x3e\r\n        \x3cdiv class\x3d"tip"\x3e${CommonNls.add}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n       --\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"tableContent"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"displayTypes" data-dojo-attach-point\x3d"displayTypes" data-dojo-attach-event\x3d"click:_changeDisplayType"\x3e\r\n      \x3cdiv class\x3d"title jimu-ellipsis"\x3e${Nls.displayAs}\x3c/div\x3e\r\n      \x3cspan class\x3d"option dropdownOption"\x3e\r\n        \x3cdiv class\x3d"radio"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"label jimu-ellipsis"\x3e${Nls.aDrowdownList}\x3c/div\x3e\r\n      \x3c/span\x3e\r\n      \x3cspan class\x3d"option expandedOption"\x3e\r\n      \x3cdiv class\x3d"radio"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"label jimu-ellipsis"\x3e${Nls.aExpandedList}\x3c/div\x3e\r\n      \x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3c!--\r\n    \x3cdiv class\x3d"jimu-multiple-set-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"" class\x3d"items-list-content items-list-header"  \x3e\r\n        \x3cdiv class\x3d"item"\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis"\x3e${CommonNls.name}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label jimu-ellipsis"\x3e${CommonNls.label}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label checkboxHeader jimu-ellipsis" title\x3d"set default?"\x3e${CommonNls.defaults}\x3c/div\x3e\r\n          \x3cdiv class\x3d"label lableR jimu-ellipsis"\x3e${CommonNls.actions}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"listContent" class\x3d"items-list-content" data-dojo-attach-event\x3d"click:_onListContentClicked"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    --\x3e\r\n\r\n    \x3cdiv class\x3d"value-type-popup" data-dojo-attach-point\x3d"valuesPopupNode" style\x3d"display:none;"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"mutiValuesSelect" multiple\x3d"true" data-dojo-type\x3d"dojox/form/CheckedMultiSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;" \x3e\x3c/div\x3e --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"pageControlContainer"\x3eLoad more data\x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n\r\n    \x3c!-- \x3ca data-dojo-attach-event\x3d"onclick:_setSelectType" class\x3d"popupOper" style\x3d"display:none;"\x3etype\x3c/a\x3e --\x3e\r\n  \x3c/div\x3e',
                "url:dojox/form/resources/_CheckedMultiSelectMenuItem.html": '\x3ctr class\x3d"dijitReset dijitMenuItem" dojoAttachPoint\x3d"focusNode" role\x3d"menuitemcheckbox" tabIndex\x3d"-1"\r\n\tdojoAttachEvent\x3d"ondijitclick:_onClick"\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\r\n\t\t\x3e\x3cdiv src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitMenuItemIcon ${_iconClass}" dojoAttachPoint\x3d"iconNode"\r\n\t\t\t\x3e\x3cinput class\x3d"dojoxCheckedMultiSelectCheckBoxInput" dojoAttachPoint\x3d"inputNode" type\x3d"${_type.type}"\r\n\t\t/\x3e\x3c/div\x3e\x3c/td\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" dojoAttachPoint\x3d"containerNode,labelNode"\x3e\x3c/td\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" dojoAttachPoint\x3d"accelKeyNode"\x3e\x3c/td\r\n\t\x3e\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26nbsp;\x3c/td\r\n\x3e\x3c/tr\x3e',
                "url:dojox/form/resources/_CheckedMultiSelectItem.html": '\x3cdiv class\x3d"dijitReset ${baseClass}"\r\n\t\x3e\x3cinput class\x3d"${baseClass}Box" data-dojo-type\x3d"dijit.form.CheckBox" data-dojo-attach-point\x3d"checkBox" \r\n\t\tdata-dojo-attach-event\x3d"_onClick:_changeBox" type\x3d"${_type.type}" data-dojo-props\x3d\'disabled:${disabled}, readOnly:${readOnly}\' baseClass\x3d"${_type.baseClass}"\r\n\t/\x3e\x3cdiv class\x3d"dijitInline ${baseClass}Label" data-dojo-attach-point\x3d"labelNode" data-dojo-attach-event\x3d"onclick:_onClick"\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
                "url:dojox/form/resources/CheckedMultiSelect.html": '\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft" id\x3d"widget_${id}"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"comboButtonNode"\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"selectNode" class\x3d"dijit dijitReset dijitInline ${baseClass}Wrapper" data-dojo-attach-event\x3d"onmousedown:_onMouseDown,onclick:focus"\r\n\t\t\x3e\x3cselect class\x3d"${baseClass}Select dojoxCheckedMultiSelectHidden" multiple\x3d"true" data-dojo-attach-point\x3d"containerNode,focusNode"\x3e\x3c/select\r\n\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"wrapperDiv"\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\x3e\x3c/div\x3e',
                "url:dijit/form/templates/CheckBox.html": '\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n', "url:jimu/dijit/_filter/NumberListValueProvider.html": '\x3cdiv\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"numberListTable" style\x3d"width:100%;border-collapse:collapse;"\r\n        cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd style\x3d"width:50%;"\x3e\r\n                    \x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox"\r\n                        data-dojo-props\x3d\'"required":false,constraints:{min:0,pattern:"#####0.##########"}\'\r\n                        style\x3d"width:100%;" /\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd\x3e\r\n                    \x3cselect data-dojo-attach-point\x3d"rangeSelect" data-dojo-type\x3d"dijit/form/Select"\r\n                        style\x3d"width:100%;" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n                        \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n                    \x3c/select\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/_filter/DateIsInValueProvider.html": '\x3cdiv\x3e\r\n\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"dateTypeSelect" class\x3d"date-type-select restrict-select-width" data-dojo-attach-event\x3d"change:_onDateTypeSelectChanged"\x3e\r\n\t\x3c/select\x3e\r\n\x3c/div\x3e', "url:jimu/dijit/templates/_SingleFilter.html": '\x3cdiv\x3e\r\n  \x3cdiv class\x3d"settings-container"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"fields-select dijit-form-FilteringSelect"\x3e\x3c/div\x3e\r\n    \x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" class\x3d"operator-select dijit-form-Select restrict-select-width"\x3e\r\n      \x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n    \x3c/select\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"attribute-value-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"valueProviderContainer" class\x3d"value-provider-container"\x3e\x3c/div\x3e\r\n      \x3cdiv role\x3d"button" tabindex\x3d"0" data-dojo-attach-point\x3d"valueTypeSetNode" title\x3d"${nls.setInputType}" class\x3d"value-type-set jimu-icon jimu-icon-setting"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" tabindex\x3d"0" aria-label\x3d"\'${nls.deleteText}\'" class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"askvalues"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table" style\x3d"width:100%;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"relativeDatesTr" class\x3d"relative-start-date-tr"\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"startDateOptions"\x3e${nls.dateOptions}\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"custom_start_date" data-dojo-props\x3d\'title:"${nls.custom}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.custom}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"today_start_date" data-dojo-props\x3d\'title:"${nls.today}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.today}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"yesterday_start_date" data-dojo-props\x3d\'title:"${nls.yesterday}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.yesterday}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"tomorrow_start_date" data-dojo-props\x3d\'title:"${nls.tomorrow}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.tomorrow}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"relativeDatesTr" class\x3d"relative-end-date-tr"\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"endDateOptions"\x3e${nls.endDateOptions}\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"custom_end_date" data-dojo-props\x3d\'title:"${nls.custom}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.custom}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"today_end_date" data-dojo-props\x3d\'title:"${nls.today}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.today}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"yesterday_end_date" data-dojo-props\x3d\'title:"${nls.yesterday}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.yesterday}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"showItems"\x3e\r\n              \x3cdiv class\x3d"opers" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"tomorrow_end_date" data-dojo-props\x3d\'title:"${nls.tomorrow}"\'\x3e\x3c/div\x3e\r\n              \x3cspan\x3e${nls.tomorrow}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"cascadeTr" class\x3d"cascade-tr"\x3e\r\n          \x3ctd class\x3d"first-td"\x3e\r\n            \x3cdiv style\x3d"margin-bottom:5px;"\x3e${nls.listValues}:\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second-td"\x3e\r\n            \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"cascadeSelect" class\x3d"cascade-select restrict-select-width" style\x3d"width:100%;"\x3e\r\n              \x3coption value\x3d"none"\x3e${nls.noneCascadeFilterTip}\x3c/option\x3e\r\n              \x3coption value\x3d"previous"\x3e${nls.previousCascadeFilterTip}\x3c/option\x3e\r\n              \x3coption value\x3d"all"\x3e${nls.allCascadeFilterTip}\x3c/option\x3e\r\n            \x3c/select\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/_FilterSet.html": '\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.matchMsgSetAll}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.matchMsgSetAny}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"jimu-filter-set-delete"\x3e\r\n\t\t\t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"btnDelete" aria-label\x3d"\'${nls.deleteText}\'" class\x3d"jimu-icon jimu-icon-delete" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"jimu-filter-set-add"\x3e\r\n\t\t\t\t\t\x3cdiv role\x3d"button" data-dojo-attach-point\x3d"btnAdd" aria-label\x3d"\'${nls.addText}\'" class\x3d"jimu-icon jimu-icon-add" tabindex\x3d"0"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox" class\x3d"jimu-filter-exps-box"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
                "url:jimu/dijit/templates/_SingleFilterParameter.html": '\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr class\x3d"first-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"second-tr"\x3e\r\n        \x3ctd data-dojo-attach-point\x3d"valueProviderTd"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"third-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
                "url:dijit/templates/CheckedMenuItem.html": '\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"${role}" tabIndex\x3d"-1" aria-checked\x3d"${checked}"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\x3cspan class\x3d"dijitMenuItemIconChar dijitCheckedMenuItemIconChar"\x3e${!checkedChar}\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,labelNode,textDirNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26#160;\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
                "url:dijit/templates/ColorPalette.html": '\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellSpacing\x3d"0" cellPadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n', "*now": function (E) { E(['dojo/i18n!*preload*jimu/nls/main*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]']) },
                "*noref": 1
        }
});
define("./ConfigManager ./LayoutManager ./DataManager ./WidgetManager ./FeatureActionManager ./SelectionManager ./DataSourceManager ./FilterManager dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/mouse dojo/topic dojo/cookie dojo/Deferred dojo/promise/all dojo/io-query esri/config esri/request esri/urlUtils esri/IdentityManager jimu/portalUrlUtils ./utils ./portalUtils require dojo/i18n dojo/i18n!./nls/main esri/main dojo/ready".split(" "), function (E, q, A, w, m, v, r, l, k, n, d, c,
        g, b, e, a, f, h, p, B, t, u, z, x, y, D, H, I, N, T, M) {
                function R() { var W = window.location.search, fa = { query: !0, find: !0 }; if ("" === W) return {}; W = p.queryToObject(W.substr(1)); for (var ma in W) fa[ma] || (W[ma] = y.sanitizeHTML(W[ma])); return W } function ca(W, fa) { K = W; "loadingPageChange" !== fa && k.setStyle(jimuConfig.mainPageId, "display", "block") } f = {}; var K; window.topic = e; B.defaults.io.timeout = 18E4; "function" !== typeof a.getAll && (a.getAll = function (W) { var fa = []; (W = a(W)) && fa.push(W); return fa }); window.jimuNls = N; window.apiNls = T.bundle;
        z.setProtocolErrorHandler(function () { return !0 }); z.setOAuthRedirectionHandler(function (W) { window.location = W.authorizeUrl + "?canHandleCrossOrgSignin\x3dtrue\x26" + p.objectToQuery(W.authorizeParams) }); z = y.getAncestorWindow(); var Q = !1, X = /^http(s?):\/\//gi; try { Q = 0 === z.location.href.indexOf("https://") } catch (W) { } t.setRequestPreCallback(function (W) {
                W.content && W.content.printFlag && (W.timeout = 3E5); Q && (W.url = W.url.replace(X, "//")); if (-1 !== W.url.indexOf("/queryRelatedRecords?")) {
                        var fa = W.url, ma = B.defaults.io.proxyUrl;
                        ma && 0 === W.url.indexOf(ma + "?") && (fa = W.url.replace(ma + "?", "")); y.isHostedService(fa) || (W.url = W.url.replace("FeatureServer", "MapServer"))
                } /GPServer\/.+\/jobs/.test(W.url) && (W.preventCache = (new Date).getTime()); window.isBuilder || !K || K.mode || (K.appProxies && 0 < K.appProxies.length && d.some(K.appProxies, function (ia) { var va = ia.sourceUrl; ia = ia.proxyUrl; Q && (va = va.replace(X, "//"), ia = ia.replace(X, "//")); if (0 <= W.url.indexOf(va)) return W.url = W.url.replace(va, ia), !0 }), K.map.appProxy && d.some(K.map.appProxy.proxyItems,
                        function (ia) { if (!ia.useProxy || !ia.proxyUrl) return !1; var va = ia.sourceUrl; ia = ia.proxyUrl; Q && (va = va.replace(X, "//"), ia = ia.replace(X, "//")); if (0 <= W.url.indexOf(va)) return W.url = W.url.replace(va, ia), !0 })); return W
        }); c(window, "mousedown", function (W) { y.isInNavMode() && (k.removeClass(document.body, "jimu-nav-mode"), window.isMoveFocusWhenInit = !1); if (b.isMiddle(W)) return W.preventDefault(), W.stopPropagation(), W.returnValue = !1 }); c(window, "keydown", function (W) {
                W.keyCode !== g.TAB || y.isInNavMode() || k.addClass(document.body,
                        "jimu-nav-mode")
        }); navigator.serviceWorker && (window.postMessageToSw({ type: "to_sw_credential", credential: null }), navigator.serviceWorker.onmessage = function (W) { var fa = W.data; W.origin === window.location.origin && "to_window_get_credential" === fa.type && window.portalUrl && (W = x.getStandardPortalUrl(window.portalUrl), W = D.getPortal(W), W.credential ? window.postMessageToSw({ type: "to_sw_credential", credential: W.credential.toJson() }) : window.isCredentialSettled && window.postMessageToSw({ type: "to_sw_no_credential" })) });
        String.prototype.startWith = function (W) { return this.substr(0, W.length) === W ? !0 : !1 }; String.prototype.endWith = function (W) { return this.substr(this.length - W.length, W.length) === W ? !0 : !1 }; Number.isNaN = Number.isNaN || function (W) { return W !== W }; "undefined" === typeof jimuConfig && (jimuConfig = {}); jimuConfig = n.mixin({ loadingId: "main-loading", loadingImageId: "app-loading", loadingGifId: "loading-gif", layoutId: "jimu-layout-manager", mapId: "map", mainPageId: "main-page", timeout: 5E3, breakPoints: [600, 1280] }, jimuConfig); window.wabVersion =
                "2.25"; window.productVersion = "Online 10.2"; window.isBuilder ? (e.subscribe("app/appConfigLoaded", ca), e.subscribe("app/appConfigChanged", ca)) : (e.subscribe("appConfigLoaded", ca), e.subscribe("appConfigChanged", ca)); if (n = y.has("ie")) 9 < n ? k.addClass(document.body, "ie-nav-mode") : k.addClass(document.body, "ie-low-nav-mode"), 10 < n && k.addClass(document.body, "ie-gte-10"); f.initApp = function () {
                        console.log("jimu.js init..."); var W = R(); if (W.mobileBreakPoint) try {
                                var fa = parseInt(W.mobileBreakPoint, 10); jimuConfig.breakPoints[0] =
                                        fa
                        } catch (ma) { console.error("mobileBreakPoint URL parameter must be a number.", ma) } W.mode && (k.setStyle(jimuConfig.loadingId, "display", "none"), k.setStyle(jimuConfig.mainPageId, "display", "block")); A.getInstance(w.getInstance()); m.getInstance(); v.getInstance(); r.getInstance(); l.getInstance(); fa = q.getInstance({ mapId: jimuConfig.mapId, urlParams: W }, jimuConfig.layoutId); W = E.getInstance(W); fa.startup(); W.loadConfig(); H(["dynamic-modules/preload"]); M(function () {
                                setTimeout(function () {
                                        k.removeClass(document.body,
                                                "dj_a11y")
                                }, 50)
                        })
                }; return f
});